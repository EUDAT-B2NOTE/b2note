/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/aurelia-binding/dist/es2015/aurelia-binding.js":
/*!*********************************************************************!*\
  !*** ./node_modules/aurelia-binding/dist/es2015/aurelia-binding.js ***!
  \*********************************************************************/
/*! exports provided: targetContext, sourceContext, camelCase, createOverrideContext, getContextFor, createScopeForTest, connectable, enqueueBindingConnect, setConnectQueueThreshold, enableConnectQueue, disableConnectQueue, getConnectQueueSize, subscriberCollection, ExpressionObserver, calcSplices, mergeSplice, projectArraySplices, getChangeRecords, ModifyCollectionObserver, CollectionLengthObserver, getArrayObserver, Expression, BindingBehavior, ValueConverter, Assign, Conditional, AccessThis, AccessScope, AccessMember, AccessKeyed, CallScope, CallMember, CallFunction, Binary, Unary, LiteralPrimitive, LiteralString, LiteralTemplate, LiteralArray, LiteralObject, Unparser, ExpressionCloner, cloneExpression, bindingMode, Parser, ParserImplementation, getMapObserver, delegationStrategy, EventManager, EventSubscriber, DirtyChecker, DirtyCheckProperty, propertyAccessor, PrimitiveObserver, SetterObserver, XLinkAttributeObserver, dataAttributeAccessor, DataAttributeObserver, StyleObserver, ValueAttributeObserver, CheckedObserver, SelectValueObserver, ClassObserver, hasDeclaredDependencies, declarePropertyDependencies, computedFrom, ComputedExpression, createComputedObserver, elements, presentationElements, presentationAttributes, SVGAnalyzer, ObserverLocator, ObjectObservationAdapter, BindingExpression, Binding, CallExpression, Call, ValueConverterResource, valueConverter, BindingBehaviorResource, bindingBehavior, ListenerExpression, Listener, NameExpression, BindingEngine, getSetObserver, observable, connectBindingToSignal, signalBindings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"targetContext\", function() { return targetContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sourceContext\", function() { return sourceContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"camelCase\", function() { return camelCase; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createOverrideContext\", function() { return createOverrideContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getContextFor\", function() { return getContextFor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createScopeForTest\", function() { return createScopeForTest; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"connectable\", function() { return connectable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"enqueueBindingConnect\", function() { return enqueueBindingConnect; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setConnectQueueThreshold\", function() { return setConnectQueueThreshold; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"enableConnectQueue\", function() { return enableConnectQueue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"disableConnectQueue\", function() { return disableConnectQueue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getConnectQueueSize\", function() { return getConnectQueueSize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"subscriberCollection\", function() { return subscriberCollection; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ExpressionObserver\", function() { return ExpressionObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calcSplices\", function() { return calcSplices; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mergeSplice\", function() { return mergeSplice; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"projectArraySplices\", function() { return projectArraySplices; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getChangeRecords\", function() { return getChangeRecords; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ModifyCollectionObserver\", function() { return ModifyCollectionObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CollectionLengthObserver\", function() { return CollectionLengthObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getArrayObserver\", function() { return getArrayObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Expression\", function() { return Expression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindingBehavior\", function() { return BindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ValueConverter\", function() { return ValueConverter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Assign\", function() { return Assign; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Conditional\", function() { return Conditional; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AccessThis\", function() { return AccessThis; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AccessScope\", function() { return AccessScope; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AccessMember\", function() { return AccessMember; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AccessKeyed\", function() { return AccessKeyed; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CallScope\", function() { return CallScope; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CallMember\", function() { return CallMember; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CallFunction\", function() { return CallFunction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Binary\", function() { return Binary; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Unary\", function() { return Unary; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LiteralPrimitive\", function() { return LiteralPrimitive; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LiteralString\", function() { return LiteralString; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LiteralTemplate\", function() { return LiteralTemplate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LiteralArray\", function() { return LiteralArray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LiteralObject\", function() { return LiteralObject; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Unparser\", function() { return Unparser; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ExpressionCloner\", function() { return ExpressionCloner; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"cloneExpression\", function() { return cloneExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bindingMode\", function() { return bindingMode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Parser\", function() { return Parser; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ParserImplementation\", function() { return ParserImplementation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getMapObserver\", function() { return getMapObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"delegationStrategy\", function() { return delegationStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EventManager\", function() { return EventManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EventSubscriber\", function() { return EventSubscriber; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DirtyChecker\", function() { return DirtyChecker; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DirtyCheckProperty\", function() { return DirtyCheckProperty; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"propertyAccessor\", function() { return propertyAccessor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PrimitiveObserver\", function() { return PrimitiveObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SetterObserver\", function() { return SetterObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"XLinkAttributeObserver\", function() { return XLinkAttributeObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dataAttributeAccessor\", function() { return dataAttributeAccessor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DataAttributeObserver\", function() { return DataAttributeObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StyleObserver\", function() { return StyleObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ValueAttributeObserver\", function() { return ValueAttributeObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CheckedObserver\", function() { return CheckedObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SelectValueObserver\", function() { return SelectValueObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ClassObserver\", function() { return ClassObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"hasDeclaredDependencies\", function() { return hasDeclaredDependencies; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"declarePropertyDependencies\", function() { return declarePropertyDependencies; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"computedFrom\", function() { return computedFrom; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ComputedExpression\", function() { return ComputedExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createComputedObserver\", function() { return createComputedObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"elements\", function() { return elements; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"presentationElements\", function() { return presentationElements; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"presentationAttributes\", function() { return presentationAttributes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SVGAnalyzer\", function() { return SVGAnalyzer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ObserverLocator\", function() { return ObserverLocator; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ObjectObservationAdapter\", function() { return ObjectObservationAdapter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindingExpression\", function() { return BindingExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Binding\", function() { return Binding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CallExpression\", function() { return CallExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Call\", function() { return Call; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ValueConverterResource\", function() { return ValueConverterResource; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"valueConverter\", function() { return valueConverter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindingBehaviorResource\", function() { return BindingBehaviorResource; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bindingBehavior\", function() { return bindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ListenerExpression\", function() { return ListenerExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Listener\", function() { return Listener; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NameExpression\", function() { return NameExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindingEngine\", function() { return BindingEngine; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getSetObserver\", function() { return getSetObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"observable\", function() { return observable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"connectBindingToSignal\", function() { return connectBindingToSignal; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"signalBindings\", function() { return signalBindings; });\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-logging */ \"./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n/* harmony import */ var aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-task-queue */ \"./node_modules/aurelia-task-queue/dist/es2015/aurelia-task-queue.js\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-metadata */ \"./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js\");\nvar _dec, _dec2, _class, _dec3, _class2, _dec4, _class3, _dec5, _class5, _dec6, _class7, _dec7, _class8, _dec8, _class9, _dec9, _class10, _class11, _temp, _dec10, _class12, _class13, _temp2;\n\n\n\n\n\n\nconst targetContext = 'Binding:target';\nconst sourceContext = 'Binding:source';\n\nconst map = Object.create(null);\n\nfunction camelCase(name) {\n  if (name in map) {\n    return map[name];\n  }\n  const result = name.charAt(0).toLowerCase() + name.slice(1).replace(/[_.-](\\w|$)/g, (_, x) => x.toUpperCase());\n  map[name] = result;\n  return result;\n}\n\nfunction createOverrideContext(bindingContext, parentOverrideContext) {\n  return {\n    bindingContext: bindingContext,\n    parentOverrideContext: parentOverrideContext || null\n  };\n}\n\nfunction getContextFor(name, scope, ancestor) {\n  let oc = scope.overrideContext;\n\n  if (ancestor) {\n    while (ancestor && oc) {\n      ancestor--;\n      oc = oc.parentOverrideContext;\n    }\n    if (ancestor || !oc) {\n      return undefined;\n    }\n    return name in oc ? oc : oc.bindingContext;\n  }\n\n  while (oc && !(name in oc) && !(oc.bindingContext && name in oc.bindingContext)) {\n    oc = oc.parentOverrideContext;\n  }\n  if (oc) {\n    return name in oc ? oc : oc.bindingContext;\n  }\n\n  return scope.bindingContext || scope.overrideContext;\n}\n\nfunction createScopeForTest(bindingContext, parentBindingContext) {\n  if (parentBindingContext) {\n    return {\n      bindingContext,\n      overrideContext: createOverrideContext(bindingContext, createOverrideContext(parentBindingContext))\n    };\n  }\n  return {\n    bindingContext,\n    overrideContext: createOverrideContext(bindingContext)\n  };\n}\n\nconst slotNames = [];\nconst versionSlotNames = [];\nlet lastSlot = -1;\nfunction ensureEnoughSlotNames(currentSlot) {\n  if (currentSlot === lastSlot) {\n    lastSlot += 5;\n    const ii = slotNames.length = versionSlotNames.length = lastSlot + 1;\n    for (let i = currentSlot + 1; i < ii; ++i) {\n      slotNames[i] = `_observer${i}`;\n      versionSlotNames[i] = `_observerVersion${i}`;\n    }\n  }\n}\nensureEnoughSlotNames(-1);\n\nfunction addObserver(observer) {\n  let observerSlots = this._observerSlots === undefined ? 0 : this._observerSlots;\n  let i = observerSlots;\n  while (i-- && this[slotNames[i]] !== observer) {}\n\n  if (i === -1) {\n    i = 0;\n    while (this[slotNames[i]]) {\n      i++;\n    }\n    this[slotNames[i]] = observer;\n    observer.subscribe(sourceContext, this);\n\n    if (i === observerSlots) {\n      this._observerSlots = i + 1;\n    }\n  }\n\n  if (this._version === undefined) {\n    this._version = 0;\n  }\n  this[versionSlotNames[i]] = this._version;\n  ensureEnoughSlotNames(i);\n}\n\nfunction observeProperty(obj, propertyName) {\n  let observer = this.observerLocator.getObserver(obj, propertyName);\n  addObserver.call(this, observer);\n}\n\nfunction observeArray(array) {\n  let observer = this.observerLocator.getArrayObserver(array);\n  addObserver.call(this, observer);\n}\n\nfunction unobserve(all) {\n  let i = this._observerSlots;\n  while (i--) {\n    if (all || this[versionSlotNames[i]] !== this._version) {\n      let observer = this[slotNames[i]];\n      this[slotNames[i]] = null;\n      if (observer) {\n        observer.unsubscribe(sourceContext, this);\n      }\n    }\n  }\n}\n\nfunction connectable() {\n  return function (target) {\n    target.prototype.observeProperty = observeProperty;\n    target.prototype.observeArray = observeArray;\n    target.prototype.unobserve = unobserve;\n    target.prototype.addObserver = addObserver;\n  };\n}\n\nconst queue = [];\nconst queued = {};\nlet nextId = 0;\nlet minimumImmediate = 100;\nconst frameBudget = 15;\n\nlet isFlushRequested = false;\nlet immediate = 0;\n\nfunction flush(animationFrameStart) {\n  const length = queue.length;\n  let i = 0;\n  while (i < length) {\n    const binding = queue[i];\n    queued[binding.__connectQueueId] = false;\n    binding.connect(true);\n    i++;\n\n    if (i % 100 === 0 && aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].performance.now() - animationFrameStart > frameBudget) {\n      break;\n    }\n  }\n  queue.splice(0, i);\n\n  if (queue.length) {\n    aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].requestAnimationFrame(flush);\n  } else {\n    isFlushRequested = false;\n    immediate = 0;\n  }\n}\n\nfunction enqueueBindingConnect(binding) {\n  if (immediate < minimumImmediate) {\n    immediate++;\n    binding.connect(false);\n  } else {\n    let id = binding.__connectQueueId;\n    if (id === undefined) {\n      id = nextId;\n      nextId++;\n      binding.__connectQueueId = id;\n    }\n\n    if (!queued[id]) {\n      queue.push(binding);\n      queued[id] = true;\n    }\n  }\n  if (!isFlushRequested) {\n    isFlushRequested = true;\n    aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].requestAnimationFrame(flush);\n  }\n}\n\nfunction setConnectQueueThreshold(value) {\n  minimumImmediate = value;\n}\n\nfunction enableConnectQueue() {\n  setConnectQueueThreshold(100);\n}\n\nfunction disableConnectQueue() {\n  setConnectQueueThreshold(Number.MAX_SAFE_INTEGER);\n}\n\nfunction getConnectQueueSize() {\n  return queue.length;\n}\n\nfunction addSubscriber(context, callable) {\n  if (this.hasSubscriber(context, callable)) {\n    return false;\n  }\n  if (!this._context0) {\n    this._context0 = context;\n    this._callable0 = callable;\n    return true;\n  }\n  if (!this._context1) {\n    this._context1 = context;\n    this._callable1 = callable;\n    return true;\n  }\n  if (!this._context2) {\n    this._context2 = context;\n    this._callable2 = callable;\n    return true;\n  }\n  if (!this._contextsRest) {\n    this._contextsRest = [context];\n    this._callablesRest = [callable];\n    return true;\n  }\n  this._contextsRest.push(context);\n  this._callablesRest.push(callable);\n  return true;\n}\n\nfunction removeSubscriber(context, callable) {\n  if (this._context0 === context && this._callable0 === callable) {\n    this._context0 = null;\n    this._callable0 = null;\n    return true;\n  }\n  if (this._context1 === context && this._callable1 === callable) {\n    this._context1 = null;\n    this._callable1 = null;\n    return true;\n  }\n  if (this._context2 === context && this._callable2 === callable) {\n    this._context2 = null;\n    this._callable2 = null;\n    return true;\n  }\n  const callables = this._callablesRest;\n  if (callables === undefined || callables.length === 0) {\n    return false;\n  }\n  const contexts = this._contextsRest;\n  let i = 0;\n  while (!(callables[i] === callable && contexts[i] === context) && callables.length > i) {\n    i++;\n  }\n  if (i >= callables.length) {\n    return false;\n  }\n  contexts.splice(i, 1);\n  callables.splice(i, 1);\n  return true;\n}\n\nlet arrayPool1 = [];\nlet arrayPool2 = [];\nlet poolUtilization = [];\n\nfunction callSubscribers(newValue, oldValue) {\n  let context0 = this._context0;\n  let callable0 = this._callable0;\n  let context1 = this._context1;\n  let callable1 = this._callable1;\n  let context2 = this._context2;\n  let callable2 = this._callable2;\n  let length = this._contextsRest ? this._contextsRest.length : 0;\n  let contextsRest;\n  let callablesRest;\n  let poolIndex;\n  let i;\n  if (length) {\n    poolIndex = poolUtilization.length;\n    while (poolIndex-- && poolUtilization[poolIndex]) {}\n    if (poolIndex < 0) {\n      poolIndex = poolUtilization.length;\n      contextsRest = [];\n      callablesRest = [];\n      poolUtilization.push(true);\n      arrayPool1.push(contextsRest);\n      arrayPool2.push(callablesRest);\n    } else {\n      poolUtilization[poolIndex] = true;\n      contextsRest = arrayPool1[poolIndex];\n      callablesRest = arrayPool2[poolIndex];\n    }\n\n    i = length;\n    while (i--) {\n      contextsRest[i] = this._contextsRest[i];\n      callablesRest[i] = this._callablesRest[i];\n    }\n  }\n\n  if (context0) {\n    if (callable0) {\n      callable0.call(context0, newValue, oldValue);\n    } else {\n      context0(newValue, oldValue);\n    }\n  }\n  if (context1) {\n    if (callable1) {\n      callable1.call(context1, newValue, oldValue);\n    } else {\n      context1(newValue, oldValue);\n    }\n  }\n  if (context2) {\n    if (callable2) {\n      callable2.call(context2, newValue, oldValue);\n    } else {\n      context2(newValue, oldValue);\n    }\n  }\n  if (length) {\n    for (i = 0; i < length; i++) {\n      let callable = callablesRest[i];\n      let context = contextsRest[i];\n      if (callable) {\n        callable.call(context, newValue, oldValue);\n      } else {\n        context(newValue, oldValue);\n      }\n      contextsRest[i] = null;\n      callablesRest[i] = null;\n    }\n    poolUtilization[poolIndex] = false;\n  }\n}\n\nfunction hasSubscribers() {\n  return !!(this._context0 || this._context1 || this._context2 || this._contextsRest && this._contextsRest.length);\n}\n\nfunction hasSubscriber(context, callable) {\n  let has = this._context0 === context && this._callable0 === callable || this._context1 === context && this._callable1 === callable || this._context2 === context && this._callable2 === callable;\n  if (has) {\n    return true;\n  }\n  let index;\n  let contexts = this._contextsRest;\n  if (!contexts || (index = contexts.length) === 0) {\n    return false;\n  }\n  let callables = this._callablesRest;\n  while (index--) {\n    if (contexts[index] === context && callables[index] === callable) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction subscriberCollection() {\n  return function (target) {\n    target.prototype.addSubscriber = addSubscriber;\n    target.prototype.removeSubscriber = removeSubscriber;\n    target.prototype.callSubscribers = callSubscribers;\n    target.prototype.hasSubscribers = hasSubscribers;\n    target.prototype.hasSubscriber = hasSubscriber;\n  };\n}\n\nlet ExpressionObserver = (_dec = connectable(), _dec2 = subscriberCollection(), _dec(_class = _dec2(_class = class ExpressionObserver {\n  constructor(scope, expression, observerLocator, lookupFunctions) {\n    this.scope = scope;\n    this.expression = expression;\n    this.observerLocator = observerLocator;\n    this.lookupFunctions = lookupFunctions;\n  }\n\n  getValue() {\n    return this.expression.evaluate(this.scope, this.lookupFunctions);\n  }\n\n  setValue(newValue) {\n    this.expression.assign(this.scope, newValue);\n  }\n\n  subscribe(context, callable) {\n    if (!this.hasSubscribers()) {\n      this.oldValue = this.expression.evaluate(this.scope, this.lookupFunctions);\n      this.expression.connect(this, this.scope);\n    }\n    this.addSubscriber(context, callable);\n    if (arguments.length === 1 && context instanceof Function) {\n      return {\n        dispose: () => {\n          this.unsubscribe(context, callable);\n        }\n      };\n    }\n  }\n\n  unsubscribe(context, callable) {\n    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {\n      this.unobserve(true);\n      this.oldValue = undefined;\n    }\n  }\n\n  call() {\n    let newValue = this.expression.evaluate(this.scope, this.lookupFunctions);\n    let oldValue = this.oldValue;\n    if (newValue !== oldValue) {\n      this.oldValue = newValue;\n      this.callSubscribers(newValue, oldValue);\n    }\n    this._version++;\n    this.expression.connect(this, this.scope);\n    this.unobserve(false);\n  }\n}) || _class) || _class);\n\nfunction isIndex(s) {\n  return +s === s >>> 0;\n}\n\nfunction toNumber(s) {\n  return +s;\n}\n\nfunction newSplice(index, removed, addedCount) {\n  return {\n    index: index,\n    removed: removed,\n    addedCount: addedCount\n  };\n}\n\nconst EDIT_LEAVE = 0;\nconst EDIT_UPDATE = 1;\nconst EDIT_ADD = 2;\nconst EDIT_DELETE = 3;\n\nfunction ArraySplice() {}\n\nArraySplice.prototype = {\n  calcEditDistances: function (current, currentStart, currentEnd, old, oldStart, oldEnd) {\n    let rowCount = oldEnd - oldStart + 1;\n    let columnCount = currentEnd - currentStart + 1;\n    let distances = new Array(rowCount);\n    let north;\n    let west;\n\n    for (let i = 0; i < rowCount; ++i) {\n      distances[i] = new Array(columnCount);\n      distances[i][0] = i;\n    }\n\n    for (let j = 0; j < columnCount; ++j) {\n      distances[0][j] = j;\n    }\n\n    for (let i = 1; i < rowCount; ++i) {\n      for (let j = 1; j < columnCount; ++j) {\n        if (this.equals(current[currentStart + j - 1], old[oldStart + i - 1])) {\n          distances[i][j] = distances[i - 1][j - 1];\n        } else {\n          north = distances[i - 1][j] + 1;\n          west = distances[i][j - 1] + 1;\n          distances[i][j] = north < west ? north : west;\n        }\n      }\n    }\n\n    return distances;\n  },\n\n  spliceOperationsFromEditDistances: function (distances) {\n    let i = distances.length - 1;\n    let j = distances[0].length - 1;\n    let current = distances[i][j];\n    let edits = [];\n    while (i > 0 || j > 0) {\n      if (i === 0) {\n        edits.push(EDIT_ADD);\n        j--;\n        continue;\n      }\n      if (j === 0) {\n        edits.push(EDIT_DELETE);\n        i--;\n        continue;\n      }\n      let northWest = distances[i - 1][j - 1];\n      let west = distances[i - 1][j];\n      let north = distances[i][j - 1];\n\n      let min;\n      if (west < north) {\n        min = west < northWest ? west : northWest;\n      } else {\n        min = north < northWest ? north : northWest;\n      }\n\n      if (min === northWest) {\n        if (northWest === current) {\n          edits.push(EDIT_LEAVE);\n        } else {\n          edits.push(EDIT_UPDATE);\n          current = northWest;\n        }\n        i--;\n        j--;\n      } else if (min === west) {\n        edits.push(EDIT_DELETE);\n        i--;\n        current = west;\n      } else {\n        edits.push(EDIT_ADD);\n        j--;\n        current = north;\n      }\n    }\n\n    edits.reverse();\n    return edits;\n  },\n\n  calcSplices: function (current, currentStart, currentEnd, old, oldStart, oldEnd) {\n    let prefixCount = 0;\n    let suffixCount = 0;\n\n    let minLength = Math.min(currentEnd - currentStart, oldEnd - oldStart);\n    if (currentStart === 0 && oldStart === 0) {\n      prefixCount = this.sharedPrefix(current, old, minLength);\n    }\n\n    if (currentEnd === current.length && oldEnd === old.length) {\n      suffixCount = this.sharedSuffix(current, old, minLength - prefixCount);\n    }\n\n    currentStart += prefixCount;\n    oldStart += prefixCount;\n    currentEnd -= suffixCount;\n    oldEnd -= suffixCount;\n\n    if (currentEnd - currentStart === 0 && oldEnd - oldStart === 0) {\n      return [];\n    }\n\n    if (currentStart === currentEnd) {\n      let splice = newSplice(currentStart, [], 0);\n      while (oldStart < oldEnd) {\n        splice.removed.push(old[oldStart++]);\n      }\n\n      return [splice];\n    } else if (oldStart === oldEnd) {\n      return [newSplice(currentStart, [], currentEnd - currentStart)];\n    }\n\n    let ops = this.spliceOperationsFromEditDistances(this.calcEditDistances(current, currentStart, currentEnd, old, oldStart, oldEnd));\n\n    let splice = undefined;\n    let splices = [];\n    let index = currentStart;\n    let oldIndex = oldStart;\n    for (let i = 0; i < ops.length; ++i) {\n      switch (ops[i]) {\n        case EDIT_LEAVE:\n          if (splice) {\n            splices.push(splice);\n            splice = undefined;\n          }\n\n          index++;\n          oldIndex++;\n          break;\n        case EDIT_UPDATE:\n          if (!splice) {\n            splice = newSplice(index, [], 0);\n          }\n\n          splice.addedCount++;\n          index++;\n\n          splice.removed.push(old[oldIndex]);\n          oldIndex++;\n          break;\n        case EDIT_ADD:\n          if (!splice) {\n            splice = newSplice(index, [], 0);\n          }\n\n          splice.addedCount++;\n          index++;\n          break;\n        case EDIT_DELETE:\n          if (!splice) {\n            splice = newSplice(index, [], 0);\n          }\n\n          splice.removed.push(old[oldIndex]);\n          oldIndex++;\n          break;\n      }\n    }\n\n    if (splice) {\n      splices.push(splice);\n    }\n    return splices;\n  },\n\n  sharedPrefix: function (current, old, searchLength) {\n    for (let i = 0; i < searchLength; ++i) {\n      if (!this.equals(current[i], old[i])) {\n        return i;\n      }\n    }\n\n    return searchLength;\n  },\n\n  sharedSuffix: function (current, old, searchLength) {\n    let index1 = current.length;\n    let index2 = old.length;\n    let count = 0;\n    while (count < searchLength && this.equals(current[--index1], old[--index2])) {\n      count++;\n    }\n\n    return count;\n  },\n\n  calculateSplices: function (current, previous) {\n    return this.calcSplices(current, 0, current.length, previous, 0, previous.length);\n  },\n\n  equals: function (currentValue, previousValue) {\n    return currentValue === previousValue;\n  }\n};\n\nlet arraySplice = new ArraySplice();\n\nfunction calcSplices(current, currentStart, currentEnd, old, oldStart, oldEnd) {\n  return arraySplice.calcSplices(current, currentStart, currentEnd, old, oldStart, oldEnd);\n}\n\nfunction intersect(start1, end1, start2, end2) {\n  if (end1 < start2 || end2 < start1) {\n    return -1;\n  }\n\n  if (end1 === start2 || end2 === start1) {\n    return 0;\n  }\n\n  if (start1 < start2) {\n    if (end1 < end2) {\n      return end1 - start2;\n    }\n\n    return end2 - start2;\n  }\n\n  if (end2 < end1) {\n    return end2 - start1;\n  }\n\n  return end1 - start1;\n}\n\nfunction mergeSplice(splices, index, removed, addedCount) {\n  let splice = newSplice(index, removed, addedCount);\n\n  let inserted = false;\n  let insertionOffset = 0;\n\n  for (let i = 0; i < splices.length; i++) {\n    let current = splices[i];\n    current.index += insertionOffset;\n\n    if (inserted) {\n      continue;\n    }\n\n    let intersectCount = intersect(splice.index, splice.index + splice.removed.length, current.index, current.index + current.addedCount);\n\n    if (intersectCount >= 0) {\n\n      splices.splice(i, 1);\n      i--;\n\n      insertionOffset -= current.addedCount - current.removed.length;\n\n      splice.addedCount += current.addedCount - intersectCount;\n      let deleteCount = splice.removed.length + current.removed.length - intersectCount;\n\n      if (!splice.addedCount && !deleteCount) {\n        inserted = true;\n      } else {\n        let currentRemoved = current.removed;\n\n        if (splice.index < current.index) {\n          let prepend = splice.removed.slice(0, current.index - splice.index);\n          Array.prototype.push.apply(prepend, currentRemoved);\n          currentRemoved = prepend;\n        }\n\n        if (splice.index + splice.removed.length > current.index + current.addedCount) {\n          let append = splice.removed.slice(current.index + current.addedCount - splice.index);\n          Array.prototype.push.apply(currentRemoved, append);\n        }\n\n        splice.removed = currentRemoved;\n        if (current.index < splice.index) {\n          splice.index = current.index;\n        }\n      }\n    } else if (splice.index < current.index) {\n\n      inserted = true;\n\n      splices.splice(i, 0, splice);\n      i++;\n\n      let offset = splice.addedCount - splice.removed.length;\n      current.index += offset;\n      insertionOffset += offset;\n    }\n  }\n\n  if (!inserted) {\n    splices.push(splice);\n  }\n}\n\nfunction createInitialSplices(array, changeRecords) {\n  let splices = [];\n\n  for (let i = 0; i < changeRecords.length; i++) {\n    let record = changeRecords[i];\n    switch (record.type) {\n      case 'splice':\n        mergeSplice(splices, record.index, record.removed.slice(), record.addedCount);\n        break;\n      case 'add':\n      case 'update':\n      case 'delete':\n        if (!isIndex(record.name)) {\n          continue;\n        }\n\n        let index = toNumber(record.name);\n        if (index < 0) {\n          continue;\n        }\n\n        mergeSplice(splices, index, [record.oldValue], record.type === 'delete' ? 0 : 1);\n        break;\n      default:\n        console.error('Unexpected record type: ' + JSON.stringify(record));\n        break;\n    }\n  }\n\n  return splices;\n}\n\nfunction projectArraySplices(array, changeRecords) {\n  let splices = [];\n\n  createInitialSplices(array, changeRecords).forEach(function (splice) {\n    if (splice.addedCount === 1 && splice.removed.length === 1) {\n      if (splice.removed[0] !== array[splice.index]) {\n        splices.push(splice);\n      }\n\n      return;\n    }\n\n    splices = splices.concat(calcSplices(array, splice.index, splice.index + splice.addedCount, splice.removed, 0, splice.removed.length));\n  });\n\n  return splices;\n}\n\nfunction newRecord(type, object, key, oldValue) {\n  return {\n    type: type,\n    object: object,\n    key: key,\n    oldValue: oldValue\n  };\n}\n\nfunction getChangeRecords(map) {\n  let entries = new Array(map.size);\n  let keys = map.keys();\n  let i = 0;\n  let item;\n\n  while (item = keys.next()) {\n    if (item.done) {\n      break;\n    }\n\n    entries[i] = newRecord('added', map, item.value);\n    i++;\n  }\n\n  return entries;\n}\n\nlet ModifyCollectionObserver = (_dec3 = subscriberCollection(), _dec3(_class2 = class ModifyCollectionObserver {\n  constructor(taskQueue, collection) {\n    this.taskQueue = taskQueue;\n    this.queued = false;\n    this.changeRecords = null;\n    this.oldCollection = null;\n    this.collection = collection;\n    this.lengthPropertyName = collection instanceof Map || collection instanceof Set ? 'size' : 'length';\n  }\n\n  subscribe(context, callable) {\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    this.removeSubscriber(context, callable);\n  }\n\n  addChangeRecord(changeRecord) {\n    if (!this.hasSubscribers() && !this.lengthObserver) {\n      return;\n    }\n\n    if (changeRecord.type === 'splice') {\n      let index = changeRecord.index;\n      let arrayLength = changeRecord.object.length;\n      if (index > arrayLength) {\n        index = arrayLength - changeRecord.addedCount;\n      } else if (index < 0) {\n        index = arrayLength + changeRecord.removed.length + index - changeRecord.addedCount;\n      }\n      if (index < 0) {\n        index = 0;\n      }\n      changeRecord.index = index;\n    }\n\n    if (this.changeRecords === null) {\n      this.changeRecords = [changeRecord];\n    } else {\n      this.changeRecords.push(changeRecord);\n    }\n\n    if (!this.queued) {\n      this.queued = true;\n      this.taskQueue.queueMicroTask(this);\n    }\n  }\n\n  flushChangeRecords() {\n    if (this.changeRecords && this.changeRecords.length || this.oldCollection) {\n      this.call();\n    }\n  }\n\n  reset(oldCollection) {\n    this.oldCollection = oldCollection;\n\n    if (this.hasSubscribers() && !this.queued) {\n      this.queued = true;\n      this.taskQueue.queueMicroTask(this);\n    }\n  }\n\n  getLengthObserver() {\n    return this.lengthObserver || (this.lengthObserver = new CollectionLengthObserver(this.collection));\n  }\n\n  call() {\n    let changeRecords = this.changeRecords;\n    let oldCollection = this.oldCollection;\n    let records;\n\n    this.queued = false;\n    this.changeRecords = [];\n    this.oldCollection = null;\n\n    if (this.hasSubscribers()) {\n      if (oldCollection) {\n        if (this.collection instanceof Map || this.collection instanceof Set) {\n          records = getChangeRecords(oldCollection);\n        } else {\n          records = calcSplices(this.collection, 0, this.collection.length, oldCollection, 0, oldCollection.length);\n        }\n      } else {\n        if (this.collection instanceof Map || this.collection instanceof Set) {\n          records = changeRecords;\n        } else {\n          records = projectArraySplices(this.collection, changeRecords);\n        }\n      }\n\n      this.callSubscribers(records);\n    }\n\n    if (this.lengthObserver) {\n      this.lengthObserver.call(this.collection[this.lengthPropertyName]);\n    }\n  }\n}) || _class2);\n\nlet CollectionLengthObserver = (_dec4 = subscriberCollection(), _dec4(_class3 = class CollectionLengthObserver {\n  constructor(collection) {\n    this.collection = collection;\n    this.lengthPropertyName = collection instanceof Map || collection instanceof Set ? 'size' : 'length';\n    this.currentValue = collection[this.lengthPropertyName];\n  }\n\n  getValue() {\n    return this.collection[this.lengthPropertyName];\n  }\n\n  setValue(newValue) {\n    this.collection[this.lengthPropertyName] = newValue;\n  }\n\n  subscribe(context, callable) {\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    this.removeSubscriber(context, callable);\n  }\n\n  call(newValue) {\n    let oldValue = this.currentValue;\n    this.callSubscribers(newValue, oldValue);\n    this.currentValue = newValue;\n  }\n}) || _class3);\n\nconst arrayProto = Array.prototype;\nconst pop = arrayProto.pop;\nconst push = arrayProto.push;\nconst reverse = arrayProto.reverse;\nconst shift = arrayProto.shift;\nconst sort = arrayProto.sort;\nconst splice = arrayProto.splice;\nconst unshift = arrayProto.unshift;\n\nif (arrayProto.__au_patched__) {\n  aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('array-observation').warn('Detected 2nd attempt of patching array from Aurelia binding.' + ' This is probably caused by dependency mismatch between core modules and a 3rd party plugin.' + ' Please see https://github.com/aurelia/cli/pull/906 if you are using webpack.');\n} else {\n  Reflect.defineProperty(arrayProto, '__au_patched__', { value: 1 });\n  arrayProto.pop = function () {\n    let notEmpty = this.length > 0;\n    let methodCallResult = pop.apply(this, arguments);\n    if (notEmpty && this.__array_observer__ !== undefined) {\n      this.__array_observer__.addChangeRecord({\n        type: 'delete',\n        object: this,\n        name: this.length,\n        oldValue: methodCallResult\n      });\n    }\n    return methodCallResult;\n  };\n\n  arrayProto.push = function () {\n    let methodCallResult = push.apply(this, arguments);\n    if (this.__array_observer__ !== undefined) {\n      this.__array_observer__.addChangeRecord({\n        type: 'splice',\n        object: this,\n        index: this.length - arguments.length,\n        removed: [],\n        addedCount: arguments.length\n      });\n    }\n    return methodCallResult;\n  };\n\n  arrayProto.reverse = function () {\n    let oldArray;\n    if (this.__array_observer__ !== undefined) {\n      this.__array_observer__.flushChangeRecords();\n      oldArray = this.slice();\n    }\n    let methodCallResult = reverse.apply(this, arguments);\n    if (this.__array_observer__ !== undefined) {\n      this.__array_observer__.reset(oldArray);\n    }\n    return methodCallResult;\n  };\n\n  arrayProto.shift = function () {\n    let notEmpty = this.length > 0;\n    let methodCallResult = shift.apply(this, arguments);\n    if (notEmpty && this.__array_observer__ !== undefined) {\n      this.__array_observer__.addChangeRecord({\n        type: 'delete',\n        object: this,\n        name: 0,\n        oldValue: methodCallResult\n      });\n    }\n    return methodCallResult;\n  };\n\n  arrayProto.sort = function () {\n    let oldArray;\n    if (this.__array_observer__ !== undefined) {\n      this.__array_observer__.flushChangeRecords();\n      oldArray = this.slice();\n    }\n    let methodCallResult = sort.apply(this, arguments);\n    if (this.__array_observer__ !== undefined) {\n      this.__array_observer__.reset(oldArray);\n    }\n    return methodCallResult;\n  };\n\n  arrayProto.splice = function () {\n    let methodCallResult = splice.apply(this, arguments);\n    if (this.__array_observer__ !== undefined) {\n      this.__array_observer__.addChangeRecord({\n        type: 'splice',\n        object: this,\n        index: +arguments[0],\n        removed: methodCallResult,\n        addedCount: arguments.length > 2 ? arguments.length - 2 : 0\n      });\n    }\n    return methodCallResult;\n  };\n\n  arrayProto.unshift = function () {\n    let methodCallResult = unshift.apply(this, arguments);\n    if (this.__array_observer__ !== undefined) {\n      this.__array_observer__.addChangeRecord({\n        type: 'splice',\n        object: this,\n        index: 0,\n        removed: [],\n        addedCount: arguments.length\n      });\n    }\n    return methodCallResult;\n  };\n}\n\nfunction getArrayObserver(taskQueue, array) {\n  return ModifyArrayObserver.for(taskQueue, array);\n}\n\nlet ModifyArrayObserver = class ModifyArrayObserver extends ModifyCollectionObserver {\n  constructor(taskQueue, array) {\n    super(taskQueue, array);\n  }\n\n  static for(taskQueue, array) {\n    if (!('__array_observer__' in array)) {\n      Reflect.defineProperty(array, '__array_observer__', {\n        value: ModifyArrayObserver.create(taskQueue, array),\n        enumerable: false, configurable: false\n      });\n    }\n    return array.__array_observer__;\n  }\n\n  static create(taskQueue, array) {\n    return new ModifyArrayObserver(taskQueue, array);\n  }\n};\n\n\nlet Expression = class Expression {\n  constructor() {\n    this.isAssignable = false;\n  }\n\n  evaluate(scope, lookupFunctions, args) {\n    throw new Error(`Binding expression \"${this}\" cannot be evaluated.`);\n  }\n\n  assign(scope, value, lookupFunctions) {\n    throw new Error(`Binding expression \"${this}\" cannot be assigned to.`);\n  }\n\n  toString() {\n    return typeof FEATURE_NO_UNPARSER === 'undefined' ? Unparser.unparse(this) : super.toString();\n  }\n};\n\nlet BindingBehavior = class BindingBehavior extends Expression {\n  constructor(expression, name, args) {\n    super();\n\n    this.expression = expression;\n    this.name = name;\n    this.args = args;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    return this.expression.evaluate(scope, lookupFunctions);\n  }\n\n  assign(scope, value, lookupFunctions) {\n    return this.expression.assign(scope, value, lookupFunctions);\n  }\n\n  accept(visitor) {\n    return visitor.visitBindingBehavior(this);\n  }\n\n  connect(binding, scope) {\n    this.expression.connect(binding, scope);\n  }\n\n  bind(binding, scope, lookupFunctions) {\n    if (this.expression.expression && this.expression.bind) {\n      this.expression.bind(binding, scope, lookupFunctions);\n    }\n    let behavior = lookupFunctions.bindingBehaviors(this.name);\n    if (!behavior) {\n      throw new Error(`No BindingBehavior named \"${this.name}\" was found!`);\n    }\n    let behaviorKey = `behavior-${this.name}`;\n    if (binding[behaviorKey]) {\n      throw new Error(`A binding behavior named \"${this.name}\" has already been applied to \"${this.expression}\"`);\n    }\n    binding[behaviorKey] = behavior;\n    behavior.bind.apply(behavior, [binding, scope].concat(evalList(scope, this.args, binding.lookupFunctions)));\n  }\n\n  unbind(binding, scope) {\n    let behaviorKey = `behavior-${this.name}`;\n    binding[behaviorKey].unbind(binding, scope);\n    binding[behaviorKey] = null;\n    if (this.expression.expression && this.expression.unbind) {\n      this.expression.unbind(binding, scope);\n    }\n  }\n};\n\nlet ValueConverter = class ValueConverter extends Expression {\n  constructor(expression, name, args) {\n    super();\n\n    this.expression = expression;\n    this.name = name;\n    this.args = args;\n    this.allArgs = [expression].concat(args);\n  }\n\n  evaluate(scope, lookupFunctions) {\n    let converter = lookupFunctions.valueConverters(this.name);\n    if (!converter) {\n      throw new Error(`No ValueConverter named \"${this.name}\" was found!`);\n    }\n\n    if ('toView' in converter) {\n      return converter.toView.apply(converter, evalList(scope, this.allArgs, lookupFunctions));\n    }\n\n    return this.allArgs[0].evaluate(scope, lookupFunctions);\n  }\n\n  assign(scope, value, lookupFunctions) {\n    let converter = lookupFunctions.valueConverters(this.name);\n    if (!converter) {\n      throw new Error(`No ValueConverter named \"${this.name}\" was found!`);\n    }\n\n    if ('fromView' in converter) {\n      value = converter.fromView.apply(converter, [value].concat(evalList(scope, this.args, lookupFunctions)));\n    }\n\n    return this.allArgs[0].assign(scope, value, lookupFunctions);\n  }\n\n  accept(visitor) {\n    return visitor.visitValueConverter(this);\n  }\n\n  connect(binding, scope) {\n    let expressions = this.allArgs;\n    let i = expressions.length;\n    while (i--) {\n      expressions[i].connect(binding, scope);\n    }\n    let converter = binding.lookupFunctions.valueConverters(this.name);\n    if (!converter) {\n      throw new Error(`No ValueConverter named \"${this.name}\" was found!`);\n    }\n    let signals = converter.signals;\n    if (signals === undefined) {\n      return;\n    }\n    i = signals.length;\n    while (i--) {\n      connectBindingToSignal(binding, signals[i]);\n    }\n  }\n};\n\nlet Assign = class Assign extends Expression {\n  constructor(target, value) {\n    super();\n\n    this.target = target;\n    this.value = value;\n    this.isAssignable = true;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    return this.target.assign(scope, this.value.evaluate(scope, lookupFunctions));\n  }\n\n  accept(vistor) {\n    vistor.visitAssign(this);\n  }\n\n  connect(binding, scope) {}\n\n  assign(scope, value) {\n    this.value.assign(scope, value);\n    this.target.assign(scope, value);\n  }\n};\n\nlet Conditional = class Conditional extends Expression {\n  constructor(condition, yes, no) {\n    super();\n\n    this.condition = condition;\n    this.yes = yes;\n    this.no = no;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    return !!this.condition.evaluate(scope, lookupFunctions) ? this.yes.evaluate(scope, lookupFunctions) : this.no.evaluate(scope, lookupFunctions);\n  }\n\n  accept(visitor) {\n    return visitor.visitConditional(this);\n  }\n\n  connect(binding, scope) {\n    this.condition.connect(binding, scope);\n    if (this.condition.evaluate(scope)) {\n      this.yes.connect(binding, scope);\n    } else {\n      this.no.connect(binding, scope);\n    }\n  }\n};\n\nlet AccessThis = class AccessThis extends Expression {\n  constructor(ancestor) {\n    super();\n    this.ancestor = ancestor;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    let oc = scope.overrideContext;\n    let i = this.ancestor;\n    while (i-- && oc) {\n      oc = oc.parentOverrideContext;\n    }\n    return i < 1 && oc ? oc.bindingContext : undefined;\n  }\n\n  accept(visitor) {\n    return visitor.visitAccessThis(this);\n  }\n\n  connect(binding, scope) {}\n};\n\nlet AccessScope = class AccessScope extends Expression {\n  constructor(name, ancestor) {\n    super();\n\n    this.name = name;\n    this.ancestor = ancestor;\n    this.isAssignable = true;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    let context = getContextFor(this.name, scope, this.ancestor);\n    return context[this.name];\n  }\n\n  assign(scope, value) {\n    let context = getContextFor(this.name, scope, this.ancestor);\n    return context ? context[this.name] = value : undefined;\n  }\n\n  accept(visitor) {\n    return visitor.visitAccessScope(this);\n  }\n\n  connect(binding, scope) {\n    let context = getContextFor(this.name, scope, this.ancestor);\n    binding.observeProperty(context, this.name);\n  }\n};\n\nlet AccessMember = class AccessMember extends Expression {\n  constructor(object, name) {\n    super();\n\n    this.object = object;\n    this.name = name;\n    this.isAssignable = true;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    let instance = this.object.evaluate(scope, lookupFunctions);\n    return instance === null || instance === undefined ? instance : instance[this.name];\n  }\n\n  assign(scope, value) {\n    let instance = this.object.evaluate(scope);\n\n    if (instance === null || instance === undefined) {\n      instance = {};\n      this.object.assign(scope, instance);\n    }\n\n    instance[this.name] = value;\n    return value;\n  }\n\n  accept(visitor) {\n    return visitor.visitAccessMember(this);\n  }\n\n  connect(binding, scope) {\n    this.object.connect(binding, scope);\n    let obj = this.object.evaluate(scope);\n    if (obj) {\n      binding.observeProperty(obj, this.name);\n    }\n  }\n};\n\nlet AccessKeyed = class AccessKeyed extends Expression {\n  constructor(object, key) {\n    super();\n\n    this.object = object;\n    this.key = key;\n    this.isAssignable = true;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    let instance = this.object.evaluate(scope, lookupFunctions);\n    let lookup = this.key.evaluate(scope, lookupFunctions);\n    return getKeyed(instance, lookup);\n  }\n\n  assign(scope, value) {\n    let instance = this.object.evaluate(scope);\n    let lookup = this.key.evaluate(scope);\n    return setKeyed(instance, lookup, value);\n  }\n\n  accept(visitor) {\n    return visitor.visitAccessKeyed(this);\n  }\n\n  connect(binding, scope) {\n    this.object.connect(binding, scope);\n    let obj = this.object.evaluate(scope);\n    if (obj instanceof Object) {\n      this.key.connect(binding, scope);\n      let key = this.key.evaluate(scope);\n\n      if (key !== null && key !== undefined && !(Array.isArray(obj) && typeof key === 'number')) {\n        binding.observeProperty(obj, key);\n      }\n    }\n  }\n};\n\nlet CallScope = class CallScope extends Expression {\n  constructor(name, args, ancestor) {\n    super();\n\n    this.name = name;\n    this.args = args;\n    this.ancestor = ancestor;\n  }\n\n  evaluate(scope, lookupFunctions, mustEvaluate) {\n    let args = evalList(scope, this.args, lookupFunctions);\n    let context = getContextFor(this.name, scope, this.ancestor);\n    let func = getFunction(context, this.name, mustEvaluate);\n    if (func) {\n      return func.apply(context, args);\n    }\n    return undefined;\n  }\n\n  accept(visitor) {\n    return visitor.visitCallScope(this);\n  }\n\n  connect(binding, scope) {\n    let args = this.args;\n    let i = args.length;\n    while (i--) {\n      args[i].connect(binding, scope);\n    }\n  }\n};\n\nlet CallMember = class CallMember extends Expression {\n  constructor(object, name, args) {\n    super();\n\n    this.object = object;\n    this.name = name;\n    this.args = args;\n  }\n\n  evaluate(scope, lookupFunctions, mustEvaluate) {\n    let instance = this.object.evaluate(scope, lookupFunctions);\n    let args = evalList(scope, this.args, lookupFunctions);\n    let func = getFunction(instance, this.name, mustEvaluate);\n    if (func) {\n      return func.apply(instance, args);\n    }\n    return undefined;\n  }\n\n  accept(visitor) {\n    return visitor.visitCallMember(this);\n  }\n\n  connect(binding, scope) {\n    this.object.connect(binding, scope);\n    let obj = this.object.evaluate(scope);\n    if (getFunction(obj, this.name, false)) {\n      let args = this.args;\n      let i = args.length;\n      while (i--) {\n        args[i].connect(binding, scope);\n      }\n    }\n  }\n};\n\nlet CallFunction = class CallFunction extends Expression {\n  constructor(func, args) {\n    super();\n\n    this.func = func;\n    this.args = args;\n  }\n\n  evaluate(scope, lookupFunctions, mustEvaluate) {\n    let func = this.func.evaluate(scope, lookupFunctions);\n    if (typeof func === 'function') {\n      return func.apply(null, evalList(scope, this.args, lookupFunctions));\n    }\n    if (!mustEvaluate && (func === null || func === undefined)) {\n      return undefined;\n    }\n    throw new Error(`${this.func} is not a function`);\n  }\n\n  accept(visitor) {\n    return visitor.visitCallFunction(this);\n  }\n\n  connect(binding, scope) {\n    this.func.connect(binding, scope);\n    let func = this.func.evaluate(scope);\n    if (typeof func === 'function') {\n      let args = this.args;\n      let i = args.length;\n      while (i--) {\n        args[i].connect(binding, scope);\n      }\n    }\n  }\n};\n\nlet Binary = class Binary extends Expression {\n  constructor(operation, left, right) {\n    super();\n\n    this.operation = operation;\n    this.left = left;\n    this.right = right;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    let left = this.left.evaluate(scope, lookupFunctions);\n\n    switch (this.operation) {\n      case '&&':\n        return left && this.right.evaluate(scope, lookupFunctions);\n      case '||':\n        return left || this.right.evaluate(scope, lookupFunctions);\n    }\n\n    let right = this.right.evaluate(scope, lookupFunctions);\n\n    switch (this.operation) {\n      case '==':\n        return left == right;\n      case '===':\n        return left === right;\n      case '!=':\n        return left != right;\n      case '!==':\n        return left !== right;\n      case 'instanceof':\n        return typeof right === 'function' && left instanceof right;\n      case 'in':\n        return typeof right === 'object' && right !== null && left in right;\n    }\n\n    if (left === null || right === null || left === undefined || right === undefined) {\n      switch (this.operation) {\n        case '+':\n          if (left !== null && left !== undefined) return left;\n          if (right !== null && right !== undefined) return right;\n          return 0;\n        case '-':\n          if (left !== null && left !== undefined) return left;\n          if (right !== null && right !== undefined) return 0 - right;\n          return 0;\n      }\n\n      return null;\n    }\n\n    switch (this.operation) {\n      case '+':\n        return autoConvertAdd(left, right);\n      case '-':\n        return left - right;\n      case '*':\n        return left * right;\n      case '/':\n        return left / right;\n      case '%':\n        return left % right;\n      case '<':\n        return left < right;\n      case '>':\n        return left > right;\n      case '<=':\n        return left <= right;\n      case '>=':\n        return left >= right;\n      case '^':\n        return left ^ right;\n    }\n\n    throw new Error(`Internal error [${this.operation}] not handled`);\n  }\n\n  accept(visitor) {\n    return visitor.visitBinary(this);\n  }\n\n  connect(binding, scope) {\n    this.left.connect(binding, scope);\n    let left = this.left.evaluate(scope);\n    if (this.operation === '&&' && !left || this.operation === '||' && left) {\n      return;\n    }\n    this.right.connect(binding, scope);\n  }\n};\n\nlet Unary = class Unary extends Expression {\n  constructor(operation, expression) {\n    super();\n\n    this.operation = operation;\n    this.expression = expression;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    switch (this.operation) {\n      case '!':\n        return !this.expression.evaluate(scope, lookupFunctions);\n      case 'typeof':\n        return typeof this.expression.evaluate(scope, lookupFunctions);\n      case 'void':\n        return void this.expression.evaluate(scope, lookupFunctions);\n    }\n\n    throw new Error(`Internal error [${this.operation}] not handled`);\n  }\n\n  accept(visitor) {\n    return visitor.visitPrefix(this);\n  }\n\n  connect(binding, scope) {\n    this.expression.connect(binding, scope);\n  }\n};\n\nlet LiteralPrimitive = class LiteralPrimitive extends Expression {\n  constructor(value) {\n    super();\n\n    this.value = value;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    return this.value;\n  }\n\n  accept(visitor) {\n    return visitor.visitLiteralPrimitive(this);\n  }\n\n  connect(binding, scope) {}\n};\n\nlet LiteralString = class LiteralString extends Expression {\n  constructor(value) {\n    super();\n\n    this.value = value;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    return this.value;\n  }\n\n  accept(visitor) {\n    return visitor.visitLiteralString(this);\n  }\n\n  connect(binding, scope) {}\n};\n\nlet LiteralTemplate = class LiteralTemplate extends Expression {\n  constructor(cooked, expressions, raw, tag) {\n    super();\n    this.cooked = cooked;\n    this.expressions = expressions || [];\n    this.length = this.expressions.length;\n    this.tagged = tag !== undefined;\n    if (this.tagged) {\n      this.cooked.raw = raw;\n      this.tag = tag;\n      if (tag instanceof AccessScope) {\n        this.contextType = 'Scope';\n      } else if (tag instanceof AccessMember || tag instanceof AccessKeyed) {\n        this.contextType = 'Object';\n      } else {\n        throw new Error(`${this.tag} is not a valid template tag`);\n      }\n    }\n  }\n\n  getScopeContext(scope, lookupFunctions) {\n    return getContextFor(this.tag.name, scope, this.tag.ancestor);\n  }\n\n  getObjectContext(scope, lookupFunctions) {\n    return this.tag.object.evaluate(scope, lookupFunctions);\n  }\n\n  evaluate(scope, lookupFunctions, mustEvaluate) {\n    const results = new Array(this.length);\n    for (let i = 0; i < this.length; i++) {\n      results[i] = this.expressions[i].evaluate(scope, lookupFunctions);\n    }\n    if (this.tagged) {\n      const func = this.tag.evaluate(scope, lookupFunctions);\n      if (typeof func === 'function') {\n        const context = this[`get${this.contextType}Context`](scope, lookupFunctions);\n        return func.call(context, this.cooked, ...results);\n      }\n      if (!mustEvaluate) {\n        return null;\n      }\n      throw new Error(`${this.tag} is not a function`);\n    }\n    let result = this.cooked[0];\n    for (let i = 0; i < this.length; i++) {\n      result = String.prototype.concat(result, results[i], this.cooked[i + 1]);\n    }\n    return result;\n  }\n\n  accept(visitor) {\n    return visitor.visitLiteralTemplate(this);\n  }\n\n  connect(binding, scope) {\n    for (let i = 0; i < this.length; i++) {\n      this.expressions[i].connect(binding, scope);\n    }\n    if (this.tagged) {\n      this.tag.connect(binding, scope);\n    }\n  }\n};\n\nlet LiteralArray = class LiteralArray extends Expression {\n  constructor(elements) {\n    super();\n\n    this.elements = elements;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    let elements = this.elements;\n    let result = [];\n\n    for (let i = 0, length = elements.length; i < length; ++i) {\n      result[i] = elements[i].evaluate(scope, lookupFunctions);\n    }\n\n    return result;\n  }\n\n  accept(visitor) {\n    return visitor.visitLiteralArray(this);\n  }\n\n  connect(binding, scope) {\n    let length = this.elements.length;\n    for (let i = 0; i < length; i++) {\n      this.elements[i].connect(binding, scope);\n    }\n  }\n};\n\nlet LiteralObject = class LiteralObject extends Expression {\n  constructor(keys, values) {\n    super();\n\n    this.keys = keys;\n    this.values = values;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    let instance = {};\n    let keys = this.keys;\n    let values = this.values;\n\n    for (let i = 0, length = keys.length; i < length; ++i) {\n      instance[keys[i]] = values[i].evaluate(scope, lookupFunctions);\n    }\n\n    return instance;\n  }\n\n  accept(visitor) {\n    return visitor.visitLiteralObject(this);\n  }\n\n  connect(binding, scope) {\n    let length = this.keys.length;\n    for (let i = 0; i < length; i++) {\n      this.values[i].connect(binding, scope);\n    }\n  }\n};\n\nfunction evalList(scope, list, lookupFunctions) {\n  const length = list.length;\n  const result = [];\n  for (let i = 0; i < length; i++) {\n    result[i] = list[i].evaluate(scope, lookupFunctions);\n  }\n  return result;\n}\n\nfunction autoConvertAdd(a, b) {\n  if (a !== null && b !== null) {\n    if (typeof a === 'string' && typeof b !== 'string') {\n      return a + b.toString();\n    }\n\n    if (typeof a !== 'string' && typeof b === 'string') {\n      return a.toString() + b;\n    }\n\n    return a + b;\n  }\n\n  if (a !== null) {\n    return a;\n  }\n\n  if (b !== null) {\n    return b;\n  }\n\n  return 0;\n}\n\nfunction getFunction(obj, name, mustExist) {\n  let func = obj === null || obj === undefined ? null : obj[name];\n  if (typeof func === 'function') {\n    return func;\n  }\n  if (!mustExist && (func === null || func === undefined)) {\n    return null;\n  }\n  throw new Error(`${name} is not a function`);\n}\n\nfunction getKeyed(obj, key) {\n  if (Array.isArray(obj)) {\n    return obj[parseInt(key, 10)];\n  } else if (obj) {\n    return obj[key];\n  } else if (obj === null || obj === undefined) {\n    return undefined;\n  }\n\n  return obj[key];\n}\n\nfunction setKeyed(obj, key, value) {\n  if (Array.isArray(obj)) {\n    let index = parseInt(key, 10);\n\n    if (obj.length <= index) {\n      obj.length = index + 1;\n    }\n\n    obj[index] = value;\n  } else {\n    obj[key] = value;\n  }\n\n  return value;\n}\n\nlet Unparser = null;\n\nif (typeof FEATURE_NO_UNPARSER === 'undefined') {\n  Unparser = class {\n    constructor(buffer) {\n      this.buffer = buffer;\n    }\n\n    static unparse(expression) {\n      let buffer = [];\n      let visitor = new Unparser(buffer);\n\n      expression.accept(visitor);\n\n      return buffer.join('');\n    }\n\n    write(text) {\n      this.buffer.push(text);\n    }\n\n    writeArgs(args) {\n      this.write('(');\n\n      for (let i = 0, length = args.length; i < length; ++i) {\n        if (i !== 0) {\n          this.write(',');\n        }\n\n        args[i].accept(this);\n      }\n\n      this.write(')');\n    }\n\n    visitBindingBehavior(behavior) {\n      let args = behavior.args;\n\n      behavior.expression.accept(this);\n      this.write(`&${behavior.name}`);\n\n      for (let i = 0, length = args.length; i < length; ++i) {\n        this.write(':');\n        args[i].accept(this);\n      }\n    }\n\n    visitValueConverter(converter) {\n      let args = converter.args;\n\n      converter.expression.accept(this);\n      this.write(`|${converter.name}`);\n\n      for (let i = 0, length = args.length; i < length; ++i) {\n        this.write(':');\n        args[i].accept(this);\n      }\n    }\n\n    visitAssign(assign) {\n      assign.target.accept(this);\n      this.write('=');\n      assign.value.accept(this);\n    }\n\n    visitConditional(conditional) {\n      conditional.condition.accept(this);\n      this.write('?');\n      conditional.yes.accept(this);\n      this.write(':');\n      conditional.no.accept(this);\n    }\n\n    visitAccessThis(access) {\n      if (access.ancestor === 0) {\n        this.write('$this');\n        return;\n      }\n      this.write('$parent');\n      let i = access.ancestor - 1;\n      while (i--) {\n        this.write('.$parent');\n      }\n    }\n\n    visitAccessScope(access) {\n      let i = access.ancestor;\n      while (i--) {\n        this.write('$parent.');\n      }\n      this.write(access.name);\n    }\n\n    visitAccessMember(access) {\n      access.object.accept(this);\n      this.write(`.${access.name}`);\n    }\n\n    visitAccessKeyed(access) {\n      access.object.accept(this);\n      this.write('[');\n      access.key.accept(this);\n      this.write(']');\n    }\n\n    visitCallScope(call) {\n      let i = call.ancestor;\n      while (i--) {\n        this.write('$parent.');\n      }\n      this.write(call.name);\n      this.writeArgs(call.args);\n    }\n\n    visitCallFunction(call) {\n      call.func.accept(this);\n      this.writeArgs(call.args);\n    }\n\n    visitCallMember(call) {\n      call.object.accept(this);\n      this.write(`.${call.name}`);\n      this.writeArgs(call.args);\n    }\n\n    visitPrefix(prefix) {\n      this.write(`(${prefix.operation}`);\n      if (prefix.operation.charCodeAt(0) >= 97) {\n        this.write(' ');\n      }\n      prefix.expression.accept(this);\n      this.write(')');\n    }\n\n    visitBinary(binary) {\n      binary.left.accept(this);\n      if (binary.operation.charCodeAt(0) === 105) {\n        this.write(` ${binary.operation} `);\n      } else {\n        this.write(binary.operation);\n      }\n      binary.right.accept(this);\n    }\n\n    visitLiteralPrimitive(literal) {\n      this.write(`${literal.value}`);\n    }\n\n    visitLiteralArray(literal) {\n      let elements = literal.elements;\n\n      this.write('[');\n\n      for (let i = 0, length = elements.length; i < length; ++i) {\n        if (i !== 0) {\n          this.write(',');\n        }\n\n        elements[i].accept(this);\n      }\n\n      this.write(']');\n    }\n\n    visitLiteralObject(literal) {\n      let keys = literal.keys;\n      let values = literal.values;\n\n      this.write('{');\n\n      for (let i = 0, length = keys.length; i < length; ++i) {\n        if (i !== 0) {\n          this.write(',');\n        }\n\n        this.write(`'${keys[i]}':`);\n        values[i].accept(this);\n      }\n\n      this.write('}');\n    }\n\n    visitLiteralString(literal) {\n      let escaped = literal.value.replace(/'/g, \"\\'\");\n      this.write(`'${escaped}'`);\n    }\n\n    visitLiteralTemplate(literal) {\n      const { cooked, expressions } = literal;\n      const length = expressions.length;\n      this.write('`');\n      this.write(cooked[0]);\n      for (let i = 0; i < length; i++) {\n        expressions[i].accept(this);\n        this.write(cooked[i + 1]);\n      }\n      this.write('`');\n    }\n  };\n}\n\nlet ExpressionCloner = class ExpressionCloner {\n  cloneExpressionArray(array) {\n    let clonedArray = [];\n    let i = array.length;\n    while (i--) {\n      clonedArray[i] = array[i].accept(this);\n    }\n    return clonedArray;\n  }\n\n  visitBindingBehavior(behavior) {\n    return new BindingBehavior(behavior.expression.accept(this), behavior.name, this.cloneExpressionArray(behavior.args));\n  }\n\n  visitValueConverter(converter) {\n    return new ValueConverter(converter.expression.accept(this), converter.name, this.cloneExpressionArray(converter.args));\n  }\n\n  visitAssign(assign) {\n    return new Assign(assign.target.accept(this), assign.value.accept(this));\n  }\n\n  visitConditional(conditional) {\n    return new Conditional(conditional.condition.accept(this), conditional.yes.accept(this), conditional.no.accept(this));\n  }\n\n  visitAccessThis(access) {\n    return new AccessThis(access.ancestor);\n  }\n\n  visitAccessScope(access) {\n    return new AccessScope(access.name, access.ancestor);\n  }\n\n  visitAccessMember(access) {\n    return new AccessMember(access.object.accept(this), access.name);\n  }\n\n  visitAccessKeyed(access) {\n    return new AccessKeyed(access.object.accept(this), access.key.accept(this));\n  }\n\n  visitCallScope(call) {\n    return new CallScope(call.name, this.cloneExpressionArray(call.args), call.ancestor);\n  }\n\n  visitCallFunction(call) {\n    return new CallFunction(call.func.accept(this), this.cloneExpressionArray(call.args));\n  }\n\n  visitCallMember(call) {\n    return new CallMember(call.object.accept(this), call.name, this.cloneExpressionArray(call.args));\n  }\n\n  visitUnary(unary) {\n    return new Unary(prefix.operation, prefix.expression.accept(this));\n  }\n\n  visitBinary(binary) {\n    return new Binary(binary.operation, binary.left.accept(this), binary.right.accept(this));\n  }\n\n  visitLiteralPrimitive(literal) {\n    return new LiteralPrimitive(literal);\n  }\n\n  visitLiteralArray(literal) {\n    return new LiteralArray(this.cloneExpressionArray(literal.elements));\n  }\n\n  visitLiteralObject(literal) {\n    return new LiteralObject(literal.keys, this.cloneExpressionArray(literal.values));\n  }\n\n  visitLiteralString(literal) {\n    return new LiteralString(literal.value);\n  }\n\n  visitLiteralTemplate(literal) {\n    return new LiteralTemplate(literal.cooked, this.cloneExpressionArray(literal.expressions), literal.raw, literal.tag && literal.tag.accept(this));\n  }\n};\n\nfunction cloneExpression(expression) {\n  let visitor = new ExpressionCloner();\n  return expression.accept(visitor);\n}\n\nconst bindingMode = {\n  oneTime: 0,\n  toView: 1,\n  oneWay: 1,\n  twoWay: 2,\n  fromView: 3\n};\n\nlet Parser = class Parser {\n  constructor() {\n    this.cache = Object.create(null);\n  }\n\n  parse(src) {\n    src = src || '';\n\n    return this.cache[src] || (this.cache[src] = new ParserImplementation(src).parseBindingBehavior());\n  }\n};\n\nconst fromCharCode = String.fromCharCode;\n\nlet ParserImplementation = class ParserImplementation {\n  get raw() {\n    return this.src.slice(this.start, this.idx);\n  }\n\n  constructor(src) {\n    this.idx = 0;\n\n    this.start = 0;\n\n    this.src = src;\n    this.len = src.length;\n\n    this.tkn = T$EOF;\n\n    this.val = undefined;\n\n    this.ch = src.charCodeAt(0);\n  }\n\n  parseBindingBehavior() {\n    this.nextToken();\n    if (this.tkn & T$ExpressionTerminal) {\n      this.err('Invalid start of expression');\n    }\n    let result = this.parseValueConverter();\n    while (this.opt(T$Ampersand)) {\n      result = new BindingBehavior(result, this.val, this.parseVariadicArgs());\n    }\n    if (this.tkn !== T$EOF) {\n      this.err(`Unconsumed token ${this.raw}`);\n    }\n    return result;\n  }\n\n  parseValueConverter() {\n    let result = this.parseExpression();\n    while (this.opt(T$Bar)) {\n      result = new ValueConverter(result, this.val, this.parseVariadicArgs());\n    }\n    return result;\n  }\n\n  parseVariadicArgs() {\n    this.nextToken();\n    const result = [];\n    while (this.opt(T$Colon)) {\n      result.push(this.parseExpression());\n    }\n    return result;\n  }\n\n  parseExpression() {\n    let exprStart = this.idx;\n    let result = this.parseConditional();\n\n    while (this.tkn === T$Eq) {\n      if (!result.isAssignable) {\n        this.err(`Expression ${this.src.slice(exprStart, this.start)} is not assignable`);\n      }\n      this.nextToken();\n      exprStart = this.idx;\n      result = new Assign(result, this.parseConditional());\n    }\n    return result;\n  }\n\n  parseConditional() {\n    let result = this.parseBinary(0);\n\n    if (this.opt(T$Question)) {\n      let yes = this.parseExpression();\n      this.expect(T$Colon);\n      result = new Conditional(result, yes, this.parseExpression());\n    }\n    return result;\n  }\n\n  parseBinary(minPrecedence) {\n    let left = this.parseLeftHandSide(0);\n\n    while (this.tkn & T$BinaryOp) {\n      const opToken = this.tkn;\n      if ((opToken & T$Precedence) <= minPrecedence) {\n        break;\n      }\n      this.nextToken();\n      left = new Binary(TokenValues[opToken & T$TokenMask], left, this.parseBinary(opToken & T$Precedence));\n    }\n    return left;\n  }\n\n  parseLeftHandSide(context) {\n    let result;\n\n    primary: switch (this.tkn) {\n      case T$Plus:\n        this.nextToken();\n        return this.parseLeftHandSide(0);\n      case T$Minus:\n        this.nextToken();\n        return new Binary('-', new LiteralPrimitive(0), this.parseLeftHandSide(0));\n      case T$Bang:\n      case T$TypeofKeyword:\n      case T$VoidKeyword:\n        const op = TokenValues[this.tkn & T$TokenMask];\n        this.nextToken();\n        return new Unary(op, this.parseLeftHandSide(0));\n      case T$ParentScope:\n        {\n          do {\n            this.nextToken();\n            context++;\n            if (this.opt(T$Period)) {\n              if (this.tkn === T$Period) {\n                this.err();\n              }\n              continue;\n            } else if (this.tkn & T$AccessScopeTerminal) {\n              result = new AccessThis(context & C$Ancestor);\n\n              context = context & C$ShorthandProp | C$This;\n              break primary;\n            } else {\n              this.err();\n            }\n          } while (this.tkn === T$ParentScope);\n        }\n\n      case T$Identifier:\n        {\n          result = new AccessScope(this.val, context & C$Ancestor);\n          this.nextToken();\n          context = context & C$ShorthandProp | C$Scope;\n          break;\n        }\n      case T$ThisScope:\n        this.nextToken();\n        result = new AccessThis(0);\n        context = context & C$ShorthandProp | C$This;\n        break;\n      case T$LParen:\n        this.nextToken();\n        result = this.parseExpression();\n        this.expect(T$RParen);\n        context = C$Primary;\n        break;\n      case T$LBracket:\n        {\n          this.nextToken();\n          const elements = [];\n          if (this.tkn !== T$RBracket) {\n            do {\n              elements.push(this.parseExpression());\n            } while (this.opt(T$Comma));\n          }\n          this.expect(T$RBracket);\n          result = new LiteralArray(elements);\n          context = C$Primary;\n          break;\n        }\n      case T$LBrace:\n        {\n          const keys = [];\n          const values = [];\n          this.nextToken();\n          while (this.tkn !== T$RBrace) {\n            if (this.tkn & T$IdentifierOrKeyword) {\n              const { ch, tkn, idx } = this;\n              keys.push(this.val);\n              this.nextToken();\n              if (this.opt(T$Colon)) {\n                values.push(this.parseExpression());\n              } else {\n                this.ch = ch;\n                this.tkn = tkn;\n                this.idx = idx;\n                values.push(this.parseLeftHandSide(C$ShorthandProp));\n              }\n            } else if (this.tkn & T$Literal) {\n              keys.push(this.val);\n              this.nextToken();\n              this.expect(T$Colon);\n              values.push(this.parseExpression());\n            } else {\n              this.err();\n            }\n            if (this.tkn !== T$RBrace) {\n              this.expect(T$Comma);\n            }\n          }\n          this.expect(T$RBrace);\n          result = new LiteralObject(keys, values);\n          context = C$Primary;\n          break;\n        }\n      case T$StringLiteral:\n        result = new LiteralString(this.val);\n        this.nextToken();\n        context = C$Primary;\n        break;\n      case T$TemplateTail:\n        result = new LiteralTemplate([this.val]);\n        this.nextToken();\n        context = C$Primary;\n        break;\n      case T$TemplateContinuation:\n        result = this.parseTemplate(0);\n        context = C$Primary;\n        break;\n      case T$NumericLiteral:\n        {\n          result = new LiteralPrimitive(this.val);\n          this.nextToken();\n\n          break;\n        }\n      case T$NullKeyword:\n      case T$UndefinedKeyword:\n      case T$TrueKeyword:\n      case T$FalseKeyword:\n        result = new LiteralPrimitive(TokenValues[this.tkn & T$TokenMask]);\n        this.nextToken();\n        context = C$Primary;\n        break;\n      default:\n        if (this.idx >= this.len) {\n          this.err('Unexpected end of expression');\n        } else {\n          this.err();\n        }\n    }\n\n    if (context & C$ShorthandProp) {\n      return result;\n    }\n\n    let name = this.val;\n    while (this.tkn & T$MemberOrCallExpression) {\n      switch (this.tkn) {\n        case T$Period:\n          this.nextToken();\n          if (!(this.tkn & T$IdentifierOrKeyword)) {\n            this.err();\n          }\n          name = this.val;\n          this.nextToken();\n\n          context = context & C$Primary | (context & (C$This | C$Scope)) << 1 | context & C$Member | (context & C$Keyed) >> 1 | (context & C$Call) >> 2;\n          if (this.tkn === T$LParen) {\n            continue;\n          }\n          if (context & C$Scope) {\n            result = new AccessScope(name, result.ancestor);\n          } else {\n            result = new AccessMember(result, name);\n          }\n          continue;\n        case T$LBracket:\n          this.nextToken();\n          context = C$Keyed;\n          result = new AccessKeyed(result, this.parseExpression());\n          this.expect(T$RBracket);\n          break;\n        case T$LParen:\n          this.nextToken();\n          const args = [];\n          while (this.tkn !== T$RParen) {\n            args.push(this.parseExpression());\n            if (!this.opt(T$Comma)) {\n              break;\n            }\n          }\n          this.expect(T$RParen);\n          if (context & C$Scope) {\n            result = new CallScope(name, args, result.ancestor);\n          } else if (context & (C$Member | C$Primary)) {\n            result = new CallMember(result, name, args);\n          } else {\n            result = new CallFunction(result, args);\n          }\n          context = C$Call;\n          break;\n        case T$TemplateTail:\n          result = new LiteralTemplate([this.val], [], [this.raw], result);\n          this.nextToken();\n          break;\n        case T$TemplateContinuation:\n          result = this.parseTemplate(context | C$Tagged, result);\n      }\n    }\n\n    return result;\n  }\n\n  parseTemplate(context, func) {\n    const cooked = [this.val];\n    const raw = context & C$Tagged ? [this.raw] : undefined;\n    this.expect(T$TemplateContinuation);\n    const expressions = [this.parseExpression()];\n\n    while ((this.tkn = this.scanTemplateTail()) !== T$TemplateTail) {\n      cooked.push(this.val);\n      if (context & C$Tagged) {\n        raw.push(this.raw);\n      }\n      this.expect(T$TemplateContinuation);\n      expressions.push(this.parseExpression());\n    }\n\n    cooked.push(this.val);\n    if (context & C$Tagged) {\n      raw.push(this.raw);\n    }\n    this.nextToken();\n    return new LiteralTemplate(cooked, expressions, raw, func);\n  }\n\n  nextToken() {\n    while (this.idx < this.len) {\n      if (this.ch <= 0x20) {\n        this.next();\n        continue;\n      }\n      this.start = this.idx;\n      if (this.ch === 0x24 || this.ch >= 0x61 && this.ch <= 0x7A) {\n        this.tkn = this.scanIdentifier();\n        return;\n      }\n\n      if ((this.tkn = CharScanners[this.ch](this)) !== null) {\n        return;\n      }\n    }\n    this.tkn = T$EOF;\n  }\n\n  next() {\n    return this.ch = this.src.charCodeAt(++this.idx);\n  }\n\n  scanIdentifier() {\n    while (AsciiIdParts.has(this.next()) || this.ch > 0x7F && IdParts[this.ch]) {}\n\n    return KeywordLookup[this.val = this.raw] || T$Identifier;\n  }\n\n  scanNumber(isFloat) {\n    if (isFloat) {\n      this.val = 0;\n    } else {\n      this.val = this.ch - 0x30;\n      while (this.next() <= 0x39 && this.ch >= 0x30) {\n        this.val = this.val * 10 + this.ch - 0x30;\n      }\n    }\n\n    if (isFloat || this.ch === 0x2E) {\n      if (!isFloat) {\n        this.next();\n      }\n      const start = this.idx;\n      let value = this.ch - 0x30;\n      while (this.next() <= 0x39 && this.ch >= 0x30) {\n        value = value * 10 + this.ch - 0x30;\n      }\n      this.val = this.val + value / Math.pow(10, this.idx - start);\n    }\n\n    if (this.ch === 0x65 || this.ch === 0x45) {\n      const start = this.idx;\n\n      this.next();\n      if (this.ch === 0x2D || this.ch === 0x2B) {\n        this.next();\n      }\n\n      if (!(this.ch >= 0x30 && this.ch <= 0x39)) {\n        this.idx = start;\n        this.err('Invalid exponent');\n      }\n      while (this.next() <= 0x39 && this.ch >= 0x30) {}\n      this.val = parseFloat(this.src.slice(this.start, this.idx));\n    }\n\n    return T$NumericLiteral;\n  }\n\n  scanString() {\n    let quote = this.ch;\n    this.next();\n\n    let buffer;\n    let marker = this.idx;\n\n    while (this.ch !== quote) {\n      if (this.ch === 0x5C) {\n        if (!buffer) {\n          buffer = [];\n        }\n\n        buffer.push(this.src.slice(marker, this.idx));\n\n        this.next();\n\n        let unescaped;\n\n        if (this.ch === 0x75) {\n          this.next();\n\n          if (this.idx + 4 < this.len) {\n            let hex = this.src.slice(this.idx, this.idx + 4);\n\n            if (!/[A-Z0-9]{4}/i.test(hex)) {\n              this.err(`Invalid unicode escape [\\\\u${hex}]`);\n            }\n\n            unescaped = parseInt(hex, 16);\n            this.idx += 4;\n            this.ch = this.src.charCodeAt(this.idx);\n          } else {\n            this.err();\n          }\n        } else {\n          unescaped = unescape(this.ch);\n          this.next();\n        }\n\n        buffer.push(fromCharCode(unescaped));\n        marker = this.idx;\n      } else if (this.ch === 0 || this.idx >= this.len) {\n        this.err('Unterminated quote');\n      } else {\n        this.next();\n      }\n    }\n\n    let last = this.src.slice(marker, this.idx);\n    this.next();\n    let unescaped = last;\n\n    if (buffer !== null && buffer !== undefined) {\n      buffer.push(last);\n      unescaped = buffer.join('');\n    }\n\n    this.val = unescaped;\n    return T$StringLiteral;\n  }\n\n  scanTemplate() {\n    let tail = true;\n    let result = '';\n\n    while (this.next() !== 0x60) {\n      if (this.ch === 0x24) {\n        if (this.idx + 1 < this.len && this.src.charCodeAt(this.idx + 1) === 0x7B) {\n          this.idx++;\n          tail = false;\n          break;\n        } else {\n          result += '$';\n        }\n      } else if (this.ch === 0x5C) {\n        result += fromCharCode(unescape(this.next()));\n      } else if (this.ch === 0 || this.idx >= this.len) {\n        this.err('Unterminated template literal');\n      } else {\n        result += fromCharCode(this.ch);\n      }\n    }\n\n    this.next();\n    this.val = result;\n    if (tail) {\n      return T$TemplateTail;\n    }\n    return T$TemplateContinuation;\n  }\n\n  scanTemplateTail() {\n    if (this.idx >= this.len) {\n      this.err('Unterminated template');\n    }\n    this.idx--;\n    return this.scanTemplate();\n  }\n\n  err(message = `Unexpected token ${this.raw}`, column = this.start) {\n    throw new Error(`Parser Error: ${message} at column ${column} in expression [${this.src}]`);\n  }\n\n  opt(token) {\n    if (this.tkn === token) {\n      this.nextToken();\n      return true;\n    }\n\n    return false;\n  }\n\n  expect(token) {\n    if (this.tkn === token) {\n      this.nextToken();\n    } else {\n      this.err(`Missing expected token ${TokenValues[token & T$TokenMask]}`, this.idx);\n    }\n  }\n};\n\nfunction unescape(code) {\n  switch (code) {\n    case 0x66:\n      return 0xC;\n    case 0x6E:\n      return 0xA;\n    case 0x72:\n      return 0xD;\n    case 0x74:\n      return 0x9;\n    case 0x76:\n      return 0xB;\n    default:\n      return code;\n  }\n}\n\nconst C$This = 1 << 10;\nconst C$Scope = 1 << 11;\nconst C$Member = 1 << 12;\nconst C$Keyed = 1 << 13;\nconst C$Call = 1 << 14;\nconst C$Primary = 1 << 15;\nconst C$ShorthandProp = 1 << 16;\nconst C$Tagged = 1 << 17;\n\nconst C$Ancestor = (1 << 9) - 1;\n\nconst T$TokenMask = (1 << 6) - 1;\n\nconst T$PrecShift = 6;\n\nconst T$Precedence = 7 << T$PrecShift;\n\nconst T$ExpressionTerminal = 1 << 11;\n\nconst T$ClosingToken = 1 << 12;\n\nconst T$OpeningToken = 1 << 13;\n\nconst T$AccessScopeTerminal = 1 << 14;\nconst T$Keyword = 1 << 15;\nconst T$EOF = 1 << 16 | T$AccessScopeTerminal | T$ExpressionTerminal;\nconst T$Identifier = 1 << 17;\nconst T$IdentifierOrKeyword = T$Identifier | T$Keyword;\nconst T$Literal = 1 << 18;\nconst T$NumericLiteral = 1 << 19 | T$Literal;\nconst T$StringLiteral = 1 << 20 | T$Literal;\nconst T$BinaryOp = 1 << 21;\n\nconst T$UnaryOp = 1 << 22;\n\nconst T$MemberExpression = 1 << 23;\n\nconst T$MemberOrCallExpression = 1 << 24;\nconst T$TemplateTail = 1 << 25 | T$MemberOrCallExpression;\nconst T$TemplateContinuation = 1 << 26 | T$MemberOrCallExpression;\n\nconst T$FalseKeyword = 0 | T$Keyword | T$Literal;\nconst T$TrueKeyword = 1 | T$Keyword | T$Literal;\nconst T$NullKeyword = 2 | T$Keyword | T$Literal;\nconst T$UndefinedKeyword = 3 | T$Keyword | T$Literal;\nconst T$ThisScope = 4 | T$IdentifierOrKeyword;\nconst T$ParentScope = 5 | T$IdentifierOrKeyword;\n\nconst T$LParen = 6 | T$OpeningToken | T$AccessScopeTerminal | T$MemberOrCallExpression;\nconst T$LBrace = 7 | T$OpeningToken;\nconst T$Period = 8 | T$MemberExpression | T$MemberOrCallExpression;\nconst T$RBrace = 9 | T$AccessScopeTerminal | T$ClosingToken | T$ExpressionTerminal;\nconst T$RParen = 10 | T$AccessScopeTerminal | T$ClosingToken | T$ExpressionTerminal;\nconst T$Comma = 11 | T$AccessScopeTerminal;\nconst T$LBracket = 12 | T$OpeningToken | T$AccessScopeTerminal | T$MemberExpression | T$MemberOrCallExpression;\nconst T$RBracket = 13 | T$ClosingToken | T$ExpressionTerminal;\nconst T$Colon = 14 | T$AccessScopeTerminal;\nconst T$Question = 15;\n\nconst T$Ampersand = 18 | T$AccessScopeTerminal;\nconst T$Bar = 19 | T$AccessScopeTerminal;\nconst T$BarBar = 20 | 1 << T$PrecShift | T$BinaryOp;\nconst T$AmpersandAmpersand = 21 | 2 << T$PrecShift | T$BinaryOp;\nconst T$Caret = 22 | 3 << T$PrecShift | T$BinaryOp;\nconst T$EqEq = 23 | 4 << T$PrecShift | T$BinaryOp;\nconst T$BangEq = 24 | 4 << T$PrecShift | T$BinaryOp;\nconst T$EqEqEq = 25 | 4 << T$PrecShift | T$BinaryOp;\nconst T$BangEqEq = 26 | 4 << T$PrecShift | T$BinaryOp;\nconst T$Lt = 27 | 5 << T$PrecShift | T$BinaryOp;\nconst T$Gt = 28 | 5 << T$PrecShift | T$BinaryOp;\nconst T$LtEq = 29 | 5 << T$PrecShift | T$BinaryOp;\nconst T$GtEq = 30 | 5 << T$PrecShift | T$BinaryOp;\nconst T$InKeyword = 31 | 5 << T$PrecShift | T$BinaryOp | T$Keyword;\nconst T$InstanceOfKeyword = 32 | 5 << T$PrecShift | T$BinaryOp | T$Keyword;\nconst T$Plus = 33 | 6 << T$PrecShift | T$BinaryOp | T$UnaryOp;\nconst T$Minus = 34 | 6 << T$PrecShift | T$BinaryOp | T$UnaryOp;\nconst T$TypeofKeyword = 35 | T$UnaryOp | T$Keyword;\nconst T$VoidKeyword = 36 | T$UnaryOp | T$Keyword;\nconst T$Star = 37 | 7 << T$PrecShift | T$BinaryOp;\nconst T$Percent = 38 | 7 << T$PrecShift | T$BinaryOp;\nconst T$Slash = 39 | 7 << T$PrecShift | T$BinaryOp;\nconst T$Eq = 40;\nconst T$Bang = 41 | T$UnaryOp;\n\nconst KeywordLookup = Object.create(null);\nKeywordLookup.true = T$TrueKeyword;\nKeywordLookup.null = T$NullKeyword;\nKeywordLookup.false = T$FalseKeyword;\nKeywordLookup.undefined = T$UndefinedKeyword;\nKeywordLookup.$this = T$ThisScope;\nKeywordLookup.$parent = T$ParentScope;\nKeywordLookup.in = T$InKeyword;\nKeywordLookup.instanceof = T$InstanceOfKeyword;\nKeywordLookup.typeof = T$TypeofKeyword;\nKeywordLookup.void = T$VoidKeyword;\n\nconst TokenValues = [false, true, null, undefined, '$this', '$parent', '(', '{', '.', '}', ')', ',', '[', ']', ':', '?', '\\'', '\"', '&', '|', '||', '&&', '^', '==', '!=', '===', '!==', '<', '>', '<=', '>=', 'in', 'instanceof', '+', '-', 'typeof', 'void', '*', '%', '/', '=', '!'];\n\nconst codes = {\n  AsciiIdPart: [0x24, 0, 0x30, 0x3A, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B],\n  IdStart: [0x24, 0, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B, 0xAA, 0, 0xBA, 0, 0xC0, 0xD7, 0xD8, 0xF7, 0xF8, 0x2B9, 0x2E0, 0x2E5, 0x1D00, 0x1D26, 0x1D2C, 0x1D5D, 0x1D62, 0x1D66, 0x1D6B, 0x1D78, 0x1D79, 0x1DBF, 0x1E00, 0x1F00, 0x2071, 0, 0x207F, 0, 0x2090, 0x209D, 0x212A, 0x212C, 0x2132, 0, 0x214E, 0, 0x2160, 0x2189, 0x2C60, 0x2C80, 0xA722, 0xA788, 0xA78B, 0xA7AF, 0xA7B0, 0xA7B8, 0xA7F7, 0xA800, 0xAB30, 0xAB5B, 0xAB5C, 0xAB65, 0xFB00, 0xFB07, 0xFF21, 0xFF3B, 0xFF41, 0xFF5B],\n  Digit: [0x30, 0x3A],\n  Skip: [0, 0x21, 0x7F, 0xA1]\n};\n\nfunction decompress(lookup, set, compressed, value) {\n  let rangeCount = compressed.length;\n  for (let i = 0; i < rangeCount; i += 2) {\n    const start = compressed[i];\n    let end = compressed[i + 1];\n    end = end > 0 ? end : start + 1;\n    if (lookup) {\n      let j = start;\n      while (j < end) {\n        lookup[j] = value;\n        j++;\n      }\n    }\n    if (set) {\n      for (let ch = start; ch < end; ch++) {\n        set.add(ch);\n      }\n    }\n  }\n}\n\nfunction returnToken(token) {\n  return p => {\n    p.next();\n    return token;\n  };\n}\nfunction unexpectedCharacter(p) {\n  p.err(`Unexpected character [${fromCharCode(p.ch)}]`);\n  return null;\n}\n\nconst AsciiIdParts = new Set();\ndecompress(null, AsciiIdParts, codes.AsciiIdPart, true);\n\nconst IdParts = new Uint8Array(0xFFFF);\ndecompress(IdParts, null, codes.IdStart, 1);\ndecompress(IdParts, null, codes.Digit, 1);\n\nconst CharScanners = new Array(0xFFFF);\nlet ci = 0;\nwhile (ci < 0xFFFF) {\n  CharScanners[ci] = unexpectedCharacter;\n  ci++;\n}\n\ndecompress(CharScanners, null, codes.Skip, p => {\n  p.next();\n  return null;\n});\ndecompress(CharScanners, null, codes.IdStart, p => p.scanIdentifier());\ndecompress(CharScanners, null, codes.Digit, p => p.scanNumber(false));\n\nCharScanners[0x22] = CharScanners[0x27] = p => {\n  return p.scanString();\n};\nCharScanners[0x60] = p => {\n  return p.scanTemplate();\n};\n\nCharScanners[0x21] = p => {\n  if (p.next() !== 0x3D) {\n    return T$Bang;\n  }\n  if (p.next() !== 0x3D) {\n    return T$BangEq;\n  }\n  p.next();\n  return T$BangEqEq;\n};\n\nCharScanners[0x3D] = p => {\n  if (p.next() !== 0x3D) {\n    return T$Eq;\n  }\n  if (p.next() !== 0x3D) {\n    return T$EqEq;\n  }\n  p.next();\n  return T$EqEqEq;\n};\n\nCharScanners[0x26] = p => {\n  if (p.next() !== 0x26) {\n    return T$Ampersand;\n  }\n  p.next();\n  return T$AmpersandAmpersand;\n};\n\nCharScanners[0x7C] = p => {\n  if (p.next() !== 0x7C) {\n    return T$Bar;\n  }\n  p.next();\n  return T$BarBar;\n};\n\nCharScanners[0x2E] = p => {\n  if (p.next() <= 0x39 && p.ch >= 0x30) {\n    return p.scanNumber(true);\n  }\n  return T$Period;\n};\n\nCharScanners[0x3C] = p => {\n  if (p.next() !== 0x3D) {\n    return T$Lt;\n  }\n  p.next();\n  return T$LtEq;\n};\n\nCharScanners[0x3E] = p => {\n  if (p.next() !== 0x3D) {\n    return T$Gt;\n  }\n  p.next();\n  return T$GtEq;\n};\n\nCharScanners[0x25] = returnToken(T$Percent);\nCharScanners[0x28] = returnToken(T$LParen);\nCharScanners[0x29] = returnToken(T$RParen);\nCharScanners[0x2A] = returnToken(T$Star);\nCharScanners[0x2B] = returnToken(T$Plus);\nCharScanners[0x2C] = returnToken(T$Comma);\nCharScanners[0x2D] = returnToken(T$Minus);\nCharScanners[0x2F] = returnToken(T$Slash);\nCharScanners[0x3A] = returnToken(T$Colon);\nCharScanners[0x3F] = returnToken(T$Question);\nCharScanners[0x5B] = returnToken(T$LBracket);\nCharScanners[0x5D] = returnToken(T$RBracket);\nCharScanners[0x5E] = returnToken(T$Caret);\nCharScanners[0x7B] = returnToken(T$LBrace);\nCharScanners[0x7D] = returnToken(T$RBrace);\n\nlet mapProto = Map.prototype;\n\nfunction getMapObserver(taskQueue, map) {\n  return ModifyMapObserver.for(taskQueue, map);\n}\n\nlet ModifyMapObserver = class ModifyMapObserver extends ModifyCollectionObserver {\n  constructor(taskQueue, map) {\n    super(taskQueue, map);\n  }\n\n  static for(taskQueue, map) {\n    if (!('__map_observer__' in map)) {\n      Reflect.defineProperty(map, '__map_observer__', {\n        value: ModifyMapObserver.create(taskQueue, map),\n        enumerable: false, configurable: false\n      });\n    }\n    return map.__map_observer__;\n  }\n\n  static create(taskQueue, map) {\n    let observer = new ModifyMapObserver(taskQueue, map);\n\n    let proto = mapProto;\n    if (proto.set !== map.set || proto.delete !== map.delete || proto.clear !== map.clear) {\n      proto = {\n        set: map.set,\n        delete: map.delete,\n        clear: map.clear\n      };\n    }\n\n    map.set = function () {\n      let hasValue = map.has(arguments[0]);\n      let type = hasValue ? 'update' : 'add';\n      let oldValue = map.get(arguments[0]);\n      let methodCallResult = proto.set.apply(map, arguments);\n      if (!hasValue || oldValue !== map.get(arguments[0])) {\n        observer.addChangeRecord({\n          type: type,\n          object: map,\n          key: arguments[0],\n          oldValue: oldValue\n        });\n      }\n      return methodCallResult;\n    };\n\n    map.delete = function () {\n      let hasValue = map.has(arguments[0]);\n      let oldValue = map.get(arguments[0]);\n      let methodCallResult = proto.delete.apply(map, arguments);\n      if (hasValue) {\n        observer.addChangeRecord({\n          type: 'delete',\n          object: map,\n          key: arguments[0],\n          oldValue: oldValue\n        });\n      }\n      return methodCallResult;\n    };\n\n    map.clear = function () {\n      let methodCallResult = proto.clear.apply(map, arguments);\n      observer.addChangeRecord({\n        type: 'clear',\n        object: map\n      });\n      return methodCallResult;\n    };\n\n    return observer;\n  }\n};\n\nlet emLogger = aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('event-manager');\n\nfunction findOriginalEventTarget(event) {\n  return event.path && event.path[0] || event.deepPath && event.deepPath[0] || event.target;\n}\n\nfunction stopPropagation() {\n  this.standardStopPropagation();\n  this.propagationStopped = true;\n}\n\nfunction handleCapturedEvent(event) {\n  event.propagationStopped = false;\n  let target = findOriginalEventTarget(event);\n\n  let orderedCallbacks = [];\n\n  while (target) {\n    if (target.capturedCallbacks) {\n      let callback = target.capturedCallbacks[event.type];\n      if (callback) {\n        if (event.stopPropagation !== stopPropagation) {\n          event.standardStopPropagation = event.stopPropagation;\n          event.stopPropagation = stopPropagation;\n        }\n        orderedCallbacks.push(callback);\n      }\n    }\n    target = target.parentNode;\n  }\n  for (let i = orderedCallbacks.length - 1; i >= 0 && !event.propagationStopped; i--) {\n    let orderedCallback = orderedCallbacks[i];\n    if ('handleEvent' in orderedCallback) {\n      orderedCallback.handleEvent(event);\n    } else {\n      orderedCallback(event);\n    }\n  }\n}\n\nlet CapturedHandlerEntry = class CapturedHandlerEntry {\n  constructor(eventName) {\n    this.eventName = eventName;\n    this.count = 0;\n  }\n\n  increment() {\n    this.count++;\n\n    if (this.count === 1) {\n      aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].addEventListener(this.eventName, handleCapturedEvent, true);\n    }\n  }\n\n  decrement() {\n    if (this.count === 0) {\n      emLogger.warn('The same EventListener was disposed multiple times.');\n    } else if (--this.count === 0) {\n      aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].removeEventListener(this.eventName, handleCapturedEvent, true);\n    }\n  }\n};\n\n\nfunction handleDelegatedEvent(event) {\n  event.propagationStopped = false;\n  let target = findOriginalEventTarget(event);\n\n  while (target && !event.propagationStopped) {\n    if (target.delegatedCallbacks) {\n      let callback = target.delegatedCallbacks[event.type];\n      if (callback) {\n        if (event.stopPropagation !== stopPropagation) {\n          event.standardStopPropagation = event.stopPropagation;\n          event.stopPropagation = stopPropagation;\n        }\n        if ('handleEvent' in callback) {\n          callback.handleEvent(event);\n        } else {\n          callback(event);\n        }\n      }\n    }\n\n    target = target.parentNode;\n  }\n}\n\nlet DelegateHandlerEntry = class DelegateHandlerEntry {\n  constructor(eventName) {\n    this.eventName = eventName;\n    this.count = 0;\n  }\n\n  increment() {\n    this.count++;\n\n    if (this.count === 1) {\n      aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].addEventListener(this.eventName, handleDelegatedEvent, false);\n    }\n  }\n\n  decrement() {\n    if (this.count === 0) {\n      emLogger.warn('The same EventListener was disposed multiple times.');\n    } else if (--this.count === 0) {\n      aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].removeEventListener(this.eventName, handleDelegatedEvent, false);\n    }\n  }\n};\nlet DelegationEntryHandler = class DelegationEntryHandler {\n  constructor(entry, lookup, targetEvent) {\n    this.entry = entry;\n    this.lookup = lookup;\n    this.targetEvent = targetEvent;\n  }\n\n  dispose() {\n    if (this.lookup[this.targetEvent]) {\n      this.entry.decrement();\n      this.lookup[this.targetEvent] = null;\n    } else {\n      emLogger.warn('Calling .dispose() on already disposed eventListener');\n    }\n  }\n};\nlet EventHandler = class EventHandler {\n  constructor(target, targetEvent, callback) {\n    this.target = target;\n    this.targetEvent = targetEvent;\n    this.callback = callback;\n  }\n\n  dispose() {\n    this.target.removeEventListener(this.targetEvent, this.callback);\n  }\n};\nlet DefaultEventStrategy = class DefaultEventStrategy {\n  constructor() {\n    this.delegatedHandlers = {};\n    this.capturedHandlers = {};\n  }\n\n  subscribe(target, targetEvent, callback, strategy, disposable) {\n    let delegatedHandlers;\n    let capturedHandlers;\n    let handlerEntry;\n\n    if (strategy === delegationStrategy.bubbling) {\n      delegatedHandlers = this.delegatedHandlers;\n      handlerEntry = delegatedHandlers[targetEvent] || (delegatedHandlers[targetEvent] = new DelegateHandlerEntry(targetEvent));\n      let delegatedCallbacks = target.delegatedCallbacks || (target.delegatedCallbacks = {});\n      if (!delegatedCallbacks[targetEvent]) {\n        handlerEntry.increment();\n      } else {\n        emLogger.warn('Overriding previous callback for event listener', { event: targetEvent, callback: callback, previousCallback: delegatedCallbacks[targetEvent] });\n      }\n      delegatedCallbacks[targetEvent] = callback;\n\n      if (disposable === true) {\n        return new DelegationEntryHandler(handlerEntry, delegatedCallbacks, targetEvent);\n      }\n\n      return function () {\n        handlerEntry.decrement();\n        delegatedCallbacks[targetEvent] = null;\n      };\n    }\n    if (strategy === delegationStrategy.capturing) {\n      capturedHandlers = this.capturedHandlers;\n      handlerEntry = capturedHandlers[targetEvent] || (capturedHandlers[targetEvent] = new CapturedHandlerEntry(targetEvent));\n      let capturedCallbacks = target.capturedCallbacks || (target.capturedCallbacks = {});\n      if (!capturedCallbacks[targetEvent]) {\n        handlerEntry.increment();\n      } else {\n        emLogger.error('already have a callback for event', { event: targetEvent, callback: callback });\n      }\n      capturedCallbacks[targetEvent] = callback;\n\n      if (disposable === true) {\n        return new DelegationEntryHandler(handlerEntry, capturedCallbacks, targetEvent);\n      }\n\n      return function () {\n        handlerEntry.decrement();\n        capturedCallbacks[targetEvent] = null;\n      };\n    }\n\n    target.addEventListener(targetEvent, callback);\n\n    if (disposable === true) {\n      return new EventHandler(target, targetEvent, callback);\n    }\n\n    return function () {\n      target.removeEventListener(targetEvent, callback);\n    };\n  }\n};\n\n\nconst delegationStrategy = {\n  none: 0,\n  capturing: 1,\n  bubbling: 2\n};\n\nlet EventManager = class EventManager {\n  constructor() {\n    this.elementHandlerLookup = {};\n    this.eventStrategyLookup = {};\n\n    this.registerElementConfig({\n      tagName: 'input',\n      properties: {\n        value: ['change', 'input'],\n        checked: ['change', 'input'],\n        files: ['change', 'input']\n      }\n    });\n\n    this.registerElementConfig({\n      tagName: 'textarea',\n      properties: {\n        value: ['change', 'input']\n      }\n    });\n\n    this.registerElementConfig({\n      tagName: 'select',\n      properties: {\n        value: ['change']\n      }\n    });\n\n    this.registerElementConfig({\n      tagName: 'content editable',\n      properties: {\n        value: ['change', 'input', 'blur', 'keyup', 'paste']\n      }\n    });\n\n    this.registerElementConfig({\n      tagName: 'scrollable element',\n      properties: {\n        scrollTop: ['scroll'],\n        scrollLeft: ['scroll']\n      }\n    });\n\n    this.defaultEventStrategy = new DefaultEventStrategy();\n  }\n\n  registerElementConfig(config) {\n    let tagName = config.tagName.toLowerCase();\n    let properties = config.properties;\n    let propertyName;\n\n    let lookup = this.elementHandlerLookup[tagName] = {};\n\n    for (propertyName in properties) {\n      if (properties.hasOwnProperty(propertyName)) {\n        lookup[propertyName] = properties[propertyName];\n      }\n    }\n  }\n\n  registerEventStrategy(eventName, strategy) {\n    this.eventStrategyLookup[eventName] = strategy;\n  }\n\n  getElementHandler(target, propertyName) {\n    let tagName;\n    let lookup = this.elementHandlerLookup;\n\n    if (target.tagName) {\n      tagName = target.tagName.toLowerCase();\n\n      if (lookup[tagName] && lookup[tagName][propertyName]) {\n        return new EventSubscriber(lookup[tagName][propertyName]);\n      }\n\n      if (propertyName === 'textContent' || propertyName === 'innerHTML') {\n        return new EventSubscriber(lookup['content editable'].value);\n      }\n\n      if (propertyName === 'scrollTop' || propertyName === 'scrollLeft') {\n        return new EventSubscriber(lookup['scrollable element'][propertyName]);\n      }\n    }\n\n    return null;\n  }\n\n  addEventListener(target, targetEvent, callbackOrListener, delegate, disposable) {\n    return (this.eventStrategyLookup[targetEvent] || this.defaultEventStrategy).subscribe(target, targetEvent, callbackOrListener, delegate, disposable);\n  }\n};\n\nlet EventSubscriber = class EventSubscriber {\n  constructor(events) {\n    this.events = events;\n    this.element = null;\n    this.handler = null;\n  }\n\n  subscribe(element, callbackOrListener) {\n    this.element = element;\n    this.handler = callbackOrListener;\n\n    let events = this.events;\n    for (let i = 0, ii = events.length; ii > i; ++i) {\n      element.addEventListener(events[i], callbackOrListener);\n    }\n  }\n\n  dispose() {\n    if (this.element === null) {\n      return;\n    }\n    let element = this.element;\n    let callbackOrListener = this.handler;\n    let events = this.events;\n    for (let i = 0, ii = events.length; ii > i; ++i) {\n      element.removeEventListener(events[i], callbackOrListener);\n    }\n    this.element = this.handler = null;\n  }\n};\n\nlet DirtyChecker = class DirtyChecker {\n  constructor() {\n    this.tracked = [];\n    this.checkDelay = 120;\n  }\n\n  addProperty(property) {\n    let tracked = this.tracked;\n\n    tracked.push(property);\n\n    if (tracked.length === 1) {\n      this.scheduleDirtyCheck();\n    }\n  }\n\n  removeProperty(property) {\n    let tracked = this.tracked;\n    tracked.splice(tracked.indexOf(property), 1);\n  }\n\n  scheduleDirtyCheck() {\n    setTimeout(() => this.check(), this.checkDelay);\n  }\n\n  check() {\n    let tracked = this.tracked;\n    let i = tracked.length;\n\n    while (i--) {\n      let current = tracked[i];\n\n      if (current.isDirty()) {\n        current.call();\n      }\n    }\n\n    if (tracked.length) {\n      this.scheduleDirtyCheck();\n    }\n  }\n};\n\nlet DirtyCheckProperty = (_dec5 = subscriberCollection(), _dec5(_class5 = class DirtyCheckProperty {\n  constructor(dirtyChecker, obj, propertyName) {\n    this.dirtyChecker = dirtyChecker;\n    this.obj = obj;\n    this.propertyName = propertyName;\n  }\n\n  getValue() {\n    return this.obj[this.propertyName];\n  }\n\n  setValue(newValue) {\n    this.obj[this.propertyName] = newValue;\n  }\n\n  call() {\n    let oldValue = this.oldValue;\n    let newValue = this.getValue();\n\n    this.callSubscribers(newValue, oldValue);\n\n    this.oldValue = newValue;\n  }\n\n  isDirty() {\n    return this.oldValue !== this.obj[this.propertyName];\n  }\n\n  subscribe(context, callable) {\n    if (!this.hasSubscribers()) {\n      this.oldValue = this.getValue();\n      this.dirtyChecker.addProperty(this);\n    }\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {\n      this.dirtyChecker.removeProperty(this);\n    }\n  }\n}) || _class5);\n\nconst logger = aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('property-observation');\n\nconst propertyAccessor = {\n  getValue: (obj, propertyName) => obj[propertyName],\n  setValue: (value, obj, propertyName) => {\n    obj[propertyName] = value;\n  }\n};\n\nlet PrimitiveObserver = class PrimitiveObserver {\n\n  constructor(primitive, propertyName) {\n    this.doNotCache = true;\n\n    this.primitive = primitive;\n    this.propertyName = propertyName;\n  }\n\n  getValue() {\n    return this.primitive[this.propertyName];\n  }\n\n  setValue() {\n    let type = typeof this.primitive;\n    throw new Error(`The ${this.propertyName} property of a ${type} (${this.primitive}) cannot be assigned.`);\n  }\n\n  subscribe() {}\n\n  unsubscribe() {}\n};\n\nlet SetterObserver = (_dec6 = subscriberCollection(), _dec6(_class7 = class SetterObserver {\n  constructor(taskQueue, obj, propertyName) {\n    this.taskQueue = taskQueue;\n    this.obj = obj;\n    this.propertyName = propertyName;\n    this.queued = false;\n    this.observing = false;\n  }\n\n  getValue() {\n    return this.obj[this.propertyName];\n  }\n\n  setValue(newValue) {\n    this.obj[this.propertyName] = newValue;\n  }\n\n  getterValue() {\n    return this.currentValue;\n  }\n\n  setterValue(newValue) {\n    let oldValue = this.currentValue;\n\n    if (oldValue !== newValue) {\n      if (!this.queued) {\n        this.oldValue = oldValue;\n        this.queued = true;\n        this.taskQueue.queueMicroTask(this);\n      }\n\n      this.currentValue = newValue;\n    }\n  }\n\n  call() {\n    let oldValue = this.oldValue;\n    let newValue = this.currentValue;\n\n    this.queued = false;\n\n    this.callSubscribers(newValue, oldValue);\n  }\n\n  subscribe(context, callable) {\n    if (!this.observing) {\n      this.convertProperty();\n    }\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    this.removeSubscriber(context, callable);\n  }\n\n  convertProperty() {\n    this.observing = true;\n    this.currentValue = this.obj[this.propertyName];\n    this.setValue = this.setterValue;\n    this.getValue = this.getterValue;\n\n    if (!Reflect.defineProperty(this.obj, this.propertyName, {\n      configurable: true,\n      enumerable: this.propertyName in this.obj ? this.obj.propertyIsEnumerable(this.propertyName) : true,\n      get: this.getValue.bind(this),\n      set: this.setValue.bind(this)\n    })) {\n      logger.warn(`Cannot observe property '${this.propertyName}' of object`, this.obj);\n    }\n  }\n}) || _class7);\n\nlet XLinkAttributeObserver = class XLinkAttributeObserver {\n  constructor(element, propertyName, attributeName) {\n    this.element = element;\n    this.propertyName = propertyName;\n    this.attributeName = attributeName;\n  }\n\n  getValue() {\n    return this.element.getAttributeNS('http://www.w3.org/1999/xlink', this.attributeName);\n  }\n\n  setValue(newValue) {\n    return this.element.setAttributeNS('http://www.w3.org/1999/xlink', this.attributeName, newValue);\n  }\n\n  subscribe() {\n    throw new Error(`Observation of a \"${this.element.nodeName}\" element\\'s \"${this.propertyName}\" property is not supported.`);\n  }\n};\n\nconst dataAttributeAccessor = {\n  getValue: (obj, propertyName) => obj.getAttribute(propertyName),\n  setValue: (value, obj, propertyName) => {\n    if (value === null || value === undefined) {\n      obj.removeAttribute(propertyName);\n    } else {\n      obj.setAttribute(propertyName, value);\n    }\n  }\n};\n\nlet DataAttributeObserver = class DataAttributeObserver {\n  constructor(element, propertyName) {\n    this.element = element;\n    this.propertyName = propertyName;\n  }\n\n  getValue() {\n    return this.element.getAttribute(this.propertyName);\n  }\n\n  setValue(newValue) {\n    if (newValue === null || newValue === undefined) {\n      return this.element.removeAttribute(this.propertyName);\n    }\n    return this.element.setAttribute(this.propertyName, newValue);\n  }\n\n  subscribe() {\n    throw new Error(`Observation of a \"${this.element.nodeName}\" element\\'s \"${this.propertyName}\" property is not supported.`);\n  }\n};\n\nlet StyleObserver = class StyleObserver {\n  constructor(element, propertyName) {\n    this.element = element;\n    this.propertyName = propertyName;\n\n    this.styles = null;\n    this.version = 0;\n  }\n\n  getValue() {\n    return this.element.style.cssText;\n  }\n\n  _setProperty(style, value) {\n    let priority = '';\n\n    if (value !== null && value !== undefined && typeof value.indexOf === 'function' && value.indexOf('!important') !== -1) {\n      priority = 'important';\n      value = value.replace('!important', '');\n    }\n    this.element.style.setProperty(style, value, priority);\n  }\n\n  setValue(newValue) {\n    let styles = this.styles || {};\n    let style;\n    let version = this.version;\n\n    if (newValue !== null && newValue !== undefined) {\n      if (newValue instanceof Object) {\n        let value;\n        for (style in newValue) {\n          if (newValue.hasOwnProperty(style)) {\n            value = newValue[style];\n            style = style.replace(/([A-Z])/g, m => '-' + m.toLowerCase());\n            styles[style] = version;\n            this._setProperty(style, value);\n          }\n        }\n      } else if (newValue.length) {\n        let rx = /\\s*([\\w\\-]+)\\s*:\\s*((?:(?:[\\w\\-]+\\(\\s*(?:\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[\\w\\-]+\\(\\s*(?:^\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^\\)]*)\\),?|[^\\)]*)\\),?|\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^;]*),?\\s*)+);?/g;\n        let pair;\n        while ((pair = rx.exec(newValue)) !== null) {\n          style = pair[1];\n          if (!style) {\n            continue;\n          }\n\n          styles[style] = version;\n          this._setProperty(style, pair[2]);\n        }\n      }\n    }\n\n    this.styles = styles;\n    this.version += 1;\n\n    if (version === 0) {\n      return;\n    }\n\n    version -= 1;\n    for (style in styles) {\n      if (!styles.hasOwnProperty(style) || styles[style] !== version) {\n        continue;\n      }\n\n      this.element.style.removeProperty(style);\n    }\n  }\n\n  subscribe() {\n    throw new Error(`Observation of a \"${this.element.nodeName}\" element\\'s \"${this.propertyName}\" property is not supported.`);\n  }\n};\n\nlet ValueAttributeObserver = (_dec7 = subscriberCollection(), _dec7(_class8 = class ValueAttributeObserver {\n  constructor(element, propertyName, handler) {\n    this.element = element;\n    this.propertyName = propertyName;\n    this.handler = handler;\n    if (propertyName === 'files') {\n      this.setValue = () => {};\n    }\n  }\n\n  getValue() {\n    return this.element[this.propertyName];\n  }\n\n  setValue(newValue) {\n    newValue = newValue === undefined || newValue === null ? '' : newValue;\n    if (this.element[this.propertyName] !== newValue) {\n      this.element[this.propertyName] = newValue;\n      this.notify();\n    }\n  }\n\n  notify() {\n    let oldValue = this.oldValue;\n    let newValue = this.getValue();\n\n    this.callSubscribers(newValue, oldValue);\n\n    this.oldValue = newValue;\n  }\n\n  handleEvent() {\n    this.notify();\n  }\n\n  subscribe(context, callable) {\n    if (!this.hasSubscribers()) {\n      this.oldValue = this.getValue();\n      this.handler.subscribe(this.element, this);\n    }\n\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {\n      this.handler.dispose();\n    }\n  }\n}) || _class8);\n\nconst checkedArrayContext = 'CheckedObserver:array';\nconst checkedValueContext = 'CheckedObserver:value';\n\nlet CheckedObserver = (_dec8 = subscriberCollection(), _dec8(_class9 = class CheckedObserver {\n  constructor(element, handler, observerLocator) {\n    this.element = element;\n    this.handler = handler;\n    this.observerLocator = observerLocator;\n  }\n\n  getValue() {\n    return this.value;\n  }\n\n  setValue(newValue) {\n    if (this.initialSync && this.value === newValue) {\n      return;\n    }\n\n    if (this.arrayObserver) {\n      this.arrayObserver.unsubscribe(checkedArrayContext, this);\n      this.arrayObserver = null;\n    }\n\n    if (this.element.type === 'checkbox' && Array.isArray(newValue)) {\n      this.arrayObserver = this.observerLocator.getArrayObserver(newValue);\n      this.arrayObserver.subscribe(checkedArrayContext, this);\n    }\n\n    this.oldValue = this.value;\n    this.value = newValue;\n    this.synchronizeElement();\n    this.notify();\n\n    if (!this.initialSync) {\n      this.initialSync = true;\n      this.observerLocator.taskQueue.queueMicroTask(this);\n    }\n  }\n\n  call(context, splices) {\n    this.synchronizeElement();\n\n    if (!this.valueObserver) {\n      this.valueObserver = this.element.__observers__.model || this.element.__observers__.value;\n      if (this.valueObserver) {\n        this.valueObserver.subscribe(checkedValueContext, this);\n      }\n    }\n  }\n\n  synchronizeElement() {\n    let value = this.value;\n    let element = this.element;\n    let elementValue = element.hasOwnProperty('model') ? element.model : element.value;\n    let isRadio = element.type === 'radio';\n    let matcher = element.matcher || ((a, b) => a === b);\n\n    element.checked = isRadio && !!matcher(value, elementValue) || !isRadio && value === true || !isRadio && Array.isArray(value) && value.findIndex(item => !!matcher(item, elementValue)) !== -1;\n  }\n\n  synchronizeValue() {\n    let value = this.value;\n    let element = this.element;\n    let elementValue = element.hasOwnProperty('model') ? element.model : element.value;\n    let index;\n    let matcher = element.matcher || ((a, b) => a === b);\n\n    if (element.type === 'checkbox') {\n      if (Array.isArray(value)) {\n        index = value.findIndex(item => !!matcher(item, elementValue));\n        if (element.checked && index === -1) {\n          value.push(elementValue);\n        } else if (!element.checked && index !== -1) {\n          value.splice(index, 1);\n        }\n\n        return;\n      }\n\n      value = element.checked;\n    } else if (element.checked) {\n      value = elementValue;\n    } else {\n      return;\n    }\n\n    this.oldValue = this.value;\n    this.value = value;\n    this.notify();\n  }\n\n  notify() {\n    let oldValue = this.oldValue;\n    let newValue = this.value;\n\n    if (newValue === oldValue) {\n      return;\n    }\n\n    this.callSubscribers(newValue, oldValue);\n  }\n\n  handleEvent() {\n    this.synchronizeValue();\n  }\n\n  subscribe(context, callable) {\n    if (!this.hasSubscribers()) {\n      this.handler.subscribe(this.element, this);\n    }\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {\n      this.handler.dispose();\n    }\n  }\n\n  unbind() {\n    if (this.arrayObserver) {\n      this.arrayObserver.unsubscribe(checkedArrayContext, this);\n      this.arrayObserver = null;\n    }\n    if (this.valueObserver) {\n      this.valueObserver.unsubscribe(checkedValueContext, this);\n    }\n  }\n}) || _class9);\n\nconst selectArrayContext = 'SelectValueObserver:array';\n\nlet SelectValueObserver = (_dec9 = subscriberCollection(), _dec9(_class10 = class SelectValueObserver {\n  constructor(element, handler, observerLocator) {\n    this.element = element;\n    this.handler = handler;\n    this.observerLocator = observerLocator;\n  }\n\n  getValue() {\n    return this.value;\n  }\n\n  setValue(newValue) {\n    if (newValue !== null && newValue !== undefined && this.element.multiple && !Array.isArray(newValue)) {\n      throw new Error('Only null or Array instances can be bound to a multi-select.');\n    }\n    if (this.value === newValue) {\n      return;\n    }\n\n    if (this.arrayObserver) {\n      this.arrayObserver.unsubscribe(selectArrayContext, this);\n      this.arrayObserver = null;\n    }\n\n    if (Array.isArray(newValue)) {\n      this.arrayObserver = this.observerLocator.getArrayObserver(newValue);\n      this.arrayObserver.subscribe(selectArrayContext, this);\n    }\n\n    this.oldValue = this.value;\n    this.value = newValue;\n    this.synchronizeOptions();\n    this.notify();\n\n    if (!this.initialSync) {\n      this.initialSync = true;\n      this.observerLocator.taskQueue.queueMicroTask(this);\n    }\n  }\n\n  call(context, splices) {\n    this.synchronizeOptions();\n  }\n\n  synchronizeOptions() {\n    let value = this.value;\n    let isArray;\n\n    if (Array.isArray(value)) {\n      isArray = true;\n    }\n\n    let options = this.element.options;\n    let i = options.length;\n    let matcher = this.element.matcher || ((a, b) => a === b);\n    while (i--) {\n      let option = options.item(i);\n      let optionValue = option.hasOwnProperty('model') ? option.model : option.value;\n      if (isArray) {\n        option.selected = value.findIndex(item => !!matcher(optionValue, item)) !== -1;\n        continue;\n      }\n      option.selected = !!matcher(optionValue, value);\n    }\n  }\n\n  synchronizeValue() {\n    let options = this.element.options;\n    let count = 0;\n    let value = [];\n\n    for (let i = 0, ii = options.length; i < ii; i++) {\n      let option = options.item(i);\n      if (!option.selected) {\n        continue;\n      }\n      value.push(option.hasOwnProperty('model') ? option.model : option.value);\n      count++;\n    }\n\n    if (this.element.multiple) {\n      if (Array.isArray(this.value)) {\n        let matcher = this.element.matcher || ((a, b) => a === b);\n\n        let i = 0;\n        while (i < this.value.length) {\n          let a = this.value[i];\n          if (value.findIndex(b => matcher(a, b)) === -1) {\n            this.value.splice(i, 1);\n          } else {\n            i++;\n          }\n        }\n\n        i = 0;\n        while (i < value.length) {\n          let a = value[i];\n          if (this.value.findIndex(b => matcher(a, b)) === -1) {\n            this.value.push(a);\n          }\n          i++;\n        }\n        return;\n      }\n    } else {\n      if (count === 0) {\n        value = null;\n      } else {\n        value = value[0];\n      }\n    }\n\n    if (value !== this.value) {\n      this.oldValue = this.value;\n      this.value = value;\n      this.notify();\n    }\n  }\n\n  notify() {\n    let oldValue = this.oldValue;\n    let newValue = this.value;\n\n    this.callSubscribers(newValue, oldValue);\n  }\n\n  handleEvent() {\n    this.synchronizeValue();\n  }\n\n  subscribe(context, callable) {\n    if (!this.hasSubscribers()) {\n      this.handler.subscribe(this.element, this);\n    }\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {\n      this.handler.dispose();\n    }\n  }\n\n  bind() {\n    this.domObserver = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].createMutationObserver(() => {\n      this.synchronizeOptions();\n      this.synchronizeValue();\n    });\n    this.domObserver.observe(this.element, { childList: true, subtree: true, characterData: true });\n  }\n\n  unbind() {\n    this.domObserver.disconnect();\n    this.domObserver = null;\n\n    if (this.arrayObserver) {\n      this.arrayObserver.unsubscribe(selectArrayContext, this);\n      this.arrayObserver = null;\n    }\n  }\n}) || _class10);\n\nlet ClassObserver = class ClassObserver {\n  constructor(element) {\n    this.element = element;\n    this.doNotCache = true;\n    this.value = '';\n    this.version = 0;\n  }\n\n  getValue() {\n    return this.value;\n  }\n\n  setValue(newValue) {\n    let nameIndex = this.nameIndex || {};\n    let version = this.version;\n    let names;\n    let name;\n\n    if (newValue !== null && newValue !== undefined && newValue.length) {\n      names = newValue.split(/\\s+/);\n      for (let i = 0, length = names.length; i < length; i++) {\n        name = names[i];\n        if (name === '') {\n          continue;\n        }\n        nameIndex[name] = version;\n        this.element.classList.add(name);\n      }\n    }\n\n    this.value = newValue;\n    this.nameIndex = nameIndex;\n    this.version += 1;\n\n    if (version === 0) {\n      return;\n    }\n\n    version -= 1;\n    for (name in nameIndex) {\n      if (!nameIndex.hasOwnProperty(name) || nameIndex[name] !== version) {\n        continue;\n      }\n      this.element.classList.remove(name);\n    }\n  }\n\n  subscribe() {\n    throw new Error(`Observation of a \"${this.element.nodeName}\" element\\'s \"class\" property is not supported.`);\n  }\n};\n\nfunction hasDeclaredDependencies(descriptor) {\n  return !!(descriptor && descriptor.get && descriptor.get.dependencies);\n}\n\nfunction declarePropertyDependencies(ctor, propertyName, dependencies) {\n  let descriptor = Object.getOwnPropertyDescriptor(ctor.prototype, propertyName);\n  descriptor.get.dependencies = dependencies;\n}\n\nfunction computedFrom(...rest) {\n  return function (target, key, descriptor) {\n    descriptor.get.dependencies = rest;\n    return descriptor;\n  };\n}\n\nlet ComputedExpression = class ComputedExpression extends Expression {\n  constructor(name, dependencies) {\n    super();\n\n    this.name = name;\n    this.dependencies = dependencies;\n    this.isAssignable = true;\n  }\n\n  evaluate(scope, lookupFunctions) {\n    return scope.bindingContext[this.name];\n  }\n\n  assign(scope, value) {\n    scope.bindingContext[this.name] = value;\n  }\n\n  accept(visitor) {\n    throw new Error('not implemented');\n  }\n\n  connect(binding, scope) {\n    let dependencies = this.dependencies;\n    let i = dependencies.length;\n    while (i--) {\n      dependencies[i].connect(binding, scope);\n    }\n  }\n};\n\nfunction createComputedObserver(obj, propertyName, descriptor, observerLocator) {\n  let dependencies = descriptor.get.dependencies;\n  if (!(dependencies instanceof ComputedExpression)) {\n    let i = dependencies.length;\n    while (i--) {\n      dependencies[i] = observerLocator.parser.parse(dependencies[i]);\n    }\n    dependencies = descriptor.get.dependencies = new ComputedExpression(propertyName, dependencies);\n  }\n\n  let scope = { bindingContext: obj, overrideContext: createOverrideContext(obj) };\n  return new ExpressionObserver(scope, dependencies, observerLocator);\n}\n\nlet svgElements;\nlet svgPresentationElements;\nlet svgPresentationAttributes;\nlet svgAnalyzer;\n\nif (typeof FEATURE_NO_SVG === 'undefined') {\n  svgElements = {\n    a: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'target', 'transform', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    altGlyph: ['class', 'dx', 'dy', 'externalResourcesRequired', 'format', 'glyphRef', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    altGlyphDef: ['id', 'xml:base', 'xml:lang', 'xml:space'],\n    altGlyphItem: ['id', 'xml:base', 'xml:lang', 'xml:space'],\n    animate: ['accumulate', 'additive', 'attributeName', 'attributeType', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    animateColor: ['accumulate', 'additive', 'attributeName', 'attributeType', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    animateMotion: ['accumulate', 'additive', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keyPoints', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'origin', 'path', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'rotate', 'systemLanguage', 'to', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    animateTransform: ['accumulate', 'additive', 'attributeName', 'attributeType', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'type', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    circle: ['class', 'cx', 'cy', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'r', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],\n    clipPath: ['class', 'clipPathUnits', 'externalResourcesRequired', 'id', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],\n    'color-profile': ['id', 'local', 'name', 'rendering-intent', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    cursor: ['externalResourcesRequired', 'id', 'requiredExtensions', 'requiredFeatures', 'systemLanguage', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    defs: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],\n    desc: ['class', 'id', 'style', 'xml:base', 'xml:lang', 'xml:space'],\n    ellipse: ['class', 'cx', 'cy', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rx', 'ry', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],\n    feBlend: ['class', 'height', 'id', 'in', 'in2', 'mode', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feColorMatrix: ['class', 'height', 'id', 'in', 'result', 'style', 'type', 'values', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feComponentTransfer: ['class', 'height', 'id', 'in', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feComposite: ['class', 'height', 'id', 'in', 'in2', 'k1', 'k2', 'k3', 'k4', 'operator', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feConvolveMatrix: ['bias', 'class', 'divisor', 'edgeMode', 'height', 'id', 'in', 'kernelMatrix', 'kernelUnitLength', 'order', 'preserveAlpha', 'result', 'style', 'targetX', 'targetY', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feDiffuseLighting: ['class', 'diffuseConstant', 'height', 'id', 'in', 'kernelUnitLength', 'result', 'style', 'surfaceScale', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feDisplacementMap: ['class', 'height', 'id', 'in', 'in2', 'result', 'scale', 'style', 'width', 'x', 'xChannelSelector', 'xml:base', 'xml:lang', 'xml:space', 'y', 'yChannelSelector'],\n    feDistantLight: ['azimuth', 'elevation', 'id', 'xml:base', 'xml:lang', 'xml:space'],\n    feFlood: ['class', 'height', 'id', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feFuncA: ['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space'],\n    feFuncB: ['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space'],\n    feFuncG: ['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space'],\n    feFuncR: ['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space'],\n    feGaussianBlur: ['class', 'height', 'id', 'in', 'result', 'stdDeviation', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feImage: ['class', 'externalResourcesRequired', 'height', 'id', 'preserveAspectRatio', 'result', 'style', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feMerge: ['class', 'height', 'id', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feMergeNode: ['id', 'xml:base', 'xml:lang', 'xml:space'],\n    feMorphology: ['class', 'height', 'id', 'in', 'operator', 'radius', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feOffset: ['class', 'dx', 'dy', 'height', 'id', 'in', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    fePointLight: ['id', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y', 'z'],\n    feSpecularLighting: ['class', 'height', 'id', 'in', 'kernelUnitLength', 'result', 'specularConstant', 'specularExponent', 'style', 'surfaceScale', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feSpotLight: ['id', 'limitingConeAngle', 'pointsAtX', 'pointsAtY', 'pointsAtZ', 'specularExponent', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y', 'z'],\n    feTile: ['class', 'height', 'id', 'in', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    feTurbulence: ['baseFrequency', 'class', 'height', 'id', 'numOctaves', 'result', 'seed', 'stitchTiles', 'style', 'type', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    filter: ['class', 'externalResourcesRequired', 'filterRes', 'filterUnits', 'height', 'id', 'primitiveUnits', 'style', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    font: ['class', 'externalResourcesRequired', 'horiz-adv-x', 'horiz-origin-x', 'horiz-origin-y', 'id', 'style', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'xml:base', 'xml:lang', 'xml:space'],\n    'font-face': ['accent-height', 'alphabetic', 'ascent', 'bbox', 'cap-height', 'descent', 'font-family', 'font-size', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'hanging', 'id', 'ideographic', 'mathematical', 'overline-position', 'overline-thickness', 'panose-1', 'slope', 'stemh', 'stemv', 'strikethrough-position', 'strikethrough-thickness', 'underline-position', 'underline-thickness', 'unicode-range', 'units-per-em', 'v-alphabetic', 'v-hanging', 'v-ideographic', 'v-mathematical', 'widths', 'x-height', 'xml:base', 'xml:lang', 'xml:space'],\n    'font-face-format': ['id', 'string', 'xml:base', 'xml:lang', 'xml:space'],\n    'font-face-name': ['id', 'name', 'xml:base', 'xml:lang', 'xml:space'],\n    'font-face-src': ['id', 'xml:base', 'xml:lang', 'xml:space'],\n    'font-face-uri': ['id', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    foreignObject: ['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    g: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],\n    glyph: ['arabic-form', 'class', 'd', 'glyph-name', 'horiz-adv-x', 'id', 'lang', 'orientation', 'style', 'unicode', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'xml:base', 'xml:lang', 'xml:space'],\n    glyphRef: ['class', 'dx', 'dy', 'format', 'glyphRef', 'id', 'style', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    hkern: ['g1', 'g2', 'id', 'k', 'u1', 'u2', 'xml:base', 'xml:lang', 'xml:space'],\n    image: ['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'preserveAspectRatio', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    line: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'x1', 'x2', 'xml:base', 'xml:lang', 'xml:space', 'y1', 'y2'],\n    linearGradient: ['class', 'externalResourcesRequired', 'gradientTransform', 'gradientUnits', 'id', 'spreadMethod', 'style', 'x1', 'x2', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y1', 'y2'],\n    marker: ['class', 'externalResourcesRequired', 'id', 'markerHeight', 'markerUnits', 'markerWidth', 'orient', 'preserveAspectRatio', 'refX', 'refY', 'style', 'viewBox', 'xml:base', 'xml:lang', 'xml:space'],\n    mask: ['class', 'externalResourcesRequired', 'height', 'id', 'maskContentUnits', 'maskUnits', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    metadata: ['id', 'xml:base', 'xml:lang', 'xml:space'],\n    'missing-glyph': ['class', 'd', 'horiz-adv-x', 'id', 'style', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'xml:base', 'xml:lang', 'xml:space'],\n    mpath: ['externalResourcesRequired', 'id', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    path: ['class', 'd', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'pathLength', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],\n    pattern: ['class', 'externalResourcesRequired', 'height', 'id', 'patternContentUnits', 'patternTransform', 'patternUnits', 'preserveAspectRatio', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'viewBox', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    polygon: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'points', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],\n    polyline: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'points', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],\n    radialGradient: ['class', 'cx', 'cy', 'externalResourcesRequired', 'fx', 'fy', 'gradientTransform', 'gradientUnits', 'id', 'r', 'spreadMethod', 'style', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    rect: ['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rx', 'ry', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    script: ['externalResourcesRequired', 'id', 'type', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    set: ['attributeName', 'attributeType', 'begin', 'dur', 'end', 'externalResourcesRequired', 'fill', 'id', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    stop: ['class', 'id', 'offset', 'style', 'xml:base', 'xml:lang', 'xml:space'],\n    style: ['id', 'media', 'title', 'type', 'xml:base', 'xml:lang', 'xml:space'],\n    svg: ['baseProfile', 'class', 'contentScriptType', 'contentStyleType', 'externalResourcesRequired', 'height', 'id', 'onabort', 'onactivate', 'onclick', 'onerror', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'onresize', 'onscroll', 'onunload', 'onzoom', 'preserveAspectRatio', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'version', 'viewBox', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y', 'zoomAndPan'],\n    switch: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],\n    symbol: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'preserveAspectRatio', 'style', 'viewBox', 'xml:base', 'xml:lang', 'xml:space'],\n    text: ['class', 'dx', 'dy', 'externalResourcesRequired', 'id', 'lengthAdjust', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'textLength', 'transform', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    textPath: ['class', 'externalResourcesRequired', 'id', 'lengthAdjust', 'method', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'spacing', 'startOffset', 'style', 'systemLanguage', 'textLength', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],\n    title: ['class', 'id', 'style', 'xml:base', 'xml:lang', 'xml:space'],\n    tref: ['class', 'dx', 'dy', 'externalResourcesRequired', 'id', 'lengthAdjust', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'textLength', 'x', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    tspan: ['class', 'dx', 'dy', 'externalResourcesRequired', 'id', 'lengthAdjust', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'textLength', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    use: ['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],\n    view: ['externalResourcesRequired', 'id', 'preserveAspectRatio', 'viewBox', 'viewTarget', 'xml:base', 'xml:lang', 'xml:space', 'zoomAndPan'],\n    vkern: ['g1', 'g2', 'id', 'k', 'u1', 'u2', 'xml:base', 'xml:lang', 'xml:space']\n  };\n\n\n  svgPresentationElements = {\n    'a': true,\n    'altGlyph': true,\n    'animate': true,\n    'animateColor': true,\n    'circle': true,\n    'clipPath': true,\n    'defs': true,\n    'ellipse': true,\n    'feBlend': true,\n    'feColorMatrix': true,\n    'feComponentTransfer': true,\n    'feComposite': true,\n    'feConvolveMatrix': true,\n    'feDiffuseLighting': true,\n    'feDisplacementMap': true,\n    'feFlood': true,\n    'feGaussianBlur': true,\n    'feImage': true,\n    'feMerge': true,\n    'feMorphology': true,\n    'feOffset': true,\n    'feSpecularLighting': true,\n    'feTile': true,\n    'feTurbulence': true,\n    'filter': true,\n    'font': true,\n    'foreignObject': true,\n    'g': true,\n    'glyph': true,\n    'glyphRef': true,\n    'image': true,\n    'line': true,\n    'linearGradient': true,\n    'marker': true,\n    'mask': true,\n    'missing-glyph': true,\n    'path': true,\n    'pattern': true,\n    'polygon': true,\n    'polyline': true,\n    'radialGradient': true,\n    'rect': true,\n    'stop': true,\n    'svg': true,\n    'switch': true,\n    'symbol': true,\n    'text': true,\n    'textPath': true,\n    'tref': true,\n    'tspan': true,\n    'use': true\n  };\n\n  svgPresentationAttributes = {\n    'alignment-baseline': true,\n    'baseline-shift': true,\n    'clip-path': true,\n    'clip-rule': true,\n    'clip': true,\n    'color-interpolation-filters': true,\n    'color-interpolation': true,\n    'color-profile': true,\n    'color-rendering': true,\n    'color': true,\n    'cursor': true,\n    'direction': true,\n    'display': true,\n    'dominant-baseline': true,\n    'enable-background': true,\n    'fill-opacity': true,\n    'fill-rule': true,\n    'fill': true,\n    'filter': true,\n    'flood-color': true,\n    'flood-opacity': true,\n    'font-family': true,\n    'font-size-adjust': true,\n    'font-size': true,\n    'font-stretch': true,\n    'font-style': true,\n    'font-variant': true,\n    'font-weight': true,\n    'glyph-orientation-horizontal': true,\n    'glyph-orientation-vertical': true,\n    'image-rendering': true,\n    'kerning': true,\n    'letter-spacing': true,\n    'lighting-color': true,\n    'marker-end': true,\n    'marker-mid': true,\n    'marker-start': true,\n    'mask': true,\n    'opacity': true,\n    'overflow': true,\n    'pointer-events': true,\n    'shape-rendering': true,\n    'stop-color': true,\n    'stop-opacity': true,\n    'stroke-dasharray': true,\n    'stroke-dashoffset': true,\n    'stroke-linecap': true,\n    'stroke-linejoin': true,\n    'stroke-miterlimit': true,\n    'stroke-opacity': true,\n    'stroke-width': true,\n    'stroke': true,\n    'text-anchor': true,\n    'text-decoration': true,\n    'text-rendering': true,\n    'unicode-bidi': true,\n    'visibility': true,\n    'word-spacing': true,\n    'writing-mode': true\n  };\n\n  let createElement = function (html) {\n    let div = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].createElement('div');\n    div.innerHTML = html;\n    return div.firstChild;\n  };\n\n  svgAnalyzer = class SVGAnalyzer {\n    constructor() {\n      if (createElement('<svg><altGlyph /></svg>').firstElementChild.nodeName === 'altglyph' && elements.altGlyph) {\n        elements.altglyph = elements.altGlyph;\n        delete elements.altGlyph;\n        elements.altglyphdef = elements.altGlyphDef;\n        delete elements.altGlyphDef;\n        elements.altglyphitem = elements.altGlyphItem;\n        delete elements.altGlyphItem;\n        elements.glyphref = elements.glyphRef;\n        delete elements.glyphRef;\n      }\n    }\n\n    isStandardSvgAttribute(nodeName, attributeName) {\n      return presentationElements[nodeName] && presentationAttributes[attributeName] || elements[nodeName] && elements[nodeName].indexOf(attributeName) !== -1;\n    }\n  };\n}\n\nconst elements = svgElements;\nconst presentationElements = svgPresentationElements;\nconst presentationAttributes = svgPresentationAttributes;\nconst SVGAnalyzer = svgAnalyzer || class {\n  isStandardSvgAttribute() {\n    return false;\n  }\n};\n\nlet ObserverLocator = (_temp = _class11 = class ObserverLocator {\n  constructor(taskQueue, eventManager, dirtyChecker, svgAnalyzer, parser) {\n    this.taskQueue = taskQueue;\n    this.eventManager = eventManager;\n    this.dirtyChecker = dirtyChecker;\n    this.svgAnalyzer = svgAnalyzer;\n    this.parser = parser;\n\n    this.adapters = [];\n    this.logger = aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('observer-locator');\n  }\n\n  getObserver(obj, propertyName) {\n    let observersLookup = obj.__observers__;\n    let observer;\n\n    if (observersLookup && propertyName in observersLookup) {\n      return observersLookup[propertyName];\n    }\n\n    observer = this.createPropertyObserver(obj, propertyName);\n\n    if (!observer.doNotCache) {\n      if (observersLookup === undefined) {\n        observersLookup = this.getOrCreateObserversLookup(obj);\n      }\n\n      observersLookup[propertyName] = observer;\n    }\n\n    return observer;\n  }\n\n  getOrCreateObserversLookup(obj) {\n    return obj.__observers__ || this.createObserversLookup(obj);\n  }\n\n  createObserversLookup(obj) {\n    let value = {};\n\n    if (!Reflect.defineProperty(obj, '__observers__', {\n      enumerable: false,\n      configurable: false,\n      writable: false,\n      value: value\n    })) {\n      this.logger.warn('Cannot add observers to object', obj);\n    }\n\n    return value;\n  }\n\n  addAdapter(adapter) {\n    this.adapters.push(adapter);\n  }\n\n  getAdapterObserver(obj, propertyName, descriptor) {\n    for (let i = 0, ii = this.adapters.length; i < ii; i++) {\n      let adapter = this.adapters[i];\n      let observer = adapter.getObserver(obj, propertyName, descriptor);\n      if (observer) {\n        return observer;\n      }\n    }\n    return null;\n  }\n\n  createPropertyObserver(obj, propertyName) {\n    let descriptor;\n    let handler;\n    let xlinkResult;\n\n    if (!(obj instanceof Object)) {\n      return new PrimitiveObserver(obj, propertyName);\n    }\n\n    if (obj instanceof aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element) {\n      if (propertyName === 'class') {\n        return new ClassObserver(obj);\n      }\n      if (propertyName === 'style' || propertyName === 'css') {\n        return new StyleObserver(obj, propertyName);\n      }\n      handler = this.eventManager.getElementHandler(obj, propertyName);\n      if (propertyName === 'value' && obj.tagName.toLowerCase() === 'select') {\n        return new SelectValueObserver(obj, handler, this);\n      }\n      if (propertyName === 'checked' && obj.tagName.toLowerCase() === 'input') {\n        return new CheckedObserver(obj, handler, this);\n      }\n      if (handler) {\n        return new ValueAttributeObserver(obj, propertyName, handler);\n      }\n      xlinkResult = /^xlink:(.+)$/.exec(propertyName);\n      if (xlinkResult) {\n        return new XLinkAttributeObserver(obj, propertyName, xlinkResult[1]);\n      }\n      if (propertyName === 'role' && (obj instanceof aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element || obj instanceof aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].SVGElement) || /^\\w+:|^data-|^aria-/.test(propertyName) || obj instanceof aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].SVGElement && this.svgAnalyzer.isStandardSvgAttribute(obj.nodeName, propertyName)) {\n        return new DataAttributeObserver(obj, propertyName);\n      }\n    }\n\n    descriptor = Object.getPropertyDescriptor(obj, propertyName);\n\n    if (hasDeclaredDependencies(descriptor)) {\n      return createComputedObserver(obj, propertyName, descriptor, this);\n    }\n\n    if (descriptor) {\n      const existingGetterOrSetter = descriptor.get || descriptor.set;\n      if (existingGetterOrSetter) {\n        if (existingGetterOrSetter.getObserver) {\n          return existingGetterOrSetter.getObserver(obj);\n        }\n\n        let adapterObserver = this.getAdapterObserver(obj, propertyName, descriptor);\n        if (adapterObserver) {\n          return adapterObserver;\n        }\n        return new DirtyCheckProperty(this.dirtyChecker, obj, propertyName);\n      }\n    }\n\n    if (obj instanceof Array) {\n      if (propertyName === 'length') {\n        return this.getArrayObserver(obj).getLengthObserver();\n      }\n\n      return new DirtyCheckProperty(this.dirtyChecker, obj, propertyName);\n    } else if (obj instanceof Map) {\n      if (propertyName === 'size') {\n        return this.getMapObserver(obj).getLengthObserver();\n      }\n\n      return new DirtyCheckProperty(this.dirtyChecker, obj, propertyName);\n    } else if (obj instanceof Set) {\n      if (propertyName === 'size') {\n        return this.getSetObserver(obj).getLengthObserver();\n      }\n\n      return new DirtyCheckProperty(this.dirtyChecker, obj, propertyName);\n    }\n\n    return new SetterObserver(this.taskQueue, obj, propertyName);\n  }\n\n  getAccessor(obj, propertyName) {\n    if (obj instanceof aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element) {\n      if (propertyName === 'class' || propertyName === 'style' || propertyName === 'css' || propertyName === 'value' && (obj.tagName.toLowerCase() === 'input' || obj.tagName.toLowerCase() === 'select') || propertyName === 'checked' && obj.tagName.toLowerCase() === 'input' || propertyName === 'model' && obj.tagName.toLowerCase() === 'input' || /^xlink:.+$/.exec(propertyName)) {\n        return this.getObserver(obj, propertyName);\n      }\n      if (/^\\w+:|^data-|^aria-/.test(propertyName) || obj instanceof aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].SVGElement && this.svgAnalyzer.isStandardSvgAttribute(obj.nodeName, propertyName) || obj.tagName.toLowerCase() === 'img' && propertyName === 'src' || obj.tagName.toLowerCase() === 'a' && propertyName === 'href') {\n        return dataAttributeAccessor;\n      }\n    }\n    return propertyAccessor;\n  }\n\n  getArrayObserver(array) {\n    return getArrayObserver(this.taskQueue, array);\n  }\n\n  getMapObserver(map) {\n    return getMapObserver(this.taskQueue, map);\n  }\n\n  getSetObserver(set) {\n    return getSetObserver(this.taskQueue, set);\n  }\n}, _class11.inject = [aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__[\"TaskQueue\"], EventManager, DirtyChecker, SVGAnalyzer, Parser], _temp);\n\nlet ObjectObservationAdapter = class ObjectObservationAdapter {\n  getObserver(object, propertyName, descriptor) {\n    throw new Error('BindingAdapters must implement getObserver(object, propertyName).');\n  }\n};\n\nlet BindingExpression = class BindingExpression {\n  constructor(observerLocator, targetProperty, sourceExpression, mode, lookupFunctions, attribute) {\n    this.observerLocator = observerLocator;\n    this.targetProperty = targetProperty;\n    this.sourceExpression = sourceExpression;\n    this.mode = mode;\n    this.lookupFunctions = lookupFunctions;\n    this.attribute = attribute;\n    this.discrete = false;\n  }\n\n  createBinding(target) {\n    return new Binding(this.observerLocator, this.sourceExpression, target, this.targetProperty, this.mode, this.lookupFunctions);\n  }\n};\n\nlet Binding = (_dec10 = connectable(), _dec10(_class12 = class Binding {\n  constructor(observerLocator, sourceExpression, target, targetProperty, mode, lookupFunctions) {\n    this.observerLocator = observerLocator;\n    this.sourceExpression = sourceExpression;\n    this.target = target;\n    this.targetProperty = targetProperty;\n    this.mode = mode;\n    this.lookupFunctions = lookupFunctions;\n  }\n\n  updateTarget(value) {\n    this.targetObserver.setValue(value, this.target, this.targetProperty);\n  }\n\n  updateSource(value) {\n    this.sourceExpression.assign(this.source, value, this.lookupFunctions);\n  }\n\n  call(context, newValue, oldValue) {\n    if (!this.isBound) {\n      return;\n    }\n    if (context === sourceContext) {\n      oldValue = this.targetObserver.getValue(this.target, this.targetProperty);\n      newValue = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\n      if (newValue !== oldValue) {\n        this.updateTarget(newValue);\n      }\n      if (this.mode !== bindingMode.oneTime) {\n        this._version++;\n        this.sourceExpression.connect(this, this.source);\n        this.unobserve(false);\n      }\n      return;\n    }\n    if (context === targetContext) {\n      if (newValue !== this.sourceExpression.evaluate(this.source, this.lookupFunctions)) {\n        this.updateSource(newValue);\n      }\n      return;\n    }\n    throw new Error(`Unexpected call context ${context}`);\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n    this.isBound = true;\n    this.source = source;\n\n    if (this.sourceExpression.bind) {\n      this.sourceExpression.bind(this, source, this.lookupFunctions);\n    }\n\n    let mode = this.mode;\n    if (!this.targetObserver) {\n      let method = mode === bindingMode.twoWay || mode === bindingMode.fromView ? 'getObserver' : 'getAccessor';\n      this.targetObserver = this.observerLocator[method](this.target, this.targetProperty);\n    }\n\n    if ('bind' in this.targetObserver) {\n      this.targetObserver.bind();\n    }\n    if (this.mode !== bindingMode.fromView) {\n      let value = this.sourceExpression.evaluate(source, this.lookupFunctions);\n      this.updateTarget(value);\n    }\n\n    if (mode === bindingMode.oneTime) {\n      return;\n    } else if (mode === bindingMode.toView) {\n      enqueueBindingConnect(this);\n    } else if (mode === bindingMode.twoWay) {\n      this.sourceExpression.connect(this, source);\n      this.targetObserver.subscribe(targetContext, this);\n    } else if (mode === bindingMode.fromView) {\n      this.targetObserver.subscribe(targetContext, this);\n    }\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    if (this.sourceExpression.unbind) {\n      this.sourceExpression.unbind(this, this.source);\n    }\n    this.source = null;\n    if ('unbind' in this.targetObserver) {\n      this.targetObserver.unbind();\n    }\n    if (this.targetObserver.unsubscribe) {\n      this.targetObserver.unsubscribe(targetContext, this);\n    }\n    this.unobserve(true);\n  }\n\n  connect(evaluate) {\n    if (!this.isBound) {\n      return;\n    }\n    if (evaluate) {\n      let value = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\n      this.updateTarget(value);\n    }\n    this.sourceExpression.connect(this, this.source);\n  }\n}) || _class12);\n\nlet CallExpression = class CallExpression {\n  constructor(observerLocator, targetProperty, sourceExpression, lookupFunctions) {\n    this.observerLocator = observerLocator;\n    this.targetProperty = targetProperty;\n    this.sourceExpression = sourceExpression;\n    this.lookupFunctions = lookupFunctions;\n  }\n\n  createBinding(target) {\n    return new Call(this.observerLocator, this.sourceExpression, target, this.targetProperty, this.lookupFunctions);\n  }\n};\n\nlet Call = class Call {\n  constructor(observerLocator, sourceExpression, target, targetProperty, lookupFunctions) {\n    this.sourceExpression = sourceExpression;\n    this.target = target;\n    this.targetProperty = observerLocator.getObserver(target, targetProperty);\n    this.lookupFunctions = lookupFunctions;\n  }\n\n  callSource($event) {\n    let overrideContext = this.source.overrideContext;\n    Object.assign(overrideContext, $event);\n    overrideContext.$event = $event;\n    let mustEvaluate = true;\n    let result = this.sourceExpression.evaluate(this.source, this.lookupFunctions, mustEvaluate);\n    delete overrideContext.$event;\n    for (let prop in $event) {\n      delete overrideContext[prop];\n    }\n    return result;\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n    this.isBound = true;\n    this.source = source;\n\n    if (this.sourceExpression.bind) {\n      this.sourceExpression.bind(this, source, this.lookupFunctions);\n    }\n    this.targetProperty.setValue($event => this.callSource($event));\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    if (this.sourceExpression.unbind) {\n      this.sourceExpression.unbind(this, this.source);\n    }\n    this.source = null;\n    this.targetProperty.setValue(null);\n  }\n};\n\nlet ValueConverterResource = class ValueConverterResource {\n  constructor(name) {\n    this.name = name;\n  }\n\n  static convention(name) {\n    if (name.endsWith('ValueConverter')) {\n      return new ValueConverterResource(camelCase(name.substring(0, name.length - 14)));\n    }\n  }\n\n  initialize(container, target) {\n    this.instance = container.get(target);\n  }\n\n  register(registry, name) {\n    registry.registerValueConverter(name || this.name, this.instance);\n  }\n\n  load(container, target) {}\n};\n\nfunction valueConverter(nameOrTarget) {\n  if (nameOrTarget === undefined || typeof nameOrTarget === 'string') {\n    return function (target) {\n      aurelia_metadata__WEBPACK_IMPORTED_MODULE_3__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_3__[\"metadata\"].resource, new ValueConverterResource(nameOrTarget), target);\n    };\n  }\n\n  aurelia_metadata__WEBPACK_IMPORTED_MODULE_3__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_3__[\"metadata\"].resource, new ValueConverterResource(), nameOrTarget);\n}\n\nlet BindingBehaviorResource = class BindingBehaviorResource {\n  constructor(name) {\n    this.name = name;\n  }\n\n  static convention(name) {\n    if (name.endsWith('BindingBehavior')) {\n      return new BindingBehaviorResource(camelCase(name.substring(0, name.length - 15)));\n    }\n  }\n\n  initialize(container, target) {\n    this.instance = container.get(target);\n  }\n\n  register(registry, name) {\n    registry.registerBindingBehavior(name || this.name, this.instance);\n  }\n\n  load(container, target) {}\n};\n\nfunction bindingBehavior(nameOrTarget) {\n  if (nameOrTarget === undefined || typeof nameOrTarget === 'string') {\n    return function (target) {\n      aurelia_metadata__WEBPACK_IMPORTED_MODULE_3__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_3__[\"metadata\"].resource, new BindingBehaviorResource(nameOrTarget), target);\n    };\n  }\n\n  aurelia_metadata__WEBPACK_IMPORTED_MODULE_3__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_3__[\"metadata\"].resource, new BindingBehaviorResource(), nameOrTarget);\n}\n\nlet ListenerExpression = class ListenerExpression {\n  constructor(eventManager, targetEvent, sourceExpression, delegationStrategy, preventDefault, lookupFunctions) {\n    this.eventManager = eventManager;\n    this.targetEvent = targetEvent;\n    this.sourceExpression = sourceExpression;\n    this.delegationStrategy = delegationStrategy;\n    this.discrete = true;\n    this.preventDefault = preventDefault;\n    this.lookupFunctions = lookupFunctions;\n  }\n\n  createBinding(target) {\n    return new Listener(this.eventManager, this.targetEvent, this.delegationStrategy, this.sourceExpression, target, this.preventDefault, this.lookupFunctions);\n  }\n};\n\nlet Listener = class Listener {\n  constructor(eventManager, targetEvent, delegationStrategy, sourceExpression, target, preventDefault, lookupFunctions) {\n    this.eventManager = eventManager;\n    this.targetEvent = targetEvent;\n    this.delegationStrategy = delegationStrategy;\n    this.sourceExpression = sourceExpression;\n    this.target = target;\n    this.preventDefault = preventDefault;\n    this.lookupFunctions = lookupFunctions;\n  }\n\n  callSource(event) {\n    let overrideContext = this.source.overrideContext;\n    overrideContext.$event = event;\n    let mustEvaluate = true;\n    let result = this.sourceExpression.evaluate(this.source, this.lookupFunctions, mustEvaluate);\n    delete overrideContext.$event;\n    if (result !== true && this.preventDefault) {\n      event.preventDefault();\n    }\n    return result;\n  }\n\n  handleEvent(event) {\n    this.callSource(event);\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n    this.isBound = true;\n    this.source = source;\n\n    if (this.sourceExpression.bind) {\n      this.sourceExpression.bind(this, source, this.lookupFunctions);\n    }\n    this._handler = this.eventManager.addEventListener(this.target, this.targetEvent, this, this.delegationStrategy, true);\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    if (this.sourceExpression.unbind) {\n      this.sourceExpression.unbind(this, this.source);\n    }\n    this.source = null;\n    this._handler.dispose();\n    this._handler = null;\n  }\n};\n\nfunction getAU(element) {\n  let au = element.au;\n\n  if (au === undefined) {\n    throw new Error(`No Aurelia APIs are defined for the element: \"${element.tagName}\".`);\n  }\n\n  return au;\n}\n\nlet NameExpression = class NameExpression {\n  constructor(sourceExpression, apiName, lookupFunctions) {\n    this.sourceExpression = sourceExpression;\n    this.apiName = apiName;\n    this.lookupFunctions = lookupFunctions;\n    this.discrete = true;\n  }\n\n  createBinding(target) {\n    return new NameBinder(this.sourceExpression, NameExpression.locateAPI(target, this.apiName), this.lookupFunctions);\n  }\n\n  static locateAPI(element, apiName) {\n    switch (apiName) {\n      case 'element':\n        return element;\n      case 'controller':\n        return getAU(element).controller;\n      case 'view-model':\n        return getAU(element).controller.viewModel;\n      case 'view':\n        return getAU(element).controller.view;\n      default:\n        let target = getAU(element)[apiName];\n\n        if (target === undefined) {\n          throw new Error(`Attempted to reference \"${apiName}\", but it was not found amongst the target's API.`);\n        }\n\n        return target.viewModel;\n    }\n  }\n};\n\nlet NameBinder = class NameBinder {\n  constructor(sourceExpression, target, lookupFunctions) {\n    this.sourceExpression = sourceExpression;\n    this.target = target;\n    this.lookupFunctions = lookupFunctions;\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n    this.isBound = true;\n    this.source = source;\n    if (this.sourceExpression.bind) {\n      this.sourceExpression.bind(this, source, this.lookupFunctions);\n    }\n    this.sourceExpression.assign(this.source, this.target, this.lookupFunctions);\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    if (this.sourceExpression.evaluate(this.source, this.lookupFunctions) === this.target) {\n      this.sourceExpression.assign(this.source, null, this.lookupFunctions);\n    }\n    if (this.sourceExpression.unbind) {\n      this.sourceExpression.unbind(this, this.source);\n    }\n    this.source = null;\n  }\n};\n\n\nconst LookupFunctions = {\n  bindingBehaviors: name => null,\n  valueConverters: name => null\n};\n\nlet BindingEngine = (_temp2 = _class13 = class BindingEngine {\n\n  constructor(observerLocator, parser) {\n    this.observerLocator = observerLocator;\n    this.parser = parser;\n  }\n\n  createBindingExpression(targetProperty, sourceExpression, mode = bindingMode.toView, lookupFunctions = LookupFunctions) {\n    return new BindingExpression(this.observerLocator, targetProperty, this.parser.parse(sourceExpression), mode, lookupFunctions);\n  }\n\n  propertyObserver(obj, propertyName) {\n    return {\n      subscribe: callback => {\n        let observer = this.observerLocator.getObserver(obj, propertyName);\n        observer.subscribe(callback);\n        return {\n          dispose: () => observer.unsubscribe(callback)\n        };\n      }\n    };\n  }\n\n  collectionObserver(collection) {\n    return {\n      subscribe: callback => {\n        let observer;\n        if (collection instanceof Array) {\n          observer = this.observerLocator.getArrayObserver(collection);\n        } else if (collection instanceof Map) {\n          observer = this.observerLocator.getMapObserver(collection);\n        } else if (collection instanceof Set) {\n          observer = this.observerLocator.getSetObserver(collection);\n        } else {\n          throw new Error('collection must be an instance of Array, Map or Set.');\n        }\n        observer.subscribe(callback);\n        return {\n          dispose: () => observer.unsubscribe(callback)\n        };\n      }\n    };\n  }\n\n  expressionObserver(bindingContext, expression) {\n    let scope = { bindingContext, overrideContext: createOverrideContext(bindingContext) };\n    return new ExpressionObserver(scope, this.parser.parse(expression), this.observerLocator, LookupFunctions);\n  }\n\n  parseExpression(expression) {\n    return this.parser.parse(expression);\n  }\n\n  registerAdapter(adapter) {\n    this.observerLocator.addAdapter(adapter);\n  }\n}, _class13.inject = [ObserverLocator, Parser], _temp2);\n\nlet setProto = Set.prototype;\n\nfunction getSetObserver(taskQueue, set) {\n  return ModifySetObserver.for(taskQueue, set);\n}\n\nlet ModifySetObserver = class ModifySetObserver extends ModifyCollectionObserver {\n  constructor(taskQueue, set) {\n    super(taskQueue, set);\n  }\n\n  static for(taskQueue, set) {\n    if (!('__set_observer__' in set)) {\n      Reflect.defineProperty(set, '__set_observer__', {\n        value: ModifySetObserver.create(taskQueue, set),\n        enumerable: false, configurable: false\n      });\n    }\n    return set.__set_observer__;\n  }\n\n  static create(taskQueue, set) {\n    let observer = new ModifySetObserver(taskQueue, set);\n\n    let proto = setProto;\n    if (proto.add !== set.add || proto.delete !== set.delete || proto.clear !== set.clear) {\n      proto = {\n        add: set.add,\n        delete: set.delete,\n        clear: set.clear\n      };\n    }\n\n    set.add = function () {\n      let type = 'add';\n      let oldSize = set.size;\n      let methodCallResult = proto.add.apply(set, arguments);\n      let hasValue = set.size === oldSize;\n      if (!hasValue) {\n        observer.addChangeRecord({\n          type: type,\n          object: set,\n          value: Array.from(set).pop()\n        });\n      }\n      return methodCallResult;\n    };\n\n    set.delete = function () {\n      let hasValue = set.has(arguments[0]);\n      let methodCallResult = proto.delete.apply(set, arguments);\n      if (hasValue) {\n        observer.addChangeRecord({\n          type: 'delete',\n          object: set,\n          value: arguments[0]\n        });\n      }\n      return methodCallResult;\n    };\n\n    set.clear = function () {\n      let methodCallResult = proto.clear.apply(set, arguments);\n      observer.addChangeRecord({\n        type: 'clear',\n        object: set\n      });\n      return methodCallResult;\n    };\n\n    return observer;\n  }\n};\n\n\nfunction observable(targetOrConfig, key, descriptor) {\n  function deco(target, key, descriptor, config) {\n    const isClassDecorator = key === undefined;\n    if (isClassDecorator) {\n      target = target.prototype;\n      key = typeof config === 'string' ? config : config.name;\n    }\n\n    let innerPropertyName = `_${key}`;\n    const innerPropertyDescriptor = {\n      configurable: true,\n      enumerable: false,\n      writable: true\n    };\n\n    const callbackName = config && config.changeHandler || `${key}Changed`;\n\n    if (descriptor) {\n      if (typeof descriptor.initializer === 'function') {\n        innerPropertyDescriptor.value = descriptor.initializer();\n      }\n    } else {\n      descriptor = {};\n    }\n\n    if (!('enumerable' in descriptor)) {\n      descriptor.enumerable = true;\n    }\n\n    delete descriptor.value;\n    delete descriptor.writable;\n    delete descriptor.initializer;\n\n    Reflect.defineProperty(target, innerPropertyName, innerPropertyDescriptor);\n\n    descriptor.get = function () {\n      return this[innerPropertyName];\n    };\n    descriptor.set = function (newValue) {\n      let oldValue = this[innerPropertyName];\n      if (newValue === oldValue) {\n        return;\n      }\n\n      this[innerPropertyName] = newValue;\n      Reflect.defineProperty(this, innerPropertyName, { enumerable: false });\n\n      if (this[callbackName]) {\n        this[callbackName](newValue, oldValue, key);\n      }\n    };\n\n    descriptor.get.dependencies = [innerPropertyName];\n\n    if (isClassDecorator) {\n      Reflect.defineProperty(target, key, descriptor);\n    } else {\n      return descriptor;\n    }\n  }\n\n  if (key === undefined) {\n    return (t, k, d) => deco(t, k, d, targetOrConfig);\n  }\n  return deco(targetOrConfig, key, descriptor);\n}\n\nconst signals = {};\n\nfunction connectBindingToSignal(binding, name) {\n  if (!signals.hasOwnProperty(name)) {\n    signals[name] = 0;\n  }\n  binding.observeProperty(signals, name);\n}\n\nfunction signalBindings(name) {\n  if (signals.hasOwnProperty(name)) {\n    signals[name]++;\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1iaW5kaW5nL2Rpc3QvZXMyMDE1L2F1cmVsaWEtYmluZGluZy5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLWJpbmRpbmcvZGlzdC9lczIwMTUvYXVyZWxpYS1iaW5kaW5nLmpzPzM0M2IiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9kZWMsIF9kZWMyLCBfY2xhc3MsIF9kZWMzLCBfY2xhc3MyLCBfZGVjNCwgX2NsYXNzMywgX2RlYzUsIF9jbGFzczUsIF9kZWM2LCBfY2xhc3M3LCBfZGVjNywgX2NsYXNzOCwgX2RlYzgsIF9jbGFzczksIF9kZWM5LCBfY2xhc3MxMCwgX2NsYXNzMTEsIF90ZW1wLCBfZGVjMTAsIF9jbGFzczEyLCBfY2xhc3MxMywgX3RlbXAyO1xuXG5pbXBvcnQgKiBhcyBMb2dNYW5hZ2VyIGZyb20gJ2F1cmVsaWEtbG9nZ2luZyc7XG5pbXBvcnQgeyBQTEFURk9STSwgRE9NIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuaW1wb3J0IHsgVGFza1F1ZXVlIH0gZnJvbSAnYXVyZWxpYS10YXNrLXF1ZXVlJztcbmltcG9ydCB7IG1ldGFkYXRhIH0gZnJvbSAnYXVyZWxpYS1tZXRhZGF0YSc7XG5cbmV4cG9ydCBjb25zdCB0YXJnZXRDb250ZXh0ID0gJ0JpbmRpbmc6dGFyZ2V0JztcbmV4cG9ydCBjb25zdCBzb3VyY2VDb250ZXh0ID0gJ0JpbmRpbmc6c291cmNlJztcblxuY29uc3QgbWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNhbWVsQ2FzZShuYW1lKSB7XG4gIGlmIChuYW1lIGluIG1hcCkge1xuICAgIHJldHVybiBtYXBbbmFtZV07XG4gIH1cbiAgY29uc3QgcmVzdWx0ID0gbmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIG5hbWUuc2xpY2UoMSkucmVwbGFjZSgvW18uLV0oXFx3fCQpL2csIChfLCB4KSA9PiB4LnRvVXBwZXJDYXNlKCkpO1xuICBtYXBbbmFtZV0gPSByZXN1bHQ7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVPdmVycmlkZUNvbnRleHQoYmluZGluZ0NvbnRleHQsIHBhcmVudE92ZXJyaWRlQ29udGV4dCkge1xuICByZXR1cm4ge1xuICAgIGJpbmRpbmdDb250ZXh0OiBiaW5kaW5nQ29udGV4dCxcbiAgICBwYXJlbnRPdmVycmlkZUNvbnRleHQ6IHBhcmVudE92ZXJyaWRlQ29udGV4dCB8fCBudWxsXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250ZXh0Rm9yKG5hbWUsIHNjb3BlLCBhbmNlc3Rvcikge1xuICBsZXQgb2MgPSBzY29wZS5vdmVycmlkZUNvbnRleHQ7XG5cbiAgaWYgKGFuY2VzdG9yKSB7XG4gICAgd2hpbGUgKGFuY2VzdG9yICYmIG9jKSB7XG4gICAgICBhbmNlc3Rvci0tO1xuICAgICAgb2MgPSBvYy5wYXJlbnRPdmVycmlkZUNvbnRleHQ7XG4gICAgfVxuICAgIGlmIChhbmNlc3RvciB8fCAhb2MpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiBuYW1lIGluIG9jID8gb2MgOiBvYy5iaW5kaW5nQ29udGV4dDtcbiAgfVxuXG4gIHdoaWxlIChvYyAmJiAhKG5hbWUgaW4gb2MpICYmICEob2MuYmluZGluZ0NvbnRleHQgJiYgbmFtZSBpbiBvYy5iaW5kaW5nQ29udGV4dCkpIHtcbiAgICBvYyA9IG9jLnBhcmVudE92ZXJyaWRlQ29udGV4dDtcbiAgfVxuICBpZiAob2MpIHtcbiAgICByZXR1cm4gbmFtZSBpbiBvYyA/IG9jIDogb2MuYmluZGluZ0NvbnRleHQ7XG4gIH1cblxuICByZXR1cm4gc2NvcGUuYmluZGluZ0NvbnRleHQgfHwgc2NvcGUub3ZlcnJpZGVDb250ZXh0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2NvcGVGb3JUZXN0KGJpbmRpbmdDb250ZXh0LCBwYXJlbnRCaW5kaW5nQ29udGV4dCkge1xuICBpZiAocGFyZW50QmluZGluZ0NvbnRleHQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYmluZGluZ0NvbnRleHQsXG4gICAgICBvdmVycmlkZUNvbnRleHQ6IGNyZWF0ZU92ZXJyaWRlQ29udGV4dChiaW5kaW5nQ29udGV4dCwgY3JlYXRlT3ZlcnJpZGVDb250ZXh0KHBhcmVudEJpbmRpbmdDb250ZXh0KSlcbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgYmluZGluZ0NvbnRleHQsXG4gICAgb3ZlcnJpZGVDb250ZXh0OiBjcmVhdGVPdmVycmlkZUNvbnRleHQoYmluZGluZ0NvbnRleHQpXG4gIH07XG59XG5cbmNvbnN0IHNsb3ROYW1lcyA9IFtdO1xuY29uc3QgdmVyc2lvblNsb3ROYW1lcyA9IFtdO1xubGV0IGxhc3RTbG90ID0gLTE7XG5mdW5jdGlvbiBlbnN1cmVFbm91Z2hTbG90TmFtZXMoY3VycmVudFNsb3QpIHtcbiAgaWYgKGN1cnJlbnRTbG90ID09PSBsYXN0U2xvdCkge1xuICAgIGxhc3RTbG90ICs9IDU7XG4gICAgY29uc3QgaWkgPSBzbG90TmFtZXMubGVuZ3RoID0gdmVyc2lvblNsb3ROYW1lcy5sZW5ndGggPSBsYXN0U2xvdCArIDE7XG4gICAgZm9yIChsZXQgaSA9IGN1cnJlbnRTbG90ICsgMTsgaSA8IGlpOyArK2kpIHtcbiAgICAgIHNsb3ROYW1lc1tpXSA9IGBfb2JzZXJ2ZXIke2l9YDtcbiAgICAgIHZlcnNpb25TbG90TmFtZXNbaV0gPSBgX29ic2VydmVyVmVyc2lvbiR7aX1gO1xuICAgIH1cbiAgfVxufVxuZW5zdXJlRW5vdWdoU2xvdE5hbWVzKC0xKTtcblxuZnVuY3Rpb24gYWRkT2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcbiAgbGV0IG9ic2VydmVyU2xvdHMgPSB0aGlzLl9vYnNlcnZlclNsb3RzID09PSB1bmRlZmluZWQgPyAwIDogdGhpcy5fb2JzZXJ2ZXJTbG90cztcbiAgbGV0IGkgPSBvYnNlcnZlclNsb3RzO1xuICB3aGlsZSAoaS0tICYmIHRoaXNbc2xvdE5hbWVzW2ldXSAhPT0gb2JzZXJ2ZXIpIHt9XG5cbiAgaWYgKGkgPT09IC0xKSB7XG4gICAgaSA9IDA7XG4gICAgd2hpbGUgKHRoaXNbc2xvdE5hbWVzW2ldXSkge1xuICAgICAgaSsrO1xuICAgIH1cbiAgICB0aGlzW3Nsb3ROYW1lc1tpXV0gPSBvYnNlcnZlcjtcbiAgICBvYnNlcnZlci5zdWJzY3JpYmUoc291cmNlQ29udGV4dCwgdGhpcyk7XG5cbiAgICBpZiAoaSA9PT0gb2JzZXJ2ZXJTbG90cykge1xuICAgICAgdGhpcy5fb2JzZXJ2ZXJTbG90cyA9IGkgKyAxO1xuICAgIH1cbiAgfVxuXG4gIGlmICh0aGlzLl92ZXJzaW9uID09PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl92ZXJzaW9uID0gMDtcbiAgfVxuICB0aGlzW3ZlcnNpb25TbG90TmFtZXNbaV1dID0gdGhpcy5fdmVyc2lvbjtcbiAgZW5zdXJlRW5vdWdoU2xvdE5hbWVzKGkpO1xufVxuXG5mdW5jdGlvbiBvYnNlcnZlUHJvcGVydHkob2JqLCBwcm9wZXJ0eU5hbWUpIHtcbiAgbGV0IG9ic2VydmVyID0gdGhpcy5vYnNlcnZlckxvY2F0b3IuZ2V0T2JzZXJ2ZXIob2JqLCBwcm9wZXJ0eU5hbWUpO1xuICBhZGRPYnNlcnZlci5jYWxsKHRoaXMsIG9ic2VydmVyKTtcbn1cblxuZnVuY3Rpb24gb2JzZXJ2ZUFycmF5KGFycmF5KSB7XG4gIGxldCBvYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXJMb2NhdG9yLmdldEFycmF5T2JzZXJ2ZXIoYXJyYXkpO1xuICBhZGRPYnNlcnZlci5jYWxsKHRoaXMsIG9ic2VydmVyKTtcbn1cblxuZnVuY3Rpb24gdW5vYnNlcnZlKGFsbCkge1xuICBsZXQgaSA9IHRoaXMuX29ic2VydmVyU2xvdHM7XG4gIHdoaWxlIChpLS0pIHtcbiAgICBpZiAoYWxsIHx8IHRoaXNbdmVyc2lvblNsb3ROYW1lc1tpXV0gIT09IHRoaXMuX3ZlcnNpb24pIHtcbiAgICAgIGxldCBvYnNlcnZlciA9IHRoaXNbc2xvdE5hbWVzW2ldXTtcbiAgICAgIHRoaXNbc2xvdE5hbWVzW2ldXSA9IG51bGw7XG4gICAgICBpZiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgb2JzZXJ2ZXIudW5zdWJzY3JpYmUoc291cmNlQ29udGV4dCwgdGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb25uZWN0YWJsZSgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICB0YXJnZXQucHJvdG90eXBlLm9ic2VydmVQcm9wZXJ0eSA9IG9ic2VydmVQcm9wZXJ0eTtcbiAgICB0YXJnZXQucHJvdG90eXBlLm9ic2VydmVBcnJheSA9IG9ic2VydmVBcnJheTtcbiAgICB0YXJnZXQucHJvdG90eXBlLnVub2JzZXJ2ZSA9IHVub2JzZXJ2ZTtcbiAgICB0YXJnZXQucHJvdG90eXBlLmFkZE9ic2VydmVyID0gYWRkT2JzZXJ2ZXI7XG4gIH07XG59XG5cbmNvbnN0IHF1ZXVlID0gW107XG5jb25zdCBxdWV1ZWQgPSB7fTtcbmxldCBuZXh0SWQgPSAwO1xubGV0IG1pbmltdW1JbW1lZGlhdGUgPSAxMDA7XG5jb25zdCBmcmFtZUJ1ZGdldCA9IDE1O1xuXG5sZXQgaXNGbHVzaFJlcXVlc3RlZCA9IGZhbHNlO1xubGV0IGltbWVkaWF0ZSA9IDA7XG5cbmZ1bmN0aW9uIGZsdXNoKGFuaW1hdGlvbkZyYW1lU3RhcnQpIHtcbiAgY29uc3QgbGVuZ3RoID0gcXVldWUubGVuZ3RoO1xuICBsZXQgaSA9IDA7XG4gIHdoaWxlIChpIDwgbGVuZ3RoKSB7XG4gICAgY29uc3QgYmluZGluZyA9IHF1ZXVlW2ldO1xuICAgIHF1ZXVlZFtiaW5kaW5nLl9fY29ubmVjdFF1ZXVlSWRdID0gZmFsc2U7XG4gICAgYmluZGluZy5jb25uZWN0KHRydWUpO1xuICAgIGkrKztcblxuICAgIGlmIChpICUgMTAwID09PSAwICYmIFBMQVRGT1JNLnBlcmZvcm1hbmNlLm5vdygpIC0gYW5pbWF0aW9uRnJhbWVTdGFydCA+IGZyYW1lQnVkZ2V0KSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgcXVldWUuc3BsaWNlKDAsIGkpO1xuXG4gIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICBQTEFURk9STS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZmx1c2gpO1xuICB9IGVsc2Uge1xuICAgIGlzRmx1c2hSZXF1ZXN0ZWQgPSBmYWxzZTtcbiAgICBpbW1lZGlhdGUgPSAwO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbnF1ZXVlQmluZGluZ0Nvbm5lY3QoYmluZGluZykge1xuICBpZiAoaW1tZWRpYXRlIDwgbWluaW11bUltbWVkaWF0ZSkge1xuICAgIGltbWVkaWF0ZSsrO1xuICAgIGJpbmRpbmcuY29ubmVjdChmYWxzZSk7XG4gIH0gZWxzZSB7XG4gICAgbGV0IGlkID0gYmluZGluZy5fX2Nvbm5lY3RRdWV1ZUlkO1xuICAgIGlmIChpZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZCA9IG5leHRJZDtcbiAgICAgIG5leHRJZCsrO1xuICAgICAgYmluZGluZy5fX2Nvbm5lY3RRdWV1ZUlkID0gaWQ7XG4gICAgfVxuXG4gICAgaWYgKCFxdWV1ZWRbaWRdKSB7XG4gICAgICBxdWV1ZS5wdXNoKGJpbmRpbmcpO1xuICAgICAgcXVldWVkW2lkXSA9IHRydWU7XG4gICAgfVxuICB9XG4gIGlmICghaXNGbHVzaFJlcXVlc3RlZCkge1xuICAgIGlzRmx1c2hSZXF1ZXN0ZWQgPSB0cnVlO1xuICAgIFBMQVRGT1JNLnJlcXVlc3RBbmltYXRpb25GcmFtZShmbHVzaCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldENvbm5lY3RRdWV1ZVRocmVzaG9sZCh2YWx1ZSkge1xuICBtaW5pbXVtSW1tZWRpYXRlID0gdmFsdWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbmFibGVDb25uZWN0UXVldWUoKSB7XG4gIHNldENvbm5lY3RRdWV1ZVRocmVzaG9sZCgxMDApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGlzYWJsZUNvbm5lY3RRdWV1ZSgpIHtcbiAgc2V0Q29ubmVjdFF1ZXVlVGhyZXNob2xkKE51bWJlci5NQVhfU0FGRV9JTlRFR0VSKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbm5lY3RRdWV1ZVNpemUoKSB7XG4gIHJldHVybiBxdWV1ZS5sZW5ndGg7XG59XG5cbmZ1bmN0aW9uIGFkZFN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgaWYgKHRoaXMuaGFzU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKCF0aGlzLl9jb250ZXh0MCkge1xuICAgIHRoaXMuX2NvbnRleHQwID0gY29udGV4dDtcbiAgICB0aGlzLl9jYWxsYWJsZTAgPSBjYWxsYWJsZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoIXRoaXMuX2NvbnRleHQxKSB7XG4gICAgdGhpcy5fY29udGV4dDEgPSBjb250ZXh0O1xuICAgIHRoaXMuX2NhbGxhYmxlMSA9IGNhbGxhYmxlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmICghdGhpcy5fY29udGV4dDIpIHtcbiAgICB0aGlzLl9jb250ZXh0MiA9IGNvbnRleHQ7XG4gICAgdGhpcy5fY2FsbGFibGUyID0gY2FsbGFibGU7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKCF0aGlzLl9jb250ZXh0c1Jlc3QpIHtcbiAgICB0aGlzLl9jb250ZXh0c1Jlc3QgPSBbY29udGV4dF07XG4gICAgdGhpcy5fY2FsbGFibGVzUmVzdCA9IFtjYWxsYWJsZV07XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgdGhpcy5fY29udGV4dHNSZXN0LnB1c2goY29udGV4dCk7XG4gIHRoaXMuX2NhbGxhYmxlc1Jlc3QucHVzaChjYWxsYWJsZSk7XG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiByZW1vdmVTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gIGlmICh0aGlzLl9jb250ZXh0MCA9PT0gY29udGV4dCAmJiB0aGlzLl9jYWxsYWJsZTAgPT09IGNhbGxhYmxlKSB7XG4gICAgdGhpcy5fY29udGV4dDAgPSBudWxsO1xuICAgIHRoaXMuX2NhbGxhYmxlMCA9IG51bGw7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKHRoaXMuX2NvbnRleHQxID09PSBjb250ZXh0ICYmIHRoaXMuX2NhbGxhYmxlMSA9PT0gY2FsbGFibGUpIHtcbiAgICB0aGlzLl9jb250ZXh0MSA9IG51bGw7XG4gICAgdGhpcy5fY2FsbGFibGUxID0gbnVsbDtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAodGhpcy5fY29udGV4dDIgPT09IGNvbnRleHQgJiYgdGhpcy5fY2FsbGFibGUyID09PSBjYWxsYWJsZSkge1xuICAgIHRoaXMuX2NvbnRleHQyID0gbnVsbDtcbiAgICB0aGlzLl9jYWxsYWJsZTIgPSBudWxsO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGNvbnN0IGNhbGxhYmxlcyA9IHRoaXMuX2NhbGxhYmxlc1Jlc3Q7XG4gIGlmIChjYWxsYWJsZXMgPT09IHVuZGVmaW5lZCB8fCBjYWxsYWJsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGNvbnN0IGNvbnRleHRzID0gdGhpcy5fY29udGV4dHNSZXN0O1xuICBsZXQgaSA9IDA7XG4gIHdoaWxlICghKGNhbGxhYmxlc1tpXSA9PT0gY2FsbGFibGUgJiYgY29udGV4dHNbaV0gPT09IGNvbnRleHQpICYmIGNhbGxhYmxlcy5sZW5ndGggPiBpKSB7XG4gICAgaSsrO1xuICB9XG4gIGlmIChpID49IGNhbGxhYmxlcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgY29udGV4dHMuc3BsaWNlKGksIDEpO1xuICBjYWxsYWJsZXMuc3BsaWNlKGksIDEpO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxubGV0IGFycmF5UG9vbDEgPSBbXTtcbmxldCBhcnJheVBvb2wyID0gW107XG5sZXQgcG9vbFV0aWxpemF0aW9uID0gW107XG5cbmZ1bmN0aW9uIGNhbGxTdWJzY3JpYmVycyhuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgbGV0IGNvbnRleHQwID0gdGhpcy5fY29udGV4dDA7XG4gIGxldCBjYWxsYWJsZTAgPSB0aGlzLl9jYWxsYWJsZTA7XG4gIGxldCBjb250ZXh0MSA9IHRoaXMuX2NvbnRleHQxO1xuICBsZXQgY2FsbGFibGUxID0gdGhpcy5fY2FsbGFibGUxO1xuICBsZXQgY29udGV4dDIgPSB0aGlzLl9jb250ZXh0MjtcbiAgbGV0IGNhbGxhYmxlMiA9IHRoaXMuX2NhbGxhYmxlMjtcbiAgbGV0IGxlbmd0aCA9IHRoaXMuX2NvbnRleHRzUmVzdCA/IHRoaXMuX2NvbnRleHRzUmVzdC5sZW5ndGggOiAwO1xuICBsZXQgY29udGV4dHNSZXN0O1xuICBsZXQgY2FsbGFibGVzUmVzdDtcbiAgbGV0IHBvb2xJbmRleDtcbiAgbGV0IGk7XG4gIGlmIChsZW5ndGgpIHtcbiAgICBwb29sSW5kZXggPSBwb29sVXRpbGl6YXRpb24ubGVuZ3RoO1xuICAgIHdoaWxlIChwb29sSW5kZXgtLSAmJiBwb29sVXRpbGl6YXRpb25bcG9vbEluZGV4XSkge31cbiAgICBpZiAocG9vbEluZGV4IDwgMCkge1xuICAgICAgcG9vbEluZGV4ID0gcG9vbFV0aWxpemF0aW9uLmxlbmd0aDtcbiAgICAgIGNvbnRleHRzUmVzdCA9IFtdO1xuICAgICAgY2FsbGFibGVzUmVzdCA9IFtdO1xuICAgICAgcG9vbFV0aWxpemF0aW9uLnB1c2godHJ1ZSk7XG4gICAgICBhcnJheVBvb2wxLnB1c2goY29udGV4dHNSZXN0KTtcbiAgICAgIGFycmF5UG9vbDIucHVzaChjYWxsYWJsZXNSZXN0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcG9vbFV0aWxpemF0aW9uW3Bvb2xJbmRleF0gPSB0cnVlO1xuICAgICAgY29udGV4dHNSZXN0ID0gYXJyYXlQb29sMVtwb29sSW5kZXhdO1xuICAgICAgY2FsbGFibGVzUmVzdCA9IGFycmF5UG9vbDJbcG9vbEluZGV4XTtcbiAgICB9XG5cbiAgICBpID0gbGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGNvbnRleHRzUmVzdFtpXSA9IHRoaXMuX2NvbnRleHRzUmVzdFtpXTtcbiAgICAgIGNhbGxhYmxlc1Jlc3RbaV0gPSB0aGlzLl9jYWxsYWJsZXNSZXN0W2ldO1xuICAgIH1cbiAgfVxuXG4gIGlmIChjb250ZXh0MCkge1xuICAgIGlmIChjYWxsYWJsZTApIHtcbiAgICAgIGNhbGxhYmxlMC5jYWxsKGNvbnRleHQwLCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZXh0MChuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgIH1cbiAgfVxuICBpZiAoY29udGV4dDEpIHtcbiAgICBpZiAoY2FsbGFibGUxKSB7XG4gICAgICBjYWxsYWJsZTEuY2FsbChjb250ZXh0MSwgbmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29udGV4dDEobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9XG4gIH1cbiAgaWYgKGNvbnRleHQyKSB7XG4gICAgaWYgKGNhbGxhYmxlMikge1xuICAgICAgY2FsbGFibGUyLmNhbGwoY29udGV4dDIsIG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnRleHQyKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgfVxuICB9XG4gIGlmIChsZW5ndGgpIHtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBjYWxsYWJsZSA9IGNhbGxhYmxlc1Jlc3RbaV07XG4gICAgICBsZXQgY29udGV4dCA9IGNvbnRleHRzUmVzdFtpXTtcbiAgICAgIGlmIChjYWxsYWJsZSkge1xuICAgICAgICBjYWxsYWJsZS5jYWxsKGNvbnRleHQsIG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZXh0KG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICB9XG4gICAgICBjb250ZXh0c1Jlc3RbaV0gPSBudWxsO1xuICAgICAgY2FsbGFibGVzUmVzdFtpXSA9IG51bGw7XG4gICAgfVxuICAgIHBvb2xVdGlsaXphdGlvbltwb29sSW5kZXhdID0gZmFsc2U7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFzU3Vic2NyaWJlcnMoKSB7XG4gIHJldHVybiAhISh0aGlzLl9jb250ZXh0MCB8fCB0aGlzLl9jb250ZXh0MSB8fCB0aGlzLl9jb250ZXh0MiB8fCB0aGlzLl9jb250ZXh0c1Jlc3QgJiYgdGhpcy5fY29udGV4dHNSZXN0Lmxlbmd0aCk7XG59XG5cbmZ1bmN0aW9uIGhhc1N1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgbGV0IGhhcyA9IHRoaXMuX2NvbnRleHQwID09PSBjb250ZXh0ICYmIHRoaXMuX2NhbGxhYmxlMCA9PT0gY2FsbGFibGUgfHwgdGhpcy5fY29udGV4dDEgPT09IGNvbnRleHQgJiYgdGhpcy5fY2FsbGFibGUxID09PSBjYWxsYWJsZSB8fCB0aGlzLl9jb250ZXh0MiA9PT0gY29udGV4dCAmJiB0aGlzLl9jYWxsYWJsZTIgPT09IGNhbGxhYmxlO1xuICBpZiAoaGFzKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgbGV0IGluZGV4O1xuICBsZXQgY29udGV4dHMgPSB0aGlzLl9jb250ZXh0c1Jlc3Q7XG4gIGlmICghY29udGV4dHMgfHwgKGluZGV4ID0gY29udGV4dHMubGVuZ3RoKSA9PT0gMCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBsZXQgY2FsbGFibGVzID0gdGhpcy5fY2FsbGFibGVzUmVzdDtcbiAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICBpZiAoY29udGV4dHNbaW5kZXhdID09PSBjb250ZXh0ICYmIGNhbGxhYmxlc1tpbmRleF0gPT09IGNhbGxhYmxlKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3Vic2NyaWJlckNvbGxlY3Rpb24oKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgdGFyZ2V0LnByb3RvdHlwZS5hZGRTdWJzY3JpYmVyID0gYWRkU3Vic2NyaWJlcjtcbiAgICB0YXJnZXQucHJvdG90eXBlLnJlbW92ZVN1YnNjcmliZXIgPSByZW1vdmVTdWJzY3JpYmVyO1xuICAgIHRhcmdldC5wcm90b3R5cGUuY2FsbFN1YnNjcmliZXJzID0gY2FsbFN1YnNjcmliZXJzO1xuICAgIHRhcmdldC5wcm90b3R5cGUuaGFzU3Vic2NyaWJlcnMgPSBoYXNTdWJzY3JpYmVycztcbiAgICB0YXJnZXQucHJvdG90eXBlLmhhc1N1YnNjcmliZXIgPSBoYXNTdWJzY3JpYmVyO1xuICB9O1xufVxuXG5leHBvcnQgbGV0IEV4cHJlc3Npb25PYnNlcnZlciA9IChfZGVjID0gY29ubmVjdGFibGUoKSwgX2RlYzIgPSBzdWJzY3JpYmVyQ29sbGVjdGlvbigpLCBfZGVjKF9jbGFzcyA9IF9kZWMyKF9jbGFzcyA9IGNsYXNzIEV4cHJlc3Npb25PYnNlcnZlciB7XG4gIGNvbnN0cnVjdG9yKHNjb3BlLCBleHByZXNzaW9uLCBvYnNlcnZlckxvY2F0b3IsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICB9XG5cbiAgZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNjb3BlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gIH1cblxuICBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIHRoaXMuZXhwcmVzc2lvbi5hc3NpZ24odGhpcy5zY29wZSwgbmV3VmFsdWUpO1xuICB9XG5cbiAgc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgaWYgKCF0aGlzLmhhc1N1YnNjcmliZXJzKCkpIHtcbiAgICAgIHRoaXMub2xkVmFsdWUgPSB0aGlzLmV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgICAgdGhpcy5leHByZXNzaW9uLmNvbm5lY3QodGhpcywgdGhpcy5zY29wZSk7XG4gICAgfVxuICAgIHRoaXMuYWRkU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgY29udGV4dCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkaXNwb3NlOiAoKSA9PiB7XG4gICAgICAgICAgdGhpcy51bnN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICBpZiAodGhpcy5yZW1vdmVTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKSAmJiAhdGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICB0aGlzLnVub2JzZXJ2ZSh0cnVlKTtcbiAgICAgIHRoaXMub2xkVmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgY2FsbCgpIHtcbiAgICBsZXQgbmV3VmFsdWUgPSB0aGlzLmV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgIGxldCBvbGRWYWx1ZSA9IHRoaXMub2xkVmFsdWU7XG4gICAgaWYgKG5ld1ZhbHVlICE9PSBvbGRWYWx1ZSkge1xuICAgICAgdGhpcy5vbGRWYWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9XG4gICAgdGhpcy5fdmVyc2lvbisrO1xuICAgIHRoaXMuZXhwcmVzc2lvbi5jb25uZWN0KHRoaXMsIHRoaXMuc2NvcGUpO1xuICAgIHRoaXMudW5vYnNlcnZlKGZhbHNlKTtcbiAgfVxufSkgfHwgX2NsYXNzKSB8fCBfY2xhc3MpO1xuXG5mdW5jdGlvbiBpc0luZGV4KHMpIHtcbiAgcmV0dXJuICtzID09PSBzID4+PiAwO1xufVxuXG5mdW5jdGlvbiB0b051bWJlcihzKSB7XG4gIHJldHVybiArcztcbn1cblxuZnVuY3Rpb24gbmV3U3BsaWNlKGluZGV4LCByZW1vdmVkLCBhZGRlZENvdW50KSB7XG4gIHJldHVybiB7XG4gICAgaW5kZXg6IGluZGV4LFxuICAgIHJlbW92ZWQ6IHJlbW92ZWQsXG4gICAgYWRkZWRDb3VudDogYWRkZWRDb3VudFxuICB9O1xufVxuXG5jb25zdCBFRElUX0xFQVZFID0gMDtcbmNvbnN0IEVESVRfVVBEQVRFID0gMTtcbmNvbnN0IEVESVRfQUREID0gMjtcbmNvbnN0IEVESVRfREVMRVRFID0gMztcblxuZnVuY3Rpb24gQXJyYXlTcGxpY2UoKSB7fVxuXG5BcnJheVNwbGljZS5wcm90b3R5cGUgPSB7XG4gIGNhbGNFZGl0RGlzdGFuY2VzOiBmdW5jdGlvbiAoY3VycmVudCwgY3VycmVudFN0YXJ0LCBjdXJyZW50RW5kLCBvbGQsIG9sZFN0YXJ0LCBvbGRFbmQpIHtcbiAgICBsZXQgcm93Q291bnQgPSBvbGRFbmQgLSBvbGRTdGFydCArIDE7XG4gICAgbGV0IGNvbHVtbkNvdW50ID0gY3VycmVudEVuZCAtIGN1cnJlbnRTdGFydCArIDE7XG4gICAgbGV0IGRpc3RhbmNlcyA9IG5ldyBBcnJheShyb3dDb3VudCk7XG4gICAgbGV0IG5vcnRoO1xuICAgIGxldCB3ZXN0O1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dDb3VudDsgKytpKSB7XG4gICAgICBkaXN0YW5jZXNbaV0gPSBuZXcgQXJyYXkoY29sdW1uQ291bnQpO1xuICAgICAgZGlzdGFuY2VzW2ldWzBdID0gaTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNvbHVtbkNvdW50OyArK2opIHtcbiAgICAgIGRpc3RhbmNlc1swXVtqXSA9IGo7XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCByb3dDb3VudDsgKytpKSB7XG4gICAgICBmb3IgKGxldCBqID0gMTsgaiA8IGNvbHVtbkNvdW50OyArK2opIHtcbiAgICAgICAgaWYgKHRoaXMuZXF1YWxzKGN1cnJlbnRbY3VycmVudFN0YXJ0ICsgaiAtIDFdLCBvbGRbb2xkU3RhcnQgKyBpIC0gMV0pKSB7XG4gICAgICAgICAgZGlzdGFuY2VzW2ldW2pdID0gZGlzdGFuY2VzW2kgLSAxXVtqIC0gMV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm9ydGggPSBkaXN0YW5jZXNbaSAtIDFdW2pdICsgMTtcbiAgICAgICAgICB3ZXN0ID0gZGlzdGFuY2VzW2ldW2ogLSAxXSArIDE7XG4gICAgICAgICAgZGlzdGFuY2VzW2ldW2pdID0gbm9ydGggPCB3ZXN0ID8gbm9ydGggOiB3ZXN0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGRpc3RhbmNlcztcbiAgfSxcblxuICBzcGxpY2VPcGVyYXRpb25zRnJvbUVkaXREaXN0YW5jZXM6IGZ1bmN0aW9uIChkaXN0YW5jZXMpIHtcbiAgICBsZXQgaSA9IGRpc3RhbmNlcy5sZW5ndGggLSAxO1xuICAgIGxldCBqID0gZGlzdGFuY2VzWzBdLmxlbmd0aCAtIDE7XG4gICAgbGV0IGN1cnJlbnQgPSBkaXN0YW5jZXNbaV1bal07XG4gICAgbGV0IGVkaXRzID0gW107XG4gICAgd2hpbGUgKGkgPiAwIHx8IGogPiAwKSB7XG4gICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICBlZGl0cy5wdXNoKEVESVRfQUREKTtcbiAgICAgICAgai0tO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChqID09PSAwKSB7XG4gICAgICAgIGVkaXRzLnB1c2goRURJVF9ERUxFVEUpO1xuICAgICAgICBpLS07XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgbGV0IG5vcnRoV2VzdCA9IGRpc3RhbmNlc1tpIC0gMV1baiAtIDFdO1xuICAgICAgbGV0IHdlc3QgPSBkaXN0YW5jZXNbaSAtIDFdW2pdO1xuICAgICAgbGV0IG5vcnRoID0gZGlzdGFuY2VzW2ldW2ogLSAxXTtcblxuICAgICAgbGV0IG1pbjtcbiAgICAgIGlmICh3ZXN0IDwgbm9ydGgpIHtcbiAgICAgICAgbWluID0gd2VzdCA8IG5vcnRoV2VzdCA/IHdlc3QgOiBub3J0aFdlc3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtaW4gPSBub3J0aCA8IG5vcnRoV2VzdCA/IG5vcnRoIDogbm9ydGhXZXN0O1xuICAgICAgfVxuXG4gICAgICBpZiAobWluID09PSBub3J0aFdlc3QpIHtcbiAgICAgICAgaWYgKG5vcnRoV2VzdCA9PT0gY3VycmVudCkge1xuICAgICAgICAgIGVkaXRzLnB1c2goRURJVF9MRUFWRSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWRpdHMucHVzaChFRElUX1VQREFURSk7XG4gICAgICAgICAgY3VycmVudCA9IG5vcnRoV2VzdDtcbiAgICAgICAgfVxuICAgICAgICBpLS07XG4gICAgICAgIGotLTtcbiAgICAgIH0gZWxzZSBpZiAobWluID09PSB3ZXN0KSB7XG4gICAgICAgIGVkaXRzLnB1c2goRURJVF9ERUxFVEUpO1xuICAgICAgICBpLS07XG4gICAgICAgIGN1cnJlbnQgPSB3ZXN0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWRpdHMucHVzaChFRElUX0FERCk7XG4gICAgICAgIGotLTtcbiAgICAgICAgY3VycmVudCA9IG5vcnRoO1xuICAgICAgfVxuICAgIH1cblxuICAgIGVkaXRzLnJldmVyc2UoKTtcbiAgICByZXR1cm4gZWRpdHM7XG4gIH0sXG5cbiAgY2FsY1NwbGljZXM6IGZ1bmN0aW9uIChjdXJyZW50LCBjdXJyZW50U3RhcnQsIGN1cnJlbnRFbmQsIG9sZCwgb2xkU3RhcnQsIG9sZEVuZCkge1xuICAgIGxldCBwcmVmaXhDb3VudCA9IDA7XG4gICAgbGV0IHN1ZmZpeENvdW50ID0gMDtcblxuICAgIGxldCBtaW5MZW5ndGggPSBNYXRoLm1pbihjdXJyZW50RW5kIC0gY3VycmVudFN0YXJ0LCBvbGRFbmQgLSBvbGRTdGFydCk7XG4gICAgaWYgKGN1cnJlbnRTdGFydCA9PT0gMCAmJiBvbGRTdGFydCA9PT0gMCkge1xuICAgICAgcHJlZml4Q291bnQgPSB0aGlzLnNoYXJlZFByZWZpeChjdXJyZW50LCBvbGQsIG1pbkxlbmd0aCk7XG4gICAgfVxuXG4gICAgaWYgKGN1cnJlbnRFbmQgPT09IGN1cnJlbnQubGVuZ3RoICYmIG9sZEVuZCA9PT0gb2xkLmxlbmd0aCkge1xuICAgICAgc3VmZml4Q291bnQgPSB0aGlzLnNoYXJlZFN1ZmZpeChjdXJyZW50LCBvbGQsIG1pbkxlbmd0aCAtIHByZWZpeENvdW50KTtcbiAgICB9XG5cbiAgICBjdXJyZW50U3RhcnQgKz0gcHJlZml4Q291bnQ7XG4gICAgb2xkU3RhcnQgKz0gcHJlZml4Q291bnQ7XG4gICAgY3VycmVudEVuZCAtPSBzdWZmaXhDb3VudDtcbiAgICBvbGRFbmQgLT0gc3VmZml4Q291bnQ7XG5cbiAgICBpZiAoY3VycmVudEVuZCAtIGN1cnJlbnRTdGFydCA9PT0gMCAmJiBvbGRFbmQgLSBvbGRTdGFydCA9PT0gMCkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50U3RhcnQgPT09IGN1cnJlbnRFbmQpIHtcbiAgICAgIGxldCBzcGxpY2UgPSBuZXdTcGxpY2UoY3VycmVudFN0YXJ0LCBbXSwgMCk7XG4gICAgICB3aGlsZSAob2xkU3RhcnQgPCBvbGRFbmQpIHtcbiAgICAgICAgc3BsaWNlLnJlbW92ZWQucHVzaChvbGRbb2xkU3RhcnQrK10pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gW3NwbGljZV07XG4gICAgfSBlbHNlIGlmIChvbGRTdGFydCA9PT0gb2xkRW5kKSB7XG4gICAgICByZXR1cm4gW25ld1NwbGljZShjdXJyZW50U3RhcnQsIFtdLCBjdXJyZW50RW5kIC0gY3VycmVudFN0YXJ0KV07XG4gICAgfVxuXG4gICAgbGV0IG9wcyA9IHRoaXMuc3BsaWNlT3BlcmF0aW9uc0Zyb21FZGl0RGlzdGFuY2VzKHRoaXMuY2FsY0VkaXREaXN0YW5jZXMoY3VycmVudCwgY3VycmVudFN0YXJ0LCBjdXJyZW50RW5kLCBvbGQsIG9sZFN0YXJ0LCBvbGRFbmQpKTtcblxuICAgIGxldCBzcGxpY2UgPSB1bmRlZmluZWQ7XG4gICAgbGV0IHNwbGljZXMgPSBbXTtcbiAgICBsZXQgaW5kZXggPSBjdXJyZW50U3RhcnQ7XG4gICAgbGV0IG9sZEluZGV4ID0gb2xkU3RhcnQ7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHN3aXRjaCAob3BzW2ldKSB7XG4gICAgICAgIGNhc2UgRURJVF9MRUFWRTpcbiAgICAgICAgICBpZiAoc3BsaWNlKSB7XG4gICAgICAgICAgICBzcGxpY2VzLnB1c2goc3BsaWNlKTtcbiAgICAgICAgICAgIHNwbGljZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgIG9sZEluZGV4Kys7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgRURJVF9VUERBVEU6XG4gICAgICAgICAgaWYgKCFzcGxpY2UpIHtcbiAgICAgICAgICAgIHNwbGljZSA9IG5ld1NwbGljZShpbmRleCwgW10sIDApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHNwbGljZS5hZGRlZENvdW50Kys7XG4gICAgICAgICAgaW5kZXgrKztcblxuICAgICAgICAgIHNwbGljZS5yZW1vdmVkLnB1c2gob2xkW29sZEluZGV4XSk7XG4gICAgICAgICAgb2xkSW5kZXgrKztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBFRElUX0FERDpcbiAgICAgICAgICBpZiAoIXNwbGljZSkge1xuICAgICAgICAgICAgc3BsaWNlID0gbmV3U3BsaWNlKGluZGV4LCBbXSwgMCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc3BsaWNlLmFkZGVkQ291bnQrKztcbiAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEVESVRfREVMRVRFOlxuICAgICAgICAgIGlmICghc3BsaWNlKSB7XG4gICAgICAgICAgICBzcGxpY2UgPSBuZXdTcGxpY2UoaW5kZXgsIFtdLCAwKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzcGxpY2UucmVtb3ZlZC5wdXNoKG9sZFtvbGRJbmRleF0pO1xuICAgICAgICAgIG9sZEluZGV4Kys7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHNwbGljZSkge1xuICAgICAgc3BsaWNlcy5wdXNoKHNwbGljZSk7XG4gICAgfVxuICAgIHJldHVybiBzcGxpY2VzO1xuICB9LFxuXG4gIHNoYXJlZFByZWZpeDogZnVuY3Rpb24gKGN1cnJlbnQsIG9sZCwgc2VhcmNoTGVuZ3RoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWFyY2hMZW5ndGg7ICsraSkge1xuICAgICAgaWYgKCF0aGlzLmVxdWFscyhjdXJyZW50W2ldLCBvbGRbaV0pKSB7XG4gICAgICAgIHJldHVybiBpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzZWFyY2hMZW5ndGg7XG4gIH0sXG5cbiAgc2hhcmVkU3VmZml4OiBmdW5jdGlvbiAoY3VycmVudCwgb2xkLCBzZWFyY2hMZW5ndGgpIHtcbiAgICBsZXQgaW5kZXgxID0gY3VycmVudC5sZW5ndGg7XG4gICAgbGV0IGluZGV4MiA9IG9sZC5sZW5ndGg7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICB3aGlsZSAoY291bnQgPCBzZWFyY2hMZW5ndGggJiYgdGhpcy5lcXVhbHMoY3VycmVudFstLWluZGV4MV0sIG9sZFstLWluZGV4Ml0pKSB7XG4gICAgICBjb3VudCsrO1xuICAgIH1cblxuICAgIHJldHVybiBjb3VudDtcbiAgfSxcblxuICBjYWxjdWxhdGVTcGxpY2VzOiBmdW5jdGlvbiAoY3VycmVudCwgcHJldmlvdXMpIHtcbiAgICByZXR1cm4gdGhpcy5jYWxjU3BsaWNlcyhjdXJyZW50LCAwLCBjdXJyZW50Lmxlbmd0aCwgcHJldmlvdXMsIDAsIHByZXZpb3VzLmxlbmd0aCk7XG4gIH0sXG5cbiAgZXF1YWxzOiBmdW5jdGlvbiAoY3VycmVudFZhbHVlLCBwcmV2aW91c1ZhbHVlKSB7XG4gICAgcmV0dXJuIGN1cnJlbnRWYWx1ZSA9PT0gcHJldmlvdXNWYWx1ZTtcbiAgfVxufTtcblxubGV0IGFycmF5U3BsaWNlID0gbmV3IEFycmF5U3BsaWNlKCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjU3BsaWNlcyhjdXJyZW50LCBjdXJyZW50U3RhcnQsIGN1cnJlbnRFbmQsIG9sZCwgb2xkU3RhcnQsIG9sZEVuZCkge1xuICByZXR1cm4gYXJyYXlTcGxpY2UuY2FsY1NwbGljZXMoY3VycmVudCwgY3VycmVudFN0YXJ0LCBjdXJyZW50RW5kLCBvbGQsIG9sZFN0YXJ0LCBvbGRFbmQpO1xufVxuXG5mdW5jdGlvbiBpbnRlcnNlY3Qoc3RhcnQxLCBlbmQxLCBzdGFydDIsIGVuZDIpIHtcbiAgaWYgKGVuZDEgPCBzdGFydDIgfHwgZW5kMiA8IHN0YXJ0MSkge1xuICAgIHJldHVybiAtMTtcbiAgfVxuXG4gIGlmIChlbmQxID09PSBzdGFydDIgfHwgZW5kMiA9PT0gc3RhcnQxKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cblxuICBpZiAoc3RhcnQxIDwgc3RhcnQyKSB7XG4gICAgaWYgKGVuZDEgPCBlbmQyKSB7XG4gICAgICByZXR1cm4gZW5kMSAtIHN0YXJ0MjtcbiAgICB9XG5cbiAgICByZXR1cm4gZW5kMiAtIHN0YXJ0MjtcbiAgfVxuXG4gIGlmIChlbmQyIDwgZW5kMSkge1xuICAgIHJldHVybiBlbmQyIC0gc3RhcnQxO1xuICB9XG5cbiAgcmV0dXJuIGVuZDEgLSBzdGFydDE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZVNwbGljZShzcGxpY2VzLCBpbmRleCwgcmVtb3ZlZCwgYWRkZWRDb3VudCkge1xuICBsZXQgc3BsaWNlID0gbmV3U3BsaWNlKGluZGV4LCByZW1vdmVkLCBhZGRlZENvdW50KTtcblxuICBsZXQgaW5zZXJ0ZWQgPSBmYWxzZTtcbiAgbGV0IGluc2VydGlvbk9mZnNldCA9IDA7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcGxpY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IGN1cnJlbnQgPSBzcGxpY2VzW2ldO1xuICAgIGN1cnJlbnQuaW5kZXggKz0gaW5zZXJ0aW9uT2Zmc2V0O1xuXG4gICAgaWYgKGluc2VydGVkKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBsZXQgaW50ZXJzZWN0Q291bnQgPSBpbnRlcnNlY3Qoc3BsaWNlLmluZGV4LCBzcGxpY2UuaW5kZXggKyBzcGxpY2UucmVtb3ZlZC5sZW5ndGgsIGN1cnJlbnQuaW5kZXgsIGN1cnJlbnQuaW5kZXggKyBjdXJyZW50LmFkZGVkQ291bnQpO1xuXG4gICAgaWYgKGludGVyc2VjdENvdW50ID49IDApIHtcblxuICAgICAgc3BsaWNlcy5zcGxpY2UoaSwgMSk7XG4gICAgICBpLS07XG5cbiAgICAgIGluc2VydGlvbk9mZnNldCAtPSBjdXJyZW50LmFkZGVkQ291bnQgLSBjdXJyZW50LnJlbW92ZWQubGVuZ3RoO1xuXG4gICAgICBzcGxpY2UuYWRkZWRDb3VudCArPSBjdXJyZW50LmFkZGVkQ291bnQgLSBpbnRlcnNlY3RDb3VudDtcbiAgICAgIGxldCBkZWxldGVDb3VudCA9IHNwbGljZS5yZW1vdmVkLmxlbmd0aCArIGN1cnJlbnQucmVtb3ZlZC5sZW5ndGggLSBpbnRlcnNlY3RDb3VudDtcblxuICAgICAgaWYgKCFzcGxpY2UuYWRkZWRDb3VudCAmJiAhZGVsZXRlQ291bnQpIHtcbiAgICAgICAgaW5zZXJ0ZWQgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IGN1cnJlbnRSZW1vdmVkID0gY3VycmVudC5yZW1vdmVkO1xuXG4gICAgICAgIGlmIChzcGxpY2UuaW5kZXggPCBjdXJyZW50LmluZGV4KSB7XG4gICAgICAgICAgbGV0IHByZXBlbmQgPSBzcGxpY2UucmVtb3ZlZC5zbGljZSgwLCBjdXJyZW50LmluZGV4IC0gc3BsaWNlLmluZGV4KTtcbiAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShwcmVwZW5kLCBjdXJyZW50UmVtb3ZlZCk7XG4gICAgICAgICAgY3VycmVudFJlbW92ZWQgPSBwcmVwZW5kO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNwbGljZS5pbmRleCArIHNwbGljZS5yZW1vdmVkLmxlbmd0aCA+IGN1cnJlbnQuaW5kZXggKyBjdXJyZW50LmFkZGVkQ291bnQpIHtcbiAgICAgICAgICBsZXQgYXBwZW5kID0gc3BsaWNlLnJlbW92ZWQuc2xpY2UoY3VycmVudC5pbmRleCArIGN1cnJlbnQuYWRkZWRDb3VudCAtIHNwbGljZS5pbmRleCk7XG4gICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoY3VycmVudFJlbW92ZWQsIGFwcGVuZCk7XG4gICAgICAgIH1cblxuICAgICAgICBzcGxpY2UucmVtb3ZlZCA9IGN1cnJlbnRSZW1vdmVkO1xuICAgICAgICBpZiAoY3VycmVudC5pbmRleCA8IHNwbGljZS5pbmRleCkge1xuICAgICAgICAgIHNwbGljZS5pbmRleCA9IGN1cnJlbnQuaW5kZXg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHNwbGljZS5pbmRleCA8IGN1cnJlbnQuaW5kZXgpIHtcblxuICAgICAgaW5zZXJ0ZWQgPSB0cnVlO1xuXG4gICAgICBzcGxpY2VzLnNwbGljZShpLCAwLCBzcGxpY2UpO1xuICAgICAgaSsrO1xuXG4gICAgICBsZXQgb2Zmc2V0ID0gc3BsaWNlLmFkZGVkQ291bnQgLSBzcGxpY2UucmVtb3ZlZC5sZW5ndGg7XG4gICAgICBjdXJyZW50LmluZGV4ICs9IG9mZnNldDtcbiAgICAgIGluc2VydGlvbk9mZnNldCArPSBvZmZzZXQ7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFpbnNlcnRlZCkge1xuICAgIHNwbGljZXMucHVzaChzcGxpY2UpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUluaXRpYWxTcGxpY2VzKGFycmF5LCBjaGFuZ2VSZWNvcmRzKSB7XG4gIGxldCBzcGxpY2VzID0gW107XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGFuZ2VSZWNvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IHJlY29yZCA9IGNoYW5nZVJlY29yZHNbaV07XG4gICAgc3dpdGNoIChyZWNvcmQudHlwZSkge1xuICAgICAgY2FzZSAnc3BsaWNlJzpcbiAgICAgICAgbWVyZ2VTcGxpY2Uoc3BsaWNlcywgcmVjb3JkLmluZGV4LCByZWNvcmQucmVtb3ZlZC5zbGljZSgpLCByZWNvcmQuYWRkZWRDb3VudCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnYWRkJzpcbiAgICAgIGNhc2UgJ3VwZGF0ZSc6XG4gICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICBpZiAoIWlzSW5kZXgocmVjb3JkLm5hbWUpKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaW5kZXggPSB0b051bWJlcihyZWNvcmQubmFtZSk7XG4gICAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1lcmdlU3BsaWNlKHNwbGljZXMsIGluZGV4LCBbcmVjb3JkLm9sZFZhbHVlXSwgcmVjb3JkLnR5cGUgPT09ICdkZWxldGUnID8gMCA6IDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgcmVjb3JkIHR5cGU6ICcgKyBKU09OLnN0cmluZ2lmeShyZWNvcmQpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHNwbGljZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9qZWN0QXJyYXlTcGxpY2VzKGFycmF5LCBjaGFuZ2VSZWNvcmRzKSB7XG4gIGxldCBzcGxpY2VzID0gW107XG5cbiAgY3JlYXRlSW5pdGlhbFNwbGljZXMoYXJyYXksIGNoYW5nZVJlY29yZHMpLmZvckVhY2goZnVuY3Rpb24gKHNwbGljZSkge1xuICAgIGlmIChzcGxpY2UuYWRkZWRDb3VudCA9PT0gMSAmJiBzcGxpY2UucmVtb3ZlZC5sZW5ndGggPT09IDEpIHtcbiAgICAgIGlmIChzcGxpY2UucmVtb3ZlZFswXSAhPT0gYXJyYXlbc3BsaWNlLmluZGV4XSkge1xuICAgICAgICBzcGxpY2VzLnB1c2goc3BsaWNlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHNwbGljZXMgPSBzcGxpY2VzLmNvbmNhdChjYWxjU3BsaWNlcyhhcnJheSwgc3BsaWNlLmluZGV4LCBzcGxpY2UuaW5kZXggKyBzcGxpY2UuYWRkZWRDb3VudCwgc3BsaWNlLnJlbW92ZWQsIDAsIHNwbGljZS5yZW1vdmVkLmxlbmd0aCkpO1xuICB9KTtcblxuICByZXR1cm4gc3BsaWNlcztcbn1cblxuZnVuY3Rpb24gbmV3UmVjb3JkKHR5cGUsIG9iamVjdCwga2V5LCBvbGRWYWx1ZSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IHR5cGUsXG4gICAgb2JqZWN0OiBvYmplY3QsXG4gICAga2V5OiBrZXksXG4gICAgb2xkVmFsdWU6IG9sZFZhbHVlXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGFuZ2VSZWNvcmRzKG1hcCkge1xuICBsZXQgZW50cmllcyA9IG5ldyBBcnJheShtYXAuc2l6ZSk7XG4gIGxldCBrZXlzID0gbWFwLmtleXMoKTtcbiAgbGV0IGkgPSAwO1xuICBsZXQgaXRlbTtcblxuICB3aGlsZSAoaXRlbSA9IGtleXMubmV4dCgpKSB7XG4gICAgaWYgKGl0ZW0uZG9uZSkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgZW50cmllc1tpXSA9IG5ld1JlY29yZCgnYWRkZWQnLCBtYXAsIGl0ZW0udmFsdWUpO1xuICAgIGkrKztcbiAgfVxuXG4gIHJldHVybiBlbnRyaWVzO1xufVxuXG5leHBvcnQgbGV0IE1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlciA9IChfZGVjMyA9IHN1YnNjcmliZXJDb2xsZWN0aW9uKCksIF9kZWMzKF9jbGFzczIgPSBjbGFzcyBNb2RpZnlDb2xsZWN0aW9uT2JzZXJ2ZXIge1xuICBjb25zdHJ1Y3Rvcih0YXNrUXVldWUsIGNvbGxlY3Rpb24pIHtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IHRhc2tRdWV1ZTtcbiAgICB0aGlzLnF1ZXVlZCA9IGZhbHNlO1xuICAgIHRoaXMuY2hhbmdlUmVjb3JkcyA9IG51bGw7XG4gICAgdGhpcy5vbGRDb2xsZWN0aW9uID0gbnVsbDtcbiAgICB0aGlzLmNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xuICAgIHRoaXMubGVuZ3RoUHJvcGVydHlOYW1lID0gY29sbGVjdGlvbiBpbnN0YW5jZW9mIE1hcCB8fCBjb2xsZWN0aW9uIGluc3RhbmNlb2YgU2V0ID8gJ3NpemUnIDogJ2xlbmd0aCc7XG4gIH1cblxuICBzdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICB0aGlzLmFkZFN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9XG5cbiAgdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICB0aGlzLnJlbW92ZVN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9XG5cbiAgYWRkQ2hhbmdlUmVjb3JkKGNoYW5nZVJlY29yZCkge1xuICAgIGlmICghdGhpcy5oYXNTdWJzY3JpYmVycygpICYmICF0aGlzLmxlbmd0aE9ic2VydmVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZVJlY29yZC50eXBlID09PSAnc3BsaWNlJykge1xuICAgICAgbGV0IGluZGV4ID0gY2hhbmdlUmVjb3JkLmluZGV4O1xuICAgICAgbGV0IGFycmF5TGVuZ3RoID0gY2hhbmdlUmVjb3JkLm9iamVjdC5sZW5ndGg7XG4gICAgICBpZiAoaW5kZXggPiBhcnJheUxlbmd0aCkge1xuICAgICAgICBpbmRleCA9IGFycmF5TGVuZ3RoIC0gY2hhbmdlUmVjb3JkLmFkZGVkQ291bnQ7XG4gICAgICB9IGVsc2UgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICBpbmRleCA9IGFycmF5TGVuZ3RoICsgY2hhbmdlUmVjb3JkLnJlbW92ZWQubGVuZ3RoICsgaW5kZXggLSBjaGFuZ2VSZWNvcmQuYWRkZWRDb3VudDtcbiAgICAgIH1cbiAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgaW5kZXggPSAwO1xuICAgICAgfVxuICAgICAgY2hhbmdlUmVjb3JkLmluZGV4ID0gaW5kZXg7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2hhbmdlUmVjb3JkcyA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5jaGFuZ2VSZWNvcmRzID0gW2NoYW5nZVJlY29yZF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2hhbmdlUmVjb3Jkcy5wdXNoKGNoYW5nZVJlY29yZCk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnF1ZXVlZCkge1xuICAgICAgdGhpcy5xdWV1ZWQgPSB0cnVlO1xuICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2sodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgZmx1c2hDaGFuZ2VSZWNvcmRzKCkge1xuICAgIGlmICh0aGlzLmNoYW5nZVJlY29yZHMgJiYgdGhpcy5jaGFuZ2VSZWNvcmRzLmxlbmd0aCB8fCB0aGlzLm9sZENvbGxlY3Rpb24pIHtcbiAgICAgIHRoaXMuY2FsbCgpO1xuICAgIH1cbiAgfVxuXG4gIHJlc2V0KG9sZENvbGxlY3Rpb24pIHtcbiAgICB0aGlzLm9sZENvbGxlY3Rpb24gPSBvbGRDb2xsZWN0aW9uO1xuXG4gICAgaWYgKHRoaXMuaGFzU3Vic2NyaWJlcnMoKSAmJiAhdGhpcy5xdWV1ZWQpIHtcbiAgICAgIHRoaXMucXVldWVkID0gdHJ1ZTtcbiAgICAgIHRoaXMudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIGdldExlbmd0aE9ic2VydmVyKCkge1xuICAgIHJldHVybiB0aGlzLmxlbmd0aE9ic2VydmVyIHx8ICh0aGlzLmxlbmd0aE9ic2VydmVyID0gbmV3IENvbGxlY3Rpb25MZW5ndGhPYnNlcnZlcih0aGlzLmNvbGxlY3Rpb24pKTtcbiAgfVxuXG4gIGNhbGwoKSB7XG4gICAgbGV0IGNoYW5nZVJlY29yZHMgPSB0aGlzLmNoYW5nZVJlY29yZHM7XG4gICAgbGV0IG9sZENvbGxlY3Rpb24gPSB0aGlzLm9sZENvbGxlY3Rpb247XG4gICAgbGV0IHJlY29yZHM7XG5cbiAgICB0aGlzLnF1ZXVlZCA9IGZhbHNlO1xuICAgIHRoaXMuY2hhbmdlUmVjb3JkcyA9IFtdO1xuICAgIHRoaXMub2xkQ29sbGVjdGlvbiA9IG51bGw7XG5cbiAgICBpZiAodGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICBpZiAob2xkQ29sbGVjdGlvbikge1xuICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uIGluc3RhbmNlb2YgTWFwIHx8IHRoaXMuY29sbGVjdGlvbiBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgICAgIHJlY29yZHMgPSBnZXRDaGFuZ2VSZWNvcmRzKG9sZENvbGxlY3Rpb24pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlY29yZHMgPSBjYWxjU3BsaWNlcyh0aGlzLmNvbGxlY3Rpb24sIDAsIHRoaXMuY29sbGVjdGlvbi5sZW5ndGgsIG9sZENvbGxlY3Rpb24sIDAsIG9sZENvbGxlY3Rpb24ubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHRoaXMuY29sbGVjdGlvbiBpbnN0YW5jZW9mIE1hcCB8fCB0aGlzLmNvbGxlY3Rpb24gaW5zdGFuY2VvZiBTZXQpIHtcbiAgICAgICAgICByZWNvcmRzID0gY2hhbmdlUmVjb3JkcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZWNvcmRzID0gcHJvamVjdEFycmF5U3BsaWNlcyh0aGlzLmNvbGxlY3Rpb24sIGNoYW5nZVJlY29yZHMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY2FsbFN1YnNjcmliZXJzKHJlY29yZHMpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmxlbmd0aE9ic2VydmVyKSB7XG4gICAgICB0aGlzLmxlbmd0aE9ic2VydmVyLmNhbGwodGhpcy5jb2xsZWN0aW9uW3RoaXMubGVuZ3RoUHJvcGVydHlOYW1lXSk7XG4gICAgfVxuICB9XG59KSB8fCBfY2xhc3MyKTtcblxuZXhwb3J0IGxldCBDb2xsZWN0aW9uTGVuZ3RoT2JzZXJ2ZXIgPSAoX2RlYzQgPSBzdWJzY3JpYmVyQ29sbGVjdGlvbigpLCBfZGVjNChfY2xhc3MzID0gY2xhc3MgQ29sbGVjdGlvbkxlbmd0aE9ic2VydmVyIHtcbiAgY29uc3RydWN0b3IoY29sbGVjdGlvbikge1xuICAgIHRoaXMuY29sbGVjdGlvbiA9IGNvbGxlY3Rpb247XG4gICAgdGhpcy5sZW5ndGhQcm9wZXJ0eU5hbWUgPSBjb2xsZWN0aW9uIGluc3RhbmNlb2YgTWFwIHx8IGNvbGxlY3Rpb24gaW5zdGFuY2VvZiBTZXQgPyAnc2l6ZScgOiAnbGVuZ3RoJztcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IGNvbGxlY3Rpb25bdGhpcy5sZW5ndGhQcm9wZXJ0eU5hbWVdO1xuICB9XG5cbiAgZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29sbGVjdGlvblt0aGlzLmxlbmd0aFByb3BlcnR5TmFtZV07XG4gIH1cblxuICBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIHRoaXMuY29sbGVjdGlvblt0aGlzLmxlbmd0aFByb3BlcnR5TmFtZV0gPSBuZXdWYWx1ZTtcbiAgfVxuXG4gIHN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSkge1xuICAgIHRoaXMuYWRkU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSk7XG4gIH1cblxuICB1bnN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSkge1xuICAgIHRoaXMucmVtb3ZlU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSk7XG4gIH1cblxuICBjYWxsKG5ld1ZhbHVlKSB7XG4gICAgbGV0IG9sZFZhbHVlID0gdGhpcy5jdXJyZW50VmFsdWU7XG4gICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IG5ld1ZhbHVlO1xuICB9XG59KSB8fCBfY2xhc3MzKTtcblxuY29uc3QgYXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTtcbmNvbnN0IHBvcCA9IGFycmF5UHJvdG8ucG9wO1xuY29uc3QgcHVzaCA9IGFycmF5UHJvdG8ucHVzaDtcbmNvbnN0IHJldmVyc2UgPSBhcnJheVByb3RvLnJldmVyc2U7XG5jb25zdCBzaGlmdCA9IGFycmF5UHJvdG8uc2hpZnQ7XG5jb25zdCBzb3J0ID0gYXJyYXlQcm90by5zb3J0O1xuY29uc3Qgc3BsaWNlID0gYXJyYXlQcm90by5zcGxpY2U7XG5jb25zdCB1bnNoaWZ0ID0gYXJyYXlQcm90by51bnNoaWZ0O1xuXG5pZiAoYXJyYXlQcm90by5fX2F1X3BhdGNoZWRfXykge1xuICBMb2dNYW5hZ2VyLmdldExvZ2dlcignYXJyYXktb2JzZXJ2YXRpb24nKS53YXJuKCdEZXRlY3RlZCAybmQgYXR0ZW1wdCBvZiBwYXRjaGluZyBhcnJheSBmcm9tIEF1cmVsaWEgYmluZGluZy4nICsgJyBUaGlzIGlzIHByb2JhYmx5IGNhdXNlZCBieSBkZXBlbmRlbmN5IG1pc21hdGNoIGJldHdlZW4gY29yZSBtb2R1bGVzIGFuZCBhIDNyZCBwYXJ0eSBwbHVnaW4uJyArICcgUGxlYXNlIHNlZSBodHRwczovL2dpdGh1Yi5jb20vYXVyZWxpYS9jbGkvcHVsbC85MDYgaWYgeW91IGFyZSB1c2luZyB3ZWJwYWNrLicpO1xufSBlbHNlIHtcbiAgUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eShhcnJheVByb3RvLCAnX19hdV9wYXRjaGVkX18nLCB7IHZhbHVlOiAxIH0pO1xuICBhcnJheVByb3RvLnBvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm90RW1wdHkgPSB0aGlzLmxlbmd0aCA+IDA7XG4gICAgbGV0IG1ldGhvZENhbGxSZXN1bHQgPSBwb3AuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAobm90RW1wdHkgJiYgdGhpcy5fX2FycmF5X29ic2VydmVyX18gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5fX2FycmF5X29ic2VydmVyX18uYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgdHlwZTogJ2RlbGV0ZScsXG4gICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgbmFtZTogdGhpcy5sZW5ndGgsXG4gICAgICAgIG9sZFZhbHVlOiBtZXRob2RDYWxsUmVzdWx0XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gIH07XG5cbiAgYXJyYXlQcm90by5wdXNoID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBtZXRob2RDYWxsUmVzdWx0ID0gcHVzaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmICh0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXy5hZGRDaGFuZ2VSZWNvcmQoe1xuICAgICAgICB0eXBlOiAnc3BsaWNlJyxcbiAgICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgICBpbmRleDogdGhpcy5sZW5ndGggLSBhcmd1bWVudHMubGVuZ3RoLFxuICAgICAgICByZW1vdmVkOiBbXSxcbiAgICAgICAgYWRkZWRDb3VudDogYXJndW1lbnRzLmxlbmd0aFxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBtZXRob2RDYWxsUmVzdWx0O1xuICB9O1xuXG4gIGFycmF5UHJvdG8ucmV2ZXJzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgb2xkQXJyYXk7XG4gICAgaWYgKHRoaXMuX19hcnJheV9vYnNlcnZlcl9fICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuX19hcnJheV9vYnNlcnZlcl9fLmZsdXNoQ2hhbmdlUmVjb3JkcygpO1xuICAgICAgb2xkQXJyYXkgPSB0aGlzLnNsaWNlKCk7XG4gICAgfVxuICAgIGxldCBtZXRob2RDYWxsUmVzdWx0ID0gcmV2ZXJzZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmICh0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXy5yZXNldChvbGRBcnJheSk7XG4gICAgfVxuICAgIHJldHVybiBtZXRob2RDYWxsUmVzdWx0O1xuICB9O1xuXG4gIGFycmF5UHJvdG8uc2hpZnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG5vdEVtcHR5ID0gdGhpcy5sZW5ndGggPiAwO1xuICAgIGxldCBtZXRob2RDYWxsUmVzdWx0ID0gc2hpZnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAobm90RW1wdHkgJiYgdGhpcy5fX2FycmF5X29ic2VydmVyX18gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5fX2FycmF5X29ic2VydmVyX18uYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgdHlwZTogJ2RlbGV0ZScsXG4gICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgbmFtZTogMCxcbiAgICAgICAgb2xkVmFsdWU6IG1ldGhvZENhbGxSZXN1bHRcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbWV0aG9kQ2FsbFJlc3VsdDtcbiAgfTtcblxuICBhcnJheVByb3RvLnNvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG9sZEFycmF5O1xuICAgIGlmICh0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXy5mbHVzaENoYW5nZVJlY29yZHMoKTtcbiAgICAgIG9sZEFycmF5ID0gdGhpcy5zbGljZSgpO1xuICAgIH1cbiAgICBsZXQgbWV0aG9kQ2FsbFJlc3VsdCA9IHNvcnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAodGhpcy5fX2FycmF5X29ic2VydmVyX18gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5fX2FycmF5X29ic2VydmVyX18ucmVzZXQob2xkQXJyYXkpO1xuICAgIH1cbiAgICByZXR1cm4gbWV0aG9kQ2FsbFJlc3VsdDtcbiAgfTtcblxuICBhcnJheVByb3RvLnNwbGljZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbWV0aG9kQ2FsbFJlc3VsdCA9IHNwbGljZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmICh0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXy5hZGRDaGFuZ2VSZWNvcmQoe1xuICAgICAgICB0eXBlOiAnc3BsaWNlJyxcbiAgICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgICBpbmRleDogK2FyZ3VtZW50c1swXSxcbiAgICAgICAgcmVtb3ZlZDogbWV0aG9kQ2FsbFJlc3VsdCxcbiAgICAgICAgYWRkZWRDb3VudDogYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHMubGVuZ3RoIC0gMiA6IDBcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbWV0aG9kQ2FsbFJlc3VsdDtcbiAgfTtcblxuICBhcnJheVByb3RvLnVuc2hpZnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG1ldGhvZENhbGxSZXN1bHQgPSB1bnNoaWZ0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKHRoaXMuX19hcnJheV9vYnNlcnZlcl9fICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuX19hcnJheV9vYnNlcnZlcl9fLmFkZENoYW5nZVJlY29yZCh7XG4gICAgICAgIHR5cGU6ICdzcGxpY2UnLFxuICAgICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICAgIGluZGV4OiAwLFxuICAgICAgICByZW1vdmVkOiBbXSxcbiAgICAgICAgYWRkZWRDb3VudDogYXJndW1lbnRzLmxlbmd0aFxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBtZXRob2RDYWxsUmVzdWx0O1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXJyYXlPYnNlcnZlcih0YXNrUXVldWUsIGFycmF5KSB7XG4gIHJldHVybiBNb2RpZnlBcnJheU9ic2VydmVyLmZvcih0YXNrUXVldWUsIGFycmF5KTtcbn1cblxubGV0IE1vZGlmeUFycmF5T2JzZXJ2ZXIgPSBjbGFzcyBNb2RpZnlBcnJheU9ic2VydmVyIGV4dGVuZHMgTW9kaWZ5Q29sbGVjdGlvbk9ic2VydmVyIHtcbiAgY29uc3RydWN0b3IodGFza1F1ZXVlLCBhcnJheSkge1xuICAgIHN1cGVyKHRhc2tRdWV1ZSwgYXJyYXkpO1xuICB9XG5cbiAgc3RhdGljIGZvcih0YXNrUXVldWUsIGFycmF5KSB7XG4gICAgaWYgKCEoJ19fYXJyYXlfb2JzZXJ2ZXJfXycgaW4gYXJyYXkpKSB7XG4gICAgICBSZWZsZWN0LmRlZmluZVByb3BlcnR5KGFycmF5LCAnX19hcnJheV9vYnNlcnZlcl9fJywge1xuICAgICAgICB2YWx1ZTogTW9kaWZ5QXJyYXlPYnNlcnZlci5jcmVhdGUodGFza1F1ZXVlLCBhcnJheSksXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLCBjb25maWd1cmFibGU6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5Ll9fYXJyYXlfb2JzZXJ2ZXJfXztcbiAgfVxuXG4gIHN0YXRpYyBjcmVhdGUodGFza1F1ZXVlLCBhcnJheSkge1xuICAgIHJldHVybiBuZXcgTW9kaWZ5QXJyYXlPYnNlcnZlcih0YXNrUXVldWUsIGFycmF5KTtcbiAgfVxufTtcblxuXG5leHBvcnQgbGV0IEV4cHJlc3Npb24gPSBjbGFzcyBFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5pc0Fzc2lnbmFibGUgPSBmYWxzZTtcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMsIGFyZ3MpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEJpbmRpbmcgZXhwcmVzc2lvbiBcIiR7dGhpc31cIiBjYW5ub3QgYmUgZXZhbHVhdGVkLmApO1xuICB9XG5cbiAgYXNzaWduKHNjb3BlLCB2YWx1ZSwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBCaW5kaW5nIGV4cHJlc3Npb24gXCIke3RoaXN9XCIgY2Fubm90IGJlIGFzc2lnbmVkIHRvLmApO1xuICB9XG5cbiAgdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBGRUFUVVJFX05PX1VOUEFSU0VSID09PSAndW5kZWZpbmVkJyA/IFVucGFyc2VyLnVucGFyc2UodGhpcykgOiBzdXBlci50b1N0cmluZygpO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IEJpbmRpbmdCZWhhdmlvciA9IGNsYXNzIEJpbmRpbmdCZWhhdmlvciBleHRlbmRzIEV4cHJlc3Npb24ge1xuICBjb25zdHJ1Y3RvcihleHByZXNzaW9uLCBuYW1lLCBhcmdzKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMuZXhwcmVzc2lvbiA9IGV4cHJlc3Npb247XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLmFyZ3MgPSBhcmdzO1xuICB9XG5cbiAgZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHJldHVybiB0aGlzLmV4cHJlc3Npb24uZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gIH1cblxuICBhc3NpZ24oc2NvcGUsIHZhbHVlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy5leHByZXNzaW9uLmFzc2lnbihzY29wZSwgdmFsdWUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gIH1cblxuICBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0QmluZGluZ0JlaGF2aW9yKHRoaXMpO1xuICB9XG5cbiAgY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHRoaXMuZXhwcmVzc2lvbi5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgfVxuXG4gIGJpbmQoYmluZGluZywgc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIGlmICh0aGlzLmV4cHJlc3Npb24uZXhwcmVzc2lvbiAmJiB0aGlzLmV4cHJlc3Npb24uYmluZCkge1xuICAgICAgdGhpcy5leHByZXNzaW9uLmJpbmQoYmluZGluZywgc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgfVxuICAgIGxldCBiZWhhdmlvciA9IGxvb2t1cEZ1bmN0aW9ucy5iaW5kaW5nQmVoYXZpb3JzKHRoaXMubmFtZSk7XG4gICAgaWYgKCFiZWhhdmlvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBCaW5kaW5nQmVoYXZpb3IgbmFtZWQgXCIke3RoaXMubmFtZX1cIiB3YXMgZm91bmQhYCk7XG4gICAgfVxuICAgIGxldCBiZWhhdmlvcktleSA9IGBiZWhhdmlvci0ke3RoaXMubmFtZX1gO1xuICAgIGlmIChiaW5kaW5nW2JlaGF2aW9yS2V5XSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBIGJpbmRpbmcgYmVoYXZpb3IgbmFtZWQgXCIke3RoaXMubmFtZX1cIiBoYXMgYWxyZWFkeSBiZWVuIGFwcGxpZWQgdG8gXCIke3RoaXMuZXhwcmVzc2lvbn1cImApO1xuICAgIH1cbiAgICBiaW5kaW5nW2JlaGF2aW9yS2V5XSA9IGJlaGF2aW9yO1xuICAgIGJlaGF2aW9yLmJpbmQuYXBwbHkoYmVoYXZpb3IsIFtiaW5kaW5nLCBzY29wZV0uY29uY2F0KGV2YWxMaXN0KHNjb3BlLCB0aGlzLmFyZ3MsIGJpbmRpbmcubG9va3VwRnVuY3Rpb25zKSkpO1xuICB9XG5cbiAgdW5iaW5kKGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgbGV0IGJlaGF2aW9yS2V5ID0gYGJlaGF2aW9yLSR7dGhpcy5uYW1lfWA7XG4gICAgYmluZGluZ1tiZWhhdmlvcktleV0udW5iaW5kKGJpbmRpbmcsIHNjb3BlKTtcbiAgICBiaW5kaW5nW2JlaGF2aW9yS2V5XSA9IG51bGw7XG4gICAgaWYgKHRoaXMuZXhwcmVzc2lvbi5leHByZXNzaW9uICYmIHRoaXMuZXhwcmVzc2lvbi51bmJpbmQpIHtcbiAgICAgIHRoaXMuZXhwcmVzc2lvbi51bmJpbmQoYmluZGluZywgc2NvcGUpO1xuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGxldCBWYWx1ZUNvbnZlcnRlciA9IGNsYXNzIFZhbHVlQ29udmVydGVyIGV4dGVuZHMgRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKGV4cHJlc3Npb24sIG5hbWUsIGFyZ3MpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5leHByZXNzaW9uID0gZXhwcmVzc2lvbjtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuYXJncyA9IGFyZ3M7XG4gICAgdGhpcy5hbGxBcmdzID0gW2V4cHJlc3Npb25dLmNvbmNhdChhcmdzKTtcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBsZXQgY29udmVydGVyID0gbG9va3VwRnVuY3Rpb25zLnZhbHVlQ29udmVydGVycyh0aGlzLm5hbWUpO1xuICAgIGlmICghY29udmVydGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIFZhbHVlQ29udmVydGVyIG5hbWVkIFwiJHt0aGlzLm5hbWV9XCIgd2FzIGZvdW5kIWApO1xuICAgIH1cblxuICAgIGlmICgndG9WaWV3JyBpbiBjb252ZXJ0ZXIpIHtcbiAgICAgIHJldHVybiBjb252ZXJ0ZXIudG9WaWV3LmFwcGx5KGNvbnZlcnRlciwgZXZhbExpc3Qoc2NvcGUsIHRoaXMuYWxsQXJncywgbG9va3VwRnVuY3Rpb25zKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuYWxsQXJnc1swXS5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIGFzc2lnbihzY29wZSwgdmFsdWUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIGxldCBjb252ZXJ0ZXIgPSBsb29rdXBGdW5jdGlvbnMudmFsdWVDb252ZXJ0ZXJzKHRoaXMubmFtZSk7XG4gICAgaWYgKCFjb252ZXJ0ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gVmFsdWVDb252ZXJ0ZXIgbmFtZWQgXCIke3RoaXMubmFtZX1cIiB3YXMgZm91bmQhYCk7XG4gICAgfVxuXG4gICAgaWYgKCdmcm9tVmlldycgaW4gY29udmVydGVyKSB7XG4gICAgICB2YWx1ZSA9IGNvbnZlcnRlci5mcm9tVmlldy5hcHBseShjb252ZXJ0ZXIsIFt2YWx1ZV0uY29uY2F0KGV2YWxMaXN0KHNjb3BlLCB0aGlzLmFyZ3MsIGxvb2t1cEZ1bmN0aW9ucykpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5hbGxBcmdzWzBdLmFzc2lnbihzY29wZSwgdmFsdWUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gIH1cblxuICBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0VmFsdWVDb252ZXJ0ZXIodGhpcyk7XG4gIH1cblxuICBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgbGV0IGV4cHJlc3Npb25zID0gdGhpcy5hbGxBcmdzO1xuICAgIGxldCBpID0gZXhwcmVzc2lvbnMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGV4cHJlc3Npb25zW2ldLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIH1cbiAgICBsZXQgY29udmVydGVyID0gYmluZGluZy5sb29rdXBGdW5jdGlvbnMudmFsdWVDb252ZXJ0ZXJzKHRoaXMubmFtZSk7XG4gICAgaWYgKCFjb252ZXJ0ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gVmFsdWVDb252ZXJ0ZXIgbmFtZWQgXCIke3RoaXMubmFtZX1cIiB3YXMgZm91bmQhYCk7XG4gICAgfVxuICAgIGxldCBzaWduYWxzID0gY29udmVydGVyLnNpZ25hbHM7XG4gICAgaWYgKHNpZ25hbHMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpID0gc2lnbmFscy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgY29ubmVjdEJpbmRpbmdUb1NpZ25hbChiaW5kaW5nLCBzaWduYWxzW2ldKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgQXNzaWduID0gY2xhc3MgQXNzaWduIGV4dGVuZHMgRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKHRhcmdldCwgdmFsdWUpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMuaXNBc3NpZ25hYmxlID0gdHJ1ZTtcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy50YXJnZXQuYXNzaWduKHNjb3BlLCB0aGlzLnZhbHVlLmV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpKTtcbiAgfVxuXG4gIGFjY2VwdCh2aXN0b3IpIHtcbiAgICB2aXN0b3IudmlzaXRBc3NpZ24odGhpcyk7XG4gIH1cblxuICBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7fVxuXG4gIGFzc2lnbihzY29wZSwgdmFsdWUpIHtcbiAgICB0aGlzLnZhbHVlLmFzc2lnbihzY29wZSwgdmFsdWUpO1xuICAgIHRoaXMudGFyZ2V0LmFzc2lnbihzY29wZSwgdmFsdWUpO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IENvbmRpdGlvbmFsID0gY2xhc3MgQ29uZGl0aW9uYWwgZXh0ZW5kcyBFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3IoY29uZGl0aW9uLCB5ZXMsIG5vKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMuY29uZGl0aW9uID0gY29uZGl0aW9uO1xuICAgIHRoaXMueWVzID0geWVzO1xuICAgIHRoaXMubm8gPSBubztcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gISF0aGlzLmNvbmRpdGlvbi5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKSA/IHRoaXMueWVzLmV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIDogdGhpcy5uby5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIGFjY2VwdCh2aXNpdG9yKSB7XG4gICAgcmV0dXJuIHZpc2l0b3IudmlzaXRDb25kaXRpb25hbCh0aGlzKTtcbiAgfVxuXG4gIGNvbm5lY3QoYmluZGluZywgc2NvcGUpIHtcbiAgICB0aGlzLmNvbmRpdGlvbi5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICBpZiAodGhpcy5jb25kaXRpb24uZXZhbHVhdGUoc2NvcGUpKSB7XG4gICAgICB0aGlzLnllcy5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5uby5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgQWNjZXNzVGhpcyA9IGNsYXNzIEFjY2Vzc1RoaXMgZXh0ZW5kcyBFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3IoYW5jZXN0b3IpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuYW5jZXN0b3IgPSBhbmNlc3RvcjtcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBsZXQgb2MgPSBzY29wZS5vdmVycmlkZUNvbnRleHQ7XG4gICAgbGV0IGkgPSB0aGlzLmFuY2VzdG9yO1xuICAgIHdoaWxlIChpLS0gJiYgb2MpIHtcbiAgICAgIG9jID0gb2MucGFyZW50T3ZlcnJpZGVDb250ZXh0O1xuICAgIH1cbiAgICByZXR1cm4gaSA8IDEgJiYgb2MgPyBvYy5iaW5kaW5nQ29udGV4dCA6IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGFjY2VwdCh2aXNpdG9yKSB7XG4gICAgcmV0dXJuIHZpc2l0b3IudmlzaXRBY2Nlc3NUaGlzKHRoaXMpO1xuICB9XG5cbiAgY29ubmVjdChiaW5kaW5nLCBzY29wZSkge31cbn07XG5cbmV4cG9ydCBsZXQgQWNjZXNzU2NvcGUgPSBjbGFzcyBBY2Nlc3NTY29wZSBleHRlbmRzIEV4cHJlc3Npb24ge1xuICBjb25zdHJ1Y3RvcihuYW1lLCBhbmNlc3Rvcikge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuYW5jZXN0b3IgPSBhbmNlc3RvcjtcbiAgICB0aGlzLmlzQXNzaWduYWJsZSA9IHRydWU7XG4gIH1cblxuICBldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgbGV0IGNvbnRleHQgPSBnZXRDb250ZXh0Rm9yKHRoaXMubmFtZSwgc2NvcGUsIHRoaXMuYW5jZXN0b3IpO1xuICAgIHJldHVybiBjb250ZXh0W3RoaXMubmFtZV07XG4gIH1cblxuICBhc3NpZ24oc2NvcGUsIHZhbHVlKSB7XG4gICAgbGV0IGNvbnRleHQgPSBnZXRDb250ZXh0Rm9yKHRoaXMubmFtZSwgc2NvcGUsIHRoaXMuYW5jZXN0b3IpO1xuICAgIHJldHVybiBjb250ZXh0ID8gY29udGV4dFt0aGlzLm5hbWVdID0gdmFsdWUgOiB1bmRlZmluZWQ7XG4gIH1cblxuICBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0QWNjZXNzU2NvcGUodGhpcyk7XG4gIH1cblxuICBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgbGV0IGNvbnRleHQgPSBnZXRDb250ZXh0Rm9yKHRoaXMubmFtZSwgc2NvcGUsIHRoaXMuYW5jZXN0b3IpO1xuICAgIGJpbmRpbmcub2JzZXJ2ZVByb3BlcnR5KGNvbnRleHQsIHRoaXMubmFtZSk7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgQWNjZXNzTWVtYmVyID0gY2xhc3MgQWNjZXNzTWVtYmVyIGV4dGVuZHMgRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKG9iamVjdCwgbmFtZSkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuaXNBc3NpZ25hYmxlID0gdHJ1ZTtcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBsZXQgaW5zdGFuY2UgPSB0aGlzLm9iamVjdC5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICByZXR1cm4gaW5zdGFuY2UgPT09IG51bGwgfHwgaW5zdGFuY2UgPT09IHVuZGVmaW5lZCA/IGluc3RhbmNlIDogaW5zdGFuY2VbdGhpcy5uYW1lXTtcbiAgfVxuXG4gIGFzc2lnbihzY29wZSwgdmFsdWUpIHtcbiAgICBsZXQgaW5zdGFuY2UgPSB0aGlzLm9iamVjdC5ldmFsdWF0ZShzY29wZSk7XG5cbiAgICBpZiAoaW5zdGFuY2UgPT09IG51bGwgfHwgaW5zdGFuY2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgaW5zdGFuY2UgPSB7fTtcbiAgICAgIHRoaXMub2JqZWN0LmFzc2lnbihzY29wZSwgaW5zdGFuY2UpO1xuICAgIH1cblxuICAgIGluc3RhbmNlW3RoaXMubmFtZV0gPSB2YWx1ZTtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0QWNjZXNzTWVtYmVyKHRoaXMpO1xuICB9XG5cbiAgY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHRoaXMub2JqZWN0LmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIGxldCBvYmogPSB0aGlzLm9iamVjdC5ldmFsdWF0ZShzY29wZSk7XG4gICAgaWYgKG9iaikge1xuICAgICAgYmluZGluZy5vYnNlcnZlUHJvcGVydHkob2JqLCB0aGlzLm5hbWUpO1xuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGxldCBBY2Nlc3NLZXllZCA9IGNsYXNzIEFjY2Vzc0tleWVkIGV4dGVuZHMgRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKG9iamVjdCwga2V5KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMub2JqZWN0ID0gb2JqZWN0O1xuICAgIHRoaXMua2V5ID0ga2V5O1xuICAgIHRoaXMuaXNBc3NpZ25hYmxlID0gdHJ1ZTtcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBsZXQgaW5zdGFuY2UgPSB0aGlzLm9iamVjdC5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICBsZXQgbG9va3VwID0gdGhpcy5rZXkuZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgcmV0dXJuIGdldEtleWVkKGluc3RhbmNlLCBsb29rdXApO1xuICB9XG5cbiAgYXNzaWduKHNjb3BlLCB2YWx1ZSkge1xuICAgIGxldCBpbnN0YW5jZSA9IHRoaXMub2JqZWN0LmV2YWx1YXRlKHNjb3BlKTtcbiAgICBsZXQgbG9va3VwID0gdGhpcy5rZXkuZXZhbHVhdGUoc2NvcGUpO1xuICAgIHJldHVybiBzZXRLZXllZChpbnN0YW5jZSwgbG9va3VwLCB2YWx1ZSk7XG4gIH1cblxuICBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0QWNjZXNzS2V5ZWQodGhpcyk7XG4gIH1cblxuICBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgdGhpcy5vYmplY3QuY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gICAgbGV0IG9iaiA9IHRoaXMub2JqZWN0LmV2YWx1YXRlKHNjb3BlKTtcbiAgICBpZiAob2JqIGluc3RhbmNlb2YgT2JqZWN0KSB7XG4gICAgICB0aGlzLmtleS5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICAgIGxldCBrZXkgPSB0aGlzLmtleS5ldmFsdWF0ZShzY29wZSk7XG5cbiAgICAgIGlmIChrZXkgIT09IG51bGwgJiYga2V5ICE9PSB1bmRlZmluZWQgJiYgIShBcnJheS5pc0FycmF5KG9iaikgJiYgdHlwZW9mIGtleSA9PT0gJ251bWJlcicpKSB7XG4gICAgICAgIGJpbmRpbmcub2JzZXJ2ZVByb3BlcnR5KG9iaiwga2V5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgQ2FsbFNjb3BlID0gY2xhc3MgQ2FsbFNjb3BlIGV4dGVuZHMgRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKG5hbWUsIGFyZ3MsIGFuY2VzdG9yKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5hcmdzID0gYXJncztcbiAgICB0aGlzLmFuY2VzdG9yID0gYW5jZXN0b3I7XG4gIH1cblxuICBldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zLCBtdXN0RXZhbHVhdGUpIHtcbiAgICBsZXQgYXJncyA9IGV2YWxMaXN0KHNjb3BlLCB0aGlzLmFyZ3MsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgbGV0IGNvbnRleHQgPSBnZXRDb250ZXh0Rm9yKHRoaXMubmFtZSwgc2NvcGUsIHRoaXMuYW5jZXN0b3IpO1xuICAgIGxldCBmdW5jID0gZ2V0RnVuY3Rpb24oY29udGV4dCwgdGhpcy5uYW1lLCBtdXN0RXZhbHVhdGUpO1xuICAgIGlmIChmdW5jKSB7XG4gICAgICByZXR1cm4gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGFjY2VwdCh2aXNpdG9yKSB7XG4gICAgcmV0dXJuIHZpc2l0b3IudmlzaXRDYWxsU2NvcGUodGhpcyk7XG4gIH1cblxuICBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgbGV0IGFyZ3MgPSB0aGlzLmFyZ3M7XG4gICAgbGV0IGkgPSBhcmdzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICBhcmdzW2ldLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGxldCBDYWxsTWVtYmVyID0gY2xhc3MgQ2FsbE1lbWJlciBleHRlbmRzIEV4cHJlc3Npb24ge1xuICBjb25zdHJ1Y3RvcihvYmplY3QsIG5hbWUsIGFyZ3MpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5vYmplY3QgPSBvYmplY3Q7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLmFyZ3MgPSBhcmdzO1xuICB9XG5cbiAgZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucywgbXVzdEV2YWx1YXRlKSB7XG4gICAgbGV0IGluc3RhbmNlID0gdGhpcy5vYmplY3QuZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgbGV0IGFyZ3MgPSBldmFsTGlzdChzY29wZSwgdGhpcy5hcmdzLCBsb29rdXBGdW5jdGlvbnMpO1xuICAgIGxldCBmdW5jID0gZ2V0RnVuY3Rpb24oaW5zdGFuY2UsIHRoaXMubmFtZSwgbXVzdEV2YWx1YXRlKTtcbiAgICBpZiAoZnVuYykge1xuICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkoaW5zdGFuY2UsIGFyZ3MpO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdENhbGxNZW1iZXIodGhpcyk7XG4gIH1cblxuICBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgdGhpcy5vYmplY3QuY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gICAgbGV0IG9iaiA9IHRoaXMub2JqZWN0LmV2YWx1YXRlKHNjb3BlKTtcbiAgICBpZiAoZ2V0RnVuY3Rpb24ob2JqLCB0aGlzLm5hbWUsIGZhbHNlKSkge1xuICAgICAgbGV0IGFyZ3MgPSB0aGlzLmFyZ3M7XG4gICAgICBsZXQgaSA9IGFyZ3MubGVuZ3RoO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBhcmdzW2ldLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGxldCBDYWxsRnVuY3Rpb24gPSBjbGFzcyBDYWxsRnVuY3Rpb24gZXh0ZW5kcyBFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3IoZnVuYywgYXJncykge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLmZ1bmMgPSBmdW5jO1xuICAgIHRoaXMuYXJncyA9IGFyZ3M7XG4gIH1cblxuICBldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zLCBtdXN0RXZhbHVhdGUpIHtcbiAgICBsZXQgZnVuYyA9IHRoaXMuZnVuYy5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICBpZiAodHlwZW9mIGZ1bmMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBmdW5jLmFwcGx5KG51bGwsIGV2YWxMaXN0KHNjb3BlLCB0aGlzLmFyZ3MsIGxvb2t1cEZ1bmN0aW9ucykpO1xuICAgIH1cbiAgICBpZiAoIW11c3RFdmFsdWF0ZSAmJiAoZnVuYyA9PT0gbnVsbCB8fCBmdW5jID09PSB1bmRlZmluZWQpKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGhpcy5mdW5jfSBpcyBub3QgYSBmdW5jdGlvbmApO1xuICB9XG5cbiAgYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdENhbGxGdW5jdGlvbih0aGlzKTtcbiAgfVxuXG4gIGNvbm5lY3QoYmluZGluZywgc2NvcGUpIHtcbiAgICB0aGlzLmZ1bmMuY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gICAgbGV0IGZ1bmMgPSB0aGlzLmZ1bmMuZXZhbHVhdGUoc2NvcGUpO1xuICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgbGV0IGFyZ3MgPSB0aGlzLmFyZ3M7XG4gICAgICBsZXQgaSA9IGFyZ3MubGVuZ3RoO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBhcmdzW2ldLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGxldCBCaW5hcnkgPSBjbGFzcyBCaW5hcnkgZXh0ZW5kcyBFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3Iob3BlcmF0aW9uLCBsZWZ0LCByaWdodCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLm9wZXJhdGlvbiA9IG9wZXJhdGlvbjtcbiAgICB0aGlzLmxlZnQgPSBsZWZ0O1xuICAgIHRoaXMucmlnaHQgPSByaWdodDtcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBsZXQgbGVmdCA9IHRoaXMubGVmdC5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcblxuICAgIHN3aXRjaCAodGhpcy5vcGVyYXRpb24pIHtcbiAgICAgIGNhc2UgJyYmJzpcbiAgICAgICAgcmV0dXJuIGxlZnQgJiYgdGhpcy5yaWdodC5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICAgIGNhc2UgJ3x8JzpcbiAgICAgICAgcmV0dXJuIGxlZnQgfHwgdGhpcy5yaWdodC5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG5cbiAgICBsZXQgcmlnaHQgPSB0aGlzLnJpZ2h0LmV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgc3dpdGNoICh0aGlzLm9wZXJhdGlvbikge1xuICAgICAgY2FzZSAnPT0nOlxuICAgICAgICByZXR1cm4gbGVmdCA9PSByaWdodDtcbiAgICAgIGNhc2UgJz09PSc6XG4gICAgICAgIHJldHVybiBsZWZ0ID09PSByaWdodDtcbiAgICAgIGNhc2UgJyE9JzpcbiAgICAgICAgcmV0dXJuIGxlZnQgIT0gcmlnaHQ7XG4gICAgICBjYXNlICchPT0nOlxuICAgICAgICByZXR1cm4gbGVmdCAhPT0gcmlnaHQ7XG4gICAgICBjYXNlICdpbnN0YW5jZW9mJzpcbiAgICAgICAgcmV0dXJuIHR5cGVvZiByaWdodCA9PT0gJ2Z1bmN0aW9uJyAmJiBsZWZ0IGluc3RhbmNlb2YgcmlnaHQ7XG4gICAgICBjYXNlICdpbic6XG4gICAgICAgIHJldHVybiB0eXBlb2YgcmlnaHQgPT09ICdvYmplY3QnICYmIHJpZ2h0ICE9PSBudWxsICYmIGxlZnQgaW4gcmlnaHQ7XG4gICAgfVxuXG4gICAgaWYgKGxlZnQgPT09IG51bGwgfHwgcmlnaHQgPT09IG51bGwgfHwgbGVmdCA9PT0gdW5kZWZpbmVkIHx8IHJpZ2h0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHN3aXRjaCAodGhpcy5vcGVyYXRpb24pIHtcbiAgICAgICAgY2FzZSAnKyc6XG4gICAgICAgICAgaWYgKGxlZnQgIT09IG51bGwgJiYgbGVmdCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gbGVmdDtcbiAgICAgICAgICBpZiAocmlnaHQgIT09IG51bGwgJiYgcmlnaHQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHJpZ2h0O1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICBjYXNlICctJzpcbiAgICAgICAgICBpZiAobGVmdCAhPT0gbnVsbCAmJiBsZWZ0ICE9PSB1bmRlZmluZWQpIHJldHVybiBsZWZ0O1xuICAgICAgICAgIGlmIChyaWdodCAhPT0gbnVsbCAmJiByaWdodCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gMCAtIHJpZ2h0O1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKHRoaXMub3BlcmF0aW9uKSB7XG4gICAgICBjYXNlICcrJzpcbiAgICAgICAgcmV0dXJuIGF1dG9Db252ZXJ0QWRkKGxlZnQsIHJpZ2h0KTtcbiAgICAgIGNhc2UgJy0nOlxuICAgICAgICByZXR1cm4gbGVmdCAtIHJpZ2h0O1xuICAgICAgY2FzZSAnKic6XG4gICAgICAgIHJldHVybiBsZWZ0ICogcmlnaHQ7XG4gICAgICBjYXNlICcvJzpcbiAgICAgICAgcmV0dXJuIGxlZnQgLyByaWdodDtcbiAgICAgIGNhc2UgJyUnOlxuICAgICAgICByZXR1cm4gbGVmdCAlIHJpZ2h0O1xuICAgICAgY2FzZSAnPCc6XG4gICAgICAgIHJldHVybiBsZWZ0IDwgcmlnaHQ7XG4gICAgICBjYXNlICc+JzpcbiAgICAgICAgcmV0dXJuIGxlZnQgPiByaWdodDtcbiAgICAgIGNhc2UgJzw9JzpcbiAgICAgICAgcmV0dXJuIGxlZnQgPD0gcmlnaHQ7XG4gICAgICBjYXNlICc+PSc6XG4gICAgICAgIHJldHVybiBsZWZ0ID49IHJpZ2h0O1xuICAgICAgY2FzZSAnXic6XG4gICAgICAgIHJldHVybiBsZWZ0IF4gcmlnaHQ7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKGBJbnRlcm5hbCBlcnJvciBbJHt0aGlzLm9wZXJhdGlvbn1dIG5vdCBoYW5kbGVkYCk7XG4gIH1cblxuICBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0QmluYXJ5KHRoaXMpO1xuICB9XG5cbiAgY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHRoaXMubGVmdC5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICBsZXQgbGVmdCA9IHRoaXMubGVmdC5ldmFsdWF0ZShzY29wZSk7XG4gICAgaWYgKHRoaXMub3BlcmF0aW9uID09PSAnJiYnICYmICFsZWZ0IHx8IHRoaXMub3BlcmF0aW9uID09PSAnfHwnICYmIGxlZnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5yaWdodC5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgfVxufTtcblxuZXhwb3J0IGxldCBVbmFyeSA9IGNsYXNzIFVuYXJ5IGV4dGVuZHMgRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKG9wZXJhdGlvbiwgZXhwcmVzc2lvbikge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLm9wZXJhdGlvbiA9IG9wZXJhdGlvbjtcbiAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICB9XG5cbiAgZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHN3aXRjaCAodGhpcy5vcGVyYXRpb24pIHtcbiAgICAgIGNhc2UgJyEnOlxuICAgICAgICByZXR1cm4gIXRoaXMuZXhwcmVzc2lvbi5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICAgIGNhc2UgJ3R5cGVvZic6XG4gICAgICAgIHJldHVybiB0eXBlb2YgdGhpcy5leHByZXNzaW9uLmV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpO1xuICAgICAgY2FzZSAndm9pZCc6XG4gICAgICAgIHJldHVybiB2b2lkIHRoaXMuZXhwcmVzc2lvbi5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludGVybmFsIGVycm9yIFske3RoaXMub3BlcmF0aW9ufV0gbm90IGhhbmRsZWRgKTtcbiAgfVxuXG4gIGFjY2VwdCh2aXNpdG9yKSB7XG4gICAgcmV0dXJuIHZpc2l0b3IudmlzaXRQcmVmaXgodGhpcyk7XG4gIH1cblxuICBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgdGhpcy5leHByZXNzaW9uLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IExpdGVyYWxQcmltaXRpdmUgPSBjbGFzcyBMaXRlcmFsUHJpbWl0aXZlIGV4dGVuZHMgRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKHZhbHVlKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgfVxuXG4gIGFjY2VwdCh2aXNpdG9yKSB7XG4gICAgcmV0dXJuIHZpc2l0b3IudmlzaXRMaXRlcmFsUHJpbWl0aXZlKHRoaXMpO1xuICB9XG5cbiAgY29ubmVjdChiaW5kaW5nLCBzY29wZSkge31cbn07XG5cbmV4cG9ydCBsZXQgTGl0ZXJhbFN0cmluZyA9IGNsYXNzIExpdGVyYWxTdHJpbmcgZXh0ZW5kcyBFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3IodmFsdWUpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICB9XG5cbiAgZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICB9XG5cbiAgYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdExpdGVyYWxTdHJpbmcodGhpcyk7XG4gIH1cblxuICBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7fVxufTtcblxuZXhwb3J0IGxldCBMaXRlcmFsVGVtcGxhdGUgPSBjbGFzcyBMaXRlcmFsVGVtcGxhdGUgZXh0ZW5kcyBFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3IoY29va2VkLCBleHByZXNzaW9ucywgcmF3LCB0YWcpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuY29va2VkID0gY29va2VkO1xuICAgIHRoaXMuZXhwcmVzc2lvbnMgPSBleHByZXNzaW9ucyB8fCBbXTtcbiAgICB0aGlzLmxlbmd0aCA9IHRoaXMuZXhwcmVzc2lvbnMubGVuZ3RoO1xuICAgIHRoaXMudGFnZ2VkID0gdGFnICE9PSB1bmRlZmluZWQ7XG4gICAgaWYgKHRoaXMudGFnZ2VkKSB7XG4gICAgICB0aGlzLmNvb2tlZC5yYXcgPSByYXc7XG4gICAgICB0aGlzLnRhZyA9IHRhZztcbiAgICAgIGlmICh0YWcgaW5zdGFuY2VvZiBBY2Nlc3NTY29wZSkge1xuICAgICAgICB0aGlzLmNvbnRleHRUeXBlID0gJ1Njb3BlJztcbiAgICAgIH0gZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgQWNjZXNzTWVtYmVyIHx8IHRhZyBpbnN0YW5jZW9mIEFjY2Vzc0tleWVkKSB7XG4gICAgICAgIHRoaXMuY29udGV4dFR5cGUgPSAnT2JqZWN0JztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0aGlzLnRhZ30gaXMgbm90IGEgdmFsaWQgdGVtcGxhdGUgdGFnYCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0U2NvcGVDb250ZXh0KHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gZ2V0Q29udGV4dEZvcih0aGlzLnRhZy5uYW1lLCBzY29wZSwgdGhpcy50YWcuYW5jZXN0b3IpO1xuICB9XG5cbiAgZ2V0T2JqZWN0Q29udGV4dChzY29wZSwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMudGFnLm9iamVjdC5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMsIG11c3RFdmFsdWF0ZSkge1xuICAgIGNvbnN0IHJlc3VsdHMgPSBuZXcgQXJyYXkodGhpcy5sZW5ndGgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0c1tpXSA9IHRoaXMuZXhwcmVzc2lvbnNbaV0uZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgfVxuICAgIGlmICh0aGlzLnRhZ2dlZCkge1xuICAgICAgY29uc3QgZnVuYyA9IHRoaXMudGFnLmV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpO1xuICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzW2BnZXQke3RoaXMuY29udGV4dFR5cGV9Q29udGV4dGBdKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpO1xuICAgICAgICByZXR1cm4gZnVuYy5jYWxsKGNvbnRleHQsIHRoaXMuY29va2VkLCAuLi5yZXN1bHRzKTtcbiAgICAgIH1cbiAgICAgIGlmICghbXVzdEV2YWx1YXRlKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGAke3RoaXMudGFnfSBpcyBub3QgYSBmdW5jdGlvbmApO1xuICAgIH1cbiAgICBsZXQgcmVzdWx0ID0gdGhpcy5jb29rZWRbMF07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHQgPSBTdHJpbmcucHJvdG90eXBlLmNvbmNhdChyZXN1bHQsIHJlc3VsdHNbaV0sIHRoaXMuY29va2VkW2kgKyAxXSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0TGl0ZXJhbFRlbXBsYXRlKHRoaXMpO1xuICB9XG5cbiAgY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5leHByZXNzaW9uc1tpXS5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICB9XG4gICAgaWYgKHRoaXMudGFnZ2VkKSB7XG4gICAgICB0aGlzLnRhZy5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgTGl0ZXJhbEFycmF5ID0gY2xhc3MgTGl0ZXJhbEFycmF5IGV4dGVuZHMgRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKGVsZW1lbnRzKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMuZWxlbWVudHMgPSBlbGVtZW50cztcbiAgfVxuXG4gIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBsZXQgZWxlbWVudHMgPSB0aGlzLmVsZW1lbnRzO1xuICAgIGxldCByZXN1bHQgPSBbXTtcblxuICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBlbGVtZW50cy5sZW5ndGg7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgcmVzdWx0W2ldID0gZWxlbWVudHNbaV0uZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGFjY2VwdCh2aXNpdG9yKSB7XG4gICAgcmV0dXJuIHZpc2l0b3IudmlzaXRMaXRlcmFsQXJyYXkodGhpcyk7XG4gIH1cblxuICBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgbGV0IGxlbmd0aCA9IHRoaXMuZWxlbWVudHMubGVuZ3RoO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuZWxlbWVudHNbaV0uY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gICAgfVxuICB9XG59O1xuXG5leHBvcnQgbGV0IExpdGVyYWxPYmplY3QgPSBjbGFzcyBMaXRlcmFsT2JqZWN0IGV4dGVuZHMgRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKGtleXMsIHZhbHVlcykge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLmtleXMgPSBrZXlzO1xuICAgIHRoaXMudmFsdWVzID0gdmFsdWVzO1xuICB9XG5cbiAgZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIGxldCBpbnN0YW5jZSA9IHt9O1xuICAgIGxldCBrZXlzID0gdGhpcy5rZXlzO1xuICAgIGxldCB2YWx1ZXMgPSB0aGlzLnZhbHVlcztcblxuICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICBpbnN0YW5jZVtrZXlzW2ldXSA9IHZhbHVlc1tpXS5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH1cblxuICBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0TGl0ZXJhbE9iamVjdCh0aGlzKTtcbiAgfVxuXG4gIGNvbm5lY3QoYmluZGluZywgc2NvcGUpIHtcbiAgICBsZXQgbGVuZ3RoID0gdGhpcy5rZXlzLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLnZhbHVlc1tpXS5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICB9XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGV2YWxMaXN0KHNjb3BlLCBsaXN0LCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgY29uc3QgbGVuZ3RoID0gbGlzdC5sZW5ndGg7XG4gIGNvbnN0IHJlc3VsdCA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgcmVzdWx0W2ldID0gbGlzdFtpXS5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBhdXRvQ29udmVydEFkZChhLCBiKSB7XG4gIGlmIChhICE9PSBudWxsICYmIGIgIT09IG51bGwpIHtcbiAgICBpZiAodHlwZW9mIGEgPT09ICdzdHJpbmcnICYmIHR5cGVvZiBiICE9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIGEgKyBiLnRvU3RyaW5nKCk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBhICE9PSAnc3RyaW5nJyAmJiB0eXBlb2YgYiA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiBhLnRvU3RyaW5nKCkgKyBiO1xuICAgIH1cblxuICAgIHJldHVybiBhICsgYjtcbiAgfVxuXG4gIGlmIChhICE9PSBudWxsKSB7XG4gICAgcmV0dXJuIGE7XG4gIH1cblxuICBpZiAoYiAhPT0gbnVsbCkge1xuICAgIHJldHVybiBiO1xuICB9XG5cbiAgcmV0dXJuIDA7XG59XG5cbmZ1bmN0aW9uIGdldEZ1bmN0aW9uKG9iaiwgbmFtZSwgbXVzdEV4aXN0KSB7XG4gIGxldCBmdW5jID0gb2JqID09PSBudWxsIHx8IG9iaiA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IG9ialtuYW1lXTtcbiAgaWYgKHR5cGVvZiBmdW5jID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIGZ1bmM7XG4gIH1cbiAgaWYgKCFtdXN0RXhpc3QgJiYgKGZ1bmMgPT09IG51bGwgfHwgZnVuYyA9PT0gdW5kZWZpbmVkKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHRocm93IG5ldyBFcnJvcihgJHtuYW1lfSBpcyBub3QgYSBmdW5jdGlvbmApO1xufVxuXG5mdW5jdGlvbiBnZXRLZXllZChvYmosIGtleSkge1xuICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgcmV0dXJuIG9ialtwYXJzZUludChrZXksIDEwKV07XG4gIH0gZWxzZSBpZiAob2JqKSB7XG4gICAgcmV0dXJuIG9ialtrZXldO1xuICB9IGVsc2UgaWYgKG9iaiA9PT0gbnVsbCB8fCBvYmogPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICByZXR1cm4gb2JqW2tleV07XG59XG5cbmZ1bmN0aW9uIHNldEtleWVkKG9iaiwga2V5LCB2YWx1ZSkge1xuICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgbGV0IGluZGV4ID0gcGFyc2VJbnQoa2V5LCAxMCk7XG5cbiAgICBpZiAob2JqLmxlbmd0aCA8PSBpbmRleCkge1xuICAgICAgb2JqLmxlbmd0aCA9IGluZGV4ICsgMTtcbiAgICB9XG5cbiAgICBvYmpbaW5kZXhdID0gdmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgb2JqW2tleV0gPSB2YWx1ZTtcbiAgfVxuXG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZXhwb3J0IGxldCBVbnBhcnNlciA9IG51bGw7XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19VTlBBUlNFUiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgVW5wYXJzZXIgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoYnVmZmVyKSB7XG4gICAgICB0aGlzLmJ1ZmZlciA9IGJ1ZmZlcjtcbiAgICB9XG5cbiAgICBzdGF0aWMgdW5wYXJzZShleHByZXNzaW9uKSB7XG4gICAgICBsZXQgYnVmZmVyID0gW107XG4gICAgICBsZXQgdmlzaXRvciA9IG5ldyBVbnBhcnNlcihidWZmZXIpO1xuXG4gICAgICBleHByZXNzaW9uLmFjY2VwdCh2aXNpdG9yKTtcblxuICAgICAgcmV0dXJuIGJ1ZmZlci5qb2luKCcnKTtcbiAgICB9XG5cbiAgICB3cml0ZSh0ZXh0KSB7XG4gICAgICB0aGlzLmJ1ZmZlci5wdXNoKHRleHQpO1xuICAgIH1cblxuICAgIHdyaXRlQXJncyhhcmdzKSB7XG4gICAgICB0aGlzLndyaXRlKCcoJyk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBhcmdzLmxlbmd0aDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICAgIGlmIChpICE9PSAwKSB7XG4gICAgICAgICAgdGhpcy53cml0ZSgnLCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgYXJnc1tpXS5hY2NlcHQodGhpcyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMud3JpdGUoJyknKTtcbiAgICB9XG5cbiAgICB2aXNpdEJpbmRpbmdCZWhhdmlvcihiZWhhdmlvcikge1xuICAgICAgbGV0IGFyZ3MgPSBiZWhhdmlvci5hcmdzO1xuXG4gICAgICBiZWhhdmlvci5leHByZXNzaW9uLmFjY2VwdCh0aGlzKTtcbiAgICAgIHRoaXMud3JpdGUoYCYke2JlaGF2aW9yLm5hbWV9YCk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBhcmdzLmxlbmd0aDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICAgIHRoaXMud3JpdGUoJzonKTtcbiAgICAgICAgYXJnc1tpXS5hY2NlcHQodGhpcyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmlzaXRWYWx1ZUNvbnZlcnRlcihjb252ZXJ0ZXIpIHtcbiAgICAgIGxldCBhcmdzID0gY29udmVydGVyLmFyZ3M7XG5cbiAgICAgIGNvbnZlcnRlci5leHByZXNzaW9uLmFjY2VwdCh0aGlzKTtcbiAgICAgIHRoaXMud3JpdGUoYHwke2NvbnZlcnRlci5uYW1lfWApO1xuXG4gICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gYXJncy5sZW5ndGg7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICB0aGlzLndyaXRlKCc6Jyk7XG4gICAgICAgIGFyZ3NbaV0uYWNjZXB0KHRoaXMpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZpc2l0QXNzaWduKGFzc2lnbikge1xuICAgICAgYXNzaWduLnRhcmdldC5hY2NlcHQodGhpcyk7XG4gICAgICB0aGlzLndyaXRlKCc9Jyk7XG4gICAgICBhc3NpZ24udmFsdWUuYWNjZXB0KHRoaXMpO1xuICAgIH1cblxuICAgIHZpc2l0Q29uZGl0aW9uYWwoY29uZGl0aW9uYWwpIHtcbiAgICAgIGNvbmRpdGlvbmFsLmNvbmRpdGlvbi5hY2NlcHQodGhpcyk7XG4gICAgICB0aGlzLndyaXRlKCc/Jyk7XG4gICAgICBjb25kaXRpb25hbC55ZXMuYWNjZXB0KHRoaXMpO1xuICAgICAgdGhpcy53cml0ZSgnOicpO1xuICAgICAgY29uZGl0aW9uYWwubm8uYWNjZXB0KHRoaXMpO1xuICAgIH1cblxuICAgIHZpc2l0QWNjZXNzVGhpcyhhY2Nlc3MpIHtcbiAgICAgIGlmIChhY2Nlc3MuYW5jZXN0b3IgPT09IDApIHtcbiAgICAgICAgdGhpcy53cml0ZSgnJHRoaXMnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy53cml0ZSgnJHBhcmVudCcpO1xuICAgICAgbGV0IGkgPSBhY2Nlc3MuYW5jZXN0b3IgLSAxO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICB0aGlzLndyaXRlKCcuJHBhcmVudCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZpc2l0QWNjZXNzU2NvcGUoYWNjZXNzKSB7XG4gICAgICBsZXQgaSA9IGFjY2Vzcy5hbmNlc3RvcjtcbiAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgdGhpcy53cml0ZSgnJHBhcmVudC4nKTtcbiAgICAgIH1cbiAgICAgIHRoaXMud3JpdGUoYWNjZXNzLm5hbWUpO1xuICAgIH1cblxuICAgIHZpc2l0QWNjZXNzTWVtYmVyKGFjY2Vzcykge1xuICAgICAgYWNjZXNzLm9iamVjdC5hY2NlcHQodGhpcyk7XG4gICAgICB0aGlzLndyaXRlKGAuJHthY2Nlc3MubmFtZX1gKTtcbiAgICB9XG5cbiAgICB2aXNpdEFjY2Vzc0tleWVkKGFjY2Vzcykge1xuICAgICAgYWNjZXNzLm9iamVjdC5hY2NlcHQodGhpcyk7XG4gICAgICB0aGlzLndyaXRlKCdbJyk7XG4gICAgICBhY2Nlc3Mua2V5LmFjY2VwdCh0aGlzKTtcbiAgICAgIHRoaXMud3JpdGUoJ10nKTtcbiAgICB9XG5cbiAgICB2aXNpdENhbGxTY29wZShjYWxsKSB7XG4gICAgICBsZXQgaSA9IGNhbGwuYW5jZXN0b3I7XG4gICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHRoaXMud3JpdGUoJyRwYXJlbnQuJyk7XG4gICAgICB9XG4gICAgICB0aGlzLndyaXRlKGNhbGwubmFtZSk7XG4gICAgICB0aGlzLndyaXRlQXJncyhjYWxsLmFyZ3MpO1xuICAgIH1cblxuICAgIHZpc2l0Q2FsbEZ1bmN0aW9uKGNhbGwpIHtcbiAgICAgIGNhbGwuZnVuYy5hY2NlcHQodGhpcyk7XG4gICAgICB0aGlzLndyaXRlQXJncyhjYWxsLmFyZ3MpO1xuICAgIH1cblxuICAgIHZpc2l0Q2FsbE1lbWJlcihjYWxsKSB7XG4gICAgICBjYWxsLm9iamVjdC5hY2NlcHQodGhpcyk7XG4gICAgICB0aGlzLndyaXRlKGAuJHtjYWxsLm5hbWV9YCk7XG4gICAgICB0aGlzLndyaXRlQXJncyhjYWxsLmFyZ3MpO1xuICAgIH1cblxuICAgIHZpc2l0UHJlZml4KHByZWZpeCkge1xuICAgICAgdGhpcy53cml0ZShgKCR7cHJlZml4Lm9wZXJhdGlvbn1gKTtcbiAgICAgIGlmIChwcmVmaXgub3BlcmF0aW9uLmNoYXJDb2RlQXQoMCkgPj0gOTcpIHtcbiAgICAgICAgdGhpcy53cml0ZSgnICcpO1xuICAgICAgfVxuICAgICAgcHJlZml4LmV4cHJlc3Npb24uYWNjZXB0KHRoaXMpO1xuICAgICAgdGhpcy53cml0ZSgnKScpO1xuICAgIH1cblxuICAgIHZpc2l0QmluYXJ5KGJpbmFyeSkge1xuICAgICAgYmluYXJ5LmxlZnQuYWNjZXB0KHRoaXMpO1xuICAgICAgaWYgKGJpbmFyeS5vcGVyYXRpb24uY2hhckNvZGVBdCgwKSA9PT0gMTA1KSB7XG4gICAgICAgIHRoaXMud3JpdGUoYCAke2JpbmFyeS5vcGVyYXRpb259IGApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy53cml0ZShiaW5hcnkub3BlcmF0aW9uKTtcbiAgICAgIH1cbiAgICAgIGJpbmFyeS5yaWdodC5hY2NlcHQodGhpcyk7XG4gICAgfVxuXG4gICAgdmlzaXRMaXRlcmFsUHJpbWl0aXZlKGxpdGVyYWwpIHtcbiAgICAgIHRoaXMud3JpdGUoYCR7bGl0ZXJhbC52YWx1ZX1gKTtcbiAgICB9XG5cbiAgICB2aXNpdExpdGVyYWxBcnJheShsaXRlcmFsKSB7XG4gICAgICBsZXQgZWxlbWVudHMgPSBsaXRlcmFsLmVsZW1lbnRzO1xuXG4gICAgICB0aGlzLndyaXRlKCdbJyk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBlbGVtZW50cy5sZW5ndGg7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICBpZiAoaSAhPT0gMCkge1xuICAgICAgICAgIHRoaXMud3JpdGUoJywnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsZW1lbnRzW2ldLmFjY2VwdCh0aGlzKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy53cml0ZSgnXScpO1xuICAgIH1cblxuICAgIHZpc2l0TGl0ZXJhbE9iamVjdChsaXRlcmFsKSB7XG4gICAgICBsZXQga2V5cyA9IGxpdGVyYWwua2V5cztcbiAgICAgIGxldCB2YWx1ZXMgPSBsaXRlcmFsLnZhbHVlcztcblxuICAgICAgdGhpcy53cml0ZSgneycpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICBpZiAoaSAhPT0gMCkge1xuICAgICAgICAgIHRoaXMud3JpdGUoJywnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMud3JpdGUoYCcke2tleXNbaV19JzpgKTtcbiAgICAgICAgdmFsdWVzW2ldLmFjY2VwdCh0aGlzKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy53cml0ZSgnfScpO1xuICAgIH1cblxuICAgIHZpc2l0TGl0ZXJhbFN0cmluZyhsaXRlcmFsKSB7XG4gICAgICBsZXQgZXNjYXBlZCA9IGxpdGVyYWwudmFsdWUucmVwbGFjZSgvJy9nLCBcIlxcJ1wiKTtcbiAgICAgIHRoaXMud3JpdGUoYCcke2VzY2FwZWR9J2ApO1xuICAgIH1cblxuICAgIHZpc2l0TGl0ZXJhbFRlbXBsYXRlKGxpdGVyYWwpIHtcbiAgICAgIGNvbnN0IHsgY29va2VkLCBleHByZXNzaW9ucyB9ID0gbGl0ZXJhbDtcbiAgICAgIGNvbnN0IGxlbmd0aCA9IGV4cHJlc3Npb25zLmxlbmd0aDtcbiAgICAgIHRoaXMud3JpdGUoJ2AnKTtcbiAgICAgIHRoaXMud3JpdGUoY29va2VkWzBdKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZXhwcmVzc2lvbnNbaV0uYWNjZXB0KHRoaXMpO1xuICAgICAgICB0aGlzLndyaXRlKGNvb2tlZFtpICsgMV0pO1xuICAgICAgfVxuICAgICAgdGhpcy53cml0ZSgnYCcpO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGxldCBFeHByZXNzaW9uQ2xvbmVyID0gY2xhc3MgRXhwcmVzc2lvbkNsb25lciB7XG4gIGNsb25lRXhwcmVzc2lvbkFycmF5KGFycmF5KSB7XG4gICAgbGV0IGNsb25lZEFycmF5ID0gW107XG4gICAgbGV0IGkgPSBhcnJheS5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgY2xvbmVkQXJyYXlbaV0gPSBhcnJheVtpXS5hY2NlcHQodGhpcyk7XG4gICAgfVxuICAgIHJldHVybiBjbG9uZWRBcnJheTtcbiAgfVxuXG4gIHZpc2l0QmluZGluZ0JlaGF2aW9yKGJlaGF2aW9yKSB7XG4gICAgcmV0dXJuIG5ldyBCaW5kaW5nQmVoYXZpb3IoYmVoYXZpb3IuZXhwcmVzc2lvbi5hY2NlcHQodGhpcyksIGJlaGF2aW9yLm5hbWUsIHRoaXMuY2xvbmVFeHByZXNzaW9uQXJyYXkoYmVoYXZpb3IuYXJncykpO1xuICB9XG5cbiAgdmlzaXRWYWx1ZUNvbnZlcnRlcihjb252ZXJ0ZXIpIHtcbiAgICByZXR1cm4gbmV3IFZhbHVlQ29udmVydGVyKGNvbnZlcnRlci5leHByZXNzaW9uLmFjY2VwdCh0aGlzKSwgY29udmVydGVyLm5hbWUsIHRoaXMuY2xvbmVFeHByZXNzaW9uQXJyYXkoY29udmVydGVyLmFyZ3MpKTtcbiAgfVxuXG4gIHZpc2l0QXNzaWduKGFzc2lnbikge1xuICAgIHJldHVybiBuZXcgQXNzaWduKGFzc2lnbi50YXJnZXQuYWNjZXB0KHRoaXMpLCBhc3NpZ24udmFsdWUuYWNjZXB0KHRoaXMpKTtcbiAgfVxuXG4gIHZpc2l0Q29uZGl0aW9uYWwoY29uZGl0aW9uYWwpIHtcbiAgICByZXR1cm4gbmV3IENvbmRpdGlvbmFsKGNvbmRpdGlvbmFsLmNvbmRpdGlvbi5hY2NlcHQodGhpcyksIGNvbmRpdGlvbmFsLnllcy5hY2NlcHQodGhpcyksIGNvbmRpdGlvbmFsLm5vLmFjY2VwdCh0aGlzKSk7XG4gIH1cblxuICB2aXNpdEFjY2Vzc1RoaXMoYWNjZXNzKSB7XG4gICAgcmV0dXJuIG5ldyBBY2Nlc3NUaGlzKGFjY2Vzcy5hbmNlc3Rvcik7XG4gIH1cblxuICB2aXNpdEFjY2Vzc1Njb3BlKGFjY2Vzcykge1xuICAgIHJldHVybiBuZXcgQWNjZXNzU2NvcGUoYWNjZXNzLm5hbWUsIGFjY2Vzcy5hbmNlc3Rvcik7XG4gIH1cblxuICB2aXNpdEFjY2Vzc01lbWJlcihhY2Nlc3MpIHtcbiAgICByZXR1cm4gbmV3IEFjY2Vzc01lbWJlcihhY2Nlc3Mub2JqZWN0LmFjY2VwdCh0aGlzKSwgYWNjZXNzLm5hbWUpO1xuICB9XG5cbiAgdmlzaXRBY2Nlc3NLZXllZChhY2Nlc3MpIHtcbiAgICByZXR1cm4gbmV3IEFjY2Vzc0tleWVkKGFjY2Vzcy5vYmplY3QuYWNjZXB0KHRoaXMpLCBhY2Nlc3Mua2V5LmFjY2VwdCh0aGlzKSk7XG4gIH1cblxuICB2aXNpdENhbGxTY29wZShjYWxsKSB7XG4gICAgcmV0dXJuIG5ldyBDYWxsU2NvcGUoY2FsbC5uYW1lLCB0aGlzLmNsb25lRXhwcmVzc2lvbkFycmF5KGNhbGwuYXJncyksIGNhbGwuYW5jZXN0b3IpO1xuICB9XG5cbiAgdmlzaXRDYWxsRnVuY3Rpb24oY2FsbCkge1xuICAgIHJldHVybiBuZXcgQ2FsbEZ1bmN0aW9uKGNhbGwuZnVuYy5hY2NlcHQodGhpcyksIHRoaXMuY2xvbmVFeHByZXNzaW9uQXJyYXkoY2FsbC5hcmdzKSk7XG4gIH1cblxuICB2aXNpdENhbGxNZW1iZXIoY2FsbCkge1xuICAgIHJldHVybiBuZXcgQ2FsbE1lbWJlcihjYWxsLm9iamVjdC5hY2NlcHQodGhpcyksIGNhbGwubmFtZSwgdGhpcy5jbG9uZUV4cHJlc3Npb25BcnJheShjYWxsLmFyZ3MpKTtcbiAgfVxuXG4gIHZpc2l0VW5hcnkodW5hcnkpIHtcbiAgICByZXR1cm4gbmV3IFVuYXJ5KHByZWZpeC5vcGVyYXRpb24sIHByZWZpeC5leHByZXNzaW9uLmFjY2VwdCh0aGlzKSk7XG4gIH1cblxuICB2aXNpdEJpbmFyeShiaW5hcnkpIHtcbiAgICByZXR1cm4gbmV3IEJpbmFyeShiaW5hcnkub3BlcmF0aW9uLCBiaW5hcnkubGVmdC5hY2NlcHQodGhpcyksIGJpbmFyeS5yaWdodC5hY2NlcHQodGhpcykpO1xuICB9XG5cbiAgdmlzaXRMaXRlcmFsUHJpbWl0aXZlKGxpdGVyYWwpIHtcbiAgICByZXR1cm4gbmV3IExpdGVyYWxQcmltaXRpdmUobGl0ZXJhbCk7XG4gIH1cblxuICB2aXNpdExpdGVyYWxBcnJheShsaXRlcmFsKSB7XG4gICAgcmV0dXJuIG5ldyBMaXRlcmFsQXJyYXkodGhpcy5jbG9uZUV4cHJlc3Npb25BcnJheShsaXRlcmFsLmVsZW1lbnRzKSk7XG4gIH1cblxuICB2aXNpdExpdGVyYWxPYmplY3QobGl0ZXJhbCkge1xuICAgIHJldHVybiBuZXcgTGl0ZXJhbE9iamVjdChsaXRlcmFsLmtleXMsIHRoaXMuY2xvbmVFeHByZXNzaW9uQXJyYXkobGl0ZXJhbC52YWx1ZXMpKTtcbiAgfVxuXG4gIHZpc2l0TGl0ZXJhbFN0cmluZyhsaXRlcmFsKSB7XG4gICAgcmV0dXJuIG5ldyBMaXRlcmFsU3RyaW5nKGxpdGVyYWwudmFsdWUpO1xuICB9XG5cbiAgdmlzaXRMaXRlcmFsVGVtcGxhdGUobGl0ZXJhbCkge1xuICAgIHJldHVybiBuZXcgTGl0ZXJhbFRlbXBsYXRlKGxpdGVyYWwuY29va2VkLCB0aGlzLmNsb25lRXhwcmVzc2lvbkFycmF5KGxpdGVyYWwuZXhwcmVzc2lvbnMpLCBsaXRlcmFsLnJhdywgbGl0ZXJhbC50YWcgJiYgbGl0ZXJhbC50YWcuYWNjZXB0KHRoaXMpKTtcbiAgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNsb25lRXhwcmVzc2lvbihleHByZXNzaW9uKSB7XG4gIGxldCB2aXNpdG9yID0gbmV3IEV4cHJlc3Npb25DbG9uZXIoKTtcbiAgcmV0dXJuIGV4cHJlc3Npb24uYWNjZXB0KHZpc2l0b3IpO1xufVxuXG5leHBvcnQgY29uc3QgYmluZGluZ01vZGUgPSB7XG4gIG9uZVRpbWU6IDAsXG4gIHRvVmlldzogMSxcbiAgb25lV2F5OiAxLFxuICB0d29XYXk6IDIsXG4gIGZyb21WaWV3OiAzXG59O1xuXG5leHBvcnQgbGV0IFBhcnNlciA9IGNsYXNzIFBhcnNlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICB9XG5cbiAgcGFyc2Uoc3JjKSB7XG4gICAgc3JjID0gc3JjIHx8ICcnO1xuXG4gICAgcmV0dXJuIHRoaXMuY2FjaGVbc3JjXSB8fCAodGhpcy5jYWNoZVtzcmNdID0gbmV3IFBhcnNlckltcGxlbWVudGF0aW9uKHNyYykucGFyc2VCaW5kaW5nQmVoYXZpb3IoKSk7XG4gIH1cbn07XG5cbmNvbnN0IGZyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGU7XG5cbmV4cG9ydCBsZXQgUGFyc2VySW1wbGVtZW50YXRpb24gPSBjbGFzcyBQYXJzZXJJbXBsZW1lbnRhdGlvbiB7XG4gIGdldCByYXcoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3JjLnNsaWNlKHRoaXMuc3RhcnQsIHRoaXMuaWR4KTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHNyYykge1xuICAgIHRoaXMuaWR4ID0gMDtcblxuICAgIHRoaXMuc3RhcnQgPSAwO1xuXG4gICAgdGhpcy5zcmMgPSBzcmM7XG4gICAgdGhpcy5sZW4gPSBzcmMubGVuZ3RoO1xuXG4gICAgdGhpcy50a24gPSBUJEVPRjtcblxuICAgIHRoaXMudmFsID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5jaCA9IHNyYy5jaGFyQ29kZUF0KDApO1xuICB9XG5cbiAgcGFyc2VCaW5kaW5nQmVoYXZpb3IoKSB7XG4gICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICBpZiAodGhpcy50a24gJiBUJEV4cHJlc3Npb25UZXJtaW5hbCkge1xuICAgICAgdGhpcy5lcnIoJ0ludmFsaWQgc3RhcnQgb2YgZXhwcmVzc2lvbicpO1xuICAgIH1cbiAgICBsZXQgcmVzdWx0ID0gdGhpcy5wYXJzZVZhbHVlQ29udmVydGVyKCk7XG4gICAgd2hpbGUgKHRoaXMub3B0KFQkQW1wZXJzYW5kKSkge1xuICAgICAgcmVzdWx0ID0gbmV3IEJpbmRpbmdCZWhhdmlvcihyZXN1bHQsIHRoaXMudmFsLCB0aGlzLnBhcnNlVmFyaWFkaWNBcmdzKCkpO1xuICAgIH1cbiAgICBpZiAodGhpcy50a24gIT09IFQkRU9GKSB7XG4gICAgICB0aGlzLmVycihgVW5jb25zdW1lZCB0b2tlbiAke3RoaXMucmF3fWApO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcGFyc2VWYWx1ZUNvbnZlcnRlcigpIHtcbiAgICBsZXQgcmVzdWx0ID0gdGhpcy5wYXJzZUV4cHJlc3Npb24oKTtcbiAgICB3aGlsZSAodGhpcy5vcHQoVCRCYXIpKSB7XG4gICAgICByZXN1bHQgPSBuZXcgVmFsdWVDb252ZXJ0ZXIocmVzdWx0LCB0aGlzLnZhbCwgdGhpcy5wYXJzZVZhcmlhZGljQXJncygpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHBhcnNlVmFyaWFkaWNBcmdzKCkge1xuICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgd2hpbGUgKHRoaXMub3B0KFQkQ29sb24pKSB7XG4gICAgICByZXN1bHQucHVzaCh0aGlzLnBhcnNlRXhwcmVzc2lvbigpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHBhcnNlRXhwcmVzc2lvbigpIHtcbiAgICBsZXQgZXhwclN0YXJ0ID0gdGhpcy5pZHg7XG4gICAgbGV0IHJlc3VsdCA9IHRoaXMucGFyc2VDb25kaXRpb25hbCgpO1xuXG4gICAgd2hpbGUgKHRoaXMudGtuID09PSBUJEVxKSB7XG4gICAgICBpZiAoIXJlc3VsdC5pc0Fzc2lnbmFibGUpIHtcbiAgICAgICAgdGhpcy5lcnIoYEV4cHJlc3Npb24gJHt0aGlzLnNyYy5zbGljZShleHByU3RhcnQsIHRoaXMuc3RhcnQpfSBpcyBub3QgYXNzaWduYWJsZWApO1xuICAgICAgfVxuICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICAgIGV4cHJTdGFydCA9IHRoaXMuaWR4O1xuICAgICAgcmVzdWx0ID0gbmV3IEFzc2lnbihyZXN1bHQsIHRoaXMucGFyc2VDb25kaXRpb25hbCgpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHBhcnNlQ29uZGl0aW9uYWwoKSB7XG4gICAgbGV0IHJlc3VsdCA9IHRoaXMucGFyc2VCaW5hcnkoMCk7XG5cbiAgICBpZiAodGhpcy5vcHQoVCRRdWVzdGlvbikpIHtcbiAgICAgIGxldCB5ZXMgPSB0aGlzLnBhcnNlRXhwcmVzc2lvbigpO1xuICAgICAgdGhpcy5leHBlY3QoVCRDb2xvbik7XG4gICAgICByZXN1bHQgPSBuZXcgQ29uZGl0aW9uYWwocmVzdWx0LCB5ZXMsIHRoaXMucGFyc2VFeHByZXNzaW9uKCkpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcGFyc2VCaW5hcnkobWluUHJlY2VkZW5jZSkge1xuICAgIGxldCBsZWZ0ID0gdGhpcy5wYXJzZUxlZnRIYW5kU2lkZSgwKTtcblxuICAgIHdoaWxlICh0aGlzLnRrbiAmIFQkQmluYXJ5T3ApIHtcbiAgICAgIGNvbnN0IG9wVG9rZW4gPSB0aGlzLnRrbjtcbiAgICAgIGlmICgob3BUb2tlbiAmIFQkUHJlY2VkZW5jZSkgPD0gbWluUHJlY2VkZW5jZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgICBsZWZ0ID0gbmV3IEJpbmFyeShUb2tlblZhbHVlc1tvcFRva2VuICYgVCRUb2tlbk1hc2tdLCBsZWZ0LCB0aGlzLnBhcnNlQmluYXJ5KG9wVG9rZW4gJiBUJFByZWNlZGVuY2UpKTtcbiAgICB9XG4gICAgcmV0dXJuIGxlZnQ7XG4gIH1cblxuICBwYXJzZUxlZnRIYW5kU2lkZShjb250ZXh0KSB7XG4gICAgbGV0IHJlc3VsdDtcblxuICAgIHByaW1hcnk6IHN3aXRjaCAodGhpcy50a24pIHtcbiAgICAgIGNhc2UgVCRQbHVzOlxuICAgICAgICB0aGlzLm5leHRUb2tlbigpO1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUxlZnRIYW5kU2lkZSgwKTtcbiAgICAgIGNhc2UgVCRNaW51czpcbiAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICAgICAgcmV0dXJuIG5ldyBCaW5hcnkoJy0nLCBuZXcgTGl0ZXJhbFByaW1pdGl2ZSgwKSwgdGhpcy5wYXJzZUxlZnRIYW5kU2lkZSgwKSk7XG4gICAgICBjYXNlIFQkQmFuZzpcbiAgICAgIGNhc2UgVCRUeXBlb2ZLZXl3b3JkOlxuICAgICAgY2FzZSBUJFZvaWRLZXl3b3JkOlxuICAgICAgICBjb25zdCBvcCA9IFRva2VuVmFsdWVzW3RoaXMudGtuICYgVCRUb2tlbk1hc2tdO1xuICAgICAgICB0aGlzLm5leHRUb2tlbigpO1xuICAgICAgICByZXR1cm4gbmV3IFVuYXJ5KG9wLCB0aGlzLnBhcnNlTGVmdEhhbmRTaWRlKDApKTtcbiAgICAgIGNhc2UgVCRQYXJlbnRTY29wZTpcbiAgICAgICAge1xuICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgICAgICAgICBjb250ZXh0Kys7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHQoVCRQZXJpb2QpKSB7XG4gICAgICAgICAgICAgIGlmICh0aGlzLnRrbiA9PT0gVCRQZXJpb2QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycigpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRrbiAmIFQkQWNjZXNzU2NvcGVUZXJtaW5hbCkge1xuICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgQWNjZXNzVGhpcyhjb250ZXh0ICYgQyRBbmNlc3Rvcik7XG5cbiAgICAgICAgICAgICAgY29udGV4dCA9IGNvbnRleHQgJiBDJFNob3J0aGFuZFByb3AgfCBDJFRoaXM7XG4gICAgICAgICAgICAgIGJyZWFrIHByaW1hcnk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLmVycigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gd2hpbGUgKHRoaXMudGtuID09PSBUJFBhcmVudFNjb3BlKTtcbiAgICAgICAgfVxuXG4gICAgICBjYXNlIFQkSWRlbnRpZmllcjpcbiAgICAgICAge1xuICAgICAgICAgIHJlc3VsdCA9IG5ldyBBY2Nlc3NTY29wZSh0aGlzLnZhbCwgY29udGV4dCAmIEMkQW5jZXN0b3IpO1xuICAgICAgICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgICAgICAgY29udGV4dCA9IGNvbnRleHQgJiBDJFNob3J0aGFuZFByb3AgfCBDJFNjb3BlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICBjYXNlIFQkVGhpc1Njb3BlOlxuICAgICAgICB0aGlzLm5leHRUb2tlbigpO1xuICAgICAgICByZXN1bHQgPSBuZXcgQWNjZXNzVGhpcygwKTtcbiAgICAgICAgY29udGV4dCA9IGNvbnRleHQgJiBDJFNob3J0aGFuZFByb3AgfCBDJFRoaXM7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUJExQYXJlbjpcbiAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICAgICAgcmVzdWx0ID0gdGhpcy5wYXJzZUV4cHJlc3Npb24oKTtcbiAgICAgICAgdGhpcy5leHBlY3QoVCRSUGFyZW4pO1xuICAgICAgICBjb250ZXh0ID0gQyRQcmltYXJ5O1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVCRMQnJhY2tldDpcbiAgICAgICAge1xuICAgICAgICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBbXTtcbiAgICAgICAgICBpZiAodGhpcy50a24gIT09IFQkUkJyYWNrZXQpIHtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgZWxlbWVudHMucHVzaCh0aGlzLnBhcnNlRXhwcmVzc2lvbigpKTtcbiAgICAgICAgICAgIH0gd2hpbGUgKHRoaXMub3B0KFQkQ29tbWEpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5leHBlY3QoVCRSQnJhY2tldCk7XG4gICAgICAgICAgcmVzdWx0ID0gbmV3IExpdGVyYWxBcnJheShlbGVtZW50cyk7XG4gICAgICAgICAgY29udGV4dCA9IEMkUHJpbWFyeTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgY2FzZSBUJExCcmFjZTpcbiAgICAgICAge1xuICAgICAgICAgIGNvbnN0IGtleXMgPSBbXTtcbiAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBbXTtcbiAgICAgICAgICB0aGlzLm5leHRUb2tlbigpO1xuICAgICAgICAgIHdoaWxlICh0aGlzLnRrbiAhPT0gVCRSQnJhY2UpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRrbiAmIFQkSWRlbnRpZmllck9yS2V5d29yZCkge1xuICAgICAgICAgICAgICBjb25zdCB7IGNoLCB0a24sIGlkeCB9ID0gdGhpcztcbiAgICAgICAgICAgICAga2V5cy5wdXNoKHRoaXMudmFsKTtcbiAgICAgICAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICAgICAgICAgICAgaWYgKHRoaXMub3B0KFQkQ29sb24pKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVzLnB1c2godGhpcy5wYXJzZUV4cHJlc3Npb24oKSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaCA9IGNoO1xuICAgICAgICAgICAgICAgIHRoaXMudGtuID0gdGtuO1xuICAgICAgICAgICAgICAgIHRoaXMuaWR4ID0gaWR4O1xuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKHRoaXMucGFyc2VMZWZ0SGFuZFNpZGUoQyRTaG9ydGhhbmRQcm9wKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50a24gJiBUJExpdGVyYWwpIHtcbiAgICAgICAgICAgICAga2V5cy5wdXNoKHRoaXMudmFsKTtcbiAgICAgICAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICAgICAgICAgICAgdGhpcy5leHBlY3QoVCRDb2xvbik7XG4gICAgICAgICAgICAgIHZhbHVlcy5wdXNoKHRoaXMucGFyc2VFeHByZXNzaW9uKCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5lcnIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnRrbiAhPT0gVCRSQnJhY2UpIHtcbiAgICAgICAgICAgICAgdGhpcy5leHBlY3QoVCRDb21tYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuZXhwZWN0KFQkUkJyYWNlKTtcbiAgICAgICAgICByZXN1bHQgPSBuZXcgTGl0ZXJhbE9iamVjdChrZXlzLCB2YWx1ZXMpO1xuICAgICAgICAgIGNvbnRleHQgPSBDJFByaW1hcnk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIGNhc2UgVCRTdHJpbmdMaXRlcmFsOlxuICAgICAgICByZXN1bHQgPSBuZXcgTGl0ZXJhbFN0cmluZyh0aGlzLnZhbCk7XG4gICAgICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgICAgIGNvbnRleHQgPSBDJFByaW1hcnk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBUJFRlbXBsYXRlVGFpbDpcbiAgICAgICAgcmVzdWx0ID0gbmV3IExpdGVyYWxUZW1wbGF0ZShbdGhpcy52YWxdKTtcbiAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICAgICAgY29udGV4dCA9IEMkUHJpbWFyeTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFQkVGVtcGxhdGVDb250aW51YXRpb246XG4gICAgICAgIHJlc3VsdCA9IHRoaXMucGFyc2VUZW1wbGF0ZSgwKTtcbiAgICAgICAgY29udGV4dCA9IEMkUHJpbWFyeTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFQkTnVtZXJpY0xpdGVyYWw6XG4gICAgICAgIHtcbiAgICAgICAgICByZXN1bHQgPSBuZXcgTGl0ZXJhbFByaW1pdGl2ZSh0aGlzLnZhbCk7XG4gICAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcblxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICBjYXNlIFQkTnVsbEtleXdvcmQ6XG4gICAgICBjYXNlIFQkVW5kZWZpbmVkS2V5d29yZDpcbiAgICAgIGNhc2UgVCRUcnVlS2V5d29yZDpcbiAgICAgIGNhc2UgVCRGYWxzZUtleXdvcmQ6XG4gICAgICAgIHJlc3VsdCA9IG5ldyBMaXRlcmFsUHJpbWl0aXZlKFRva2VuVmFsdWVzW3RoaXMudGtuICYgVCRUb2tlbk1hc2tdKTtcbiAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICAgICAgY29udGV4dCA9IEMkUHJpbWFyeTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAodGhpcy5pZHggPj0gdGhpcy5sZW4pIHtcbiAgICAgICAgICB0aGlzLmVycignVW5leHBlY3RlZCBlbmQgb2YgZXhwcmVzc2lvbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZXJyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY29udGV4dCAmIEMkU2hvcnRoYW5kUHJvcCkge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBsZXQgbmFtZSA9IHRoaXMudmFsO1xuICAgIHdoaWxlICh0aGlzLnRrbiAmIFQkTWVtYmVyT3JDYWxsRXhwcmVzc2lvbikge1xuICAgICAgc3dpdGNoICh0aGlzLnRrbikge1xuICAgICAgICBjYXNlIFQkUGVyaW9kOlxuICAgICAgICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgICAgICAgaWYgKCEodGhpcy50a24gJiBUJElkZW50aWZpZXJPcktleXdvcmQpKSB7XG4gICAgICAgICAgICB0aGlzLmVycigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBuYW1lID0gdGhpcy52YWw7XG4gICAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcblxuICAgICAgICAgIGNvbnRleHQgPSBjb250ZXh0ICYgQyRQcmltYXJ5IHwgKGNvbnRleHQgJiAoQyRUaGlzIHwgQyRTY29wZSkpIDw8IDEgfCBjb250ZXh0ICYgQyRNZW1iZXIgfCAoY29udGV4dCAmIEMkS2V5ZWQpID4+IDEgfCAoY29udGV4dCAmIEMkQ2FsbCkgPj4gMjtcbiAgICAgICAgICBpZiAodGhpcy50a24gPT09IFQkTFBhcmVuKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNvbnRleHQgJiBDJFNjb3BlKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBuZXcgQWNjZXNzU2NvcGUobmFtZSwgcmVzdWx0LmFuY2VzdG9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gbmV3IEFjY2Vzc01lbWJlcihyZXN1bHQsIG5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgY2FzZSBUJExCcmFja2V0OlxuICAgICAgICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgICAgICAgY29udGV4dCA9IEMkS2V5ZWQ7XG4gICAgICAgICAgcmVzdWx0ID0gbmV3IEFjY2Vzc0tleWVkKHJlc3VsdCwgdGhpcy5wYXJzZUV4cHJlc3Npb24oKSk7XG4gICAgICAgICAgdGhpcy5leHBlY3QoVCRSQnJhY2tldCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgVCRMUGFyZW46XG4gICAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICAgICAgICBjb25zdCBhcmdzID0gW107XG4gICAgICAgICAgd2hpbGUgKHRoaXMudGtuICE9PSBUJFJQYXJlbikge1xuICAgICAgICAgICAgYXJncy5wdXNoKHRoaXMucGFyc2VFeHByZXNzaW9uKCkpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLm9wdChUJENvbW1hKSkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5leHBlY3QoVCRSUGFyZW4pO1xuICAgICAgICAgIGlmIChjb250ZXh0ICYgQyRTY29wZSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gbmV3IENhbGxTY29wZShuYW1lLCBhcmdzLCByZXN1bHQuYW5jZXN0b3IpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY29udGV4dCAmIChDJE1lbWJlciB8IEMkUHJpbWFyeSkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBDYWxsTWVtYmVyKHJlc3VsdCwgbmFtZSwgYXJncyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBDYWxsRnVuY3Rpb24ocmVzdWx0LCBhcmdzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29udGV4dCA9IEMkQ2FsbDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBUJFRlbXBsYXRlVGFpbDpcbiAgICAgICAgICByZXN1bHQgPSBuZXcgTGl0ZXJhbFRlbXBsYXRlKFt0aGlzLnZhbF0sIFtdLCBbdGhpcy5yYXddLCByZXN1bHQpO1xuICAgICAgICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgVCRUZW1wbGF0ZUNvbnRpbnVhdGlvbjpcbiAgICAgICAgICByZXN1bHQgPSB0aGlzLnBhcnNlVGVtcGxhdGUoY29udGV4dCB8IEMkVGFnZ2VkLCByZXN1bHQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwYXJzZVRlbXBsYXRlKGNvbnRleHQsIGZ1bmMpIHtcbiAgICBjb25zdCBjb29rZWQgPSBbdGhpcy52YWxdO1xuICAgIGNvbnN0IHJhdyA9IGNvbnRleHQgJiBDJFRhZ2dlZCA/IFt0aGlzLnJhd10gOiB1bmRlZmluZWQ7XG4gICAgdGhpcy5leHBlY3QoVCRUZW1wbGF0ZUNvbnRpbnVhdGlvbik7XG4gICAgY29uc3QgZXhwcmVzc2lvbnMgPSBbdGhpcy5wYXJzZUV4cHJlc3Npb24oKV07XG5cbiAgICB3aGlsZSAoKHRoaXMudGtuID0gdGhpcy5zY2FuVGVtcGxhdGVUYWlsKCkpICE9PSBUJFRlbXBsYXRlVGFpbCkge1xuICAgICAgY29va2VkLnB1c2godGhpcy52YWwpO1xuICAgICAgaWYgKGNvbnRleHQgJiBDJFRhZ2dlZCkge1xuICAgICAgICByYXcucHVzaCh0aGlzLnJhdyk7XG4gICAgICB9XG4gICAgICB0aGlzLmV4cGVjdChUJFRlbXBsYXRlQ29udGludWF0aW9uKTtcbiAgICAgIGV4cHJlc3Npb25zLnB1c2godGhpcy5wYXJzZUV4cHJlc3Npb24oKSk7XG4gICAgfVxuXG4gICAgY29va2VkLnB1c2godGhpcy52YWwpO1xuICAgIGlmIChjb250ZXh0ICYgQyRUYWdnZWQpIHtcbiAgICAgIHJhdy5wdXNoKHRoaXMucmF3KTtcbiAgICB9XG4gICAgdGhpcy5uZXh0VG9rZW4oKTtcbiAgICByZXR1cm4gbmV3IExpdGVyYWxUZW1wbGF0ZShjb29rZWQsIGV4cHJlc3Npb25zLCByYXcsIGZ1bmMpO1xuICB9XG5cbiAgbmV4dFRva2VuKCkge1xuICAgIHdoaWxlICh0aGlzLmlkeCA8IHRoaXMubGVuKSB7XG4gICAgICBpZiAodGhpcy5jaCA8PSAweDIwKSB7XG4gICAgICAgIHRoaXMubmV4dCgpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc3RhcnQgPSB0aGlzLmlkeDtcbiAgICAgIGlmICh0aGlzLmNoID09PSAweDI0IHx8IHRoaXMuY2ggPj0gMHg2MSAmJiB0aGlzLmNoIDw9IDB4N0EpIHtcbiAgICAgICAgdGhpcy50a24gPSB0aGlzLnNjYW5JZGVudGlmaWVyKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCh0aGlzLnRrbiA9IENoYXJTY2FubmVyc1t0aGlzLmNoXSh0aGlzKSkgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnRrbiA9IFQkRU9GO1xuICB9XG5cbiAgbmV4dCgpIHtcbiAgICByZXR1cm4gdGhpcy5jaCA9IHRoaXMuc3JjLmNoYXJDb2RlQXQoKyt0aGlzLmlkeCk7XG4gIH1cblxuICBzY2FuSWRlbnRpZmllcigpIHtcbiAgICB3aGlsZSAoQXNjaWlJZFBhcnRzLmhhcyh0aGlzLm5leHQoKSkgfHwgdGhpcy5jaCA+IDB4N0YgJiYgSWRQYXJ0c1t0aGlzLmNoXSkge31cblxuICAgIHJldHVybiBLZXl3b3JkTG9va3VwW3RoaXMudmFsID0gdGhpcy5yYXddIHx8IFQkSWRlbnRpZmllcjtcbiAgfVxuXG4gIHNjYW5OdW1iZXIoaXNGbG9hdCkge1xuICAgIGlmIChpc0Zsb2F0KSB7XG4gICAgICB0aGlzLnZhbCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudmFsID0gdGhpcy5jaCAtIDB4MzA7XG4gICAgICB3aGlsZSAodGhpcy5uZXh0KCkgPD0gMHgzOSAmJiB0aGlzLmNoID49IDB4MzApIHtcbiAgICAgICAgdGhpcy52YWwgPSB0aGlzLnZhbCAqIDEwICsgdGhpcy5jaCAtIDB4MzA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGlzRmxvYXQgfHwgdGhpcy5jaCA9PT0gMHgyRSkge1xuICAgICAgaWYgKCFpc0Zsb2F0KSB7XG4gICAgICAgIHRoaXMubmV4dCgpO1xuICAgICAgfVxuICAgICAgY29uc3Qgc3RhcnQgPSB0aGlzLmlkeDtcbiAgICAgIGxldCB2YWx1ZSA9IHRoaXMuY2ggLSAweDMwO1xuICAgICAgd2hpbGUgKHRoaXMubmV4dCgpIDw9IDB4MzkgJiYgdGhpcy5jaCA+PSAweDMwKSB7XG4gICAgICAgIHZhbHVlID0gdmFsdWUgKiAxMCArIHRoaXMuY2ggLSAweDMwO1xuICAgICAgfVxuICAgICAgdGhpcy52YWwgPSB0aGlzLnZhbCArIHZhbHVlIC8gTWF0aC5wb3coMTAsIHRoaXMuaWR4IC0gc3RhcnQpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmNoID09PSAweDY1IHx8IHRoaXMuY2ggPT09IDB4NDUpIHtcbiAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5pZHg7XG5cbiAgICAgIHRoaXMubmV4dCgpO1xuICAgICAgaWYgKHRoaXMuY2ggPT09IDB4MkQgfHwgdGhpcy5jaCA9PT0gMHgyQikge1xuICAgICAgICB0aGlzLm5leHQoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCEodGhpcy5jaCA+PSAweDMwICYmIHRoaXMuY2ggPD0gMHgzOSkpIHtcbiAgICAgICAgdGhpcy5pZHggPSBzdGFydDtcbiAgICAgICAgdGhpcy5lcnIoJ0ludmFsaWQgZXhwb25lbnQnKTtcbiAgICAgIH1cbiAgICAgIHdoaWxlICh0aGlzLm5leHQoKSA8PSAweDM5ICYmIHRoaXMuY2ggPj0gMHgzMCkge31cbiAgICAgIHRoaXMudmFsID0gcGFyc2VGbG9hdCh0aGlzLnNyYy5zbGljZSh0aGlzLnN0YXJ0LCB0aGlzLmlkeCkpO1xuICAgIH1cblxuICAgIHJldHVybiBUJE51bWVyaWNMaXRlcmFsO1xuICB9XG5cbiAgc2NhblN0cmluZygpIHtcbiAgICBsZXQgcXVvdGUgPSB0aGlzLmNoO1xuICAgIHRoaXMubmV4dCgpO1xuXG4gICAgbGV0IGJ1ZmZlcjtcbiAgICBsZXQgbWFya2VyID0gdGhpcy5pZHg7XG5cbiAgICB3aGlsZSAodGhpcy5jaCAhPT0gcXVvdGUpIHtcbiAgICAgIGlmICh0aGlzLmNoID09PSAweDVDKSB7XG4gICAgICAgIGlmICghYnVmZmVyKSB7XG4gICAgICAgICAgYnVmZmVyID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBidWZmZXIucHVzaCh0aGlzLnNyYy5zbGljZShtYXJrZXIsIHRoaXMuaWR4KSk7XG5cbiAgICAgICAgdGhpcy5uZXh0KCk7XG5cbiAgICAgICAgbGV0IHVuZXNjYXBlZDtcblxuICAgICAgICBpZiAodGhpcy5jaCA9PT0gMHg3NSkge1xuICAgICAgICAgIHRoaXMubmV4dCgpO1xuXG4gICAgICAgICAgaWYgKHRoaXMuaWR4ICsgNCA8IHRoaXMubGVuKSB7XG4gICAgICAgICAgICBsZXQgaGV4ID0gdGhpcy5zcmMuc2xpY2UodGhpcy5pZHgsIHRoaXMuaWR4ICsgNCk7XG5cbiAgICAgICAgICAgIGlmICghL1tBLVowLTldezR9L2kudGVzdChoZXgpKSB7XG4gICAgICAgICAgICAgIHRoaXMuZXJyKGBJbnZhbGlkIHVuaWNvZGUgZXNjYXBlIFtcXFxcdSR7aGV4fV1gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdW5lc2NhcGVkID0gcGFyc2VJbnQoaGV4LCAxNik7XG4gICAgICAgICAgICB0aGlzLmlkeCArPSA0O1xuICAgICAgICAgICAgdGhpcy5jaCA9IHRoaXMuc3JjLmNoYXJDb2RlQXQodGhpcy5pZHgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVycigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1bmVzY2FwZWQgPSB1bmVzY2FwZSh0aGlzLmNoKTtcbiAgICAgICAgICB0aGlzLm5leHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJ1ZmZlci5wdXNoKGZyb21DaGFyQ29kZSh1bmVzY2FwZWQpKTtcbiAgICAgICAgbWFya2VyID0gdGhpcy5pZHg7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuY2ggPT09IDAgfHwgdGhpcy5pZHggPj0gdGhpcy5sZW4pIHtcbiAgICAgICAgdGhpcy5lcnIoJ1VudGVybWluYXRlZCBxdW90ZScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5uZXh0KCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IGxhc3QgPSB0aGlzLnNyYy5zbGljZShtYXJrZXIsIHRoaXMuaWR4KTtcbiAgICB0aGlzLm5leHQoKTtcbiAgICBsZXQgdW5lc2NhcGVkID0gbGFzdDtcblxuICAgIGlmIChidWZmZXIgIT09IG51bGwgJiYgYnVmZmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGJ1ZmZlci5wdXNoKGxhc3QpO1xuICAgICAgdW5lc2NhcGVkID0gYnVmZmVyLmpvaW4oJycpO1xuICAgIH1cblxuICAgIHRoaXMudmFsID0gdW5lc2NhcGVkO1xuICAgIHJldHVybiBUJFN0cmluZ0xpdGVyYWw7XG4gIH1cblxuICBzY2FuVGVtcGxhdGUoKSB7XG4gICAgbGV0IHRhaWwgPSB0cnVlO1xuICAgIGxldCByZXN1bHQgPSAnJztcblxuICAgIHdoaWxlICh0aGlzLm5leHQoKSAhPT0gMHg2MCkge1xuICAgICAgaWYgKHRoaXMuY2ggPT09IDB4MjQpIHtcbiAgICAgICAgaWYgKHRoaXMuaWR4ICsgMSA8IHRoaXMubGVuICYmIHRoaXMuc3JjLmNoYXJDb2RlQXQodGhpcy5pZHggKyAxKSA9PT0gMHg3Qikge1xuICAgICAgICAgIHRoaXMuaWR4Kys7XG4gICAgICAgICAgdGFpbCA9IGZhbHNlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdCArPSAnJCc7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodGhpcy5jaCA9PT0gMHg1Qykge1xuICAgICAgICByZXN1bHQgKz0gZnJvbUNoYXJDb2RlKHVuZXNjYXBlKHRoaXMubmV4dCgpKSk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuY2ggPT09IDAgfHwgdGhpcy5pZHggPj0gdGhpcy5sZW4pIHtcbiAgICAgICAgdGhpcy5lcnIoJ1VudGVybWluYXRlZCB0ZW1wbGF0ZSBsaXRlcmFsJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgKz0gZnJvbUNoYXJDb2RlKHRoaXMuY2gpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMubmV4dCgpO1xuICAgIHRoaXMudmFsID0gcmVzdWx0O1xuICAgIGlmICh0YWlsKSB7XG4gICAgICByZXR1cm4gVCRUZW1wbGF0ZVRhaWw7XG4gICAgfVxuICAgIHJldHVybiBUJFRlbXBsYXRlQ29udGludWF0aW9uO1xuICB9XG5cbiAgc2NhblRlbXBsYXRlVGFpbCgpIHtcbiAgICBpZiAodGhpcy5pZHggPj0gdGhpcy5sZW4pIHtcbiAgICAgIHRoaXMuZXJyKCdVbnRlcm1pbmF0ZWQgdGVtcGxhdGUnKTtcbiAgICB9XG4gICAgdGhpcy5pZHgtLTtcbiAgICByZXR1cm4gdGhpcy5zY2FuVGVtcGxhdGUoKTtcbiAgfVxuXG4gIGVycihtZXNzYWdlID0gYFVuZXhwZWN0ZWQgdG9rZW4gJHt0aGlzLnJhd31gLCBjb2x1bW4gPSB0aGlzLnN0YXJ0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBQYXJzZXIgRXJyb3I6ICR7bWVzc2FnZX0gYXQgY29sdW1uICR7Y29sdW1ufSBpbiBleHByZXNzaW9uIFske3RoaXMuc3JjfV1gKTtcbiAgfVxuXG4gIG9wdCh0b2tlbikge1xuICAgIGlmICh0aGlzLnRrbiA9PT0gdG9rZW4pIHtcbiAgICAgIHRoaXMubmV4dFRva2VuKCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBleHBlY3QodG9rZW4pIHtcbiAgICBpZiAodGhpcy50a24gPT09IHRva2VuKSB7XG4gICAgICB0aGlzLm5leHRUb2tlbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVycihgTWlzc2luZyBleHBlY3RlZCB0b2tlbiAke1Rva2VuVmFsdWVzW3Rva2VuICYgVCRUb2tlbk1hc2tdfWAsIHRoaXMuaWR4KTtcbiAgICB9XG4gIH1cbn07XG5cbmZ1bmN0aW9uIHVuZXNjYXBlKGNvZGUpIHtcbiAgc3dpdGNoIChjb2RlKSB7XG4gICAgY2FzZSAweDY2OlxuICAgICAgcmV0dXJuIDB4QztcbiAgICBjYXNlIDB4NkU6XG4gICAgICByZXR1cm4gMHhBO1xuICAgIGNhc2UgMHg3MjpcbiAgICAgIHJldHVybiAweEQ7XG4gICAgY2FzZSAweDc0OlxuICAgICAgcmV0dXJuIDB4OTtcbiAgICBjYXNlIDB4NzY6XG4gICAgICByZXR1cm4gMHhCO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gY29kZTtcbiAgfVxufVxuXG5jb25zdCBDJFRoaXMgPSAxIDw8IDEwO1xuY29uc3QgQyRTY29wZSA9IDEgPDwgMTE7XG5jb25zdCBDJE1lbWJlciA9IDEgPDwgMTI7XG5jb25zdCBDJEtleWVkID0gMSA8PCAxMztcbmNvbnN0IEMkQ2FsbCA9IDEgPDwgMTQ7XG5jb25zdCBDJFByaW1hcnkgPSAxIDw8IDE1O1xuY29uc3QgQyRTaG9ydGhhbmRQcm9wID0gMSA8PCAxNjtcbmNvbnN0IEMkVGFnZ2VkID0gMSA8PCAxNztcblxuY29uc3QgQyRBbmNlc3RvciA9ICgxIDw8IDkpIC0gMTtcblxuY29uc3QgVCRUb2tlbk1hc2sgPSAoMSA8PCA2KSAtIDE7XG5cbmNvbnN0IFQkUHJlY1NoaWZ0ID0gNjtcblxuY29uc3QgVCRQcmVjZWRlbmNlID0gNyA8PCBUJFByZWNTaGlmdDtcblxuY29uc3QgVCRFeHByZXNzaW9uVGVybWluYWwgPSAxIDw8IDExO1xuXG5jb25zdCBUJENsb3NpbmdUb2tlbiA9IDEgPDwgMTI7XG5cbmNvbnN0IFQkT3BlbmluZ1Rva2VuID0gMSA8PCAxMztcblxuY29uc3QgVCRBY2Nlc3NTY29wZVRlcm1pbmFsID0gMSA8PCAxNDtcbmNvbnN0IFQkS2V5d29yZCA9IDEgPDwgMTU7XG5jb25zdCBUJEVPRiA9IDEgPDwgMTYgfCBUJEFjY2Vzc1Njb3BlVGVybWluYWwgfCBUJEV4cHJlc3Npb25UZXJtaW5hbDtcbmNvbnN0IFQkSWRlbnRpZmllciA9IDEgPDwgMTc7XG5jb25zdCBUJElkZW50aWZpZXJPcktleXdvcmQgPSBUJElkZW50aWZpZXIgfCBUJEtleXdvcmQ7XG5jb25zdCBUJExpdGVyYWwgPSAxIDw8IDE4O1xuY29uc3QgVCROdW1lcmljTGl0ZXJhbCA9IDEgPDwgMTkgfCBUJExpdGVyYWw7XG5jb25zdCBUJFN0cmluZ0xpdGVyYWwgPSAxIDw8IDIwIHwgVCRMaXRlcmFsO1xuY29uc3QgVCRCaW5hcnlPcCA9IDEgPDwgMjE7XG5cbmNvbnN0IFQkVW5hcnlPcCA9IDEgPDwgMjI7XG5cbmNvbnN0IFQkTWVtYmVyRXhwcmVzc2lvbiA9IDEgPDwgMjM7XG5cbmNvbnN0IFQkTWVtYmVyT3JDYWxsRXhwcmVzc2lvbiA9IDEgPDwgMjQ7XG5jb25zdCBUJFRlbXBsYXRlVGFpbCA9IDEgPDwgMjUgfCBUJE1lbWJlck9yQ2FsbEV4cHJlc3Npb247XG5jb25zdCBUJFRlbXBsYXRlQ29udGludWF0aW9uID0gMSA8PCAyNiB8IFQkTWVtYmVyT3JDYWxsRXhwcmVzc2lvbjtcblxuY29uc3QgVCRGYWxzZUtleXdvcmQgPSAwIHwgVCRLZXl3b3JkIHwgVCRMaXRlcmFsO1xuY29uc3QgVCRUcnVlS2V5d29yZCA9IDEgfCBUJEtleXdvcmQgfCBUJExpdGVyYWw7XG5jb25zdCBUJE51bGxLZXl3b3JkID0gMiB8IFQkS2V5d29yZCB8IFQkTGl0ZXJhbDtcbmNvbnN0IFQkVW5kZWZpbmVkS2V5d29yZCA9IDMgfCBUJEtleXdvcmQgfCBUJExpdGVyYWw7XG5jb25zdCBUJFRoaXNTY29wZSA9IDQgfCBUJElkZW50aWZpZXJPcktleXdvcmQ7XG5jb25zdCBUJFBhcmVudFNjb3BlID0gNSB8IFQkSWRlbnRpZmllck9yS2V5d29yZDtcblxuY29uc3QgVCRMUGFyZW4gPSA2IHwgVCRPcGVuaW5nVG9rZW4gfCBUJEFjY2Vzc1Njb3BlVGVybWluYWwgfCBUJE1lbWJlck9yQ2FsbEV4cHJlc3Npb247XG5jb25zdCBUJExCcmFjZSA9IDcgfCBUJE9wZW5pbmdUb2tlbjtcbmNvbnN0IFQkUGVyaW9kID0gOCB8IFQkTWVtYmVyRXhwcmVzc2lvbiB8IFQkTWVtYmVyT3JDYWxsRXhwcmVzc2lvbjtcbmNvbnN0IFQkUkJyYWNlID0gOSB8IFQkQWNjZXNzU2NvcGVUZXJtaW5hbCB8IFQkQ2xvc2luZ1Rva2VuIHwgVCRFeHByZXNzaW9uVGVybWluYWw7XG5jb25zdCBUJFJQYXJlbiA9IDEwIHwgVCRBY2Nlc3NTY29wZVRlcm1pbmFsIHwgVCRDbG9zaW5nVG9rZW4gfCBUJEV4cHJlc3Npb25UZXJtaW5hbDtcbmNvbnN0IFQkQ29tbWEgPSAxMSB8IFQkQWNjZXNzU2NvcGVUZXJtaW5hbDtcbmNvbnN0IFQkTEJyYWNrZXQgPSAxMiB8IFQkT3BlbmluZ1Rva2VuIHwgVCRBY2Nlc3NTY29wZVRlcm1pbmFsIHwgVCRNZW1iZXJFeHByZXNzaW9uIHwgVCRNZW1iZXJPckNhbGxFeHByZXNzaW9uO1xuY29uc3QgVCRSQnJhY2tldCA9IDEzIHwgVCRDbG9zaW5nVG9rZW4gfCBUJEV4cHJlc3Npb25UZXJtaW5hbDtcbmNvbnN0IFQkQ29sb24gPSAxNCB8IFQkQWNjZXNzU2NvcGVUZXJtaW5hbDtcbmNvbnN0IFQkUXVlc3Rpb24gPSAxNTtcblxuY29uc3QgVCRBbXBlcnNhbmQgPSAxOCB8IFQkQWNjZXNzU2NvcGVUZXJtaW5hbDtcbmNvbnN0IFQkQmFyID0gMTkgfCBUJEFjY2Vzc1Njb3BlVGVybWluYWw7XG5jb25zdCBUJEJhckJhciA9IDIwIHwgMSA8PCBUJFByZWNTaGlmdCB8IFQkQmluYXJ5T3A7XG5jb25zdCBUJEFtcGVyc2FuZEFtcGVyc2FuZCA9IDIxIHwgMiA8PCBUJFByZWNTaGlmdCB8IFQkQmluYXJ5T3A7XG5jb25zdCBUJENhcmV0ID0gMjIgfCAzIDw8IFQkUHJlY1NoaWZ0IHwgVCRCaW5hcnlPcDtcbmNvbnN0IFQkRXFFcSA9IDIzIHwgNCA8PCBUJFByZWNTaGlmdCB8IFQkQmluYXJ5T3A7XG5jb25zdCBUJEJhbmdFcSA9IDI0IHwgNCA8PCBUJFByZWNTaGlmdCB8IFQkQmluYXJ5T3A7XG5jb25zdCBUJEVxRXFFcSA9IDI1IHwgNCA8PCBUJFByZWNTaGlmdCB8IFQkQmluYXJ5T3A7XG5jb25zdCBUJEJhbmdFcUVxID0gMjYgfCA0IDw8IFQkUHJlY1NoaWZ0IHwgVCRCaW5hcnlPcDtcbmNvbnN0IFQkTHQgPSAyNyB8IDUgPDwgVCRQcmVjU2hpZnQgfCBUJEJpbmFyeU9wO1xuY29uc3QgVCRHdCA9IDI4IHwgNSA8PCBUJFByZWNTaGlmdCB8IFQkQmluYXJ5T3A7XG5jb25zdCBUJEx0RXEgPSAyOSB8IDUgPDwgVCRQcmVjU2hpZnQgfCBUJEJpbmFyeU9wO1xuY29uc3QgVCRHdEVxID0gMzAgfCA1IDw8IFQkUHJlY1NoaWZ0IHwgVCRCaW5hcnlPcDtcbmNvbnN0IFQkSW5LZXl3b3JkID0gMzEgfCA1IDw8IFQkUHJlY1NoaWZ0IHwgVCRCaW5hcnlPcCB8IFQkS2V5d29yZDtcbmNvbnN0IFQkSW5zdGFuY2VPZktleXdvcmQgPSAzMiB8IDUgPDwgVCRQcmVjU2hpZnQgfCBUJEJpbmFyeU9wIHwgVCRLZXl3b3JkO1xuY29uc3QgVCRQbHVzID0gMzMgfCA2IDw8IFQkUHJlY1NoaWZ0IHwgVCRCaW5hcnlPcCB8IFQkVW5hcnlPcDtcbmNvbnN0IFQkTWludXMgPSAzNCB8IDYgPDwgVCRQcmVjU2hpZnQgfCBUJEJpbmFyeU9wIHwgVCRVbmFyeU9wO1xuY29uc3QgVCRUeXBlb2ZLZXl3b3JkID0gMzUgfCBUJFVuYXJ5T3AgfCBUJEtleXdvcmQ7XG5jb25zdCBUJFZvaWRLZXl3b3JkID0gMzYgfCBUJFVuYXJ5T3AgfCBUJEtleXdvcmQ7XG5jb25zdCBUJFN0YXIgPSAzNyB8IDcgPDwgVCRQcmVjU2hpZnQgfCBUJEJpbmFyeU9wO1xuY29uc3QgVCRQZXJjZW50ID0gMzggfCA3IDw8IFQkUHJlY1NoaWZ0IHwgVCRCaW5hcnlPcDtcbmNvbnN0IFQkU2xhc2ggPSAzOSB8IDcgPDwgVCRQcmVjU2hpZnQgfCBUJEJpbmFyeU9wO1xuY29uc3QgVCRFcSA9IDQwO1xuY29uc3QgVCRCYW5nID0gNDEgfCBUJFVuYXJ5T3A7XG5cbmNvbnN0IEtleXdvcmRMb29rdXAgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuS2V5d29yZExvb2t1cC50cnVlID0gVCRUcnVlS2V5d29yZDtcbktleXdvcmRMb29rdXAubnVsbCA9IFQkTnVsbEtleXdvcmQ7XG5LZXl3b3JkTG9va3VwLmZhbHNlID0gVCRGYWxzZUtleXdvcmQ7XG5LZXl3b3JkTG9va3VwLnVuZGVmaW5lZCA9IFQkVW5kZWZpbmVkS2V5d29yZDtcbktleXdvcmRMb29rdXAuJHRoaXMgPSBUJFRoaXNTY29wZTtcbktleXdvcmRMb29rdXAuJHBhcmVudCA9IFQkUGFyZW50U2NvcGU7XG5LZXl3b3JkTG9va3VwLmluID0gVCRJbktleXdvcmQ7XG5LZXl3b3JkTG9va3VwLmluc3RhbmNlb2YgPSBUJEluc3RhbmNlT2ZLZXl3b3JkO1xuS2V5d29yZExvb2t1cC50eXBlb2YgPSBUJFR5cGVvZktleXdvcmQ7XG5LZXl3b3JkTG9va3VwLnZvaWQgPSBUJFZvaWRLZXl3b3JkO1xuXG5jb25zdCBUb2tlblZhbHVlcyA9IFtmYWxzZSwgdHJ1ZSwgbnVsbCwgdW5kZWZpbmVkLCAnJHRoaXMnLCAnJHBhcmVudCcsICcoJywgJ3snLCAnLicsICd9JywgJyknLCAnLCcsICdbJywgJ10nLCAnOicsICc/JywgJ1xcJycsICdcIicsICcmJywgJ3wnLCAnfHwnLCAnJiYnLCAnXicsICc9PScsICchPScsICc9PT0nLCAnIT09JywgJzwnLCAnPicsICc8PScsICc+PScsICdpbicsICdpbnN0YW5jZW9mJywgJysnLCAnLScsICd0eXBlb2YnLCAndm9pZCcsICcqJywgJyUnLCAnLycsICc9JywgJyEnXTtcblxuY29uc3QgY29kZXMgPSB7XG4gIEFzY2lpSWRQYXJ0OiBbMHgyNCwgMCwgMHgzMCwgMHgzQSwgMHg0MSwgMHg1QiwgMHg1RiwgMCwgMHg2MSwgMHg3Ql0sXG4gIElkU3RhcnQ6IFsweDI0LCAwLCAweDQxLCAweDVCLCAweDVGLCAwLCAweDYxLCAweDdCLCAweEFBLCAwLCAweEJBLCAwLCAweEMwLCAweEQ3LCAweEQ4LCAweEY3LCAweEY4LCAweDJCOSwgMHgyRTAsIDB4MkU1LCAweDFEMDAsIDB4MUQyNiwgMHgxRDJDLCAweDFENUQsIDB4MUQ2MiwgMHgxRDY2LCAweDFENkIsIDB4MUQ3OCwgMHgxRDc5LCAweDFEQkYsIDB4MUUwMCwgMHgxRjAwLCAweDIwNzEsIDAsIDB4MjA3RiwgMCwgMHgyMDkwLCAweDIwOUQsIDB4MjEyQSwgMHgyMTJDLCAweDIxMzIsIDAsIDB4MjE0RSwgMCwgMHgyMTYwLCAweDIxODksIDB4MkM2MCwgMHgyQzgwLCAweEE3MjIsIDB4QTc4OCwgMHhBNzhCLCAweEE3QUYsIDB4QTdCMCwgMHhBN0I4LCAweEE3RjcsIDB4QTgwMCwgMHhBQjMwLCAweEFCNUIsIDB4QUI1QywgMHhBQjY1LCAweEZCMDAsIDB4RkIwNywgMHhGRjIxLCAweEZGM0IsIDB4RkY0MSwgMHhGRjVCXSxcbiAgRGlnaXQ6IFsweDMwLCAweDNBXSxcbiAgU2tpcDogWzAsIDB4MjEsIDB4N0YsIDB4QTFdXG59O1xuXG5mdW5jdGlvbiBkZWNvbXByZXNzKGxvb2t1cCwgc2V0LCBjb21wcmVzc2VkLCB2YWx1ZSkge1xuICBsZXQgcmFuZ2VDb3VudCA9IGNvbXByZXNzZWQubGVuZ3RoO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHJhbmdlQ291bnQ7IGkgKz0gMikge1xuICAgIGNvbnN0IHN0YXJ0ID0gY29tcHJlc3NlZFtpXTtcbiAgICBsZXQgZW5kID0gY29tcHJlc3NlZFtpICsgMV07XG4gICAgZW5kID0gZW5kID4gMCA/IGVuZCA6IHN0YXJ0ICsgMTtcbiAgICBpZiAobG9va3VwKSB7XG4gICAgICBsZXQgaiA9IHN0YXJ0O1xuICAgICAgd2hpbGUgKGogPCBlbmQpIHtcbiAgICAgICAgbG9va3VwW2pdID0gdmFsdWU7XG4gICAgICAgIGorKztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHNldCkge1xuICAgICAgZm9yIChsZXQgY2ggPSBzdGFydDsgY2ggPCBlbmQ7IGNoKyspIHtcbiAgICAgICAgc2V0LmFkZChjaCk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHJldHVyblRva2VuKHRva2VuKSB7XG4gIHJldHVybiBwID0+IHtcbiAgICBwLm5leHQoKTtcbiAgICByZXR1cm4gdG9rZW47XG4gIH07XG59XG5mdW5jdGlvbiB1bmV4cGVjdGVkQ2hhcmFjdGVyKHApIHtcbiAgcC5lcnIoYFVuZXhwZWN0ZWQgY2hhcmFjdGVyIFske2Zyb21DaGFyQ29kZShwLmNoKX1dYCk7XG4gIHJldHVybiBudWxsO1xufVxuXG5jb25zdCBBc2NpaUlkUGFydHMgPSBuZXcgU2V0KCk7XG5kZWNvbXByZXNzKG51bGwsIEFzY2lpSWRQYXJ0cywgY29kZXMuQXNjaWlJZFBhcnQsIHRydWUpO1xuXG5jb25zdCBJZFBhcnRzID0gbmV3IFVpbnQ4QXJyYXkoMHhGRkZGKTtcbmRlY29tcHJlc3MoSWRQYXJ0cywgbnVsbCwgY29kZXMuSWRTdGFydCwgMSk7XG5kZWNvbXByZXNzKElkUGFydHMsIG51bGwsIGNvZGVzLkRpZ2l0LCAxKTtcblxuY29uc3QgQ2hhclNjYW5uZXJzID0gbmV3IEFycmF5KDB4RkZGRik7XG5sZXQgY2kgPSAwO1xud2hpbGUgKGNpIDwgMHhGRkZGKSB7XG4gIENoYXJTY2FubmVyc1tjaV0gPSB1bmV4cGVjdGVkQ2hhcmFjdGVyO1xuICBjaSsrO1xufVxuXG5kZWNvbXByZXNzKENoYXJTY2FubmVycywgbnVsbCwgY29kZXMuU2tpcCwgcCA9PiB7XG4gIHAubmV4dCgpO1xuICByZXR1cm4gbnVsbDtcbn0pO1xuZGVjb21wcmVzcyhDaGFyU2Nhbm5lcnMsIG51bGwsIGNvZGVzLklkU3RhcnQsIHAgPT4gcC5zY2FuSWRlbnRpZmllcigpKTtcbmRlY29tcHJlc3MoQ2hhclNjYW5uZXJzLCBudWxsLCBjb2Rlcy5EaWdpdCwgcCA9PiBwLnNjYW5OdW1iZXIoZmFsc2UpKTtcblxuQ2hhclNjYW5uZXJzWzB4MjJdID0gQ2hhclNjYW5uZXJzWzB4MjddID0gcCA9PiB7XG4gIHJldHVybiBwLnNjYW5TdHJpbmcoKTtcbn07XG5DaGFyU2Nhbm5lcnNbMHg2MF0gPSBwID0+IHtcbiAgcmV0dXJuIHAuc2NhblRlbXBsYXRlKCk7XG59O1xuXG5DaGFyU2Nhbm5lcnNbMHgyMV0gPSBwID0+IHtcbiAgaWYgKHAubmV4dCgpICE9PSAweDNEKSB7XG4gICAgcmV0dXJuIFQkQmFuZztcbiAgfVxuICBpZiAocC5uZXh0KCkgIT09IDB4M0QpIHtcbiAgICByZXR1cm4gVCRCYW5nRXE7XG4gIH1cbiAgcC5uZXh0KCk7XG4gIHJldHVybiBUJEJhbmdFcUVxO1xufTtcblxuQ2hhclNjYW5uZXJzWzB4M0RdID0gcCA9PiB7XG4gIGlmIChwLm5leHQoKSAhPT0gMHgzRCkge1xuICAgIHJldHVybiBUJEVxO1xuICB9XG4gIGlmIChwLm5leHQoKSAhPT0gMHgzRCkge1xuICAgIHJldHVybiBUJEVxRXE7XG4gIH1cbiAgcC5uZXh0KCk7XG4gIHJldHVybiBUJEVxRXFFcTtcbn07XG5cbkNoYXJTY2FubmVyc1sweDI2XSA9IHAgPT4ge1xuICBpZiAocC5uZXh0KCkgIT09IDB4MjYpIHtcbiAgICByZXR1cm4gVCRBbXBlcnNhbmQ7XG4gIH1cbiAgcC5uZXh0KCk7XG4gIHJldHVybiBUJEFtcGVyc2FuZEFtcGVyc2FuZDtcbn07XG5cbkNoYXJTY2FubmVyc1sweDdDXSA9IHAgPT4ge1xuICBpZiAocC5uZXh0KCkgIT09IDB4N0MpIHtcbiAgICByZXR1cm4gVCRCYXI7XG4gIH1cbiAgcC5uZXh0KCk7XG4gIHJldHVybiBUJEJhckJhcjtcbn07XG5cbkNoYXJTY2FubmVyc1sweDJFXSA9IHAgPT4ge1xuICBpZiAocC5uZXh0KCkgPD0gMHgzOSAmJiBwLmNoID49IDB4MzApIHtcbiAgICByZXR1cm4gcC5zY2FuTnVtYmVyKHRydWUpO1xuICB9XG4gIHJldHVybiBUJFBlcmlvZDtcbn07XG5cbkNoYXJTY2FubmVyc1sweDNDXSA9IHAgPT4ge1xuICBpZiAocC5uZXh0KCkgIT09IDB4M0QpIHtcbiAgICByZXR1cm4gVCRMdDtcbiAgfVxuICBwLm5leHQoKTtcbiAgcmV0dXJuIFQkTHRFcTtcbn07XG5cbkNoYXJTY2FubmVyc1sweDNFXSA9IHAgPT4ge1xuICBpZiAocC5uZXh0KCkgIT09IDB4M0QpIHtcbiAgICByZXR1cm4gVCRHdDtcbiAgfVxuICBwLm5leHQoKTtcbiAgcmV0dXJuIFQkR3RFcTtcbn07XG5cbkNoYXJTY2FubmVyc1sweDI1XSA9IHJldHVyblRva2VuKFQkUGVyY2VudCk7XG5DaGFyU2Nhbm5lcnNbMHgyOF0gPSByZXR1cm5Ub2tlbihUJExQYXJlbik7XG5DaGFyU2Nhbm5lcnNbMHgyOV0gPSByZXR1cm5Ub2tlbihUJFJQYXJlbik7XG5DaGFyU2Nhbm5lcnNbMHgyQV0gPSByZXR1cm5Ub2tlbihUJFN0YXIpO1xuQ2hhclNjYW5uZXJzWzB4MkJdID0gcmV0dXJuVG9rZW4oVCRQbHVzKTtcbkNoYXJTY2FubmVyc1sweDJDXSA9IHJldHVyblRva2VuKFQkQ29tbWEpO1xuQ2hhclNjYW5uZXJzWzB4MkRdID0gcmV0dXJuVG9rZW4oVCRNaW51cyk7XG5DaGFyU2Nhbm5lcnNbMHgyRl0gPSByZXR1cm5Ub2tlbihUJFNsYXNoKTtcbkNoYXJTY2FubmVyc1sweDNBXSA9IHJldHVyblRva2VuKFQkQ29sb24pO1xuQ2hhclNjYW5uZXJzWzB4M0ZdID0gcmV0dXJuVG9rZW4oVCRRdWVzdGlvbik7XG5DaGFyU2Nhbm5lcnNbMHg1Ql0gPSByZXR1cm5Ub2tlbihUJExCcmFja2V0KTtcbkNoYXJTY2FubmVyc1sweDVEXSA9IHJldHVyblRva2VuKFQkUkJyYWNrZXQpO1xuQ2hhclNjYW5uZXJzWzB4NUVdID0gcmV0dXJuVG9rZW4oVCRDYXJldCk7XG5DaGFyU2Nhbm5lcnNbMHg3Ql0gPSByZXR1cm5Ub2tlbihUJExCcmFjZSk7XG5DaGFyU2Nhbm5lcnNbMHg3RF0gPSByZXR1cm5Ub2tlbihUJFJCcmFjZSk7XG5cbmxldCBtYXBQcm90byA9IE1hcC5wcm90b3R5cGU7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXBPYnNlcnZlcih0YXNrUXVldWUsIG1hcCkge1xuICByZXR1cm4gTW9kaWZ5TWFwT2JzZXJ2ZXIuZm9yKHRhc2tRdWV1ZSwgbWFwKTtcbn1cblxubGV0IE1vZGlmeU1hcE9ic2VydmVyID0gY2xhc3MgTW9kaWZ5TWFwT2JzZXJ2ZXIgZXh0ZW5kcyBNb2RpZnlDb2xsZWN0aW9uT2JzZXJ2ZXIge1xuICBjb25zdHJ1Y3Rvcih0YXNrUXVldWUsIG1hcCkge1xuICAgIHN1cGVyKHRhc2tRdWV1ZSwgbWFwKTtcbiAgfVxuXG4gIHN0YXRpYyBmb3IodGFza1F1ZXVlLCBtYXApIHtcbiAgICBpZiAoISgnX19tYXBfb2JzZXJ2ZXJfXycgaW4gbWFwKSkge1xuICAgICAgUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eShtYXAsICdfX21hcF9vYnNlcnZlcl9fJywge1xuICAgICAgICB2YWx1ZTogTW9kaWZ5TWFwT2JzZXJ2ZXIuY3JlYXRlKHRhc2tRdWV1ZSwgbWFwKSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsIGNvbmZpZ3VyYWJsZTogZmFsc2VcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbWFwLl9fbWFwX29ic2VydmVyX187XG4gIH1cblxuICBzdGF0aWMgY3JlYXRlKHRhc2tRdWV1ZSwgbWFwKSB7XG4gICAgbGV0IG9ic2VydmVyID0gbmV3IE1vZGlmeU1hcE9ic2VydmVyKHRhc2tRdWV1ZSwgbWFwKTtcblxuICAgIGxldCBwcm90byA9IG1hcFByb3RvO1xuICAgIGlmIChwcm90by5zZXQgIT09IG1hcC5zZXQgfHwgcHJvdG8uZGVsZXRlICE9PSBtYXAuZGVsZXRlIHx8IHByb3RvLmNsZWFyICE9PSBtYXAuY2xlYXIpIHtcbiAgICAgIHByb3RvID0ge1xuICAgICAgICBzZXQ6IG1hcC5zZXQsXG4gICAgICAgIGRlbGV0ZTogbWFwLmRlbGV0ZSxcbiAgICAgICAgY2xlYXI6IG1hcC5jbGVhclxuICAgICAgfTtcbiAgICB9XG5cbiAgICBtYXAuc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGhhc1ZhbHVlID0gbWFwLmhhcyhhcmd1bWVudHNbMF0pO1xuICAgICAgbGV0IHR5cGUgPSBoYXNWYWx1ZSA/ICd1cGRhdGUnIDogJ2FkZCc7XG4gICAgICBsZXQgb2xkVmFsdWUgPSBtYXAuZ2V0KGFyZ3VtZW50c1swXSk7XG4gICAgICBsZXQgbWV0aG9kQ2FsbFJlc3VsdCA9IHByb3RvLnNldC5hcHBseShtYXAsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAoIWhhc1ZhbHVlIHx8IG9sZFZhbHVlICE9PSBtYXAuZ2V0KGFyZ3VtZW50c1swXSkpIHtcbiAgICAgICAgb2JzZXJ2ZXIuYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgIG9iamVjdDogbWFwLFxuICAgICAgICAgIGtleTogYXJndW1lbnRzWzBdLFxuICAgICAgICAgIG9sZFZhbHVlOiBvbGRWYWx1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtZXRob2RDYWxsUmVzdWx0O1xuICAgIH07XG5cbiAgICBtYXAuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGhhc1ZhbHVlID0gbWFwLmhhcyhhcmd1bWVudHNbMF0pO1xuICAgICAgbGV0IG9sZFZhbHVlID0gbWFwLmdldChhcmd1bWVudHNbMF0pO1xuICAgICAgbGV0IG1ldGhvZENhbGxSZXN1bHQgPSBwcm90by5kZWxldGUuYXBwbHkobWFwLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKGhhc1ZhbHVlKSB7XG4gICAgICAgIG9ic2VydmVyLmFkZENoYW5nZVJlY29yZCh7XG4gICAgICAgICAgdHlwZTogJ2RlbGV0ZScsXG4gICAgICAgICAgb2JqZWN0OiBtYXAsXG4gICAgICAgICAga2V5OiBhcmd1bWVudHNbMF0sXG4gICAgICAgICAgb2xkVmFsdWU6IG9sZFZhbHVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIG1hcC5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBtZXRob2RDYWxsUmVzdWx0ID0gcHJvdG8uY2xlYXIuYXBwbHkobWFwLCBhcmd1bWVudHMpO1xuICAgICAgb2JzZXJ2ZXIuYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgdHlwZTogJ2NsZWFyJyxcbiAgICAgICAgb2JqZWN0OiBtYXBcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIHJldHVybiBvYnNlcnZlcjtcbiAgfVxufTtcblxubGV0IGVtTG9nZ2VyID0gTG9nTWFuYWdlci5nZXRMb2dnZXIoJ2V2ZW50LW1hbmFnZXInKTtcblxuZnVuY3Rpb24gZmluZE9yaWdpbmFsRXZlbnRUYXJnZXQoZXZlbnQpIHtcbiAgcmV0dXJuIGV2ZW50LnBhdGggJiYgZXZlbnQucGF0aFswXSB8fCBldmVudC5kZWVwUGF0aCAmJiBldmVudC5kZWVwUGF0aFswXSB8fCBldmVudC50YXJnZXQ7XG59XG5cbmZ1bmN0aW9uIHN0b3BQcm9wYWdhdGlvbigpIHtcbiAgdGhpcy5zdGFuZGFyZFN0b3BQcm9wYWdhdGlvbigpO1xuICB0aGlzLnByb3BhZ2F0aW9uU3RvcHBlZCA9IHRydWU7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUNhcHR1cmVkRXZlbnQoZXZlbnQpIHtcbiAgZXZlbnQucHJvcGFnYXRpb25TdG9wcGVkID0gZmFsc2U7XG4gIGxldCB0YXJnZXQgPSBmaW5kT3JpZ2luYWxFdmVudFRhcmdldChldmVudCk7XG5cbiAgbGV0IG9yZGVyZWRDYWxsYmFja3MgPSBbXTtcblxuICB3aGlsZSAodGFyZ2V0KSB7XG4gICAgaWYgKHRhcmdldC5jYXB0dXJlZENhbGxiYWNrcykge1xuICAgICAgbGV0IGNhbGxiYWNrID0gdGFyZ2V0LmNhcHR1cmVkQ2FsbGJhY2tzW2V2ZW50LnR5cGVdO1xuICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIGlmIChldmVudC5zdG9wUHJvcGFnYXRpb24gIT09IHN0b3BQcm9wYWdhdGlvbikge1xuICAgICAgICAgIGV2ZW50LnN0YW5kYXJkU3RvcFByb3BhZ2F0aW9uID0gZXZlbnQuc3RvcFByb3BhZ2F0aW9uO1xuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbiA9IHN0b3BQcm9wYWdhdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBvcmRlcmVkQ2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgICAgfVxuICAgIH1cbiAgICB0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZTtcbiAgfVxuICBmb3IgKGxldCBpID0gb3JkZXJlZENhbGxiYWNrcy5sZW5ndGggLSAxOyBpID49IDAgJiYgIWV2ZW50LnByb3BhZ2F0aW9uU3RvcHBlZDsgaS0tKSB7XG4gICAgbGV0IG9yZGVyZWRDYWxsYmFjayA9IG9yZGVyZWRDYWxsYmFja3NbaV07XG4gICAgaWYgKCdoYW5kbGVFdmVudCcgaW4gb3JkZXJlZENhbGxiYWNrKSB7XG4gICAgICBvcmRlcmVkQ2FsbGJhY2suaGFuZGxlRXZlbnQoZXZlbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBvcmRlcmVkQ2FsbGJhY2soZXZlbnQpO1xuICAgIH1cbiAgfVxufVxuXG5sZXQgQ2FwdHVyZWRIYW5kbGVyRW50cnkgPSBjbGFzcyBDYXB0dXJlZEhhbmRsZXJFbnRyeSB7XG4gIGNvbnN0cnVjdG9yKGV2ZW50TmFtZSkge1xuICAgIHRoaXMuZXZlbnROYW1lID0gZXZlbnROYW1lO1xuICAgIHRoaXMuY291bnQgPSAwO1xuICB9XG5cbiAgaW5jcmVtZW50KCkge1xuICAgIHRoaXMuY291bnQrKztcblxuICAgIGlmICh0aGlzLmNvdW50ID09PSAxKSB7XG4gICAgICBET00uYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmV2ZW50TmFtZSwgaGFuZGxlQ2FwdHVyZWRFdmVudCwgdHJ1ZSk7XG4gICAgfVxuICB9XG5cbiAgZGVjcmVtZW50KCkge1xuICAgIGlmICh0aGlzLmNvdW50ID09PSAwKSB7XG4gICAgICBlbUxvZ2dlci53YXJuKCdUaGUgc2FtZSBFdmVudExpc3RlbmVyIHdhcyBkaXNwb3NlZCBtdWx0aXBsZSB0aW1lcy4nKTtcbiAgICB9IGVsc2UgaWYgKC0tdGhpcy5jb3VudCA9PT0gMCkge1xuICAgICAgRE9NLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIGhhbmRsZUNhcHR1cmVkRXZlbnQsIHRydWUpO1xuICAgIH1cbiAgfVxufTtcblxuXG5mdW5jdGlvbiBoYW5kbGVEZWxlZ2F0ZWRFdmVudChldmVudCkge1xuICBldmVudC5wcm9wYWdhdGlvblN0b3BwZWQgPSBmYWxzZTtcbiAgbGV0IHRhcmdldCA9IGZpbmRPcmlnaW5hbEV2ZW50VGFyZ2V0KGV2ZW50KTtcblxuICB3aGlsZSAodGFyZ2V0ICYmICFldmVudC5wcm9wYWdhdGlvblN0b3BwZWQpIHtcbiAgICBpZiAodGFyZ2V0LmRlbGVnYXRlZENhbGxiYWNrcykge1xuICAgICAgbGV0IGNhbGxiYWNrID0gdGFyZ2V0LmRlbGVnYXRlZENhbGxiYWNrc1tldmVudC50eXBlXTtcbiAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICBpZiAoZXZlbnQuc3RvcFByb3BhZ2F0aW9uICE9PSBzdG9wUHJvcGFnYXRpb24pIHtcbiAgICAgICAgICBldmVudC5zdGFuZGFyZFN0b3BQcm9wYWdhdGlvbiA9IGV2ZW50LnN0b3BQcm9wYWdhdGlvbjtcbiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24gPSBzdG9wUHJvcGFnYXRpb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCdoYW5kbGVFdmVudCcgaW4gY2FsbGJhY2spIHtcbiAgICAgICAgICBjYWxsYmFjay5oYW5kbGVFdmVudChldmVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2FsbGJhY2soZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7XG4gIH1cbn1cblxubGV0IERlbGVnYXRlSGFuZGxlckVudHJ5ID0gY2xhc3MgRGVsZWdhdGVIYW5kbGVyRW50cnkge1xuICBjb25zdHJ1Y3RvcihldmVudE5hbWUpIHtcbiAgICB0aGlzLmV2ZW50TmFtZSA9IGV2ZW50TmFtZTtcbiAgICB0aGlzLmNvdW50ID0gMDtcbiAgfVxuXG4gIGluY3JlbWVudCgpIHtcbiAgICB0aGlzLmNvdW50Kys7XG5cbiAgICBpZiAodGhpcy5jb3VudCA9PT0gMSkge1xuICAgICAgRE9NLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIGhhbmRsZURlbGVnYXRlZEV2ZW50LCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgZGVjcmVtZW50KCkge1xuICAgIGlmICh0aGlzLmNvdW50ID09PSAwKSB7XG4gICAgICBlbUxvZ2dlci53YXJuKCdUaGUgc2FtZSBFdmVudExpc3RlbmVyIHdhcyBkaXNwb3NlZCBtdWx0aXBsZSB0aW1lcy4nKTtcbiAgICB9IGVsc2UgaWYgKC0tdGhpcy5jb3VudCA9PT0gMCkge1xuICAgICAgRE9NLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIGhhbmRsZURlbGVnYXRlZEV2ZW50LCBmYWxzZSk7XG4gICAgfVxuICB9XG59O1xubGV0IERlbGVnYXRpb25FbnRyeUhhbmRsZXIgPSBjbGFzcyBEZWxlZ2F0aW9uRW50cnlIYW5kbGVyIHtcbiAgY29uc3RydWN0b3IoZW50cnksIGxvb2t1cCwgdGFyZ2V0RXZlbnQpIHtcbiAgICB0aGlzLmVudHJ5ID0gZW50cnk7XG4gICAgdGhpcy5sb29rdXAgPSBsb29rdXA7XG4gICAgdGhpcy50YXJnZXRFdmVudCA9IHRhcmdldEV2ZW50O1xuICB9XG5cbiAgZGlzcG9zZSgpIHtcbiAgICBpZiAodGhpcy5sb29rdXBbdGhpcy50YXJnZXRFdmVudF0pIHtcbiAgICAgIHRoaXMuZW50cnkuZGVjcmVtZW50KCk7XG4gICAgICB0aGlzLmxvb2t1cFt0aGlzLnRhcmdldEV2ZW50XSA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVtTG9nZ2VyLndhcm4oJ0NhbGxpbmcgLmRpc3Bvc2UoKSBvbiBhbHJlYWR5IGRpc3Bvc2VkIGV2ZW50TGlzdGVuZXInKTtcbiAgICB9XG4gIH1cbn07XG5sZXQgRXZlbnRIYW5kbGVyID0gY2xhc3MgRXZlbnRIYW5kbGVyIHtcbiAgY29uc3RydWN0b3IodGFyZ2V0LCB0YXJnZXRFdmVudCwgY2FsbGJhY2spIHtcbiAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICB0aGlzLnRhcmdldEV2ZW50ID0gdGFyZ2V0RXZlbnQ7XG4gICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xuICB9XG5cbiAgZGlzcG9zZSgpIHtcbiAgICB0aGlzLnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMudGFyZ2V0RXZlbnQsIHRoaXMuY2FsbGJhY2spO1xuICB9XG59O1xubGV0IERlZmF1bHRFdmVudFN0cmF0ZWd5ID0gY2xhc3MgRGVmYXVsdEV2ZW50U3RyYXRlZ3kge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmRlbGVnYXRlZEhhbmRsZXJzID0ge307XG4gICAgdGhpcy5jYXB0dXJlZEhhbmRsZXJzID0ge307XG4gIH1cblxuICBzdWJzY3JpYmUodGFyZ2V0LCB0YXJnZXRFdmVudCwgY2FsbGJhY2ssIHN0cmF0ZWd5LCBkaXNwb3NhYmxlKSB7XG4gICAgbGV0IGRlbGVnYXRlZEhhbmRsZXJzO1xuICAgIGxldCBjYXB0dXJlZEhhbmRsZXJzO1xuICAgIGxldCBoYW5kbGVyRW50cnk7XG5cbiAgICBpZiAoc3RyYXRlZ3kgPT09IGRlbGVnYXRpb25TdHJhdGVneS5idWJibGluZykge1xuICAgICAgZGVsZWdhdGVkSGFuZGxlcnMgPSB0aGlzLmRlbGVnYXRlZEhhbmRsZXJzO1xuICAgICAgaGFuZGxlckVudHJ5ID0gZGVsZWdhdGVkSGFuZGxlcnNbdGFyZ2V0RXZlbnRdIHx8IChkZWxlZ2F0ZWRIYW5kbGVyc1t0YXJnZXRFdmVudF0gPSBuZXcgRGVsZWdhdGVIYW5kbGVyRW50cnkodGFyZ2V0RXZlbnQpKTtcbiAgICAgIGxldCBkZWxlZ2F0ZWRDYWxsYmFja3MgPSB0YXJnZXQuZGVsZWdhdGVkQ2FsbGJhY2tzIHx8ICh0YXJnZXQuZGVsZWdhdGVkQ2FsbGJhY2tzID0ge30pO1xuICAgICAgaWYgKCFkZWxlZ2F0ZWRDYWxsYmFja3NbdGFyZ2V0RXZlbnRdKSB7XG4gICAgICAgIGhhbmRsZXJFbnRyeS5pbmNyZW1lbnQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVtTG9nZ2VyLndhcm4oJ092ZXJyaWRpbmcgcHJldmlvdXMgY2FsbGJhY2sgZm9yIGV2ZW50IGxpc3RlbmVyJywgeyBldmVudDogdGFyZ2V0RXZlbnQsIGNhbGxiYWNrOiBjYWxsYmFjaywgcHJldmlvdXNDYWxsYmFjazogZGVsZWdhdGVkQ2FsbGJhY2tzW3RhcmdldEV2ZW50XSB9KTtcbiAgICAgIH1cbiAgICAgIGRlbGVnYXRlZENhbGxiYWNrc1t0YXJnZXRFdmVudF0gPSBjYWxsYmFjaztcblxuICAgICAgaWYgKGRpc3Bvc2FibGUgPT09IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEZWxlZ2F0aW9uRW50cnlIYW5kbGVyKGhhbmRsZXJFbnRyeSwgZGVsZWdhdGVkQ2FsbGJhY2tzLCB0YXJnZXRFdmVudCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGhhbmRsZXJFbnRyeS5kZWNyZW1lbnQoKTtcbiAgICAgICAgZGVsZWdhdGVkQ2FsbGJhY2tzW3RhcmdldEV2ZW50XSA9IG51bGw7XG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAoc3RyYXRlZ3kgPT09IGRlbGVnYXRpb25TdHJhdGVneS5jYXB0dXJpbmcpIHtcbiAgICAgIGNhcHR1cmVkSGFuZGxlcnMgPSB0aGlzLmNhcHR1cmVkSGFuZGxlcnM7XG4gICAgICBoYW5kbGVyRW50cnkgPSBjYXB0dXJlZEhhbmRsZXJzW3RhcmdldEV2ZW50XSB8fCAoY2FwdHVyZWRIYW5kbGVyc1t0YXJnZXRFdmVudF0gPSBuZXcgQ2FwdHVyZWRIYW5kbGVyRW50cnkodGFyZ2V0RXZlbnQpKTtcbiAgICAgIGxldCBjYXB0dXJlZENhbGxiYWNrcyA9IHRhcmdldC5jYXB0dXJlZENhbGxiYWNrcyB8fCAodGFyZ2V0LmNhcHR1cmVkQ2FsbGJhY2tzID0ge30pO1xuICAgICAgaWYgKCFjYXB0dXJlZENhbGxiYWNrc1t0YXJnZXRFdmVudF0pIHtcbiAgICAgICAgaGFuZGxlckVudHJ5LmluY3JlbWVudCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZW1Mb2dnZXIuZXJyb3IoJ2FscmVhZHkgaGF2ZSBhIGNhbGxiYWNrIGZvciBldmVudCcsIHsgZXZlbnQ6IHRhcmdldEV2ZW50LCBjYWxsYmFjazogY2FsbGJhY2sgfSk7XG4gICAgICB9XG4gICAgICBjYXB0dXJlZENhbGxiYWNrc1t0YXJnZXRFdmVudF0gPSBjYWxsYmFjaztcblxuICAgICAgaWYgKGRpc3Bvc2FibGUgPT09IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEZWxlZ2F0aW9uRW50cnlIYW5kbGVyKGhhbmRsZXJFbnRyeSwgY2FwdHVyZWRDYWxsYmFja3MsIHRhcmdldEV2ZW50KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaGFuZGxlckVudHJ5LmRlY3JlbWVudCgpO1xuICAgICAgICBjYXB0dXJlZENhbGxiYWNrc1t0YXJnZXRFdmVudF0gPSBudWxsO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcih0YXJnZXRFdmVudCwgY2FsbGJhY2spO1xuXG4gICAgaWYgKGRpc3Bvc2FibGUgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBuZXcgRXZlbnRIYW5kbGVyKHRhcmdldCwgdGFyZ2V0RXZlbnQsIGNhbGxiYWNrKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIodGFyZ2V0RXZlbnQsIGNhbGxiYWNrKTtcbiAgICB9O1xuICB9XG59O1xuXG5cbmV4cG9ydCBjb25zdCBkZWxlZ2F0aW9uU3RyYXRlZ3kgPSB7XG4gIG5vbmU6IDAsXG4gIGNhcHR1cmluZzogMSxcbiAgYnViYmxpbmc6IDJcbn07XG5cbmV4cG9ydCBsZXQgRXZlbnRNYW5hZ2VyID0gY2xhc3MgRXZlbnRNYW5hZ2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5lbGVtZW50SGFuZGxlckxvb2t1cCA9IHt9O1xuICAgIHRoaXMuZXZlbnRTdHJhdGVneUxvb2t1cCA9IHt9O1xuXG4gICAgdGhpcy5yZWdpc3RlckVsZW1lbnRDb25maWcoe1xuICAgICAgdGFnTmFtZTogJ2lucHV0JyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgdmFsdWU6IFsnY2hhbmdlJywgJ2lucHV0J10sXG4gICAgICAgIGNoZWNrZWQ6IFsnY2hhbmdlJywgJ2lucHV0J10sXG4gICAgICAgIGZpbGVzOiBbJ2NoYW5nZScsICdpbnB1dCddXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLnJlZ2lzdGVyRWxlbWVudENvbmZpZyh7XG4gICAgICB0YWdOYW1lOiAndGV4dGFyZWEnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB2YWx1ZTogWydjaGFuZ2UnLCAnaW5wdXQnXVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5yZWdpc3RlckVsZW1lbnRDb25maWcoe1xuICAgICAgdGFnTmFtZTogJ3NlbGVjdCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHZhbHVlOiBbJ2NoYW5nZSddXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLnJlZ2lzdGVyRWxlbWVudENvbmZpZyh7XG4gICAgICB0YWdOYW1lOiAnY29udGVudCBlZGl0YWJsZScsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHZhbHVlOiBbJ2NoYW5nZScsICdpbnB1dCcsICdibHVyJywgJ2tleXVwJywgJ3Bhc3RlJ11cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMucmVnaXN0ZXJFbGVtZW50Q29uZmlnKHtcbiAgICAgIHRhZ05hbWU6ICdzY3JvbGxhYmxlIGVsZW1lbnQnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBzY3JvbGxUb3A6IFsnc2Nyb2xsJ10sXG4gICAgICAgIHNjcm9sbExlZnQ6IFsnc2Nyb2xsJ11cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuZGVmYXVsdEV2ZW50U3RyYXRlZ3kgPSBuZXcgRGVmYXVsdEV2ZW50U3RyYXRlZ3koKTtcbiAgfVxuXG4gIHJlZ2lzdGVyRWxlbWVudENvbmZpZyhjb25maWcpIHtcbiAgICBsZXQgdGFnTmFtZSA9IGNvbmZpZy50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IHByb3BlcnRpZXMgPSBjb25maWcucHJvcGVydGllcztcbiAgICBsZXQgcHJvcGVydHlOYW1lO1xuXG4gICAgbGV0IGxvb2t1cCA9IHRoaXMuZWxlbWVudEhhbmRsZXJMb29rdXBbdGFnTmFtZV0gPSB7fTtcblxuICAgIGZvciAocHJvcGVydHlOYW1lIGluIHByb3BlcnRpZXMpIHtcbiAgICAgIGlmIChwcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KHByb3BlcnR5TmFtZSkpIHtcbiAgICAgICAgbG9va3VwW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0aWVzW3Byb3BlcnR5TmFtZV07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJFdmVudFN0cmF0ZWd5KGV2ZW50TmFtZSwgc3RyYXRlZ3kpIHtcbiAgICB0aGlzLmV2ZW50U3RyYXRlZ3lMb29rdXBbZXZlbnROYW1lXSA9IHN0cmF0ZWd5O1xuICB9XG5cbiAgZ2V0RWxlbWVudEhhbmRsZXIodGFyZ2V0LCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBsZXQgdGFnTmFtZTtcbiAgICBsZXQgbG9va3VwID0gdGhpcy5lbGVtZW50SGFuZGxlckxvb2t1cDtcblxuICAgIGlmICh0YXJnZXQudGFnTmFtZSkge1xuICAgICAgdGFnTmFtZSA9IHRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgIGlmIChsb29rdXBbdGFnTmFtZV0gJiYgbG9va3VwW3RhZ05hbWVdW3Byb3BlcnR5TmFtZV0pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBFdmVudFN1YnNjcmliZXIobG9va3VwW3RhZ05hbWVdW3Byb3BlcnR5TmFtZV0pO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAndGV4dENvbnRlbnQnIHx8IHByb3BlcnR5TmFtZSA9PT0gJ2lubmVySFRNTCcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBFdmVudFN1YnNjcmliZXIobG9va3VwWydjb250ZW50IGVkaXRhYmxlJ10udmFsdWUpO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAnc2Nyb2xsVG9wJyB8fCBwcm9wZXJ0eU5hbWUgPT09ICdzY3JvbGxMZWZ0Jykge1xuICAgICAgICByZXR1cm4gbmV3IEV2ZW50U3Vic2NyaWJlcihsb29rdXBbJ3Njcm9sbGFibGUgZWxlbWVudCddW3Byb3BlcnR5TmFtZV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgYWRkRXZlbnRMaXN0ZW5lcih0YXJnZXQsIHRhcmdldEV2ZW50LCBjYWxsYmFja09yTGlzdGVuZXIsIGRlbGVnYXRlLCBkaXNwb3NhYmxlKSB7XG4gICAgcmV0dXJuICh0aGlzLmV2ZW50U3RyYXRlZ3lMb29rdXBbdGFyZ2V0RXZlbnRdIHx8IHRoaXMuZGVmYXVsdEV2ZW50U3RyYXRlZ3kpLnN1YnNjcmliZSh0YXJnZXQsIHRhcmdldEV2ZW50LCBjYWxsYmFja09yTGlzdGVuZXIsIGRlbGVnYXRlLCBkaXNwb3NhYmxlKTtcbiAgfVxufTtcblxuZXhwb3J0IGxldCBFdmVudFN1YnNjcmliZXIgPSBjbGFzcyBFdmVudFN1YnNjcmliZXIge1xuICBjb25zdHJ1Y3RvcihldmVudHMpIHtcbiAgICB0aGlzLmV2ZW50cyA9IGV2ZW50cztcbiAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xuICAgIHRoaXMuaGFuZGxlciA9IG51bGw7XG4gIH1cblxuICBzdWJzY3JpYmUoZWxlbWVudCwgY2FsbGJhY2tPckxpc3RlbmVyKSB7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmhhbmRsZXIgPSBjYWxsYmFja09yTGlzdGVuZXI7XG5cbiAgICBsZXQgZXZlbnRzID0gdGhpcy5ldmVudHM7XG4gICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZXZlbnRzLmxlbmd0aDsgaWkgPiBpOyArK2kpIHtcbiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudHNbaV0sIGNhbGxiYWNrT3JMaXN0ZW5lcik7XG4gICAgfVxuICB9XG5cbiAgZGlzcG9zZSgpIHtcbiAgICBpZiAodGhpcy5lbGVtZW50ID09PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGxldCBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuICAgIGxldCBjYWxsYmFja09yTGlzdGVuZXIgPSB0aGlzLmhhbmRsZXI7XG4gICAgbGV0IGV2ZW50cyA9IHRoaXMuZXZlbnRzO1xuICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGV2ZW50cy5sZW5ndGg7IGlpID4gaTsgKytpKSB7XG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRzW2ldLCBjYWxsYmFja09yTGlzdGVuZXIpO1xuICAgIH1cbiAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLmhhbmRsZXIgPSBudWxsO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IERpcnR5Q2hlY2tlciA9IGNsYXNzIERpcnR5Q2hlY2tlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMudHJhY2tlZCA9IFtdO1xuICAgIHRoaXMuY2hlY2tEZWxheSA9IDEyMDtcbiAgfVxuXG4gIGFkZFByb3BlcnR5KHByb3BlcnR5KSB7XG4gICAgbGV0IHRyYWNrZWQgPSB0aGlzLnRyYWNrZWQ7XG5cbiAgICB0cmFja2VkLnB1c2gocHJvcGVydHkpO1xuXG4gICAgaWYgKHRyYWNrZWQubGVuZ3RoID09PSAxKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlRGlydHlDaGVjaygpO1xuICAgIH1cbiAgfVxuXG4gIHJlbW92ZVByb3BlcnR5KHByb3BlcnR5KSB7XG4gICAgbGV0IHRyYWNrZWQgPSB0aGlzLnRyYWNrZWQ7XG4gICAgdHJhY2tlZC5zcGxpY2UodHJhY2tlZC5pbmRleE9mKHByb3BlcnR5KSwgMSk7XG4gIH1cblxuICBzY2hlZHVsZURpcnR5Q2hlY2soKSB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmNoZWNrKCksIHRoaXMuY2hlY2tEZWxheSk7XG4gIH1cblxuICBjaGVjaygpIHtcbiAgICBsZXQgdHJhY2tlZCA9IHRoaXMudHJhY2tlZDtcbiAgICBsZXQgaSA9IHRyYWNrZWQubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgbGV0IGN1cnJlbnQgPSB0cmFja2VkW2ldO1xuXG4gICAgICBpZiAoY3VycmVudC5pc0RpcnR5KCkpIHtcbiAgICAgICAgY3VycmVudC5jYWxsKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRyYWNrZWQubGVuZ3RoKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlRGlydHlDaGVjaygpO1xuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGxldCBEaXJ0eUNoZWNrUHJvcGVydHkgPSAoX2RlYzUgPSBzdWJzY3JpYmVyQ29sbGVjdGlvbigpLCBfZGVjNShfY2xhc3M1ID0gY2xhc3MgRGlydHlDaGVja1Byb3BlcnR5IHtcbiAgY29uc3RydWN0b3IoZGlydHlDaGVja2VyLCBvYmosIHByb3BlcnR5TmFtZSkge1xuICAgIHRoaXMuZGlydHlDaGVja2VyID0gZGlydHlDaGVja2VyO1xuICAgIHRoaXMub2JqID0gb2JqO1xuICAgIHRoaXMucHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lO1xuICB9XG5cbiAgZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMub2JqW3RoaXMucHJvcGVydHlOYW1lXTtcbiAgfVxuXG4gIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgdGhpcy5vYmpbdGhpcy5wcm9wZXJ0eU5hbWVdID0gbmV3VmFsdWU7XG4gIH1cblxuICBjYWxsKCkge1xuICAgIGxldCBvbGRWYWx1ZSA9IHRoaXMub2xkVmFsdWU7XG4gICAgbGV0IG5ld1ZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpO1xuXG4gICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKTtcblxuICAgIHRoaXMub2xkVmFsdWUgPSBuZXdWYWx1ZTtcbiAgfVxuXG4gIGlzRGlydHkoKSB7XG4gICAgcmV0dXJuIHRoaXMub2xkVmFsdWUgIT09IHRoaXMub2JqW3RoaXMucHJvcGVydHlOYW1lXTtcbiAgfVxuXG4gIHN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSkge1xuICAgIGlmICghdGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICB0aGlzLm9sZFZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpO1xuICAgICAgdGhpcy5kaXJ0eUNoZWNrZXIuYWRkUHJvcGVydHkodGhpcyk7XG4gICAgfVxuICAgIHRoaXMuYWRkU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSk7XG4gIH1cblxuICB1bnN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSkge1xuICAgIGlmICh0aGlzLnJlbW92ZVN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpICYmICF0aGlzLmhhc1N1YnNjcmliZXJzKCkpIHtcbiAgICAgIHRoaXMuZGlydHlDaGVja2VyLnJlbW92ZVByb3BlcnR5KHRoaXMpO1xuICAgIH1cbiAgfVxufSkgfHwgX2NsYXNzNSk7XG5cbmNvbnN0IGxvZ2dlciA9IExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCdwcm9wZXJ0eS1vYnNlcnZhdGlvbicpO1xuXG5leHBvcnQgY29uc3QgcHJvcGVydHlBY2Nlc3NvciA9IHtcbiAgZ2V0VmFsdWU6IChvYmosIHByb3BlcnR5TmFtZSkgPT4gb2JqW3Byb3BlcnR5TmFtZV0sXG4gIHNldFZhbHVlOiAodmFsdWUsIG9iaiwgcHJvcGVydHlOYW1lKSA9PiB7XG4gICAgb2JqW3Byb3BlcnR5TmFtZV0gPSB2YWx1ZTtcbiAgfVxufTtcblxuZXhwb3J0IGxldCBQcmltaXRpdmVPYnNlcnZlciA9IGNsYXNzIFByaW1pdGl2ZU9ic2VydmVyIHtcblxuICBjb25zdHJ1Y3RvcihwcmltaXRpdmUsIHByb3BlcnR5TmFtZSkge1xuICAgIHRoaXMuZG9Ob3RDYWNoZSA9IHRydWU7XG5cbiAgICB0aGlzLnByaW1pdGl2ZSA9IHByaW1pdGl2ZTtcbiAgICB0aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgfVxuXG4gIGdldFZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLnByaW1pdGl2ZVt0aGlzLnByb3BlcnR5TmFtZV07XG4gIH1cblxuICBzZXRWYWx1ZSgpIHtcbiAgICBsZXQgdHlwZSA9IHR5cGVvZiB0aGlzLnByaW1pdGl2ZTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSAke3RoaXMucHJvcGVydHlOYW1lfSBwcm9wZXJ0eSBvZiBhICR7dHlwZX0gKCR7dGhpcy5wcmltaXRpdmV9KSBjYW5ub3QgYmUgYXNzaWduZWQuYCk7XG4gIH1cblxuICBzdWJzY3JpYmUoKSB7fVxuXG4gIHVuc3Vic2NyaWJlKCkge31cbn07XG5cbmV4cG9ydCBsZXQgU2V0dGVyT2JzZXJ2ZXIgPSAoX2RlYzYgPSBzdWJzY3JpYmVyQ29sbGVjdGlvbigpLCBfZGVjNihfY2xhc3M3ID0gY2xhc3MgU2V0dGVyT2JzZXJ2ZXIge1xuICBjb25zdHJ1Y3Rvcih0YXNrUXVldWUsIG9iaiwgcHJvcGVydHlOYW1lKSB7XG4gICAgdGhpcy50YXNrUXVldWUgPSB0YXNrUXVldWU7XG4gICAgdGhpcy5vYmogPSBvYmo7XG4gICAgdGhpcy5wcm9wZXJ0eU5hbWUgPSBwcm9wZXJ0eU5hbWU7XG4gICAgdGhpcy5xdWV1ZWQgPSBmYWxzZTtcbiAgICB0aGlzLm9ic2VydmluZyA9IGZhbHNlO1xuICB9XG5cbiAgZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMub2JqW3RoaXMucHJvcGVydHlOYW1lXTtcbiAgfVxuXG4gIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgdGhpcy5vYmpbdGhpcy5wcm9wZXJ0eU5hbWVdID0gbmV3VmFsdWU7XG4gIH1cblxuICBnZXR0ZXJWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFsdWU7XG4gIH1cblxuICBzZXR0ZXJWYWx1ZShuZXdWYWx1ZSkge1xuICAgIGxldCBvbGRWYWx1ZSA9IHRoaXMuY3VycmVudFZhbHVlO1xuXG4gICAgaWYgKG9sZFZhbHVlICE9PSBuZXdWYWx1ZSkge1xuICAgICAgaWYgKCF0aGlzLnF1ZXVlZCkge1xuICAgICAgICB0aGlzLm9sZFZhbHVlID0gb2xkVmFsdWU7XG4gICAgICAgIHRoaXMucXVldWVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2sodGhpcyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY3VycmVudFZhbHVlID0gbmV3VmFsdWU7XG4gICAgfVxuICB9XG5cbiAgY2FsbCgpIHtcbiAgICBsZXQgb2xkVmFsdWUgPSB0aGlzLm9sZFZhbHVlO1xuICAgIGxldCBuZXdWYWx1ZSA9IHRoaXMuY3VycmVudFZhbHVlO1xuXG4gICAgdGhpcy5xdWV1ZWQgPSBmYWxzZTtcblxuICAgIHRoaXMuY2FsbFN1YnNjcmliZXJzKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gIH1cblxuICBzdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICBpZiAoIXRoaXMub2JzZXJ2aW5nKSB7XG4gICAgICB0aGlzLmNvbnZlcnRQcm9wZXJ0eSgpO1xuICAgIH1cbiAgICB0aGlzLmFkZFN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9XG5cbiAgdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICB0aGlzLnJlbW92ZVN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9XG5cbiAgY29udmVydFByb3BlcnR5KCkge1xuICAgIHRoaXMub2JzZXJ2aW5nID0gdHJ1ZTtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHRoaXMub2JqW3RoaXMucHJvcGVydHlOYW1lXTtcbiAgICB0aGlzLnNldFZhbHVlID0gdGhpcy5zZXR0ZXJWYWx1ZTtcbiAgICB0aGlzLmdldFZhbHVlID0gdGhpcy5nZXR0ZXJWYWx1ZTtcblxuICAgIGlmICghUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLm9iaiwgdGhpcy5wcm9wZXJ0eU5hbWUsIHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRoaXMucHJvcGVydHlOYW1lIGluIHRoaXMub2JqID8gdGhpcy5vYmoucHJvcGVydHlJc0VudW1lcmFibGUodGhpcy5wcm9wZXJ0eU5hbWUpIDogdHJ1ZSxcbiAgICAgIGdldDogdGhpcy5nZXRWYWx1ZS5iaW5kKHRoaXMpLFxuICAgICAgc2V0OiB0aGlzLnNldFZhbHVlLmJpbmQodGhpcylcbiAgICB9KSkge1xuICAgICAgbG9nZ2VyLndhcm4oYENhbm5vdCBvYnNlcnZlIHByb3BlcnR5ICcke3RoaXMucHJvcGVydHlOYW1lfScgb2Ygb2JqZWN0YCwgdGhpcy5vYmopO1xuICAgIH1cbiAgfVxufSkgfHwgX2NsYXNzNyk7XG5cbmV4cG9ydCBsZXQgWExpbmtBdHRyaWJ1dGVPYnNlcnZlciA9IGNsYXNzIFhMaW5rQXR0cmlidXRlT2JzZXJ2ZXIge1xuICBjb25zdHJ1Y3RvcihlbGVtZW50LCBwcm9wZXJ0eU5hbWUsIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMucHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lO1xuICAgIHRoaXMuYXR0cmlidXRlTmFtZSA9IGF0dHJpYnV0ZU5hbWU7XG4gIH1cblxuICBnZXRWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZU5TKCdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJywgdGhpcy5hdHRyaWJ1dGVOYW1lKTtcbiAgfVxuXG4gIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsIHRoaXMuYXR0cmlidXRlTmFtZSwgbmV3VmFsdWUpO1xuICB9XG5cbiAgc3Vic2NyaWJlKCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgT2JzZXJ2YXRpb24gb2YgYSBcIiR7dGhpcy5lbGVtZW50Lm5vZGVOYW1lfVwiIGVsZW1lbnRcXCdzIFwiJHt0aGlzLnByb3BlcnR5TmFtZX1cIiBwcm9wZXJ0eSBpcyBub3Qgc3VwcG9ydGVkLmApO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZGF0YUF0dHJpYnV0ZUFjY2Vzc29yID0ge1xuICBnZXRWYWx1ZTogKG9iaiwgcHJvcGVydHlOYW1lKSA9PiBvYmouZ2V0QXR0cmlidXRlKHByb3BlcnR5TmFtZSksXG4gIHNldFZhbHVlOiAodmFsdWUsIG9iaiwgcHJvcGVydHlOYW1lKSA9PiB7XG4gICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIG9iai5yZW1vdmVBdHRyaWJ1dGUocHJvcGVydHlOYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgb2JqLnNldEF0dHJpYnV0ZShwcm9wZXJ0eU5hbWUsIHZhbHVlKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgRGF0YUF0dHJpYnV0ZU9ic2VydmVyID0gY2xhc3MgRGF0YUF0dHJpYnV0ZU9ic2VydmVyIHtcbiAgY29uc3RydWN0b3IoZWxlbWVudCwgcHJvcGVydHlOYW1lKSB7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgfVxuXG4gIGdldFZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKHRoaXMucHJvcGVydHlOYW1lKTtcbiAgfVxuXG4gIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgaWYgKG5ld1ZhbHVlID09PSBudWxsIHx8IG5ld1ZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHRoaXMucHJvcGVydHlOYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUodGhpcy5wcm9wZXJ0eU5hbWUsIG5ld1ZhbHVlKTtcbiAgfVxuXG4gIHN1YnNjcmliZSgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE9ic2VydmF0aW9uIG9mIGEgXCIke3RoaXMuZWxlbWVudC5ub2RlTmFtZX1cIiBlbGVtZW50XFwncyBcIiR7dGhpcy5wcm9wZXJ0eU5hbWV9XCIgcHJvcGVydHkgaXMgbm90IHN1cHBvcnRlZC5gKTtcbiAgfVxufTtcblxuZXhwb3J0IGxldCBTdHlsZU9ic2VydmVyID0gY2xhc3MgU3R5bGVPYnNlcnZlciB7XG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQsIHByb3BlcnR5TmFtZSkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5wcm9wZXJ0eU5hbWUgPSBwcm9wZXJ0eU5hbWU7XG5cbiAgICB0aGlzLnN0eWxlcyA9IG51bGw7XG4gICAgdGhpcy52ZXJzaW9uID0gMDtcbiAgfVxuXG4gIGdldFZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQuc3R5bGUuY3NzVGV4dDtcbiAgfVxuXG4gIF9zZXRQcm9wZXJ0eShzdHlsZSwgdmFsdWUpIHtcbiAgICBsZXQgcHJpb3JpdHkgPSAnJztcblxuICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiB2YWx1ZS5pbmRleE9mID09PSAnZnVuY3Rpb24nICYmIHZhbHVlLmluZGV4T2YoJyFpbXBvcnRhbnQnKSAhPT0gLTEpIHtcbiAgICAgIHByaW9yaXR5ID0gJ2ltcG9ydGFudCc7XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoJyFpbXBvcnRhbnQnLCAnJyk7XG4gICAgfVxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShzdHlsZSwgdmFsdWUsIHByaW9yaXR5KTtcbiAgfVxuXG4gIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgbGV0IHN0eWxlcyA9IHRoaXMuc3R5bGVzIHx8IHt9O1xuICAgIGxldCBzdHlsZTtcbiAgICBsZXQgdmVyc2lvbiA9IHRoaXMudmVyc2lvbjtcblxuICAgIGlmIChuZXdWYWx1ZSAhPT0gbnVsbCAmJiBuZXdWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAobmV3VmFsdWUgaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICBmb3IgKHN0eWxlIGluIG5ld1ZhbHVlKSB7XG4gICAgICAgICAgaWYgKG5ld1ZhbHVlLmhhc093blByb3BlcnR5KHN0eWxlKSkge1xuICAgICAgICAgICAgdmFsdWUgPSBuZXdWYWx1ZVtzdHlsZV07XG4gICAgICAgICAgICBzdHlsZSA9IHN0eWxlLnJlcGxhY2UoLyhbQS1aXSkvZywgbSA9PiAnLScgKyBtLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgc3R5bGVzW3N0eWxlXSA9IHZlcnNpb247XG4gICAgICAgICAgICB0aGlzLl9zZXRQcm9wZXJ0eShzdHlsZSwgdmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChuZXdWYWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgbGV0IHJ4ID0gL1xccyooW1xcd1xcLV0rKVxccyo6XFxzKigoPzooPzpbXFx3XFwtXStcXChcXHMqKD86XCIoPzpcXFxcXCJ8W15cIl0pKlwifCcoPzpcXFxcJ3xbXiddKSonfFtcXHdcXC1dK1xcKFxccyooPzpeXCIoPzpcXFxcXCJ8W15cIl0pKlwifCcoPzpcXFxcJ3xbXiddKSonfFteXFwpXSopXFwpLD98W15cXCldKilcXCksP3xcIig/OlxcXFxcInxbXlwiXSkqXCJ8Jyg/OlxcXFwnfFteJ10pKid8W147XSopLD9cXHMqKSspOz8vZztcbiAgICAgICAgbGV0IHBhaXI7XG4gICAgICAgIHdoaWxlICgocGFpciA9IHJ4LmV4ZWMobmV3VmFsdWUpKSAhPT0gbnVsbCkge1xuICAgICAgICAgIHN0eWxlID0gcGFpclsxXTtcbiAgICAgICAgICBpZiAoIXN0eWxlKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzdHlsZXNbc3R5bGVdID0gdmVyc2lvbjtcbiAgICAgICAgICB0aGlzLl9zZXRQcm9wZXJ0eShzdHlsZSwgcGFpclsyXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnN0eWxlcyA9IHN0eWxlcztcbiAgICB0aGlzLnZlcnNpb24gKz0gMTtcblxuICAgIGlmICh2ZXJzaW9uID09PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmVyc2lvbiAtPSAxO1xuICAgIGZvciAoc3R5bGUgaW4gc3R5bGVzKSB7XG4gICAgICBpZiAoIXN0eWxlcy5oYXNPd25Qcm9wZXJ0eShzdHlsZSkgfHwgc3R5bGVzW3N0eWxlXSAhPT0gdmVyc2lvbikge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnJlbW92ZVByb3BlcnR5KHN0eWxlKTtcbiAgICB9XG4gIH1cblxuICBzdWJzY3JpYmUoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBPYnNlcnZhdGlvbiBvZiBhIFwiJHt0aGlzLmVsZW1lbnQubm9kZU5hbWV9XCIgZWxlbWVudFxcJ3MgXCIke3RoaXMucHJvcGVydHlOYW1lfVwiIHByb3BlcnR5IGlzIG5vdCBzdXBwb3J0ZWQuYCk7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgVmFsdWVBdHRyaWJ1dGVPYnNlcnZlciA9IChfZGVjNyA9IHN1YnNjcmliZXJDb2xsZWN0aW9uKCksIF9kZWM3KF9jbGFzczggPSBjbGFzcyBWYWx1ZUF0dHJpYnV0ZU9ic2VydmVyIHtcbiAgY29uc3RydWN0b3IoZWxlbWVudCwgcHJvcGVydHlOYW1lLCBoYW5kbGVyKSB7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyO1xuICAgIGlmIChwcm9wZXJ0eU5hbWUgPT09ICdmaWxlcycpIHtcbiAgICAgIHRoaXMuc2V0VmFsdWUgPSAoKSA9PiB7fTtcbiAgICB9XG4gIH1cblxuICBnZXRWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50W3RoaXMucHJvcGVydHlOYW1lXTtcbiAgfVxuXG4gIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgbmV3VmFsdWUgPSBuZXdWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IG5ld1ZhbHVlID09PSBudWxsID8gJycgOiBuZXdWYWx1ZTtcbiAgICBpZiAodGhpcy5lbGVtZW50W3RoaXMucHJvcGVydHlOYW1lXSAhPT0gbmV3VmFsdWUpIHtcbiAgICAgIHRoaXMuZWxlbWVudFt0aGlzLnByb3BlcnR5TmFtZV0gPSBuZXdWYWx1ZTtcbiAgICAgIHRoaXMubm90aWZ5KCk7XG4gICAgfVxuICB9XG5cbiAgbm90aWZ5KCkge1xuICAgIGxldCBvbGRWYWx1ZSA9IHRoaXMub2xkVmFsdWU7XG4gICAgbGV0IG5ld1ZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpO1xuXG4gICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKTtcblxuICAgIHRoaXMub2xkVmFsdWUgPSBuZXdWYWx1ZTtcbiAgfVxuXG4gIGhhbmRsZUV2ZW50KCkge1xuICAgIHRoaXMubm90aWZ5KCk7XG4gIH1cblxuICBzdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICBpZiAoIXRoaXMuaGFzU3Vic2NyaWJlcnMoKSkge1xuICAgICAgdGhpcy5vbGRWYWx1ZSA9IHRoaXMuZ2V0VmFsdWUoKTtcbiAgICAgIHRoaXMuaGFuZGxlci5zdWJzY3JpYmUodGhpcy5lbGVtZW50LCB0aGlzKTtcbiAgICB9XG5cbiAgICB0aGlzLmFkZFN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9XG5cbiAgdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICBpZiAodGhpcy5yZW1vdmVTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKSAmJiAhdGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICB0aGlzLmhhbmRsZXIuZGlzcG9zZSgpO1xuICAgIH1cbiAgfVxufSkgfHwgX2NsYXNzOCk7XG5cbmNvbnN0IGNoZWNrZWRBcnJheUNvbnRleHQgPSAnQ2hlY2tlZE9ic2VydmVyOmFycmF5JztcbmNvbnN0IGNoZWNrZWRWYWx1ZUNvbnRleHQgPSAnQ2hlY2tlZE9ic2VydmVyOnZhbHVlJztcblxuZXhwb3J0IGxldCBDaGVja2VkT2JzZXJ2ZXIgPSAoX2RlYzggPSBzdWJzY3JpYmVyQ29sbGVjdGlvbigpLCBfZGVjOChfY2xhc3M5ID0gY2xhc3MgQ2hlY2tlZE9ic2VydmVyIHtcbiAgY29uc3RydWN0b3IoZWxlbWVudCwgaGFuZGxlciwgb2JzZXJ2ZXJMb2NhdG9yKSB7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyO1xuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICB9XG5cbiAgZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cblxuICBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIGlmICh0aGlzLmluaXRpYWxTeW5jICYmIHRoaXMudmFsdWUgPT09IG5ld1ZhbHVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYXJyYXlPYnNlcnZlcikge1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyLnVuc3Vic2NyaWJlKGNoZWNrZWRBcnJheUNvbnRleHQsIHRoaXMpO1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5lbGVtZW50LnR5cGUgPT09ICdjaGVja2JveCcgJiYgQXJyYXkuaXNBcnJheShuZXdWYWx1ZSkpIHtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXJMb2NhdG9yLmdldEFycmF5T2JzZXJ2ZXIobmV3VmFsdWUpO1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyLnN1YnNjcmliZShjaGVja2VkQXJyYXlDb250ZXh0LCB0aGlzKTtcbiAgICB9XG5cbiAgICB0aGlzLm9sZFZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICB0aGlzLnZhbHVlID0gbmV3VmFsdWU7XG4gICAgdGhpcy5zeW5jaHJvbml6ZUVsZW1lbnQoKTtcbiAgICB0aGlzLm5vdGlmeSgpO1xuXG4gICAgaWYgKCF0aGlzLmluaXRpYWxTeW5jKSB7XG4gICAgICB0aGlzLmluaXRpYWxTeW5jID0gdHJ1ZTtcbiAgICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzayh0aGlzKTtcbiAgICB9XG4gIH1cblxuICBjYWxsKGNvbnRleHQsIHNwbGljZXMpIHtcbiAgICB0aGlzLnN5bmNocm9uaXplRWxlbWVudCgpO1xuXG4gICAgaWYgKCF0aGlzLnZhbHVlT2JzZXJ2ZXIpIHtcbiAgICAgIHRoaXMudmFsdWVPYnNlcnZlciA9IHRoaXMuZWxlbWVudC5fX29ic2VydmVyc19fLm1vZGVsIHx8IHRoaXMuZWxlbWVudC5fX29ic2VydmVyc19fLnZhbHVlO1xuICAgICAgaWYgKHRoaXMudmFsdWVPYnNlcnZlcikge1xuICAgICAgICB0aGlzLnZhbHVlT2JzZXJ2ZXIuc3Vic2NyaWJlKGNoZWNrZWRWYWx1ZUNvbnRleHQsIHRoaXMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHN5bmNocm9uaXplRWxlbWVudCgpIHtcbiAgICBsZXQgdmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgIGxldCBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuICAgIGxldCBlbGVtZW50VmFsdWUgPSBlbGVtZW50Lmhhc093blByb3BlcnR5KCdtb2RlbCcpID8gZWxlbWVudC5tb2RlbCA6IGVsZW1lbnQudmFsdWU7XG4gICAgbGV0IGlzUmFkaW8gPSBlbGVtZW50LnR5cGUgPT09ICdyYWRpbyc7XG4gICAgbGV0IG1hdGNoZXIgPSBlbGVtZW50Lm1hdGNoZXIgfHwgKChhLCBiKSA9PiBhID09PSBiKTtcblxuICAgIGVsZW1lbnQuY2hlY2tlZCA9IGlzUmFkaW8gJiYgISFtYXRjaGVyKHZhbHVlLCBlbGVtZW50VmFsdWUpIHx8ICFpc1JhZGlvICYmIHZhbHVlID09PSB0cnVlIHx8ICFpc1JhZGlvICYmIEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmZpbmRJbmRleChpdGVtID0+ICEhbWF0Y2hlcihpdGVtLCBlbGVtZW50VmFsdWUpKSAhPT0gLTE7XG4gIH1cblxuICBzeW5jaHJvbml6ZVZhbHVlKCkge1xuICAgIGxldCB2YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgbGV0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG4gICAgbGV0IGVsZW1lbnRWYWx1ZSA9IGVsZW1lbnQuaGFzT3duUHJvcGVydHkoJ21vZGVsJykgPyBlbGVtZW50Lm1vZGVsIDogZWxlbWVudC52YWx1ZTtcbiAgICBsZXQgaW5kZXg7XG4gICAgbGV0IG1hdGNoZXIgPSBlbGVtZW50Lm1hdGNoZXIgfHwgKChhLCBiKSA9PiBhID09PSBiKTtcblxuICAgIGlmIChlbGVtZW50LnR5cGUgPT09ICdjaGVja2JveCcpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBpbmRleCA9IHZhbHVlLmZpbmRJbmRleChpdGVtID0+ICEhbWF0Y2hlcihpdGVtLCBlbGVtZW50VmFsdWUpKTtcbiAgICAgICAgaWYgKGVsZW1lbnQuY2hlY2tlZCAmJiBpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICB2YWx1ZS5wdXNoKGVsZW1lbnRWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoIWVsZW1lbnQuY2hlY2tlZCAmJiBpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICB2YWx1ZS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YWx1ZSA9IGVsZW1lbnQuY2hlY2tlZDtcbiAgICB9IGVsc2UgaWYgKGVsZW1lbnQuY2hlY2tlZCkge1xuICAgICAgdmFsdWUgPSBlbGVtZW50VmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLm9sZFZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy5ub3RpZnkoKTtcbiAgfVxuXG4gIG5vdGlmeSgpIHtcbiAgICBsZXQgb2xkVmFsdWUgPSB0aGlzLm9sZFZhbHVlO1xuICAgIGxldCBuZXdWYWx1ZSA9IHRoaXMudmFsdWU7XG5cbiAgICBpZiAobmV3VmFsdWUgPT09IG9sZFZhbHVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgfVxuXG4gIGhhbmRsZUV2ZW50KCkge1xuICAgIHRoaXMuc3luY2hyb25pemVWYWx1ZSgpO1xuICB9XG5cbiAgc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgaWYgKCF0aGlzLmhhc1N1YnNjcmliZXJzKCkpIHtcbiAgICAgIHRoaXMuaGFuZGxlci5zdWJzY3JpYmUodGhpcy5lbGVtZW50LCB0aGlzKTtcbiAgICB9XG4gICAgdGhpcy5hZGRTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKTtcbiAgfVxuXG4gIHVuc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgaWYgKHRoaXMucmVtb3ZlU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSkgJiYgIXRoaXMuaGFzU3Vic2NyaWJlcnMoKSkge1xuICAgICAgdGhpcy5oYW5kbGVyLmRpc3Bvc2UoKTtcbiAgICB9XG4gIH1cblxuICB1bmJpbmQoKSB7XG4gICAgaWYgKHRoaXMuYXJyYXlPYnNlcnZlcikge1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyLnVuc3Vic2NyaWJlKGNoZWNrZWRBcnJheUNvbnRleHQsIHRoaXMpO1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKHRoaXMudmFsdWVPYnNlcnZlcikge1xuICAgICAgdGhpcy52YWx1ZU9ic2VydmVyLnVuc3Vic2NyaWJlKGNoZWNrZWRWYWx1ZUNvbnRleHQsIHRoaXMpO1xuICAgIH1cbiAgfVxufSkgfHwgX2NsYXNzOSk7XG5cbmNvbnN0IHNlbGVjdEFycmF5Q29udGV4dCA9ICdTZWxlY3RWYWx1ZU9ic2VydmVyOmFycmF5JztcblxuZXhwb3J0IGxldCBTZWxlY3RWYWx1ZU9ic2VydmVyID0gKF9kZWM5ID0gc3Vic2NyaWJlckNvbGxlY3Rpb24oKSwgX2RlYzkoX2NsYXNzMTAgPSBjbGFzcyBTZWxlY3RWYWx1ZU9ic2VydmVyIHtcbiAgY29uc3RydWN0b3IoZWxlbWVudCwgaGFuZGxlciwgb2JzZXJ2ZXJMb2NhdG9yKSB7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyO1xuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICB9XG5cbiAgZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cblxuICBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIGlmIChuZXdWYWx1ZSAhPT0gbnVsbCAmJiBuZXdWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuZWxlbWVudC5tdWx0aXBsZSAmJiAhQXJyYXkuaXNBcnJheShuZXdWYWx1ZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignT25seSBudWxsIG9yIEFycmF5IGluc3RhbmNlcyBjYW4gYmUgYm91bmQgdG8gYSBtdWx0aS1zZWxlY3QuJyk7XG4gICAgfVxuICAgIGlmICh0aGlzLnZhbHVlID09PSBuZXdWYWx1ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmFycmF5T2JzZXJ2ZXIpIHtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlci51bnN1YnNjcmliZShzZWxlY3RBcnJheUNvbnRleHQsIHRoaXMpO1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShuZXdWYWx1ZSkpIHtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXJMb2NhdG9yLmdldEFycmF5T2JzZXJ2ZXIobmV3VmFsdWUpO1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyLnN1YnNjcmliZShzZWxlY3RBcnJheUNvbnRleHQsIHRoaXMpO1xuICAgIH1cblxuICAgIHRoaXMub2xkVmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgIHRoaXMudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICB0aGlzLnN5bmNocm9uaXplT3B0aW9ucygpO1xuICAgIHRoaXMubm90aWZ5KCk7XG5cbiAgICBpZiAoIXRoaXMuaW5pdGlhbFN5bmMpIHtcbiAgICAgIHRoaXMuaW5pdGlhbFN5bmMgPSB0cnVlO1xuICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIGNhbGwoY29udGV4dCwgc3BsaWNlcykge1xuICAgIHRoaXMuc3luY2hyb25pemVPcHRpb25zKCk7XG4gIH1cblxuICBzeW5jaHJvbml6ZU9wdGlvbnMoKSB7XG4gICAgbGV0IHZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICBsZXQgaXNBcnJheTtcblxuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgaXNBcnJheSA9IHRydWU7XG4gICAgfVxuXG4gICAgbGV0IG9wdGlvbnMgPSB0aGlzLmVsZW1lbnQub3B0aW9ucztcbiAgICBsZXQgaSA9IG9wdGlvbnMubGVuZ3RoO1xuICAgIGxldCBtYXRjaGVyID0gdGhpcy5lbGVtZW50Lm1hdGNoZXIgfHwgKChhLCBiKSA9PiBhID09PSBiKTtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICBsZXQgb3B0aW9uID0gb3B0aW9ucy5pdGVtKGkpO1xuICAgICAgbGV0IG9wdGlvblZhbHVlID0gb3B0aW9uLmhhc093blByb3BlcnR5KCdtb2RlbCcpID8gb3B0aW9uLm1vZGVsIDogb3B0aW9uLnZhbHVlO1xuICAgICAgaWYgKGlzQXJyYXkpIHtcbiAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gdmFsdWUuZmluZEluZGV4KGl0ZW0gPT4gISFtYXRjaGVyKG9wdGlvblZhbHVlLCBpdGVtKSkgIT09IC0xO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIG9wdGlvbi5zZWxlY3RlZCA9ICEhbWF0Y2hlcihvcHRpb25WYWx1ZSwgdmFsdWUpO1xuICAgIH1cbiAgfVxuXG4gIHN5bmNocm9uaXplVmFsdWUoKSB7XG4gICAgbGV0IG9wdGlvbnMgPSB0aGlzLmVsZW1lbnQub3B0aW9ucztcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIGxldCB2YWx1ZSA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDAsIGlpID0gb3B0aW9ucy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICBsZXQgb3B0aW9uID0gb3B0aW9ucy5pdGVtKGkpO1xuICAgICAgaWYgKCFvcHRpb24uc2VsZWN0ZWQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICB2YWx1ZS5wdXNoKG9wdGlvbi5oYXNPd25Qcm9wZXJ0eSgnbW9kZWwnKSA/IG9wdGlvbi5tb2RlbCA6IG9wdGlvbi52YWx1ZSk7XG4gICAgICBjb3VudCsrO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmVsZW1lbnQubXVsdGlwbGUpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMudmFsdWUpKSB7XG4gICAgICAgIGxldCBtYXRjaGVyID0gdGhpcy5lbGVtZW50Lm1hdGNoZXIgfHwgKChhLCBiKSA9PiBhID09PSBiKTtcblxuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIHdoaWxlIChpIDwgdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICBsZXQgYSA9IHRoaXMudmFsdWVbaV07XG4gICAgICAgICAgaWYgKHZhbHVlLmZpbmRJbmRleChiID0+IG1hdGNoZXIoYSwgYikpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpID0gMDtcbiAgICAgICAgd2hpbGUgKGkgPCB2YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICBsZXQgYSA9IHZhbHVlW2ldO1xuICAgICAgICAgIGlmICh0aGlzLnZhbHVlLmZpbmRJbmRleChiID0+IG1hdGNoZXIoYSwgYikpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZS5wdXNoKGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoY291bnQgPT09IDApIHtcbiAgICAgICAgdmFsdWUgPSBudWxsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSB2YWx1ZVswXTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodmFsdWUgIT09IHRoaXMudmFsdWUpIHtcbiAgICAgIHRoaXMub2xkVmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgdGhpcy5ub3RpZnkoKTtcbiAgICB9XG4gIH1cblxuICBub3RpZnkoKSB7XG4gICAgbGV0IG9sZFZhbHVlID0gdGhpcy5vbGRWYWx1ZTtcbiAgICBsZXQgbmV3VmFsdWUgPSB0aGlzLnZhbHVlO1xuXG4gICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgfVxuXG4gIGhhbmRsZUV2ZW50KCkge1xuICAgIHRoaXMuc3luY2hyb25pemVWYWx1ZSgpO1xuICB9XG5cbiAgc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgaWYgKCF0aGlzLmhhc1N1YnNjcmliZXJzKCkpIHtcbiAgICAgIHRoaXMuaGFuZGxlci5zdWJzY3JpYmUodGhpcy5lbGVtZW50LCB0aGlzKTtcbiAgICB9XG4gICAgdGhpcy5hZGRTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKTtcbiAgfVxuXG4gIHVuc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgaWYgKHRoaXMucmVtb3ZlU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSkgJiYgIXRoaXMuaGFzU3Vic2NyaWJlcnMoKSkge1xuICAgICAgdGhpcy5oYW5kbGVyLmRpc3Bvc2UoKTtcbiAgICB9XG4gIH1cblxuICBiaW5kKCkge1xuICAgIHRoaXMuZG9tT2JzZXJ2ZXIgPSBET00uY3JlYXRlTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG4gICAgICB0aGlzLnN5bmNocm9uaXplT3B0aW9ucygpO1xuICAgICAgdGhpcy5zeW5jaHJvbml6ZVZhbHVlKCk7XG4gICAgfSk7XG4gICAgdGhpcy5kb21PYnNlcnZlci5vYnNlcnZlKHRoaXMuZWxlbWVudCwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUsIGNoYXJhY3RlckRhdGE6IHRydWUgfSk7XG4gIH1cblxuICB1bmJpbmQoKSB7XG4gICAgdGhpcy5kb21PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5kb21PYnNlcnZlciA9IG51bGw7XG5cbiAgICBpZiAodGhpcy5hcnJheU9ic2VydmVyKSB7XG4gICAgICB0aGlzLmFycmF5T2JzZXJ2ZXIudW5zdWJzY3JpYmUoc2VsZWN0QXJyYXlDb250ZXh0LCB0aGlzKTtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlciA9IG51bGw7XG4gICAgfVxuICB9XG59KSB8fCBfY2xhc3MxMCk7XG5cbmV4cG9ydCBsZXQgQ2xhc3NPYnNlcnZlciA9IGNsYXNzIENsYXNzT2JzZXJ2ZXIge1xuICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmRvTm90Q2FjaGUgPSB0cnVlO1xuICAgIHRoaXMudmFsdWUgPSAnJztcbiAgICB0aGlzLnZlcnNpb24gPSAwO1xuICB9XG5cbiAgZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cblxuICBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIGxldCBuYW1lSW5kZXggPSB0aGlzLm5hbWVJbmRleCB8fCB7fTtcbiAgICBsZXQgdmVyc2lvbiA9IHRoaXMudmVyc2lvbjtcbiAgICBsZXQgbmFtZXM7XG4gICAgbGV0IG5hbWU7XG5cbiAgICBpZiAobmV3VmFsdWUgIT09IG51bGwgJiYgbmV3VmFsdWUgIT09IHVuZGVmaW5lZCAmJiBuZXdWYWx1ZS5sZW5ndGgpIHtcbiAgICAgIG5hbWVzID0gbmV3VmFsdWUuc3BsaXQoL1xccysvKTtcbiAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBuYW1lcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBuYW1lID0gbmFtZXNbaV07XG4gICAgICAgIGlmIChuYW1lID09PSAnJykge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIG5hbWVJbmRleFtuYW1lXSA9IHZlcnNpb247XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKG5hbWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICB0aGlzLm5hbWVJbmRleCA9IG5hbWVJbmRleDtcbiAgICB0aGlzLnZlcnNpb24gKz0gMTtcblxuICAgIGlmICh2ZXJzaW9uID09PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmVyc2lvbiAtPSAxO1xuICAgIGZvciAobmFtZSBpbiBuYW1lSW5kZXgpIHtcbiAgICAgIGlmICghbmFtZUluZGV4Lmhhc093blByb3BlcnR5KG5hbWUpIHx8IG5hbWVJbmRleFtuYW1lXSAhPT0gdmVyc2lvbikge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKG5hbWUpO1xuICAgIH1cbiAgfVxuXG4gIHN1YnNjcmliZSgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE9ic2VydmF0aW9uIG9mIGEgXCIke3RoaXMuZWxlbWVudC5ub2RlTmFtZX1cIiBlbGVtZW50XFwncyBcImNsYXNzXCIgcHJvcGVydHkgaXMgbm90IHN1cHBvcnRlZC5gKTtcbiAgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0RlY2xhcmVkRGVwZW5kZW5jaWVzKGRlc2NyaXB0b3IpIHtcbiAgcmV0dXJuICEhKGRlc2NyaXB0b3IgJiYgZGVzY3JpcHRvci5nZXQgJiYgZGVzY3JpcHRvci5nZXQuZGVwZW5kZW5jaWVzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlY2xhcmVQcm9wZXJ0eURlcGVuZGVuY2llcyhjdG9yLCBwcm9wZXJ0eU5hbWUsIGRlcGVuZGVuY2llcykge1xuICBsZXQgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoY3Rvci5wcm90b3R5cGUsIHByb3BlcnR5TmFtZSk7XG4gIGRlc2NyaXB0b3IuZ2V0LmRlcGVuZGVuY2llcyA9IGRlcGVuZGVuY2llcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVkRnJvbSguLi5yZXN0KSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IpIHtcbiAgICBkZXNjcmlwdG9yLmdldC5kZXBlbmRlbmNpZXMgPSByZXN0O1xuICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICB9O1xufVxuXG5leHBvcnQgbGV0IENvbXB1dGVkRXhwcmVzc2lvbiA9IGNsYXNzIENvbXB1dGVkRXhwcmVzc2lvbiBleHRlbmRzIEV4cHJlc3Npb24ge1xuICBjb25zdHJ1Y3RvcihuYW1lLCBkZXBlbmRlbmNpZXMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLmRlcGVuZGVuY2llcyA9IGRlcGVuZGVuY2llcztcbiAgICB0aGlzLmlzQXNzaWduYWJsZSA9IHRydWU7XG4gIH1cblxuICBldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgcmV0dXJuIHNjb3BlLmJpbmRpbmdDb250ZXh0W3RoaXMubmFtZV07XG4gIH1cblxuICBhc3NpZ24oc2NvcGUsIHZhbHVlKSB7XG4gICAgc2NvcGUuYmluZGluZ0NvbnRleHRbdGhpcy5uYW1lXSA9IHZhbHVlO1xuICB9XG5cbiAgYWNjZXB0KHZpc2l0b3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ25vdCBpbXBsZW1lbnRlZCcpO1xuICB9XG5cbiAgY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIGxldCBkZXBlbmRlbmNpZXMgPSB0aGlzLmRlcGVuZGVuY2llcztcbiAgICBsZXQgaSA9IGRlcGVuZGVuY2llcy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgZGVwZW5kZW5jaWVzW2ldLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNvbXB1dGVkT2JzZXJ2ZXIob2JqLCBwcm9wZXJ0eU5hbWUsIGRlc2NyaXB0b3IsIG9ic2VydmVyTG9jYXRvcikge1xuICBsZXQgZGVwZW5kZW5jaWVzID0gZGVzY3JpcHRvci5nZXQuZGVwZW5kZW5jaWVzO1xuICBpZiAoIShkZXBlbmRlbmNpZXMgaW5zdGFuY2VvZiBDb21wdXRlZEV4cHJlc3Npb24pKSB7XG4gICAgbGV0IGkgPSBkZXBlbmRlbmNpZXMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGRlcGVuZGVuY2llc1tpXSA9IG9ic2VydmVyTG9jYXRvci5wYXJzZXIucGFyc2UoZGVwZW5kZW5jaWVzW2ldKTtcbiAgICB9XG4gICAgZGVwZW5kZW5jaWVzID0gZGVzY3JpcHRvci5nZXQuZGVwZW5kZW5jaWVzID0gbmV3IENvbXB1dGVkRXhwcmVzc2lvbihwcm9wZXJ0eU5hbWUsIGRlcGVuZGVuY2llcyk7XG4gIH1cblxuICBsZXQgc2NvcGUgPSB7IGJpbmRpbmdDb250ZXh0OiBvYmosIG92ZXJyaWRlQ29udGV4dDogY3JlYXRlT3ZlcnJpZGVDb250ZXh0KG9iaikgfTtcbiAgcmV0dXJuIG5ldyBFeHByZXNzaW9uT2JzZXJ2ZXIoc2NvcGUsIGRlcGVuZGVuY2llcywgb2JzZXJ2ZXJMb2NhdG9yKTtcbn1cblxubGV0IHN2Z0VsZW1lbnRzO1xubGV0IHN2Z1ByZXNlbnRhdGlvbkVsZW1lbnRzO1xubGV0IHN2Z1ByZXNlbnRhdGlvbkF0dHJpYnV0ZXM7XG5sZXQgc3ZnQW5hbHl6ZXI7XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19TVkcgPT09ICd1bmRlZmluZWQnKSB7XG4gIHN2Z0VsZW1lbnRzID0ge1xuICAgIGE6IFsnY2xhc3MnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdpZCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RhcmdldCcsICd0cmFuc2Zvcm0nLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgYWx0R2x5cGg6IFsnY2xhc3MnLCAnZHgnLCAnZHknLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdmb3JtYXQnLCAnZ2x5cGhSZWYnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyb3RhdGUnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAneCcsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIGFsdEdseXBoRGVmOiBbJ2lkJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGFsdEdseXBoSXRlbTogWydpZCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgICBhbmltYXRlOiBbJ2FjY3VtdWxhdGUnLCAnYWRkaXRpdmUnLCAnYXR0cmlidXRlTmFtZScsICdhdHRyaWJ1dGVUeXBlJywgJ2JlZ2luJywgJ2J5JywgJ2NhbGNNb2RlJywgJ2R1cicsICdlbmQnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdmaWxsJywgJ2Zyb20nLCAnaWQnLCAna2V5U3BsaW5lcycsICdrZXlUaW1lcycsICdtYXgnLCAnbWluJywgJ29uYmVnaW4nLCAnb25lbmQnLCAnb25sb2FkJywgJ29ucmVwZWF0JywgJ3JlcGVhdENvdW50JywgJ3JlcGVhdER1cicsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyZXN0YXJ0JywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RvJywgJ3ZhbHVlcycsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgICBhbmltYXRlQ29sb3I6IFsnYWNjdW11bGF0ZScsICdhZGRpdGl2ZScsICdhdHRyaWJ1dGVOYW1lJywgJ2F0dHJpYnV0ZVR5cGUnLCAnYmVnaW4nLCAnYnknLCAnY2FsY01vZGUnLCAnZHVyJywgJ2VuZCcsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2ZpbGwnLCAnZnJvbScsICdpZCcsICdrZXlTcGxpbmVzJywgJ2tleVRpbWVzJywgJ21heCcsICdtaW4nLCAnb25iZWdpbicsICdvbmVuZCcsICdvbmxvYWQnLCAnb25yZXBlYXQnLCAncmVwZWF0Q291bnQnLCAncmVwZWF0RHVyJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3Jlc3RhcnQnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndG8nLCAndmFsdWVzJywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGFuaW1hdGVNb3Rpb246IFsnYWNjdW11bGF0ZScsICdhZGRpdGl2ZScsICdiZWdpbicsICdieScsICdjYWxjTW9kZScsICdkdXInLCAnZW5kJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnZmlsbCcsICdmcm9tJywgJ2lkJywgJ2tleVBvaW50cycsICdrZXlTcGxpbmVzJywgJ2tleVRpbWVzJywgJ21heCcsICdtaW4nLCAnb25iZWdpbicsICdvbmVuZCcsICdvbmxvYWQnLCAnb25yZXBlYXQnLCAnb3JpZ2luJywgJ3BhdGgnLCAncmVwZWF0Q291bnQnLCAncmVwZWF0RHVyJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3Jlc3RhcnQnLCAncm90YXRlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RvJywgJ3ZhbHVlcycsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgICBhbmltYXRlVHJhbnNmb3JtOiBbJ2FjY3VtdWxhdGUnLCAnYWRkaXRpdmUnLCAnYXR0cmlidXRlTmFtZScsICdhdHRyaWJ1dGVUeXBlJywgJ2JlZ2luJywgJ2J5JywgJ2NhbGNNb2RlJywgJ2R1cicsICdlbmQnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdmaWxsJywgJ2Zyb20nLCAnaWQnLCAna2V5U3BsaW5lcycsICdrZXlUaW1lcycsICdtYXgnLCAnbWluJywgJ29uYmVnaW4nLCAnb25lbmQnLCAnb25sb2FkJywgJ29ucmVwZWF0JywgJ3JlcGVhdENvdW50JywgJ3JlcGVhdER1cicsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyZXN0YXJ0JywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RvJywgJ3R5cGUnLCAndmFsdWVzJywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGNpcmNsZTogWydjbGFzcycsICdjeCcsICdjeScsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncicsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgY2xpcFBhdGg6IFsnY2xhc3MnLCAnY2xpcFBhdGhVbml0cycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RyYW5zZm9ybScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgICAnY29sb3ItcHJvZmlsZSc6IFsnaWQnLCAnbG9jYWwnLCAnbmFtZScsICdyZW5kZXJpbmctaW50ZW50JywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGN1cnNvcjogWydleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3gnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgICBkZWZzOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgZGVzYzogWydjbGFzcycsICdpZCcsICdzdHlsZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgICBlbGxpcHNlOiBbJ2NsYXNzJywgJ2N4JywgJ2N5JywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyeCcsICdyeScsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgZmVCbGVuZDogWydjbGFzcycsICdoZWlnaHQnLCAnaWQnLCAnaW4nLCAnaW4yJywgJ21vZGUnLCAncmVzdWx0JywgJ3N0eWxlJywgJ3dpZHRoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgICBmZUNvbG9yTWF0cml4OiBbJ2NsYXNzJywgJ2hlaWdodCcsICdpZCcsICdpbicsICdyZXN1bHQnLCAnc3R5bGUnLCAndHlwZScsICd2YWx1ZXMnLCAnd2lkdGgnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIGZlQ29tcG9uZW50VHJhbnNmZXI6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ3Jlc3VsdCcsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gICAgZmVDb21wb3NpdGU6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ2luMicsICdrMScsICdrMicsICdrMycsICdrNCcsICdvcGVyYXRvcicsICdyZXN1bHQnLCAnc3R5bGUnLCAnd2lkdGgnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIGZlQ29udm9sdmVNYXRyaXg6IFsnYmlhcycsICdjbGFzcycsICdkaXZpc29yJywgJ2VkZ2VNb2RlJywgJ2hlaWdodCcsICdpZCcsICdpbicsICdrZXJuZWxNYXRyaXgnLCAna2VybmVsVW5pdExlbmd0aCcsICdvcmRlcicsICdwcmVzZXJ2ZUFscGhhJywgJ3Jlc3VsdCcsICdzdHlsZScsICd0YXJnZXRYJywgJ3RhcmdldFknLCAnd2lkdGgnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIGZlRGlmZnVzZUxpZ2h0aW5nOiBbJ2NsYXNzJywgJ2RpZmZ1c2VDb25zdGFudCcsICdoZWlnaHQnLCAnaWQnLCAnaW4nLCAna2VybmVsVW5pdExlbmd0aCcsICdyZXN1bHQnLCAnc3R5bGUnLCAnc3VyZmFjZVNjYWxlJywgJ3dpZHRoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgICBmZURpc3BsYWNlbWVudE1hcDogWydjbGFzcycsICdoZWlnaHQnLCAnaWQnLCAnaW4nLCAnaW4yJywgJ3Jlc3VsdCcsICdzY2FsZScsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3hDaGFubmVsU2VsZWN0b3InLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knLCAneUNoYW5uZWxTZWxlY3RvciddLFxuICAgIGZlRGlzdGFudExpZ2h0OiBbJ2F6aW11dGgnLCAnZWxldmF0aW9uJywgJ2lkJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGZlRmxvb2Q6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ3Jlc3VsdCcsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gICAgZmVGdW5jQTogWydhbXBsaXR1ZGUnLCAnZXhwb25lbnQnLCAnaWQnLCAnaW50ZXJjZXB0JywgJ29mZnNldCcsICdzbG9wZScsICd0YWJsZVZhbHVlcycsICd0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGZlRnVuY0I6IFsnYW1wbGl0dWRlJywgJ2V4cG9uZW50JywgJ2lkJywgJ2ludGVyY2VwdCcsICdvZmZzZXQnLCAnc2xvcGUnLCAndGFibGVWYWx1ZXMnLCAndHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgICBmZUZ1bmNHOiBbJ2FtcGxpdHVkZScsICdleHBvbmVudCcsICdpZCcsICdpbnRlcmNlcHQnLCAnb2Zmc2V0JywgJ3Nsb3BlJywgJ3RhYmxlVmFsdWVzJywgJ3R5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgZmVGdW5jUjogWydhbXBsaXR1ZGUnLCAnZXhwb25lbnQnLCAnaWQnLCAnaW50ZXJjZXB0JywgJ29mZnNldCcsICdzbG9wZScsICd0YWJsZVZhbHVlcycsICd0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGZlR2F1c3NpYW5CbHVyOiBbJ2NsYXNzJywgJ2hlaWdodCcsICdpZCcsICdpbicsICdyZXN1bHQnLCAnc3RkRGV2aWF0aW9uJywgJ3N0eWxlJywgJ3dpZHRoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgICBmZUltYWdlOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaGVpZ2h0JywgJ2lkJywgJ3ByZXNlcnZlQXNwZWN0UmF0aW8nLCAncmVzdWx0JywgJ3N0eWxlJywgJ3dpZHRoJywgJ3gnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgICBmZU1lcmdlOiBbJ2NsYXNzJywgJ2hlaWdodCcsICdpZCcsICdyZXN1bHQnLCAnc3R5bGUnLCAnd2lkdGgnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIGZlTWVyZ2VOb2RlOiBbJ2lkJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGZlTW9ycGhvbG9neTogWydjbGFzcycsICdoZWlnaHQnLCAnaWQnLCAnaW4nLCAnb3BlcmF0b3InLCAncmFkaXVzJywgJ3Jlc3VsdCcsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gICAgZmVPZmZzZXQ6IFsnY2xhc3MnLCAnZHgnLCAnZHknLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ3Jlc3VsdCcsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gICAgZmVQb2ludExpZ2h0OiBbJ2lkJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knLCAneiddLFxuICAgIGZlU3BlY3VsYXJMaWdodGluZzogWydjbGFzcycsICdoZWlnaHQnLCAnaWQnLCAnaW4nLCAna2VybmVsVW5pdExlbmd0aCcsICdyZXN1bHQnLCAnc3BlY3VsYXJDb25zdGFudCcsICdzcGVjdWxhckV4cG9uZW50JywgJ3N0eWxlJywgJ3N1cmZhY2VTY2FsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gICAgZmVTcG90TGlnaHQ6IFsnaWQnLCAnbGltaXRpbmdDb25lQW5nbGUnLCAncG9pbnRzQXRYJywgJ3BvaW50c0F0WScsICdwb2ludHNBdFonLCAnc3BlY3VsYXJFeHBvbmVudCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5JywgJ3onXSxcbiAgICBmZVRpbGU6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ3Jlc3VsdCcsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gICAgZmVUdXJidWxlbmNlOiBbJ2Jhc2VGcmVxdWVuY3knLCAnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ251bU9jdGF2ZXMnLCAncmVzdWx0JywgJ3NlZWQnLCAnc3RpdGNoVGlsZXMnLCAnc3R5bGUnLCAndHlwZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gICAgZmlsdGVyOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnZmlsdGVyUmVzJywgJ2ZpbHRlclVuaXRzJywgJ2hlaWdodCcsICdpZCcsICdwcmltaXRpdmVVbml0cycsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gICAgZm9udDogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2hvcml6LWFkdi14JywgJ2hvcml6LW9yaWdpbi14JywgJ2hvcml6LW9yaWdpbi15JywgJ2lkJywgJ3N0eWxlJywgJ3ZlcnQtYWR2LXknLCAndmVydC1vcmlnaW4teCcsICd2ZXJ0LW9yaWdpbi15JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgICdmb250LWZhY2UnOiBbJ2FjY2VudC1oZWlnaHQnLCAnYWxwaGFiZXRpYycsICdhc2NlbnQnLCAnYmJveCcsICdjYXAtaGVpZ2h0JywgJ2Rlc2NlbnQnLCAnZm9udC1mYW1pbHknLCAnZm9udC1zaXplJywgJ2ZvbnQtc3RyZXRjaCcsICdmb250LXN0eWxlJywgJ2ZvbnQtdmFyaWFudCcsICdmb250LXdlaWdodCcsICdoYW5naW5nJywgJ2lkJywgJ2lkZW9ncmFwaGljJywgJ21hdGhlbWF0aWNhbCcsICdvdmVybGluZS1wb3NpdGlvbicsICdvdmVybGluZS10aGlja25lc3MnLCAncGFub3NlLTEnLCAnc2xvcGUnLCAnc3RlbWgnLCAnc3RlbXYnLCAnc3RyaWtldGhyb3VnaC1wb3NpdGlvbicsICdzdHJpa2V0aHJvdWdoLXRoaWNrbmVzcycsICd1bmRlcmxpbmUtcG9zaXRpb24nLCAndW5kZXJsaW5lLXRoaWNrbmVzcycsICd1bmljb2RlLXJhbmdlJywgJ3VuaXRzLXBlci1lbScsICd2LWFscGhhYmV0aWMnLCAndi1oYW5naW5nJywgJ3YtaWRlb2dyYXBoaWMnLCAndi1tYXRoZW1hdGljYWwnLCAnd2lkdGhzJywgJ3gtaGVpZ2h0JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgICdmb250LWZhY2UtZm9ybWF0JzogWydpZCcsICdzdHJpbmcnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgJ2ZvbnQtZmFjZS1uYW1lJzogWydpZCcsICduYW1lJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgICdmb250LWZhY2Utc3JjJzogWydpZCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgICAnZm9udC1mYWNlLXVyaSc6IFsnaWQnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgZm9yZWlnbk9iamVjdDogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2hlaWdodCcsICdpZCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RyYW5zZm9ybScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gICAgZzogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGdseXBoOiBbJ2FyYWJpYy1mb3JtJywgJ2NsYXNzJywgJ2QnLCAnZ2x5cGgtbmFtZScsICdob3Jpei1hZHYteCcsICdpZCcsICdsYW5nJywgJ29yaWVudGF0aW9uJywgJ3N0eWxlJywgJ3VuaWNvZGUnLCAndmVydC1hZHYteScsICd2ZXJ0LW9yaWdpbi14JywgJ3ZlcnQtb3JpZ2luLXknLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgZ2x5cGhSZWY6IFsnY2xhc3MnLCAnZHgnLCAnZHknLCAnZm9ybWF0JywgJ2dseXBoUmVmJywgJ2lkJywgJ3N0eWxlJywgJ3gnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgICBoa2VybjogWydnMScsICdnMicsICdpZCcsICdrJywgJ3UxJywgJ3UyJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIGltYWdlOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaGVpZ2h0JywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncHJlc2VydmVBc3BlY3RSYXRpbycsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAnd2lkdGgnLCAneCcsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIGxpbmU6IFsnY2xhc3MnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdpZCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RyYW5zZm9ybScsICd4MScsICd4MicsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneTEnLCAneTInXSxcbiAgICBsaW5lYXJHcmFkaWVudDogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2dyYWRpZW50VHJhbnNmb3JtJywgJ2dyYWRpZW50VW5pdHMnLCAnaWQnLCAnc3ByZWFkTWV0aG9kJywgJ3N0eWxlJywgJ3gxJywgJ3gyJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3kxJywgJ3kyJ10sXG4gICAgbWFya2VyOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnbWFya2VySGVpZ2h0JywgJ21hcmtlclVuaXRzJywgJ21hcmtlcldpZHRoJywgJ29yaWVudCcsICdwcmVzZXJ2ZUFzcGVjdFJhdGlvJywgJ3JlZlgnLCAncmVmWScsICdzdHlsZScsICd2aWV3Qm94JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIG1hc2s6IFsnY2xhc3MnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdoZWlnaHQnLCAnaWQnLCAnbWFza0NvbnRlbnRVbml0cycsICdtYXNrVW5pdHMnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAnd2lkdGgnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIG1ldGFkYXRhOiBbJ2lkJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgICdtaXNzaW5nLWdseXBoJzogWydjbGFzcycsICdkJywgJ2hvcml6LWFkdi14JywgJ2lkJywgJ3N0eWxlJywgJ3ZlcnQtYWR2LXknLCAndmVydC1vcmlnaW4teCcsICd2ZXJ0LW9yaWdpbi15JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIG1wYXRoOiBbJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgcGF0aDogWydjbGFzcycsICdkJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdwYXRoTGVuZ3RoJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RyYW5zZm9ybScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgICBwYXR0ZXJuOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaGVpZ2h0JywgJ2lkJywgJ3BhdHRlcm5Db250ZW50VW5pdHMnLCAncGF0dGVyblRyYW5zZm9ybScsICdwYXR0ZXJuVW5pdHMnLCAncHJlc2VydmVBc3BlY3RSYXRpbycsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd2aWV3Qm94JywgJ3dpZHRoJywgJ3gnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgICBwb2x5Z29uOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdwb2ludHMnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIHBvbHlsaW5lOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdwb2ludHMnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIHJhZGlhbEdyYWRpZW50OiBbJ2NsYXNzJywgJ2N4JywgJ2N5JywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnZngnLCAnZnknLCAnZ3JhZGllbnRUcmFuc2Zvcm0nLCAnZ3JhZGllbnRVbml0cycsICdpZCcsICdyJywgJ3NwcmVhZE1ldGhvZCcsICdzdHlsZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIHJlY3Q6IFsnY2xhc3MnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdoZWlnaHQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyeCcsICdyeScsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAnd2lkdGgnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIHNjcmlwdDogWydleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ3R5cGUnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgc2V0OiBbJ2F0dHJpYnV0ZU5hbWUnLCAnYXR0cmlidXRlVHlwZScsICdiZWdpbicsICdkdXInLCAnZW5kJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnZmlsbCcsICdpZCcsICdtYXgnLCAnbWluJywgJ29uYmVnaW4nLCAnb25lbmQnLCAnb25sb2FkJywgJ29ucmVwZWF0JywgJ3JlcGVhdENvdW50JywgJ3JlcGVhdER1cicsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyZXN0YXJ0JywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RvJywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIHN0b3A6IFsnY2xhc3MnLCAnaWQnLCAnb2Zmc2V0JywgJ3N0eWxlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIHN0eWxlOiBbJ2lkJywgJ21lZGlhJywgJ3RpdGxlJywgJ3R5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICAgc3ZnOiBbJ2Jhc2VQcm9maWxlJywgJ2NsYXNzJywgJ2NvbnRlbnRTY3JpcHRUeXBlJywgJ2NvbnRlbnRTdHlsZVR5cGUnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdoZWlnaHQnLCAnaWQnLCAnb25hYm9ydCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25lcnJvcicsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAnb25yZXNpemUnLCAnb25zY3JvbGwnLCAnb251bmxvYWQnLCAnb256b29tJywgJ3ByZXNlcnZlQXNwZWN0UmF0aW8nLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndmVyc2lvbicsICd2aWV3Qm94JywgJ3dpZHRoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knLCAnem9vbUFuZFBhbiddLFxuICAgIHN3aXRjaDogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIHN5bWJvbDogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncHJlc2VydmVBc3BlY3RSYXRpbycsICdzdHlsZScsICd2aWV3Qm94JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIHRleHQ6IFsnY2xhc3MnLCAnZHgnLCAnZHknLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdpZCcsICdsZW5ndGhBZGp1c3QnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyb3RhdGUnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndGV4dExlbmd0aCcsICd0cmFuc2Zvcm0nLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIHRleHRQYXRoOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnbGVuZ3RoQWRqdXN0JywgJ21ldGhvZCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3NwYWNpbmcnLCAnc3RhcnRPZmZzZXQnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndGV4dExlbmd0aCcsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIHRpdGxlOiBbJ2NsYXNzJywgJ2lkJywgJ3N0eWxlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAgIHRyZWY6IFsnY2xhc3MnLCAnZHgnLCAnZHknLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdpZCcsICdsZW5ndGhBZGp1c3QnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyb3RhdGUnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndGV4dExlbmd0aCcsICd4JywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgICB0c3BhbjogWydjbGFzcycsICdkeCcsICdkeScsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ2xlbmd0aEFkanVzdCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3JvdGF0ZScsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0ZXh0TGVuZ3RoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgICB1c2U6IFsnY2xhc3MnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdoZWlnaHQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAnd2lkdGgnLCAneCcsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICAgIHZpZXc6IFsnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdpZCcsICdwcmVzZXJ2ZUFzcGVjdFJhdGlvJywgJ3ZpZXdCb3gnLCAndmlld1RhcmdldCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAnem9vbUFuZFBhbiddLFxuICAgIHZrZXJuOiBbJ2cxJywgJ2cyJywgJ2lkJywgJ2snLCAndTEnLCAndTInLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ11cbiAgfTtcblxuXG4gIHN2Z1ByZXNlbnRhdGlvbkVsZW1lbnRzID0ge1xuICAgICdhJzogdHJ1ZSxcbiAgICAnYWx0R2x5cGgnOiB0cnVlLFxuICAgICdhbmltYXRlJzogdHJ1ZSxcbiAgICAnYW5pbWF0ZUNvbG9yJzogdHJ1ZSxcbiAgICAnY2lyY2xlJzogdHJ1ZSxcbiAgICAnY2xpcFBhdGgnOiB0cnVlLFxuICAgICdkZWZzJzogdHJ1ZSxcbiAgICAnZWxsaXBzZSc6IHRydWUsXG4gICAgJ2ZlQmxlbmQnOiB0cnVlLFxuICAgICdmZUNvbG9yTWF0cml4JzogdHJ1ZSxcbiAgICAnZmVDb21wb25lbnRUcmFuc2Zlcic6IHRydWUsXG4gICAgJ2ZlQ29tcG9zaXRlJzogdHJ1ZSxcbiAgICAnZmVDb252b2x2ZU1hdHJpeCc6IHRydWUsXG4gICAgJ2ZlRGlmZnVzZUxpZ2h0aW5nJzogdHJ1ZSxcbiAgICAnZmVEaXNwbGFjZW1lbnRNYXAnOiB0cnVlLFxuICAgICdmZUZsb29kJzogdHJ1ZSxcbiAgICAnZmVHYXVzc2lhbkJsdXInOiB0cnVlLFxuICAgICdmZUltYWdlJzogdHJ1ZSxcbiAgICAnZmVNZXJnZSc6IHRydWUsXG4gICAgJ2ZlTW9ycGhvbG9neSc6IHRydWUsXG4gICAgJ2ZlT2Zmc2V0JzogdHJ1ZSxcbiAgICAnZmVTcGVjdWxhckxpZ2h0aW5nJzogdHJ1ZSxcbiAgICAnZmVUaWxlJzogdHJ1ZSxcbiAgICAnZmVUdXJidWxlbmNlJzogdHJ1ZSxcbiAgICAnZmlsdGVyJzogdHJ1ZSxcbiAgICAnZm9udCc6IHRydWUsXG4gICAgJ2ZvcmVpZ25PYmplY3QnOiB0cnVlLFxuICAgICdnJzogdHJ1ZSxcbiAgICAnZ2x5cGgnOiB0cnVlLFxuICAgICdnbHlwaFJlZic6IHRydWUsXG4gICAgJ2ltYWdlJzogdHJ1ZSxcbiAgICAnbGluZSc6IHRydWUsXG4gICAgJ2xpbmVhckdyYWRpZW50JzogdHJ1ZSxcbiAgICAnbWFya2VyJzogdHJ1ZSxcbiAgICAnbWFzayc6IHRydWUsXG4gICAgJ21pc3NpbmctZ2x5cGgnOiB0cnVlLFxuICAgICdwYXRoJzogdHJ1ZSxcbiAgICAncGF0dGVybic6IHRydWUsXG4gICAgJ3BvbHlnb24nOiB0cnVlLFxuICAgICdwb2x5bGluZSc6IHRydWUsXG4gICAgJ3JhZGlhbEdyYWRpZW50JzogdHJ1ZSxcbiAgICAncmVjdCc6IHRydWUsXG4gICAgJ3N0b3AnOiB0cnVlLFxuICAgICdzdmcnOiB0cnVlLFxuICAgICdzd2l0Y2gnOiB0cnVlLFxuICAgICdzeW1ib2wnOiB0cnVlLFxuICAgICd0ZXh0JzogdHJ1ZSxcbiAgICAndGV4dFBhdGgnOiB0cnVlLFxuICAgICd0cmVmJzogdHJ1ZSxcbiAgICAndHNwYW4nOiB0cnVlLFxuICAgICd1c2UnOiB0cnVlXG4gIH07XG5cbiAgc3ZnUHJlc2VudGF0aW9uQXR0cmlidXRlcyA9IHtcbiAgICAnYWxpZ25tZW50LWJhc2VsaW5lJzogdHJ1ZSxcbiAgICAnYmFzZWxpbmUtc2hpZnQnOiB0cnVlLFxuICAgICdjbGlwLXBhdGgnOiB0cnVlLFxuICAgICdjbGlwLXJ1bGUnOiB0cnVlLFxuICAgICdjbGlwJzogdHJ1ZSxcbiAgICAnY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzJzogdHJ1ZSxcbiAgICAnY29sb3ItaW50ZXJwb2xhdGlvbic6IHRydWUsXG4gICAgJ2NvbG9yLXByb2ZpbGUnOiB0cnVlLFxuICAgICdjb2xvci1yZW5kZXJpbmcnOiB0cnVlLFxuICAgICdjb2xvcic6IHRydWUsXG4gICAgJ2N1cnNvcic6IHRydWUsXG4gICAgJ2RpcmVjdGlvbic6IHRydWUsXG4gICAgJ2Rpc3BsYXknOiB0cnVlLFxuICAgICdkb21pbmFudC1iYXNlbGluZSc6IHRydWUsXG4gICAgJ2VuYWJsZS1iYWNrZ3JvdW5kJzogdHJ1ZSxcbiAgICAnZmlsbC1vcGFjaXR5JzogdHJ1ZSxcbiAgICAnZmlsbC1ydWxlJzogdHJ1ZSxcbiAgICAnZmlsbCc6IHRydWUsXG4gICAgJ2ZpbHRlcic6IHRydWUsXG4gICAgJ2Zsb29kLWNvbG9yJzogdHJ1ZSxcbiAgICAnZmxvb2Qtb3BhY2l0eSc6IHRydWUsXG4gICAgJ2ZvbnQtZmFtaWx5JzogdHJ1ZSxcbiAgICAnZm9udC1zaXplLWFkanVzdCc6IHRydWUsXG4gICAgJ2ZvbnQtc2l6ZSc6IHRydWUsXG4gICAgJ2ZvbnQtc3RyZXRjaCc6IHRydWUsXG4gICAgJ2ZvbnQtc3R5bGUnOiB0cnVlLFxuICAgICdmb250LXZhcmlhbnQnOiB0cnVlLFxuICAgICdmb250LXdlaWdodCc6IHRydWUsXG4gICAgJ2dseXBoLW9yaWVudGF0aW9uLWhvcml6b250YWwnOiB0cnVlLFxuICAgICdnbHlwaC1vcmllbnRhdGlvbi12ZXJ0aWNhbCc6IHRydWUsXG4gICAgJ2ltYWdlLXJlbmRlcmluZyc6IHRydWUsXG4gICAgJ2tlcm5pbmcnOiB0cnVlLFxuICAgICdsZXR0ZXItc3BhY2luZyc6IHRydWUsXG4gICAgJ2xpZ2h0aW5nLWNvbG9yJzogdHJ1ZSxcbiAgICAnbWFya2VyLWVuZCc6IHRydWUsXG4gICAgJ21hcmtlci1taWQnOiB0cnVlLFxuICAgICdtYXJrZXItc3RhcnQnOiB0cnVlLFxuICAgICdtYXNrJzogdHJ1ZSxcbiAgICAnb3BhY2l0eSc6IHRydWUsXG4gICAgJ292ZXJmbG93JzogdHJ1ZSxcbiAgICAncG9pbnRlci1ldmVudHMnOiB0cnVlLFxuICAgICdzaGFwZS1yZW5kZXJpbmcnOiB0cnVlLFxuICAgICdzdG9wLWNvbG9yJzogdHJ1ZSxcbiAgICAnc3RvcC1vcGFjaXR5JzogdHJ1ZSxcbiAgICAnc3Ryb2tlLWRhc2hhcnJheSc6IHRydWUsXG4gICAgJ3N0cm9rZS1kYXNob2Zmc2V0JzogdHJ1ZSxcbiAgICAnc3Ryb2tlLWxpbmVjYXAnOiB0cnVlLFxuICAgICdzdHJva2UtbGluZWpvaW4nOiB0cnVlLFxuICAgICdzdHJva2UtbWl0ZXJsaW1pdCc6IHRydWUsXG4gICAgJ3N0cm9rZS1vcGFjaXR5JzogdHJ1ZSxcbiAgICAnc3Ryb2tlLXdpZHRoJzogdHJ1ZSxcbiAgICAnc3Ryb2tlJzogdHJ1ZSxcbiAgICAndGV4dC1hbmNob3InOiB0cnVlLFxuICAgICd0ZXh0LWRlY29yYXRpb24nOiB0cnVlLFxuICAgICd0ZXh0LXJlbmRlcmluZyc6IHRydWUsXG4gICAgJ3VuaWNvZGUtYmlkaSc6IHRydWUsXG4gICAgJ3Zpc2liaWxpdHknOiB0cnVlLFxuICAgICd3b3JkLXNwYWNpbmcnOiB0cnVlLFxuICAgICd3cml0aW5nLW1vZGUnOiB0cnVlXG4gIH07XG5cbiAgbGV0IGNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoaHRtbCkge1xuICAgIGxldCBkaXYgPSBET00uY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZGl2LmlubmVySFRNTCA9IGh0bWw7XG4gICAgcmV0dXJuIGRpdi5maXJzdENoaWxkO1xuICB9O1xuXG4gIHN2Z0FuYWx5emVyID0gY2xhc3MgU1ZHQW5hbHl6ZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgaWYgKGNyZWF0ZUVsZW1lbnQoJzxzdmc+PGFsdEdseXBoIC8+PC9zdmc+JykuZmlyc3RFbGVtZW50Q2hpbGQubm9kZU5hbWUgPT09ICdhbHRnbHlwaCcgJiYgZWxlbWVudHMuYWx0R2x5cGgpIHtcbiAgICAgICAgZWxlbWVudHMuYWx0Z2x5cGggPSBlbGVtZW50cy5hbHRHbHlwaDtcbiAgICAgICAgZGVsZXRlIGVsZW1lbnRzLmFsdEdseXBoO1xuICAgICAgICBlbGVtZW50cy5hbHRnbHlwaGRlZiA9IGVsZW1lbnRzLmFsdEdseXBoRGVmO1xuICAgICAgICBkZWxldGUgZWxlbWVudHMuYWx0R2x5cGhEZWY7XG4gICAgICAgIGVsZW1lbnRzLmFsdGdseXBoaXRlbSA9IGVsZW1lbnRzLmFsdEdseXBoSXRlbTtcbiAgICAgICAgZGVsZXRlIGVsZW1lbnRzLmFsdEdseXBoSXRlbTtcbiAgICAgICAgZWxlbWVudHMuZ2x5cGhyZWYgPSBlbGVtZW50cy5nbHlwaFJlZjtcbiAgICAgICAgZGVsZXRlIGVsZW1lbnRzLmdseXBoUmVmO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlzU3RhbmRhcmRTdmdBdHRyaWJ1dGUobm9kZU5hbWUsIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgIHJldHVybiBwcmVzZW50YXRpb25FbGVtZW50c1tub2RlTmFtZV0gJiYgcHJlc2VudGF0aW9uQXR0cmlidXRlc1thdHRyaWJ1dGVOYW1lXSB8fCBlbGVtZW50c1tub2RlTmFtZV0gJiYgZWxlbWVudHNbbm9kZU5hbWVdLmluZGV4T2YoYXR0cmlidXRlTmFtZSkgIT09IC0xO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IGVsZW1lbnRzID0gc3ZnRWxlbWVudHM7XG5leHBvcnQgY29uc3QgcHJlc2VudGF0aW9uRWxlbWVudHMgPSBzdmdQcmVzZW50YXRpb25FbGVtZW50cztcbmV4cG9ydCBjb25zdCBwcmVzZW50YXRpb25BdHRyaWJ1dGVzID0gc3ZnUHJlc2VudGF0aW9uQXR0cmlidXRlcztcbmV4cG9ydCBjb25zdCBTVkdBbmFseXplciA9IHN2Z0FuYWx5emVyIHx8IGNsYXNzIHtcbiAgaXNTdGFuZGFyZFN2Z0F0dHJpYnV0ZSgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgT2JzZXJ2ZXJMb2NhdG9yID0gKF90ZW1wID0gX2NsYXNzMTEgPSBjbGFzcyBPYnNlcnZlckxvY2F0b3Ige1xuICBjb25zdHJ1Y3Rvcih0YXNrUXVldWUsIGV2ZW50TWFuYWdlciwgZGlydHlDaGVja2VyLCBzdmdBbmFseXplciwgcGFyc2VyKSB7XG4gICAgdGhpcy50YXNrUXVldWUgPSB0YXNrUXVldWU7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXI7XG4gICAgdGhpcy5kaXJ0eUNoZWNrZXIgPSBkaXJ0eUNoZWNrZXI7XG4gICAgdGhpcy5zdmdBbmFseXplciA9IHN2Z0FuYWx5emVyO1xuICAgIHRoaXMucGFyc2VyID0gcGFyc2VyO1xuXG4gICAgdGhpcy5hZGFwdGVycyA9IFtdO1xuICAgIHRoaXMubG9nZ2VyID0gTG9nTWFuYWdlci5nZXRMb2dnZXIoJ29ic2VydmVyLWxvY2F0b3InKTtcbiAgfVxuXG4gIGdldE9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lKSB7XG4gICAgbGV0IG9ic2VydmVyc0xvb2t1cCA9IG9iai5fX29ic2VydmVyc19fO1xuICAgIGxldCBvYnNlcnZlcjtcblxuICAgIGlmIChvYnNlcnZlcnNMb29rdXAgJiYgcHJvcGVydHlOYW1lIGluIG9ic2VydmVyc0xvb2t1cCkge1xuICAgICAgcmV0dXJuIG9ic2VydmVyc0xvb2t1cFtwcm9wZXJ0eU5hbWVdO1xuICAgIH1cblxuICAgIG9ic2VydmVyID0gdGhpcy5jcmVhdGVQcm9wZXJ0eU9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lKTtcblxuICAgIGlmICghb2JzZXJ2ZXIuZG9Ob3RDYWNoZSkge1xuICAgICAgaWYgKG9ic2VydmVyc0xvb2t1cCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG9ic2VydmVyc0xvb2t1cCA9IHRoaXMuZ2V0T3JDcmVhdGVPYnNlcnZlcnNMb29rdXAob2JqKTtcbiAgICAgIH1cblxuICAgICAgb2JzZXJ2ZXJzTG9va3VwW3Byb3BlcnR5TmFtZV0gPSBvYnNlcnZlcjtcbiAgICB9XG5cbiAgICByZXR1cm4gb2JzZXJ2ZXI7XG4gIH1cblxuICBnZXRPckNyZWF0ZU9ic2VydmVyc0xvb2t1cChvYmopIHtcbiAgICByZXR1cm4gb2JqLl9fb2JzZXJ2ZXJzX18gfHwgdGhpcy5jcmVhdGVPYnNlcnZlcnNMb29rdXAob2JqKTtcbiAgfVxuXG4gIGNyZWF0ZU9ic2VydmVyc0xvb2t1cChvYmopIHtcbiAgICBsZXQgdmFsdWUgPSB7fTtcblxuICAgIGlmICghUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eShvYmosICdfX29ic2VydmVyc19fJywge1xuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgdmFsdWU6IHZhbHVlXG4gICAgfSkpIHtcbiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ0Nhbm5vdCBhZGQgb2JzZXJ2ZXJzIHRvIG9iamVjdCcsIG9iaik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG5cbiAgYWRkQWRhcHRlcihhZGFwdGVyKSB7XG4gICAgdGhpcy5hZGFwdGVycy5wdXNoKGFkYXB0ZXIpO1xuICB9XG5cbiAgZ2V0QWRhcHRlck9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lLCBkZXNjcmlwdG9yKSB7XG4gICAgZm9yIChsZXQgaSA9IDAsIGlpID0gdGhpcy5hZGFwdGVycy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICBsZXQgYWRhcHRlciA9IHRoaXMuYWRhcHRlcnNbaV07XG4gICAgICBsZXQgb2JzZXJ2ZXIgPSBhZGFwdGVyLmdldE9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lLCBkZXNjcmlwdG9yKTtcbiAgICAgIGlmIChvYnNlcnZlcikge1xuICAgICAgICByZXR1cm4gb2JzZXJ2ZXI7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY3JlYXRlUHJvcGVydHlPYnNlcnZlcihvYmosIHByb3BlcnR5TmFtZSkge1xuICAgIGxldCBkZXNjcmlwdG9yO1xuICAgIGxldCBoYW5kbGVyO1xuICAgIGxldCB4bGlua1Jlc3VsdDtcblxuICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIE9iamVjdCkpIHtcbiAgICAgIHJldHVybiBuZXcgUHJpbWl0aXZlT2JzZXJ2ZXIob2JqLCBwcm9wZXJ0eU5hbWUpO1xuICAgIH1cblxuICAgIGlmIChvYmogaW5zdGFuY2VvZiBET00uRWxlbWVudCkge1xuICAgICAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICByZXR1cm4gbmV3IENsYXNzT2JzZXJ2ZXIob2JqKTtcbiAgICAgIH1cbiAgICAgIGlmIChwcm9wZXJ0eU5hbWUgPT09ICdzdHlsZScgfHwgcHJvcGVydHlOYW1lID09PSAnY3NzJykge1xuICAgICAgICByZXR1cm4gbmV3IFN0eWxlT2JzZXJ2ZXIob2JqLCBwcm9wZXJ0eU5hbWUpO1xuICAgICAgfVxuICAgICAgaGFuZGxlciA9IHRoaXMuZXZlbnRNYW5hZ2VyLmdldEVsZW1lbnRIYW5kbGVyKG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICAgIGlmIChwcm9wZXJ0eU5hbWUgPT09ICd2YWx1ZScgJiYgb2JqLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3NlbGVjdCcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTZWxlY3RWYWx1ZU9ic2VydmVyKG9iaiwgaGFuZGxlciwgdGhpcyk7XG4gICAgICB9XG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAnY2hlY2tlZCcgJiYgb2JqLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0Jykge1xuICAgICAgICByZXR1cm4gbmV3IENoZWNrZWRPYnNlcnZlcihvYmosIGhhbmRsZXIsIHRoaXMpO1xuICAgICAgfVxuICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZUF0dHJpYnV0ZU9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lLCBoYW5kbGVyKTtcbiAgICAgIH1cbiAgICAgIHhsaW5rUmVzdWx0ID0gL154bGluazooLispJC8uZXhlYyhwcm9wZXJ0eU5hbWUpO1xuICAgICAgaWYgKHhsaW5rUmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWExpbmtBdHRyaWJ1dGVPYnNlcnZlcihvYmosIHByb3BlcnR5TmFtZSwgeGxpbmtSZXN1bHRbMV0pO1xuICAgICAgfVxuICAgICAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ3JvbGUnICYmIChvYmogaW5zdGFuY2VvZiBET00uRWxlbWVudCB8fCBvYmogaW5zdGFuY2VvZiBET00uU1ZHRWxlbWVudCkgfHwgL15cXHcrOnxeZGF0YS18XmFyaWEtLy50ZXN0KHByb3BlcnR5TmFtZSkgfHwgb2JqIGluc3RhbmNlb2YgRE9NLlNWR0VsZW1lbnQgJiYgdGhpcy5zdmdBbmFseXplci5pc1N0YW5kYXJkU3ZnQXR0cmlidXRlKG9iai5ub2RlTmFtZSwgcHJvcGVydHlOYW1lKSkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGFBdHRyaWJ1dGVPYnNlcnZlcihvYmosIHByb3BlcnR5TmFtZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRQcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBwcm9wZXJ0eU5hbWUpO1xuXG4gICAgaWYgKGhhc0RlY2xhcmVkRGVwZW5kZW5jaWVzKGRlc2NyaXB0b3IpKSB7XG4gICAgICByZXR1cm4gY3JlYXRlQ29tcHV0ZWRPYnNlcnZlcihvYmosIHByb3BlcnR5TmFtZSwgZGVzY3JpcHRvciwgdGhpcyk7XG4gICAgfVxuXG4gICAgaWYgKGRlc2NyaXB0b3IpIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nR2V0dGVyT3JTZXR0ZXIgPSBkZXNjcmlwdG9yLmdldCB8fCBkZXNjcmlwdG9yLnNldDtcbiAgICAgIGlmIChleGlzdGluZ0dldHRlck9yU2V0dGVyKSB7XG4gICAgICAgIGlmIChleGlzdGluZ0dldHRlck9yU2V0dGVyLmdldE9ic2VydmVyKSB7XG4gICAgICAgICAgcmV0dXJuIGV4aXN0aW5nR2V0dGVyT3JTZXR0ZXIuZ2V0T2JzZXJ2ZXIob2JqKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBhZGFwdGVyT2JzZXJ2ZXIgPSB0aGlzLmdldEFkYXB0ZXJPYnNlcnZlcihvYmosIHByb3BlcnR5TmFtZSwgZGVzY3JpcHRvcik7XG4gICAgICAgIGlmIChhZGFwdGVyT2JzZXJ2ZXIpIHtcbiAgICAgICAgICByZXR1cm4gYWRhcHRlck9ic2VydmVyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgRGlydHlDaGVja1Byb3BlcnR5KHRoaXMuZGlydHlDaGVja2VyLCBvYmosIHByb3BlcnR5TmFtZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAnbGVuZ3RoJykge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBcnJheU9ic2VydmVyKG9iaikuZ2V0TGVuZ3RoT2JzZXJ2ZXIoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBEaXJ0eUNoZWNrUHJvcGVydHkodGhpcy5kaXJ0eUNoZWNrZXIsIG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIE1hcCkge1xuICAgICAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ3NpemUnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1hcE9ic2VydmVyKG9iaikuZ2V0TGVuZ3RoT2JzZXJ2ZXIoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBEaXJ0eUNoZWNrUHJvcGVydHkodGhpcy5kaXJ0eUNoZWNrZXIsIG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ3NpemUnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNldE9ic2VydmVyKG9iaikuZ2V0TGVuZ3RoT2JzZXJ2ZXIoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBEaXJ0eUNoZWNrUHJvcGVydHkodGhpcy5kaXJ0eUNoZWNrZXIsIG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFNldHRlck9ic2VydmVyKHRoaXMudGFza1F1ZXVlLCBvYmosIHByb3BlcnR5TmFtZSk7XG4gIH1cblxuICBnZXRBY2Nlc3NvcihvYmosIHByb3BlcnR5TmFtZSkge1xuICAgIGlmIChvYmogaW5zdGFuY2VvZiBET00uRWxlbWVudCkge1xuICAgICAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ2NsYXNzJyB8fCBwcm9wZXJ0eU5hbWUgPT09ICdzdHlsZScgfHwgcHJvcGVydHlOYW1lID09PSAnY3NzJyB8fCBwcm9wZXJ0eU5hbWUgPT09ICd2YWx1ZScgJiYgKG9iai50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbnB1dCcgfHwgb2JqLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3NlbGVjdCcpIHx8IHByb3BlcnR5TmFtZSA9PT0gJ2NoZWNrZWQnICYmIG9iai50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbnB1dCcgfHwgcHJvcGVydHlOYW1lID09PSAnbW9kZWwnICYmIG9iai50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbnB1dCcgfHwgL154bGluazouKyQvLmV4ZWMocHJvcGVydHlOYW1lKSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRPYnNlcnZlcihvYmosIHByb3BlcnR5TmFtZSk7XG4gICAgICB9XG4gICAgICBpZiAoL15cXHcrOnxeZGF0YS18XmFyaWEtLy50ZXN0KHByb3BlcnR5TmFtZSkgfHwgb2JqIGluc3RhbmNlb2YgRE9NLlNWR0VsZW1lbnQgJiYgdGhpcy5zdmdBbmFseXplci5pc1N0YW5kYXJkU3ZnQXR0cmlidXRlKG9iai5ub2RlTmFtZSwgcHJvcGVydHlOYW1lKSB8fCBvYmoudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnaW1nJyAmJiBwcm9wZXJ0eU5hbWUgPT09ICdzcmMnIHx8IG9iai50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdhJyAmJiBwcm9wZXJ0eU5hbWUgPT09ICdocmVmJykge1xuICAgICAgICByZXR1cm4gZGF0YUF0dHJpYnV0ZUFjY2Vzc29yO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcHJvcGVydHlBY2Nlc3NvcjtcbiAgfVxuXG4gIGdldEFycmF5T2JzZXJ2ZXIoYXJyYXkpIHtcbiAgICByZXR1cm4gZ2V0QXJyYXlPYnNlcnZlcih0aGlzLnRhc2tRdWV1ZSwgYXJyYXkpO1xuICB9XG5cbiAgZ2V0TWFwT2JzZXJ2ZXIobWFwKSB7XG4gICAgcmV0dXJuIGdldE1hcE9ic2VydmVyKHRoaXMudGFza1F1ZXVlLCBtYXApO1xuICB9XG5cbiAgZ2V0U2V0T2JzZXJ2ZXIoc2V0KSB7XG4gICAgcmV0dXJuIGdldFNldE9ic2VydmVyKHRoaXMudGFza1F1ZXVlLCBzZXQpO1xuICB9XG59LCBfY2xhc3MxMS5pbmplY3QgPSBbVGFza1F1ZXVlLCBFdmVudE1hbmFnZXIsIERpcnR5Q2hlY2tlciwgU1ZHQW5hbHl6ZXIsIFBhcnNlcl0sIF90ZW1wKTtcblxuZXhwb3J0IGxldCBPYmplY3RPYnNlcnZhdGlvbkFkYXB0ZXIgPSBjbGFzcyBPYmplY3RPYnNlcnZhdGlvbkFkYXB0ZXIge1xuICBnZXRPYnNlcnZlcihvYmplY3QsIHByb3BlcnR5TmFtZSwgZGVzY3JpcHRvcikge1xuICAgIHRocm93IG5ldyBFcnJvcignQmluZGluZ0FkYXB0ZXJzIG11c3QgaW1wbGVtZW50IGdldE9ic2VydmVyKG9iamVjdCwgcHJvcGVydHlOYW1lKS4nKTtcbiAgfVxufTtcblxuZXhwb3J0IGxldCBCaW5kaW5nRXhwcmVzc2lvbiA9IGNsYXNzIEJpbmRpbmdFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3Iob2JzZXJ2ZXJMb2NhdG9yLCB0YXJnZXRQcm9wZXJ0eSwgc291cmNlRXhwcmVzc2lvbiwgbW9kZSwgbG9va3VwRnVuY3Rpb25zLCBhdHRyaWJ1dGUpIHtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uID0gc291cmNlRXhwcmVzc2lvbjtcbiAgICB0aGlzLm1vZGUgPSBtb2RlO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICAgIHRoaXMuYXR0cmlidXRlID0gYXR0cmlidXRlO1xuICAgIHRoaXMuZGlzY3JldGUgPSBmYWxzZTtcbiAgfVxuXG4gIGNyZWF0ZUJpbmRpbmcodGFyZ2V0KSB7XG4gICAgcmV0dXJuIG5ldyBCaW5kaW5nKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLnNvdXJjZUV4cHJlc3Npb24sIHRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSwgdGhpcy5tb2RlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgQmluZGluZyA9IChfZGVjMTAgPSBjb25uZWN0YWJsZSgpLCBfZGVjMTAoX2NsYXNzMTIgPSBjbGFzcyBCaW5kaW5nIHtcbiAgY29uc3RydWN0b3Iob2JzZXJ2ZXJMb2NhdG9yLCBzb3VyY2VFeHByZXNzaW9uLCB0YXJnZXQsIHRhcmdldFByb3BlcnR5LCBtb2RlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcbiAgICB0aGlzLm1vZGUgPSBtb2RlO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICB9XG5cbiAgdXBkYXRlVGFyZ2V0KHZhbHVlKSB7XG4gICAgdGhpcy50YXJnZXRPYnNlcnZlci5zZXRWYWx1ZSh2YWx1ZSwgdGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0UHJvcGVydHkpO1xuICB9XG5cbiAgdXBkYXRlU291cmNlKHZhbHVlKSB7XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmFzc2lnbih0aGlzLnNvdXJjZSwgdmFsdWUsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIGNhbGwoY29udGV4dCwgbmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGNvbnRleHQgPT09IHNvdXJjZUNvbnRleHQpIHtcbiAgICAgIG9sZFZhbHVlID0gdGhpcy50YXJnZXRPYnNlcnZlci5nZXRWYWx1ZSh0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSk7XG4gICAgICBuZXdWYWx1ZSA9IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgICAgaWYgKG5ld1ZhbHVlICE9PSBvbGRWYWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldChuZXdWYWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5tb2RlICE9PSBiaW5kaW5nTW9kZS5vbmVUaW1lKSB7XG4gICAgICAgIHRoaXMuX3ZlcnNpb24rKztcbiAgICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmNvbm5lY3QodGhpcywgdGhpcy5zb3VyY2UpO1xuICAgICAgICB0aGlzLnVub2JzZXJ2ZShmYWxzZSk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjb250ZXh0ID09PSB0YXJnZXRDb250ZXh0KSB7XG4gICAgICBpZiAobmV3VmFsdWUgIT09IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpKSB7XG4gICAgICAgIHRoaXMudXBkYXRlU291cmNlKG5ld1ZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIGNhbGwgY29udGV4dCAke2NvbnRleHR9YCk7XG4gIH1cblxuICBiaW5kKHNvdXJjZSkge1xuICAgIGlmICh0aGlzLmlzQm91bmQpIHtcbiAgICAgIGlmICh0aGlzLnNvdXJjZSA9PT0gc291cmNlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMudW5iaW5kKCk7XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IHRydWU7XG4gICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cbiAgICBpZiAodGhpcy5zb3VyY2VFeHByZXNzaW9uLmJpbmQpIHtcbiAgICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbi5iaW5kKHRoaXMsIHNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgIH1cblxuICAgIGxldCBtb2RlID0gdGhpcy5tb2RlO1xuICAgIGlmICghdGhpcy50YXJnZXRPYnNlcnZlcikge1xuICAgICAgbGV0IG1ldGhvZCA9IG1vZGUgPT09IGJpbmRpbmdNb2RlLnR3b1dheSB8fCBtb2RlID09PSBiaW5kaW5nTW9kZS5mcm9tVmlldyA/ICdnZXRPYnNlcnZlcicgOiAnZ2V0QWNjZXNzb3InO1xuICAgICAgdGhpcy50YXJnZXRPYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXJMb2NhdG9yW21ldGhvZF0odGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0UHJvcGVydHkpO1xuICAgIH1cblxuICAgIGlmICgnYmluZCcgaW4gdGhpcy50YXJnZXRPYnNlcnZlcikge1xuICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci5iaW5kKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLm1vZGUgIT09IGJpbmRpbmdNb2RlLmZyb21WaWV3KSB7XG4gICAgICBsZXQgdmFsdWUgPSB0aGlzLnNvdXJjZUV4cHJlc3Npb24uZXZhbHVhdGUoc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgICB0aGlzLnVwZGF0ZVRhcmdldCh2YWx1ZSk7XG4gICAgfVxuXG4gICAgaWYgKG1vZGUgPT09IGJpbmRpbmdNb2RlLm9uZVRpbWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKG1vZGUgPT09IGJpbmRpbmdNb2RlLnRvVmlldykge1xuICAgICAgZW5xdWV1ZUJpbmRpbmdDb25uZWN0KHRoaXMpO1xuICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gYmluZGluZ01vZGUudHdvV2F5KSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uY29ubmVjdCh0aGlzLCBzb3VyY2UpO1xuICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci5zdWJzY3JpYmUodGFyZ2V0Q29udGV4dCwgdGhpcyk7XG4gICAgfSBlbHNlIGlmIChtb2RlID09PSBiaW5kaW5nTW9kZS5mcm9tVmlldykge1xuICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci5zdWJzY3JpYmUodGFyZ2V0Q29udGV4dCwgdGhpcyk7XG4gICAgfVxuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIGlmICgndW5iaW5kJyBpbiB0aGlzLnRhcmdldE9ic2VydmVyKSB7XG4gICAgICB0aGlzLnRhcmdldE9ic2VydmVyLnVuYmluZCgpO1xuICAgIH1cbiAgICBpZiAodGhpcy50YXJnZXRPYnNlcnZlci51bnN1YnNjcmliZSkge1xuICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci51bnN1YnNjcmliZSh0YXJnZXRDb250ZXh0LCB0aGlzKTtcbiAgICB9XG4gICAgdGhpcy51bm9ic2VydmUodHJ1ZSk7XG4gIH1cblxuICBjb25uZWN0KGV2YWx1YXRlKSB7XG4gICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGV2YWx1YXRlKSB7XG4gICAgICBsZXQgdmFsdWUgPSB0aGlzLnNvdXJjZUV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KHZhbHVlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmNvbm5lY3QodGhpcywgdGhpcy5zb3VyY2UpO1xuICB9XG59KSB8fCBfY2xhc3MxMik7XG5cbmV4cG9ydCBsZXQgQ2FsbEV4cHJlc3Npb24gPSBjbGFzcyBDYWxsRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKG9ic2VydmVyTG9jYXRvciwgdGFyZ2V0UHJvcGVydHksIHNvdXJjZUV4cHJlc3Npb24sIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICB9XG5cbiAgY3JlYXRlQmluZGluZyh0YXJnZXQpIHtcbiAgICByZXR1cm4gbmV3IENhbGwodGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuc291cmNlRXhwcmVzc2lvbiwgdGFyZ2V0LCB0aGlzLnRhcmdldFByb3BlcnR5LCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgQ2FsbCA9IGNsYXNzIENhbGwge1xuICBjb25zdHJ1Y3RvcihvYnNlcnZlckxvY2F0b3IsIHNvdXJjZUV4cHJlc3Npb24sIHRhcmdldCwgdGFyZ2V0UHJvcGVydHksIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IG9ic2VydmVyTG9jYXRvci5nZXRPYnNlcnZlcih0YXJnZXQsIHRhcmdldFByb3BlcnR5KTtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgfVxuXG4gIGNhbGxTb3VyY2UoJGV2ZW50KSB7XG4gICAgbGV0IG92ZXJyaWRlQ29udGV4dCA9IHRoaXMuc291cmNlLm92ZXJyaWRlQ29udGV4dDtcbiAgICBPYmplY3QuYXNzaWduKG92ZXJyaWRlQ29udGV4dCwgJGV2ZW50KTtcbiAgICBvdmVycmlkZUNvbnRleHQuJGV2ZW50ID0gJGV2ZW50O1xuICAgIGxldCBtdXN0RXZhbHVhdGUgPSB0cnVlO1xuICAgIGxldCByZXN1bHQgPSB0aGlzLnNvdXJjZUV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zLCBtdXN0RXZhbHVhdGUpO1xuICAgIGRlbGV0ZSBvdmVycmlkZUNvbnRleHQuJGV2ZW50O1xuICAgIGZvciAobGV0IHByb3AgaW4gJGV2ZW50KSB7XG4gICAgICBkZWxldGUgb3ZlcnJpZGVDb250ZXh0W3Byb3BdO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgYmluZChzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXG4gICAgaWYgKHRoaXMuc291cmNlRXhwcmVzc2lvbi5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uYmluZCh0aGlzLCBzb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eS5zZXRWYWx1ZSgkZXZlbnQgPT4gdGhpcy5jYWxsU291cmNlKCRldmVudCkpO1xuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkuc2V0VmFsdWUobnVsbCk7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgVmFsdWVDb252ZXJ0ZXJSZXNvdXJjZSA9IGNsYXNzIFZhbHVlQ29udmVydGVyUmVzb3VyY2Uge1xuICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgfVxuXG4gIHN0YXRpYyBjb252ZW50aW9uKG5hbWUpIHtcbiAgICBpZiAobmFtZS5lbmRzV2l0aCgnVmFsdWVDb252ZXJ0ZXInKSkge1xuICAgICAgcmV0dXJuIG5ldyBWYWx1ZUNvbnZlcnRlclJlc291cmNlKGNhbWVsQ2FzZShuYW1lLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCAtIDE0KSkpO1xuICAgIH1cbiAgfVxuXG4gIGluaXRpYWxpemUoY29udGFpbmVyLCB0YXJnZXQpIHtcbiAgICB0aGlzLmluc3RhbmNlID0gY29udGFpbmVyLmdldCh0YXJnZXQpO1xuICB9XG5cbiAgcmVnaXN0ZXIocmVnaXN0cnksIG5hbWUpIHtcbiAgICByZWdpc3RyeS5yZWdpc3RlclZhbHVlQ29udmVydGVyKG5hbWUgfHwgdGhpcy5uYW1lLCB0aGlzLmluc3RhbmNlKTtcbiAgfVxuXG4gIGxvYWQoY29udGFpbmVyLCB0YXJnZXQpIHt9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gdmFsdWVDb252ZXJ0ZXIobmFtZU9yVGFyZ2V0KSB7XG4gIGlmIChuYW1lT3JUYXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0eXBlb2YgbmFtZU9yVGFyZ2V0ID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICBtZXRhZGF0YS5kZWZpbmUobWV0YWRhdGEucmVzb3VyY2UsIG5ldyBWYWx1ZUNvbnZlcnRlclJlc291cmNlKG5hbWVPclRhcmdldCksIHRhcmdldCk7XG4gICAgfTtcbiAgfVxuXG4gIG1ldGFkYXRhLmRlZmluZShtZXRhZGF0YS5yZXNvdXJjZSwgbmV3IFZhbHVlQ29udmVydGVyUmVzb3VyY2UoKSwgbmFtZU9yVGFyZ2V0KTtcbn1cblxuZXhwb3J0IGxldCBCaW5kaW5nQmVoYXZpb3JSZXNvdXJjZSA9IGNsYXNzIEJpbmRpbmdCZWhhdmlvclJlc291cmNlIHtcbiAgY29uc3RydWN0b3IobmFtZSkge1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gIH1cblxuICBzdGF0aWMgY29udmVudGlvbihuYW1lKSB7XG4gICAgaWYgKG5hbWUuZW5kc1dpdGgoJ0JpbmRpbmdCZWhhdmlvcicpKSB7XG4gICAgICByZXR1cm4gbmV3IEJpbmRpbmdCZWhhdmlvclJlc291cmNlKGNhbWVsQ2FzZShuYW1lLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCAtIDE1KSkpO1xuICAgIH1cbiAgfVxuXG4gIGluaXRpYWxpemUoY29udGFpbmVyLCB0YXJnZXQpIHtcbiAgICB0aGlzLmluc3RhbmNlID0gY29udGFpbmVyLmdldCh0YXJnZXQpO1xuICB9XG5cbiAgcmVnaXN0ZXIocmVnaXN0cnksIG5hbWUpIHtcbiAgICByZWdpc3RyeS5yZWdpc3RlckJpbmRpbmdCZWhhdmlvcihuYW1lIHx8IHRoaXMubmFtZSwgdGhpcy5pbnN0YW5jZSk7XG4gIH1cblxuICBsb2FkKGNvbnRhaW5lciwgdGFyZ2V0KSB7fVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGJpbmRpbmdCZWhhdmlvcihuYW1lT3JUYXJnZXQpIHtcbiAgaWYgKG5hbWVPclRhcmdldCA9PT0gdW5kZWZpbmVkIHx8IHR5cGVvZiBuYW1lT3JUYXJnZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgIG1ldGFkYXRhLmRlZmluZShtZXRhZGF0YS5yZXNvdXJjZSwgbmV3IEJpbmRpbmdCZWhhdmlvclJlc291cmNlKG5hbWVPclRhcmdldCksIHRhcmdldCk7XG4gICAgfTtcbiAgfVxuXG4gIG1ldGFkYXRhLmRlZmluZShtZXRhZGF0YS5yZXNvdXJjZSwgbmV3IEJpbmRpbmdCZWhhdmlvclJlc291cmNlKCksIG5hbWVPclRhcmdldCk7XG59XG5cbmV4cG9ydCBsZXQgTGlzdGVuZXJFeHByZXNzaW9uID0gY2xhc3MgTGlzdGVuZXJFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3IoZXZlbnRNYW5hZ2VyLCB0YXJnZXRFdmVudCwgc291cmNlRXhwcmVzc2lvbiwgZGVsZWdhdGlvblN0cmF0ZWd5LCBwcmV2ZW50RGVmYXVsdCwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXI7XG4gICAgdGhpcy50YXJnZXRFdmVudCA9IHRhcmdldEV2ZW50O1xuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XG4gICAgdGhpcy5kZWxlZ2F0aW9uU3RyYXRlZ3kgPSBkZWxlZ2F0aW9uU3RyYXRlZ3k7XG4gICAgdGhpcy5kaXNjcmV0ZSA9IHRydWU7XG4gICAgdGhpcy5wcmV2ZW50RGVmYXVsdCA9IHByZXZlbnREZWZhdWx0O1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICB9XG5cbiAgY3JlYXRlQmluZGluZyh0YXJnZXQpIHtcbiAgICByZXR1cm4gbmV3IExpc3RlbmVyKHRoaXMuZXZlbnRNYW5hZ2VyLCB0aGlzLnRhcmdldEV2ZW50LCB0aGlzLmRlbGVnYXRpb25TdHJhdGVneSwgdGhpcy5zb3VyY2VFeHByZXNzaW9uLCB0YXJnZXQsIHRoaXMucHJldmVudERlZmF1bHQsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfVxufTtcblxuZXhwb3J0IGxldCBMaXN0ZW5lciA9IGNsYXNzIExpc3RlbmVyIHtcbiAgY29uc3RydWN0b3IoZXZlbnRNYW5hZ2VyLCB0YXJnZXRFdmVudCwgZGVsZWdhdGlvblN0cmF0ZWd5LCBzb3VyY2VFeHByZXNzaW9uLCB0YXJnZXQsIHByZXZlbnREZWZhdWx0LCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICB0aGlzLmV2ZW50TWFuYWdlciA9IGV2ZW50TWFuYWdlcjtcbiAgICB0aGlzLnRhcmdldEV2ZW50ID0gdGFyZ2V0RXZlbnQ7XG4gICAgdGhpcy5kZWxlZ2F0aW9uU3RyYXRlZ3kgPSBkZWxlZ2F0aW9uU3RyYXRlZ3k7XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uID0gc291cmNlRXhwcmVzc2lvbjtcbiAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICB0aGlzLnByZXZlbnREZWZhdWx0ID0gcHJldmVudERlZmF1bHQ7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gIH1cblxuICBjYWxsU291cmNlKGV2ZW50KSB7XG4gICAgbGV0IG92ZXJyaWRlQ29udGV4dCA9IHRoaXMuc291cmNlLm92ZXJyaWRlQ29udGV4dDtcbiAgICBvdmVycmlkZUNvbnRleHQuJGV2ZW50ID0gZXZlbnQ7XG4gICAgbGV0IG11c3RFdmFsdWF0ZSA9IHRydWU7XG4gICAgbGV0IHJlc3VsdCA9IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMsIG11c3RFdmFsdWF0ZSk7XG4gICAgZGVsZXRlIG92ZXJyaWRlQ29udGV4dC4kZXZlbnQ7XG4gICAgaWYgKHJlc3VsdCAhPT0gdHJ1ZSAmJiB0aGlzLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgaGFuZGxlRXZlbnQoZXZlbnQpIHtcbiAgICB0aGlzLmNhbGxTb3VyY2UoZXZlbnQpO1xuICB9XG5cbiAgYmluZChzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXG4gICAgaWYgKHRoaXMuc291cmNlRXhwcmVzc2lvbi5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uYmluZCh0aGlzLCBzb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG4gICAgdGhpcy5faGFuZGxlciA9IHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0RXZlbnQsIHRoaXMsIHRoaXMuZGVsZWdhdGlvblN0cmF0ZWd5LCB0cnVlKTtcbiAgfVxuXG4gIHVuYmluZCgpIHtcbiAgICBpZiAoIXRoaXMuaXNCb3VuZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5zb3VyY2VFeHByZXNzaW9uLnVuYmluZCkge1xuICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLnVuYmluZCh0aGlzLCB0aGlzLnNvdXJjZSk7XG4gICAgfVxuICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICB0aGlzLl9oYW5kbGVyLmRpc3Bvc2UoKTtcbiAgICB0aGlzLl9oYW5kbGVyID0gbnVsbDtcbiAgfVxufTtcblxuZnVuY3Rpb24gZ2V0QVUoZWxlbWVudCkge1xuICBsZXQgYXUgPSBlbGVtZW50LmF1O1xuXG4gIGlmIChhdSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBObyBBdXJlbGlhIEFQSXMgYXJlIGRlZmluZWQgZm9yIHRoZSBlbGVtZW50OiBcIiR7ZWxlbWVudC50YWdOYW1lfVwiLmApO1xuICB9XG5cbiAgcmV0dXJuIGF1O1xufVxuXG5leHBvcnQgbGV0IE5hbWVFeHByZXNzaW9uID0gY2xhc3MgTmFtZUV4cHJlc3Npb24ge1xuICBjb25zdHJ1Y3Rvcihzb3VyY2VFeHByZXNzaW9uLCBhcGlOYW1lLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMuYXBpTmFtZSA9IGFwaU5hbWU7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gICAgdGhpcy5kaXNjcmV0ZSA9IHRydWU7XG4gIH1cblxuICBjcmVhdGVCaW5kaW5nKHRhcmdldCkge1xuICAgIHJldHVybiBuZXcgTmFtZUJpbmRlcih0aGlzLnNvdXJjZUV4cHJlc3Npb24sIE5hbWVFeHByZXNzaW9uLmxvY2F0ZUFQSSh0YXJnZXQsIHRoaXMuYXBpTmFtZSksIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIHN0YXRpYyBsb2NhdGVBUEkoZWxlbWVudCwgYXBpTmFtZSkge1xuICAgIHN3aXRjaCAoYXBpTmFtZSkge1xuICAgICAgY2FzZSAnZWxlbWVudCc6XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgY2FzZSAnY29udHJvbGxlcic6XG4gICAgICAgIHJldHVybiBnZXRBVShlbGVtZW50KS5jb250cm9sbGVyO1xuICAgICAgY2FzZSAndmlldy1tb2RlbCc6XG4gICAgICAgIHJldHVybiBnZXRBVShlbGVtZW50KS5jb250cm9sbGVyLnZpZXdNb2RlbDtcbiAgICAgIGNhc2UgJ3ZpZXcnOlxuICAgICAgICByZXR1cm4gZ2V0QVUoZWxlbWVudCkuY29udHJvbGxlci52aWV3O1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgbGV0IHRhcmdldCA9IGdldEFVKGVsZW1lbnQpW2FwaU5hbWVdO1xuXG4gICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQXR0ZW1wdGVkIHRvIHJlZmVyZW5jZSBcIiR7YXBpTmFtZX1cIiwgYnV0IGl0IHdhcyBub3QgZm91bmQgYW1vbmdzdCB0aGUgdGFyZ2V0J3MgQVBJLmApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldC52aWV3TW9kZWw7XG4gICAgfVxuICB9XG59O1xuXG5sZXQgTmFtZUJpbmRlciA9IGNsYXNzIE5hbWVCaW5kZXIge1xuICBjb25zdHJ1Y3Rvcihzb3VyY2VFeHByZXNzaW9uLCB0YXJnZXQsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gIH1cblxuICBiaW5kKHNvdXJjZSkge1xuICAgIGlmICh0aGlzLmlzQm91bmQpIHtcbiAgICAgIGlmICh0aGlzLnNvdXJjZSA9PT0gc291cmNlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMudW5iaW5kKCk7XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IHRydWU7XG4gICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgaWYgKHRoaXMuc291cmNlRXhwcmVzc2lvbi5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uYmluZCh0aGlzLCBzb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmFzc2lnbih0aGlzLnNvdXJjZSwgdGhpcy50YXJnZXQsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIHVuYmluZCgpIHtcbiAgICBpZiAoIXRoaXMuaXNCb3VuZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucykgPT09IHRoaXMudGFyZ2V0KSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uYXNzaWduKHRoaXMuc291cmNlLCBudWxsLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgfVxuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICB9XG59O1xuXG5cbmNvbnN0IExvb2t1cEZ1bmN0aW9ucyA9IHtcbiAgYmluZGluZ0JlaGF2aW9yczogbmFtZSA9PiBudWxsLFxuICB2YWx1ZUNvbnZlcnRlcnM6IG5hbWUgPT4gbnVsbFxufTtcblxuZXhwb3J0IGxldCBCaW5kaW5nRW5naW5lID0gKF90ZW1wMiA9IF9jbGFzczEzID0gY2xhc3MgQmluZGluZ0VuZ2luZSB7XG5cbiAgY29uc3RydWN0b3Iob2JzZXJ2ZXJMb2NhdG9yLCBwYXJzZXIpIHtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnBhcnNlciA9IHBhcnNlcjtcbiAgfVxuXG4gIGNyZWF0ZUJpbmRpbmdFeHByZXNzaW9uKHRhcmdldFByb3BlcnR5LCBzb3VyY2VFeHByZXNzaW9uLCBtb2RlID0gYmluZGluZ01vZGUudG9WaWV3LCBsb29rdXBGdW5jdGlvbnMgPSBMb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IEJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0YXJnZXRQcm9wZXJ0eSwgdGhpcy5wYXJzZXIucGFyc2Uoc291cmNlRXhwcmVzc2lvbiksIG1vZGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gIH1cblxuICBwcm9wZXJ0eU9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1YnNjcmliZTogY2FsbGJhY2sgPT4ge1xuICAgICAgICBsZXQgb2JzZXJ2ZXIgPSB0aGlzLm9ic2VydmVyTG9jYXRvci5nZXRPYnNlcnZlcihvYmosIHByb3BlcnR5TmFtZSk7XG4gICAgICAgIG9ic2VydmVyLnN1YnNjcmliZShjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGlzcG9zZTogKCkgPT4gb2JzZXJ2ZXIudW5zdWJzY3JpYmUoY2FsbGJhY2spXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIGNvbGxlY3Rpb25PYnNlcnZlcihjb2xsZWN0aW9uKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1YnNjcmliZTogY2FsbGJhY2sgPT4ge1xuICAgICAgICBsZXQgb2JzZXJ2ZXI7XG4gICAgICAgIGlmIChjb2xsZWN0aW9uIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICBvYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXJMb2NhdG9yLmdldEFycmF5T2JzZXJ2ZXIoY29sbGVjdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAoY29sbGVjdGlvbiBpbnN0YW5jZW9mIE1hcCkge1xuICAgICAgICAgIG9ic2VydmVyID0gdGhpcy5vYnNlcnZlckxvY2F0b3IuZ2V0TWFwT2JzZXJ2ZXIoY29sbGVjdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAoY29sbGVjdGlvbiBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgICAgIG9ic2VydmVyID0gdGhpcy5vYnNlcnZlckxvY2F0b3IuZ2V0U2V0T2JzZXJ2ZXIoY29sbGVjdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb2xsZWN0aW9uIG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgQXJyYXksIE1hcCBvciBTZXQuJyk7XG4gICAgICAgIH1cbiAgICAgICAgb2JzZXJ2ZXIuc3Vic2NyaWJlKGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkaXNwb3NlOiAoKSA9PiBvYnNlcnZlci51bnN1YnNjcmliZShjYWxsYmFjaylcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgZXhwcmVzc2lvbk9ic2VydmVyKGJpbmRpbmdDb250ZXh0LCBleHByZXNzaW9uKSB7XG4gICAgbGV0IHNjb3BlID0geyBiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0OiBjcmVhdGVPdmVycmlkZUNvbnRleHQoYmluZGluZ0NvbnRleHQpIH07XG4gICAgcmV0dXJuIG5ldyBFeHByZXNzaW9uT2JzZXJ2ZXIoc2NvcGUsIHRoaXMucGFyc2VyLnBhcnNlKGV4cHJlc3Npb24pLCB0aGlzLm9ic2VydmVyTG9jYXRvciwgTG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIHBhcnNlRXhwcmVzc2lvbihleHByZXNzaW9uKSB7XG4gICAgcmV0dXJuIHRoaXMucGFyc2VyLnBhcnNlKGV4cHJlc3Npb24pO1xuICB9XG5cbiAgcmVnaXN0ZXJBZGFwdGVyKGFkYXB0ZXIpIHtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvci5hZGRBZGFwdGVyKGFkYXB0ZXIpO1xuICB9XG59LCBfY2xhc3MxMy5pbmplY3QgPSBbT2JzZXJ2ZXJMb2NhdG9yLCBQYXJzZXJdLCBfdGVtcDIpO1xuXG5sZXQgc2V0UHJvdG8gPSBTZXQucHJvdG90eXBlO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2V0T2JzZXJ2ZXIodGFza1F1ZXVlLCBzZXQpIHtcbiAgcmV0dXJuIE1vZGlmeVNldE9ic2VydmVyLmZvcih0YXNrUXVldWUsIHNldCk7XG59XG5cbmxldCBNb2RpZnlTZXRPYnNlcnZlciA9IGNsYXNzIE1vZGlmeVNldE9ic2VydmVyIGV4dGVuZHMgTW9kaWZ5Q29sbGVjdGlvbk9ic2VydmVyIHtcbiAgY29uc3RydWN0b3IodGFza1F1ZXVlLCBzZXQpIHtcbiAgICBzdXBlcih0YXNrUXVldWUsIHNldCk7XG4gIH1cblxuICBzdGF0aWMgZm9yKHRhc2tRdWV1ZSwgc2V0KSB7XG4gICAgaWYgKCEoJ19fc2V0X29ic2VydmVyX18nIGluIHNldCkpIHtcbiAgICAgIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkoc2V0LCAnX19zZXRfb2JzZXJ2ZXJfXycsIHtcbiAgICAgICAgdmFsdWU6IE1vZGlmeVNldE9ic2VydmVyLmNyZWF0ZSh0YXNrUXVldWUsIHNldCksXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLCBjb25maWd1cmFibGU6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHNldC5fX3NldF9vYnNlcnZlcl9fO1xuICB9XG5cbiAgc3RhdGljIGNyZWF0ZSh0YXNrUXVldWUsIHNldCkge1xuICAgIGxldCBvYnNlcnZlciA9IG5ldyBNb2RpZnlTZXRPYnNlcnZlcih0YXNrUXVldWUsIHNldCk7XG5cbiAgICBsZXQgcHJvdG8gPSBzZXRQcm90bztcbiAgICBpZiAocHJvdG8uYWRkICE9PSBzZXQuYWRkIHx8IHByb3RvLmRlbGV0ZSAhPT0gc2V0LmRlbGV0ZSB8fCBwcm90by5jbGVhciAhPT0gc2V0LmNsZWFyKSB7XG4gICAgICBwcm90byA9IHtcbiAgICAgICAgYWRkOiBzZXQuYWRkLFxuICAgICAgICBkZWxldGU6IHNldC5kZWxldGUsXG4gICAgICAgIGNsZWFyOiBzZXQuY2xlYXJcbiAgICAgIH07XG4gICAgfVxuXG4gICAgc2V0LmFkZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB0eXBlID0gJ2FkZCc7XG4gICAgICBsZXQgb2xkU2l6ZSA9IHNldC5zaXplO1xuICAgICAgbGV0IG1ldGhvZENhbGxSZXN1bHQgPSBwcm90by5hZGQuYXBwbHkoc2V0LCBhcmd1bWVudHMpO1xuICAgICAgbGV0IGhhc1ZhbHVlID0gc2V0LnNpemUgPT09IG9sZFNpemU7XG4gICAgICBpZiAoIWhhc1ZhbHVlKSB7XG4gICAgICAgIG9ic2VydmVyLmFkZENoYW5nZVJlY29yZCh7XG4gICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICBvYmplY3Q6IHNldCxcbiAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbShzZXQpLnBvcCgpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIHNldC5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgaGFzVmFsdWUgPSBzZXQuaGFzKGFyZ3VtZW50c1swXSk7XG4gICAgICBsZXQgbWV0aG9kQ2FsbFJlc3VsdCA9IHByb3RvLmRlbGV0ZS5hcHBseShzZXQsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAoaGFzVmFsdWUpIHtcbiAgICAgICAgb2JzZXJ2ZXIuYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgICB0eXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICBvYmplY3Q6IHNldCxcbiAgICAgICAgICB2YWx1ZTogYXJndW1lbnRzWzBdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIHNldC5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBtZXRob2RDYWxsUmVzdWx0ID0gcHJvdG8uY2xlYXIuYXBwbHkoc2V0LCBhcmd1bWVudHMpO1xuICAgICAgb2JzZXJ2ZXIuYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgdHlwZTogJ2NsZWFyJyxcbiAgICAgICAgb2JqZWN0OiBzZXRcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIHJldHVybiBvYnNlcnZlcjtcbiAgfVxufTtcblxuXG5leHBvcnQgZnVuY3Rpb24gb2JzZXJ2YWJsZSh0YXJnZXRPckNvbmZpZywga2V5LCBkZXNjcmlwdG9yKSB7XG4gIGZ1bmN0aW9uIGRlY28odGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IsIGNvbmZpZykge1xuICAgIGNvbnN0IGlzQ2xhc3NEZWNvcmF0b3IgPSBrZXkgPT09IHVuZGVmaW5lZDtcbiAgICBpZiAoaXNDbGFzc0RlY29yYXRvcikge1xuICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnByb3RvdHlwZTtcbiAgICAgIGtleSA9IHR5cGVvZiBjb25maWcgPT09ICdzdHJpbmcnID8gY29uZmlnIDogY29uZmlnLm5hbWU7XG4gICAgfVxuXG4gICAgbGV0IGlubmVyUHJvcGVydHlOYW1lID0gYF8ke2tleX1gO1xuICAgIGNvbnN0IGlubmVyUHJvcGVydHlEZXNjcmlwdG9yID0ge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH07XG5cbiAgICBjb25zdCBjYWxsYmFja05hbWUgPSBjb25maWcgJiYgY29uZmlnLmNoYW5nZUhhbmRsZXIgfHwgYCR7a2V5fUNoYW5nZWRgO1xuXG4gICAgaWYgKGRlc2NyaXB0b3IpIHtcbiAgICAgIGlmICh0eXBlb2YgZGVzY3JpcHRvci5pbml0aWFsaXplciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBpbm5lclByb3BlcnR5RGVzY3JpcHRvci52YWx1ZSA9IGRlc2NyaXB0b3IuaW5pdGlhbGl6ZXIoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZGVzY3JpcHRvciA9IHt9O1xuICAgIH1cblxuICAgIGlmICghKCdlbnVtZXJhYmxlJyBpbiBkZXNjcmlwdG9yKSkge1xuICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBkZWxldGUgZGVzY3JpcHRvci52YWx1ZTtcbiAgICBkZWxldGUgZGVzY3JpcHRvci53cml0YWJsZTtcbiAgICBkZWxldGUgZGVzY3JpcHRvci5pbml0aWFsaXplcjtcblxuICAgIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBpbm5lclByb3BlcnR5TmFtZSwgaW5uZXJQcm9wZXJ0eURlc2NyaXB0b3IpO1xuXG4gICAgZGVzY3JpcHRvci5nZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpc1tpbm5lclByb3BlcnR5TmFtZV07XG4gICAgfTtcbiAgICBkZXNjcmlwdG9yLnNldCA9IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgbGV0IG9sZFZhbHVlID0gdGhpc1tpbm5lclByb3BlcnR5TmFtZV07XG4gICAgICBpZiAobmV3VmFsdWUgPT09IG9sZFZhbHVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpc1tpbm5lclByb3BlcnR5TmFtZV0gPSBuZXdWYWx1ZTtcbiAgICAgIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkodGhpcywgaW5uZXJQcm9wZXJ0eU5hbWUsIHsgZW51bWVyYWJsZTogZmFsc2UgfSk7XG5cbiAgICAgIGlmICh0aGlzW2NhbGxiYWNrTmFtZV0pIHtcbiAgICAgICAgdGhpc1tjYWxsYmFja05hbWVdKG5ld1ZhbHVlLCBvbGRWYWx1ZSwga2V5KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZGVzY3JpcHRvci5nZXQuZGVwZW5kZW5jaWVzID0gW2lubmVyUHJvcGVydHlOYW1lXTtcblxuICAgIGlmIChpc0NsYXNzRGVjb3JhdG9yKSB7XG4gICAgICBSZWZsZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gICAgfVxuICB9XG5cbiAgaWYgKGtleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuICh0LCBrLCBkKSA9PiBkZWNvKHQsIGssIGQsIHRhcmdldE9yQ29uZmlnKTtcbiAgfVxuICByZXR1cm4gZGVjbyh0YXJnZXRPckNvbmZpZywga2V5LCBkZXNjcmlwdG9yKTtcbn1cblxuY29uc3Qgc2lnbmFscyA9IHt9O1xuXG5leHBvcnQgZnVuY3Rpb24gY29ubmVjdEJpbmRpbmdUb1NpZ25hbChiaW5kaW5nLCBuYW1lKSB7XG4gIGlmICghc2lnbmFscy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgIHNpZ25hbHNbbmFtZV0gPSAwO1xuICB9XG4gIGJpbmRpbmcub2JzZXJ2ZVByb3BlcnR5KHNpZ25hbHMsIG5hbWUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2lnbmFsQmluZGluZ3MobmFtZSkge1xuICBpZiAoc2lnbmFscy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgIHNpZ25hbHNbbmFtZV0rKztcbiAgfVxufSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/aurelia-binding/dist/es2015/aurelia-binding.js\n");

/***/ }),

/***/ "./node_modules/aurelia-bootstrapper/dist/es2015/aurelia-bootstrapper.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/aurelia-bootstrapper/dist/es2015/aurelia-bootstrapper.js ***!
  \*******************************************************************************/
/*! exports provided: bootstrap, starting */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(process) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bootstrap\", function() { return bootstrap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"starting\", function() { return starting; });\n/* harmony import */ var aurelia_polyfills__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-polyfills */ \"./node_modules/aurelia-polyfills/dist/es2015/aurelia-polyfills.js\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n\n\n\nlet bootstrapPromises = [];\nlet startResolve;\n\nconst startPromise = new Promise(resolve => startResolve = resolve);\nconst host = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].global;\nconst isNodeLike = typeof process !== 'undefined' && !process.browser;\n\nfunction ready() {\n  if (!host.document || host.document.readyState === 'complete') {\n    return Promise.resolve();\n  }\n\n  return new Promise(resolve => {\n    host.document.addEventListener('DOMContentLoaded', completed);\n    host.addEventListener('load', completed);\n\n    function completed() {\n      host.document.removeEventListener('DOMContentLoaded', completed);\n      host.removeEventListener('load', completed);\n      resolve();\n    }\n  });\n}\n\nfunction createLoader() {\n  if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].Loader) {\n    return Promise.resolve(new aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].Loader());\n  }\n\n  if (false) {}\n\n  return Promise.reject('No PLATFORM.Loader is defined and there is neither a System API (ES6) or a Require API (AMD) globally available to load your app.');\n}\n\nfunction initializePal(loader) {\n  if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"isInitialized\"]) return Promise.resolve();\n\n  let type;\n\n  const isRenderer = isNodeLike && (process.type === 'renderer' || process.versions['node-webkit']);\n\n  if (isNodeLike && !isRenderer) {\n    type = 'nodejs';\n  } else if (typeof window !== 'undefined') {\n    type = 'browser';\n  } else if (typeof self !== 'undefined') {\n    type = 'worker';\n  } else {\n    throw new Error('Could not determine platform implementation to load.');\n  }\n\n  return loader.loadModule('aurelia-pal-' + type).then(palModule => type === 'nodejs' && !aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"isInitialized\"] && palModule.globalize() || palModule.initialize());\n}\n\nfunction preparePlatform(loader) {\n  const map = (moduleId, relativeTo) => loader.normalize(moduleId, relativeTo).then(normalized => {\n    loader.map(moduleId, normalized);\n    return normalized;\n  });\n\n  return initializePal(loader).then(() => loader.normalize('aurelia-bootstrapper')).then(bootstrapperName => {\n    const frameworkPromise = map('aurelia-framework', bootstrapperName);\n\n    return Promise.all([frameworkPromise, frameworkPromise.then(frameworkName => map('aurelia-dependency-injection', frameworkName)), map('aurelia-router', bootstrapperName), map('aurelia-logging-console', bootstrapperName)]);\n  }).then(([frameworkName]) => loader.loadModule(frameworkName)).then(fx => startResolve(() => new fx.Aurelia(loader)));\n}\n\nfunction config(appHost, configModuleId, aurelia) {\n  aurelia.host = appHost;\n  aurelia.configModuleId = configModuleId || null;\n\n  if (configModuleId) {\n    return aurelia.loader.loadModule(configModuleId).then(customConfig => {\n      if (!customConfig.configure) {\n        throw new Error(`Cannot initialize module '${configModuleId}' without a configure function.`);\n      }\n\n      return customConfig.configure(aurelia);\n    });\n  }\n\n  aurelia.use.standardConfiguration().developmentLogging();\n\n  return aurelia.start().then(() => aurelia.setRoot());\n}\n\nfunction run() {\n  return ready().then(createLoader).then(preparePlatform).then(() => {\n    const appHosts = host.document.querySelectorAll('[aurelia-app],[data-aurelia-app]');\n    for (let i = 0, ii = appHosts.length; i < ii; ++i) {\n      const appHost = appHosts[i];\n      const moduleId = appHost.getAttribute('aurelia-app') || appHost.getAttribute('data-aurelia-app');\n      bootstrap(config.bind(null, appHost, moduleId));\n    }\n\n    const toConsole = console.error.bind(console);\n    const bootstraps = bootstrapPromises.map(p => p.catch(toConsole));\n    bootstrapPromises = null;\n    return Promise.all(bootstraps);\n  });\n}\n\nfunction bootstrap(configure) {\n  const p = startPromise.then(factory => configure(factory()));\n  if (bootstrapPromises) bootstrapPromises.push(p);\n  return p;\n}\n\nconst starting = run();\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../process/browser.js */ \"./node_modules/process/browser.js\")))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1ib290c3RyYXBwZXIvZGlzdC9lczIwMTUvYXVyZWxpYS1ib290c3RyYXBwZXIuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1ib290c3RyYXBwZXIvZGlzdC9lczIwMTUvYXVyZWxpYS1ib290c3RyYXBwZXIuanM/MTk1OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJ2F1cmVsaWEtcG9seWZpbGxzJztcbmltcG9ydCB7IFBMQVRGT1JNLCBpc0luaXRpYWxpemVkIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuXG5sZXQgYm9vdHN0cmFwUHJvbWlzZXMgPSBbXTtcbmxldCBzdGFydFJlc29sdmU7XG5cbmNvbnN0IHN0YXJ0UHJvbWlzZSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc3RhcnRSZXNvbHZlID0gcmVzb2x2ZSk7XG5jb25zdCBob3N0ID0gUExBVEZPUk0uZ2xvYmFsO1xuY29uc3QgaXNOb2RlTGlrZSA9IHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiAhcHJvY2Vzcy5icm93c2VyO1xuXG5mdW5jdGlvbiByZWFkeSgpIHtcbiAgaWYgKCFob3N0LmRvY3VtZW50IHx8IGhvc3QuZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJykge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICBob3N0LmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBjb21wbGV0ZWQpO1xuICAgIGhvc3QuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGNvbXBsZXRlZCk7XG5cbiAgICBmdW5jdGlvbiBjb21wbGV0ZWQoKSB7XG4gICAgICBob3N0LmRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBjb21wbGV0ZWQpO1xuICAgICAgaG9zdC5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgY29tcGxldGVkKTtcbiAgICAgIHJlc29sdmUoKTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVMb2FkZXIoKSB7XG4gIGlmIChQTEFURk9STS5Mb2FkZXIpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBQTEFURk9STS5Mb2FkZXIoKSk7XG4gIH1cblxuICBpZiAodHlwZW9mIEFVUkVMSUFfV0VCUEFDS18yXzAgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKHR5cGVvZiBfX3dlYnBhY2tfcmVxdWlyZV9fICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgY29uc3QgbSA9IF9fd2VicGFja19yZXF1aXJlX18ocmVxdWlyZS5yZXNvbHZlKCdhdXJlbGlhLWxvYWRlci13ZWJwYWNrJykpO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgbS5XZWJwYWNrTG9hZGVyKCkpO1xuICAgIH1cblxuICAgIGlmIChob3N0LlN5c3RlbSAmJiB0eXBlb2YgaG9zdC5TeXN0ZW0uY29uZmlnID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gaG9zdC5TeXN0ZW0ubm9ybWFsaXplKCdhdXJlbGlhLWJvb3RzdHJhcHBlcicpLnRoZW4oYnNuID0+IHtcbiAgICAgICAgcmV0dXJuIGhvc3QuU3lzdGVtLm5vcm1hbGl6ZSgnYXVyZWxpYS1sb2FkZXItZGVmYXVsdCcsIGJzbik7XG4gICAgICB9KS50aGVuKGxvYWRlck5hbWUgPT4ge1xuICAgICAgICByZXR1cm4gaG9zdC5TeXN0ZW0uaW1wb3J0KGxvYWRlck5hbWUpLnRoZW4obSA9PiBuZXcgbS5EZWZhdWx0TG9hZGVyKCkpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBob3N0LnJlcXVpcmUgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGhvc3QuZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBob3N0LmRlZmluZS5hbWQgPT09ICdvYmplY3QnKSB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gaG9zdC5yZXF1aXJlKFsnYXVyZWxpYS1sb2FkZXItZGVmYXVsdCddLCBtID0+IHJlc29sdmUobmV3IG0uRGVmYXVsdExvYWRlcigpKSwgcmVqZWN0KSk7XG4gICAgfVxuXG4gICAgaWYgKGlzTm9kZUxpa2UgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIG1vZHVsZS5yZXF1aXJlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgY29uc3QgbSA9IG1vZHVsZS5yZXF1aXJlKCdhdXJlbGlhLWxvYWRlci1ub2RlanMnKTtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IG0uTm9kZUpzTG9hZGVyKCkpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBQcm9taXNlLnJlamVjdCgnTm8gUExBVEZPUk0uTG9hZGVyIGlzIGRlZmluZWQgYW5kIHRoZXJlIGlzIG5laXRoZXIgYSBTeXN0ZW0gQVBJIChFUzYpIG9yIGEgUmVxdWlyZSBBUEkgKEFNRCkgZ2xvYmFsbHkgYXZhaWxhYmxlIHRvIGxvYWQgeW91ciBhcHAuJyk7XG59XG5cbmZ1bmN0aW9uIGluaXRpYWxpemVQYWwobG9hZGVyKSB7XG4gIGlmIChpc0luaXRpYWxpemVkKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cbiAgbGV0IHR5cGU7XG5cbiAgY29uc3QgaXNSZW5kZXJlciA9IGlzTm9kZUxpa2UgJiYgKHByb2Nlc3MudHlwZSA9PT0gJ3JlbmRlcmVyJyB8fCBwcm9jZXNzLnZlcnNpb25zWydub2RlLXdlYmtpdCddKTtcblxuICBpZiAoaXNOb2RlTGlrZSAmJiAhaXNSZW5kZXJlcikge1xuICAgIHR5cGUgPSAnbm9kZWpzJztcbiAgfSBlbHNlIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIHR5cGUgPSAnYnJvd3Nlcic7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdHlwZSA9ICd3b3JrZXInO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGRldGVybWluZSBwbGF0Zm9ybSBpbXBsZW1lbnRhdGlvbiB0byBsb2FkLicpO1xuICB9XG5cbiAgcmV0dXJuIGxvYWRlci5sb2FkTW9kdWxlKCdhdXJlbGlhLXBhbC0nICsgdHlwZSkudGhlbihwYWxNb2R1bGUgPT4gdHlwZSA9PT0gJ25vZGVqcycgJiYgIWlzSW5pdGlhbGl6ZWQgJiYgcGFsTW9kdWxlLmdsb2JhbGl6ZSgpIHx8IHBhbE1vZHVsZS5pbml0aWFsaXplKCkpO1xufVxuXG5mdW5jdGlvbiBwcmVwYXJlUGxhdGZvcm0obG9hZGVyKSB7XG4gIGNvbnN0IG1hcCA9IChtb2R1bGVJZCwgcmVsYXRpdmVUbykgPT4gbG9hZGVyLm5vcm1hbGl6ZShtb2R1bGVJZCwgcmVsYXRpdmVUbykudGhlbihub3JtYWxpemVkID0+IHtcbiAgICBsb2FkZXIubWFwKG1vZHVsZUlkLCBub3JtYWxpemVkKTtcbiAgICByZXR1cm4gbm9ybWFsaXplZDtcbiAgfSk7XG5cbiAgcmV0dXJuIGluaXRpYWxpemVQYWwobG9hZGVyKS50aGVuKCgpID0+IGxvYWRlci5ub3JtYWxpemUoJ2F1cmVsaWEtYm9vdHN0cmFwcGVyJykpLnRoZW4oYm9vdHN0cmFwcGVyTmFtZSA9PiB7XG4gICAgY29uc3QgZnJhbWV3b3JrUHJvbWlzZSA9IG1hcChQTEFURk9STS5tb2R1bGVOYW1lKCdhdXJlbGlhLWZyYW1ld29yaycsIHsgZXhwb3J0czogWydBdXJlbGlhJ10gfSksIGJvb3RzdHJhcHBlck5hbWUpO1xuXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtmcmFtZXdvcmtQcm9taXNlLCBmcmFtZXdvcmtQcm9taXNlLnRoZW4oZnJhbWV3b3JrTmFtZSA9PiBtYXAoJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nLCBmcmFtZXdvcmtOYW1lKSksIG1hcCgnYXVyZWxpYS1yb3V0ZXInLCBib290c3RyYXBwZXJOYW1lKSwgbWFwKCdhdXJlbGlhLWxvZ2dpbmctY29uc29sZScsIGJvb3RzdHJhcHBlck5hbWUpXSk7XG4gIH0pLnRoZW4oKFtmcmFtZXdvcmtOYW1lXSkgPT4gbG9hZGVyLmxvYWRNb2R1bGUoZnJhbWV3b3JrTmFtZSkpLnRoZW4oZnggPT4gc3RhcnRSZXNvbHZlKCgpID0+IG5ldyBmeC5BdXJlbGlhKGxvYWRlcikpKTtcbn1cblxuZnVuY3Rpb24gY29uZmlnKGFwcEhvc3QsIGNvbmZpZ01vZHVsZUlkLCBhdXJlbGlhKSB7XG4gIGF1cmVsaWEuaG9zdCA9IGFwcEhvc3Q7XG4gIGF1cmVsaWEuY29uZmlnTW9kdWxlSWQgPSBjb25maWdNb2R1bGVJZCB8fCBudWxsO1xuXG4gIGlmIChjb25maWdNb2R1bGVJZCkge1xuICAgIHJldHVybiBhdXJlbGlhLmxvYWRlci5sb2FkTW9kdWxlKGNvbmZpZ01vZHVsZUlkKS50aGVuKGN1c3RvbUNvbmZpZyA9PiB7XG4gICAgICBpZiAoIWN1c3RvbUNvbmZpZy5jb25maWd1cmUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgaW5pdGlhbGl6ZSBtb2R1bGUgJyR7Y29uZmlnTW9kdWxlSWR9JyB3aXRob3V0IGEgY29uZmlndXJlIGZ1bmN0aW9uLmApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY3VzdG9tQ29uZmlnLmNvbmZpZ3VyZShhdXJlbGlhKTtcbiAgICB9KTtcbiAgfVxuXG4gIGF1cmVsaWEudXNlLnN0YW5kYXJkQ29uZmlndXJhdGlvbigpLmRldmVsb3BtZW50TG9nZ2luZygpO1xuXG4gIHJldHVybiBhdXJlbGlhLnN0YXJ0KCkudGhlbigoKSA9PiBhdXJlbGlhLnNldFJvb3QoKSk7XG59XG5cbmZ1bmN0aW9uIHJ1bigpIHtcbiAgcmV0dXJuIHJlYWR5KCkudGhlbihjcmVhdGVMb2FkZXIpLnRoZW4ocHJlcGFyZVBsYXRmb3JtKS50aGVuKCgpID0+IHtcbiAgICBjb25zdCBhcHBIb3N0cyA9IGhvc3QuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2F1cmVsaWEtYXBwXSxbZGF0YS1hdXJlbGlhLWFwcF0nKTtcbiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBhcHBIb3N0cy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjb25zdCBhcHBIb3N0ID0gYXBwSG9zdHNbaV07XG4gICAgICBjb25zdCBtb2R1bGVJZCA9IGFwcEhvc3QuZ2V0QXR0cmlidXRlKCdhdXJlbGlhLWFwcCcpIHx8IGFwcEhvc3QuZ2V0QXR0cmlidXRlKCdkYXRhLWF1cmVsaWEtYXBwJyk7XG4gICAgICBib290c3RyYXAoY29uZmlnLmJpbmQobnVsbCwgYXBwSG9zdCwgbW9kdWxlSWQpKTtcbiAgICB9XG5cbiAgICBjb25zdCB0b0NvbnNvbGUgPSBjb25zb2xlLmVycm9yLmJpbmQoY29uc29sZSk7XG4gICAgY29uc3QgYm9vdHN0cmFwcyA9IGJvb3RzdHJhcFByb21pc2VzLm1hcChwID0+IHAuY2F0Y2godG9Db25zb2xlKSk7XG4gICAgYm9vdHN0cmFwUHJvbWlzZXMgPSBudWxsO1xuICAgIHJldHVybiBQcm9taXNlLmFsbChib290c3RyYXBzKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBib290c3RyYXAoY29uZmlndXJlKSB7XG4gIGNvbnN0IHAgPSBzdGFydFByb21pc2UudGhlbihmYWN0b3J5ID0+IGNvbmZpZ3VyZShmYWN0b3J5KCkpKTtcbiAgaWYgKGJvb3RzdHJhcFByb21pc2VzKSBib290c3RyYXBQcm9taXNlcy5wdXNoKHApO1xuICByZXR1cm4gcDtcbn1cblxuZXhwb3J0IGNvbnN0IHN0YXJ0aW5nID0gcnVuKCk7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBc0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/aurelia-bootstrapper/dist/es2015/aurelia-bootstrapper.js\n");

/***/ }),

/***/ "./node_modules/aurelia-dependency-injection/dist/es2015/aurelia-dependency-injection.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/aurelia-dependency-injection/dist/es2015/aurelia-dependency-injection.js ***!
  \***********************************************************************************************/
/*! exports provided: resolver, StrategyResolver, Lazy, All, Optional, Parent, Factory, NewInstance, getDecoratorDependencies, lazy, all, optional, parent, factory, newInstance, invoker, invokeAsFactory, FactoryInvoker, registration, transient, singleton, TransientRegistration, SingletonRegistration, _emptyParameters, InvocationHandler, Container, autoinject, inject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"resolver\", function() { return resolver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StrategyResolver\", function() { return StrategyResolver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Lazy\", function() { return Lazy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"All\", function() { return All; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Optional\", function() { return Optional; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Parent\", function() { return Parent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Factory\", function() { return Factory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NewInstance\", function() { return NewInstance; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getDecoratorDependencies\", function() { return getDecoratorDependencies; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lazy\", function() { return lazy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"all\", function() { return all; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"optional\", function() { return optional; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"parent\", function() { return parent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"factory\", function() { return factory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"newInstance\", function() { return newInstance; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"invoker\", function() { return invoker; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"invokeAsFactory\", function() { return invokeAsFactory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FactoryInvoker\", function() { return FactoryInvoker; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"registration\", function() { return registration; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"transient\", function() { return transient; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"singleton\", function() { return singleton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TransientRegistration\", function() { return TransientRegistration; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SingletonRegistration\", function() { return SingletonRegistration; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_emptyParameters\", function() { return _emptyParameters; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InvocationHandler\", function() { return InvocationHandler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Container\", function() { return Container; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"autoinject\", function() { return autoinject; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"inject\", function() { return inject; });\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-metadata */ \"./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\nvar _dec, _class, _dec2, _class2, _dec3, _class3, _dec4, _class4, _dec5, _class5, _dec6, _class6, _dec7, _class7;\n\n\n\n\nconst resolver = aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"protocol\"].create('aurelia:resolver', function (target) {\n  if (!(typeof target.get === 'function')) {\n    return 'Resolvers must implement: get(container: Container, key: any): any';\n  }\n\n  return true;\n});\n\nlet StrategyResolver = (_dec = resolver(), _dec(_class = class StrategyResolver {\n  constructor(strategy, state) {\n    this.strategy = strategy;\n    this.state = state;\n  }\n\n  get(container, key) {\n    switch (this.strategy) {\n      case 0:\n        return this.state;\n      case 1:\n        let singleton = container.invoke(this.state);\n        this.state = singleton;\n        this.strategy = 0;\n        return singleton;\n      case 2:\n        return container.invoke(this.state);\n      case 3:\n        return this.state(container, key, this);\n      case 4:\n        return this.state[0].get(container, key);\n      case 5:\n        return container.get(this.state);\n      default:\n        throw new Error('Invalid strategy: ' + this.strategy);\n    }\n  }\n}) || _class);\n\nlet Lazy = (_dec2 = resolver(), _dec2(_class2 = class Lazy {\n  constructor(key) {\n    this._key = key;\n  }\n\n  get(container) {\n    return () => container.get(this._key);\n  }\n\n  static of(key) {\n    return new Lazy(key);\n  }\n}) || _class2);\n\nlet All = (_dec3 = resolver(), _dec3(_class3 = class All {\n  constructor(key) {\n    this._key = key;\n  }\n\n  get(container) {\n    return container.getAll(this._key);\n  }\n\n  static of(key) {\n    return new All(key);\n  }\n}) || _class3);\n\nlet Optional = (_dec4 = resolver(), _dec4(_class4 = class Optional {\n  constructor(key, checkParent = true) {\n    this._key = key;\n    this._checkParent = checkParent;\n  }\n\n  get(container) {\n    if (container.hasResolver(this._key, this._checkParent)) {\n      return container.get(this._key);\n    }\n\n    return null;\n  }\n\n  static of(key, checkParent = true) {\n    return new Optional(key, checkParent);\n  }\n}) || _class4);\n\nlet Parent = (_dec5 = resolver(), _dec5(_class5 = class Parent {\n  constructor(key) {\n    this._key = key;\n  }\n\n  get(container) {\n    return container.parent ? container.parent.get(this._key) : null;\n  }\n\n  static of(key) {\n    return new Parent(key);\n  }\n}) || _class5);\n\nlet Factory = (_dec6 = resolver(), _dec6(_class6 = class Factory {\n  constructor(key) {\n    this._key = key;\n  }\n\n  get(container) {\n    let fn = this._key;\n    let resolver = container.getResolver(fn);\n    if (resolver && resolver.strategy === 3) {\n      fn = resolver.state;\n    }\n\n    return (...rest) => container.invoke(fn, rest);\n  }\n\n  static of(key) {\n    return new Factory(key);\n  }\n}) || _class6);\n\nlet NewInstance = (_dec7 = resolver(), _dec7(_class7 = class NewInstance {\n  constructor(key, ...dynamicDependencies) {\n    this.key = key;\n    this.asKey = key;\n    this.dynamicDependencies = dynamicDependencies;\n  }\n\n  get(container) {\n    let dynamicDependencies = this.dynamicDependencies.length > 0 ? this.dynamicDependencies.map(dependency => dependency['protocol:aurelia:resolver'] ? dependency.get(container) : container.get(dependency)) : undefined;\n\n    let fn = this.key;\n    let resolver = container.getResolver(fn);\n    if (resolver && resolver.strategy === 3) {\n      fn = resolver.state;\n    }\n\n    const instance = container.invoke(fn, dynamicDependencies);\n    container.registerInstance(this.asKey, instance);\n    return instance;\n  }\n\n  as(key) {\n    this.asKey = key;\n    return this;\n  }\n\n  static of(key, ...dynamicDependencies) {\n    return new NewInstance(key, ...dynamicDependencies);\n  }\n}) || _class7);\n\nfunction getDecoratorDependencies(target) {\n  autoinject(target);\n\n  return target.inject;\n}\n\nfunction lazy(keyValue) {\n  return function (target, key, index) {\n    let inject = getDecoratorDependencies(target);\n    inject[index] = Lazy.of(keyValue);\n  };\n}\n\nfunction all(keyValue) {\n  return function (target, key, index) {\n    let inject = getDecoratorDependencies(target);\n    inject[index] = All.of(keyValue);\n  };\n}\n\nfunction optional(checkParentOrTarget = true) {\n  let deco = function (checkParent) {\n    return function (target, key, index) {\n      let inject = getDecoratorDependencies(target);\n      inject[index] = Optional.of(inject[index], checkParent);\n    };\n  };\n  if (typeof checkParentOrTarget === 'boolean') {\n    return deco(checkParentOrTarget);\n  }\n  return deco(true);\n}\n\nfunction parent(target, key, index) {\n  let inject = getDecoratorDependencies(target);\n  inject[index] = Parent.of(inject[index]);\n}\n\nfunction factory(keyValue) {\n  return function (target, key, index) {\n    let inject = getDecoratorDependencies(target);\n    inject[index] = Factory.of(keyValue);\n  };\n}\n\nfunction newInstance(asKeyOrTarget, ...dynamicDependencies) {\n  let deco = function (asKey) {\n    return function (target, key, index) {\n      let inject = getDecoratorDependencies(target);\n      inject[index] = NewInstance.of(inject[index], ...dynamicDependencies);\n      if (!!asKey) {\n        inject[index].as(asKey);\n      }\n    };\n  };\n  if (arguments.length >= 1) {\n    return deco(asKeyOrTarget);\n  }\n  return deco();\n}\n\nfunction invoker(value) {\n  return function (target) {\n    aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].invoker, value, target);\n  };\n}\n\nfunction invokeAsFactory(potentialTarget) {\n  let deco = function (target) {\n    aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].invoker, FactoryInvoker.instance, target);\n  };\n\n  return potentialTarget ? deco(potentialTarget) : deco;\n}\n\nlet FactoryInvoker = class FactoryInvoker {\n  invoke(container, fn, dependencies) {\n    let i = dependencies.length;\n    let args = new Array(i);\n\n    while (i--) {\n      args[i] = container.get(dependencies[i]);\n    }\n\n    return fn.apply(undefined, args);\n  }\n\n  invokeWithDynamicDependencies(container, fn, staticDependencies, dynamicDependencies) {\n    let i = staticDependencies.length;\n    let args = new Array(i);\n\n    while (i--) {\n      args[i] = container.get(staticDependencies[i]);\n    }\n\n    if (dynamicDependencies !== undefined) {\n      args = args.concat(dynamicDependencies);\n    }\n\n    return fn.apply(undefined, args);\n  }\n};\n\nFactoryInvoker.instance = new FactoryInvoker();\n\nfunction registration(value) {\n  return function (target) {\n    aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].registration, value, target);\n  };\n}\n\nfunction transient(key) {\n  return registration(new TransientRegistration(key));\n}\n\nfunction singleton(keyOrRegisterInChild, registerInChild = false) {\n  return registration(new SingletonRegistration(keyOrRegisterInChild, registerInChild));\n}\n\nlet TransientRegistration = class TransientRegistration {\n  constructor(key) {\n    this._key = key;\n  }\n\n  registerResolver(container, key, fn) {\n    let existingResolver = container.getResolver(this._key || key);\n    return existingResolver === undefined ? container.registerTransient(this._key || key, fn) : existingResolver;\n  }\n};\n\nlet SingletonRegistration = class SingletonRegistration {\n  constructor(keyOrRegisterInChild, registerInChild = false) {\n    if (typeof keyOrRegisterInChild === 'boolean') {\n      this._registerInChild = keyOrRegisterInChild;\n    } else {\n      this._key = keyOrRegisterInChild;\n      this._registerInChild = registerInChild;\n    }\n  }\n\n  registerResolver(container, key, fn) {\n    let targetContainer = this._registerInChild ? container : container.root;\n    let existingResolver = targetContainer.getResolver(this._key || key);\n    return existingResolver === undefined ? targetContainer.registerSingleton(this._key || key, fn) : existingResolver;\n  }\n};\n\nfunction validateKey(key) {\n  if (key === null || key === undefined) {\n    throw new Error('key/value cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?');\n  }\n}\nconst _emptyParameters = Object.freeze([]);\n\naurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].registration = 'aurelia:registration';\naurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].invoker = 'aurelia:invoker';\n\nlet resolverDecorates = resolver.decorates;\n\nlet InvocationHandler = class InvocationHandler {\n  constructor(fn, invoker, dependencies) {\n    this.fn = fn;\n    this.invoker = invoker;\n    this.dependencies = dependencies;\n  }\n\n  invoke(container, dynamicDependencies) {\n    return dynamicDependencies !== undefined ? this.invoker.invokeWithDynamicDependencies(container, this.fn, this.dependencies, dynamicDependencies) : this.invoker.invoke(container, this.fn, this.dependencies);\n  }\n};\n\nfunction invokeWithDynamicDependencies(container, fn, staticDependencies, dynamicDependencies) {\n  let i = staticDependencies.length;\n  let args = new Array(i);\n  let lookup;\n\n  while (i--) {\n    lookup = staticDependencies[i];\n\n    if (lookup === null || lookup === undefined) {\n      throw new Error('Constructor Parameter with index ' + i + ' cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?');\n    } else {\n      args[i] = container.get(lookup);\n    }\n  }\n\n  if (dynamicDependencies !== undefined) {\n    args = args.concat(dynamicDependencies);\n  }\n\n  return Reflect.construct(fn, args);\n}\n\nlet classInvokers = {\n  [0]: {\n    invoke(container, Type) {\n      return new Type();\n    },\n    invokeWithDynamicDependencies: invokeWithDynamicDependencies\n  },\n  [1]: {\n    invoke(container, Type, deps) {\n      return new Type(container.get(deps[0]));\n    },\n    invokeWithDynamicDependencies: invokeWithDynamicDependencies\n  },\n  [2]: {\n    invoke(container, Type, deps) {\n      return new Type(container.get(deps[0]), container.get(deps[1]));\n    },\n    invokeWithDynamicDependencies: invokeWithDynamicDependencies\n  },\n  [3]: {\n    invoke(container, Type, deps) {\n      return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]));\n    },\n    invokeWithDynamicDependencies: invokeWithDynamicDependencies\n  },\n  [4]: {\n    invoke(container, Type, deps) {\n      return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]));\n    },\n    invokeWithDynamicDependencies: invokeWithDynamicDependencies\n  },\n  [5]: {\n    invoke(container, Type, deps) {\n      return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]), container.get(deps[4]));\n    },\n    invokeWithDynamicDependencies: invokeWithDynamicDependencies\n  },\n  fallback: {\n    invoke: invokeWithDynamicDependencies,\n    invokeWithDynamicDependencies: invokeWithDynamicDependencies\n  }\n};\n\nfunction getDependencies(f) {\n  if (!f.hasOwnProperty('inject')) {\n    return [];\n  }\n\n  if (typeof f.inject === 'function') {\n    return f.inject();\n  }\n\n  return f.inject;\n}\n\nlet Container = class Container {\n  constructor(configuration) {\n    if (configuration === undefined) {\n      configuration = {};\n    }\n\n    this._configuration = configuration;\n    this._onHandlerCreated = configuration.onHandlerCreated;\n    this._handlers = configuration.handlers || (configuration.handlers = new Map());\n    this._resolvers = new Map();\n    this.root = this;\n    this.parent = null;\n  }\n\n  makeGlobal() {\n    Container.instance = this;\n    return this;\n  }\n\n  setHandlerCreatedCallback(onHandlerCreated) {\n    this._onHandlerCreated = onHandlerCreated;\n    this._configuration.onHandlerCreated = onHandlerCreated;\n  }\n\n  registerInstance(key, instance) {\n    return this.registerResolver(key, new StrategyResolver(0, instance === undefined ? key : instance));\n  }\n\n  registerSingleton(key, fn) {\n    return this.registerResolver(key, new StrategyResolver(1, fn === undefined ? key : fn));\n  }\n\n  registerTransient(key, fn) {\n    return this.registerResolver(key, new StrategyResolver(2, fn === undefined ? key : fn));\n  }\n\n  registerHandler(key, handler) {\n    return this.registerResolver(key, new StrategyResolver(3, handler));\n  }\n\n  registerAlias(originalKey, aliasKey) {\n    return this.registerResolver(aliasKey, new StrategyResolver(5, originalKey));\n  }\n\n  registerResolver(key, resolver) {\n    validateKey(key);\n\n    let allResolvers = this._resolvers;\n    let result = allResolvers.get(key);\n\n    if (result === undefined) {\n      allResolvers.set(key, resolver);\n    } else if (result.strategy === 4) {\n      result.state.push(resolver);\n    } else {\n      allResolvers.set(key, new StrategyResolver(4, [result, resolver]));\n    }\n\n    return resolver;\n  }\n\n  autoRegister(key, fn) {\n    fn = fn === undefined ? key : fn;\n\n    if (typeof fn === 'function') {\n      let registration = aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].get(aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].registration, fn);\n\n      if (registration === undefined) {\n        return this.registerResolver(key, new StrategyResolver(1, fn));\n      }\n\n      return registration.registerResolver(this, key, fn);\n    }\n\n    return this.registerResolver(key, new StrategyResolver(0, fn));\n  }\n\n  autoRegisterAll(fns) {\n    let i = fns.length;\n    while (i--) {\n      this.autoRegister(fns[i]);\n    }\n  }\n\n  unregister(key) {\n    this._resolvers.delete(key);\n  }\n\n  hasResolver(key, checkParent = false) {\n    validateKey(key);\n\n    return this._resolvers.has(key) || checkParent && this.parent !== null && this.parent.hasResolver(key, checkParent);\n  }\n\n  getResolver(key) {\n    return this._resolvers.get(key);\n  }\n\n  get(key) {\n    validateKey(key);\n\n    if (key === Container) {\n      return this;\n    }\n\n    if (resolverDecorates(key)) {\n      return key.get(this, key);\n    }\n\n    let resolver = this._resolvers.get(key);\n\n    if (resolver === undefined) {\n      if (this.parent === null) {\n        return this.autoRegister(key).get(this, key);\n      }\n\n      let registration = aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].get(aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].registration, key);\n\n      if (registration === undefined) {\n        return this.parent._get(key);\n      }\n\n      return registration.registerResolver(this, key, key).get(this, key);\n    }\n\n    return resolver.get(this, key);\n  }\n\n  _get(key) {\n    let resolver = this._resolvers.get(key);\n\n    if (resolver === undefined) {\n      if (this.parent === null) {\n        return this.autoRegister(key).get(this, key);\n      }\n\n      return this.parent._get(key);\n    }\n\n    return resolver.get(this, key);\n  }\n\n  getAll(key) {\n    validateKey(key);\n\n    let resolver = this._resolvers.get(key);\n\n    if (resolver === undefined) {\n      if (this.parent === null) {\n        return _emptyParameters;\n      }\n\n      return this.parent.getAll(key);\n    }\n\n    if (resolver.strategy === 4) {\n      let state = resolver.state;\n      let i = state.length;\n      let results = new Array(i);\n\n      while (i--) {\n        results[i] = state[i].get(this, key);\n      }\n\n      return results;\n    }\n\n    return [resolver.get(this, key)];\n  }\n\n  createChild() {\n    let child = new Container(this._configuration);\n    child.root = this.root;\n    child.parent = this;\n    return child;\n  }\n\n  invoke(fn, dynamicDependencies) {\n    try {\n      let handler = this._handlers.get(fn);\n\n      if (handler === undefined) {\n        handler = this._createInvocationHandler(fn);\n        this._handlers.set(fn, handler);\n      }\n\n      return handler.invoke(this, dynamicDependencies);\n    } catch (e) {\n      throw new aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"AggregateError\"](`Error invoking ${fn.name}. Check the inner error for details.`, e, true);\n    }\n  }\n\n  _createInvocationHandler(fn) {\n    let dependencies;\n\n    if (fn.inject === undefined) {\n      dependencies = aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].getOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].paramTypes, fn) || _emptyParameters;\n    } else {\n      dependencies = [];\n      let ctor = fn;\n      while (typeof ctor === 'function') {\n        dependencies.push(...getDependencies(ctor));\n        ctor = Object.getPrototypeOf(ctor);\n      }\n    }\n\n    let invoker = aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].getOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].invoker, fn) || classInvokers[dependencies.length] || classInvokers.fallback;\n\n    let handler = new InvocationHandler(fn, invoker, dependencies);\n    return this._onHandlerCreated !== undefined ? this._onHandlerCreated(handler) : handler;\n  }\n};\n\nfunction autoinject(potentialTarget) {\n  let deco = function (target) {\n    if (!target.hasOwnProperty('inject')) {\n      target.inject = (aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].getOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"metadata\"].paramTypes, target) || _emptyParameters).slice();\n\n      if (target.inject.length > 0 && target.inject[target.inject.length - 1] === Object) {\n        target.inject.pop();\n      }\n    }\n  };\n\n  return potentialTarget ? deco(potentialTarget) : deco;\n}\n\nfunction inject(...rest) {\n  return function (target, key, descriptor) {\n    if (typeof descriptor === 'number') {\n      autoinject(target);\n      if (rest.length === 1) {\n        target.inject[descriptor] = rest[0];\n      }\n      return;\n    }\n\n    if (descriptor) {\n      const fn = descriptor.value;\n      fn.inject = rest;\n    } else {\n      target.inject = rest;\n    }\n  };\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbi9kaXN0L2VzMjAxNS9hdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24vZGlzdC9lczIwMTUvYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbi5qcz8zOWU1Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfZGVjLCBfY2xhc3MsIF9kZWMyLCBfY2xhc3MyLCBfZGVjMywgX2NsYXNzMywgX2RlYzQsIF9jbGFzczQsIF9kZWM1LCBfY2xhc3M1LCBfZGVjNiwgX2NsYXNzNiwgX2RlYzcsIF9jbGFzczc7XG5cbmltcG9ydCB7IHByb3RvY29sLCBtZXRhZGF0YSB9IGZyb20gJ2F1cmVsaWEtbWV0YWRhdGEnO1xuaW1wb3J0IHsgQWdncmVnYXRlRXJyb3IgfSBmcm9tICdhdXJlbGlhLXBhbCc7XG5cbmV4cG9ydCBjb25zdCByZXNvbHZlciA9IHByb3RvY29sLmNyZWF0ZSgnYXVyZWxpYTpyZXNvbHZlcicsIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgaWYgKCEodHlwZW9mIHRhcmdldC5nZXQgPT09ICdmdW5jdGlvbicpKSB7XG4gICAgcmV0dXJuICdSZXNvbHZlcnMgbXVzdCBpbXBsZW1lbnQ6IGdldChjb250YWluZXI6IENvbnRhaW5lciwga2V5OiBhbnkpOiBhbnknO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59KTtcblxuZXhwb3J0IGxldCBTdHJhdGVneVJlc29sdmVyID0gKF9kZWMgPSByZXNvbHZlcigpLCBfZGVjKF9jbGFzcyA9IGNsYXNzIFN0cmF0ZWd5UmVzb2x2ZXIge1xuICBjb25zdHJ1Y3RvcihzdHJhdGVneSwgc3RhdGUpIHtcbiAgICB0aGlzLnN0cmF0ZWd5ID0gc3RyYXRlZ3k7XG4gICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICB9XG5cbiAgZ2V0KGNvbnRhaW5lciwga2V5KSB7XG4gICAgc3dpdGNoICh0aGlzLnN0cmF0ZWd5KSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRlO1xuICAgICAgY2FzZSAxOlxuICAgICAgICBsZXQgc2luZ2xldG9uID0gY29udGFpbmVyLmludm9rZSh0aGlzLnN0YXRlKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHNpbmdsZXRvbjtcbiAgICAgICAgdGhpcy5zdHJhdGVneSA9IDA7XG4gICAgICAgIHJldHVybiBzaW5nbGV0b247XG4gICAgICBjYXNlIDI6XG4gICAgICAgIHJldHVybiBjb250YWluZXIuaW52b2tlKHRoaXMuc3RhdGUpO1xuICAgICAgY2FzZSAzOlxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZShjb250YWluZXIsIGtleSwgdGhpcyk7XG4gICAgICBjYXNlIDQ6XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRlWzBdLmdldChjb250YWluZXIsIGtleSk7XG4gICAgICBjYXNlIDU6XG4gICAgICAgIHJldHVybiBjb250YWluZXIuZ2V0KHRoaXMuc3RhdGUpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHN0cmF0ZWd5OiAnICsgdGhpcy5zdHJhdGVneSk7XG4gICAgfVxuICB9XG59KSB8fCBfY2xhc3MpO1xuXG5leHBvcnQgbGV0IExhenkgPSAoX2RlYzIgPSByZXNvbHZlcigpLCBfZGVjMihfY2xhc3MyID0gY2xhc3MgTGF6eSB7XG4gIGNvbnN0cnVjdG9yKGtleSkge1xuICAgIHRoaXMuX2tleSA9IGtleTtcbiAgfVxuXG4gIGdldChjb250YWluZXIpIHtcbiAgICByZXR1cm4gKCkgPT4gY29udGFpbmVyLmdldCh0aGlzLl9rZXkpO1xuICB9XG5cbiAgc3RhdGljIG9mKGtleSkge1xuICAgIHJldHVybiBuZXcgTGF6eShrZXkpO1xuICB9XG59KSB8fCBfY2xhc3MyKTtcblxuZXhwb3J0IGxldCBBbGwgPSAoX2RlYzMgPSByZXNvbHZlcigpLCBfZGVjMyhfY2xhc3MzID0gY2xhc3MgQWxsIHtcbiAgY29uc3RydWN0b3Ioa2V5KSB7XG4gICAgdGhpcy5fa2V5ID0ga2V5O1xuICB9XG5cbiAgZ2V0KGNvbnRhaW5lcikge1xuICAgIHJldHVybiBjb250YWluZXIuZ2V0QWxsKHRoaXMuX2tleSk7XG4gIH1cblxuICBzdGF0aWMgb2Yoa2V5KSB7XG4gICAgcmV0dXJuIG5ldyBBbGwoa2V5KTtcbiAgfVxufSkgfHwgX2NsYXNzMyk7XG5cbmV4cG9ydCBsZXQgT3B0aW9uYWwgPSAoX2RlYzQgPSByZXNvbHZlcigpLCBfZGVjNChfY2xhc3M0ID0gY2xhc3MgT3B0aW9uYWwge1xuICBjb25zdHJ1Y3RvcihrZXksIGNoZWNrUGFyZW50ID0gdHJ1ZSkge1xuICAgIHRoaXMuX2tleSA9IGtleTtcbiAgICB0aGlzLl9jaGVja1BhcmVudCA9IGNoZWNrUGFyZW50O1xuICB9XG5cbiAgZ2V0KGNvbnRhaW5lcikge1xuICAgIGlmIChjb250YWluZXIuaGFzUmVzb2x2ZXIodGhpcy5fa2V5LCB0aGlzLl9jaGVja1BhcmVudCkpIHtcbiAgICAgIHJldHVybiBjb250YWluZXIuZ2V0KHRoaXMuX2tleSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBzdGF0aWMgb2Yoa2V5LCBjaGVja1BhcmVudCA9IHRydWUpIHtcbiAgICByZXR1cm4gbmV3IE9wdGlvbmFsKGtleSwgY2hlY2tQYXJlbnQpO1xuICB9XG59KSB8fCBfY2xhc3M0KTtcblxuZXhwb3J0IGxldCBQYXJlbnQgPSAoX2RlYzUgPSByZXNvbHZlcigpLCBfZGVjNShfY2xhc3M1ID0gY2xhc3MgUGFyZW50IHtcbiAgY29uc3RydWN0b3Ioa2V5KSB7XG4gICAgdGhpcy5fa2V5ID0ga2V5O1xuICB9XG5cbiAgZ2V0KGNvbnRhaW5lcikge1xuICAgIHJldHVybiBjb250YWluZXIucGFyZW50ID8gY29udGFpbmVyLnBhcmVudC5nZXQodGhpcy5fa2V5KSA6IG51bGw7XG4gIH1cblxuICBzdGF0aWMgb2Yoa2V5KSB7XG4gICAgcmV0dXJuIG5ldyBQYXJlbnQoa2V5KTtcbiAgfVxufSkgfHwgX2NsYXNzNSk7XG5cbmV4cG9ydCBsZXQgRmFjdG9yeSA9IChfZGVjNiA9IHJlc29sdmVyKCksIF9kZWM2KF9jbGFzczYgPSBjbGFzcyBGYWN0b3J5IHtcbiAgY29uc3RydWN0b3Ioa2V5KSB7XG4gICAgdGhpcy5fa2V5ID0ga2V5O1xuICB9XG5cbiAgZ2V0KGNvbnRhaW5lcikge1xuICAgIGxldCBmbiA9IHRoaXMuX2tleTtcbiAgICBsZXQgcmVzb2x2ZXIgPSBjb250YWluZXIuZ2V0UmVzb2x2ZXIoZm4pO1xuICAgIGlmIChyZXNvbHZlciAmJiByZXNvbHZlci5zdHJhdGVneSA9PT0gMykge1xuICAgICAgZm4gPSByZXNvbHZlci5zdGF0ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gKC4uLnJlc3QpID0+IGNvbnRhaW5lci5pbnZva2UoZm4sIHJlc3QpO1xuICB9XG5cbiAgc3RhdGljIG9mKGtleSkge1xuICAgIHJldHVybiBuZXcgRmFjdG9yeShrZXkpO1xuICB9XG59KSB8fCBfY2xhc3M2KTtcblxuZXhwb3J0IGxldCBOZXdJbnN0YW5jZSA9IChfZGVjNyA9IHJlc29sdmVyKCksIF9kZWM3KF9jbGFzczcgPSBjbGFzcyBOZXdJbnN0YW5jZSB7XG4gIGNvbnN0cnVjdG9yKGtleSwgLi4uZHluYW1pY0RlcGVuZGVuY2llcykge1xuICAgIHRoaXMua2V5ID0ga2V5O1xuICAgIHRoaXMuYXNLZXkgPSBrZXk7XG4gICAgdGhpcy5keW5hbWljRGVwZW5kZW5jaWVzID0gZHluYW1pY0RlcGVuZGVuY2llcztcbiAgfVxuXG4gIGdldChjb250YWluZXIpIHtcbiAgICBsZXQgZHluYW1pY0RlcGVuZGVuY2llcyA9IHRoaXMuZHluYW1pY0RlcGVuZGVuY2llcy5sZW5ndGggPiAwID8gdGhpcy5keW5hbWljRGVwZW5kZW5jaWVzLm1hcChkZXBlbmRlbmN5ID0+IGRlcGVuZGVuY3lbJ3Byb3RvY29sOmF1cmVsaWE6cmVzb2x2ZXInXSA/IGRlcGVuZGVuY3kuZ2V0KGNvbnRhaW5lcikgOiBjb250YWluZXIuZ2V0KGRlcGVuZGVuY3kpKSA6IHVuZGVmaW5lZDtcblxuICAgIGxldCBmbiA9IHRoaXMua2V5O1xuICAgIGxldCByZXNvbHZlciA9IGNvbnRhaW5lci5nZXRSZXNvbHZlcihmbik7XG4gICAgaWYgKHJlc29sdmVyICYmIHJlc29sdmVyLnN0cmF0ZWd5ID09PSAzKSB7XG4gICAgICBmbiA9IHJlc29sdmVyLnN0YXRlO1xuICAgIH1cblxuICAgIGNvbnN0IGluc3RhbmNlID0gY29udGFpbmVyLmludm9rZShmbiwgZHluYW1pY0RlcGVuZGVuY2llcyk7XG4gICAgY29udGFpbmVyLnJlZ2lzdGVySW5zdGFuY2UodGhpcy5hc0tleSwgaW5zdGFuY2UpO1xuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfVxuXG4gIGFzKGtleSkge1xuICAgIHRoaXMuYXNLZXkgPSBrZXk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBzdGF0aWMgb2Yoa2V5LCAuLi5keW5hbWljRGVwZW5kZW5jaWVzKSB7XG4gICAgcmV0dXJuIG5ldyBOZXdJbnN0YW5jZShrZXksIC4uLmR5bmFtaWNEZXBlbmRlbmNpZXMpO1xuICB9XG59KSB8fCBfY2xhc3M3KTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldERlY29yYXRvckRlcGVuZGVuY2llcyh0YXJnZXQpIHtcbiAgYXV0b2luamVjdCh0YXJnZXQpO1xuXG4gIHJldHVybiB0YXJnZXQuaW5qZWN0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGF6eShrZXlWYWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5LCBpbmRleCkge1xuICAgIGxldCBpbmplY3QgPSBnZXREZWNvcmF0b3JEZXBlbmRlbmNpZXModGFyZ2V0KTtcbiAgICBpbmplY3RbaW5kZXhdID0gTGF6eS5vZihrZXlWYWx1ZSk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhbGwoa2V5VmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSwgaW5kZXgpIHtcbiAgICBsZXQgaW5qZWN0ID0gZ2V0RGVjb3JhdG9yRGVwZW5kZW5jaWVzKHRhcmdldCk7XG4gICAgaW5qZWN0W2luZGV4XSA9IEFsbC5vZihrZXlWYWx1ZSk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBvcHRpb25hbChjaGVja1BhcmVudE9yVGFyZ2V0ID0gdHJ1ZSkge1xuICBsZXQgZGVjbyA9IGZ1bmN0aW9uIChjaGVja1BhcmVudCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXksIGluZGV4KSB7XG4gICAgICBsZXQgaW5qZWN0ID0gZ2V0RGVjb3JhdG9yRGVwZW5kZW5jaWVzKHRhcmdldCk7XG4gICAgICBpbmplY3RbaW5kZXhdID0gT3B0aW9uYWwub2YoaW5qZWN0W2luZGV4XSwgY2hlY2tQYXJlbnQpO1xuICAgIH07XG4gIH07XG4gIGlmICh0eXBlb2YgY2hlY2tQYXJlbnRPclRhcmdldCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgcmV0dXJuIGRlY28oY2hlY2tQYXJlbnRPclRhcmdldCk7XG4gIH1cbiAgcmV0dXJuIGRlY28odHJ1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJlbnQodGFyZ2V0LCBrZXksIGluZGV4KSB7XG4gIGxldCBpbmplY3QgPSBnZXREZWNvcmF0b3JEZXBlbmRlbmNpZXModGFyZ2V0KTtcbiAgaW5qZWN0W2luZGV4XSA9IFBhcmVudC5vZihpbmplY3RbaW5kZXhdKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZhY3Rvcnkoa2V5VmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSwgaW5kZXgpIHtcbiAgICBsZXQgaW5qZWN0ID0gZ2V0RGVjb3JhdG9yRGVwZW5kZW5jaWVzKHRhcmdldCk7XG4gICAgaW5qZWN0W2luZGV4XSA9IEZhY3Rvcnkub2Yoa2V5VmFsdWUpO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbmV3SW5zdGFuY2UoYXNLZXlPclRhcmdldCwgLi4uZHluYW1pY0RlcGVuZGVuY2llcykge1xuICBsZXQgZGVjbyA9IGZ1bmN0aW9uIChhc0tleSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXksIGluZGV4KSB7XG4gICAgICBsZXQgaW5qZWN0ID0gZ2V0RGVjb3JhdG9yRGVwZW5kZW5jaWVzKHRhcmdldCk7XG4gICAgICBpbmplY3RbaW5kZXhdID0gTmV3SW5zdGFuY2Uub2YoaW5qZWN0W2luZGV4XSwgLi4uZHluYW1pY0RlcGVuZGVuY2llcyk7XG4gICAgICBpZiAoISFhc0tleSkge1xuICAgICAgICBpbmplY3RbaW5kZXhdLmFzKGFzS2V5KTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAxKSB7XG4gICAgcmV0dXJuIGRlY28oYXNLZXlPclRhcmdldCk7XG4gIH1cbiAgcmV0dXJuIGRlY28oKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGludm9rZXIodmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICBtZXRhZGF0YS5kZWZpbmUobWV0YWRhdGEuaW52b2tlciwgdmFsdWUsIHRhcmdldCk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnZva2VBc0ZhY3RvcnkocG90ZW50aWFsVGFyZ2V0KSB7XG4gIGxldCBkZWNvID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIG1ldGFkYXRhLmRlZmluZShtZXRhZGF0YS5pbnZva2VyLCBGYWN0b3J5SW52b2tlci5pbnN0YW5jZSwgdGFyZ2V0KTtcbiAgfTtcblxuICByZXR1cm4gcG90ZW50aWFsVGFyZ2V0ID8gZGVjbyhwb3RlbnRpYWxUYXJnZXQpIDogZGVjbztcbn1cblxuZXhwb3J0IGxldCBGYWN0b3J5SW52b2tlciA9IGNsYXNzIEZhY3RvcnlJbnZva2VyIHtcbiAgaW52b2tlKGNvbnRhaW5lciwgZm4sIGRlcGVuZGVuY2llcykge1xuICAgIGxldCBpID0gZGVwZW5kZW5jaWVzLmxlbmd0aDtcbiAgICBsZXQgYXJncyA9IG5ldyBBcnJheShpKTtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGFyZ3NbaV0gPSBjb250YWluZXIuZ2V0KGRlcGVuZGVuY2llc1tpXSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZuLmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7XG4gIH1cblxuICBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llcyhjb250YWluZXIsIGZuLCBzdGF0aWNEZXBlbmRlbmNpZXMsIGR5bmFtaWNEZXBlbmRlbmNpZXMpIHtcbiAgICBsZXQgaSA9IHN0YXRpY0RlcGVuZGVuY2llcy5sZW5ndGg7XG4gICAgbGV0IGFyZ3MgPSBuZXcgQXJyYXkoaSk7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICBhcmdzW2ldID0gY29udGFpbmVyLmdldChzdGF0aWNEZXBlbmRlbmNpZXNbaV0pO1xuICAgIH1cblxuICAgIGlmIChkeW5hbWljRGVwZW5kZW5jaWVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGFyZ3MgPSBhcmdzLmNvbmNhdChkeW5hbWljRGVwZW5kZW5jaWVzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm4uYXBwbHkodW5kZWZpbmVkLCBhcmdzKTtcbiAgfVxufTtcblxuRmFjdG9yeUludm9rZXIuaW5zdGFuY2UgPSBuZXcgRmFjdG9yeUludm9rZXIoKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdHJhdGlvbih2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIG1ldGFkYXRhLmRlZmluZShtZXRhZGF0YS5yZWdpc3RyYXRpb24sIHZhbHVlLCB0YXJnZXQpO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdHJhbnNpZW50KGtleSkge1xuICByZXR1cm4gcmVnaXN0cmF0aW9uKG5ldyBUcmFuc2llbnRSZWdpc3RyYXRpb24oa2V5KSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaW5nbGV0b24oa2V5T3JSZWdpc3RlckluQ2hpbGQsIHJlZ2lzdGVySW5DaGlsZCA9IGZhbHNlKSB7XG4gIHJldHVybiByZWdpc3RyYXRpb24obmV3IFNpbmdsZXRvblJlZ2lzdHJhdGlvbihrZXlPclJlZ2lzdGVySW5DaGlsZCwgcmVnaXN0ZXJJbkNoaWxkKSk7XG59XG5cbmV4cG9ydCBsZXQgVHJhbnNpZW50UmVnaXN0cmF0aW9uID0gY2xhc3MgVHJhbnNpZW50UmVnaXN0cmF0aW9uIHtcbiAgY29uc3RydWN0b3Ioa2V5KSB7XG4gICAgdGhpcy5fa2V5ID0ga2V5O1xuICB9XG5cbiAgcmVnaXN0ZXJSZXNvbHZlcihjb250YWluZXIsIGtleSwgZm4pIHtcbiAgICBsZXQgZXhpc3RpbmdSZXNvbHZlciA9IGNvbnRhaW5lci5nZXRSZXNvbHZlcih0aGlzLl9rZXkgfHwga2V5KTtcbiAgICByZXR1cm4gZXhpc3RpbmdSZXNvbHZlciA9PT0gdW5kZWZpbmVkID8gY29udGFpbmVyLnJlZ2lzdGVyVHJhbnNpZW50KHRoaXMuX2tleSB8fCBrZXksIGZuKSA6IGV4aXN0aW5nUmVzb2x2ZXI7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgU2luZ2xldG9uUmVnaXN0cmF0aW9uID0gY2xhc3MgU2luZ2xldG9uUmVnaXN0cmF0aW9uIHtcbiAgY29uc3RydWN0b3Ioa2V5T3JSZWdpc3RlckluQ2hpbGQsIHJlZ2lzdGVySW5DaGlsZCA9IGZhbHNlKSB7XG4gICAgaWYgKHR5cGVvZiBrZXlPclJlZ2lzdGVySW5DaGlsZCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICB0aGlzLl9yZWdpc3RlckluQ2hpbGQgPSBrZXlPclJlZ2lzdGVySW5DaGlsZDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fa2V5ID0ga2V5T3JSZWdpc3RlckluQ2hpbGQ7XG4gICAgICB0aGlzLl9yZWdpc3RlckluQ2hpbGQgPSByZWdpc3RlckluQ2hpbGQ7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJSZXNvbHZlcihjb250YWluZXIsIGtleSwgZm4pIHtcbiAgICBsZXQgdGFyZ2V0Q29udGFpbmVyID0gdGhpcy5fcmVnaXN0ZXJJbkNoaWxkID8gY29udGFpbmVyIDogY29udGFpbmVyLnJvb3Q7XG4gICAgbGV0IGV4aXN0aW5nUmVzb2x2ZXIgPSB0YXJnZXRDb250YWluZXIuZ2V0UmVzb2x2ZXIodGhpcy5fa2V5IHx8IGtleSk7XG4gICAgcmV0dXJuIGV4aXN0aW5nUmVzb2x2ZXIgPT09IHVuZGVmaW5lZCA/IHRhcmdldENvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbih0aGlzLl9rZXkgfHwga2V5LCBmbikgOiBleGlzdGluZ1Jlc29sdmVyO1xuICB9XG59O1xuXG5mdW5jdGlvbiB2YWxpZGF0ZUtleShrZXkpIHtcbiAgaWYgKGtleSA9PT0gbnVsbCB8fCBrZXkgPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBFcnJvcigna2V5L3ZhbHVlIGNhbm5vdCBiZSBudWxsIG9yIHVuZGVmaW5lZC4gQXJlIHlvdSB0cnlpbmcgdG8gaW5qZWN0L3JlZ2lzdGVyIHNvbWV0aGluZyB0aGF0IGRvZXNuXFwndCBleGlzdCB3aXRoIERJPycpO1xuICB9XG59XG5leHBvcnQgY29uc3QgX2VtcHR5UGFyYW1ldGVycyA9IE9iamVjdC5mcmVlemUoW10pO1xuXG5tZXRhZGF0YS5yZWdpc3RyYXRpb24gPSAnYXVyZWxpYTpyZWdpc3RyYXRpb24nO1xubWV0YWRhdGEuaW52b2tlciA9ICdhdXJlbGlhOmludm9rZXInO1xuXG5sZXQgcmVzb2x2ZXJEZWNvcmF0ZXMgPSByZXNvbHZlci5kZWNvcmF0ZXM7XG5cbmV4cG9ydCBsZXQgSW52b2NhdGlvbkhhbmRsZXIgPSBjbGFzcyBJbnZvY2F0aW9uSGFuZGxlciB7XG4gIGNvbnN0cnVjdG9yKGZuLCBpbnZva2VyLCBkZXBlbmRlbmNpZXMpIHtcbiAgICB0aGlzLmZuID0gZm47XG4gICAgdGhpcy5pbnZva2VyID0gaW52b2tlcjtcbiAgICB0aGlzLmRlcGVuZGVuY2llcyA9IGRlcGVuZGVuY2llcztcbiAgfVxuXG4gIGludm9rZShjb250YWluZXIsIGR5bmFtaWNEZXBlbmRlbmNpZXMpIHtcbiAgICByZXR1cm4gZHluYW1pY0RlcGVuZGVuY2llcyAhPT0gdW5kZWZpbmVkID8gdGhpcy5pbnZva2VyLmludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzKGNvbnRhaW5lciwgdGhpcy5mbiwgdGhpcy5kZXBlbmRlbmNpZXMsIGR5bmFtaWNEZXBlbmRlbmNpZXMpIDogdGhpcy5pbnZva2VyLmludm9rZShjb250YWluZXIsIHRoaXMuZm4sIHRoaXMuZGVwZW5kZW5jaWVzKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXMoY29udGFpbmVyLCBmbiwgc3RhdGljRGVwZW5kZW5jaWVzLCBkeW5hbWljRGVwZW5kZW5jaWVzKSB7XG4gIGxldCBpID0gc3RhdGljRGVwZW5kZW5jaWVzLmxlbmd0aDtcbiAgbGV0IGFyZ3MgPSBuZXcgQXJyYXkoaSk7XG4gIGxldCBsb29rdXA7XG5cbiAgd2hpbGUgKGktLSkge1xuICAgIGxvb2t1cCA9IHN0YXRpY0RlcGVuZGVuY2llc1tpXTtcblxuICAgIGlmIChsb29rdXAgPT09IG51bGwgfHwgbG9va3VwID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ29uc3RydWN0b3IgUGFyYW1ldGVyIHdpdGggaW5kZXggJyArIGkgKyAnIGNhbm5vdCBiZSBudWxsIG9yIHVuZGVmaW5lZC4gQXJlIHlvdSB0cnlpbmcgdG8gaW5qZWN0L3JlZ2lzdGVyIHNvbWV0aGluZyB0aGF0IGRvZXNuXFwndCBleGlzdCB3aXRoIERJPycpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhcmdzW2ldID0gY29udGFpbmVyLmdldChsb29rdXApO1xuICAgIH1cbiAgfVxuXG4gIGlmIChkeW5hbWljRGVwZW5kZW5jaWVzICE9PSB1bmRlZmluZWQpIHtcbiAgICBhcmdzID0gYXJncy5jb25jYXQoZHluYW1pY0RlcGVuZGVuY2llcyk7XG4gIH1cblxuICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoZm4sIGFyZ3MpO1xufVxuXG5sZXQgY2xhc3NJbnZva2VycyA9IHtcbiAgWzBdOiB7XG4gICAgaW52b2tlKGNvbnRhaW5lciwgVHlwZSkge1xuICAgICAgcmV0dXJuIG5ldyBUeXBlKCk7XG4gICAgfSxcbiAgICBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llczogaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXNcbiAgfSxcbiAgWzFdOiB7XG4gICAgaW52b2tlKGNvbnRhaW5lciwgVHlwZSwgZGVwcykge1xuICAgICAgcmV0dXJuIG5ldyBUeXBlKGNvbnRhaW5lci5nZXQoZGVwc1swXSkpO1xuICAgIH0sXG4gICAgaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXM6IGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzXG4gIH0sXG4gIFsyXToge1xuICAgIGludm9rZShjb250YWluZXIsIFR5cGUsIGRlcHMpIHtcbiAgICAgIHJldHVybiBuZXcgVHlwZShjb250YWluZXIuZ2V0KGRlcHNbMF0pLCBjb250YWluZXIuZ2V0KGRlcHNbMV0pKTtcbiAgICB9LFxuICAgIGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzOiBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llc1xuICB9LFxuICBbM106IHtcbiAgICBpbnZva2UoY29udGFpbmVyLCBUeXBlLCBkZXBzKSB7XG4gICAgICByZXR1cm4gbmV3IFR5cGUoY29udGFpbmVyLmdldChkZXBzWzBdKSwgY29udGFpbmVyLmdldChkZXBzWzFdKSwgY29udGFpbmVyLmdldChkZXBzWzJdKSk7XG4gICAgfSxcbiAgICBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llczogaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXNcbiAgfSxcbiAgWzRdOiB7XG4gICAgaW52b2tlKGNvbnRhaW5lciwgVHlwZSwgZGVwcykge1xuICAgICAgcmV0dXJuIG5ldyBUeXBlKGNvbnRhaW5lci5nZXQoZGVwc1swXSksIGNvbnRhaW5lci5nZXQoZGVwc1sxXSksIGNvbnRhaW5lci5nZXQoZGVwc1syXSksIGNvbnRhaW5lci5nZXQoZGVwc1szXSkpO1xuICAgIH0sXG4gICAgaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXM6IGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzXG4gIH0sXG4gIFs1XToge1xuICAgIGludm9rZShjb250YWluZXIsIFR5cGUsIGRlcHMpIHtcbiAgICAgIHJldHVybiBuZXcgVHlwZShjb250YWluZXIuZ2V0KGRlcHNbMF0pLCBjb250YWluZXIuZ2V0KGRlcHNbMV0pLCBjb250YWluZXIuZ2V0KGRlcHNbMl0pLCBjb250YWluZXIuZ2V0KGRlcHNbM10pLCBjb250YWluZXIuZ2V0KGRlcHNbNF0pKTtcbiAgICB9LFxuICAgIGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzOiBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llc1xuICB9LFxuICBmYWxsYmFjazoge1xuICAgIGludm9rZTogaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXMsXG4gICAgaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXM6IGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzXG4gIH1cbn07XG5cbmZ1bmN0aW9uIGdldERlcGVuZGVuY2llcyhmKSB7XG4gIGlmICghZi5oYXNPd25Qcm9wZXJ0eSgnaW5qZWN0JykpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBpZiAodHlwZW9mIGYuaW5qZWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIGYuaW5qZWN0KCk7XG4gIH1cblxuICByZXR1cm4gZi5pbmplY3Q7XG59XG5cbmV4cG9ydCBsZXQgQ29udGFpbmVyID0gY2xhc3MgQ29udGFpbmVyIHtcbiAgY29uc3RydWN0b3IoY29uZmlndXJhdGlvbikge1xuICAgIGlmIChjb25maWd1cmF0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbmZpZ3VyYXRpb24gPSB7fTtcbiAgICB9XG5cbiAgICB0aGlzLl9jb25maWd1cmF0aW9uID0gY29uZmlndXJhdGlvbjtcbiAgICB0aGlzLl9vbkhhbmRsZXJDcmVhdGVkID0gY29uZmlndXJhdGlvbi5vbkhhbmRsZXJDcmVhdGVkO1xuICAgIHRoaXMuX2hhbmRsZXJzID0gY29uZmlndXJhdGlvbi5oYW5kbGVycyB8fCAoY29uZmlndXJhdGlvbi5oYW5kbGVycyA9IG5ldyBNYXAoKSk7XG4gICAgdGhpcy5fcmVzb2x2ZXJzID0gbmV3IE1hcCgpO1xuICAgIHRoaXMucm9vdCA9IHRoaXM7XG4gICAgdGhpcy5wYXJlbnQgPSBudWxsO1xuICB9XG5cbiAgbWFrZUdsb2JhbCgpIHtcbiAgICBDb250YWluZXIuaW5zdGFuY2UgPSB0aGlzO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgc2V0SGFuZGxlckNyZWF0ZWRDYWxsYmFjayhvbkhhbmRsZXJDcmVhdGVkKSB7XG4gICAgdGhpcy5fb25IYW5kbGVyQ3JlYXRlZCA9IG9uSGFuZGxlckNyZWF0ZWQ7XG4gICAgdGhpcy5fY29uZmlndXJhdGlvbi5vbkhhbmRsZXJDcmVhdGVkID0gb25IYW5kbGVyQ3JlYXRlZDtcbiAgfVxuXG4gIHJlZ2lzdGVySW5zdGFuY2Uoa2V5LCBpbnN0YW5jZSkge1xuICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyUmVzb2x2ZXIoa2V5LCBuZXcgU3RyYXRlZ3lSZXNvbHZlcigwLCBpbnN0YW5jZSA9PT0gdW5kZWZpbmVkID8ga2V5IDogaW5zdGFuY2UpKTtcbiAgfVxuXG4gIHJlZ2lzdGVyU2luZ2xldG9uKGtleSwgZm4pIHtcbiAgICByZXR1cm4gdGhpcy5yZWdpc3RlclJlc29sdmVyKGtleSwgbmV3IFN0cmF0ZWd5UmVzb2x2ZXIoMSwgZm4gPT09IHVuZGVmaW5lZCA/IGtleSA6IGZuKSk7XG4gIH1cblxuICByZWdpc3RlclRyYW5zaWVudChrZXksIGZuKSB7XG4gICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJSZXNvbHZlcihrZXksIG5ldyBTdHJhdGVneVJlc29sdmVyKDIsIGZuID09PSB1bmRlZmluZWQgPyBrZXkgOiBmbikpO1xuICB9XG5cbiAgcmVnaXN0ZXJIYW5kbGVyKGtleSwgaGFuZGxlcikge1xuICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyUmVzb2x2ZXIoa2V5LCBuZXcgU3RyYXRlZ3lSZXNvbHZlcigzLCBoYW5kbGVyKSk7XG4gIH1cblxuICByZWdpc3RlckFsaWFzKG9yaWdpbmFsS2V5LCBhbGlhc0tleSkge1xuICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyUmVzb2x2ZXIoYWxpYXNLZXksIG5ldyBTdHJhdGVneVJlc29sdmVyKDUsIG9yaWdpbmFsS2V5KSk7XG4gIH1cblxuICByZWdpc3RlclJlc29sdmVyKGtleSwgcmVzb2x2ZXIpIHtcbiAgICB2YWxpZGF0ZUtleShrZXkpO1xuXG4gICAgbGV0IGFsbFJlc29sdmVycyA9IHRoaXMuX3Jlc29sdmVycztcbiAgICBsZXQgcmVzdWx0ID0gYWxsUmVzb2x2ZXJzLmdldChrZXkpO1xuXG4gICAgaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBhbGxSZXNvbHZlcnMuc2V0KGtleSwgcmVzb2x2ZXIpO1xuICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0cmF0ZWd5ID09PSA0KSB7XG4gICAgICByZXN1bHQuc3RhdGUucHVzaChyZXNvbHZlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsbFJlc29sdmVycy5zZXQoa2V5LCBuZXcgU3RyYXRlZ3lSZXNvbHZlcig0LCBbcmVzdWx0LCByZXNvbHZlcl0pKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzb2x2ZXI7XG4gIH1cblxuICBhdXRvUmVnaXN0ZXIoa2V5LCBmbikge1xuICAgIGZuID0gZm4gPT09IHVuZGVmaW5lZCA/IGtleSA6IGZuO1xuXG4gICAgaWYgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgbGV0IHJlZ2lzdHJhdGlvbiA9IG1ldGFkYXRhLmdldChtZXRhZGF0YS5yZWdpc3RyYXRpb24sIGZuKTtcblxuICAgICAgaWYgKHJlZ2lzdHJhdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyUmVzb2x2ZXIoa2V5LCBuZXcgU3RyYXRlZ3lSZXNvbHZlcigxLCBmbikpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVnaXN0cmF0aW9uLnJlZ2lzdGVyUmVzb2x2ZXIodGhpcywga2V5LCBmbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJSZXNvbHZlcihrZXksIG5ldyBTdHJhdGVneVJlc29sdmVyKDAsIGZuKSk7XG4gIH1cblxuICBhdXRvUmVnaXN0ZXJBbGwoZm5zKSB7XG4gICAgbGV0IGkgPSBmbnMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIHRoaXMuYXV0b1JlZ2lzdGVyKGZuc1tpXSk7XG4gICAgfVxuICB9XG5cbiAgdW5yZWdpc3RlcihrZXkpIHtcbiAgICB0aGlzLl9yZXNvbHZlcnMuZGVsZXRlKGtleSk7XG4gIH1cblxuICBoYXNSZXNvbHZlcihrZXksIGNoZWNrUGFyZW50ID0gZmFsc2UpIHtcbiAgICB2YWxpZGF0ZUtleShrZXkpO1xuXG4gICAgcmV0dXJuIHRoaXMuX3Jlc29sdmVycy5oYXMoa2V5KSB8fCBjaGVja1BhcmVudCAmJiB0aGlzLnBhcmVudCAhPT0gbnVsbCAmJiB0aGlzLnBhcmVudC5oYXNSZXNvbHZlcihrZXksIGNoZWNrUGFyZW50KTtcbiAgfVxuXG4gIGdldFJlc29sdmVyKGtleSkge1xuICAgIHJldHVybiB0aGlzLl9yZXNvbHZlcnMuZ2V0KGtleSk7XG4gIH1cblxuICBnZXQoa2V5KSB7XG4gICAgdmFsaWRhdGVLZXkoa2V5KTtcblxuICAgIGlmIChrZXkgPT09IENvbnRhaW5lcikge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgaWYgKHJlc29sdmVyRGVjb3JhdGVzKGtleSkpIHtcbiAgICAgIHJldHVybiBrZXkuZ2V0KHRoaXMsIGtleSk7XG4gICAgfVxuXG4gICAgbGV0IHJlc29sdmVyID0gdGhpcy5fcmVzb2x2ZXJzLmdldChrZXkpO1xuXG4gICAgaWYgKHJlc29sdmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICh0aGlzLnBhcmVudCA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdXRvUmVnaXN0ZXIoa2V5KS5nZXQodGhpcywga2V5KTtcbiAgICAgIH1cblxuICAgICAgbGV0IHJlZ2lzdHJhdGlvbiA9IG1ldGFkYXRhLmdldChtZXRhZGF0YS5yZWdpc3RyYXRpb24sIGtleSk7XG5cbiAgICAgIGlmIChyZWdpc3RyYXRpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuX2dldChrZXkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVnaXN0cmF0aW9uLnJlZ2lzdGVyUmVzb2x2ZXIodGhpcywga2V5LCBrZXkpLmdldCh0aGlzLCBrZXkpO1xuICAgIH1cblxuICAgIHJldHVybiByZXNvbHZlci5nZXQodGhpcywga2V5KTtcbiAgfVxuXG4gIF9nZXQoa2V5KSB7XG4gICAgbGV0IHJlc29sdmVyID0gdGhpcy5fcmVzb2x2ZXJzLmdldChrZXkpO1xuXG4gICAgaWYgKHJlc29sdmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICh0aGlzLnBhcmVudCA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdXRvUmVnaXN0ZXIoa2V5KS5nZXQodGhpcywga2V5KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucGFyZW50Ll9nZXQoa2V5KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzb2x2ZXIuZ2V0KHRoaXMsIGtleSk7XG4gIH1cblxuICBnZXRBbGwoa2V5KSB7XG4gICAgdmFsaWRhdGVLZXkoa2V5KTtcblxuICAgIGxldCByZXNvbHZlciA9IHRoaXMuX3Jlc29sdmVycy5nZXQoa2V5KTtcblxuICAgIGlmIChyZXNvbHZlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAodGhpcy5wYXJlbnQgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIF9lbXB0eVBhcmFtZXRlcnM7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnBhcmVudC5nZXRBbGwoa2V5KTtcbiAgICB9XG5cbiAgICBpZiAocmVzb2x2ZXIuc3RyYXRlZ3kgPT09IDQpIHtcbiAgICAgIGxldCBzdGF0ZSA9IHJlc29sdmVyLnN0YXRlO1xuICAgICAgbGV0IGkgPSBzdGF0ZS5sZW5ndGg7XG4gICAgICBsZXQgcmVzdWx0cyA9IG5ldyBBcnJheShpKTtcblxuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICByZXN1bHRzW2ldID0gc3RhdGVbaV0uZ2V0KHRoaXMsIGtleSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH1cblxuICAgIHJldHVybiBbcmVzb2x2ZXIuZ2V0KHRoaXMsIGtleSldO1xuICB9XG5cbiAgY3JlYXRlQ2hpbGQoKSB7XG4gICAgbGV0IGNoaWxkID0gbmV3IENvbnRhaW5lcih0aGlzLl9jb25maWd1cmF0aW9uKTtcbiAgICBjaGlsZC5yb290ID0gdGhpcy5yb290O1xuICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XG4gICAgcmV0dXJuIGNoaWxkO1xuICB9XG5cbiAgaW52b2tlKGZuLCBkeW5hbWljRGVwZW5kZW5jaWVzKSB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBoYW5kbGVyID0gdGhpcy5faGFuZGxlcnMuZ2V0KGZuKTtcblxuICAgICAgaWYgKGhhbmRsZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBoYW5kbGVyID0gdGhpcy5fY3JlYXRlSW52b2NhdGlvbkhhbmRsZXIoZm4pO1xuICAgICAgICB0aGlzLl9oYW5kbGVycy5zZXQoZm4sIGhhbmRsZXIpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaGFuZGxlci5pbnZva2UodGhpcywgZHluYW1pY0RlcGVuZGVuY2llcyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhyb3cgbmV3IEFnZ3JlZ2F0ZUVycm9yKGBFcnJvciBpbnZva2luZyAke2ZuLm5hbWV9LiBDaGVjayB0aGUgaW5uZXIgZXJyb3IgZm9yIGRldGFpbHMuYCwgZSwgdHJ1ZSk7XG4gICAgfVxuICB9XG5cbiAgX2NyZWF0ZUludm9jYXRpb25IYW5kbGVyKGZuKSB7XG4gICAgbGV0IGRlcGVuZGVuY2llcztcblxuICAgIGlmIChmbi5pbmplY3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgZGVwZW5kZW5jaWVzID0gbWV0YWRhdGEuZ2V0T3duKG1ldGFkYXRhLnBhcmFtVHlwZXMsIGZuKSB8fCBfZW1wdHlQYXJhbWV0ZXJzO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZXBlbmRlbmNpZXMgPSBbXTtcbiAgICAgIGxldCBjdG9yID0gZm47XG4gICAgICB3aGlsZSAodHlwZW9mIGN0b3IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZGVwZW5kZW5jaWVzLnB1c2goLi4uZ2V0RGVwZW5kZW5jaWVzKGN0b3IpKTtcbiAgICAgICAgY3RvciA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihjdG9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgaW52b2tlciA9IG1ldGFkYXRhLmdldE93bihtZXRhZGF0YS5pbnZva2VyLCBmbikgfHwgY2xhc3NJbnZva2Vyc1tkZXBlbmRlbmNpZXMubGVuZ3RoXSB8fCBjbGFzc0ludm9rZXJzLmZhbGxiYWNrO1xuXG4gICAgbGV0IGhhbmRsZXIgPSBuZXcgSW52b2NhdGlvbkhhbmRsZXIoZm4sIGludm9rZXIsIGRlcGVuZGVuY2llcyk7XG4gICAgcmV0dXJuIHRoaXMuX29uSGFuZGxlckNyZWF0ZWQgIT09IHVuZGVmaW5lZCA/IHRoaXMuX29uSGFuZGxlckNyZWF0ZWQoaGFuZGxlcikgOiBoYW5kbGVyO1xuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gYXV0b2luamVjdChwb3RlbnRpYWxUYXJnZXQpIHtcbiAgbGV0IGRlY28gPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgaWYgKCF0YXJnZXQuaGFzT3duUHJvcGVydHkoJ2luamVjdCcpKSB7XG4gICAgICB0YXJnZXQuaW5qZWN0ID0gKG1ldGFkYXRhLmdldE93bihtZXRhZGF0YS5wYXJhbVR5cGVzLCB0YXJnZXQpIHx8IF9lbXB0eVBhcmFtZXRlcnMpLnNsaWNlKCk7XG5cbiAgICAgIGlmICh0YXJnZXQuaW5qZWN0Lmxlbmd0aCA+IDAgJiYgdGFyZ2V0LmluamVjdFt0YXJnZXQuaW5qZWN0Lmxlbmd0aCAtIDFdID09PSBPYmplY3QpIHtcbiAgICAgICAgdGFyZ2V0LmluamVjdC5wb3AoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHBvdGVudGlhbFRhcmdldCA/IGRlY28ocG90ZW50aWFsVGFyZ2V0KSA6IGRlY287XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbmplY3QoLi4ucmVzdCkge1xuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgaWYgKHR5cGVvZiBkZXNjcmlwdG9yID09PSAnbnVtYmVyJykge1xuICAgICAgYXV0b2luamVjdCh0YXJnZXQpO1xuICAgICAgaWYgKHJlc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHRhcmdldC5pbmplY3RbZGVzY3JpcHRvcl0gPSByZXN0WzBdO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICBjb25zdCBmbiA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgICBmbi5pbmplY3QgPSByZXN0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0YXJnZXQuaW5qZWN0ID0gcmVzdDtcbiAgICB9XG4gIH07XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/aurelia-dependency-injection/dist/es2015/aurelia-dependency-injection.js\n");

/***/ }),

/***/ "./node_modules/aurelia-history/dist/es2015/aurelia-history.js":
/*!*********************************************************************!*\
  !*** ./node_modules/aurelia-history/dist/es2015/aurelia-history.js ***!
  \*********************************************************************/
/*! exports provided: History */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"History\", function() { return History; });\n\n\nfunction mi(name) {\n  throw new Error(`History must implement ${name}().`);\n}\n\nlet History = class History {\n  activate(options) {\n    mi('activate');\n  }\n\n  deactivate() {\n    mi('deactivate');\n  }\n\n  getAbsoluteRoot() {\n    mi('getAbsoluteRoot');\n  }\n\n  navigate(fragment, options) {\n    mi('navigate');\n  }\n\n  navigateBack() {\n    mi('navigateBack');\n  }\n\n  setTitle(title) {\n    mi('setTitle');\n  }\n\n  setState(key, value) {\n    mi('setState');\n  }\n\n  getState(key) {\n    mi('getState');\n  }\n\n  getHistoryIndex() {\n    mi('getHistoryIndex');\n  }\n\n  go(movement) {\n    mi('go');\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1oaXN0b3J5L2Rpc3QvZXMyMDE1L2F1cmVsaWEtaGlzdG9yeS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLWhpc3RvcnkvZGlzdC9lczIwMTUvYXVyZWxpYS1oaXN0b3J5LmpzPzUwZTYiXSwic291cmNlc0NvbnRlbnQiOlsiXG5cbmZ1bmN0aW9uIG1pKG5hbWUpIHtcbiAgdGhyb3cgbmV3IEVycm9yKGBIaXN0b3J5IG11c3QgaW1wbGVtZW50ICR7bmFtZX0oKS5gKTtcbn1cblxuZXhwb3J0IGxldCBIaXN0b3J5ID0gY2xhc3MgSGlzdG9yeSB7XG4gIGFjdGl2YXRlKG9wdGlvbnMpIHtcbiAgICBtaSgnYWN0aXZhdGUnKTtcbiAgfVxuXG4gIGRlYWN0aXZhdGUoKSB7XG4gICAgbWkoJ2RlYWN0aXZhdGUnKTtcbiAgfVxuXG4gIGdldEFic29sdXRlUm9vdCgpIHtcbiAgICBtaSgnZ2V0QWJzb2x1dGVSb290Jyk7XG4gIH1cblxuICBuYXZpZ2F0ZShmcmFnbWVudCwgb3B0aW9ucykge1xuICAgIG1pKCduYXZpZ2F0ZScpO1xuICB9XG5cbiAgbmF2aWdhdGVCYWNrKCkge1xuICAgIG1pKCduYXZpZ2F0ZUJhY2snKTtcbiAgfVxuXG4gIHNldFRpdGxlKHRpdGxlKSB7XG4gICAgbWkoJ3NldFRpdGxlJyk7XG4gIH1cblxuICBzZXRTdGF0ZShrZXksIHZhbHVlKSB7XG4gICAgbWkoJ3NldFN0YXRlJyk7XG4gIH1cblxuICBnZXRTdGF0ZShrZXkpIHtcbiAgICBtaSgnZ2V0U3RhdGUnKTtcbiAgfVxuXG4gIGdldEhpc3RvcnlJbmRleCgpIHtcbiAgICBtaSgnZ2V0SGlzdG9yeUluZGV4Jyk7XG4gIH1cblxuICBnbyhtb3ZlbWVudCkge1xuICAgIG1pKCdnbycpO1xuICB9XG59OyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/aurelia-history/dist/es2015/aurelia-history.js\n");

/***/ }),

/***/ "./node_modules/aurelia-loader-webpack/dist/es2015/aurelia-loader-webpack.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/aurelia-loader-webpack/dist/es2015/aurelia-loader-webpack.js ***!
  \***********************************************************************************/
/*! exports provided: TextTemplateLoader, ensureOriginOnExports, WebpackLoader */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(module) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TextTemplateLoader\", function() { return TextTemplateLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ensureOriginOnExports\", function() { return ensureOriginOnExports; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"WebpackLoader\", function() { return WebpackLoader; });\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-metadata */ \"./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js\");\n/* harmony import */ var aurelia_loader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-loader */ \"./node_modules/aurelia-loader/dist/es2015/aurelia-loader.js\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n\n\n\n/**\n* An implementation of the TemplateLoader interface implemented with text-based loading.\n*/\nclass TextTemplateLoader {\n    /**\n    * Loads a template.\n    * @param loader The loader that is requesting the template load.\n    * @param entry The TemplateRegistryEntry to load and populate with a template.\n    * @return A promise which resolves when the TemplateRegistryEntry is loaded with a template.\n    */\n    loadTemplate(loader, entry) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const text = yield loader.loadText(entry.address);\n            entry.template = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createTemplateFromMarkup(text);\n        });\n    }\n}\nfunction ensureOriginOnExports(moduleExports, moduleId) {\n    let target = moduleExports;\n    let key;\n    let exportedValue;\n    if (target.__useDefault) {\n        target = target.default;\n    }\n    aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"Origin\"].set(target, new aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"Origin\"](moduleId, 'default'));\n    if (typeof target === 'object') {\n        for (key in target) {\n            exportedValue = target[key];\n            if (typeof exportedValue === 'function') {\n                aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"Origin\"].set(exportedValue, new aurelia_metadata__WEBPACK_IMPORTED_MODULE_0__[\"Origin\"](moduleId, key));\n            }\n        }\n    }\n    return moduleExports;\n}\n/**\n* A default implementation of the Loader abstraction which works with webpack (extended common-js style).\n*/\nclass WebpackLoader extends aurelia_loader__WEBPACK_IMPORTED_MODULE_1__[\"Loader\"] {\n    constructor() {\n        super();\n        this.moduleRegistry = Object.create(null);\n        this.loaderPlugins = Object.create(null);\n        this.modulesBeingLoaded = new Map();\n        this.useTemplateLoader(new TextTemplateLoader());\n        this.addPlugin('template-registry-entry', {\n            fetch: (moduleId) => __awaiter(this, void 0, void 0, function* () {\n                // HMR:\n                if (false) {}\n                const entry = this.getOrCreateTemplateRegistryEntry(moduleId);\n                if (!entry.templateIsLoaded) {\n                    yield this.templateLoader.loadTemplate(this, entry);\n                }\n                return entry;\n            })\n        });\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"PLATFORM\"].eachModule = callback => {\n            const registry = __webpack_require__.c;\n            const cachedModuleIds = Object.getOwnPropertyNames(registry);\n            cachedModuleIds\n                // Note: we use .some here like a .forEach that can be \"break\"ed out of.\n                // It will stop iterating only when a truthy value is returned.\n                // Even though the docs say \"true\" explicitly, loader-default also goes by truthy\n                // and this is to keep it consistent with that.\n                .some(moduleId => {\n                const moduleExports = registry[moduleId].exports;\n                if (typeof moduleExports === 'object') {\n                    return callback(moduleId, moduleExports);\n                }\n                return false;\n            });\n        };\n    }\n    _import(address, defaultHMR = true) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const addressParts = address.split('!');\n            const moduleId = addressParts.splice(addressParts.length - 1, 1)[0];\n            const loaderPlugin = addressParts.length === 1 ? addressParts[0] : null;\n            if (loaderPlugin) {\n                const plugin = this.loaderPlugins[loaderPlugin];\n                if (!plugin) {\n                    throw new Error(`Plugin ${loaderPlugin} is not registered in the loader.`);\n                }\n                if (false) {}\n                return yield plugin.fetch(moduleId);\n            }\n            if (__webpack_require__.m[moduleId]) {\n                if (defaultHMR && module.hot && this.hmrContext) {\n                    module.hot.accept(moduleId, () => this.hmrContext.handleModuleChange(moduleId, module.hot));\n                }\n                return __webpack_require__(moduleId);\n            }\n            const asyncModuleId = `async!${moduleId}`;\n            if (__webpack_require__.m[asyncModuleId]) {\n                if (defaultHMR && module.hot && this.hmrContext) {\n                    module.hot.accept(moduleId, () => this.hmrContext.handleModuleChange(moduleId, module.hot));\n                    module.hot.accept(asyncModuleId, () => this.hmrContext.handleModuleChange(moduleId, module.hot));\n                }\n                const callback = __webpack_require__(asyncModuleId);\n                return yield new Promise(callback);\n            }\n            throw new Error(`Unable to find module with ID: ${moduleId}`);\n        });\n    }\n    /**\n    * Maps a module id to a source.\n    * @param id The module id.\n    * @param source The source to map the module to.\n    */\n    map(id, source) { }\n    /**\n    * Normalizes a module id.\n    * @param moduleId The module id to normalize.\n    * @param relativeTo What the module id should be normalized relative to.\n    * @return The normalized module id.\n    */\n    normalizeSync(moduleId, relativeTo) {\n        return moduleId;\n    }\n    /**\n    * Normalizes a module id.\n    * @param moduleId The module id to normalize.\n    * @param relativeTo What the module id should be normalized relative to.\n    * @return The normalized module id.\n    */\n    normalize(moduleId, relativeTo) {\n        return Promise.resolve(moduleId);\n    }\n    /**\n    * Instructs the loader to use a specific TemplateLoader instance for loading templates\n    * @param templateLoader The instance of TemplateLoader to use for loading templates.\n    */\n    useTemplateLoader(templateLoader) {\n        this.templateLoader = templateLoader;\n    }\n    /**\n    * Loads a collection of modules.\n    * @param ids The set of module ids to load.\n    * @return A Promise for an array of loaded modules.\n    */\n    loadAllModules(ids) {\n        return Promise.all(ids.map(id => this.loadModule(id)));\n    }\n    /**\n    * Loads a module.\n    * @param moduleId The module ID to load.\n    * @return A Promise for the loaded module.\n    */\n    loadModule(moduleId, defaultHMR = true) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let existing = this.moduleRegistry[moduleId];\n            if (existing) {\n                return existing;\n            }\n            let beingLoaded = this.modulesBeingLoaded.get(moduleId);\n            if (beingLoaded) {\n                return beingLoaded;\n            }\n            beingLoaded = this._import(moduleId, defaultHMR);\n            this.modulesBeingLoaded.set(moduleId, beingLoaded);\n            const moduleExports = yield beingLoaded;\n            this.moduleRegistry[moduleId] = ensureOriginOnExports(moduleExports, moduleId);\n            this.modulesBeingLoaded.delete(moduleId);\n            return moduleExports;\n        });\n    }\n    /**\n    * Loads a template.\n    * @param url The url of the template to load.\n    * @return A Promise for a TemplateRegistryEntry containing the template.\n    */\n    loadTemplate(url) {\n        return this.loadModule(this.applyPluginToUrl(url, 'template-registry-entry'), false);\n    }\n    /**\n    * Loads a text-based resource.\n    * @param url The url of the text file to load.\n    * @return A Promise for text content.\n    */\n    loadText(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = yield this.loadModule(url, false);\n            if (result instanceof Array && result[0] instanceof Array && result.hasOwnProperty('toString')) {\n                // we're dealing with a file loaded using the css-loader:\n                return result.toString();\n            }\n            return result;\n        });\n    }\n    /**\n    * Alters a module id so that it includes a plugin loader.\n    * @param url The url of the module to load.\n    * @param pluginName The plugin to apply to the module id.\n    * @return The plugin-based module id.\n    */\n    applyPluginToUrl(url, pluginName) {\n        return `${pluginName}!${url}`;\n    }\n    /**\n    * Registers a plugin with the loader.\n    * @param pluginName The name of the plugin.\n    * @param implementation The plugin implementation.\n    */\n    addPlugin(pluginName, implementation) {\n        this.loaderPlugins[pluginName] = implementation;\n    }\n}\naurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"PLATFORM\"].Loader = WebpackLoader;\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../webpack/buildin/harmony-module.js */ \"./node_modules/webpack/buildin/harmony-module.js\")(module)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1sb2FkZXItd2VicGFjay9kaXN0L2VzMjAxNS9hdXJlbGlhLWxvYWRlci13ZWJwYWNrLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2F1cmVsaWEtbG9hZGVyLXdlYnBhY2svZGlzdC9lczIwMTUvYXVyZWxpYS1sb2FkZXItd2VicGFjay5qcz9mMGQzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgT3JpZ2luIH0gZnJvbSAnYXVyZWxpYS1tZXRhZGF0YSc7XG5pbXBvcnQgeyBMb2FkZXIgfSBmcm9tICdhdXJlbGlhLWxvYWRlcic7XG5pbXBvcnQgeyBET00sIFBMQVRGT1JNIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuLyoqXG4qIEFuIGltcGxlbWVudGF0aW9uIG9mIHRoZSBUZW1wbGF0ZUxvYWRlciBpbnRlcmZhY2UgaW1wbGVtZW50ZWQgd2l0aCB0ZXh0LWJhc2VkIGxvYWRpbmcuXG4qL1xuZXhwb3J0IGNsYXNzIFRleHRUZW1wbGF0ZUxvYWRlciB7XG4gICAgLyoqXG4gICAgKiBMb2FkcyBhIHRlbXBsYXRlLlxuICAgICogQHBhcmFtIGxvYWRlciBUaGUgbG9hZGVyIHRoYXQgaXMgcmVxdWVzdGluZyB0aGUgdGVtcGxhdGUgbG9hZC5cbiAgICAqIEBwYXJhbSBlbnRyeSBUaGUgVGVtcGxhdGVSZWdpc3RyeUVudHJ5IHRvIGxvYWQgYW5kIHBvcHVsYXRlIHdpdGggYSB0ZW1wbGF0ZS5cbiAgICAqIEByZXR1cm4gQSBwcm9taXNlIHdoaWNoIHJlc29sdmVzIHdoZW4gdGhlIFRlbXBsYXRlUmVnaXN0cnlFbnRyeSBpcyBsb2FkZWQgd2l0aCBhIHRlbXBsYXRlLlxuICAgICovXG4gICAgbG9hZFRlbXBsYXRlKGxvYWRlciwgZW50cnkpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSB5aWVsZCBsb2FkZXIubG9hZFRleHQoZW50cnkuYWRkcmVzcyk7XG4gICAgICAgICAgICBlbnRyeS50ZW1wbGF0ZSA9IERPTS5jcmVhdGVUZW1wbGF0ZUZyb21NYXJrdXAodGV4dCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBlbnN1cmVPcmlnaW5PbkV4cG9ydHMobW9kdWxlRXhwb3J0cywgbW9kdWxlSWQpIHtcbiAgICBsZXQgdGFyZ2V0ID0gbW9kdWxlRXhwb3J0cztcbiAgICBsZXQga2V5O1xuICAgIGxldCBleHBvcnRlZFZhbHVlO1xuICAgIGlmICh0YXJnZXQuX191c2VEZWZhdWx0KSB7XG4gICAgICAgIHRhcmdldCA9IHRhcmdldC5kZWZhdWx0O1xuICAgIH1cbiAgICBPcmlnaW4uc2V0KHRhcmdldCwgbmV3IE9yaWdpbihtb2R1bGVJZCwgJ2RlZmF1bHQnKSk7XG4gICAgaWYgKHR5cGVvZiB0YXJnZXQgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGZvciAoa2V5IGluIHRhcmdldCkge1xuICAgICAgICAgICAgZXhwb3J0ZWRWYWx1ZSA9IHRhcmdldFtrZXldO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBleHBvcnRlZFZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgT3JpZ2luLnNldChleHBvcnRlZFZhbHVlLCBuZXcgT3JpZ2luKG1vZHVsZUlkLCBrZXkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbW9kdWxlRXhwb3J0cztcbn1cbi8qKlxuKiBBIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgdGhlIExvYWRlciBhYnN0cmFjdGlvbiB3aGljaCB3b3JrcyB3aXRoIHdlYnBhY2sgKGV4dGVuZGVkIGNvbW1vbi1qcyBzdHlsZSkuXG4qL1xuZXhwb3J0IGNsYXNzIFdlYnBhY2tMb2FkZXIgZXh0ZW5kcyBMb2FkZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLm1vZHVsZVJlZ2lzdHJ5ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgdGhpcy5sb2FkZXJQbHVnaW5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgdGhpcy5tb2R1bGVzQmVpbmdMb2FkZWQgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMudXNlVGVtcGxhdGVMb2FkZXIobmV3IFRleHRUZW1wbGF0ZUxvYWRlcigpKTtcbiAgICAgICAgdGhpcy5hZGRQbHVnaW4oJ3RlbXBsYXRlLXJlZ2lzdHJ5LWVudHJ5Jywge1xuICAgICAgICAgICAgZmV0Y2g6IChtb2R1bGVJZCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIC8vIEhNUjpcbiAgICAgICAgICAgICAgICBpZiAobW9kdWxlLmhvdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaG1yQ29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90ZTogUGxlYXNlIGRvIE5PVCBpbXBvcnQgYXVyZWxpYS1ob3QtbW9kdWxlLXJlbG9hZCBzdGF0aWNhbGx5IGF0IHRoZSB0b3Agb2YgZmlsZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgIFdlIGRvbid0IHdhbnQgdG8gYnVuZGxlIGl0IHdoZW4gbm90IHVzaW5nIC0taG90LCBpbiBwYXJ0aWN1bGFyIGluIHByb2R1Y3Rpb24gYnVpbGRzLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgV2VicGFjayB3aWxsIGV2YWx1YXRlIHRoZSBgaWYgKG1vZHVsZS5ob3QpYCBhYm92ZSBhdCBidWlsZCB0aW1lIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgYW5kIHdpbGwgaW5jbHVkZSAob3Igbm90KSBhdXJlbGlhLWhvdC1tb2R1bGUtcmVsb2FkIGFjY29yZGluZ2x5LlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBIbXJDb250ZXh0IH0gPSByZXF1aXJlKCdhdXJlbGlhLWhvdC1tb2R1bGUtcmVsb2FkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhtckNvbnRleHQgPSBuZXcgSG1yQ29udGV4dCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBtb2R1bGUuaG90LmFjY2VwdChtb2R1bGVJZCwgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5obXJDb250ZXh0LmhhbmRsZVZpZXdDaGFuZ2UobW9kdWxlSWQpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5nZXRPckNyZWF0ZVRlbXBsYXRlUmVnaXN0cnlFbnRyeShtb2R1bGVJZCk7XG4gICAgICAgICAgICAgICAgaWYgKCFlbnRyeS50ZW1wbGF0ZUlzTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMudGVtcGxhdGVMb2FkZXIubG9hZFRlbXBsYXRlKHRoaXMsIGVudHJ5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVudHJ5O1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIFBMQVRGT1JNLmVhY2hNb2R1bGUgPSBjYWxsYmFjayA9PiB7XG4gICAgICAgICAgICBjb25zdCByZWdpc3RyeSA9IF9fd2VicGFja19yZXF1aXJlX18uYztcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZE1vZHVsZUlkcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHJlZ2lzdHJ5KTtcbiAgICAgICAgICAgIGNhY2hlZE1vZHVsZUlkc1xuICAgICAgICAgICAgICAgIC8vIE5vdGU6IHdlIHVzZSAuc29tZSBoZXJlIGxpa2UgYSAuZm9yRWFjaCB0aGF0IGNhbiBiZSBcImJyZWFrXCJlZCBvdXQgb2YuXG4gICAgICAgICAgICAgICAgLy8gSXQgd2lsbCBzdG9wIGl0ZXJhdGluZyBvbmx5IHdoZW4gYSB0cnV0aHkgdmFsdWUgaXMgcmV0dXJuZWQuXG4gICAgICAgICAgICAgICAgLy8gRXZlbiB0aG91Z2ggdGhlIGRvY3Mgc2F5IFwidHJ1ZVwiIGV4cGxpY2l0bHksIGxvYWRlci1kZWZhdWx0IGFsc28gZ29lcyBieSB0cnV0aHlcbiAgICAgICAgICAgICAgICAvLyBhbmQgdGhpcyBpcyB0byBrZWVwIGl0IGNvbnNpc3RlbnQgd2l0aCB0aGF0LlxuICAgICAgICAgICAgICAgIC5zb21lKG1vZHVsZUlkID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2R1bGVFeHBvcnRzID0gcmVnaXN0cnlbbW9kdWxlSWRdLmV4cG9ydHM7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtb2R1bGVFeHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2sobW9kdWxlSWQsIG1vZHVsZUV4cG9ydHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgX2ltcG9ydChhZGRyZXNzLCBkZWZhdWx0SE1SID0gdHJ1ZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgYWRkcmVzc1BhcnRzID0gYWRkcmVzcy5zcGxpdCgnIScpO1xuICAgICAgICAgICAgY29uc3QgbW9kdWxlSWQgPSBhZGRyZXNzUGFydHMuc3BsaWNlKGFkZHJlc3NQYXJ0cy5sZW5ndGggLSAxLCAxKVswXTtcbiAgICAgICAgICAgIGNvbnN0IGxvYWRlclBsdWdpbiA9IGFkZHJlc3NQYXJ0cy5sZW5ndGggPT09IDEgPyBhZGRyZXNzUGFydHNbMF0gOiBudWxsO1xuICAgICAgICAgICAgaWYgKGxvYWRlclBsdWdpbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBsdWdpbiA9IHRoaXMubG9hZGVyUGx1Z2luc1tsb2FkZXJQbHVnaW5dO1xuICAgICAgICAgICAgICAgIGlmICghcGx1Z2luKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUGx1Z2luICR7bG9hZGVyUGx1Z2lufSBpcyBub3QgcmVnaXN0ZXJlZCBpbiB0aGUgbG9hZGVyLmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobW9kdWxlLmhvdCAmJiBwbHVnaW4uaG90KSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZHVsZS5ob3QuYWNjZXB0KG1vZHVsZUlkLCAoKSA9PiBwbHVnaW4uaG90KG1vZHVsZUlkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB5aWVsZCBwbHVnaW4uZmV0Y2gobW9kdWxlSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF9fd2VicGFja19yZXF1aXJlX18ubVttb2R1bGVJZF0pIHtcbiAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdEhNUiAmJiBtb2R1bGUuaG90ICYmIHRoaXMuaG1yQ29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBtb2R1bGUuaG90LmFjY2VwdChtb2R1bGVJZCwgKCkgPT4gdGhpcy5obXJDb250ZXh0LmhhbmRsZU1vZHVsZUNoYW5nZShtb2R1bGVJZCwgbW9kdWxlLmhvdCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhc3luY01vZHVsZUlkID0gYGFzeW5jISR7bW9kdWxlSWR9YDtcbiAgICAgICAgICAgIGlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLm1bYXN5bmNNb2R1bGVJZF0pIHtcbiAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdEhNUiAmJiBtb2R1bGUuaG90ICYmIHRoaXMuaG1yQ29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICBtb2R1bGUuaG90LmFjY2VwdChtb2R1bGVJZCwgKCkgPT4gdGhpcy5obXJDb250ZXh0LmhhbmRsZU1vZHVsZUNoYW5nZShtb2R1bGVJZCwgbW9kdWxlLmhvdCkpO1xuICAgICAgICAgICAgICAgICAgICBtb2R1bGUuaG90LmFjY2VwdChhc3luY01vZHVsZUlkLCAoKSA9PiB0aGlzLmhtckNvbnRleHQuaGFuZGxlTW9kdWxlQ2hhbmdlKG1vZHVsZUlkLCBtb2R1bGUuaG90KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXyhhc3luY01vZHVsZUlkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4geWllbGQgbmV3IFByb21pc2UoY2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gZmluZCBtb2R1bGUgd2l0aCBJRDogJHttb2R1bGVJZH1gKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICogTWFwcyBhIG1vZHVsZSBpZCB0byBhIHNvdXJjZS5cbiAgICAqIEBwYXJhbSBpZCBUaGUgbW9kdWxlIGlkLlxuICAgICogQHBhcmFtIHNvdXJjZSBUaGUgc291cmNlIHRvIG1hcCB0aGUgbW9kdWxlIHRvLlxuICAgICovXG4gICAgbWFwKGlkLCBzb3VyY2UpIHsgfVxuICAgIC8qKlxuICAgICogTm9ybWFsaXplcyBhIG1vZHVsZSBpZC5cbiAgICAqIEBwYXJhbSBtb2R1bGVJZCBUaGUgbW9kdWxlIGlkIHRvIG5vcm1hbGl6ZS5cbiAgICAqIEBwYXJhbSByZWxhdGl2ZVRvIFdoYXQgdGhlIG1vZHVsZSBpZCBzaG91bGQgYmUgbm9ybWFsaXplZCByZWxhdGl2ZSB0by5cbiAgICAqIEByZXR1cm4gVGhlIG5vcm1hbGl6ZWQgbW9kdWxlIGlkLlxuICAgICovXG4gICAgbm9ybWFsaXplU3luYyhtb2R1bGVJZCwgcmVsYXRpdmVUbykge1xuICAgICAgICByZXR1cm4gbW9kdWxlSWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICogTm9ybWFsaXplcyBhIG1vZHVsZSBpZC5cbiAgICAqIEBwYXJhbSBtb2R1bGVJZCBUaGUgbW9kdWxlIGlkIHRvIG5vcm1hbGl6ZS5cbiAgICAqIEBwYXJhbSByZWxhdGl2ZVRvIFdoYXQgdGhlIG1vZHVsZSBpZCBzaG91bGQgYmUgbm9ybWFsaXplZCByZWxhdGl2ZSB0by5cbiAgICAqIEByZXR1cm4gVGhlIG5vcm1hbGl6ZWQgbW9kdWxlIGlkLlxuICAgICovXG4gICAgbm9ybWFsaXplKG1vZHVsZUlkLCByZWxhdGl2ZVRvKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobW9kdWxlSWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEluc3RydWN0cyB0aGUgbG9hZGVyIHRvIHVzZSBhIHNwZWNpZmljIFRlbXBsYXRlTG9hZGVyIGluc3RhbmNlIGZvciBsb2FkaW5nIHRlbXBsYXRlc1xuICAgICogQHBhcmFtIHRlbXBsYXRlTG9hZGVyIFRoZSBpbnN0YW5jZSBvZiBUZW1wbGF0ZUxvYWRlciB0byB1c2UgZm9yIGxvYWRpbmcgdGVtcGxhdGVzLlxuICAgICovXG4gICAgdXNlVGVtcGxhdGVMb2FkZXIodGVtcGxhdGVMb2FkZXIpIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUxvYWRlciA9IHRlbXBsYXRlTG9hZGVyO1xuICAgIH1cbiAgICAvKipcbiAgICAqIExvYWRzIGEgY29sbGVjdGlvbiBvZiBtb2R1bGVzLlxuICAgICogQHBhcmFtIGlkcyBUaGUgc2V0IG9mIG1vZHVsZSBpZHMgdG8gbG9hZC5cbiAgICAqIEByZXR1cm4gQSBQcm9taXNlIGZvciBhbiBhcnJheSBvZiBsb2FkZWQgbW9kdWxlcy5cbiAgICAqL1xuICAgIGxvYWRBbGxNb2R1bGVzKGlkcykge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoaWRzLm1hcChpZCA9PiB0aGlzLmxvYWRNb2R1bGUoaWQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICogTG9hZHMgYSBtb2R1bGUuXG4gICAgKiBAcGFyYW0gbW9kdWxlSWQgVGhlIG1vZHVsZSBJRCB0byBsb2FkLlxuICAgICogQHJldHVybiBBIFByb21pc2UgZm9yIHRoZSBsb2FkZWQgbW9kdWxlLlxuICAgICovXG4gICAgbG9hZE1vZHVsZShtb2R1bGVJZCwgZGVmYXVsdEhNUiA9IHRydWUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGxldCBleGlzdGluZyA9IHRoaXMubW9kdWxlUmVnaXN0cnlbbW9kdWxlSWRdO1xuICAgICAgICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4aXN0aW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGJlaW5nTG9hZGVkID0gdGhpcy5tb2R1bGVzQmVpbmdMb2FkZWQuZ2V0KG1vZHVsZUlkKTtcbiAgICAgICAgICAgIGlmIChiZWluZ0xvYWRlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiZWluZ0xvYWRlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJlaW5nTG9hZGVkID0gdGhpcy5faW1wb3J0KG1vZHVsZUlkLCBkZWZhdWx0SE1SKTtcbiAgICAgICAgICAgIHRoaXMubW9kdWxlc0JlaW5nTG9hZGVkLnNldChtb2R1bGVJZCwgYmVpbmdMb2FkZWQpO1xuICAgICAgICAgICAgY29uc3QgbW9kdWxlRXhwb3J0cyA9IHlpZWxkIGJlaW5nTG9hZGVkO1xuICAgICAgICAgICAgdGhpcy5tb2R1bGVSZWdpc3RyeVttb2R1bGVJZF0gPSBlbnN1cmVPcmlnaW5PbkV4cG9ydHMobW9kdWxlRXhwb3J0cywgbW9kdWxlSWQpO1xuICAgICAgICAgICAgdGhpcy5tb2R1bGVzQmVpbmdMb2FkZWQuZGVsZXRlKG1vZHVsZUlkKTtcbiAgICAgICAgICAgIHJldHVybiBtb2R1bGVFeHBvcnRzO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBMb2FkcyBhIHRlbXBsYXRlLlxuICAgICogQHBhcmFtIHVybCBUaGUgdXJsIG9mIHRoZSB0ZW1wbGF0ZSB0byBsb2FkLlxuICAgICogQHJldHVybiBBIFByb21pc2UgZm9yIGEgVGVtcGxhdGVSZWdpc3RyeUVudHJ5IGNvbnRhaW5pbmcgdGhlIHRlbXBsYXRlLlxuICAgICovXG4gICAgbG9hZFRlbXBsYXRlKHVybCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2FkTW9kdWxlKHRoaXMuYXBwbHlQbHVnaW5Ub1VybCh1cmwsICd0ZW1wbGF0ZS1yZWdpc3RyeS1lbnRyeScpLCBmYWxzZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICogTG9hZHMgYSB0ZXh0LWJhc2VkIHJlc291cmNlLlxuICAgICogQHBhcmFtIHVybCBUaGUgdXJsIG9mIHRoZSB0ZXh0IGZpbGUgdG8gbG9hZC5cbiAgICAqIEByZXR1cm4gQSBQcm9taXNlIGZvciB0ZXh0IGNvbnRlbnQuXG4gICAgKi9cbiAgICBsb2FkVGV4dCh1cmwpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHlpZWxkIHRoaXMubG9hZE1vZHVsZSh1cmwsIGZhbHNlKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBBcnJheSAmJiByZXN1bHRbMF0gaW5zdGFuY2VvZiBBcnJheSAmJiByZXN1bHQuaGFzT3duUHJvcGVydHkoJ3RvU3RyaW5nJykpIHtcbiAgICAgICAgICAgICAgICAvLyB3ZSdyZSBkZWFsaW5nIHdpdGggYSBmaWxlIGxvYWRlZCB1c2luZyB0aGUgY3NzLWxvYWRlcjpcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBBbHRlcnMgYSBtb2R1bGUgaWQgc28gdGhhdCBpdCBpbmNsdWRlcyBhIHBsdWdpbiBsb2FkZXIuXG4gICAgKiBAcGFyYW0gdXJsIFRoZSB1cmwgb2YgdGhlIG1vZHVsZSB0byBsb2FkLlxuICAgICogQHBhcmFtIHBsdWdpbk5hbWUgVGhlIHBsdWdpbiB0byBhcHBseSB0byB0aGUgbW9kdWxlIGlkLlxuICAgICogQHJldHVybiBUaGUgcGx1Z2luLWJhc2VkIG1vZHVsZSBpZC5cbiAgICAqL1xuICAgIGFwcGx5UGx1Z2luVG9VcmwodXJsLCBwbHVnaW5OYW1lKSB7XG4gICAgICAgIHJldHVybiBgJHtwbHVnaW5OYW1lfSEke3VybH1gO1xuICAgIH1cbiAgICAvKipcbiAgICAqIFJlZ2lzdGVycyBhIHBsdWdpbiB3aXRoIHRoZSBsb2FkZXIuXG4gICAgKiBAcGFyYW0gcGx1Z2luTmFtZSBUaGUgbmFtZSBvZiB0aGUgcGx1Z2luLlxuICAgICogQHBhcmFtIGltcGxlbWVudGF0aW9uIFRoZSBwbHVnaW4gaW1wbGVtZW50YXRpb24uXG4gICAgKi9cbiAgICBhZGRQbHVnaW4ocGx1Z2luTmFtZSwgaW1wbGVtZW50YXRpb24pIHtcbiAgICAgICAgdGhpcy5sb2FkZXJQbHVnaW5zW3BsdWdpbk5hbWVdID0gaW1wbGVtZW50YXRpb247XG4gICAgfVxufVxuUExBVEZPUk0uTG9hZGVyID0gV2VicGFja0xvYWRlcjtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/aurelia-loader-webpack/dist/es2015/aurelia-loader-webpack.js\n");

/***/ }),

/***/ "./node_modules/aurelia-loader/dist/es2015/aurelia-loader.js":
/*!*******************************************************************!*\
  !*** ./node_modules/aurelia-loader/dist/es2015/aurelia-loader.js ***!
  \*******************************************************************/
/*! exports provided: TemplateDependency, TemplateRegistryEntry, Loader */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplateDependency\", function() { return TemplateDependency; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplateRegistryEntry\", function() { return TemplateRegistryEntry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Loader\", function() { return Loader; });\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-path */ \"./node_modules/aurelia-path/dist/es2015/aurelia-path.js\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-metadata */ \"./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js\");\n\n\n\nlet TemplateDependency = class TemplateDependency {\n  constructor(src, name) {\n    this.src = src;\n    this.name = name;\n  }\n};\n\nlet TemplateRegistryEntry = class TemplateRegistryEntry {\n  constructor(address) {\n    this.templateIsLoaded = false;\n    this.factoryIsReady = false;\n    this.resources = null;\n    this.dependencies = null;\n\n    this.address = address;\n    this.onReady = null;\n    this._template = null;\n    this._factory = null;\n  }\n\n  get template() {\n    return this._template;\n  }\n\n  set template(value) {\n    let address = this.address;\n    let requires;\n    let current;\n    let src;\n    let dependencies;\n\n    this._template = value;\n    this.templateIsLoaded = true;\n\n    requires = value.content.querySelectorAll('require');\n    dependencies = this.dependencies = new Array(requires.length);\n\n    for (let i = 0, ii = requires.length; i < ii; ++i) {\n      current = requires[i];\n      src = current.getAttribute('from');\n\n      if (!src) {\n        throw new Error(`<require> element in ${address} has no \"from\" attribute.`);\n      }\n\n      dependencies[i] = new TemplateDependency(Object(aurelia_path__WEBPACK_IMPORTED_MODULE_0__[\"relativeToFile\"])(src, address), current.getAttribute('as'));\n\n      if (current.parentNode) {\n        current.parentNode.removeChild(current);\n      }\n    }\n  }\n\n  get factory() {\n    return this._factory;\n  }\n\n  set factory(value) {\n    this._factory = value;\n    this.factoryIsReady = true;\n  }\n\n  addDependency(src, name) {\n    let finalSrc = typeof src === 'string' ? Object(aurelia_path__WEBPACK_IMPORTED_MODULE_0__[\"relativeToFile\"])(src, this.address) : aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(src).moduleId;\n\n    this.dependencies.push(new TemplateDependency(finalSrc, name));\n  }\n};\n\nlet Loader = class Loader {\n  constructor() {\n    this.templateRegistry = {};\n  }\n\n  map(id, source) {\n    throw new Error('Loaders must implement map(id, source).');\n  }\n\n  normalizeSync(moduleId, relativeTo) {\n    throw new Error('Loaders must implement normalizeSync(moduleId, relativeTo).');\n  }\n\n  normalize(moduleId, relativeTo) {\n    throw new Error('Loaders must implement normalize(moduleId: string, relativeTo: string): Promise<string>.');\n  }\n\n  loadModule(id) {\n    throw new Error('Loaders must implement loadModule(id).');\n  }\n\n  loadAllModules(ids) {\n    throw new Error('Loader must implement loadAllModules(ids).');\n  }\n\n  loadTemplate(url) {\n    throw new Error('Loader must implement loadTemplate(url).');\n  }\n\n  loadText(url) {\n    throw new Error('Loader must implement loadText(url).');\n  }\n\n  applyPluginToUrl(url, pluginName) {\n    throw new Error('Loader must implement applyPluginToUrl(url, pluginName).');\n  }\n\n  addPlugin(pluginName, implementation) {\n    throw new Error('Loader must implement addPlugin(pluginName, implementation).');\n  }\n\n  getOrCreateTemplateRegistryEntry(address) {\n    return this.templateRegistry[address] || (this.templateRegistry[address] = new TemplateRegistryEntry(address));\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1sb2FkZXIvZGlzdC9lczIwMTUvYXVyZWxpYS1sb2FkZXIuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1sb2FkZXIvZGlzdC9lczIwMTUvYXVyZWxpYS1sb2FkZXIuanM/ZTNjZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZWxhdGl2ZVRvRmlsZSB9IGZyb20gJ2F1cmVsaWEtcGF0aCc7XG5pbXBvcnQgeyBPcmlnaW4gfSBmcm9tICdhdXJlbGlhLW1ldGFkYXRhJztcblxuZXhwb3J0IGxldCBUZW1wbGF0ZURlcGVuZGVuY3kgPSBjbGFzcyBUZW1wbGF0ZURlcGVuZGVuY3kge1xuICBjb25zdHJ1Y3RvcihzcmMsIG5hbWUpIHtcbiAgICB0aGlzLnNyYyA9IHNyYztcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IFRlbXBsYXRlUmVnaXN0cnlFbnRyeSA9IGNsYXNzIFRlbXBsYXRlUmVnaXN0cnlFbnRyeSB7XG4gIGNvbnN0cnVjdG9yKGFkZHJlc3MpIHtcbiAgICB0aGlzLnRlbXBsYXRlSXNMb2FkZWQgPSBmYWxzZTtcbiAgICB0aGlzLmZhY3RvcnlJc1JlYWR5ID0gZmFsc2U7XG4gICAgdGhpcy5yZXNvdXJjZXMgPSBudWxsO1xuICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gbnVsbDtcblxuICAgIHRoaXMuYWRkcmVzcyA9IGFkZHJlc3M7XG4gICAgdGhpcy5vblJlYWR5ID0gbnVsbDtcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IG51bGw7XG4gICAgdGhpcy5fZmFjdG9yeSA9IG51bGw7XG4gIH1cblxuICBnZXQgdGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlO1xuICB9XG5cbiAgc2V0IHRlbXBsYXRlKHZhbHVlKSB7XG4gICAgbGV0IGFkZHJlc3MgPSB0aGlzLmFkZHJlc3M7XG4gICAgbGV0IHJlcXVpcmVzO1xuICAgIGxldCBjdXJyZW50O1xuICAgIGxldCBzcmM7XG4gICAgbGV0IGRlcGVuZGVuY2llcztcblxuICAgIHRoaXMuX3RlbXBsYXRlID0gdmFsdWU7XG4gICAgdGhpcy50ZW1wbGF0ZUlzTG9hZGVkID0gdHJ1ZTtcblxuICAgIHJlcXVpcmVzID0gdmFsdWUuY29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCdyZXF1aXJlJyk7XG4gICAgZGVwZW5kZW5jaWVzID0gdGhpcy5kZXBlbmRlbmNpZXMgPSBuZXcgQXJyYXkocmVxdWlyZXMubGVuZ3RoKTtcblxuICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHJlcXVpcmVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGN1cnJlbnQgPSByZXF1aXJlc1tpXTtcbiAgICAgIHNyYyA9IGN1cnJlbnQuZ2V0QXR0cmlidXRlKCdmcm9tJyk7XG5cbiAgICAgIGlmICghc3JjKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgPHJlcXVpcmU+IGVsZW1lbnQgaW4gJHthZGRyZXNzfSBoYXMgbm8gXCJmcm9tXCIgYXR0cmlidXRlLmApO1xuICAgICAgfVxuXG4gICAgICBkZXBlbmRlbmNpZXNbaV0gPSBuZXcgVGVtcGxhdGVEZXBlbmRlbmN5KHJlbGF0aXZlVG9GaWxlKHNyYywgYWRkcmVzcyksIGN1cnJlbnQuZ2V0QXR0cmlidXRlKCdhcycpKTtcblxuICAgICAgaWYgKGN1cnJlbnQucGFyZW50Tm9kZSkge1xuICAgICAgICBjdXJyZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY3VycmVudCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0IGZhY3RvcnkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZhY3Rvcnk7XG4gIH1cblxuICBzZXQgZmFjdG9yeSh2YWx1ZSkge1xuICAgIHRoaXMuX2ZhY3RvcnkgPSB2YWx1ZTtcbiAgICB0aGlzLmZhY3RvcnlJc1JlYWR5ID0gdHJ1ZTtcbiAgfVxuXG4gIGFkZERlcGVuZGVuY3koc3JjLCBuYW1lKSB7XG4gICAgbGV0IGZpbmFsU3JjID0gdHlwZW9mIHNyYyA9PT0gJ3N0cmluZycgPyByZWxhdGl2ZVRvRmlsZShzcmMsIHRoaXMuYWRkcmVzcykgOiBPcmlnaW4uZ2V0KHNyYykubW9kdWxlSWQ7XG5cbiAgICB0aGlzLmRlcGVuZGVuY2llcy5wdXNoKG5ldyBUZW1wbGF0ZURlcGVuZGVuY3koZmluYWxTcmMsIG5hbWUpKTtcbiAgfVxufTtcblxuZXhwb3J0IGxldCBMb2FkZXIgPSBjbGFzcyBMb2FkZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnRlbXBsYXRlUmVnaXN0cnkgPSB7fTtcbiAgfVxuXG4gIG1hcChpZCwgc291cmNlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdMb2FkZXJzIG11c3QgaW1wbGVtZW50IG1hcChpZCwgc291cmNlKS4nKTtcbiAgfVxuXG4gIG5vcm1hbGl6ZVN5bmMobW9kdWxlSWQsIHJlbGF0aXZlVG8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvYWRlcnMgbXVzdCBpbXBsZW1lbnQgbm9ybWFsaXplU3luYyhtb2R1bGVJZCwgcmVsYXRpdmVUbykuJyk7XG4gIH1cblxuICBub3JtYWxpemUobW9kdWxlSWQsIHJlbGF0aXZlVG8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvYWRlcnMgbXVzdCBpbXBsZW1lbnQgbm9ybWFsaXplKG1vZHVsZUlkOiBzdHJpbmcsIHJlbGF0aXZlVG86IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPi4nKTtcbiAgfVxuXG4gIGxvYWRNb2R1bGUoaWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvYWRlcnMgbXVzdCBpbXBsZW1lbnQgbG9hZE1vZHVsZShpZCkuJyk7XG4gIH1cblxuICBsb2FkQWxsTW9kdWxlcyhpZHMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvYWRlciBtdXN0IGltcGxlbWVudCBsb2FkQWxsTW9kdWxlcyhpZHMpLicpO1xuICB9XG5cbiAgbG9hZFRlbXBsYXRlKHVybCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTG9hZGVyIG11c3QgaW1wbGVtZW50IGxvYWRUZW1wbGF0ZSh1cmwpLicpO1xuICB9XG5cbiAgbG9hZFRleHQodXJsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdMb2FkZXIgbXVzdCBpbXBsZW1lbnQgbG9hZFRleHQodXJsKS4nKTtcbiAgfVxuXG4gIGFwcGx5UGx1Z2luVG9VcmwodXJsLCBwbHVnaW5OYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdMb2FkZXIgbXVzdCBpbXBsZW1lbnQgYXBwbHlQbHVnaW5Ub1VybCh1cmwsIHBsdWdpbk5hbWUpLicpO1xuICB9XG5cbiAgYWRkUGx1Z2luKHBsdWdpbk5hbWUsIGltcGxlbWVudGF0aW9uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdMb2FkZXIgbXVzdCBpbXBsZW1lbnQgYWRkUGx1Z2luKHBsdWdpbk5hbWUsIGltcGxlbWVudGF0aW9uKS4nKTtcbiAgfVxuXG4gIGdldE9yQ3JlYXRlVGVtcGxhdGVSZWdpc3RyeUVudHJ5KGFkZHJlc3MpIHtcbiAgICByZXR1cm4gdGhpcy50ZW1wbGF0ZVJlZ2lzdHJ5W2FkZHJlc3NdIHx8ICh0aGlzLnRlbXBsYXRlUmVnaXN0cnlbYWRkcmVzc10gPSBuZXcgVGVtcGxhdGVSZWdpc3RyeUVudHJ5KGFkZHJlc3MpKTtcbiAgfVxufTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/aurelia-loader/dist/es2015/aurelia-loader.js\n");

/***/ }),

/***/ "./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js":
/*!*********************************************************************!*\
  !*** ./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js ***!
  \*********************************************************************/
/*! exports provided: logLevel, getLogger, addAppender, removeAppender, getAppenders, clearAppenders, addCustomLevel, removeCustomLevel, setLevel, getLevel, Logger */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"logLevel\", function() { return logLevel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getLogger\", function() { return getLogger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addAppender\", function() { return addAppender; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"removeAppender\", function() { return removeAppender; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAppenders\", function() { return getAppenders; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clearAppenders\", function() { return clearAppenders; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addCustomLevel\", function() { return addCustomLevel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"removeCustomLevel\", function() { return removeCustomLevel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setLevel\", function() { return setLevel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getLevel\", function() { return getLevel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Logger\", function() { return Logger; });\n\nconst logLevel = {\n  none: 0,\n  error: 10,\n  warn: 20,\n  info: 30,\n  debug: 40\n};\n\nlet loggers = {};\nlet appenders = [];\nlet globalDefaultLevel = logLevel.none;\n\nconst standardLevels = ['none', 'error', 'warn', 'info', 'debug'];\nfunction isStandardLevel(level) {\n  return standardLevels.filter(l => l === level).length > 0;\n}\n\nfunction appendArgs() {\n  return [this, ...arguments];\n}\n\nfunction logFactory(level) {\n  const threshold = logLevel[level];\n  return function () {\n    if (this.level < threshold) {\n      return;\n    }\n\n    const args = appendArgs.apply(this, arguments);\n    let i = appenders.length;\n    while (i--) {\n      appenders[i][level](...args);\n    }\n  };\n}\n\nfunction logFactoryCustom(level) {\n  const threshold = logLevel[level];\n  return function () {\n    if (this.level < threshold) {\n      return;\n    }\n\n    const args = appendArgs.apply(this, arguments);\n    let i = appenders.length;\n    while (i--) {\n      const appender = appenders[i];\n      if (appender[level] !== undefined) {\n        appender[level](...args);\n      }\n    }\n  };\n}\n\nfunction connectLoggers() {\n  let proto = Logger.prototype;\n  for (let level in logLevel) {\n    if (isStandardLevel(level)) {\n      if (level !== 'none') {\n        proto[level] = logFactory(level);\n      }\n    } else {\n      proto[level] = logFactoryCustom(level);\n    }\n  }\n}\n\nfunction disconnectLoggers() {\n  let proto = Logger.prototype;\n  for (let level in logLevel) {\n    if (level !== 'none') {\n      proto[level] = function () {};\n    }\n  }\n}\n\nfunction getLogger(id) {\n  return loggers[id] || new Logger(id);\n}\n\nfunction addAppender(appender) {\n  if (appenders.push(appender) === 1) {\n    connectLoggers();\n  }\n}\n\nfunction removeAppender(appender) {\n  appenders = appenders.filter(a => a !== appender);\n}\n\nfunction getAppenders() {\n  return [...appenders];\n}\n\nfunction clearAppenders() {\n  appenders = [];\n  disconnectLoggers();\n}\n\nfunction addCustomLevel(name, value) {\n  if (logLevel[name] !== undefined) {\n    throw Error(`Log level \"${name}\" already exists.`);\n  }\n\n  if (isNaN(value)) {\n    throw Error('Value must be a number.');\n  }\n\n  logLevel[name] = value;\n\n  if (appenders.length > 0) {\n    connectLoggers();\n  } else {\n    Logger.prototype[name] = function () {};\n  }\n}\n\nfunction removeCustomLevel(name) {\n  if (logLevel[name] === undefined) {\n    return;\n  }\n\n  if (isStandardLevel(name)) {\n    throw Error(`Built-in log level \"${name}\" cannot be removed.`);\n  }\n\n  delete logLevel[name];\n  delete Logger.prototype[name];\n}\n\nfunction setLevel(level) {\n  globalDefaultLevel = level;\n  for (let key in loggers) {\n    loggers[key].setLevel(level);\n  }\n}\n\nfunction getLevel() {\n  return globalDefaultLevel;\n}\n\nlet Logger = class Logger {\n  constructor(id) {\n    let cached = loggers[id];\n    if (cached) {\n      return cached;\n    }\n\n    loggers[id] = this;\n    this.id = id;\n    this.level = globalDefaultLevel;\n  }\n\n  debug(message, ...rest) {}\n\n  info(message, ...rest) {}\n\n  warn(message, ...rest) {}\n\n  error(message, ...rest) {}\n\n  setLevel(level) {\n    this.level = level;\n  }\n\n  isDebugEnabled() {\n    return this.level === logLevel.debug;\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1sb2dnaW5nL2Rpc3QvZXMyMDE1L2F1cmVsaWEtbG9nZ2luZy5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLWxvZ2dpbmcvZGlzdC9lczIwMTUvYXVyZWxpYS1sb2dnaW5nLmpzPzI4YWEiXSwic291cmNlc0NvbnRlbnQiOlsiXG5leHBvcnQgY29uc3QgbG9nTGV2ZWwgPSB7XG4gIG5vbmU6IDAsXG4gIGVycm9yOiAxMCxcbiAgd2FybjogMjAsXG4gIGluZm86IDMwLFxuICBkZWJ1ZzogNDBcbn07XG5cbmxldCBsb2dnZXJzID0ge307XG5sZXQgYXBwZW5kZXJzID0gW107XG5sZXQgZ2xvYmFsRGVmYXVsdExldmVsID0gbG9nTGV2ZWwubm9uZTtcblxuY29uc3Qgc3RhbmRhcmRMZXZlbHMgPSBbJ25vbmUnLCAnZXJyb3InLCAnd2FybicsICdpbmZvJywgJ2RlYnVnJ107XG5mdW5jdGlvbiBpc1N0YW5kYXJkTGV2ZWwobGV2ZWwpIHtcbiAgcmV0dXJuIHN0YW5kYXJkTGV2ZWxzLmZpbHRlcihsID0+IGwgPT09IGxldmVsKS5sZW5ndGggPiAwO1xufVxuXG5mdW5jdGlvbiBhcHBlbmRBcmdzKCkge1xuICByZXR1cm4gW3RoaXMsIC4uLmFyZ3VtZW50c107XG59XG5cbmZ1bmN0aW9uIGxvZ0ZhY3RvcnkobGV2ZWwpIHtcbiAgY29uc3QgdGhyZXNob2xkID0gbG9nTGV2ZWxbbGV2ZWxdO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmxldmVsIDwgdGhyZXNob2xkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgYXJncyA9IGFwcGVuZEFyZ3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBsZXQgaSA9IGFwcGVuZGVycy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgYXBwZW5kZXJzW2ldW2xldmVsXSguLi5hcmdzKTtcbiAgICB9XG4gIH07XG59XG5cbmZ1bmN0aW9uIGxvZ0ZhY3RvcnlDdXN0b20obGV2ZWwpIHtcbiAgY29uc3QgdGhyZXNob2xkID0gbG9nTGV2ZWxbbGV2ZWxdO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmxldmVsIDwgdGhyZXNob2xkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgYXJncyA9IGFwcGVuZEFyZ3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBsZXQgaSA9IGFwcGVuZGVycy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgY29uc3QgYXBwZW5kZXIgPSBhcHBlbmRlcnNbaV07XG4gICAgICBpZiAoYXBwZW5kZXJbbGV2ZWxdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgYXBwZW5kZXJbbGV2ZWxdKC4uLmFyZ3MpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gY29ubmVjdExvZ2dlcnMoKSB7XG4gIGxldCBwcm90byA9IExvZ2dlci5wcm90b3R5cGU7XG4gIGZvciAobGV0IGxldmVsIGluIGxvZ0xldmVsKSB7XG4gICAgaWYgKGlzU3RhbmRhcmRMZXZlbChsZXZlbCkpIHtcbiAgICAgIGlmIChsZXZlbCAhPT0gJ25vbmUnKSB7XG4gICAgICAgIHByb3RvW2xldmVsXSA9IGxvZ0ZhY3RvcnkobGV2ZWwpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBwcm90b1tsZXZlbF0gPSBsb2dGYWN0b3J5Q3VzdG9tKGxldmVsKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZGlzY29ubmVjdExvZ2dlcnMoKSB7XG4gIGxldCBwcm90byA9IExvZ2dlci5wcm90b3R5cGU7XG4gIGZvciAobGV0IGxldmVsIGluIGxvZ0xldmVsKSB7XG4gICAgaWYgKGxldmVsICE9PSAnbm9uZScpIHtcbiAgICAgIHByb3RvW2xldmVsXSA9IGZ1bmN0aW9uICgpIHt9O1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9nZ2VyKGlkKSB7XG4gIHJldHVybiBsb2dnZXJzW2lkXSB8fCBuZXcgTG9nZ2VyKGlkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZEFwcGVuZGVyKGFwcGVuZGVyKSB7XG4gIGlmIChhcHBlbmRlcnMucHVzaChhcHBlbmRlcikgPT09IDEpIHtcbiAgICBjb25uZWN0TG9nZ2VycygpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVBcHBlbmRlcihhcHBlbmRlcikge1xuICBhcHBlbmRlcnMgPSBhcHBlbmRlcnMuZmlsdGVyKGEgPT4gYSAhPT0gYXBwZW5kZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXBwZW5kZXJzKCkge1xuICByZXR1cm4gWy4uLmFwcGVuZGVyc107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGVhckFwcGVuZGVycygpIHtcbiAgYXBwZW5kZXJzID0gW107XG4gIGRpc2Nvbm5lY3RMb2dnZXJzKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRDdXN0b21MZXZlbChuYW1lLCB2YWx1ZSkge1xuICBpZiAobG9nTGV2ZWxbbmFtZV0gIT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IEVycm9yKGBMb2cgbGV2ZWwgXCIke25hbWV9XCIgYWxyZWFkeSBleGlzdHMuYCk7XG4gIH1cblxuICBpZiAoaXNOYU4odmFsdWUpKSB7XG4gICAgdGhyb3cgRXJyb3IoJ1ZhbHVlIG11c3QgYmUgYSBudW1iZXIuJyk7XG4gIH1cblxuICBsb2dMZXZlbFtuYW1lXSA9IHZhbHVlO1xuXG4gIGlmIChhcHBlbmRlcnMubGVuZ3RoID4gMCkge1xuICAgIGNvbm5lY3RMb2dnZXJzKCk7XG4gIH0gZWxzZSB7XG4gICAgTG9nZ2VyLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uICgpIHt9O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVDdXN0b21MZXZlbChuYW1lKSB7XG4gIGlmIChsb2dMZXZlbFtuYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGlzU3RhbmRhcmRMZXZlbChuYW1lKSkge1xuICAgIHRocm93IEVycm9yKGBCdWlsdC1pbiBsb2cgbGV2ZWwgXCIke25hbWV9XCIgY2Fubm90IGJlIHJlbW92ZWQuYCk7XG4gIH1cblxuICBkZWxldGUgbG9nTGV2ZWxbbmFtZV07XG4gIGRlbGV0ZSBMb2dnZXIucHJvdG90eXBlW25hbWVdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0TGV2ZWwobGV2ZWwpIHtcbiAgZ2xvYmFsRGVmYXVsdExldmVsID0gbGV2ZWw7XG4gIGZvciAobGV0IGtleSBpbiBsb2dnZXJzKSB7XG4gICAgbG9nZ2Vyc1trZXldLnNldExldmVsKGxldmVsKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGV2ZWwoKSB7XG4gIHJldHVybiBnbG9iYWxEZWZhdWx0TGV2ZWw7XG59XG5cbmV4cG9ydCBsZXQgTG9nZ2VyID0gY2xhc3MgTG9nZ2VyIHtcbiAgY29uc3RydWN0b3IoaWQpIHtcbiAgICBsZXQgY2FjaGVkID0gbG9nZ2Vyc1tpZF07XG4gICAgaWYgKGNhY2hlZCkge1xuICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICB9XG5cbiAgICBsb2dnZXJzW2lkXSA9IHRoaXM7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMubGV2ZWwgPSBnbG9iYWxEZWZhdWx0TGV2ZWw7XG4gIH1cblxuICBkZWJ1ZyhtZXNzYWdlLCAuLi5yZXN0KSB7fVxuXG4gIGluZm8obWVzc2FnZSwgLi4ucmVzdCkge31cblxuICB3YXJuKG1lc3NhZ2UsIC4uLnJlc3QpIHt9XG5cbiAgZXJyb3IobWVzc2FnZSwgLi4ucmVzdCkge31cblxuICBzZXRMZXZlbChsZXZlbCkge1xuICAgIHRoaXMubGV2ZWwgPSBsZXZlbDtcbiAgfVxuXG4gIGlzRGVidWdFbmFibGVkKCkge1xuICAgIHJldHVybiB0aGlzLmxldmVsID09PSBsb2dMZXZlbC5kZWJ1ZztcbiAgfVxufTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js\n");

/***/ }),

/***/ "./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js":
/*!***********************************************************************!*\
  !*** ./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js ***!
  \***********************************************************************/
/*! exports provided: metadata, Origin, decorators, deprecated, mixin, protocol */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"metadata\", function() { return metadata; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Origin\", function() { return Origin; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"decorators\", function() { return decorators; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"deprecated\", function() { return deprecated; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mixin\", function() { return mixin; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"protocol\", function() { return protocol; });\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\n\n\nfunction isObject(val) {\n  return val && (typeof val === 'function' || typeof val === 'object');\n}\n\nconst metadata = {\n  resource: 'aurelia:resource',\n  paramTypes: 'design:paramtypes',\n  propertyType: 'design:type',\n  properties: 'design:properties',\n  get(metadataKey, target, targetKey) {\n    if (!isObject(target)) {\n      return undefined;\n    }\n    let result = metadata.getOwn(metadataKey, target, targetKey);\n    return result === undefined ? metadata.get(metadataKey, Object.getPrototypeOf(target), targetKey) : result;\n  },\n  getOwn(metadataKey, target, targetKey) {\n    if (!isObject(target)) {\n      return undefined;\n    }\n    return Reflect.getOwnMetadata(metadataKey, target, targetKey);\n  },\n  define(metadataKey, metadataValue, target, targetKey) {\n    Reflect.defineMetadata(metadataKey, metadataValue, target, targetKey);\n  },\n  getOrCreateOwn(metadataKey, Type, target, targetKey) {\n    let result = metadata.getOwn(metadataKey, target, targetKey);\n\n    if (result === undefined) {\n      result = new Type();\n      Reflect.defineMetadata(metadataKey, result, target, targetKey);\n    }\n\n    return result;\n  }\n};\n\nconst originStorage = new Map();\nconst unknownOrigin = Object.freeze({ moduleId: undefined, moduleMember: undefined });\n\nlet Origin = class Origin {\n  constructor(moduleId, moduleMember) {\n    this.moduleId = moduleId;\n    this.moduleMember = moduleMember;\n  }\n\n  static get(fn) {\n    let origin = originStorage.get(fn);\n\n    if (origin === undefined) {\n      aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"PLATFORM\"].eachModule((key, value) => {\n        if (typeof value === 'object') {\n          for (let name in value) {\n            try {\n              let exp = value[name];\n              if (exp === fn) {\n                originStorage.set(fn, origin = new Origin(key, name));\n                return true;\n              }\n            } catch (e) {}\n          }\n        }\n\n        if (value === fn) {\n          originStorage.set(fn, origin = new Origin(key, 'default'));\n          return true;\n        }\n\n        return false;\n      });\n    }\n\n    return origin || unknownOrigin;\n  }\n\n  static set(fn, origin) {\n    originStorage.set(fn, origin);\n  }\n};\n\nfunction decorators(...rest) {\n  let applicator = function (target, key, descriptor) {\n    let i = rest.length;\n\n    if (key) {\n      descriptor = descriptor || {\n        value: target[key],\n        writable: true,\n        configurable: true,\n        enumerable: true\n      };\n\n      while (i--) {\n        descriptor = rest[i](target, key, descriptor) || descriptor;\n      }\n\n      Object.defineProperty(target, key, descriptor);\n    } else {\n      while (i--) {\n        target = rest[i](target) || target;\n      }\n    }\n\n    return target;\n  };\n\n  applicator.on = applicator;\n  return applicator;\n}\n\nfunction deprecated(optionsOrTarget, maybeKey, maybeDescriptor) {\n  function decorator(target, key, descriptor) {\n    const methodSignature = `${target.constructor.name}#${key}`;\n    let options = maybeKey ? {} : optionsOrTarget || {};\n    let message = `DEPRECATION - ${methodSignature}`;\n\n    if (typeof descriptor.value !== 'function') {\n      throw new SyntaxError('Only methods can be marked as deprecated.');\n    }\n\n    if (options.message) {\n      message += ` - ${options.message}`;\n    }\n\n    return _extends({}, descriptor, {\n      value: function deprecationWrapper() {\n        if (options.error) {\n          throw new Error(message);\n        } else {\n          console.warn(message);\n        }\n\n        return descriptor.value.apply(this, arguments);\n      }\n    });\n  }\n\n  return maybeKey ? decorator(optionsOrTarget, maybeKey, maybeDescriptor) : decorator;\n}\n\nfunction mixin(behavior) {\n  const instanceKeys = Object.keys(behavior);\n\n  function _mixin(possible) {\n    let decorator = function (target) {\n      let resolvedTarget = typeof target === 'function' ? target.prototype : target;\n\n      let i = instanceKeys.length;\n      while (i--) {\n        let property = instanceKeys[i];\n        Object.defineProperty(resolvedTarget, property, {\n          value: behavior[property],\n          writable: true\n        });\n      }\n    };\n\n    return possible ? decorator(possible) : decorator;\n  }\n\n  return _mixin;\n}\n\nfunction alwaysValid() {\n  return true;\n}\nfunction noCompose() {}\n\nfunction ensureProtocolOptions(options) {\n  if (options === undefined) {\n    options = {};\n  } else if (typeof options === 'function') {\n    options = {\n      validate: options\n    };\n  }\n\n  if (!options.validate) {\n    options.validate = alwaysValid;\n  }\n\n  if (!options.compose) {\n    options.compose = noCompose;\n  }\n\n  return options;\n}\n\nfunction createProtocolValidator(validate) {\n  return function (target) {\n    let result = validate(target);\n    return result === true;\n  };\n}\n\nfunction createProtocolAsserter(name, validate) {\n  return function (target) {\n    let result = validate(target);\n    if (result !== true) {\n      throw new Error(result || `${name} was not correctly implemented.`);\n    }\n  };\n}\n\nfunction protocol(name, options) {\n  options = ensureProtocolOptions(options);\n\n  let result = function (target) {\n    let resolvedTarget = typeof target === 'function' ? target.prototype : target;\n\n    options.compose(resolvedTarget);\n    result.assert(resolvedTarget);\n\n    Object.defineProperty(resolvedTarget, 'protocol:' + name, {\n      enumerable: false,\n      configurable: false,\n      writable: false,\n      value: true\n    });\n  };\n\n  result.validate = createProtocolValidator(options.validate);\n  result.assert = createProtocolAsserter(name, options.validate);\n\n  return result;\n}\n\nprotocol.create = function (name, options) {\n  options = ensureProtocolOptions(options);\n  let hidden = 'protocol:' + name;\n  let result = function (target) {\n    let decorator = protocol(name, options);\n    return target ? decorator(target) : decorator;\n  };\n\n  result.decorates = function (obj) {\n    return obj[hidden] === true;\n  };\n  result.validate = createProtocolValidator(options.validate);\n  result.assert = createProtocolAsserter(name, options.validate);\n\n  return result;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1tZXRhZGF0YS9kaXN0L2VzMjAxNS9hdXJlbGlhLW1ldGFkYXRhLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2F1cmVsaWEtbWV0YWRhdGEvZGlzdC9lczIwMTUvYXVyZWxpYS1tZXRhZGF0YS5qcz80ODY1Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbmltcG9ydCB7IFBMQVRGT1JNIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuXG5mdW5jdGlvbiBpc09iamVjdCh2YWwpIHtcbiAgcmV0dXJuIHZhbCAmJiAodHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jyk7XG59XG5cbmV4cG9ydCBjb25zdCBtZXRhZGF0YSA9IHtcbiAgcmVzb3VyY2U6ICdhdXJlbGlhOnJlc291cmNlJyxcbiAgcGFyYW1UeXBlczogJ2Rlc2lnbjpwYXJhbXR5cGVzJyxcbiAgcHJvcGVydHlUeXBlOiAnZGVzaWduOnR5cGUnLFxuICBwcm9wZXJ0aWVzOiAnZGVzaWduOnByb3BlcnRpZXMnLFxuICBnZXQobWV0YWRhdGFLZXksIHRhcmdldCwgdGFyZ2V0S2V5KSB7XG4gICAgaWYgKCFpc09iamVjdCh0YXJnZXQpKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBsZXQgcmVzdWx0ID0gbWV0YWRhdGEuZ2V0T3duKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHRhcmdldEtleSk7XG4gICAgcmV0dXJuIHJlc3VsdCA9PT0gdW5kZWZpbmVkID8gbWV0YWRhdGEuZ2V0KG1ldGFkYXRhS2V5LCBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KSwgdGFyZ2V0S2V5KSA6IHJlc3VsdDtcbiAgfSxcbiAgZ2V0T3duKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHRhcmdldEtleSkge1xuICAgIGlmICghaXNPYmplY3QodGFyZ2V0KSkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmV0dXJuIFJlZmxlY3QuZ2V0T3duTWV0YWRhdGEobWV0YWRhdGFLZXksIHRhcmdldCwgdGFyZ2V0S2V5KTtcbiAgfSxcbiAgZGVmaW5lKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlLCB0YXJnZXQsIHRhcmdldEtleSkge1xuICAgIFJlZmxlY3QuZGVmaW5lTWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUsIHRhcmdldCwgdGFyZ2V0S2V5KTtcbiAgfSxcbiAgZ2V0T3JDcmVhdGVPd24obWV0YWRhdGFLZXksIFR5cGUsIHRhcmdldCwgdGFyZ2V0S2V5KSB7XG4gICAgbGV0IHJlc3VsdCA9IG1ldGFkYXRhLmdldE93bihtZXRhZGF0YUtleSwgdGFyZ2V0LCB0YXJnZXRLZXkpO1xuXG4gICAgaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXN1bHQgPSBuZXcgVHlwZSgpO1xuICAgICAgUmVmbGVjdC5kZWZpbmVNZXRhZGF0YShtZXRhZGF0YUtleSwgcmVzdWx0LCB0YXJnZXQsIHRhcmdldEtleSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxufTtcblxuY29uc3Qgb3JpZ2luU3RvcmFnZSA9IG5ldyBNYXAoKTtcbmNvbnN0IHVua25vd25PcmlnaW4gPSBPYmplY3QuZnJlZXplKHsgbW9kdWxlSWQ6IHVuZGVmaW5lZCwgbW9kdWxlTWVtYmVyOiB1bmRlZmluZWQgfSk7XG5cbmV4cG9ydCBsZXQgT3JpZ2luID0gY2xhc3MgT3JpZ2luIHtcbiAgY29uc3RydWN0b3IobW9kdWxlSWQsIG1vZHVsZU1lbWJlcikge1xuICAgIHRoaXMubW9kdWxlSWQgPSBtb2R1bGVJZDtcbiAgICB0aGlzLm1vZHVsZU1lbWJlciA9IG1vZHVsZU1lbWJlcjtcbiAgfVxuXG4gIHN0YXRpYyBnZXQoZm4pIHtcbiAgICBsZXQgb3JpZ2luID0gb3JpZ2luU3RvcmFnZS5nZXQoZm4pO1xuXG4gICAgaWYgKG9yaWdpbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBQTEFURk9STS5lYWNoTW9kdWxlKChrZXksIHZhbHVlKSA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgZm9yIChsZXQgbmFtZSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgbGV0IGV4cCA9IHZhbHVlW25hbWVdO1xuICAgICAgICAgICAgICBpZiAoZXhwID09PSBmbikge1xuICAgICAgICAgICAgICAgIG9yaWdpblN0b3JhZ2Uuc2V0KGZuLCBvcmlnaW4gPSBuZXcgT3JpZ2luKGtleSwgbmFtZSkpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gZm4pIHtcbiAgICAgICAgICBvcmlnaW5TdG9yYWdlLnNldChmbiwgb3JpZ2luID0gbmV3IE9yaWdpbihrZXksICdkZWZhdWx0JykpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9yaWdpbiB8fCB1bmtub3duT3JpZ2luO1xuICB9XG5cbiAgc3RhdGljIHNldChmbiwgb3JpZ2luKSB7XG4gICAgb3JpZ2luU3RvcmFnZS5zZXQoZm4sIG9yaWdpbik7XG4gIH1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNvcmF0b3JzKC4uLnJlc3QpIHtcbiAgbGV0IGFwcGxpY2F0b3IgPSBmdW5jdGlvbiAodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IpIHtcbiAgICBsZXQgaSA9IHJlc3QubGVuZ3RoO1xuXG4gICAgaWYgKGtleSkge1xuICAgICAgZGVzY3JpcHRvciA9IGRlc2NyaXB0b3IgfHwge1xuICAgICAgICB2YWx1ZTogdGFyZ2V0W2tleV0sXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICAgIH07XG5cbiAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgZGVzY3JpcHRvciA9IHJlc3RbaV0odGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IpIHx8IGRlc2NyaXB0b3I7XG4gICAgICB9XG5cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgdGFyZ2V0ID0gcmVzdFtpXSh0YXJnZXQpIHx8IHRhcmdldDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9O1xuXG4gIGFwcGxpY2F0b3Iub24gPSBhcHBsaWNhdG9yO1xuICByZXR1cm4gYXBwbGljYXRvcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlcHJlY2F0ZWQob3B0aW9uc09yVGFyZ2V0LCBtYXliZUtleSwgbWF5YmVEZXNjcmlwdG9yKSB7XG4gIGZ1bmN0aW9uIGRlY29yYXRvcih0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGNvbnN0IG1ldGhvZFNpZ25hdHVyZSA9IGAke3RhcmdldC5jb25zdHJ1Y3Rvci5uYW1lfSMke2tleX1gO1xuICAgIGxldCBvcHRpb25zID0gbWF5YmVLZXkgPyB7fSA6IG9wdGlvbnNPclRhcmdldCB8fCB7fTtcbiAgICBsZXQgbWVzc2FnZSA9IGBERVBSRUNBVElPTiAtICR7bWV0aG9kU2lnbmF0dXJlfWA7XG5cbiAgICBpZiAodHlwZW9mIGRlc2NyaXB0b3IudmFsdWUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcignT25seSBtZXRob2RzIGNhbiBiZSBtYXJrZWQgYXMgZGVwcmVjYXRlZC4nKTtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucy5tZXNzYWdlKSB7XG4gICAgICBtZXNzYWdlICs9IGAgLSAke29wdGlvbnMubWVzc2FnZX1gO1xuICAgIH1cblxuICAgIHJldHVybiBfZXh0ZW5kcyh7fSwgZGVzY3JpcHRvciwge1xuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlcHJlY2F0aW9uV3JhcHBlcigpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuZXJyb3IpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRlc2NyaXB0b3IudmFsdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBtYXliZUtleSA/IGRlY29yYXRvcihvcHRpb25zT3JUYXJnZXQsIG1heWJlS2V5LCBtYXliZURlc2NyaXB0b3IpIDogZGVjb3JhdG9yO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWl4aW4oYmVoYXZpb3IpIHtcbiAgY29uc3QgaW5zdGFuY2VLZXlzID0gT2JqZWN0LmtleXMoYmVoYXZpb3IpO1xuXG4gIGZ1bmN0aW9uIF9taXhpbihwb3NzaWJsZSkge1xuICAgIGxldCBkZWNvcmF0b3IgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICBsZXQgcmVzb2x2ZWRUYXJnZXQgPSB0eXBlb2YgdGFyZ2V0ID09PSAnZnVuY3Rpb24nID8gdGFyZ2V0LnByb3RvdHlwZSA6IHRhcmdldDtcblxuICAgICAgbGV0IGkgPSBpbnN0YW5jZUtleXMubGVuZ3RoO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBsZXQgcHJvcGVydHkgPSBpbnN0YW5jZUtleXNbaV07XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXNvbHZlZFRhcmdldCwgcHJvcGVydHksIHtcbiAgICAgICAgICB2YWx1ZTogYmVoYXZpb3JbcHJvcGVydHldLFxuICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gcG9zc2libGUgPyBkZWNvcmF0b3IocG9zc2libGUpIDogZGVjb3JhdG9yO1xuICB9XG5cbiAgcmV0dXJuIF9taXhpbjtcbn1cblxuZnVuY3Rpb24gYWx3YXlzVmFsaWQoKSB7XG4gIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gbm9Db21wb3NlKCkge31cblxuZnVuY3Rpb24gZW5zdXJlUHJvdG9jb2xPcHRpb25zKG9wdGlvbnMpIHtcbiAgaWYgKG9wdGlvbnMgPT09IHVuZGVmaW5lZCkge1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfSBlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIG9wdGlvbnMgPSB7XG4gICAgICB2YWxpZGF0ZTogb3B0aW9uc1xuICAgIH07XG4gIH1cblxuICBpZiAoIW9wdGlvbnMudmFsaWRhdGUpIHtcbiAgICBvcHRpb25zLnZhbGlkYXRlID0gYWx3YXlzVmFsaWQ7XG4gIH1cblxuICBpZiAoIW9wdGlvbnMuY29tcG9zZSkge1xuICAgIG9wdGlvbnMuY29tcG9zZSA9IG5vQ29tcG9zZTtcbiAgfVxuXG4gIHJldHVybiBvcHRpb25zO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVQcm90b2NvbFZhbGlkYXRvcih2YWxpZGF0ZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIGxldCByZXN1bHQgPSB2YWxpZGF0ZSh0YXJnZXQpO1xuICAgIHJldHVybiByZXN1bHQgPT09IHRydWU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVByb3RvY29sQXNzZXJ0ZXIobmFtZSwgdmFsaWRhdGUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICBsZXQgcmVzdWx0ID0gdmFsaWRhdGUodGFyZ2V0KTtcbiAgICBpZiAocmVzdWx0ICE9PSB0cnVlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IocmVzdWx0IHx8IGAke25hbWV9IHdhcyBub3QgY29ycmVjdGx5IGltcGxlbWVudGVkLmApO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByb3RvY29sKG5hbWUsIG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IGVuc3VyZVByb3RvY29sT3B0aW9ucyhvcHRpb25zKTtcblxuICBsZXQgcmVzdWx0ID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIGxldCByZXNvbHZlZFRhcmdldCA9IHR5cGVvZiB0YXJnZXQgPT09ICdmdW5jdGlvbicgPyB0YXJnZXQucHJvdG90eXBlIDogdGFyZ2V0O1xuXG4gICAgb3B0aW9ucy5jb21wb3NlKHJlc29sdmVkVGFyZ2V0KTtcbiAgICByZXN1bHQuYXNzZXJ0KHJlc29sdmVkVGFyZ2V0KTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXNvbHZlZFRhcmdldCwgJ3Byb3RvY29sOicgKyBuYW1lLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICB2YWx1ZTogdHJ1ZVxuICAgIH0pO1xuICB9O1xuXG4gIHJlc3VsdC52YWxpZGF0ZSA9IGNyZWF0ZVByb3RvY29sVmFsaWRhdG9yKG9wdGlvbnMudmFsaWRhdGUpO1xuICByZXN1bHQuYXNzZXJ0ID0gY3JlYXRlUHJvdG9jb2xBc3NlcnRlcihuYW1lLCBvcHRpb25zLnZhbGlkYXRlKTtcblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5wcm90b2NvbC5jcmVhdGUgPSBmdW5jdGlvbiAobmFtZSwgb3B0aW9ucykge1xuICBvcHRpb25zID0gZW5zdXJlUHJvdG9jb2xPcHRpb25zKG9wdGlvbnMpO1xuICBsZXQgaGlkZGVuID0gJ3Byb3RvY29sOicgKyBuYW1lO1xuICBsZXQgcmVzdWx0ID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIGxldCBkZWNvcmF0b3IgPSBwcm90b2NvbChuYW1lLCBvcHRpb25zKTtcbiAgICByZXR1cm4gdGFyZ2V0ID8gZGVjb3JhdG9yKHRhcmdldCkgOiBkZWNvcmF0b3I7XG4gIH07XG5cbiAgcmVzdWx0LmRlY29yYXRlcyA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICByZXR1cm4gb2JqW2hpZGRlbl0gPT09IHRydWU7XG4gIH07XG4gIHJlc3VsdC52YWxpZGF0ZSA9IGNyZWF0ZVByb3RvY29sVmFsaWRhdG9yKG9wdGlvbnMudmFsaWRhdGUpO1xuICByZXN1bHQuYXNzZXJ0ID0gY3JlYXRlUHJvdG9jb2xBc3NlcnRlcihuYW1lLCBvcHRpb25zLnZhbGlkYXRlKTtcblxuICByZXR1cm4gcmVzdWx0O1xufTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js\n");

/***/ }),

/***/ "./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js":
/*!*************************************************************!*\
  !*** ./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js ***!
  \*************************************************************/
/*! exports provided: AggregateError, FEATURE, PLATFORM, DOM, isInitialized, initializePAL, reset */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(global) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AggregateError\", function() { return AggregateError; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FEATURE\", function() { return FEATURE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PLATFORM\", function() { return PLATFORM; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DOM\", function() { return DOM; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isInitialized\", function() { return isInitialized; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"initializePAL\", function() { return initializePAL; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"reset\", function() { return reset; });\n\nfunction AggregateError(message, innerError, skipIfAlreadyAggregate) {\n  if (innerError) {\n    if (innerError.innerError && skipIfAlreadyAggregate) {\n      return innerError;\n    }\n\n    const separator = '\\n------------------------------------------------\\n';\n\n    message += `${separator}Inner Error:\\n`;\n\n    if (typeof innerError === 'string') {\n      message += `Message: ${innerError}`;\n    } else {\n      if (innerError.message) {\n        message += `Message: ${innerError.message}`;\n      } else {\n        message += `Unknown Inner Error Type. Displaying Inner Error as JSON:\\n ${JSON.stringify(innerError, null, '  ')}`;\n      }\n\n      if (innerError.stack) {\n        message += `\\nInner Error Stack:\\n${innerError.stack}`;\n        message += '\\nEnd Inner Error Stack';\n      }\n    }\n\n    message += separator;\n  }\n\n  let e = new Error(message);\n  if (innerError) {\n    e.innerError = innerError;\n  }\n\n  return e;\n}\n\nconst FEATURE = {};\n\nconst PLATFORM = {\n  noop() {},\n  eachModule() {},\n  moduleName(moduleName) {\n    return moduleName;\n  }\n};\n\nPLATFORM.global = function () {\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n\n  return new Function('return this')();\n}();\n\nconst DOM = {};\nlet isInitialized = false;\n\nfunction initializePAL(callback) {\n  if (isInitialized) {\n    return;\n  }\n  isInitialized = true;\n  if (typeof Object.getPropertyDescriptor !== 'function') {\n    Object.getPropertyDescriptor = function (subject, name) {\n      let pd = Object.getOwnPropertyDescriptor(subject, name);\n      let proto = Object.getPrototypeOf(subject);\n      while (typeof pd === 'undefined' && proto !== null) {\n        pd = Object.getOwnPropertyDescriptor(proto, name);\n        proto = Object.getPrototypeOf(proto);\n      }\n      return pd;\n    };\n  }\n\n  callback(PLATFORM, FEATURE, DOM);\n}\nfunction reset() {\n  isInitialized = false;\n}\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\")))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1wYWwvZGlzdC9lczIwMTUvYXVyZWxpYS1wYWwuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1wYWwvZGlzdC9lczIwMTUvYXVyZWxpYS1wYWwuanM/YzQ4NSJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBmdW5jdGlvbiBBZ2dyZWdhdGVFcnJvcihtZXNzYWdlLCBpbm5lckVycm9yLCBza2lwSWZBbHJlYWR5QWdncmVnYXRlKSB7XG4gIGlmIChpbm5lckVycm9yKSB7XG4gICAgaWYgKGlubmVyRXJyb3IuaW5uZXJFcnJvciAmJiBza2lwSWZBbHJlYWR5QWdncmVnYXRlKSB7XG4gICAgICByZXR1cm4gaW5uZXJFcnJvcjtcbiAgICB9XG5cbiAgICBjb25zdCBzZXBhcmF0b3IgPSAnXFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXFxuJztcblxuICAgIG1lc3NhZ2UgKz0gYCR7c2VwYXJhdG9yfUlubmVyIEVycm9yOlxcbmA7XG5cbiAgICBpZiAodHlwZW9mIGlubmVyRXJyb3IgPT09ICdzdHJpbmcnKSB7XG4gICAgICBtZXNzYWdlICs9IGBNZXNzYWdlOiAke2lubmVyRXJyb3J9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGlubmVyRXJyb3IubWVzc2FnZSkge1xuICAgICAgICBtZXNzYWdlICs9IGBNZXNzYWdlOiAke2lubmVyRXJyb3IubWVzc2FnZX1gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWVzc2FnZSArPSBgVW5rbm93biBJbm5lciBFcnJvciBUeXBlLiBEaXNwbGF5aW5nIElubmVyIEVycm9yIGFzIEpTT046XFxuICR7SlNPTi5zdHJpbmdpZnkoaW5uZXJFcnJvciwgbnVsbCwgJyAgJyl9YDtcbiAgICAgIH1cblxuICAgICAgaWYgKGlubmVyRXJyb3Iuc3RhY2spIHtcbiAgICAgICAgbWVzc2FnZSArPSBgXFxuSW5uZXIgRXJyb3IgU3RhY2s6XFxuJHtpbm5lckVycm9yLnN0YWNrfWA7XG4gICAgICAgIG1lc3NhZ2UgKz0gJ1xcbkVuZCBJbm5lciBFcnJvciBTdGFjayc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbWVzc2FnZSArPSBzZXBhcmF0b3I7XG4gIH1cblxuICBsZXQgZSA9IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgaWYgKGlubmVyRXJyb3IpIHtcbiAgICBlLmlubmVyRXJyb3IgPSBpbm5lckVycm9yO1xuICB9XG5cbiAgcmV0dXJuIGU7XG59XG5cbmV4cG9ydCBjb25zdCBGRUFUVVJFID0ge307XG5cbmV4cG9ydCBjb25zdCBQTEFURk9STSA9IHtcbiAgbm9vcCgpIHt9LFxuICBlYWNoTW9kdWxlKCkge30sXG4gIG1vZHVsZU5hbWUobW9kdWxlTmFtZSkge1xuICAgIHJldHVybiBtb2R1bGVOYW1lO1xuICB9XG59O1xuXG5QTEFURk9STS5nbG9iYWwgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gc2VsZjtcbiAgfVxuXG4gIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBnbG9iYWw7XG4gIH1cblxuICByZXR1cm4gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG59KCk7XG5cbmV4cG9ydCBjb25zdCBET00gPSB7fTtcbmV4cG9ydCBsZXQgaXNJbml0aWFsaXplZCA9IGZhbHNlO1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVBBTChjYWxsYmFjaykge1xuICBpZiAoaXNJbml0aWFsaXplZCkge1xuICAgIHJldHVybjtcbiAgfVxuICBpc0luaXRpYWxpemVkID0gdHJ1ZTtcbiAgaWYgKHR5cGVvZiBPYmplY3QuZ2V0UHJvcGVydHlEZXNjcmlwdG9yICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgT2JqZWN0LmdldFByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIChzdWJqZWN0LCBuYW1lKSB7XG4gICAgICBsZXQgcGQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHN1YmplY3QsIG5hbWUpO1xuICAgICAgbGV0IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHN1YmplY3QpO1xuICAgICAgd2hpbGUgKHR5cGVvZiBwZCA9PT0gJ3VuZGVmaW5lZCcgJiYgcHJvdG8gIT09IG51bGwpIHtcbiAgICAgICAgcGQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHByb3RvLCBuYW1lKTtcbiAgICAgICAgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YocHJvdG8pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBkO1xuICAgIH07XG4gIH1cblxuICBjYWxsYmFjayhQTEFURk9STSwgRkVBVFVSRSwgRE9NKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiByZXNldCgpIHtcbiAgaXNJbml0aWFsaXplZCA9IGZhbHNlO1xufSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\n");

/***/ }),

/***/ "./node_modules/aurelia-path/dist/es2015/aurelia-path.js":
/*!***************************************************************!*\
  !*** ./node_modules/aurelia-path/dist/es2015/aurelia-path.js ***!
  \***************************************************************/
/*! exports provided: relativeToFile, join, buildQueryString, parseQueryString */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"relativeToFile\", function() { return relativeToFile; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"join\", function() { return join; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"buildQueryString\", function() { return buildQueryString; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"parseQueryString\", function() { return parseQueryString; });\n\nfunction trimDots(ary) {\n  for (let i = 0; i < ary.length; ++i) {\n    let part = ary[i];\n    if (part === '.') {\n      ary.splice(i, 1);\n      i -= 1;\n    } else if (part === '..') {\n      if (i === 0 || i === 1 && ary[2] === '..' || ary[i - 1] === '..') {\n        continue;\n      } else if (i > 0) {\n        ary.splice(i - 1, 2);\n        i -= 2;\n      }\n    }\n  }\n}\n\nfunction relativeToFile(name, file) {\n  let fileParts = file && file.split('/');\n  let nameParts = name.trim().split('/');\n\n  if (nameParts[0].charAt(0) === '.' && fileParts) {\n    let normalizedBaseParts = fileParts.slice(0, fileParts.length - 1);\n    nameParts.unshift(...normalizedBaseParts);\n  }\n\n  trimDots(nameParts);\n\n  return nameParts.join('/');\n}\n\nfunction join(path1, path2) {\n  if (!path1) {\n    return path2;\n  }\n\n  if (!path2) {\n    return path1;\n  }\n\n  let schemeMatch = path1.match(/^([^/]*?:)\\//);\n  let scheme = schemeMatch && schemeMatch.length > 0 ? schemeMatch[1] : '';\n  path1 = path1.substr(scheme.length);\n\n  let urlPrefix;\n  if (path1.indexOf('///') === 0 && scheme === 'file:') {\n    urlPrefix = '///';\n  } else if (path1.indexOf('//') === 0) {\n    urlPrefix = '//';\n  } else if (path1.indexOf('/') === 0) {\n    urlPrefix = '/';\n  } else {\n    urlPrefix = '';\n  }\n\n  let trailingSlash = path2.slice(-1) === '/' ? '/' : '';\n\n  let url1 = path1.split('/');\n  let url2 = path2.split('/');\n  let url3 = [];\n\n  for (let i = 0, ii = url1.length; i < ii; ++i) {\n    if (url1[i] === '..') {\n      url3.pop();\n    } else if (url1[i] === '.' || url1[i] === '') {\n      continue;\n    } else {\n      url3.push(url1[i]);\n    }\n  }\n\n  for (let i = 0, ii = url2.length; i < ii; ++i) {\n    if (url2[i] === '..') {\n      url3.pop();\n    } else if (url2[i] === '.' || url2[i] === '') {\n      continue;\n    } else {\n      url3.push(url2[i]);\n    }\n  }\n\n  return scheme + urlPrefix + url3.join('/') + trailingSlash;\n}\n\nlet encode = encodeURIComponent;\nlet encodeKey = k => encode(k).replace('%24', '$');\n\nfunction buildParam(key, value, traditional) {\n  let result = [];\n  if (value === null || value === undefined) {\n    return result;\n  }\n  if (Array.isArray(value)) {\n    for (let i = 0, l = value.length; i < l; i++) {\n      if (traditional) {\n        result.push(`${encodeKey(key)}=${encode(value[i])}`);\n      } else {\n        let arrayKey = key + '[' + (typeof value[i] === 'object' && value[i] !== null ? i : '') + ']';\n        result = result.concat(buildParam(arrayKey, value[i]));\n      }\n    }\n  } else if (typeof value === 'object' && !traditional) {\n    for (let propertyName in value) {\n      result = result.concat(buildParam(key + '[' + propertyName + ']', value[propertyName]));\n    }\n  } else {\n    result.push(`${encodeKey(key)}=${encode(value)}`);\n  }\n  return result;\n}\n\nfunction buildQueryString(params, traditional) {\n  let pairs = [];\n  let keys = Object.keys(params || {}).sort();\n  for (let i = 0, len = keys.length; i < len; i++) {\n    let key = keys[i];\n    pairs = pairs.concat(buildParam(key, params[key], traditional));\n  }\n\n  if (pairs.length === 0) {\n    return '';\n  }\n\n  return pairs.join('&');\n}\n\nfunction processScalarParam(existedParam, value) {\n  if (Array.isArray(existedParam)) {\n    existedParam.push(value);\n    return existedParam;\n  }\n  if (existedParam !== undefined) {\n    return [existedParam, value];\n  }\n\n  return value;\n}\n\nfunction parseComplexParam(queryParams, keys, value) {\n  let currentParams = queryParams;\n  let keysLastIndex = keys.length - 1;\n  for (let j = 0; j <= keysLastIndex; j++) {\n    let key = keys[j] === '' ? currentParams.length : keys[j];\n    if (j < keysLastIndex) {\n      let prevValue = !currentParams[key] || typeof currentParams[key] === 'object' ? currentParams[key] : [currentParams[key]];\n      currentParams = currentParams[key] = prevValue || (isNaN(keys[j + 1]) ? {} : []);\n    } else {\n      currentParams = currentParams[key] = value;\n    }\n  }\n}\n\nfunction parseQueryString(queryString) {\n  let queryParams = {};\n  if (!queryString || typeof queryString !== 'string') {\n    return queryParams;\n  }\n\n  let query = queryString;\n  if (query.charAt(0) === '?') {\n    query = query.substr(1);\n  }\n\n  let pairs = query.replace(/\\+/g, ' ').split('&');\n  for (let i = 0; i < pairs.length; i++) {\n    let pair = pairs[i].split('=');\n    let key = decodeURIComponent(pair[0]);\n    if (!key) {\n      continue;\n    }\n\n    let keys = key.split('][');\n    let keysLastIndex = keys.length - 1;\n\n    if (/\\[/.test(keys[0]) && /\\]$/.test(keys[keysLastIndex])) {\n      keys[keysLastIndex] = keys[keysLastIndex].replace(/\\]$/, '');\n      keys = keys.shift().split('[').concat(keys);\n      keysLastIndex = keys.length - 1;\n    } else {\n      keysLastIndex = 0;\n    }\n\n    if (pair.length >= 2) {\n      let value = pair[1] ? decodeURIComponent(pair[1]) : '';\n      if (keysLastIndex) {\n        parseComplexParam(queryParams, keys, value);\n      } else {\n        queryParams[key] = processScalarParam(queryParams[key], value);\n      }\n    } else {\n      queryParams[key] = true;\n    }\n  }\n  return queryParams;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1wYXRoL2Rpc3QvZXMyMDE1L2F1cmVsaWEtcGF0aC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXBhdGgvZGlzdC9lczIwMTUvYXVyZWxpYS1wYXRoLmpzPzlmZWIiXSwic291cmNlc0NvbnRlbnQiOlsiXG5mdW5jdGlvbiB0cmltRG90cyhhcnkpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnkubGVuZ3RoOyArK2kpIHtcbiAgICBsZXQgcGFydCA9IGFyeVtpXTtcbiAgICBpZiAocGFydCA9PT0gJy4nKSB7XG4gICAgICBhcnkuc3BsaWNlKGksIDEpO1xuICAgICAgaSAtPSAxO1xuICAgIH0gZWxzZSBpZiAocGFydCA9PT0gJy4uJykge1xuICAgICAgaWYgKGkgPT09IDAgfHwgaSA9PT0gMSAmJiBhcnlbMl0gPT09ICcuLicgfHwgYXJ5W2kgLSAxXSA9PT0gJy4uJykge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH0gZWxzZSBpZiAoaSA+IDApIHtcbiAgICAgICAgYXJ5LnNwbGljZShpIC0gMSwgMik7XG4gICAgICAgIGkgLT0gMjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbGF0aXZlVG9GaWxlKG5hbWUsIGZpbGUpIHtcbiAgbGV0IGZpbGVQYXJ0cyA9IGZpbGUgJiYgZmlsZS5zcGxpdCgnLycpO1xuICBsZXQgbmFtZVBhcnRzID0gbmFtZS50cmltKCkuc3BsaXQoJy8nKTtcblxuICBpZiAobmFtZVBhcnRzWzBdLmNoYXJBdCgwKSA9PT0gJy4nICYmIGZpbGVQYXJ0cykge1xuICAgIGxldCBub3JtYWxpemVkQmFzZVBhcnRzID0gZmlsZVBhcnRzLnNsaWNlKDAsIGZpbGVQYXJ0cy5sZW5ndGggLSAxKTtcbiAgICBuYW1lUGFydHMudW5zaGlmdCguLi5ub3JtYWxpemVkQmFzZVBhcnRzKTtcbiAgfVxuXG4gIHRyaW1Eb3RzKG5hbWVQYXJ0cyk7XG5cbiAgcmV0dXJuIG5hbWVQYXJ0cy5qb2luKCcvJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBqb2luKHBhdGgxLCBwYXRoMikge1xuICBpZiAoIXBhdGgxKSB7XG4gICAgcmV0dXJuIHBhdGgyO1xuICB9XG5cbiAgaWYgKCFwYXRoMikge1xuICAgIHJldHVybiBwYXRoMTtcbiAgfVxuXG4gIGxldCBzY2hlbWVNYXRjaCA9IHBhdGgxLm1hdGNoKC9eKFteL10qPzopXFwvLyk7XG4gIGxldCBzY2hlbWUgPSBzY2hlbWVNYXRjaCAmJiBzY2hlbWVNYXRjaC5sZW5ndGggPiAwID8gc2NoZW1lTWF0Y2hbMV0gOiAnJztcbiAgcGF0aDEgPSBwYXRoMS5zdWJzdHIoc2NoZW1lLmxlbmd0aCk7XG5cbiAgbGV0IHVybFByZWZpeDtcbiAgaWYgKHBhdGgxLmluZGV4T2YoJy8vLycpID09PSAwICYmIHNjaGVtZSA9PT0gJ2ZpbGU6Jykge1xuICAgIHVybFByZWZpeCA9ICcvLy8nO1xuICB9IGVsc2UgaWYgKHBhdGgxLmluZGV4T2YoJy8vJykgPT09IDApIHtcbiAgICB1cmxQcmVmaXggPSAnLy8nO1xuICB9IGVsc2UgaWYgKHBhdGgxLmluZGV4T2YoJy8nKSA9PT0gMCkge1xuICAgIHVybFByZWZpeCA9ICcvJztcbiAgfSBlbHNlIHtcbiAgICB1cmxQcmVmaXggPSAnJztcbiAgfVxuXG4gIGxldCB0cmFpbGluZ1NsYXNoID0gcGF0aDIuc2xpY2UoLTEpID09PSAnLycgPyAnLycgOiAnJztcblxuICBsZXQgdXJsMSA9IHBhdGgxLnNwbGl0KCcvJyk7XG4gIGxldCB1cmwyID0gcGF0aDIuc3BsaXQoJy8nKTtcbiAgbGV0IHVybDMgPSBbXTtcblxuICBmb3IgKGxldCBpID0gMCwgaWkgPSB1cmwxLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICBpZiAodXJsMVtpXSA9PT0gJy4uJykge1xuICAgICAgdXJsMy5wb3AoKTtcbiAgICB9IGVsc2UgaWYgKHVybDFbaV0gPT09ICcuJyB8fCB1cmwxW2ldID09PSAnJykge1xuICAgICAgY29udGludWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVybDMucHVzaCh1cmwxW2ldKTtcbiAgICB9XG4gIH1cblxuICBmb3IgKGxldCBpID0gMCwgaWkgPSB1cmwyLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICBpZiAodXJsMltpXSA9PT0gJy4uJykge1xuICAgICAgdXJsMy5wb3AoKTtcbiAgICB9IGVsc2UgaWYgKHVybDJbaV0gPT09ICcuJyB8fCB1cmwyW2ldID09PSAnJykge1xuICAgICAgY29udGludWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVybDMucHVzaCh1cmwyW2ldKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gc2NoZW1lICsgdXJsUHJlZml4ICsgdXJsMy5qb2luKCcvJykgKyB0cmFpbGluZ1NsYXNoO1xufVxuXG5sZXQgZW5jb2RlID0gZW5jb2RlVVJJQ29tcG9uZW50O1xubGV0IGVuY29kZUtleSA9IGsgPT4gZW5jb2RlKGspLnJlcGxhY2UoJyUyNCcsICckJyk7XG5cbmZ1bmN0aW9uIGJ1aWxkUGFyYW0oa2V5LCB2YWx1ZSwgdHJhZGl0aW9uYWwpIHtcbiAgbGV0IHJlc3VsdCA9IFtdO1xuICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgZm9yIChsZXQgaSA9IDAsIGwgPSB2YWx1ZS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIGlmICh0cmFkaXRpb25hbCkge1xuICAgICAgICByZXN1bHQucHVzaChgJHtlbmNvZGVLZXkoa2V5KX09JHtlbmNvZGUodmFsdWVbaV0pfWApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IGFycmF5S2V5ID0ga2V5ICsgJ1snICsgKHR5cGVvZiB2YWx1ZVtpXSA9PT0gJ29iamVjdCcgJiYgdmFsdWVbaV0gIT09IG51bGwgPyBpIDogJycpICsgJ10nO1xuICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KGJ1aWxkUGFyYW0oYXJyYXlLZXksIHZhbHVlW2ldKSk7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgIXRyYWRpdGlvbmFsKSB7XG4gICAgZm9yIChsZXQgcHJvcGVydHlOYW1lIGluIHZhbHVlKSB7XG4gICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KGJ1aWxkUGFyYW0oa2V5ICsgJ1snICsgcHJvcGVydHlOYW1lICsgJ10nLCB2YWx1ZVtwcm9wZXJ0eU5hbWVdKSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJlc3VsdC5wdXNoKGAke2VuY29kZUtleShrZXkpfT0ke2VuY29kZSh2YWx1ZSl9YCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkUXVlcnlTdHJpbmcocGFyYW1zLCB0cmFkaXRpb25hbCkge1xuICBsZXQgcGFpcnMgPSBbXTtcbiAgbGV0IGtleXMgPSBPYmplY3Qua2V5cyhwYXJhbXMgfHwge30pLnNvcnQoKTtcbiAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGtleXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBsZXQga2V5ID0ga2V5c1tpXTtcbiAgICBwYWlycyA9IHBhaXJzLmNvbmNhdChidWlsZFBhcmFtKGtleSwgcGFyYW1zW2tleV0sIHRyYWRpdGlvbmFsKSk7XG4gIH1cblxuICBpZiAocGFpcnMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgcmV0dXJuIHBhaXJzLmpvaW4oJyYnKTtcbn1cblxuZnVuY3Rpb24gcHJvY2Vzc1NjYWxhclBhcmFtKGV4aXN0ZWRQYXJhbSwgdmFsdWUpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoZXhpc3RlZFBhcmFtKSkge1xuICAgIGV4aXN0ZWRQYXJhbS5wdXNoKHZhbHVlKTtcbiAgICByZXR1cm4gZXhpc3RlZFBhcmFtO1xuICB9XG4gIGlmIChleGlzdGVkUGFyYW0gIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBbZXhpc3RlZFBhcmFtLCB2YWx1ZV07XG4gIH1cblxuICByZXR1cm4gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIHBhcnNlQ29tcGxleFBhcmFtKHF1ZXJ5UGFyYW1zLCBrZXlzLCB2YWx1ZSkge1xuICBsZXQgY3VycmVudFBhcmFtcyA9IHF1ZXJ5UGFyYW1zO1xuICBsZXQga2V5c0xhc3RJbmRleCA9IGtleXMubGVuZ3RoIC0gMTtcbiAgZm9yIChsZXQgaiA9IDA7IGogPD0ga2V5c0xhc3RJbmRleDsgaisrKSB7XG4gICAgbGV0IGtleSA9IGtleXNbal0gPT09ICcnID8gY3VycmVudFBhcmFtcy5sZW5ndGggOiBrZXlzW2pdO1xuICAgIGlmIChqIDwga2V5c0xhc3RJbmRleCkge1xuICAgICAgbGV0IHByZXZWYWx1ZSA9ICFjdXJyZW50UGFyYW1zW2tleV0gfHwgdHlwZW9mIGN1cnJlbnRQYXJhbXNba2V5XSA9PT0gJ29iamVjdCcgPyBjdXJyZW50UGFyYW1zW2tleV0gOiBbY3VycmVudFBhcmFtc1trZXldXTtcbiAgICAgIGN1cnJlbnRQYXJhbXMgPSBjdXJyZW50UGFyYW1zW2tleV0gPSBwcmV2VmFsdWUgfHwgKGlzTmFOKGtleXNbaiArIDFdKSA/IHt9IDogW10pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXJyZW50UGFyYW1zID0gY3VycmVudFBhcmFtc1trZXldID0gdmFsdWU7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVF1ZXJ5U3RyaW5nKHF1ZXJ5U3RyaW5nKSB7XG4gIGxldCBxdWVyeVBhcmFtcyA9IHt9O1xuICBpZiAoIXF1ZXJ5U3RyaW5nIHx8IHR5cGVvZiBxdWVyeVN0cmluZyAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gcXVlcnlQYXJhbXM7XG4gIH1cblxuICBsZXQgcXVlcnkgPSBxdWVyeVN0cmluZztcbiAgaWYgKHF1ZXJ5LmNoYXJBdCgwKSA9PT0gJz8nKSB7XG4gICAgcXVlcnkgPSBxdWVyeS5zdWJzdHIoMSk7XG4gIH1cblxuICBsZXQgcGFpcnMgPSBxdWVyeS5yZXBsYWNlKC9cXCsvZywgJyAnKS5zcGxpdCgnJicpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHBhaXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IHBhaXIgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xuICAgIGxldCBrZXkgPSBkZWNvZGVVUklDb21wb25lbnQocGFpclswXSk7XG4gICAgaWYgKCFrZXkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGxldCBrZXlzID0ga2V5LnNwbGl0KCddWycpO1xuICAgIGxldCBrZXlzTGFzdEluZGV4ID0ga2V5cy5sZW5ndGggLSAxO1xuXG4gICAgaWYgKC9cXFsvLnRlc3Qoa2V5c1swXSkgJiYgL1xcXSQvLnRlc3Qoa2V5c1trZXlzTGFzdEluZGV4XSkpIHtcbiAgICAgIGtleXNba2V5c0xhc3RJbmRleF0gPSBrZXlzW2tleXNMYXN0SW5kZXhdLnJlcGxhY2UoL1xcXSQvLCAnJyk7XG4gICAgICBrZXlzID0ga2V5cy5zaGlmdCgpLnNwbGl0KCdbJykuY29uY2F0KGtleXMpO1xuICAgICAga2V5c0xhc3RJbmRleCA9IGtleXMubGVuZ3RoIC0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAga2V5c0xhc3RJbmRleCA9IDA7XG4gICAgfVxuXG4gICAgaWYgKHBhaXIubGVuZ3RoID49IDIpIHtcbiAgICAgIGxldCB2YWx1ZSA9IHBhaXJbMV0gPyBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSkgOiAnJztcbiAgICAgIGlmIChrZXlzTGFzdEluZGV4KSB7XG4gICAgICAgIHBhcnNlQ29tcGxleFBhcmFtKHF1ZXJ5UGFyYW1zLCBrZXlzLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBxdWVyeVBhcmFtc1trZXldID0gcHJvY2Vzc1NjYWxhclBhcmFtKHF1ZXJ5UGFyYW1zW2tleV0sIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcXVlcnlQYXJhbXNba2V5XSA9IHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBxdWVyeVBhcmFtcztcbn0iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/aurelia-path/dist/es2015/aurelia-path.js\n");

/***/ }),

/***/ "./node_modules/aurelia-polyfills/dist/es2015/aurelia-polyfills.js":
/*!*************************************************************************!*\
  !*** ./node_modules/aurelia-polyfills/dist/es2015/aurelia-polyfills.js ***!
  \*************************************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n\n\nif (typeof FEATURE_NO_ES2015 === 'undefined') {\n\n  (function (Object, GOPS) {\n    'use strict';\n\n    if (GOPS in Object) return;\n\n    var setDescriptor,\n        G = aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"PLATFORM\"].global,\n        id = 0,\n        random = '' + Math.random(),\n        prefix = '__\\x01symbol:',\n        prefixLength = prefix.length,\n        internalSymbol = '__\\x01symbol@@' + random,\n        DP = 'defineProperty',\n        DPies = 'defineProperties',\n        GOPN = 'getOwnPropertyNames',\n        GOPD = 'getOwnPropertyDescriptor',\n        PIE = 'propertyIsEnumerable',\n        gOPN = Object[GOPN],\n        gOPD = Object[GOPD],\n        create = Object.create,\n        keys = Object.keys,\n        defineProperty = Object[DP],\n        $defineProperties = Object[DPies],\n        descriptor = gOPD(Object, GOPN),\n        ObjectProto = Object.prototype,\n        hOP = ObjectProto.hasOwnProperty,\n        pIE = ObjectProto[PIE],\n        toString = ObjectProto.toString,\n        indexOf = Array.prototype.indexOf || function (v) {\n      for (var i = this.length; i-- && this[i] !== v;) {}\n      return i;\n    },\n        addInternalIfNeeded = function (o, uid, enumerable) {\n      if (!hOP.call(o, internalSymbol)) {\n        defineProperty(o, internalSymbol, {\n          enumerable: false,\n          configurable: false,\n          writable: false,\n          value: {}\n        });\n      }\n      o[internalSymbol]['@@' + uid] = enumerable;\n    },\n        createWithSymbols = function (proto, descriptors) {\n      var self = create(proto);\n      if (descriptors !== null && typeof descriptors === 'object') {\n        gOPN(descriptors).forEach(function (key) {\n          if (propertyIsEnumerable.call(descriptors, key)) {\n            $defineProperty(self, key, descriptors[key]);\n          }\n        });\n      }\n      return self;\n    },\n        copyAsNonEnumerable = function (descriptor) {\n      var newDescriptor = create(descriptor);\n      newDescriptor.enumerable = false;\n      return newDescriptor;\n    },\n        get = function get() {},\n        onlyNonSymbols = function (name) {\n      return name != internalSymbol && !hOP.call(source, name);\n    },\n        onlySymbols = function (name) {\n      return name != internalSymbol && hOP.call(source, name);\n    },\n        propertyIsEnumerable = function propertyIsEnumerable(key) {\n      var uid = '' + key;\n      return onlySymbols(uid) ? hOP.call(this, uid) && this[internalSymbol] && this[internalSymbol]['@@' + uid] : pIE.call(this, key);\n    },\n        setAndGetSymbol = function (uid) {\n      var descriptor = {\n        enumerable: false,\n        configurable: true,\n        get: get,\n        set: function (value) {\n          setDescriptor(this, uid, {\n            enumerable: false,\n            configurable: true,\n            writable: true,\n            value: value\n          });\n          addInternalIfNeeded(this, uid, true);\n        }\n      };\n      defineProperty(ObjectProto, uid, descriptor);\n      return source[uid] = defineProperty(Object(uid), 'constructor', sourceConstructor);\n    },\n        Symbol = function Symbol(description) {\n      if (this && this !== G) {\n        throw new TypeError('Symbol is not a constructor');\n      }\n      return setAndGetSymbol(prefix.concat(description || '', random, ++id));\n    },\n        source = create(null),\n        sourceConstructor = { value: Symbol },\n        sourceMap = function (uid) {\n      return source[uid];\n    },\n        $defineProperty = function defineProp(o, key, descriptor) {\n      var uid = '' + key;\n      if (onlySymbols(uid)) {\n        setDescriptor(o, uid, descriptor.enumerable ? copyAsNonEnumerable(descriptor) : descriptor);\n        addInternalIfNeeded(o, uid, !!descriptor.enumerable);\n      } else {\n        defineProperty(o, key, descriptor);\n      }\n      return o;\n    },\n        $getOwnPropertySymbols = function getOwnPropertySymbols(o) {\n      var cof = toString.call(o);\n      o = cof === '[object String]' ? o.split('') : Object(o);\n      return gOPN(o).filter(onlySymbols).map(sourceMap);\n    };\n\n    descriptor.value = $defineProperty;\n    defineProperty(Object, DP, descriptor);\n\n    descriptor.value = $getOwnPropertySymbols;\n    defineProperty(Object, GOPS, descriptor);\n\n    var cachedWindowNames = typeof window === 'object' ? Object.getOwnPropertyNames(window) : [];\n    var originalObjectGetOwnPropertyNames = Object.getOwnPropertyNames;\n    descriptor.value = function getOwnPropertyNames(o) {\n      if (toString.call(o) === '[object Window]') {\n        try {\n          return originalObjectGetOwnPropertyNames(o);\n        } catch (e) {\n          return [].concat([], cachedWindowNames);\n        }\n      }\n      return gOPN(o).filter(onlyNonSymbols);\n    };\n    defineProperty(Object, GOPN, descriptor);\n\n    descriptor.value = function defineProperties(o, descriptors) {\n      var symbols = $getOwnPropertySymbols(descriptors);\n      if (symbols.length) {\n        keys(descriptors).concat(symbols).forEach(function (uid) {\n          if (propertyIsEnumerable.call(descriptors, uid)) {\n            $defineProperty(o, uid, descriptors[uid]);\n          }\n        });\n      } else {\n        $defineProperties(o, descriptors);\n      }\n      return o;\n    };\n    defineProperty(Object, DPies, descriptor);\n\n    descriptor.value = propertyIsEnumerable;\n    defineProperty(ObjectProto, PIE, descriptor);\n\n    descriptor.value = Symbol;\n    defineProperty(G, 'Symbol', descriptor);\n\n    descriptor.value = function (key) {\n      var uid = prefix.concat(prefix, key, random);\n      return uid in ObjectProto ? source[uid] : setAndGetSymbol(uid);\n    };\n    defineProperty(Symbol, 'for', descriptor);\n\n    descriptor.value = function (symbol) {\n      return hOP.call(source, symbol) ? symbol.slice(prefixLength * 2, -random.length) : void 0;\n    };\n    defineProperty(Symbol, 'keyFor', descriptor);\n\n    descriptor.value = function getOwnPropertyDescriptor(o, key) {\n      var descriptor = gOPD(o, key);\n      if (descriptor && onlySymbols(key)) {\n        descriptor.enumerable = propertyIsEnumerable.call(o, key);\n      }\n      return descriptor;\n    };\n    defineProperty(Object, GOPD, descriptor);\n\n    descriptor.value = function (proto, descriptors) {\n      return arguments.length === 1 ? create(proto) : createWithSymbols(proto, descriptors);\n    };\n    defineProperty(Object, 'create', descriptor);\n\n    descriptor.value = function () {\n      var str = toString.call(this);\n      return str === '[object String]' && onlySymbols(this) ? '[object Symbol]' : str;\n    };\n    defineProperty(ObjectProto, 'toString', descriptor);\n\n    try {\n      setDescriptor = create(defineProperty({}, prefix, {\n        get: function () {\n          return defineProperty(this, prefix, { value: false })[prefix];\n        }\n      }))[prefix] || defineProperty;\n    } catch (o_O) {\n      setDescriptor = function (o, key, descriptor) {\n        var protoDescriptor = gOPD(ObjectProto, key);\n        delete ObjectProto[key];\n        defineProperty(o, key, descriptor);\n        defineProperty(ObjectProto, key, protoDescriptor);\n      };\n    }\n  })(Object, 'getOwnPropertySymbols');\n\n  (function (O, S) {\n    var dP = O.defineProperty,\n        ObjectProto = O.prototype,\n        toString = ObjectProto.toString,\n        toStringTag = 'toStringTag',\n        descriptor;\n    ['iterator', 'match', 'replace', 'search', 'split', 'hasInstance', 'isConcatSpreadable', 'unscopables', 'species', 'toPrimitive', toStringTag].forEach(function (name) {\n      if (!(name in Symbol)) {\n        dP(Symbol, name, { value: Symbol(name) });\n        switch (name) {\n          case toStringTag:\n            descriptor = O.getOwnPropertyDescriptor(ObjectProto, 'toString');\n            descriptor.value = function () {\n              var str = toString.call(this),\n                  tst = typeof this === 'undefined' || this === null ? undefined : this[Symbol.toStringTag];\n              return typeof tst === 'undefined' ? str : '[object ' + tst + ']';\n            };\n            dP(ObjectProto, 'toString', descriptor);\n            break;\n        }\n      }\n    });\n  })(Object, Symbol);\n\n  (function (Si, AP, SP) {\n\n    function returnThis() {\n      return this;\n    }\n\n    if (!AP[Si]) AP[Si] = function () {\n      var i = 0,\n          self = this,\n          iterator = {\n        next: function next() {\n          var done = self.length <= i;\n          return done ? { done: done } : { done: done, value: self[i++] };\n        }\n      };\n      iterator[Si] = returnThis;\n      return iterator;\n    };\n\n    if (!SP[Si]) SP[Si] = function () {\n      var fromCodePoint = String.fromCodePoint,\n          self = this,\n          i = 0,\n          length = self.length,\n          iterator = {\n        next: function next() {\n          var done = length <= i,\n              c = done ? '' : fromCodePoint(self.codePointAt(i));\n          i += c.length;\n          return done ? { done: done } : { done: done, value: c };\n        }\n      };\n      iterator[Si] = returnThis;\n      return iterator;\n    };\n  })(Symbol.iterator, Array.prototype, String.prototype);\n}\n\nif (typeof FEATURE_NO_ES2015 === 'undefined') {\n\n  Number.isNaN = Number.isNaN || function (value) {\n    return value !== value;\n  };\n\n  Number.isFinite = Number.isFinite || function (value) {\n    return typeof value === \"number\" && isFinite(value);\n  };\n}\n\nif (!String.prototype.endsWith || function () {\n  try {\n    return !\"ab\".endsWith(\"a\", 1);\n  } catch (e) {\n    return true;\n  }\n}()) {\n  String.prototype.endsWith = function (searchString, position) {\n    let subjectString = this.toString();\n    if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > subjectString.length) {\n      position = subjectString.length;\n    }\n    position -= searchString.length;\n    let lastIndex = subjectString.indexOf(searchString, position);\n    return lastIndex !== -1 && lastIndex === position;\n  };\n}\n\nif (!String.prototype.startsWith || function () {\n  try {\n    return !\"ab\".startsWith(\"b\", 1);\n  } catch (e) {\n    return true;\n  }\n}()) {\n  String.prototype.startsWith = function (searchString, position) {\n    position = position || 0;\n    return this.substr(position, searchString.length) === searchString;\n  };\n}\n\nif (typeof FEATURE_NO_ES2015 === 'undefined') {\n\n  if (!Array.from) {\n    Array.from = function () {\n      var toInteger = function (it) {\n        return isNaN(it = +it) ? 0 : (it > 0 ? Math.floor : Math.ceil)(it);\n      };\n      var toLength = function (it) {\n        return it > 0 ? Math.min(toInteger(it), 0x1fffffffffffff) : 0;\n      };\n      var iterCall = function (iter, fn, val, index) {\n        try {\n          return fn(val, index);\n        } catch (E) {\n          if (typeof iter.return == 'function') iter.return();\n          throw E;\n        }\n      };\n\n      return function from(arrayLike) {\n        var O = Object(arrayLike),\n            C = typeof this == 'function' ? this : Array,\n            aLen = arguments.length,\n            mapfn = aLen > 1 ? arguments[1] : undefined,\n            mapping = mapfn !== undefined,\n            index = 0,\n            iterFn = O[Symbol.iterator],\n            length,\n            result,\n            step,\n            iterator;\n        if (mapping) mapfn = mapfn.bind(aLen > 2 ? arguments[2] : undefined);\n        if (iterFn != undefined && !Array.isArray(arrayLike)) {\n          for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {\n            result[index] = mapping ? iterCall(iterator, mapfn, step.value, index) : step.value;\n          }\n        } else {\n          length = toLength(O.length);\n          for (result = new C(length); length > index; index++) {\n            result[index] = mapping ? mapfn(O[index], index) : O[index];\n          }\n        }\n        result.length = index;\n        return result;\n      };\n    }();\n  }\n\n  if (!Array.prototype.find) {\n    Object.defineProperty(Array.prototype, 'find', {\n      configurable: true,\n      writable: true,\n      enumerable: false,\n      value: function (predicate) {\n        if (this === null) {\n          throw new TypeError('Array.prototype.find called on null or undefined');\n        }\n        if (typeof predicate !== 'function') {\n          throw new TypeError('predicate must be a function');\n        }\n        var list = Object(this);\n        var length = list.length >>> 0;\n        var thisArg = arguments[1];\n        var value;\n\n        for (var i = 0; i < length; i++) {\n          value = list[i];\n          if (predicate.call(thisArg, value, i, list)) {\n            return value;\n          }\n        }\n        return undefined;\n      }\n    });\n  }\n\n  if (!Array.prototype.findIndex) {\n    Object.defineProperty(Array.prototype, 'findIndex', {\n      configurable: true,\n      writable: true,\n      enumerable: false,\n      value: function (predicate) {\n        if (this === null) {\n          throw new TypeError('Array.prototype.findIndex called on null or undefined');\n        }\n        if (typeof predicate !== 'function') {\n          throw new TypeError('predicate must be a function');\n        }\n        var list = Object(this);\n        var length = list.length >>> 0;\n        var thisArg = arguments[1];\n        var value;\n\n        for (var i = 0; i < length; i++) {\n          value = list[i];\n          if (predicate.call(thisArg, value, i, list)) {\n            return i;\n          }\n        }\n        return -1;\n      }\n    });\n  }\n}\n\nif (typeof FEATURE_NO_ES2016 === 'undefined' && !Array.prototype.includes) {\n  Object.defineProperty(Array.prototype, 'includes', {\n    configurable: true,\n    writable: true,\n    enumerable: false,\n    value: function (searchElement) {\n      var O = Object(this);\n      var len = parseInt(O.length) || 0;\n      if (len === 0) {\n        return false;\n      }\n      var n = parseInt(arguments[1]) || 0;\n      var k;\n      if (n >= 0) {\n        k = n;\n      } else {\n        k = len + n;\n        if (k < 0) {\n          k = 0;\n        }\n      }\n      var currentElement;\n      while (k < len) {\n        currentElement = O[k];\n        if (searchElement === currentElement || searchElement !== searchElement && currentElement !== currentElement) {\n          return true;\n        }\n        k++;\n      }\n      return false;\n    }\n  });\n}\n\nif (typeof FEATURE_NO_ES2015 === 'undefined') {\n\n  (function () {\n    let needsFix = false;\n\n    try {\n      let s = Object.keys('a');\n      needsFix = s.length !== 1 || s[0] !== '0';\n    } catch (e) {\n      needsFix = true;\n    }\n\n    if (needsFix) {\n      Object.keys = function () {\n        var hasOwnProperty = Object.prototype.hasOwnProperty,\n            hasDontEnumBug = !{ toString: null }.propertyIsEnumerable('toString'),\n            dontEnums = ['toString', 'toLocaleString', 'valueOf', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable', 'constructor'],\n            dontEnumsLength = dontEnums.length;\n\n        return function (obj) {\n          if (obj === undefined || obj === null) {\n            throw TypeError(`Cannot convert undefined or null to object`);\n          }\n\n          obj = Object(obj);\n\n          var result = [],\n              prop,\n              i;\n\n          for (prop in obj) {\n            if (hasOwnProperty.call(obj, prop)) {\n              result.push(prop);\n            }\n          }\n\n          if (hasDontEnumBug) {\n            for (i = 0; i < dontEnumsLength; i++) {\n              if (hasOwnProperty.call(obj, dontEnums[i])) {\n                result.push(dontEnums[i]);\n              }\n            }\n          }\n\n          return result;\n        };\n      }();\n    }\n  })();\n\n  (function (O) {\n    if ('assign' in O) {\n      return;\n    }\n\n    O.defineProperty(O, 'assign', {\n      configurable: true,\n      writable: true,\n      value: function () {\n        var gOPS = O.getOwnPropertySymbols,\n            pIE = O.propertyIsEnumerable,\n            filterOS = gOPS ? function (self) {\n          return gOPS(self).filter(pIE, self);\n        } : function () {\n          return Array.prototype;\n        };\n\n        return function assign(where) {\n          if (gOPS && !(where instanceof O)) {\n            console.warn('problematic Symbols', where);\n          }\n\n          function set(keyOrSymbol) {\n            where[keyOrSymbol] = arg[keyOrSymbol];\n          }\n\n          for (var i = 1, ii = arguments.length; i < ii; ++i) {\n            var arg = arguments[i];\n\n            if (arg === null || arg === undefined) {\n              continue;\n            }\n\n            O.keys(arg).concat(filterOS(arg)).forEach(set);\n          }\n\n          return where;\n        };\n      }()\n    });\n  })(Object);\n\n  if (!Object.is) {\n    Object.is = function (x, y) {\n      if (x === y) {\n        return x !== 0 || 1 / x === 1 / y;\n      } else {\n        return x !== x && y !== y;\n      }\n    };\n  }\n}\n\nif (typeof FEATURE_NO_ES2015 === 'undefined') {\n\n  (function (global) {\n    var i;\n\n    var defineProperty = Object.defineProperty,\n        is = function (a, b) {\n      return a === b || a !== a && b !== b;\n    };\n\n    if (typeof WeakMap == 'undefined') {\n      global.WeakMap = createCollection({\n        'delete': sharedDelete,\n\n        clear: sharedClear,\n\n        get: sharedGet,\n\n        has: mapHas,\n\n        set: sharedSet\n      }, true);\n    }\n\n    if (typeof Map == 'undefined' || typeof new Map().values !== 'function' || !new Map().values().next) {\n      global.Map = createCollection({\n        'delete': sharedDelete,\n\n        has: mapHas,\n\n        get: sharedGet,\n\n        set: sharedSet,\n\n        keys: sharedKeys,\n\n        values: sharedValues,\n\n        entries: mapEntries,\n\n        forEach: sharedForEach,\n\n        clear: sharedClear,\n\n        [Symbol.iterator]: mapEntries\n      });\n    }\n\n    if (typeof Set == 'undefined' || typeof new Set().values !== 'function' || !new Set().values().next) {\n      global.Set = createCollection({\n        has: setHas,\n\n        add: sharedAdd,\n\n        'delete': sharedDelete,\n\n        clear: sharedClear,\n\n        keys: sharedValues,\n        values: sharedValues,\n\n        entries: setEntries,\n\n        forEach: sharedForEach,\n\n        [Symbol.iterator]: sharedValues\n      });\n    }\n\n    if (typeof WeakSet == 'undefined') {\n      global.WeakSet = createCollection({\n        'delete': sharedDelete,\n\n        add: sharedAdd,\n\n        clear: sharedClear,\n\n        has: setHas\n      }, true);\n    }\n\n    function createCollection(proto, objectOnly) {\n      function Collection(a) {\n        if (!this || this.constructor !== Collection) return new Collection(a);\n        this._keys = [];\n        this._values = [];\n        this._itp = [];\n        this.objectOnly = objectOnly;\n\n        if (a) init.call(this, a);\n      }\n\n      if (!objectOnly) {\n        defineProperty(proto, 'size', {\n          get: sharedSize\n        });\n      }\n\n      proto.constructor = Collection;\n      Collection.prototype = proto;\n\n      return Collection;\n    }\n\n    function init(a) {\n      var i;\n\n      if (this.add) a.forEach(this.add, this);else a.forEach(function (a) {\n          this.set(a[0], a[1]);\n        }, this);\n    }\n\n    function sharedDelete(key) {\n      if (this.has(key)) {\n        this._keys.splice(i, 1);\n        this._values.splice(i, 1);\n\n        this._itp.forEach(function (p) {\n          if (i < p[0]) p[0]--;\n        });\n      }\n\n      return -1 < i;\n    };\n\n    function sharedGet(key) {\n      return this.has(key) ? this._values[i] : undefined;\n    }\n\n    function has(list, key) {\n      if (this.objectOnly && key !== Object(key)) throw new TypeError(\"Invalid value used as weak collection key\");\n\n      if (key != key || key === 0) for (i = list.length; i-- && !is(list[i], key);) {} else i = list.indexOf(key);\n      return -1 < i;\n    }\n\n    function setHas(value) {\n      return has.call(this, this._values, value);\n    }\n\n    function mapHas(value) {\n      return has.call(this, this._keys, value);\n    }\n\n    function sharedSet(key, value) {\n      this.has(key) ? this._values[i] = value : this._values[this._keys.push(key) - 1] = value;\n      return this;\n    }\n\n    function sharedAdd(value) {\n      if (!this.has(value)) this._values.push(value);\n      return this;\n    }\n\n    function sharedClear() {\n      (this._keys || 0).length = this._values.length = 0;\n    }\n\n    function sharedKeys() {\n      return sharedIterator(this._itp, this._keys);\n    }\n\n    function sharedValues() {\n      return sharedIterator(this._itp, this._values);\n    }\n\n    function mapEntries() {\n      return sharedIterator(this._itp, this._keys, this._values);\n    }\n\n    function setEntries() {\n      return sharedIterator(this._itp, this._values, this._values);\n    }\n\n    function sharedIterator(itp, array, array2) {\n      var p = [0],\n          done = false;\n      itp.push(p);\n      return {\n        [Symbol.iterator]: function () {\n          return this;\n        },\n        next: function () {\n          var v,\n              k = p[0];\n          if (!done && k < array.length) {\n            v = array2 ? [array[k], array2[k]] : array[k];\n            p[0]++;\n          } else {\n            done = true;\n            itp.splice(itp.indexOf(p), 1);\n          }\n          return { done: done, value: v };\n        }\n      };\n    }\n\n    function sharedSize() {\n      return this._values.length;\n    }\n\n    function sharedForEach(callback, context) {\n      var it = this.entries();\n      for (;;) {\n        var r = it.next();\n        if (r.done) break;\n        callback.call(context, r.value[1], r.value[0], this);\n      }\n    }\n  })(aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"PLATFORM\"].global);\n}\n\nif (typeof FEATURE_NO_ES2015 === 'undefined') {\n\n  const bind = Function.prototype.bind;\n\n  if (typeof aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"PLATFORM\"].global.Reflect === 'undefined') {\n    aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"PLATFORM\"].global.Reflect = {};\n  }\n\n  if (typeof Reflect.defineProperty !== 'function') {\n    Reflect.defineProperty = function (target, propertyKey, descriptor) {\n      if (typeof target === 'object' ? target === null : typeof target !== 'function') {\n        throw new TypeError('Reflect.defineProperty called on non-object');\n      }\n      try {\n        Object.defineProperty(target, propertyKey, descriptor);\n        return true;\n      } catch (e) {\n        return false;\n      }\n    };\n  }\n\n  if (typeof Reflect.construct !== 'function') {\n    Reflect.construct = function (Target, args) {\n      if (args) {\n        switch (args.length) {\n          case 0:\n            return new Target();\n          case 1:\n            return new Target(args[0]);\n          case 2:\n            return new Target(args[0], args[1]);\n          case 3:\n            return new Target(args[0], args[1], args[2]);\n          case 4:\n            return new Target(args[0], args[1], args[2], args[3]);\n        }\n      }\n\n      var a = [null];\n      a.push.apply(a, args);\n      return new (bind.apply(Target, a))();\n    };\n  }\n\n  if (typeof Reflect.ownKeys !== 'function') {\n    Reflect.ownKeys = function (o) {\n      return Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o));\n    };\n  }\n}\n\nif (typeof FEATURE_NO_ESNEXT === 'undefined') {\n\n  const emptyMetadata = Object.freeze({});\n  const metadataContainerKey = '__metadata__';\n\n  if (typeof Reflect.getOwnMetadata !== 'function') {\n    Reflect.getOwnMetadata = function (metadataKey, target, targetKey) {\n      if (target.hasOwnProperty(metadataContainerKey)) {\n        return (target[metadataContainerKey][targetKey] || emptyMetadata)[metadataKey];\n      }\n    };\n  }\n\n  if (typeof Reflect.defineMetadata !== 'function') {\n    Reflect.defineMetadata = function (metadataKey, metadataValue, target, targetKey) {\n      let metadataContainer = target.hasOwnProperty(metadataContainerKey) ? target[metadataContainerKey] : target[metadataContainerKey] = {};\n      let targetContainer = metadataContainer[targetKey] || (metadataContainer[targetKey] = {});\n      targetContainer[metadataKey] = metadataValue;\n    };\n  }\n\n  if (typeof Reflect.metadata !== 'function') {\n    Reflect.metadata = function (metadataKey, metadataValue) {\n      return function (target, targetKey) {\n        Reflect.defineMetadata(metadataKey, metadataValue, target, targetKey);\n      };\n    };\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1wb2x5ZmlsbHMvZGlzdC9lczIwMTUvYXVyZWxpYS1wb2x5ZmlsbHMuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1wb2x5ZmlsbHMvZGlzdC9lczIwMTUvYXVyZWxpYS1wb2x5ZmlsbHMuanM/OTAzMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQTEFURk9STSB9IGZyb20gJ2F1cmVsaWEtcGFsJztcblxuaWYgKHR5cGVvZiBGRUFUVVJFX05PX0VTMjAxNSA9PT0gJ3VuZGVmaW5lZCcpIHtcblxuICAoZnVuY3Rpb24gKE9iamVjdCwgR09QUykge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmIChHT1BTIGluIE9iamVjdCkgcmV0dXJuO1xuXG4gICAgdmFyIHNldERlc2NyaXB0b3IsXG4gICAgICAgIEcgPSBQTEFURk9STS5nbG9iYWwsXG4gICAgICAgIGlkID0gMCxcbiAgICAgICAgcmFuZG9tID0gJycgKyBNYXRoLnJhbmRvbSgpLFxuICAgICAgICBwcmVmaXggPSAnX19cXHgwMXN5bWJvbDonLFxuICAgICAgICBwcmVmaXhMZW5ndGggPSBwcmVmaXgubGVuZ3RoLFxuICAgICAgICBpbnRlcm5hbFN5bWJvbCA9ICdfX1xceDAxc3ltYm9sQEAnICsgcmFuZG9tLFxuICAgICAgICBEUCA9ICdkZWZpbmVQcm9wZXJ0eScsXG4gICAgICAgIERQaWVzID0gJ2RlZmluZVByb3BlcnRpZXMnLFxuICAgICAgICBHT1BOID0gJ2dldE93blByb3BlcnR5TmFtZXMnLFxuICAgICAgICBHT1BEID0gJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsXG4gICAgICAgIFBJRSA9ICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsXG4gICAgICAgIGdPUE4gPSBPYmplY3RbR09QTl0sXG4gICAgICAgIGdPUEQgPSBPYmplY3RbR09QRF0sXG4gICAgICAgIGNyZWF0ZSA9IE9iamVjdC5jcmVhdGUsXG4gICAgICAgIGtleXMgPSBPYmplY3Qua2V5cyxcbiAgICAgICAgZGVmaW5lUHJvcGVydHkgPSBPYmplY3RbRFBdLFxuICAgICAgICAkZGVmaW5lUHJvcGVydGllcyA9IE9iamVjdFtEUGllc10sXG4gICAgICAgIGRlc2NyaXB0b3IgPSBnT1BEKE9iamVjdCwgR09QTiksXG4gICAgICAgIE9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZSxcbiAgICAgICAgaE9QID0gT2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHksXG4gICAgICAgIHBJRSA9IE9iamVjdFByb3RvW1BJRV0sXG4gICAgICAgIHRvU3RyaW5nID0gT2JqZWN0UHJvdG8udG9TdHJpbmcsXG4gICAgICAgIGluZGV4T2YgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZiB8fCBmdW5jdGlvbiAodikge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMubGVuZ3RoOyBpLS0gJiYgdGhpc1tpXSAhPT0gdjspIHt9XG4gICAgICByZXR1cm4gaTtcbiAgICB9LFxuICAgICAgICBhZGRJbnRlcm5hbElmTmVlZGVkID0gZnVuY3Rpb24gKG8sIHVpZCwgZW51bWVyYWJsZSkge1xuICAgICAgaWYgKCFoT1AuY2FsbChvLCBpbnRlcm5hbFN5bWJvbCkpIHtcbiAgICAgICAgZGVmaW5lUHJvcGVydHkobywgaW50ZXJuYWxTeW1ib2wsIHtcbiAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBvW2ludGVybmFsU3ltYm9sXVsnQEAnICsgdWlkXSA9IGVudW1lcmFibGU7XG4gICAgfSxcbiAgICAgICAgY3JlYXRlV2l0aFN5bWJvbHMgPSBmdW5jdGlvbiAocHJvdG8sIGRlc2NyaXB0b3JzKSB7XG4gICAgICB2YXIgc2VsZiA9IGNyZWF0ZShwcm90byk7XG4gICAgICBpZiAoZGVzY3JpcHRvcnMgIT09IG51bGwgJiYgdHlwZW9mIGRlc2NyaXB0b3JzID09PSAnb2JqZWN0Jykge1xuICAgICAgICBnT1BOKGRlc2NyaXB0b3JzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICBpZiAocHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChkZXNjcmlwdG9ycywga2V5KSkge1xuICAgICAgICAgICAgJGRlZmluZVByb3BlcnR5KHNlbGYsIGtleSwgZGVzY3JpcHRvcnNba2V5XSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzZWxmO1xuICAgIH0sXG4gICAgICAgIGNvcHlBc05vbkVudW1lcmFibGUgPSBmdW5jdGlvbiAoZGVzY3JpcHRvcikge1xuICAgICAgdmFyIG5ld0Rlc2NyaXB0b3IgPSBjcmVhdGUoZGVzY3JpcHRvcik7XG4gICAgICBuZXdEZXNjcmlwdG9yLmVudW1lcmFibGUgPSBmYWxzZTtcbiAgICAgIHJldHVybiBuZXdEZXNjcmlwdG9yO1xuICAgIH0sXG4gICAgICAgIGdldCA9IGZ1bmN0aW9uIGdldCgpIHt9LFxuICAgICAgICBvbmx5Tm9uU3ltYm9scyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICByZXR1cm4gbmFtZSAhPSBpbnRlcm5hbFN5bWJvbCAmJiAhaE9QLmNhbGwoc291cmNlLCBuYW1lKTtcbiAgICB9LFxuICAgICAgICBvbmx5U3ltYm9scyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICByZXR1cm4gbmFtZSAhPSBpbnRlcm5hbFN5bWJvbCAmJiBoT1AuY2FsbChzb3VyY2UsIG5hbWUpO1xuICAgIH0sXG4gICAgICAgIHByb3BlcnR5SXNFbnVtZXJhYmxlID0gZnVuY3Rpb24gcHJvcGVydHlJc0VudW1lcmFibGUoa2V5KSB7XG4gICAgICB2YXIgdWlkID0gJycgKyBrZXk7XG4gICAgICByZXR1cm4gb25seVN5bWJvbHModWlkKSA/IGhPUC5jYWxsKHRoaXMsIHVpZCkgJiYgdGhpc1tpbnRlcm5hbFN5bWJvbF0gJiYgdGhpc1tpbnRlcm5hbFN5bWJvbF1bJ0BAJyArIHVpZF0gOiBwSUUuY2FsbCh0aGlzLCBrZXkpO1xuICAgIH0sXG4gICAgICAgIHNldEFuZEdldFN5bWJvbCA9IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgIHZhciBkZXNjcmlwdG9yID0ge1xuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICBnZXQ6IGdldCxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICBzZXREZXNjcmlwdG9yKHRoaXMsIHVpZCwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGFkZEludGVybmFsSWZOZWVkZWQodGhpcywgdWlkLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGRlZmluZVByb3BlcnR5KE9iamVjdFByb3RvLCB1aWQsIGRlc2NyaXB0b3IpO1xuICAgICAgcmV0dXJuIHNvdXJjZVt1aWRdID0gZGVmaW5lUHJvcGVydHkoT2JqZWN0KHVpZCksICdjb25zdHJ1Y3RvcicsIHNvdXJjZUNvbnN0cnVjdG9yKTtcbiAgICB9LFxuICAgICAgICBTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woZGVzY3JpcHRpb24pIHtcbiAgICAgIGlmICh0aGlzICYmIHRoaXMgIT09IEcpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc2V0QW5kR2V0U3ltYm9sKHByZWZpeC5jb25jYXQoZGVzY3JpcHRpb24gfHwgJycsIHJhbmRvbSwgKytpZCkpO1xuICAgIH0sXG4gICAgICAgIHNvdXJjZSA9IGNyZWF0ZShudWxsKSxcbiAgICAgICAgc291cmNlQ29uc3RydWN0b3IgPSB7IHZhbHVlOiBTeW1ib2wgfSxcbiAgICAgICAgc291cmNlTWFwID0gZnVuY3Rpb24gKHVpZCkge1xuICAgICAgcmV0dXJuIHNvdXJjZVt1aWRdO1xuICAgIH0sXG4gICAgICAgICRkZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uIGRlZmluZVByb3Aobywga2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgICB2YXIgdWlkID0gJycgKyBrZXk7XG4gICAgICBpZiAob25seVN5bWJvbHModWlkKSkge1xuICAgICAgICBzZXREZXNjcmlwdG9yKG8sIHVpZCwgZGVzY3JpcHRvci5lbnVtZXJhYmxlID8gY29weUFzTm9uRW51bWVyYWJsZShkZXNjcmlwdG9yKSA6IGRlc2NyaXB0b3IpO1xuICAgICAgICBhZGRJbnRlcm5hbElmTmVlZGVkKG8sIHVpZCwgISFkZXNjcmlwdG9yLmVudW1lcmFibGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVmaW5lUHJvcGVydHkobywga2V5LCBkZXNjcmlwdG9yKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvO1xuICAgIH0sXG4gICAgICAgICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMobykge1xuICAgICAgdmFyIGNvZiA9IHRvU3RyaW5nLmNhbGwobyk7XG4gICAgICBvID0gY29mID09PSAnW29iamVjdCBTdHJpbmddJyA/IG8uc3BsaXQoJycpIDogT2JqZWN0KG8pO1xuICAgICAgcmV0dXJuIGdPUE4obykuZmlsdGVyKG9ubHlTeW1ib2xzKS5tYXAoc291cmNlTWFwKTtcbiAgICB9O1xuXG4gICAgZGVzY3JpcHRvci52YWx1ZSA9ICRkZWZpbmVQcm9wZXJ0eTtcbiAgICBkZWZpbmVQcm9wZXJ0eShPYmplY3QsIERQLCBkZXNjcmlwdG9yKTtcblxuICAgIGRlc2NyaXB0b3IudmFsdWUgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xuICAgIGRlZmluZVByb3BlcnR5KE9iamVjdCwgR09QUywgZGVzY3JpcHRvcik7XG5cbiAgICB2YXIgY2FjaGVkV2luZG93TmFtZXMgPSB0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdykgOiBbXTtcbiAgICB2YXIgb3JpZ2luYWxPYmplY3RHZXRPd25Qcm9wZXJ0eU5hbWVzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXM7XG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMobykge1xuICAgICAgaWYgKHRvU3RyaW5nLmNhbGwobykgPT09ICdbb2JqZWN0IFdpbmRvd10nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuIG9yaWdpbmFsT2JqZWN0R2V0T3duUHJvcGVydHlOYW1lcyhvKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHJldHVybiBbXS5jb25jYXQoW10sIGNhY2hlZFdpbmRvd05hbWVzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGdPUE4obykuZmlsdGVyKG9ubHlOb25TeW1ib2xzKTtcbiAgICB9O1xuICAgIGRlZmluZVByb3BlcnR5KE9iamVjdCwgR09QTiwgZGVzY3JpcHRvcik7XG5cbiAgICBkZXNjcmlwdG9yLnZhbHVlID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhvLCBkZXNjcmlwdG9ycykge1xuICAgICAgdmFyIHN5bWJvbHMgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzKGRlc2NyaXB0b3JzKTtcbiAgICAgIGlmIChzeW1ib2xzLmxlbmd0aCkge1xuICAgICAgICBrZXlzKGRlc2NyaXB0b3JzKS5jb25jYXQoc3ltYm9scykuZm9yRWFjaChmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgICAgaWYgKHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZGVzY3JpcHRvcnMsIHVpZCkpIHtcbiAgICAgICAgICAgICRkZWZpbmVQcm9wZXJ0eShvLCB1aWQsIGRlc2NyaXB0b3JzW3VpZF0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkZGVmaW5lUHJvcGVydGllcyhvLCBkZXNjcmlwdG9ycyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbztcbiAgICB9O1xuICAgIGRlZmluZVByb3BlcnR5KE9iamVjdCwgRFBpZXMsIGRlc2NyaXB0b3IpO1xuXG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IHByb3BlcnR5SXNFbnVtZXJhYmxlO1xuICAgIGRlZmluZVByb3BlcnR5KE9iamVjdFByb3RvLCBQSUUsIGRlc2NyaXB0b3IpO1xuXG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IFN5bWJvbDtcbiAgICBkZWZpbmVQcm9wZXJ0eShHLCAnU3ltYm9sJywgZGVzY3JpcHRvcik7XG5cbiAgICBkZXNjcmlwdG9yLnZhbHVlID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgdmFyIHVpZCA9IHByZWZpeC5jb25jYXQocHJlZml4LCBrZXksIHJhbmRvbSk7XG4gICAgICByZXR1cm4gdWlkIGluIE9iamVjdFByb3RvID8gc291cmNlW3VpZF0gOiBzZXRBbmRHZXRTeW1ib2wodWlkKTtcbiAgICB9O1xuICAgIGRlZmluZVByb3BlcnR5KFN5bWJvbCwgJ2ZvcicsIGRlc2NyaXB0b3IpO1xuXG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uIChzeW1ib2wpIHtcbiAgICAgIHJldHVybiBoT1AuY2FsbChzb3VyY2UsIHN5bWJvbCkgPyBzeW1ib2wuc2xpY2UocHJlZml4TGVuZ3RoICogMiwgLXJhbmRvbS5sZW5ndGgpIDogdm9pZCAwO1xuICAgIH07XG4gICAgZGVmaW5lUHJvcGVydHkoU3ltYm9sLCAna2V5Rm9yJywgZGVzY3JpcHRvcik7XG5cbiAgICBkZXNjcmlwdG9yLnZhbHVlID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG8sIGtleSkge1xuICAgICAgdmFyIGRlc2NyaXB0b3IgPSBnT1BEKG8sIGtleSk7XG4gICAgICBpZiAoZGVzY3JpcHRvciAmJiBvbmx5U3ltYm9scyhrZXkpKSB7XG4gICAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwobywga2V5KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICAgIH07XG4gICAgZGVmaW5lUHJvcGVydHkoT2JqZWN0LCBHT1BELCBkZXNjcmlwdG9yKTtcblxuICAgIGRlc2NyaXB0b3IudmFsdWUgPSBmdW5jdGlvbiAocHJvdG8sIGRlc2NyaXB0b3JzKSB7XG4gICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PT0gMSA/IGNyZWF0ZShwcm90bykgOiBjcmVhdGVXaXRoU3ltYm9scyhwcm90bywgZGVzY3JpcHRvcnMpO1xuICAgIH07XG4gICAgZGVmaW5lUHJvcGVydHkoT2JqZWN0LCAnY3JlYXRlJywgZGVzY3JpcHRvcik7XG5cbiAgICBkZXNjcmlwdG9yLnZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHN0ciA9IHRvU3RyaW5nLmNhbGwodGhpcyk7XG4gICAgICByZXR1cm4gc3RyID09PSAnW29iamVjdCBTdHJpbmddJyAmJiBvbmx5U3ltYm9scyh0aGlzKSA/ICdbb2JqZWN0IFN5bWJvbF0nIDogc3RyO1xuICAgIH07XG4gICAgZGVmaW5lUHJvcGVydHkoT2JqZWN0UHJvdG8sICd0b1N0cmluZycsIGRlc2NyaXB0b3IpO1xuXG4gICAgdHJ5IHtcbiAgICAgIHNldERlc2NyaXB0b3IgPSBjcmVhdGUoZGVmaW5lUHJvcGVydHkoe30sIHByZWZpeCwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gZGVmaW5lUHJvcGVydHkodGhpcywgcHJlZml4LCB7IHZhbHVlOiBmYWxzZSB9KVtwcmVmaXhdO1xuICAgICAgICB9XG4gICAgICB9KSlbcHJlZml4XSB8fCBkZWZpbmVQcm9wZXJ0eTtcbiAgICB9IGNhdGNoIChvX08pIHtcbiAgICAgIHNldERlc2NyaXB0b3IgPSBmdW5jdGlvbiAobywga2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgICAgIHZhciBwcm90b0Rlc2NyaXB0b3IgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpO1xuICAgICAgICBkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTtcbiAgICAgICAgZGVmaW5lUHJvcGVydHkobywga2V5LCBkZXNjcmlwdG9yKTtcbiAgICAgICAgZGVmaW5lUHJvcGVydHkoT2JqZWN0UHJvdG8sIGtleSwgcHJvdG9EZXNjcmlwdG9yKTtcbiAgICAgIH07XG4gICAgfVxuICB9KShPYmplY3QsICdnZXRPd25Qcm9wZXJ0eVN5bWJvbHMnKTtcblxuICAoZnVuY3Rpb24gKE8sIFMpIHtcbiAgICB2YXIgZFAgPSBPLmRlZmluZVByb3BlcnR5LFxuICAgICAgICBPYmplY3RQcm90byA9IE8ucHJvdG90eXBlLFxuICAgICAgICB0b1N0cmluZyA9IE9iamVjdFByb3RvLnRvU3RyaW5nLFxuICAgICAgICB0b1N0cmluZ1RhZyA9ICd0b1N0cmluZ1RhZycsXG4gICAgICAgIGRlc2NyaXB0b3I7XG4gICAgWydpdGVyYXRvcicsICdtYXRjaCcsICdyZXBsYWNlJywgJ3NlYXJjaCcsICdzcGxpdCcsICdoYXNJbnN0YW5jZScsICdpc0NvbmNhdFNwcmVhZGFibGUnLCAndW5zY29wYWJsZXMnLCAnc3BlY2llcycsICd0b1ByaW1pdGl2ZScsIHRvU3RyaW5nVGFnXS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICBpZiAoIShuYW1lIGluIFN5bWJvbCkpIHtcbiAgICAgICAgZFAoU3ltYm9sLCBuYW1lLCB7IHZhbHVlOiBTeW1ib2wobmFtZSkgfSk7XG4gICAgICAgIHN3aXRjaCAobmFtZSkge1xuICAgICAgICAgIGNhc2UgdG9TdHJpbmdUYWc6XG4gICAgICAgICAgICBkZXNjcmlwdG9yID0gTy5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoT2JqZWN0UHJvdG8sICd0b1N0cmluZycpO1xuICAgICAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgdmFyIHN0ciA9IHRvU3RyaW5nLmNhbGwodGhpcyksXG4gICAgICAgICAgICAgICAgICB0c3QgPSB0eXBlb2YgdGhpcyA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcyA9PT0gbnVsbCA/IHVuZGVmaW5lZCA6IHRoaXNbU3ltYm9sLnRvU3RyaW5nVGFnXTtcbiAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiB0c3QgPT09ICd1bmRlZmluZWQnID8gc3RyIDogJ1tvYmplY3QgJyArIHRzdCArICddJztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBkUChPYmplY3RQcm90bywgJ3RvU3RyaW5nJywgZGVzY3JpcHRvcik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9KShPYmplY3QsIFN5bWJvbCk7XG5cbiAgKGZ1bmN0aW9uIChTaSwgQVAsIFNQKSB7XG5cbiAgICBmdW5jdGlvbiByZXR1cm5UaGlzKCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgaWYgKCFBUFtTaV0pIEFQW1NpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBpID0gMCxcbiAgICAgICAgICBzZWxmID0gdGhpcyxcbiAgICAgICAgICBpdGVyYXRvciA9IHtcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgICB2YXIgZG9uZSA9IHNlbGYubGVuZ3RoIDw9IGk7XG4gICAgICAgICAgcmV0dXJuIGRvbmUgPyB7IGRvbmU6IGRvbmUgfSA6IHsgZG9uZTogZG9uZSwgdmFsdWU6IHNlbGZbaSsrXSB9O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgaXRlcmF0b3JbU2ldID0gcmV0dXJuVGhpcztcbiAgICAgIHJldHVybiBpdGVyYXRvcjtcbiAgICB9O1xuXG4gICAgaWYgKCFTUFtTaV0pIFNQW1NpXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBmcm9tQ29kZVBvaW50ID0gU3RyaW5nLmZyb21Db2RlUG9pbnQsXG4gICAgICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgbGVuZ3RoID0gc2VsZi5sZW5ndGgsXG4gICAgICAgICAgaXRlcmF0b3IgPSB7XG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgdmFyIGRvbmUgPSBsZW5ndGggPD0gaSxcbiAgICAgICAgICAgICAgYyA9IGRvbmUgPyAnJyA6IGZyb21Db2RlUG9pbnQoc2VsZi5jb2RlUG9pbnRBdChpKSk7XG4gICAgICAgICAgaSArPSBjLmxlbmd0aDtcbiAgICAgICAgICByZXR1cm4gZG9uZSA/IHsgZG9uZTogZG9uZSB9IDogeyBkb25lOiBkb25lLCB2YWx1ZTogYyB9O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgaXRlcmF0b3JbU2ldID0gcmV0dXJuVGhpcztcbiAgICAgIHJldHVybiBpdGVyYXRvcjtcbiAgICB9O1xuICB9KShTeW1ib2wuaXRlcmF0b3IsIEFycmF5LnByb3RvdHlwZSwgU3RyaW5nLnByb3RvdHlwZSk7XG59XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19FUzIwMTUgPT09ICd1bmRlZmluZWQnKSB7XG5cbiAgTnVtYmVyLmlzTmFOID0gTnVtYmVyLmlzTmFOIHx8IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAhPT0gdmFsdWU7XG4gIH07XG5cbiAgTnVtYmVyLmlzRmluaXRlID0gTnVtYmVyLmlzRmluaXRlIHx8IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgJiYgaXNGaW5pdGUodmFsdWUpO1xuICB9O1xufVxuXG5pZiAoIVN0cmluZy5wcm90b3R5cGUuZW5kc1dpdGggfHwgZnVuY3Rpb24gKCkge1xuICB0cnkge1xuICAgIHJldHVybiAhXCJhYlwiLmVuZHNXaXRoKFwiYVwiLCAxKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59KCkpIHtcbiAgU3RyaW5nLnByb3RvdHlwZS5lbmRzV2l0aCA9IGZ1bmN0aW9uIChzZWFyY2hTdHJpbmcsIHBvc2l0aW9uKSB7XG4gICAgbGV0IHN1YmplY3RTdHJpbmcgPSB0aGlzLnRvU3RyaW5nKCk7XG4gICAgaWYgKHR5cGVvZiBwb3NpdGlvbiAhPT0gJ251bWJlcicgfHwgIWlzRmluaXRlKHBvc2l0aW9uKSB8fCBNYXRoLmZsb29yKHBvc2l0aW9uKSAhPT0gcG9zaXRpb24gfHwgcG9zaXRpb24gPiBzdWJqZWN0U3RyaW5nLmxlbmd0aCkge1xuICAgICAgcG9zaXRpb24gPSBzdWJqZWN0U3RyaW5nLmxlbmd0aDtcbiAgICB9XG4gICAgcG9zaXRpb24gLT0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcbiAgICBsZXQgbGFzdEluZGV4ID0gc3ViamVjdFN0cmluZy5pbmRleE9mKHNlYXJjaFN0cmluZywgcG9zaXRpb24pO1xuICAgIHJldHVybiBsYXN0SW5kZXggIT09IC0xICYmIGxhc3RJbmRleCA9PT0gcG9zaXRpb247XG4gIH07XG59XG5cbmlmICghU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoIHx8IGZ1bmN0aW9uICgpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gIVwiYWJcIi5zdGFydHNXaXRoKFwiYlwiLCAxKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59KCkpIHtcbiAgU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoID0gZnVuY3Rpb24gKHNlYXJjaFN0cmluZywgcG9zaXRpb24pIHtcbiAgICBwb3NpdGlvbiA9IHBvc2l0aW9uIHx8IDA7XG4gICAgcmV0dXJuIHRoaXMuc3Vic3RyKHBvc2l0aW9uLCBzZWFyY2hTdHJpbmcubGVuZ3RoKSA9PT0gc2VhcmNoU3RyaW5nO1xuICB9O1xufVxuXG5pZiAodHlwZW9mIEZFQVRVUkVfTk9fRVMyMDE1ID09PSAndW5kZWZpbmVkJykge1xuXG4gIGlmICghQXJyYXkuZnJvbSkge1xuICAgIEFycmF5LmZyb20gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdG9JbnRlZ2VyID0gZnVuY3Rpb24gKGl0KSB7XG4gICAgICAgIHJldHVybiBpc05hTihpdCA9ICtpdCkgPyAwIDogKGl0ID4gMCA/IE1hdGguZmxvb3IgOiBNYXRoLmNlaWwpKGl0KTtcbiAgICAgIH07XG4gICAgICB2YXIgdG9MZW5ndGggPSBmdW5jdGlvbiAoaXQpIHtcbiAgICAgICAgcmV0dXJuIGl0ID4gMCA/IE1hdGgubWluKHRvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDtcbiAgICAgIH07XG4gICAgICB2YXIgaXRlckNhbGwgPSBmdW5jdGlvbiAoaXRlciwgZm4sIHZhbCwgaW5kZXgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXR1cm4gZm4odmFsLCBpbmRleCk7XG4gICAgICAgIH0gY2F0Y2ggKEUpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGl0ZXIucmV0dXJuID09ICdmdW5jdGlvbicpIGl0ZXIucmV0dXJuKCk7XG4gICAgICAgICAgdGhyb3cgRTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZyb20oYXJyYXlMaWtlKSB7XG4gICAgICAgIHZhciBPID0gT2JqZWN0KGFycmF5TGlrZSksXG4gICAgICAgICAgICBDID0gdHlwZW9mIHRoaXMgPT0gJ2Z1bmN0aW9uJyA/IHRoaXMgOiBBcnJheSxcbiAgICAgICAgICAgIGFMZW4gPSBhcmd1bWVudHMubGVuZ3RoLFxuICAgICAgICAgICAgbWFwZm4gPSBhTGVuID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIG1hcHBpbmcgPSBtYXBmbiAhPT0gdW5kZWZpbmVkLFxuICAgICAgICAgICAgaW5kZXggPSAwLFxuICAgICAgICAgICAgaXRlckZuID0gT1tTeW1ib2wuaXRlcmF0b3JdLFxuICAgICAgICAgICAgbGVuZ3RoLFxuICAgICAgICAgICAgcmVzdWx0LFxuICAgICAgICAgICAgc3RlcCxcbiAgICAgICAgICAgIGl0ZXJhdG9yO1xuICAgICAgICBpZiAobWFwcGluZykgbWFwZm4gPSBtYXBmbi5iaW5kKGFMZW4gPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkKTtcbiAgICAgICAgaWYgKGl0ZXJGbiAhPSB1bmRlZmluZWQgJiYgIUFycmF5LmlzQXJyYXkoYXJyYXlMaWtlKSkge1xuICAgICAgICAgIGZvciAoaXRlcmF0b3IgPSBpdGVyRm4uY2FsbChPKSwgcmVzdWx0ID0gbmV3IEMoKTsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOyBpbmRleCsrKSB7XG4gICAgICAgICAgICByZXN1bHRbaW5kZXhdID0gbWFwcGluZyA/IGl0ZXJDYWxsKGl0ZXJhdG9yLCBtYXBmbiwgc3RlcC52YWx1ZSwgaW5kZXgpIDogc3RlcC52YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpO1xuICAgICAgICAgIGZvciAocmVzdWx0ID0gbmV3IEMobGVuZ3RoKTsgbGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIHtcbiAgICAgICAgICAgIHJlc3VsdFtpbmRleF0gPSBtYXBwaW5nID8gbWFwZm4oT1tpbmRleF0sIGluZGV4KSA6IE9baW5kZXhdO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXN1bHQubGVuZ3RoID0gaW5kZXg7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9O1xuICAgIH0oKTtcbiAgfVxuXG4gIGlmICghQXJyYXkucHJvdG90eXBlLmZpbmQpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnZmluZCcsIHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgICAgICBpZiAodGhpcyA9PT0gbnVsbCkge1xuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FycmF5LnByb3RvdHlwZS5maW5kIGNhbGxlZCBvbiBudWxsIG9yIHVuZGVmaW5lZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgcHJlZGljYXRlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigncHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaXN0ID0gT2JqZWN0KHRoaXMpO1xuICAgICAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGggPj4+IDA7XG4gICAgICAgIHZhciB0aGlzQXJnID0gYXJndW1lbnRzWzFdO1xuICAgICAgICB2YXIgdmFsdWU7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhbHVlID0gbGlzdFtpXTtcbiAgICAgICAgICBpZiAocHJlZGljYXRlLmNhbGwodGhpc0FyZywgdmFsdWUsIGksIGxpc3QpKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBpZiAoIUFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnZmluZEluZGV4Jywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgICAgIGlmICh0aGlzID09PSBudWxsKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleCBjYWxsZWQgb24gbnVsbCBvciB1bmRlZmluZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHByZWRpY2F0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ByZWRpY2F0ZSBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGlzdCA9IE9iamVjdCh0aGlzKTtcbiAgICAgICAgdmFyIGxlbmd0aCA9IGxpc3QubGVuZ3RoID4+PiAwO1xuICAgICAgICB2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgdmFyIHZhbHVlO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YWx1ZSA9IGxpc3RbaV07XG4gICAgICAgICAgaWYgKHByZWRpY2F0ZS5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpLCBsaXN0KSkge1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5pZiAodHlwZW9mIEZFQVRVUkVfTk9fRVMyMDE2ID09PSAndW5kZWZpbmVkJyAmJiAhQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpbmNsdWRlcycsIHtcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgd3JpdGFibGU6IHRydWUsXG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIChzZWFyY2hFbGVtZW50KSB7XG4gICAgICB2YXIgTyA9IE9iamVjdCh0aGlzKTtcbiAgICAgIHZhciBsZW4gPSBwYXJzZUludChPLmxlbmd0aCkgfHwgMDtcbiAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIG4gPSBwYXJzZUludChhcmd1bWVudHNbMV0pIHx8IDA7XG4gICAgICB2YXIgaztcbiAgICAgIGlmIChuID49IDApIHtcbiAgICAgICAgayA9IG47XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBrID0gbGVuICsgbjtcbiAgICAgICAgaWYgKGsgPCAwKSB7XG4gICAgICAgICAgayA9IDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBjdXJyZW50RWxlbWVudDtcbiAgICAgIHdoaWxlIChrIDwgbGVuKSB7XG4gICAgICAgIGN1cnJlbnRFbGVtZW50ID0gT1trXTtcbiAgICAgICAgaWYgKHNlYXJjaEVsZW1lbnQgPT09IGN1cnJlbnRFbGVtZW50IHx8IHNlYXJjaEVsZW1lbnQgIT09IHNlYXJjaEVsZW1lbnQgJiYgY3VycmVudEVsZW1lbnQgIT09IGN1cnJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaysrO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSk7XG59XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19FUzIwMTUgPT09ICd1bmRlZmluZWQnKSB7XG5cbiAgKGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbmVlZHNGaXggPSBmYWxzZTtcblxuICAgIHRyeSB7XG4gICAgICBsZXQgcyA9IE9iamVjdC5rZXlzKCdhJyk7XG4gICAgICBuZWVkc0ZpeCA9IHMubGVuZ3RoICE9PSAxIHx8IHNbMF0gIT09ICcwJztcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBuZWVkc0ZpeCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKG5lZWRzRml4KSB7XG4gICAgICBPYmplY3Qua2V5cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxcbiAgICAgICAgICAgIGhhc0RvbnRFbnVtQnVnID0gIXsgdG9TdHJpbmc6IG51bGwgfS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgndG9TdHJpbmcnKSxcbiAgICAgICAgICAgIGRvbnRFbnVtcyA9IFsndG9TdHJpbmcnLCAndG9Mb2NhbGVTdHJpbmcnLCAndmFsdWVPZicsICdoYXNPd25Qcm9wZXJ0eScsICdpc1Byb3RvdHlwZU9mJywgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJywgJ2NvbnN0cnVjdG9yJ10sXG4gICAgICAgICAgICBkb250RW51bXNMZW5ndGggPSBkb250RW51bXMubGVuZ3RoO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgaWYgKG9iaiA9PT0gdW5kZWZpbmVkIHx8IG9iaiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgVHlwZUVycm9yKGBDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3RgKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBvYmogPSBPYmplY3Qob2JqKTtcblxuICAgICAgICAgIHZhciByZXN1bHQgPSBbXSxcbiAgICAgICAgICAgICAgcHJvcCxcbiAgICAgICAgICAgICAgaTtcblxuICAgICAgICAgIGZvciAocHJvcCBpbiBvYmopIHtcbiAgICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIHtcbiAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocHJvcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGhhc0RvbnRFbnVtQnVnKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZG9udEVudW1zTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqLCBkb250RW51bXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goZG9udEVudW1zW2ldKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICB9KCk7XG4gICAgfVxuICB9KSgpO1xuXG4gIChmdW5jdGlvbiAoTykge1xuICAgIGlmICgnYXNzaWduJyBpbiBPKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgTy5kZWZpbmVQcm9wZXJ0eShPLCAnYXNzaWduJywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ09QUyA9IE8uZ2V0T3duUHJvcGVydHlTeW1ib2xzLFxuICAgICAgICAgICAgcElFID0gTy5wcm9wZXJ0eUlzRW51bWVyYWJsZSxcbiAgICAgICAgICAgIGZpbHRlck9TID0gZ09QUyA/IGZ1bmN0aW9uIChzZWxmKSB7XG4gICAgICAgICAgcmV0dXJuIGdPUFMoc2VsZikuZmlsdGVyKHBJRSwgc2VsZik7XG4gICAgICAgIH0gOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gYXNzaWduKHdoZXJlKSB7XG4gICAgICAgICAgaWYgKGdPUFMgJiYgISh3aGVyZSBpbnN0YW5jZW9mIE8pKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ3Byb2JsZW1hdGljIFN5bWJvbHMnLCB3aGVyZSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gc2V0KGtleU9yU3ltYm9sKSB7XG4gICAgICAgICAgICB3aGVyZVtrZXlPclN5bWJvbF0gPSBhcmdba2V5T3JTeW1ib2xdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZvciAodmFyIGkgPSAxLCBpaSA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgICB2YXIgYXJnID0gYXJndW1lbnRzW2ldO1xuXG4gICAgICAgICAgICBpZiAoYXJnID09PSBudWxsIHx8IGFyZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBPLmtleXMoYXJnKS5jb25jYXQoZmlsdGVyT1MoYXJnKSkuZm9yRWFjaChzZXQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB3aGVyZTtcbiAgICAgICAgfTtcbiAgICAgIH0oKVxuICAgIH0pO1xuICB9KShPYmplY3QpO1xuXG4gIGlmICghT2JqZWN0LmlzKSB7XG4gICAgT2JqZWN0LmlzID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgIGlmICh4ID09PSB5KSB7XG4gICAgICAgIHJldHVybiB4ICE9PSAwIHx8IDEgLyB4ID09PSAxIC8geTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB4ICE9PSB4ICYmIHkgIT09IHk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufVxuXG5pZiAodHlwZW9mIEZFQVRVUkVfTk9fRVMyMDE1ID09PSAndW5kZWZpbmVkJykge1xuXG4gIChmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgdmFyIGk7XG5cbiAgICB2YXIgZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gICAgICAgIGlzID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHJldHVybiBhID09PSBiIHx8IGEgIT09IGEgJiYgYiAhPT0gYjtcbiAgICB9O1xuXG4gICAgaWYgKHR5cGVvZiBXZWFrTWFwID09ICd1bmRlZmluZWQnKSB7XG4gICAgICBnbG9iYWwuV2Vha01hcCA9IGNyZWF0ZUNvbGxlY3Rpb24oe1xuICAgICAgICAnZGVsZXRlJzogc2hhcmVkRGVsZXRlLFxuXG4gICAgICAgIGNsZWFyOiBzaGFyZWRDbGVhcixcblxuICAgICAgICBnZXQ6IHNoYXJlZEdldCxcblxuICAgICAgICBoYXM6IG1hcEhhcyxcblxuICAgICAgICBzZXQ6IHNoYXJlZFNldFxuICAgICAgfSwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBNYXAgPT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIG5ldyBNYXAoKS52YWx1ZXMgIT09ICdmdW5jdGlvbicgfHwgIW5ldyBNYXAoKS52YWx1ZXMoKS5uZXh0KSB7XG4gICAgICBnbG9iYWwuTWFwID0gY3JlYXRlQ29sbGVjdGlvbih7XG4gICAgICAgICdkZWxldGUnOiBzaGFyZWREZWxldGUsXG5cbiAgICAgICAgaGFzOiBtYXBIYXMsXG5cbiAgICAgICAgZ2V0OiBzaGFyZWRHZXQsXG5cbiAgICAgICAgc2V0OiBzaGFyZWRTZXQsXG5cbiAgICAgICAga2V5czogc2hhcmVkS2V5cyxcblxuICAgICAgICB2YWx1ZXM6IHNoYXJlZFZhbHVlcyxcblxuICAgICAgICBlbnRyaWVzOiBtYXBFbnRyaWVzLFxuXG4gICAgICAgIGZvckVhY2g6IHNoYXJlZEZvckVhY2gsXG5cbiAgICAgICAgY2xlYXI6IHNoYXJlZENsZWFyLFxuXG4gICAgICAgIFtTeW1ib2wuaXRlcmF0b3JdOiBtYXBFbnRyaWVzXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIFNldCA9PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgbmV3IFNldCgpLnZhbHVlcyAhPT0gJ2Z1bmN0aW9uJyB8fCAhbmV3IFNldCgpLnZhbHVlcygpLm5leHQpIHtcbiAgICAgIGdsb2JhbC5TZXQgPSBjcmVhdGVDb2xsZWN0aW9uKHtcbiAgICAgICAgaGFzOiBzZXRIYXMsXG5cbiAgICAgICAgYWRkOiBzaGFyZWRBZGQsXG5cbiAgICAgICAgJ2RlbGV0ZSc6IHNoYXJlZERlbGV0ZSxcblxuICAgICAgICBjbGVhcjogc2hhcmVkQ2xlYXIsXG5cbiAgICAgICAga2V5czogc2hhcmVkVmFsdWVzLFxuICAgICAgICB2YWx1ZXM6IHNoYXJlZFZhbHVlcyxcblxuICAgICAgICBlbnRyaWVzOiBzZXRFbnRyaWVzLFxuXG4gICAgICAgIGZvckVhY2g6IHNoYXJlZEZvckVhY2gsXG5cbiAgICAgICAgW1N5bWJvbC5pdGVyYXRvcl06IHNoYXJlZFZhbHVlc1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBXZWFrU2V0ID09ICd1bmRlZmluZWQnKSB7XG4gICAgICBnbG9iYWwuV2Vha1NldCA9IGNyZWF0ZUNvbGxlY3Rpb24oe1xuICAgICAgICAnZGVsZXRlJzogc2hhcmVkRGVsZXRlLFxuXG4gICAgICAgIGFkZDogc2hhcmVkQWRkLFxuXG4gICAgICAgIGNsZWFyOiBzaGFyZWRDbGVhcixcblxuICAgICAgICBoYXM6IHNldEhhc1xuICAgICAgfSwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlQ29sbGVjdGlvbihwcm90bywgb2JqZWN0T25seSkge1xuICAgICAgZnVuY3Rpb24gQ29sbGVjdGlvbihhKSB7XG4gICAgICAgIGlmICghdGhpcyB8fCB0aGlzLmNvbnN0cnVjdG9yICE9PSBDb2xsZWN0aW9uKSByZXR1cm4gbmV3IENvbGxlY3Rpb24oYSk7XG4gICAgICAgIHRoaXMuX2tleXMgPSBbXTtcbiAgICAgICAgdGhpcy5fdmFsdWVzID0gW107XG4gICAgICAgIHRoaXMuX2l0cCA9IFtdO1xuICAgICAgICB0aGlzLm9iamVjdE9ubHkgPSBvYmplY3RPbmx5O1xuXG4gICAgICAgIGlmIChhKSBpbml0LmNhbGwodGhpcywgYSk7XG4gICAgICB9XG5cbiAgICAgIGlmICghb2JqZWN0T25seSkge1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eShwcm90bywgJ3NpemUnLCB7XG4gICAgICAgICAgZ2V0OiBzaGFyZWRTaXplXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBwcm90by5jb25zdHJ1Y3RvciA9IENvbGxlY3Rpb247XG4gICAgICBDb2xsZWN0aW9uLnByb3RvdHlwZSA9IHByb3RvO1xuXG4gICAgICByZXR1cm4gQ29sbGVjdGlvbjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0KGEpIHtcbiAgICAgIHZhciBpO1xuXG4gICAgICBpZiAodGhpcy5hZGQpIGEuZm9yRWFjaCh0aGlzLmFkZCwgdGhpcyk7ZWxzZSBhLmZvckVhY2goZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICB0aGlzLnNldChhWzBdLCBhWzFdKTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hhcmVkRGVsZXRlKGtleSkge1xuICAgICAgaWYgKHRoaXMuaGFzKGtleSkpIHtcbiAgICAgICAgdGhpcy5fa2V5cy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIHRoaXMuX3ZhbHVlcy5zcGxpY2UoaSwgMSk7XG5cbiAgICAgICAgdGhpcy5faXRwLmZvckVhY2goZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICBpZiAoaSA8IHBbMF0pIHBbMF0tLTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAtMSA8IGk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHNoYXJlZEdldChrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLmhhcyhrZXkpID8gdGhpcy5fdmFsdWVzW2ldIDogdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhhcyhsaXN0LCBrZXkpIHtcbiAgICAgIGlmICh0aGlzLm9iamVjdE9ubHkgJiYga2V5ICE9PSBPYmplY3Qoa2V5KSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgdmFsdWUgdXNlZCBhcyB3ZWFrIGNvbGxlY3Rpb24ga2V5XCIpO1xuXG4gICAgICBpZiAoa2V5ICE9IGtleSB8fCBrZXkgPT09IDApIGZvciAoaSA9IGxpc3QubGVuZ3RoOyBpLS0gJiYgIWlzKGxpc3RbaV0sIGtleSk7KSB7fSBlbHNlIGkgPSBsaXN0LmluZGV4T2Yoa2V5KTtcbiAgICAgIHJldHVybiAtMSA8IGk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0SGFzKHZhbHVlKSB7XG4gICAgICByZXR1cm4gaGFzLmNhbGwodGhpcywgdGhpcy5fdmFsdWVzLCB2YWx1ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFwSGFzKHZhbHVlKSB7XG4gICAgICByZXR1cm4gaGFzLmNhbGwodGhpcywgdGhpcy5fa2V5cywgdmFsdWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNoYXJlZFNldChrZXksIHZhbHVlKSB7XG4gICAgICB0aGlzLmhhcyhrZXkpID8gdGhpcy5fdmFsdWVzW2ldID0gdmFsdWUgOiB0aGlzLl92YWx1ZXNbdGhpcy5fa2V5cy5wdXNoKGtleSkgLSAxXSA9IHZhbHVlO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hhcmVkQWRkKHZhbHVlKSB7XG4gICAgICBpZiAoIXRoaXMuaGFzKHZhbHVlKSkgdGhpcy5fdmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hhcmVkQ2xlYXIoKSB7XG4gICAgICAodGhpcy5fa2V5cyB8fCAwKS5sZW5ndGggPSB0aGlzLl92YWx1ZXMubGVuZ3RoID0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzaGFyZWRLZXlzKCkge1xuICAgICAgcmV0dXJuIHNoYXJlZEl0ZXJhdG9yKHRoaXMuX2l0cCwgdGhpcy5fa2V5cyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hhcmVkVmFsdWVzKCkge1xuICAgICAgcmV0dXJuIHNoYXJlZEl0ZXJhdG9yKHRoaXMuX2l0cCwgdGhpcy5fdmFsdWVzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYXBFbnRyaWVzKCkge1xuICAgICAgcmV0dXJuIHNoYXJlZEl0ZXJhdG9yKHRoaXMuX2l0cCwgdGhpcy5fa2V5cywgdGhpcy5fdmFsdWVzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRFbnRyaWVzKCkge1xuICAgICAgcmV0dXJuIHNoYXJlZEl0ZXJhdG9yKHRoaXMuX2l0cCwgdGhpcy5fdmFsdWVzLCB0aGlzLl92YWx1ZXMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNoYXJlZEl0ZXJhdG9yKGl0cCwgYXJyYXksIGFycmF5Mikge1xuICAgICAgdmFyIHAgPSBbMF0sXG4gICAgICAgICAgZG9uZSA9IGZhbHNlO1xuICAgICAgaXRwLnB1c2gocCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBbU3ltYm9sLml0ZXJhdG9yXTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHYsXG4gICAgICAgICAgICAgIGsgPSBwWzBdO1xuICAgICAgICAgIGlmICghZG9uZSAmJiBrIDwgYXJyYXkubGVuZ3RoKSB7XG4gICAgICAgICAgICB2ID0gYXJyYXkyID8gW2FycmF5W2tdLCBhcnJheTJba11dIDogYXJyYXlba107XG4gICAgICAgICAgICBwWzBdKys7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICAgICAgaXRwLnNwbGljZShpdHAuaW5kZXhPZihwKSwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB7IGRvbmU6IGRvbmUsIHZhbHVlOiB2IH07XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hhcmVkU2l6ZSgpIHtcbiAgICAgIHJldHVybiB0aGlzLl92YWx1ZXMubGVuZ3RoO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNoYXJlZEZvckVhY2goY2FsbGJhY2ssIGNvbnRleHQpIHtcbiAgICAgIHZhciBpdCA9IHRoaXMuZW50cmllcygpO1xuICAgICAgZm9yICg7Oykge1xuICAgICAgICB2YXIgciA9IGl0Lm5leHQoKTtcbiAgICAgICAgaWYgKHIuZG9uZSkgYnJlYWs7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwoY29udGV4dCwgci52YWx1ZVsxXSwgci52YWx1ZVswXSwgdGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9KShQTEFURk9STS5nbG9iYWwpO1xufVxuXG5pZiAodHlwZW9mIEZFQVRVUkVfTk9fRVMyMDE1ID09PSAndW5kZWZpbmVkJykge1xuXG4gIGNvbnN0IGJpbmQgPSBGdW5jdGlvbi5wcm90b3R5cGUuYmluZDtcblxuICBpZiAodHlwZW9mIFBMQVRGT1JNLmdsb2JhbC5SZWZsZWN0ID09PSAndW5kZWZpbmVkJykge1xuICAgIFBMQVRGT1JNLmdsb2JhbC5SZWZsZWN0ID0ge307XG4gIH1cblxuICBpZiAodHlwZW9mIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkgIT09ICdmdW5jdGlvbicpIHtcbiAgICBSZWZsZWN0LmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gKHRhcmdldCwgcHJvcGVydHlLZXksIGRlc2NyaXB0b3IpIHtcbiAgICAgIGlmICh0eXBlb2YgdGFyZ2V0ID09PSAnb2JqZWN0JyA/IHRhcmdldCA9PT0gbnVsbCA6IHR5cGVvZiB0YXJnZXQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSBjYWxsZWQgb24gbm9uLW9iamVjdCcpO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHlLZXksIGRlc2NyaXB0b3IpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBpZiAodHlwZW9mIFJlZmxlY3QuY29uc3RydWN0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgUmVmbGVjdC5jb25zdHJ1Y3QgPSBmdW5jdGlvbiAoVGFyZ2V0LCBhcmdzKSB7XG4gICAgICBpZiAoYXJncykge1xuICAgICAgICBzd2l0Y2ggKGFyZ3MubGVuZ3RoKSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUYXJnZXQoKTtcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRhcmdldChhcmdzWzBdKTtcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRhcmdldChhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRhcmdldChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTtcbiAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRhcmdldChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgYSA9IFtudWxsXTtcbiAgICAgIGEucHVzaC5hcHBseShhLCBhcmdzKTtcbiAgICAgIHJldHVybiBuZXcgKGJpbmQuYXBwbHkoVGFyZ2V0LCBhKSkoKTtcbiAgICB9O1xuICB9XG5cbiAgaWYgKHR5cGVvZiBSZWZsZWN0Lm93bktleXMgIT09ICdmdW5jdGlvbicpIHtcbiAgICBSZWZsZWN0Lm93bktleXMgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG8pLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG8pKTtcbiAgICB9O1xuICB9XG59XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19FU05FWFQgPT09ICd1bmRlZmluZWQnKSB7XG5cbiAgY29uc3QgZW1wdHlNZXRhZGF0YSA9IE9iamVjdC5mcmVlemUoe30pO1xuICBjb25zdCBtZXRhZGF0YUNvbnRhaW5lcktleSA9ICdfX21ldGFkYXRhX18nO1xuXG4gIGlmICh0eXBlb2YgUmVmbGVjdC5nZXRPd25NZXRhZGF0YSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIFJlZmxlY3QuZ2V0T3duTWV0YWRhdGEgPSBmdW5jdGlvbiAobWV0YWRhdGFLZXksIHRhcmdldCwgdGFyZ2V0S2V5KSB7XG4gICAgICBpZiAodGFyZ2V0Lmhhc093blByb3BlcnR5KG1ldGFkYXRhQ29udGFpbmVyS2V5KSkge1xuICAgICAgICByZXR1cm4gKHRhcmdldFttZXRhZGF0YUNvbnRhaW5lcktleV1bdGFyZ2V0S2V5XSB8fCBlbXB0eU1ldGFkYXRhKVttZXRhZGF0YUtleV07XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgUmVmbGVjdC5kZWZpbmVNZXRhZGF0YSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIFJlZmxlY3QuZGVmaW5lTWV0YWRhdGEgPSBmdW5jdGlvbiAobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUsIHRhcmdldCwgdGFyZ2V0S2V5KSB7XG4gICAgICBsZXQgbWV0YWRhdGFDb250YWluZXIgPSB0YXJnZXQuaGFzT3duUHJvcGVydHkobWV0YWRhdGFDb250YWluZXJLZXkpID8gdGFyZ2V0W21ldGFkYXRhQ29udGFpbmVyS2V5XSA6IHRhcmdldFttZXRhZGF0YUNvbnRhaW5lcktleV0gPSB7fTtcbiAgICAgIGxldCB0YXJnZXRDb250YWluZXIgPSBtZXRhZGF0YUNvbnRhaW5lclt0YXJnZXRLZXldIHx8IChtZXRhZGF0YUNvbnRhaW5lclt0YXJnZXRLZXldID0ge30pO1xuICAgICAgdGFyZ2V0Q29udGFpbmVyW21ldGFkYXRhS2V5XSA9IG1ldGFkYXRhVmFsdWU7XG4gICAgfTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIFJlZmxlY3QubWV0YWRhdGEgPSBmdW5jdGlvbiAobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCB0YXJnZXRLZXkpIHtcbiAgICAgICAgUmVmbGVjdC5kZWZpbmVNZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSwgdGFyZ2V0LCB0YXJnZXRLZXkpO1xuICAgICAgfTtcbiAgICB9O1xuICB9XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/aurelia-polyfills/dist/es2015/aurelia-polyfills.js\n");

/***/ }),

/***/ "./node_modules/aurelia-route-recognizer/dist/es2015/aurelia-route-recognizer.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/aurelia-route-recognizer/dist/es2015/aurelia-route-recognizer.js ***!
  \***************************************************************************************/
/*! exports provided: State, StaticSegment, DynamicSegment, StarSegment, EpsilonSegment, RouteRecognizer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"State\", function() { return State; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StaticSegment\", function() { return StaticSegment; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DynamicSegment\", function() { return DynamicSegment; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StarSegment\", function() { return StarSegment; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EpsilonSegment\", function() { return EpsilonSegment; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouteRecognizer\", function() { return RouteRecognizer; });\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-path */ \"./node_modules/aurelia-path/dist/es2015/aurelia-path.js\");\n\n\nlet State = class State {\n  constructor(charSpec) {\n    this.charSpec = charSpec;\n    this.nextStates = [];\n  }\n\n  get(charSpec) {\n    for (let child of this.nextStates) {\n      let isEqual = child.charSpec.validChars === charSpec.validChars && child.charSpec.invalidChars === charSpec.invalidChars;\n\n      if (isEqual) {\n        return child;\n      }\n    }\n\n    return undefined;\n  }\n\n  put(charSpec) {\n    let state = this.get(charSpec);\n\n    if (state) {\n      return state;\n    }\n\n    state = new State(charSpec);\n\n    this.nextStates.push(state);\n\n    if (charSpec.repeat) {\n      state.nextStates.push(state);\n    }\n\n    return state;\n  }\n\n  match(ch) {\n    let nextStates = this.nextStates;\n    let results = [];\n\n    for (let i = 0, l = nextStates.length; i < l; i++) {\n      let child = nextStates[i];\n      let charSpec = child.charSpec;\n\n      if (charSpec.validChars !== undefined) {\n        if (charSpec.validChars.indexOf(ch) !== -1) {\n          results.push(child);\n        }\n      } else if (charSpec.invalidChars !== undefined) {\n        if (charSpec.invalidChars.indexOf(ch) === -1) {\n          results.push(child);\n        }\n      }\n    }\n\n    return results;\n  }\n};\n\nconst specials = ['/', '.', '*', '+', '?', '|', '(', ')', '[', ']', '{', '}', '\\\\'];\n\nconst escapeRegex = new RegExp('(\\\\' + specials.join('|\\\\') + ')', 'g');\n\nlet StaticSegment = class StaticSegment {\n  constructor(string, caseSensitive) {\n    this.string = string;\n    this.caseSensitive = caseSensitive;\n  }\n\n  eachChar(callback) {\n    let s = this.string;\n    for (let i = 0, ii = s.length; i < ii; ++i) {\n      let ch = s[i];\n      callback({ validChars: this.caseSensitive ? ch : ch.toUpperCase() + ch.toLowerCase() });\n    }\n  }\n\n  regex() {\n    return this.string.replace(escapeRegex, '\\\\$1');\n  }\n\n  generate() {\n    return this.string;\n  }\n};\n\nlet DynamicSegment = class DynamicSegment {\n  constructor(name, optional) {\n    this.name = name;\n    this.optional = optional;\n  }\n\n  eachChar(callback) {\n    callback({ invalidChars: '/', repeat: true });\n  }\n\n  regex() {\n    return '([^/]+)';\n  }\n\n  generate(params, consumed) {\n    consumed[this.name] = true;\n    return params[this.name];\n  }\n};\n\nlet StarSegment = class StarSegment {\n  constructor(name) {\n    this.name = name;\n  }\n\n  eachChar(callback) {\n    callback({ invalidChars: '', repeat: true });\n  }\n\n  regex() {\n    return '(.+)';\n  }\n\n  generate(params, consumed) {\n    consumed[this.name] = true;\n    return params[this.name];\n  }\n};\n\nlet EpsilonSegment = class EpsilonSegment {\n  eachChar() {}\n\n  regex() {\n    return '';\n  }\n\n  generate() {\n    return '';\n  }\n};\n\nlet RouteRecognizer = class RouteRecognizer {\n  constructor() {\n    this.rootState = new State();\n    this.names = {};\n    this.routes = new Map();\n  }\n\n  add(route) {\n    if (Array.isArray(route)) {\n      route.forEach(r => this.add(r));\n      return undefined;\n    }\n\n    let currentState = this.rootState;\n    let skippableStates = [];\n    let regex = '^';\n    let types = { statics: 0, dynamics: 0, stars: 0 };\n    let names = [];\n    let routeName = route.handler.name;\n    let isEmpty = true;\n    let segments = parse(route.path, names, types, route.caseSensitive);\n\n    for (let i = 0, ii = segments.length; i < ii; i++) {\n      let segment = segments[i];\n      if (segment instanceof EpsilonSegment) {\n        continue;\n      }\n\n      let [firstState, nextState] = addSegment(currentState, segment);\n\n      for (let j = 0, jj = skippableStates.length; j < jj; j++) {\n        skippableStates[j].nextStates.push(firstState);\n      }\n\n      if (segment.optional) {\n        skippableStates.push(nextState);\n        regex += `(?:/${segment.regex()})?`;\n      } else {\n        currentState = nextState;\n        regex += `/${segment.regex()}`;\n        skippableStates.length = 0;\n        isEmpty = false;\n      }\n    }\n\n    if (isEmpty) {\n      currentState = currentState.put({ validChars: '/' });\n      regex += '/?';\n    }\n\n    let handlers = [{ handler: route.handler, names: names }];\n\n    this.routes.set(route.handler, { segments, handlers });\n    if (routeName) {\n      let routeNames = Array.isArray(routeName) ? routeName : [routeName];\n      for (let i = 0; i < routeNames.length; i++) {\n        if (!(routeNames[i] in this.names)) {\n          this.names[routeNames[i]] = { segments, handlers };\n        }\n      }\n    }\n\n    for (let i = 0; i < skippableStates.length; i++) {\n      let state = skippableStates[i];\n      state.handlers = handlers;\n      state.regex = new RegExp(regex + '$', route.caseSensitive ? '' : 'i');\n      state.types = types;\n    }\n\n    currentState.handlers = handlers;\n    currentState.regex = new RegExp(regex + '$', route.caseSensitive ? '' : 'i');\n    currentState.types = types;\n\n    return currentState;\n  }\n\n  getRoute(nameOrRoute) {\n    return typeof nameOrRoute === 'string' ? this.names[nameOrRoute] : this.routes.get(nameOrRoute);\n  }\n\n  handlersFor(nameOrRoute) {\n    let route = this.getRoute(nameOrRoute);\n    if (!route) {\n      throw new Error(`There is no route named ${nameOrRoute}`);\n    }\n\n    return [...route.handlers];\n  }\n\n  hasRoute(nameOrRoute) {\n    return !!this.getRoute(nameOrRoute);\n  }\n\n  generate(nameOrRoute, params) {\n    let route = this.getRoute(nameOrRoute);\n    if (!route) {\n      throw new Error(`There is no route named ${nameOrRoute}`);\n    }\n\n    let handler = route.handlers[0].handler;\n    if (handler.generationUsesHref) {\n      return handler.href;\n    }\n\n    let routeParams = Object.assign({}, params);\n    let segments = route.segments;\n    let consumed = {};\n    let output = '';\n\n    for (let i = 0, l = segments.length; i < l; i++) {\n      let segment = segments[i];\n\n      if (segment instanceof EpsilonSegment) {\n        continue;\n      }\n\n      let segmentValue = segment.generate(routeParams, consumed);\n      if (segmentValue === null || segmentValue === undefined) {\n        if (!segment.optional) {\n          throw new Error(`A value is required for route parameter '${segment.name}' in route '${nameOrRoute}'.`);\n        }\n      } else {\n        output += '/';\n        output += segmentValue;\n      }\n    }\n\n    if (output.charAt(0) !== '/') {\n      output = '/' + output;\n    }\n\n    for (let param in consumed) {\n      delete routeParams[param];\n    }\n\n    let queryString = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_0__[\"buildQueryString\"])(routeParams);\n    output += queryString ? `?${queryString}` : '';\n\n    return output;\n  }\n\n  recognize(path) {\n    let states = [this.rootState];\n    let queryParams = {};\n    let isSlashDropped = false;\n    let normalizedPath = path;\n\n    let queryStart = normalizedPath.indexOf('?');\n    if (queryStart !== -1) {\n      let queryString = normalizedPath.substr(queryStart + 1, normalizedPath.length);\n      normalizedPath = normalizedPath.substr(0, queryStart);\n      queryParams = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_0__[\"parseQueryString\"])(queryString);\n    }\n\n    normalizedPath = decodeURI(normalizedPath);\n\n    if (normalizedPath.charAt(0) !== '/') {\n      normalizedPath = '/' + normalizedPath;\n    }\n\n    let pathLen = normalizedPath.length;\n    if (pathLen > 1 && normalizedPath.charAt(pathLen - 1) === '/') {\n      normalizedPath = normalizedPath.substr(0, pathLen - 1);\n      isSlashDropped = true;\n    }\n\n    for (let i = 0, l = normalizedPath.length; i < l; i++) {\n      states = recognizeChar(states, normalizedPath.charAt(i));\n      if (!states.length) {\n        break;\n      }\n    }\n\n    let solutions = [];\n    for (let i = 0, l = states.length; i < l; i++) {\n      if (states[i].handlers) {\n        solutions.push(states[i]);\n      }\n    }\n\n    states = sortSolutions(solutions);\n\n    let state = solutions[0];\n    if (state && state.handlers) {\n      if (isSlashDropped && state.regex.source.slice(-5) === '(.+)$') {\n        normalizedPath = normalizedPath + '/';\n      }\n\n      return findHandler(state, normalizedPath, queryParams);\n    }\n  }\n};\n\nlet RecognizeResults = class RecognizeResults {\n  constructor(queryParams) {\n    this.splice = Array.prototype.splice;\n    this.slice = Array.prototype.slice;\n    this.push = Array.prototype.push;\n    this.length = 0;\n    this.queryParams = queryParams || {};\n  }\n};\n\n\nfunction parse(route, names, types, caseSensitive) {\n  let normalizedRoute = route;\n  if (route.charAt(0) === '/') {\n    normalizedRoute = route.substr(1);\n  }\n\n  let results = [];\n\n  let splitRoute = normalizedRoute.split('/');\n  for (let i = 0, ii = splitRoute.length; i < ii; ++i) {\n    let segment = splitRoute[i];\n\n    let match = segment.match(/^:([^?]+)(\\?)?$/);\n    if (match) {\n      let [, name, optional] = match;\n      if (name.indexOf('=') !== -1) {\n        throw new Error(`Parameter ${name} in route ${route} has a default value, which is not supported.`);\n      }\n      results.push(new DynamicSegment(name, !!optional));\n      names.push(name);\n      types.dynamics++;\n      continue;\n    }\n\n    match = segment.match(/^\\*(.+)$/);\n    if (match) {\n      results.push(new StarSegment(match[1]));\n      names.push(match[1]);\n      types.stars++;\n    } else if (segment === '') {\n      results.push(new EpsilonSegment());\n    } else {\n      results.push(new StaticSegment(segment, caseSensitive));\n      types.statics++;\n    }\n  }\n\n  return results;\n}\n\nfunction sortSolutions(states) {\n  return states.sort((a, b) => {\n    if (a.types.stars !== b.types.stars) {\n      return a.types.stars - b.types.stars;\n    }\n\n    if (a.types.stars) {\n      if (a.types.statics !== b.types.statics) {\n        return b.types.statics - a.types.statics;\n      }\n      if (a.types.dynamics !== b.types.dynamics) {\n        return b.types.dynamics - a.types.dynamics;\n      }\n    }\n\n    if (a.types.dynamics !== b.types.dynamics) {\n      return a.types.dynamics - b.types.dynamics;\n    }\n\n    if (a.types.statics !== b.types.statics) {\n      return b.types.statics - a.types.statics;\n    }\n\n    return 0;\n  });\n}\n\nfunction recognizeChar(states, ch) {\n  let nextStates = [];\n\n  for (let i = 0, l = states.length; i < l; i++) {\n    let state = states[i];\n    nextStates.push(...state.match(ch));\n  }\n\n  return nextStates;\n}\n\nfunction findHandler(state, path, queryParams) {\n  let handlers = state.handlers;\n  let regex = state.regex;\n  let captures = path.match(regex);\n  let currentCapture = 1;\n  let result = new RecognizeResults(queryParams);\n\n  for (let i = 0, l = handlers.length; i < l; i++) {\n    let handler = handlers[i];\n    let names = handler.names;\n    let params = {};\n\n    for (let j = 0, m = names.length; j < m; j++) {\n      params[names[j]] = captures[currentCapture++];\n    }\n\n    result.push({ handler: handler.handler, params: params, isDynamic: !!names.length });\n  }\n\n  return result;\n}\n\nfunction addSegment(currentState, segment) {\n  let firstState = currentState.put({ validChars: '/' });\n  let nextState = firstState;\n  segment.eachChar(ch => {\n    nextState = nextState.put(ch);\n  });\n\n  return [firstState, nextState];\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1yb3V0ZS1yZWNvZ25pemVyL2Rpc3QvZXMyMDE1L2F1cmVsaWEtcm91dGUtcmVjb2duaXplci5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXJvdXRlLXJlY29nbml6ZXIvZGlzdC9lczIwMTUvYXVyZWxpYS1yb3V0ZS1yZWNvZ25pemVyLmpzPzAwNTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYnVpbGRRdWVyeVN0cmluZywgcGFyc2VRdWVyeVN0cmluZyB9IGZyb20gJ2F1cmVsaWEtcGF0aCc7XG5cbmV4cG9ydCBsZXQgU3RhdGUgPSBjbGFzcyBTdGF0ZSB7XG4gIGNvbnN0cnVjdG9yKGNoYXJTcGVjKSB7XG4gICAgdGhpcy5jaGFyU3BlYyA9IGNoYXJTcGVjO1xuICAgIHRoaXMubmV4dFN0YXRlcyA9IFtdO1xuICB9XG5cbiAgZ2V0KGNoYXJTcGVjKSB7XG4gICAgZm9yIChsZXQgY2hpbGQgb2YgdGhpcy5uZXh0U3RhdGVzKSB7XG4gICAgICBsZXQgaXNFcXVhbCA9IGNoaWxkLmNoYXJTcGVjLnZhbGlkQ2hhcnMgPT09IGNoYXJTcGVjLnZhbGlkQ2hhcnMgJiYgY2hpbGQuY2hhclNwZWMuaW52YWxpZENoYXJzID09PSBjaGFyU3BlYy5pbnZhbGlkQ2hhcnM7XG5cbiAgICAgIGlmIChpc0VxdWFsKSB7XG4gICAgICAgIHJldHVybiBjaGlsZDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgcHV0KGNoYXJTcGVjKSB7XG4gICAgbGV0IHN0YXRlID0gdGhpcy5nZXQoY2hhclNwZWMpO1xuXG4gICAgaWYgKHN0YXRlKSB7XG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxuXG4gICAgc3RhdGUgPSBuZXcgU3RhdGUoY2hhclNwZWMpO1xuXG4gICAgdGhpcy5uZXh0U3RhdGVzLnB1c2goc3RhdGUpO1xuXG4gICAgaWYgKGNoYXJTcGVjLnJlcGVhdCkge1xuICAgICAgc3RhdGUubmV4dFN0YXRlcy5wdXNoKHN0YXRlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICBtYXRjaChjaCkge1xuICAgIGxldCBuZXh0U3RhdGVzID0gdGhpcy5uZXh0U3RhdGVzO1xuICAgIGxldCByZXN1bHRzID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMCwgbCA9IG5leHRTdGF0ZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICBsZXQgY2hpbGQgPSBuZXh0U3RhdGVzW2ldO1xuICAgICAgbGV0IGNoYXJTcGVjID0gY2hpbGQuY2hhclNwZWM7XG5cbiAgICAgIGlmIChjaGFyU3BlYy52YWxpZENoYXJzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKGNoYXJTcGVjLnZhbGlkQ2hhcnMuaW5kZXhPZihjaCkgIT09IC0xKSB7XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKGNoaWxkKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjaGFyU3BlYy5pbnZhbGlkQ2hhcnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoY2hhclNwZWMuaW52YWxpZENoYXJzLmluZGV4T2YoY2gpID09PSAtMSkge1xuICAgICAgICAgIHJlc3VsdHMucHVzaChjaGlsZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfVxufTtcblxuY29uc3Qgc3BlY2lhbHMgPSBbJy8nLCAnLicsICcqJywgJysnLCAnPycsICd8JywgJygnLCAnKScsICdbJywgJ10nLCAneycsICd9JywgJ1xcXFwnXTtcblxuY29uc3QgZXNjYXBlUmVnZXggPSBuZXcgUmVnRXhwKCcoXFxcXCcgKyBzcGVjaWFscy5qb2luKCd8XFxcXCcpICsgJyknLCAnZycpO1xuXG5leHBvcnQgbGV0IFN0YXRpY1NlZ21lbnQgPSBjbGFzcyBTdGF0aWNTZWdtZW50IHtcbiAgY29uc3RydWN0b3Ioc3RyaW5nLCBjYXNlU2Vuc2l0aXZlKSB7XG4gICAgdGhpcy5zdHJpbmcgPSBzdHJpbmc7XG4gICAgdGhpcy5jYXNlU2Vuc2l0aXZlID0gY2FzZVNlbnNpdGl2ZTtcbiAgfVxuXG4gIGVhY2hDaGFyKGNhbGxiYWNrKSB7XG4gICAgbGV0IHMgPSB0aGlzLnN0cmluZztcbiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGxldCBjaCA9IHNbaV07XG4gICAgICBjYWxsYmFjayh7IHZhbGlkQ2hhcnM6IHRoaXMuY2FzZVNlbnNpdGl2ZSA/IGNoIDogY2gudG9VcHBlckNhc2UoKSArIGNoLnRvTG93ZXJDYXNlKCkgfSk7XG4gICAgfVxuICB9XG5cbiAgcmVnZXgoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaW5nLnJlcGxhY2UoZXNjYXBlUmVnZXgsICdcXFxcJDEnKTtcbiAgfVxuXG4gIGdlbmVyYXRlKCkge1xuICAgIHJldHVybiB0aGlzLnN0cmluZztcbiAgfVxufTtcblxuZXhwb3J0IGxldCBEeW5hbWljU2VnbWVudCA9IGNsYXNzIER5bmFtaWNTZWdtZW50IHtcbiAgY29uc3RydWN0b3IobmFtZSwgb3B0aW9uYWwpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMub3B0aW9uYWwgPSBvcHRpb25hbDtcbiAgfVxuXG4gIGVhY2hDaGFyKGNhbGxiYWNrKSB7XG4gICAgY2FsbGJhY2soeyBpbnZhbGlkQ2hhcnM6ICcvJywgcmVwZWF0OiB0cnVlIH0pO1xuICB9XG5cbiAgcmVnZXgoKSB7XG4gICAgcmV0dXJuICcoW14vXSspJztcbiAgfVxuXG4gIGdlbmVyYXRlKHBhcmFtcywgY29uc3VtZWQpIHtcbiAgICBjb25zdW1lZFt0aGlzLm5hbWVdID0gdHJ1ZTtcbiAgICByZXR1cm4gcGFyYW1zW3RoaXMubmFtZV07XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgU3RhclNlZ21lbnQgPSBjbGFzcyBTdGFyU2VnbWVudCB7XG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG5cbiAgZWFjaENoYXIoY2FsbGJhY2spIHtcbiAgICBjYWxsYmFjayh7IGludmFsaWRDaGFyczogJycsIHJlcGVhdDogdHJ1ZSB9KTtcbiAgfVxuXG4gIHJlZ2V4KCkge1xuICAgIHJldHVybiAnKC4rKSc7XG4gIH1cblxuICBnZW5lcmF0ZShwYXJhbXMsIGNvbnN1bWVkKSB7XG4gICAgY29uc3VtZWRbdGhpcy5uYW1lXSA9IHRydWU7XG4gICAgcmV0dXJuIHBhcmFtc1t0aGlzLm5hbWVdO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IEVwc2lsb25TZWdtZW50ID0gY2xhc3MgRXBzaWxvblNlZ21lbnQge1xuICBlYWNoQ2hhcigpIHt9XG5cbiAgcmVnZXgoKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgZ2VuZXJhdGUoKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IFJvdXRlUmVjb2duaXplciA9IGNsYXNzIFJvdXRlUmVjb2duaXplciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMucm9vdFN0YXRlID0gbmV3IFN0YXRlKCk7XG4gICAgdGhpcy5uYW1lcyA9IHt9O1xuICAgIHRoaXMucm91dGVzID0gbmV3IE1hcCgpO1xuICB9XG5cbiAgYWRkKHJvdXRlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkocm91dGUpKSB7XG4gICAgICByb3V0ZS5mb3JFYWNoKHIgPT4gdGhpcy5hZGQocikpO1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBsZXQgY3VycmVudFN0YXRlID0gdGhpcy5yb290U3RhdGU7XG4gICAgbGV0IHNraXBwYWJsZVN0YXRlcyA9IFtdO1xuICAgIGxldCByZWdleCA9ICdeJztcbiAgICBsZXQgdHlwZXMgPSB7IHN0YXRpY3M6IDAsIGR5bmFtaWNzOiAwLCBzdGFyczogMCB9O1xuICAgIGxldCBuYW1lcyA9IFtdO1xuICAgIGxldCByb3V0ZU5hbWUgPSByb3V0ZS5oYW5kbGVyLm5hbWU7XG4gICAgbGV0IGlzRW1wdHkgPSB0cnVlO1xuICAgIGxldCBzZWdtZW50cyA9IHBhcnNlKHJvdXRlLnBhdGgsIG5hbWVzLCB0eXBlcywgcm91dGUuY2FzZVNlbnNpdGl2ZSk7XG5cbiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBzZWdtZW50cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICBsZXQgc2VnbWVudCA9IHNlZ21lbnRzW2ldO1xuICAgICAgaWYgKHNlZ21lbnQgaW5zdGFuY2VvZiBFcHNpbG9uU2VnbWVudCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgbGV0IFtmaXJzdFN0YXRlLCBuZXh0U3RhdGVdID0gYWRkU2VnbWVudChjdXJyZW50U3RhdGUsIHNlZ21lbnQpO1xuXG4gICAgICBmb3IgKGxldCBqID0gMCwgamogPSBza2lwcGFibGVTdGF0ZXMubGVuZ3RoOyBqIDwgamo7IGorKykge1xuICAgICAgICBza2lwcGFibGVTdGF0ZXNbal0ubmV4dFN0YXRlcy5wdXNoKGZpcnN0U3RhdGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2VnbWVudC5vcHRpb25hbCkge1xuICAgICAgICBza2lwcGFibGVTdGF0ZXMucHVzaChuZXh0U3RhdGUpO1xuICAgICAgICByZWdleCArPSBgKD86LyR7c2VnbWVudC5yZWdleCgpfSk/YDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnRTdGF0ZSA9IG5leHRTdGF0ZTtcbiAgICAgICAgcmVnZXggKz0gYC8ke3NlZ21lbnQucmVnZXgoKX1gO1xuICAgICAgICBza2lwcGFibGVTdGF0ZXMubGVuZ3RoID0gMDtcbiAgICAgICAgaXNFbXB0eSA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpc0VtcHR5KSB7XG4gICAgICBjdXJyZW50U3RhdGUgPSBjdXJyZW50U3RhdGUucHV0KHsgdmFsaWRDaGFyczogJy8nIH0pO1xuICAgICAgcmVnZXggKz0gJy8/JztcbiAgICB9XG5cbiAgICBsZXQgaGFuZGxlcnMgPSBbeyBoYW5kbGVyOiByb3V0ZS5oYW5kbGVyLCBuYW1lczogbmFtZXMgfV07XG5cbiAgICB0aGlzLnJvdXRlcy5zZXQocm91dGUuaGFuZGxlciwgeyBzZWdtZW50cywgaGFuZGxlcnMgfSk7XG4gICAgaWYgKHJvdXRlTmFtZSkge1xuICAgICAgbGV0IHJvdXRlTmFtZXMgPSBBcnJheS5pc0FycmF5KHJvdXRlTmFtZSkgPyByb3V0ZU5hbWUgOiBbcm91dGVOYW1lXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm91dGVOYW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoIShyb3V0ZU5hbWVzW2ldIGluIHRoaXMubmFtZXMpKSB7XG4gICAgICAgICAgdGhpcy5uYW1lc1tyb3V0ZU5hbWVzW2ldXSA9IHsgc2VnbWVudHMsIGhhbmRsZXJzIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNraXBwYWJsZVN0YXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHN0YXRlID0gc2tpcHBhYmxlU3RhdGVzW2ldO1xuICAgICAgc3RhdGUuaGFuZGxlcnMgPSBoYW5kbGVycztcbiAgICAgIHN0YXRlLnJlZ2V4ID0gbmV3IFJlZ0V4cChyZWdleCArICckJywgcm91dGUuY2FzZVNlbnNpdGl2ZSA/ICcnIDogJ2knKTtcbiAgICAgIHN0YXRlLnR5cGVzID0gdHlwZXM7XG4gICAgfVxuXG4gICAgY3VycmVudFN0YXRlLmhhbmRsZXJzID0gaGFuZGxlcnM7XG4gICAgY3VycmVudFN0YXRlLnJlZ2V4ID0gbmV3IFJlZ0V4cChyZWdleCArICckJywgcm91dGUuY2FzZVNlbnNpdGl2ZSA/ICcnIDogJ2knKTtcbiAgICBjdXJyZW50U3RhdGUudHlwZXMgPSB0eXBlcztcblxuICAgIHJldHVybiBjdXJyZW50U3RhdGU7XG4gIH1cblxuICBnZXRSb3V0ZShuYW1lT3JSb3V0ZSkge1xuICAgIHJldHVybiB0eXBlb2YgbmFtZU9yUm91dGUgPT09ICdzdHJpbmcnID8gdGhpcy5uYW1lc1tuYW1lT3JSb3V0ZV0gOiB0aGlzLnJvdXRlcy5nZXQobmFtZU9yUm91dGUpO1xuICB9XG5cbiAgaGFuZGxlcnNGb3IobmFtZU9yUm91dGUpIHtcbiAgICBsZXQgcm91dGUgPSB0aGlzLmdldFJvdXRlKG5hbWVPclJvdXRlKTtcbiAgICBpZiAoIXJvdXRlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZXJlIGlzIG5vIHJvdXRlIG5hbWVkICR7bmFtZU9yUm91dGV9YCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFsuLi5yb3V0ZS5oYW5kbGVyc107XG4gIH1cblxuICBoYXNSb3V0ZShuYW1lT3JSb3V0ZSkge1xuICAgIHJldHVybiAhIXRoaXMuZ2V0Um91dGUobmFtZU9yUm91dGUpO1xuICB9XG5cbiAgZ2VuZXJhdGUobmFtZU9yUm91dGUsIHBhcmFtcykge1xuICAgIGxldCByb3V0ZSA9IHRoaXMuZ2V0Um91dGUobmFtZU9yUm91dGUpO1xuICAgIGlmICghcm91dGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlcmUgaXMgbm8gcm91dGUgbmFtZWQgJHtuYW1lT3JSb3V0ZX1gKTtcbiAgICB9XG5cbiAgICBsZXQgaGFuZGxlciA9IHJvdXRlLmhhbmRsZXJzWzBdLmhhbmRsZXI7XG4gICAgaWYgKGhhbmRsZXIuZ2VuZXJhdGlvblVzZXNIcmVmKSB7XG4gICAgICByZXR1cm4gaGFuZGxlci5ocmVmO1xuICAgIH1cblxuICAgIGxldCByb3V0ZVBhcmFtcyA9IE9iamVjdC5hc3NpZ24oe30sIHBhcmFtcyk7XG4gICAgbGV0IHNlZ21lbnRzID0gcm91dGUuc2VnbWVudHM7XG4gICAgbGV0IGNvbnN1bWVkID0ge307XG4gICAgbGV0IG91dHB1dCA9ICcnO1xuXG4gICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzZWdtZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIGxldCBzZWdtZW50ID0gc2VnbWVudHNbaV07XG5cbiAgICAgIGlmIChzZWdtZW50IGluc3RhbmNlb2YgRXBzaWxvblNlZ21lbnQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGxldCBzZWdtZW50VmFsdWUgPSBzZWdtZW50LmdlbmVyYXRlKHJvdXRlUGFyYW1zLCBjb25zdW1lZCk7XG4gICAgICBpZiAoc2VnbWVudFZhbHVlID09PSBudWxsIHx8IHNlZ21lbnRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghc2VnbWVudC5vcHRpb25hbCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQSB2YWx1ZSBpcyByZXF1aXJlZCBmb3Igcm91dGUgcGFyYW1ldGVyICcke3NlZ21lbnQubmFtZX0nIGluIHJvdXRlICcke25hbWVPclJvdXRlfScuYCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG91dHB1dCArPSAnLyc7XG4gICAgICAgIG91dHB1dCArPSBzZWdtZW50VmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG91dHB1dC5jaGFyQXQoMCkgIT09ICcvJykge1xuICAgICAgb3V0cHV0ID0gJy8nICsgb3V0cHV0O1xuICAgIH1cblxuICAgIGZvciAobGV0IHBhcmFtIGluIGNvbnN1bWVkKSB7XG4gICAgICBkZWxldGUgcm91dGVQYXJhbXNbcGFyYW1dO1xuICAgIH1cblxuICAgIGxldCBxdWVyeVN0cmluZyA9IGJ1aWxkUXVlcnlTdHJpbmcocm91dGVQYXJhbXMpO1xuICAgIG91dHB1dCArPSBxdWVyeVN0cmluZyA/IGA/JHtxdWVyeVN0cmluZ31gIDogJyc7XG5cbiAgICByZXR1cm4gb3V0cHV0O1xuICB9XG5cbiAgcmVjb2duaXplKHBhdGgpIHtcbiAgICBsZXQgc3RhdGVzID0gW3RoaXMucm9vdFN0YXRlXTtcbiAgICBsZXQgcXVlcnlQYXJhbXMgPSB7fTtcbiAgICBsZXQgaXNTbGFzaERyb3BwZWQgPSBmYWxzZTtcbiAgICBsZXQgbm9ybWFsaXplZFBhdGggPSBwYXRoO1xuXG4gICAgbGV0IHF1ZXJ5U3RhcnQgPSBub3JtYWxpemVkUGF0aC5pbmRleE9mKCc/Jyk7XG4gICAgaWYgKHF1ZXJ5U3RhcnQgIT09IC0xKSB7XG4gICAgICBsZXQgcXVlcnlTdHJpbmcgPSBub3JtYWxpemVkUGF0aC5zdWJzdHIocXVlcnlTdGFydCArIDEsIG5vcm1hbGl6ZWRQYXRoLmxlbmd0aCk7XG4gICAgICBub3JtYWxpemVkUGF0aCA9IG5vcm1hbGl6ZWRQYXRoLnN1YnN0cigwLCBxdWVyeVN0YXJ0KTtcbiAgICAgIHF1ZXJ5UGFyYW1zID0gcGFyc2VRdWVyeVN0cmluZyhxdWVyeVN0cmluZyk7XG4gICAgfVxuXG4gICAgbm9ybWFsaXplZFBhdGggPSBkZWNvZGVVUkkobm9ybWFsaXplZFBhdGgpO1xuXG4gICAgaWYgKG5vcm1hbGl6ZWRQYXRoLmNoYXJBdCgwKSAhPT0gJy8nKSB7XG4gICAgICBub3JtYWxpemVkUGF0aCA9ICcvJyArIG5vcm1hbGl6ZWRQYXRoO1xuICAgIH1cblxuICAgIGxldCBwYXRoTGVuID0gbm9ybWFsaXplZFBhdGgubGVuZ3RoO1xuICAgIGlmIChwYXRoTGVuID4gMSAmJiBub3JtYWxpemVkUGF0aC5jaGFyQXQocGF0aExlbiAtIDEpID09PSAnLycpIHtcbiAgICAgIG5vcm1hbGl6ZWRQYXRoID0gbm9ybWFsaXplZFBhdGguc3Vic3RyKDAsIHBhdGhMZW4gLSAxKTtcbiAgICAgIGlzU2xhc2hEcm9wcGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gMCwgbCA9IG5vcm1hbGl6ZWRQYXRoLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgc3RhdGVzID0gcmVjb2duaXplQ2hhcihzdGF0ZXMsIG5vcm1hbGl6ZWRQYXRoLmNoYXJBdChpKSk7XG4gICAgICBpZiAoIXN0YXRlcy5sZW5ndGgpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IHNvbHV0aW9ucyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwLCBsID0gc3RhdGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgaWYgKHN0YXRlc1tpXS5oYW5kbGVycykge1xuICAgICAgICBzb2x1dGlvbnMucHVzaChzdGF0ZXNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHN0YXRlcyA9IHNvcnRTb2x1dGlvbnMoc29sdXRpb25zKTtcblxuICAgIGxldCBzdGF0ZSA9IHNvbHV0aW9uc1swXTtcbiAgICBpZiAoc3RhdGUgJiYgc3RhdGUuaGFuZGxlcnMpIHtcbiAgICAgIGlmIChpc1NsYXNoRHJvcHBlZCAmJiBzdGF0ZS5yZWdleC5zb3VyY2Uuc2xpY2UoLTUpID09PSAnKC4rKSQnKSB7XG4gICAgICAgIG5vcm1hbGl6ZWRQYXRoID0gbm9ybWFsaXplZFBhdGggKyAnLyc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmaW5kSGFuZGxlcihzdGF0ZSwgbm9ybWFsaXplZFBhdGgsIHF1ZXJ5UGFyYW1zKTtcbiAgICB9XG4gIH1cbn07XG5cbmxldCBSZWNvZ25pemVSZXN1bHRzID0gY2xhc3MgUmVjb2duaXplUmVzdWx0cyB7XG4gIGNvbnN0cnVjdG9yKHF1ZXJ5UGFyYW1zKSB7XG4gICAgdGhpcy5zcGxpY2UgPSBBcnJheS5wcm90b3R5cGUuc3BsaWNlO1xuICAgIHRoaXMuc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG4gICAgdGhpcy5wdXNoID0gQXJyYXkucHJvdG90eXBlLnB1c2g7XG4gICAgdGhpcy5sZW5ndGggPSAwO1xuICAgIHRoaXMucXVlcnlQYXJhbXMgPSBxdWVyeVBhcmFtcyB8fCB7fTtcbiAgfVxufTtcblxuXG5mdW5jdGlvbiBwYXJzZShyb3V0ZSwgbmFtZXMsIHR5cGVzLCBjYXNlU2Vuc2l0aXZlKSB7XG4gIGxldCBub3JtYWxpemVkUm91dGUgPSByb3V0ZTtcbiAgaWYgKHJvdXRlLmNoYXJBdCgwKSA9PT0gJy8nKSB7XG4gICAgbm9ybWFsaXplZFJvdXRlID0gcm91dGUuc3Vic3RyKDEpO1xuICB9XG5cbiAgbGV0IHJlc3VsdHMgPSBbXTtcblxuICBsZXQgc3BsaXRSb3V0ZSA9IG5vcm1hbGl6ZWRSb3V0ZS5zcGxpdCgnLycpO1xuICBmb3IgKGxldCBpID0gMCwgaWkgPSBzcGxpdFJvdXRlLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICBsZXQgc2VnbWVudCA9IHNwbGl0Um91dGVbaV07XG5cbiAgICBsZXQgbWF0Y2ggPSBzZWdtZW50Lm1hdGNoKC9eOihbXj9dKykoXFw/KT8kLyk7XG4gICAgaWYgKG1hdGNoKSB7XG4gICAgICBsZXQgWywgbmFtZSwgb3B0aW9uYWxdID0gbWF0Y2g7XG4gICAgICBpZiAobmFtZS5pbmRleE9mKCc9JykgIT09IC0xKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgUGFyYW1ldGVyICR7bmFtZX0gaW4gcm91dGUgJHtyb3V0ZX0gaGFzIGEgZGVmYXVsdCB2YWx1ZSwgd2hpY2ggaXMgbm90IHN1cHBvcnRlZC5gKTtcbiAgICAgIH1cbiAgICAgIHJlc3VsdHMucHVzaChuZXcgRHluYW1pY1NlZ21lbnQobmFtZSwgISFvcHRpb25hbCkpO1xuICAgICAgbmFtZXMucHVzaChuYW1lKTtcbiAgICAgIHR5cGVzLmR5bmFtaWNzKys7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBtYXRjaCA9IHNlZ21lbnQubWF0Y2goL15cXCooLispJC8pO1xuICAgIGlmIChtYXRjaCkge1xuICAgICAgcmVzdWx0cy5wdXNoKG5ldyBTdGFyU2VnbWVudChtYXRjaFsxXSkpO1xuICAgICAgbmFtZXMucHVzaChtYXRjaFsxXSk7XG4gICAgICB0eXBlcy5zdGFycysrO1xuICAgIH0gZWxzZSBpZiAoc2VnbWVudCA9PT0gJycpIHtcbiAgICAgIHJlc3VsdHMucHVzaChuZXcgRXBzaWxvblNlZ21lbnQoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdHMucHVzaChuZXcgU3RhdGljU2VnbWVudChzZWdtZW50LCBjYXNlU2Vuc2l0aXZlKSk7XG4gICAgICB0eXBlcy5zdGF0aWNzKys7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdHM7XG59XG5cbmZ1bmN0aW9uIHNvcnRTb2x1dGlvbnMoc3RhdGVzKSB7XG4gIHJldHVybiBzdGF0ZXMuc29ydCgoYSwgYikgPT4ge1xuICAgIGlmIChhLnR5cGVzLnN0YXJzICE9PSBiLnR5cGVzLnN0YXJzKSB7XG4gICAgICByZXR1cm4gYS50eXBlcy5zdGFycyAtIGIudHlwZXMuc3RhcnM7XG4gICAgfVxuXG4gICAgaWYgKGEudHlwZXMuc3RhcnMpIHtcbiAgICAgIGlmIChhLnR5cGVzLnN0YXRpY3MgIT09IGIudHlwZXMuc3RhdGljcykge1xuICAgICAgICByZXR1cm4gYi50eXBlcy5zdGF0aWNzIC0gYS50eXBlcy5zdGF0aWNzO1xuICAgICAgfVxuICAgICAgaWYgKGEudHlwZXMuZHluYW1pY3MgIT09IGIudHlwZXMuZHluYW1pY3MpIHtcbiAgICAgICAgcmV0dXJuIGIudHlwZXMuZHluYW1pY3MgLSBhLnR5cGVzLmR5bmFtaWNzO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChhLnR5cGVzLmR5bmFtaWNzICE9PSBiLnR5cGVzLmR5bmFtaWNzKSB7XG4gICAgICByZXR1cm4gYS50eXBlcy5keW5hbWljcyAtIGIudHlwZXMuZHluYW1pY3M7XG4gICAgfVxuXG4gICAgaWYgKGEudHlwZXMuc3RhdGljcyAhPT0gYi50eXBlcy5zdGF0aWNzKSB7XG4gICAgICByZXR1cm4gYi50eXBlcy5zdGF0aWNzIC0gYS50eXBlcy5zdGF0aWNzO1xuICAgIH1cblxuICAgIHJldHVybiAwO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcmVjb2duaXplQ2hhcihzdGF0ZXMsIGNoKSB7XG4gIGxldCBuZXh0U3RhdGVzID0gW107XG5cbiAgZm9yIChsZXQgaSA9IDAsIGwgPSBzdGF0ZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgbGV0IHN0YXRlID0gc3RhdGVzW2ldO1xuICAgIG5leHRTdGF0ZXMucHVzaCguLi5zdGF0ZS5tYXRjaChjaCkpO1xuICB9XG5cbiAgcmV0dXJuIG5leHRTdGF0ZXM7XG59XG5cbmZ1bmN0aW9uIGZpbmRIYW5kbGVyKHN0YXRlLCBwYXRoLCBxdWVyeVBhcmFtcykge1xuICBsZXQgaGFuZGxlcnMgPSBzdGF0ZS5oYW5kbGVycztcbiAgbGV0IHJlZ2V4ID0gc3RhdGUucmVnZXg7XG4gIGxldCBjYXB0dXJlcyA9IHBhdGgubWF0Y2gocmVnZXgpO1xuICBsZXQgY3VycmVudENhcHR1cmUgPSAxO1xuICBsZXQgcmVzdWx0ID0gbmV3IFJlY29nbml6ZVJlc3VsdHMocXVlcnlQYXJhbXMpO1xuXG4gIGZvciAobGV0IGkgPSAwLCBsID0gaGFuZGxlcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgbGV0IGhhbmRsZXIgPSBoYW5kbGVyc1tpXTtcbiAgICBsZXQgbmFtZXMgPSBoYW5kbGVyLm5hbWVzO1xuICAgIGxldCBwYXJhbXMgPSB7fTtcblxuICAgIGZvciAobGV0IGogPSAwLCBtID0gbmFtZXMubGVuZ3RoOyBqIDwgbTsgaisrKSB7XG4gICAgICBwYXJhbXNbbmFtZXNbal1dID0gY2FwdHVyZXNbY3VycmVudENhcHR1cmUrK107XG4gICAgfVxuXG4gICAgcmVzdWx0LnB1c2goeyBoYW5kbGVyOiBoYW5kbGVyLmhhbmRsZXIsIHBhcmFtczogcGFyYW1zLCBpc0R5bmFtaWM6ICEhbmFtZXMubGVuZ3RoIH0pO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gYWRkU2VnbWVudChjdXJyZW50U3RhdGUsIHNlZ21lbnQpIHtcbiAgbGV0IGZpcnN0U3RhdGUgPSBjdXJyZW50U3RhdGUucHV0KHsgdmFsaWRDaGFyczogJy8nIH0pO1xuICBsZXQgbmV4dFN0YXRlID0gZmlyc3RTdGF0ZTtcbiAgc2VnbWVudC5lYWNoQ2hhcihjaCA9PiB7XG4gICAgbmV4dFN0YXRlID0gbmV4dFN0YXRlLnB1dChjaCk7XG4gIH0pO1xuXG4gIHJldHVybiBbZmlyc3RTdGF0ZSwgbmV4dFN0YXRlXTtcbn0iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/aurelia-route-recognizer/dist/es2015/aurelia-route-recognizer.js\n");

/***/ }),

/***/ "./node_modules/aurelia-router/dist/es2015/aurelia-router.js":
/*!*******************************************************************!*\
  !*** ./node_modules/aurelia-router/dist/es2015/aurelia-router.js ***!
  \*******************************************************************/
/*! exports provided: ActivateNextStep, AppRouter, BuildNavigationPlanStep, CanActivateNextStep, CanDeactivatePreviousStep, CommitChangesStep, DeactivatePreviousStep, LoadRouteStep, NavModel, NavigationInstruction, Pipeline, PipelineProvider, PipelineSlotName, PipelineStatus, Redirect, RedirectToRoute, RouteLoader, Router, RouterConfiguration, RouterEvent, activationStrategy, isNavigationCommand */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ActivateNextStep\", function() { return ActivateNextStep; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AppRouter\", function() { return AppRouter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BuildNavigationPlanStep\", function() { return BuildNavigationPlanStep; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CanActivateNextStep\", function() { return CanActivateNextStep; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CanDeactivatePreviousStep\", function() { return CanDeactivatePreviousStep; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CommitChangesStep\", function() { return CommitChangesStep; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DeactivatePreviousStep\", function() { return DeactivatePreviousStep; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LoadRouteStep\", function() { return LoadRouteStep; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NavModel\", function() { return NavModel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NavigationInstruction\", function() { return NavigationInstruction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Pipeline\", function() { return Pipeline; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PipelineProvider\", function() { return PipelineProvider; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PipelineSlotName\", function() { return PipelineSlotName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PipelineStatus\", function() { return PipelineStatus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Redirect\", function() { return Redirect; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RedirectToRoute\", function() { return RedirectToRoute; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouteLoader\", function() { return RouteLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Router\", function() { return Router; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouterConfiguration\", function() { return RouterConfiguration; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouterEvent\", function() { return RouterEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"activationStrategy\", function() { return activationStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isNavigationCommand\", function() { return isNavigationCommand; });\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-logging */ \"./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js\");\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-dependency-injection */ \"./node_modules/aurelia-dependency-injection/dist/es2015/aurelia-dependency-injection.js\");\n/* harmony import */ var aurelia_history__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-history */ \"./node_modules/aurelia-history/dist/es2015/aurelia-history.js\");\n/* harmony import */ var aurelia_route_recognizer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-route-recognizer */ \"./node_modules/aurelia-route-recognizer/dist/es2015/aurelia-route-recognizer.js\");\n/* harmony import */ var aurelia_event_aggregator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-event-aggregator */ \"aurelia-event-aggregator\");\n\n\n\n\n\n\n/**\r\n * Class used to represent an instruction during a navigation.\r\n */\r\nclass NavigationInstruction {\r\n    constructor(init) {\r\n        /**\r\n         * Current built viewport plan of this nav instruction\r\n         */\r\n        this.plan = null;\r\n        this.options = {};\r\n        Object.assign(this, init);\r\n        this.params = this.params || {};\r\n        this.viewPortInstructions = {};\r\n        let ancestorParams = [];\r\n        let current = this;\r\n        do {\r\n            let currentParams = Object.assign({}, current.params);\r\n            if (current.config && current.config.hasChildRouter) {\r\n                // remove the param for the injected child route segment\r\n                delete currentParams[current.getWildCardName()];\r\n            }\r\n            ancestorParams.unshift(currentParams);\r\n            current = current.parentInstruction;\r\n        } while (current);\r\n        let allParams = Object.assign({}, this.queryParams, ...ancestorParams);\r\n        this.lifecycleArgs = [allParams, this.config, this];\r\n    }\r\n    /**\r\n     * Gets an array containing this instruction and all child instructions for the current navigation.\r\n     */\r\n    getAllInstructions() {\r\n        let instructions = [this];\r\n        let viewPortInstructions = this.viewPortInstructions;\r\n        for (let key in viewPortInstructions) {\r\n            let childInstruction = viewPortInstructions[key].childNavigationInstruction;\r\n            if (childInstruction) {\r\n                instructions.push(...childInstruction.getAllInstructions());\r\n            }\r\n        }\r\n        return instructions;\r\n    }\r\n    /**\r\n     * Gets an array containing the instruction and all child instructions for the previous navigation.\r\n     * Previous instructions are no longer available after navigation completes.\r\n     */\r\n    getAllPreviousInstructions() {\r\n        return this.getAllInstructions().map(c => c.previousInstruction).filter(c => c);\r\n    }\r\n    addViewPortInstruction(nameOrInitOptions, strategy, moduleId, component) {\r\n        let viewPortInstruction;\r\n        let viewPortName = typeof nameOrInitOptions === 'string' ? nameOrInitOptions : nameOrInitOptions.name;\r\n        const lifecycleArgs = this.lifecycleArgs;\r\n        const config = Object.assign({}, lifecycleArgs[1], { currentViewPort: viewPortName });\r\n        if (typeof nameOrInitOptions === 'string') {\r\n            viewPortInstruction = {\r\n                name: nameOrInitOptions,\r\n                strategy: strategy,\r\n                moduleId: moduleId,\r\n                component: component,\r\n                childRouter: component.childRouter,\r\n                lifecycleArgs: [lifecycleArgs[0], config, lifecycleArgs[2]]\r\n            };\r\n        }\r\n        else {\r\n            viewPortInstruction = {\r\n                name: viewPortName,\r\n                strategy: nameOrInitOptions.strategy,\r\n                component: nameOrInitOptions.component,\r\n                moduleId: nameOrInitOptions.moduleId,\r\n                childRouter: nameOrInitOptions.component.childRouter,\r\n                lifecycleArgs: [lifecycleArgs[0], config, lifecycleArgs[2]]\r\n            };\r\n        }\r\n        return this.viewPortInstructions[viewPortName] = viewPortInstruction;\r\n    }\r\n    /**\r\n     * Gets the name of the route pattern's wildcard parameter, if applicable.\r\n     */\r\n    getWildCardName() {\r\n        // todo: potential issue, or at least unsafe typings\r\n        let configRoute = this.config.route;\r\n        let wildcardIndex = configRoute.lastIndexOf('*');\r\n        return configRoute.substr(wildcardIndex + 1);\r\n    }\r\n    /**\r\n     * Gets the path and query string created by filling the route\r\n     * pattern's wildcard parameter with the matching param.\r\n     */\r\n    getWildcardPath() {\r\n        let wildcardName = this.getWildCardName();\r\n        let path = this.params[wildcardName] || '';\r\n        let queryString = this.queryString;\r\n        if (queryString) {\r\n            path += '?' + queryString;\r\n        }\r\n        return path;\r\n    }\r\n    /**\r\n     * Gets the instruction's base URL, accounting for wildcard route parameters.\r\n     */\r\n    getBaseUrl() {\r\n        let $encodeURI = encodeURI;\r\n        let fragment = decodeURI(this.fragment);\r\n        if (fragment === '') {\r\n            let nonEmptyRoute = this.router.routes.find(route => {\r\n                return route.name === this.config.name &&\r\n                    route.route !== '';\r\n            });\r\n            if (nonEmptyRoute) {\r\n                fragment = nonEmptyRoute.route;\r\n            }\r\n        }\r\n        if (!this.params) {\r\n            return $encodeURI(fragment);\r\n        }\r\n        let wildcardName = this.getWildCardName();\r\n        let path = this.params[wildcardName] || '';\r\n        if (!path) {\r\n            return $encodeURI(fragment);\r\n        }\r\n        return $encodeURI(fragment.substr(0, fragment.lastIndexOf(path)));\r\n    }\r\n    /**\r\n     * Finalize a viewport instruction\r\n     * @internal\r\n     */\r\n    _commitChanges(waitToSwap) {\r\n        let router = this.router;\r\n        router.currentInstruction = this;\r\n        const previousInstruction = this.previousInstruction;\r\n        if (previousInstruction) {\r\n            previousInstruction.config.navModel.isActive = false;\r\n        }\r\n        this.config.navModel.isActive = true;\r\n        router.refreshNavigation();\r\n        let loads = [];\r\n        let delaySwaps = [];\r\n        let viewPortInstructions = this.viewPortInstructions;\r\n        for (let viewPortName in viewPortInstructions) {\r\n            let viewPortInstruction = viewPortInstructions[viewPortName];\r\n            let viewPort = router.viewPorts[viewPortName];\r\n            if (!viewPort) {\r\n                throw new Error(`There was no router-view found in the view for ${viewPortInstruction.moduleId}.`);\r\n            }\r\n            let childNavInstruction = viewPortInstruction.childNavigationInstruction;\r\n            if (viewPortInstruction.strategy === \"replace\" /* Replace */) {\r\n                if (childNavInstruction && childNavInstruction.parentCatchHandler) {\r\n                    loads.push(childNavInstruction._commitChanges(waitToSwap));\r\n                }\r\n                else {\r\n                    if (waitToSwap) {\r\n                        delaySwaps.push({ viewPort, viewPortInstruction });\r\n                    }\r\n                    loads.push(viewPort\r\n                        .process(viewPortInstruction, waitToSwap)\r\n                        .then(() => childNavInstruction\r\n                        ? childNavInstruction._commitChanges(waitToSwap)\r\n                        : Promise.resolve()));\r\n                }\r\n            }\r\n            else {\r\n                if (childNavInstruction) {\r\n                    loads.push(childNavInstruction._commitChanges(waitToSwap));\r\n                }\r\n            }\r\n        }\r\n        return Promise\r\n            .all(loads)\r\n            .then(() => {\r\n            delaySwaps.forEach(x => x.viewPort.swap(x.viewPortInstruction));\r\n            return null;\r\n        })\r\n            .then(() => prune(this));\r\n    }\r\n    /**@internal */\r\n    _updateTitle() {\r\n        let router = this.router;\r\n        let title = this._buildTitle(router.titleSeparator);\r\n        if (title) {\r\n            router.history.setTitle(title);\r\n        }\r\n    }\r\n    /**@internal */\r\n    _buildTitle(separator = ' | ') {\r\n        let title = '';\r\n        let childTitles = [];\r\n        let navModelTitle = this.config.navModel.title;\r\n        let instructionRouter = this.router;\r\n        let viewPortInstructions = this.viewPortInstructions;\r\n        if (navModelTitle) {\r\n            title = instructionRouter.transformTitle(navModelTitle);\r\n        }\r\n        for (let viewPortName in viewPortInstructions) {\r\n            let viewPortInstruction = viewPortInstructions[viewPortName];\r\n            let child_nav_instruction = viewPortInstruction.childNavigationInstruction;\r\n            if (child_nav_instruction) {\r\n                let childTitle = child_nav_instruction._buildTitle(separator);\r\n                if (childTitle) {\r\n                    childTitles.push(childTitle);\r\n                }\r\n            }\r\n        }\r\n        if (childTitles.length) {\r\n            title = childTitles.join(separator) + (title ? separator : '') + title;\r\n        }\r\n        if (instructionRouter.title) {\r\n            title += (title ? separator : '') + instructionRouter.transformTitle(instructionRouter.title);\r\n        }\r\n        return title;\r\n    }\r\n}\r\nconst prune = (instruction) => {\r\n    instruction.previousInstruction = null;\r\n    instruction.plan = null;\r\n};\n\n/**\r\n* Class for storing and interacting with a route's navigation settings.\r\n*/\r\nclass NavModel {\r\n    constructor(router, relativeHref) {\r\n        /**\r\n        * True if this nav item is currently active.\r\n        */\r\n        this.isActive = false;\r\n        /**\r\n        * The title.\r\n        */\r\n        this.title = null;\r\n        /**\r\n        * This nav item's absolute href.\r\n        */\r\n        this.href = null;\r\n        /**\r\n        * This nav item's relative href.\r\n        */\r\n        this.relativeHref = null;\r\n        /**\r\n        * Data attached to the route at configuration time.\r\n        */\r\n        this.settings = {};\r\n        /**\r\n        * The route config.\r\n        */\r\n        this.config = null;\r\n        this.router = router;\r\n        this.relativeHref = relativeHref;\r\n    }\r\n    /**\r\n    * Sets the route's title and updates document.title.\r\n    *  If the a navigation is in progress, the change will be applied\r\n    *  to document.title when the navigation completes.\r\n    *\r\n    * @param title The new title.\r\n    */\r\n    setTitle(title) {\r\n        this.title = title;\r\n        if (this.isActive) {\r\n            this.router.updateTitle();\r\n        }\r\n    }\r\n}\n\nfunction _normalizeAbsolutePath(path, hasPushState, absolute = false) {\r\n    if (!hasPushState && path[0] !== '#') {\r\n        path = '#' + path;\r\n    }\r\n    if (hasPushState && absolute) {\r\n        path = path.substring(1, path.length);\r\n    }\r\n    return path;\r\n}\r\nfunction _createRootedPath(fragment, baseUrl, hasPushState, absolute) {\r\n    if (isAbsoluteUrl.test(fragment)) {\r\n        return fragment;\r\n    }\r\n    let path = '';\r\n    if (baseUrl.length && baseUrl[0] !== '/') {\r\n        path += '/';\r\n    }\r\n    path += baseUrl;\r\n    if ((!path.length || path[path.length - 1] !== '/') && fragment[0] !== '/') {\r\n        path += '/';\r\n    }\r\n    if (path.length && path[path.length - 1] === '/' && fragment[0] === '/') {\r\n        path = path.substring(0, path.length - 1);\r\n    }\r\n    return _normalizeAbsolutePath(path + fragment, hasPushState, absolute);\r\n}\r\nfunction _resolveUrl(fragment, baseUrl, hasPushState) {\r\n    if (isRootedPath.test(fragment)) {\r\n        return _normalizeAbsolutePath(fragment, hasPushState);\r\n    }\r\n    return _createRootedPath(fragment, baseUrl, hasPushState);\r\n}\r\nfunction _ensureArrayWithSingleRoutePerConfig(config) {\r\n    let routeConfigs = [];\r\n    if (Array.isArray(config.route)) {\r\n        for (let i = 0, ii = config.route.length; i < ii; ++i) {\r\n            let current = Object.assign({}, config);\r\n            current.route = config.route[i];\r\n            routeConfigs.push(current);\r\n        }\r\n    }\r\n    else {\r\n        routeConfigs.push(Object.assign({}, config));\r\n    }\r\n    return routeConfigs;\r\n}\r\nconst isRootedPath = /^#?\\//;\r\nconst isAbsoluteUrl = /^([a-z][a-z0-9+\\-.]*:)?\\/\\//i;\n\n/**\r\n * Class used to configure a [[Router]] instance.\r\n *\r\n * @constructor\r\n */\r\nclass RouterConfiguration {\r\n    constructor() {\r\n        this.instructions = [];\r\n        this.options = {};\r\n        this.pipelineSteps = [];\r\n    }\r\n    /**\r\n     * Adds a step to be run during the [[Router]]'s navigation pipeline.\r\n     *\r\n     * @param name The name of the pipeline slot to insert the step into.\r\n     * @param step The pipeline step.\r\n     * @chainable\r\n     */\r\n    addPipelineStep(name, step) {\r\n        if (step === null || step === undefined) {\r\n            throw new Error('Pipeline step cannot be null or undefined.');\r\n        }\r\n        this.pipelineSteps.push({ name, step });\r\n        return this;\r\n    }\r\n    /**\r\n     * Adds a step to be run during the [[Router]]'s authorize pipeline slot.\r\n     *\r\n     * @param step The pipeline step.\r\n     * @chainable\r\n     */\r\n    addAuthorizeStep(step) {\r\n        return this.addPipelineStep(\"authorize\" /* Authorize */, step);\r\n    }\r\n    /**\r\n     * Adds a step to be run during the [[Router]]'s preActivate pipeline slot.\r\n     *\r\n     * @param step The pipeline step.\r\n     * @chainable\r\n     */\r\n    addPreActivateStep(step) {\r\n        return this.addPipelineStep(\"preActivate\" /* PreActivate */, step);\r\n    }\r\n    /**\r\n     * Adds a step to be run during the [[Router]]'s preRender pipeline slot.\r\n     *\r\n     * @param step The pipeline step.\r\n     * @chainable\r\n     */\r\n    addPreRenderStep(step) {\r\n        return this.addPipelineStep(\"preRender\" /* PreRender */, step);\r\n    }\r\n    /**\r\n     * Adds a step to be run during the [[Router]]'s postRender pipeline slot.\r\n     *\r\n     * @param step The pipeline step.\r\n     * @chainable\r\n     */\r\n    addPostRenderStep(step) {\r\n        return this.addPipelineStep(\"postRender\" /* PostRender */, step);\r\n    }\r\n    /**\r\n     * Configures a route that will be used if there is no previous location available on navigation cancellation.\r\n     *\r\n     * @param fragment The URL fragment to use as the navigation destination.\r\n     * @chainable\r\n     */\r\n    fallbackRoute(fragment) {\r\n        this._fallbackRoute = fragment;\r\n        return this;\r\n    }\r\n    /**\r\n     * Maps one or more routes to be registered with the router.\r\n     *\r\n     * @param route The [[RouteConfig]] to map, or an array of [[RouteConfig]] to map.\r\n     * @chainable\r\n     */\r\n    map(route) {\r\n        if (Array.isArray(route)) {\r\n            route.forEach(r => this.map(r));\r\n            return this;\r\n        }\r\n        return this.mapRoute(route);\r\n    }\r\n    /**\r\n     * Configures defaults to use for any view ports.\r\n     *\r\n     * @param viewPortConfig a view port configuration object to use as a\r\n     *  default, of the form { viewPortName: { moduleId } }.\r\n     * @chainable\r\n     */\r\n    useViewPortDefaults(viewPortConfig) {\r\n        this.viewPortDefaults = viewPortConfig;\r\n        return this;\r\n    }\r\n    /**\r\n     * Maps a single route to be registered with the router.\r\n     *\r\n     * @param route The [[RouteConfig]] to map.\r\n     * @chainable\r\n     */\r\n    mapRoute(config) {\r\n        this.instructions.push(router => {\r\n            let routeConfigs = _ensureArrayWithSingleRoutePerConfig(config);\r\n            let navModel;\r\n            for (let i = 0, ii = routeConfigs.length; i < ii; ++i) {\r\n                let routeConfig = routeConfigs[i];\r\n                routeConfig.settings = routeConfig.settings || {};\r\n                if (!navModel) {\r\n                    navModel = router.createNavModel(routeConfig);\r\n                }\r\n                router.addRoute(routeConfig, navModel);\r\n            }\r\n        });\r\n        return this;\r\n    }\r\n    /**\r\n     * Registers an unknown route handler to be run when the URL fragment doesn't match any registered routes.\r\n     *\r\n     * @param config A string containing a moduleId to load, or a [[RouteConfig]], or a function that takes the\r\n     *  [[NavigationInstruction]] and selects a moduleId to load.\r\n     * @chainable\r\n     */\r\n    mapUnknownRoutes(config) {\r\n        this.unknownRouteConfig = config;\r\n        return this;\r\n    }\r\n    /**\r\n     * Applies the current configuration to the specified [[Router]].\r\n     *\r\n     * @param router The [[Router]] to apply the configuration to.\r\n     */\r\n    exportToRouter(router) {\r\n        let instructions = this.instructions;\r\n        for (let i = 0, ii = instructions.length; i < ii; ++i) {\r\n            instructions[i](router);\r\n        }\r\n        let { title, titleSeparator, unknownRouteConfig, _fallbackRoute, viewPortDefaults } = this;\r\n        if (title) {\r\n            router.title = title;\r\n        }\r\n        if (titleSeparator) {\r\n            router.titleSeparator = titleSeparator;\r\n        }\r\n        if (unknownRouteConfig) {\r\n            router.handleUnknownRoutes(unknownRouteConfig);\r\n        }\r\n        if (_fallbackRoute) {\r\n            router.fallbackRoute = _fallbackRoute;\r\n        }\r\n        if (viewPortDefaults) {\r\n            router.useViewPortDefaults(viewPortDefaults);\r\n        }\r\n        Object.assign(router.options, this.options);\r\n        let pipelineSteps = this.pipelineSteps;\r\n        let pipelineStepCount = pipelineSteps.length;\r\n        if (pipelineStepCount) {\r\n            if (!router.isRoot) {\r\n                throw new Error('Pipeline steps can only be added to the root router');\r\n            }\r\n            let pipelineProvider = router.pipelineProvider;\r\n            for (let i = 0, ii = pipelineStepCount; i < ii; ++i) {\r\n                let { name, step } = pipelineSteps[i];\r\n                pipelineProvider.addStep(name, step);\r\n            }\r\n        }\r\n    }\r\n}\n\n/**\r\n * The primary class responsible for handling routing and navigation.\r\n */\r\nclass Router {\r\n    /**\r\n     * @param container The [[Container]] to use when child routers.\r\n     * @param history The [[History]] implementation to delegate navigation requests to.\r\n     */\r\n    constructor(container, history) {\r\n        /**\r\n         * The parent router, or null if this instance is not a child router.\r\n         */\r\n        this.parent = null;\r\n        this.options = {};\r\n        /**\r\n         * The defaults used when a viewport lacks specified content\r\n         */\r\n        this.viewPortDefaults = {};\r\n        /**\r\n         * Extension point to transform the document title before it is built and displayed.\r\n         * By default, child routers delegate to the parent router, and the app router\r\n         * returns the title unchanged.\r\n         */\r\n        this.transformTitle = (title) => {\r\n            if (this.parent) {\r\n                return this.parent.transformTitle(title);\r\n            }\r\n            return title;\r\n        };\r\n        this.container = container;\r\n        this.history = history;\r\n        this.reset();\r\n    }\r\n    /**\r\n     * Fully resets the router's internal state. Primarily used internally by the framework when multiple calls to setRoot are made.\r\n     * Use with caution (actually, avoid using this). Do not use this to simply change your navigation model.\r\n     */\r\n    reset() {\r\n        this.viewPorts = {};\r\n        this.routes = [];\r\n        this.baseUrl = '';\r\n        this.isConfigured = false;\r\n        this.isNavigating = false;\r\n        this.isExplicitNavigation = false;\r\n        this.isExplicitNavigationBack = false;\r\n        this.isNavigatingFirst = false;\r\n        this.isNavigatingNew = false;\r\n        this.isNavigatingRefresh = false;\r\n        this.isNavigatingForward = false;\r\n        this.isNavigatingBack = false;\r\n        this.couldDeactivate = false;\r\n        this.navigation = [];\r\n        this.currentInstruction = null;\r\n        this.viewPortDefaults = {};\r\n        this._fallbackOrder = 100;\r\n        this._recognizer = new aurelia_route_recognizer__WEBPACK_IMPORTED_MODULE_3__[\"RouteRecognizer\"]();\r\n        this._childRecognizer = new aurelia_route_recognizer__WEBPACK_IMPORTED_MODULE_3__[\"RouteRecognizer\"]();\r\n        this._configuredPromise = new Promise(resolve => {\r\n            this._resolveConfiguredPromise = resolve;\r\n        });\r\n    }\r\n    /**\r\n     * Gets a value indicating whether or not this [[Router]] is the root in the router tree. I.e., it has no parent.\r\n     */\r\n    get isRoot() {\r\n        return !this.parent;\r\n    }\r\n    /**\r\n     * Registers a viewPort to be used as a rendering target for activated routes.\r\n     *\r\n     * @param viewPort The viewPort.\r\n     * @param name The name of the viewPort. 'default' if unspecified.\r\n     */\r\n    registerViewPort(viewPort, name) {\r\n        name = name || 'default';\r\n        this.viewPorts[name] = viewPort;\r\n    }\r\n    /**\r\n     * Returns a Promise that resolves when the router is configured.\r\n     */\r\n    ensureConfigured() {\r\n        return this._configuredPromise;\r\n    }\r\n    /**\r\n     * Configures the router.\r\n     *\r\n     * @param callbackOrConfig The [[RouterConfiguration]] or a callback that takes a [[RouterConfiguration]].\r\n     */\r\n    configure(callbackOrConfig) {\r\n        this.isConfigured = true;\r\n        let result = callbackOrConfig;\r\n        let config;\r\n        if (typeof callbackOrConfig === 'function') {\r\n            config = new RouterConfiguration();\r\n            result = callbackOrConfig(config);\r\n        }\r\n        return Promise\r\n            .resolve(result)\r\n            .then((c) => {\r\n            if (c && c.exportToRouter) {\r\n                config = c;\r\n            }\r\n            config.exportToRouter(this);\r\n            this.isConfigured = true;\r\n            this._resolveConfiguredPromise();\r\n        });\r\n    }\r\n    /**\r\n     * Navigates to a new location.\r\n     *\r\n     * @param fragment The URL fragment to use as the navigation destination.\r\n     * @param options The navigation options.\r\n     */\r\n    navigate(fragment, options) {\r\n        if (!this.isConfigured && this.parent) {\r\n            return this.parent.navigate(fragment, options);\r\n        }\r\n        this.isExplicitNavigation = true;\r\n        return this.history.navigate(_resolveUrl(fragment, this.baseUrl, this.history._hasPushState), options);\r\n    }\r\n    /**\r\n     * Navigates to a new location corresponding to the route and params specified. Equivallent to [[Router.generate]] followed\r\n     * by [[Router.navigate]].\r\n     *\r\n     * @param route The name of the route to use when generating the navigation location.\r\n     * @param params The route parameters to be used when populating the route pattern.\r\n     * @param options The navigation options.\r\n     */\r\n    navigateToRoute(route, params, options) {\r\n        let path = this.generate(route, params);\r\n        return this.navigate(path, options);\r\n    }\r\n    /**\r\n     * Navigates back to the most recent location in history.\r\n     */\r\n    navigateBack() {\r\n        this.isExplicitNavigationBack = true;\r\n        this.history.navigateBack();\r\n    }\r\n    /**\r\n     * Creates a child router of the current router.\r\n     *\r\n     * @param container The [[Container]] to provide to the child router. Uses the current [[Router]]'s [[Container]] if unspecified.\r\n     * @returns {Router} The new child Router.\r\n     */\r\n    createChild(container) {\r\n        let childRouter = new Router(container || this.container.createChild(), this.history);\r\n        childRouter.parent = this;\r\n        return childRouter;\r\n    }\r\n    /**\r\n     * Generates a URL fragment matching the specified route pattern.\r\n     *\r\n     * @param name The name of the route whose pattern should be used to generate the fragment.\r\n     * @param params The route params to be used to populate the route pattern.\r\n     * @param options If options.absolute = true, then absolute url will be generated; otherwise, it will be relative url.\r\n     * @returns {string} A string containing the generated URL fragment.\r\n     */\r\n    generate(nameOrRoute, params = {}, options = {}) {\r\n        // A child recognizer generates routes for potential child routes. Any potential child route is added\r\n        // to the childRoute property of params for the childRouter to recognize. When generating routes, we\r\n        // use the childRecognizer when childRoute params are available to generate a child router enabled route.\r\n        let recognizer = 'childRoute' in params ? this._childRecognizer : this._recognizer;\r\n        let hasRoute = recognizer.hasRoute(nameOrRoute);\r\n        if (!hasRoute) {\r\n            if (this.parent) {\r\n                return this.parent.generate(nameOrRoute, params, options);\r\n            }\r\n            throw new Error(`A route with name '${nameOrRoute}' could not be found. Check that \\`name: '${nameOrRoute}'\\` was specified in the route's config.`);\r\n        }\r\n        let path = recognizer.generate(nameOrRoute, params);\r\n        let rootedPath = _createRootedPath(path, this.baseUrl, this.history._hasPushState, options.absolute);\r\n        return options.absolute ? `${this.history.getAbsoluteRoot()}${rootedPath}` : rootedPath;\r\n    }\r\n    /**\r\n     * Creates a [[NavModel]] for the specified route config.\r\n     *\r\n     * @param config The route config.\r\n     */\r\n    createNavModel(config) {\r\n        let navModel = new NavModel(this, 'href' in config\r\n            ? config.href\r\n            // potential error when config.route is a string[] ?\r\n            : config.route);\r\n        navModel.title = config.title;\r\n        navModel.order = config.nav;\r\n        navModel.href = config.href;\r\n        navModel.settings = config.settings;\r\n        navModel.config = config;\r\n        return navModel;\r\n    }\r\n    /**\r\n     * Registers a new route with the router.\r\n     *\r\n     * @param config The [[RouteConfig]].\r\n     * @param navModel The [[NavModel]] to use for the route. May be omitted for single-pattern routes.\r\n     */\r\n    addRoute(config, navModel) {\r\n        if (Array.isArray(config.route)) {\r\n            let routeConfigs = _ensureArrayWithSingleRoutePerConfig(config);\r\n            // the following is wrong. todo: fix this after TS refactoring release\r\n            routeConfigs.forEach(this.addRoute.bind(this));\r\n            return;\r\n        }\r\n        validateRouteConfig(config);\r\n        if (!('viewPorts' in config) && !config.navigationStrategy) {\r\n            config.viewPorts = {\r\n                'default': {\r\n                    moduleId: config.moduleId,\r\n                    view: config.view\r\n                }\r\n            };\r\n        }\r\n        if (!navModel) {\r\n            navModel = this.createNavModel(config);\r\n        }\r\n        this.routes.push(config);\r\n        let path = config.route;\r\n        if (path.charAt(0) === '/') {\r\n            path = path.substr(1);\r\n        }\r\n        let caseSensitive = config.caseSensitive === true;\r\n        let state = this._recognizer.add({\r\n            path: path,\r\n            handler: config,\r\n            caseSensitive: caseSensitive\r\n        });\r\n        if (path) {\r\n            let settings = config.settings;\r\n            delete config.settings;\r\n            let withChild = JSON.parse(JSON.stringify(config));\r\n            config.settings = settings;\r\n            withChild.route = `${path}/*childRoute`;\r\n            withChild.hasChildRouter = true;\r\n            this._childRecognizer.add({\r\n                path: withChild.route,\r\n                handler: withChild,\r\n                caseSensitive: caseSensitive\r\n            });\r\n            withChild.navModel = navModel;\r\n            withChild.settings = config.settings;\r\n            withChild.navigationStrategy = config.navigationStrategy;\r\n        }\r\n        config.navModel = navModel;\r\n        let navigation = this.navigation;\r\n        if ((navModel.order || navModel.order === 0) && navigation.indexOf(navModel) === -1) {\r\n            if ((!navModel.href && navModel.href !== '') && (state.types.dynamics || state.types.stars)) {\r\n                throw new Error('Invalid route config for \"' + config.route + '\" : dynamic routes must specify an \"href:\" to be included in the navigation model.');\r\n            }\r\n            if (typeof navModel.order !== 'number') {\r\n                navModel.order = ++this._fallbackOrder;\r\n            }\r\n            navigation.push(navModel);\r\n            // this is a potential error / inconsistency between browsers\r\n            //\r\n            // MDN: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort\r\n            // If compareFunction(a, b) returns 0, leave a and b unchanged with respect to each other,\r\n            // but sorted with respect to all different elements.\r\n            // Note: the ECMAscript standard does not guarantee this behaviour,\r\n            // and thus not all browsers (e.g. Mozilla versions dating back to at least 2003) respect this.\r\n            navigation.sort((a, b) => a.order - b.order);\r\n        }\r\n    }\r\n    /**\r\n     * Gets a value indicating whether or not this [[Router]] or one of its ancestors has a route registered with the specified name.\r\n     *\r\n     * @param name The name of the route to check.\r\n     */\r\n    hasRoute(name) {\r\n        return !!(this._recognizer.hasRoute(name) || this.parent && this.parent.hasRoute(name));\r\n    }\r\n    /**\r\n     * Gets a value indicating whether or not this [[Router]] has a route registered with the specified name.\r\n     *\r\n     * @param name The name of the route to check.\r\n     */\r\n    hasOwnRoute(name) {\r\n        return this._recognizer.hasRoute(name);\r\n    }\r\n    /**\r\n     * Register a handler to use when the incoming URL fragment doesn't match any registered routes.\r\n     *\r\n     * @param config The moduleId, or a function that selects the moduleId, or a [[RouteConfig]].\r\n     */\r\n    handleUnknownRoutes(config) {\r\n        if (!config) {\r\n            throw new Error('Invalid unknown route handler');\r\n        }\r\n        this.catchAllHandler = instruction => {\r\n            return this\r\n                ._createRouteConfig(config, instruction)\r\n                .then(c => {\r\n                instruction.config = c;\r\n                return instruction;\r\n            });\r\n        };\r\n    }\r\n    /**\r\n     * Updates the document title using the current navigation instruction.\r\n     */\r\n    updateTitle() {\r\n        let parentRouter = this.parent;\r\n        if (parentRouter) {\r\n            return parentRouter.updateTitle();\r\n        }\r\n        let currentInstruction = this.currentInstruction;\r\n        if (currentInstruction) {\r\n            currentInstruction._updateTitle();\r\n        }\r\n        return undefined;\r\n    }\r\n    /**\r\n     * Updates the navigation routes with hrefs relative to the current location.\r\n     * Note: This method will likely move to a plugin in a future release.\r\n     */\r\n    refreshNavigation() {\r\n        let nav = this.navigation;\r\n        for (let i = 0, length = nav.length; i < length; i++) {\r\n            let current = nav[i];\r\n            if (!current.config.href) {\r\n                current.href = _createRootedPath(current.relativeHref, this.baseUrl, this.history._hasPushState);\r\n            }\r\n            else {\r\n                current.href = _normalizeAbsolutePath(current.config.href, this.history._hasPushState);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Sets the default configuration for the view ports. This specifies how to\r\n     *  populate a view port for which no module is specified. The default is\r\n     *  an empty view/view-model pair.\r\n     */\r\n    useViewPortDefaults($viewPortDefaults) {\r\n        // a workaround to have strong typings while not requiring to expose interface ViewPortInstruction\r\n        let viewPortDefaults = $viewPortDefaults;\r\n        for (let viewPortName in viewPortDefaults) {\r\n            let viewPortConfig = viewPortDefaults[viewPortName];\r\n            this.viewPortDefaults[viewPortName] = {\r\n                moduleId: viewPortConfig.moduleId\r\n            };\r\n        }\r\n    }\r\n    /**@internal */\r\n    _refreshBaseUrl() {\r\n        let parentRouter = this.parent;\r\n        if (parentRouter) {\r\n            this.baseUrl = generateBaseUrl(parentRouter, parentRouter.currentInstruction);\r\n        }\r\n    }\r\n    /**@internal */\r\n    _createNavigationInstruction(url = '', parentInstruction = null) {\r\n        let fragment = url;\r\n        let queryString = '';\r\n        let queryIndex = url.indexOf('?');\r\n        if (queryIndex !== -1) {\r\n            fragment = url.substr(0, queryIndex);\r\n            queryString = url.substr(queryIndex + 1);\r\n        }\r\n        let urlRecognizationResults = this._recognizer.recognize(url);\r\n        if (!urlRecognizationResults || !urlRecognizationResults.length) {\r\n            urlRecognizationResults = this._childRecognizer.recognize(url);\r\n        }\r\n        let instructionInit = {\r\n            fragment,\r\n            queryString,\r\n            config: null,\r\n            parentInstruction,\r\n            previousInstruction: this.currentInstruction,\r\n            router: this,\r\n            options: {\r\n                compareQueryParams: this.options.compareQueryParams\r\n            }\r\n        };\r\n        let result;\r\n        if (urlRecognizationResults && urlRecognizationResults.length) {\r\n            let first = urlRecognizationResults[0];\r\n            let instruction = new NavigationInstruction(Object.assign({}, instructionInit, {\r\n                params: first.params,\r\n                queryParams: first.queryParams || urlRecognizationResults.queryParams,\r\n                config: first.config || first.handler\r\n            }));\r\n            if (typeof first.handler === 'function') {\r\n                result = evaluateNavigationStrategy(instruction, first.handler, first);\r\n            }\r\n            else if (first.handler && typeof first.handler.navigationStrategy === 'function') {\r\n                result = evaluateNavigationStrategy(instruction, first.handler.navigationStrategy, first.handler);\r\n            }\r\n            else {\r\n                result = Promise.resolve(instruction);\r\n            }\r\n        }\r\n        else if (this.catchAllHandler) {\r\n            let instruction = new NavigationInstruction(Object.assign({}, instructionInit, {\r\n                params: { path: fragment },\r\n                queryParams: urlRecognizationResults ? urlRecognizationResults.queryParams : {},\r\n                config: null // config will be created by the catchAllHandler\r\n            }));\r\n            result = evaluateNavigationStrategy(instruction, this.catchAllHandler);\r\n        }\r\n        else if (this.parent) {\r\n            let router = this._parentCatchAllHandler(this.parent);\r\n            if (router) {\r\n                let newParentInstruction = this._findParentInstructionFromRouter(router, parentInstruction);\r\n                let instruction = new NavigationInstruction(Object.assign({}, instructionInit, {\r\n                    params: { path: fragment },\r\n                    queryParams: urlRecognizationResults ? urlRecognizationResults.queryParams : {},\r\n                    router: router,\r\n                    parentInstruction: newParentInstruction,\r\n                    parentCatchHandler: true,\r\n                    config: null // config will be created by the chained parent catchAllHandler\r\n                }));\r\n                result = evaluateNavigationStrategy(instruction, router.catchAllHandler);\r\n            }\r\n        }\r\n        if (result && parentInstruction) {\r\n            this.baseUrl = generateBaseUrl(this.parent, parentInstruction);\r\n        }\r\n        return result || Promise.reject(new Error(`Route not found: ${url}`));\r\n    }\r\n    /**@internal */\r\n    _findParentInstructionFromRouter(router, instruction) {\r\n        if (instruction.router === router) {\r\n            instruction.fragment = router.baseUrl; // need to change the fragment in case of a redirect instead of moduleId\r\n            return instruction;\r\n        }\r\n        else if (instruction.parentInstruction) {\r\n            return this._findParentInstructionFromRouter(router, instruction.parentInstruction);\r\n        }\r\n        return undefined;\r\n    }\r\n    /**@internal */\r\n    _parentCatchAllHandler(router) {\r\n        if (router.catchAllHandler) {\r\n            return router;\r\n        }\r\n        else if (router.parent) {\r\n            return this._parentCatchAllHandler(router.parent);\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _createRouteConfig(config, instruction) {\r\n        return Promise\r\n            .resolve(config)\r\n            .then((c) => {\r\n            if (typeof c === 'string') {\r\n                return { moduleId: c };\r\n            }\r\n            else if (typeof c === 'function') {\r\n                return c(instruction);\r\n            }\r\n            return c;\r\n        })\r\n            // typing here could be either RouteConfig or RedirectConfig\r\n            // but temporarily treat both as RouteConfig\r\n            // todo: improve typings precision\r\n            .then((c) => typeof c === 'string' ? { moduleId: c } : c)\r\n            .then((c) => {\r\n            c.route = instruction.params.path;\r\n            validateRouteConfig(c);\r\n            if (!c.navModel) {\r\n                c.navModel = this.createNavModel(c);\r\n            }\r\n            return c;\r\n        });\r\n    }\r\n}\r\n/* @internal exported for unit testing */\r\nconst generateBaseUrl = (router, instruction) => {\r\n    return `${router.baseUrl || ''}${instruction.getBaseUrl() || ''}`;\r\n};\r\n/* @internal exported for unit testing */\r\nconst validateRouteConfig = (config) => {\r\n    if (typeof config !== 'object') {\r\n        throw new Error('Invalid Route Config');\r\n    }\r\n    if (typeof config.route !== 'string') {\r\n        let name = config.name || '(no name)';\r\n        throw new Error('Invalid Route Config for \"' + name + '\": You must specify a \"route:\" pattern.');\r\n    }\r\n    if (!('redirect' in config || config.moduleId || config.navigationStrategy || config.viewPorts)) {\r\n        throw new Error('Invalid Route Config for \"' + config.route + '\": You must specify a \"moduleId:\", \"redirect:\", \"navigationStrategy:\", or \"viewPorts:\".');\r\n    }\r\n};\r\n/* @internal exported for unit testing */\r\nconst evaluateNavigationStrategy = (instruction, evaluator, context) => {\r\n    return Promise\r\n        .resolve(evaluator.call(context, instruction))\r\n        .then(() => {\r\n        if (!('viewPorts' in instruction.config)) {\r\n            instruction.config.viewPorts = {\r\n                'default': {\r\n                    moduleId: instruction.config.moduleId\r\n                }\r\n            };\r\n        }\r\n        return instruction;\r\n    });\r\n};\n\n/**@internal exported for unit testing */\r\nconst createNextFn = (instruction, steps) => {\r\n    let index = -1;\r\n    const next = function () {\r\n        index++;\r\n        if (index < steps.length) {\r\n            let currentStep = steps[index];\r\n            try {\r\n                return currentStep(instruction, next);\r\n            }\r\n            catch (e) {\r\n                return next.reject(e);\r\n            }\r\n        }\r\n        else {\r\n            return next.complete();\r\n        }\r\n    };\r\n    next.complete = createCompletionHandler(next, \"completed\" /* Completed */);\r\n    next.cancel = createCompletionHandler(next, \"canceled\" /* Canceled */);\r\n    next.reject = createCompletionHandler(next, \"rejected\" /* Rejected */);\r\n    return next;\r\n};\r\n/**@internal exported for unit testing */\r\nconst createCompletionHandler = (next, status) => {\r\n    return (output) => Promise\r\n        .resolve({\r\n        status,\r\n        output,\r\n        completed: status === \"completed\" /* Completed */\r\n    });\r\n};\n\n/**\r\n * The class responsible for managing and processing the navigation pipeline.\r\n */\r\nclass Pipeline {\r\n    constructor() {\r\n        /**\r\n         * The pipeline steps. And steps added via addStep will be converted to a function\r\n         * The actualy running functions with correct step contexts of this pipeline\r\n         */\r\n        this.steps = [];\r\n    }\r\n    /**\r\n     * Adds a step to the pipeline.\r\n     *\r\n     * @param step The pipeline step.\r\n     */\r\n    addStep(step) {\r\n        let run;\r\n        if (typeof step === 'function') {\r\n            run = step;\r\n        }\r\n        else if (typeof step.getSteps === 'function') {\r\n            // getSteps is to enable support open slots\r\n            // where devs can add multiple steps into the same slot name\r\n            let steps = step.getSteps();\r\n            for (let i = 0, l = steps.length; i < l; i++) {\r\n                this.addStep(steps[i]);\r\n            }\r\n            return this;\r\n        }\r\n        else {\r\n            run = step.run.bind(step);\r\n        }\r\n        this.steps.push(run);\r\n        return this;\r\n    }\r\n    /**\r\n     * Runs the pipeline.\r\n     *\r\n     * @param instruction The navigation instruction to process.\r\n     */\r\n    run(instruction) {\r\n        const nextFn = createNextFn(instruction, this.steps);\r\n        return nextFn();\r\n    }\r\n}\n\n/**\r\n* Determines if the provided object is a navigation command.\r\n* A navigation command is anything with a navigate method.\r\n*\r\n* @param obj The object to check.\r\n*/\r\nfunction isNavigationCommand(obj) {\r\n    return obj && typeof obj.navigate === 'function';\r\n}\r\n/**\r\n* Used during the activation lifecycle to cause a redirect.\r\n*/\r\nclass Redirect {\r\n    /**\r\n     * @param url The URL fragment to use as the navigation destination.\r\n     * @param options The navigation options.\r\n     */\r\n    constructor(url, options = {}) {\r\n        this.url = url;\r\n        this.options = Object.assign({ trigger: true, replace: true }, options);\r\n        this.shouldContinueProcessing = false;\r\n    }\r\n    /**\r\n     * Called by the activation system to set the child router.\r\n     *\r\n     * @param router The router.\r\n     */\r\n    setRouter(router) {\r\n        this.router = router;\r\n    }\r\n    /**\r\n     * Called by the navigation pipeline to navigate.\r\n     *\r\n     * @param appRouter The router to be redirected.\r\n     */\r\n    navigate(appRouter) {\r\n        let navigatingRouter = this.options.useAppRouter ? appRouter : (this.router || appRouter);\r\n        navigatingRouter.navigate(this.url, this.options);\r\n    }\r\n}\r\n/**\r\n * Used during the activation lifecycle to cause a redirect to a named route.\r\n */\r\nclass RedirectToRoute {\r\n    /**\r\n     * @param route The name of the route.\r\n     * @param params The parameters to be sent to the activation method.\r\n     * @param options The options to use for navigation.\r\n     */\r\n    constructor(route, params = {}, options = {}) {\r\n        this.route = route;\r\n        this.params = params;\r\n        this.options = Object.assign({ trigger: true, replace: true }, options);\r\n        this.shouldContinueProcessing = false;\r\n    }\r\n    /**\r\n     * Called by the activation system to set the child router.\r\n     *\r\n     * @param router The router.\r\n     */\r\n    setRouter(router) {\r\n        this.router = router;\r\n    }\r\n    /**\r\n     * Called by the navigation pipeline to navigate.\r\n     *\r\n     * @param appRouter The router to be redirected.\r\n     */\r\n    navigate(appRouter) {\r\n        let navigatingRouter = this.options.useAppRouter ? appRouter : (this.router || appRouter);\r\n        navigatingRouter.navigateToRoute(this.route, this.params, this.options);\r\n    }\r\n}\n\n/**\r\n * @internal exported for unit testing\r\n */\r\nfunction _buildNavigationPlan(instruction, forceLifecycleMinimum) {\r\n    let config = instruction.config;\r\n    if ('redirect' in config) {\r\n        return buildRedirectPlan(instruction);\r\n    }\r\n    const prevInstruction = instruction.previousInstruction;\r\n    const defaultViewPortConfigs = instruction.router.viewPortDefaults;\r\n    if (prevInstruction) {\r\n        return buildTransitionPlans(instruction, prevInstruction, defaultViewPortConfigs, forceLifecycleMinimum);\r\n    }\r\n    // first navigation, only need to prepare a few information for each viewport plan\r\n    const viewPortPlans = {};\r\n    let viewPortConfigs = config.viewPorts;\r\n    for (let viewPortName in viewPortConfigs) {\r\n        let viewPortConfig = viewPortConfigs[viewPortName];\r\n        if (viewPortConfig.moduleId === null && viewPortName in defaultViewPortConfigs) {\r\n            viewPortConfig = defaultViewPortConfigs[viewPortName];\r\n        }\r\n        viewPortPlans[viewPortName] = {\r\n            name: viewPortName,\r\n            strategy: \"replace\" /* Replace */,\r\n            config: viewPortConfig\r\n        };\r\n    }\r\n    return Promise.resolve(viewPortPlans);\r\n}\r\n/**\r\n * Build redirect plan based on config of a navigation instruction\r\n * @internal exported for unit testing\r\n */\r\nconst buildRedirectPlan = (instruction) => {\r\n    const config = instruction.config;\r\n    const router = instruction.router;\r\n    return router\r\n        ._createNavigationInstruction(config.redirect)\r\n        .then(redirectInstruction => {\r\n        const params = {};\r\n        const originalInstructionParams = instruction.params;\r\n        const redirectInstructionParams = redirectInstruction.params;\r\n        for (let key in redirectInstructionParams) {\r\n            // If the param on the redirect points to another param, e.g. { route: first/:this, redirect: second/:this }\r\n            let val = redirectInstructionParams[key];\r\n            if (typeof val === 'string' && val[0] === ':') {\r\n                val = val.slice(1);\r\n                // And if that param is found on the original instruction then use it\r\n                if (val in originalInstructionParams) {\r\n                    params[key] = originalInstructionParams[val];\r\n                }\r\n            }\r\n            else {\r\n                params[key] = redirectInstructionParams[key];\r\n            }\r\n        }\r\n        let redirectLocation = router.generate(redirectInstruction.config, params, instruction.options);\r\n        // Special handling for child routes\r\n        for (let key in originalInstructionParams) {\r\n            redirectLocation = redirectLocation.replace(`:${key}`, originalInstructionParams[key]);\r\n        }\r\n        let queryString = instruction.queryString;\r\n        if (queryString) {\r\n            redirectLocation += '?' + queryString;\r\n        }\r\n        return Promise.resolve(new Redirect(redirectLocation));\r\n    });\r\n};\r\n/**\r\n * @param viewPortPlans the Plan record that holds information about built plans\r\n * @internal exported for unit testing\r\n */\r\nconst buildTransitionPlans = (currentInstruction, previousInstruction, defaultViewPortConfigs, forceLifecycleMinimum) => {\r\n    let viewPortPlans = {};\r\n    let newInstructionConfig = currentInstruction.config;\r\n    let hasNewParams = hasDifferentParameterValues(previousInstruction, currentInstruction);\r\n    let pending = [];\r\n    let previousViewPortInstructions = previousInstruction.viewPortInstructions;\r\n    for (let viewPortName in previousViewPortInstructions) {\r\n        const prevViewPortInstruction = previousViewPortInstructions[viewPortName];\r\n        const prevViewPortComponent = prevViewPortInstruction.component;\r\n        const newInstructionViewPortConfigs = newInstructionConfig.viewPorts;\r\n        // if this is invoked on a viewport without any changes, based on new url,\r\n        // newViewPortConfig will be the existing viewport instruction\r\n        let nextViewPortConfig = viewPortName in newInstructionViewPortConfigs\r\n            ? newInstructionViewPortConfigs[viewPortName]\r\n            : prevViewPortInstruction;\r\n        if (nextViewPortConfig.moduleId === null && viewPortName in defaultViewPortConfigs) {\r\n            nextViewPortConfig = defaultViewPortConfigs[viewPortName];\r\n        }\r\n        const viewPortActivationStrategy = determineActivationStrategy(currentInstruction, prevViewPortInstruction, nextViewPortConfig, hasNewParams, forceLifecycleMinimum);\r\n        const viewPortPlan = viewPortPlans[viewPortName] = {\r\n            name: viewPortName,\r\n            // ViewPortInstruction can quack like a RouteConfig\r\n            config: nextViewPortConfig,\r\n            prevComponent: prevViewPortComponent,\r\n            prevModuleId: prevViewPortInstruction.moduleId,\r\n            strategy: viewPortActivationStrategy\r\n        };\r\n        // recursively build nav plans for all existing child routers/viewports of this viewport\r\n        // this is possible because existing child viewports and routers already have necessary information\r\n        // to process the wildcard path from parent instruction\r\n        if (viewPortActivationStrategy !== \"replace\" /* Replace */ && prevViewPortInstruction.childRouter) {\r\n            const path = currentInstruction.getWildcardPath();\r\n            const task = prevViewPortInstruction\r\n                .childRouter\r\n                ._createNavigationInstruction(path, currentInstruction)\r\n                .then((childInstruction) => {\r\n                viewPortPlan.childNavigationInstruction = childInstruction;\r\n                return _buildNavigationPlan(childInstruction, \r\n                // is it safe to assume viewPortPlan has not been changed from previous assignment?\r\n                // if so, can just use local variable viewPortPlanStrategy\r\n                // there could be user code modifying viewport plan during _createNavigationInstruction?\r\n                viewPortPlan.strategy === \"invoke-lifecycle\" /* InvokeLifecycle */)\r\n                    .then(childPlan => {\r\n                    if (childPlan instanceof Redirect) {\r\n                        return Promise.reject(childPlan);\r\n                    }\r\n                    childInstruction.plan = childPlan;\r\n                    // for bluebird ?\r\n                    return null;\r\n                });\r\n            });\r\n            pending.push(task);\r\n        }\r\n    }\r\n    return Promise.all(pending).then(() => viewPortPlans);\r\n};\r\n/**\r\n * @param newViewPortConfig if this is invoked on a viewport without any changes, based on new url, newViewPortConfig will be the existing viewport instruction\r\n * @internal exported for unit testing\r\n */\r\nconst determineActivationStrategy = (currentNavInstruction, prevViewPortInstruction, newViewPortConfig, \r\n// indicates whether there is difference between old and new url params\r\nhasNewParams, forceLifecycleMinimum) => {\r\n    let newInstructionConfig = currentNavInstruction.config;\r\n    let prevViewPortViewModel = prevViewPortInstruction.component.viewModel;\r\n    let viewPortPlanStrategy;\r\n    if (prevViewPortInstruction.moduleId !== newViewPortConfig.moduleId) {\r\n        viewPortPlanStrategy = \"replace\" /* Replace */;\r\n    }\r\n    else if ('determineActivationStrategy' in prevViewPortViewModel) {\r\n        viewPortPlanStrategy = prevViewPortViewModel.determineActivationStrategy(...currentNavInstruction.lifecycleArgs);\r\n    }\r\n    else if (newInstructionConfig.activationStrategy) {\r\n        viewPortPlanStrategy = newInstructionConfig.activationStrategy;\r\n    }\r\n    else if (hasNewParams || forceLifecycleMinimum) {\r\n        viewPortPlanStrategy = \"invoke-lifecycle\" /* InvokeLifecycle */;\r\n    }\r\n    else {\r\n        viewPortPlanStrategy = \"no-change\" /* NoChange */;\r\n    }\r\n    return viewPortPlanStrategy;\r\n};\r\n/**@internal exported for unit testing */\r\nconst hasDifferentParameterValues = (prev, next) => {\r\n    let prevParams = prev.params;\r\n    let nextParams = next.params;\r\n    let nextWildCardName = next.config.hasChildRouter ? next.getWildCardName() : null;\r\n    for (let key in nextParams) {\r\n        if (key === nextWildCardName) {\r\n            continue;\r\n        }\r\n        if (prevParams[key] !== nextParams[key]) {\r\n            return true;\r\n        }\r\n    }\r\n    for (let key in prevParams) {\r\n        if (key === nextWildCardName) {\r\n            continue;\r\n        }\r\n        if (prevParams[key] !== nextParams[key]) {\r\n            return true;\r\n        }\r\n    }\r\n    if (!next.options.compareQueryParams) {\r\n        return false;\r\n    }\r\n    let prevQueryParams = prev.queryParams;\r\n    let nextQueryParams = next.queryParams;\r\n    for (let key in nextQueryParams) {\r\n        if (prevQueryParams[key] !== nextQueryParams[key]) {\r\n            return true;\r\n        }\r\n    }\r\n    for (let key in prevQueryParams) {\r\n        if (prevQueryParams[key] !== nextQueryParams[key]) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n};\n\n/**\r\n * Transform a navigation instruction into viewport plan record object,\r\n * or a redirect request if user viewmodel demands\r\n */\r\nclass BuildNavigationPlanStep {\r\n    run(navigationInstruction, next) {\r\n        return _buildNavigationPlan(navigationInstruction)\r\n            .then(plan => {\r\n            if (plan instanceof Redirect) {\r\n                return next.cancel(plan);\r\n            }\r\n            navigationInstruction.plan = plan;\r\n            return next();\r\n        })\r\n            .catch(next.cancel);\r\n    }\r\n}\n\n/**\r\n * @internal Exported for unit testing\r\n */\r\nconst loadNewRoute = (routeLoader, navigationInstruction) => {\r\n    let loadingPlans = determineLoadingPlans(navigationInstruction);\r\n    let loadPromises = loadingPlans.map((loadingPlan) => loadRoute(routeLoader, loadingPlan.navigationInstruction, loadingPlan.viewPortPlan));\r\n    return Promise.all(loadPromises);\r\n};\r\n/**\r\n * @internal Exported for unit testing\r\n */\r\nconst determineLoadingPlans = (navigationInstruction, loadingPlans = []) => {\r\n    let viewPortPlans = navigationInstruction.plan;\r\n    for (let viewPortName in viewPortPlans) {\r\n        let viewPortPlan = viewPortPlans[viewPortName];\r\n        let childNavInstruction = viewPortPlan.childNavigationInstruction;\r\n        if (viewPortPlan.strategy === \"replace\" /* Replace */) {\r\n            loadingPlans.push({ viewPortPlan, navigationInstruction });\r\n            if (childNavInstruction) {\r\n                determineLoadingPlans(childNavInstruction, loadingPlans);\r\n            }\r\n        }\r\n        else {\r\n            let viewPortInstruction = navigationInstruction.addViewPortInstruction({\r\n                name: viewPortName,\r\n                strategy: viewPortPlan.strategy,\r\n                moduleId: viewPortPlan.prevModuleId,\r\n                component: viewPortPlan.prevComponent\r\n            });\r\n            if (childNavInstruction) {\r\n                viewPortInstruction.childNavigationInstruction = childNavInstruction;\r\n                determineLoadingPlans(childNavInstruction, loadingPlans);\r\n            }\r\n        }\r\n    }\r\n    return loadingPlans;\r\n};\r\n/**\r\n * @internal Exported for unit testing\r\n */\r\nconst loadRoute = (routeLoader, navigationInstruction, viewPortPlan) => {\r\n    let planConfig = viewPortPlan.config;\r\n    let moduleId = planConfig ? planConfig.moduleId : null;\r\n    return loadComponent(routeLoader, navigationInstruction, planConfig)\r\n        .then((component) => {\r\n        let viewPortInstruction = navigationInstruction.addViewPortInstruction({\r\n            name: viewPortPlan.name,\r\n            strategy: viewPortPlan.strategy,\r\n            moduleId: moduleId,\r\n            component: component\r\n        });\r\n        let childRouter = component.childRouter;\r\n        if (childRouter) {\r\n            let path = navigationInstruction.getWildcardPath();\r\n            return childRouter\r\n                ._createNavigationInstruction(path, navigationInstruction)\r\n                .then((childInstruction) => {\r\n                viewPortPlan.childNavigationInstruction = childInstruction;\r\n                return _buildNavigationPlan(childInstruction)\r\n                    .then((childPlan) => {\r\n                    if (childPlan instanceof Redirect) {\r\n                        return Promise.reject(childPlan);\r\n                    }\r\n                    childInstruction.plan = childPlan;\r\n                    viewPortInstruction.childNavigationInstruction = childInstruction;\r\n                    return loadNewRoute(routeLoader, childInstruction);\r\n                });\r\n            });\r\n        }\r\n        // ts complains without this, though they are same\r\n        return void 0;\r\n    });\r\n};\r\n/**\r\n * Load a routed-component based on navigation instruction and route config\r\n * @internal exported for unit testing only\r\n */\r\nconst loadComponent = (routeLoader, navigationInstruction, config) => {\r\n    let router = navigationInstruction.router;\r\n    let lifecycleArgs = navigationInstruction.lifecycleArgs;\r\n    return Promise.resolve()\r\n        .then(() => routeLoader.loadRoute(router, config, navigationInstruction))\r\n        .then(\r\n    /**\r\n     * @param component an object carrying information about loaded route\r\n     * typically contains information about view model, childContainer, view and router\r\n     */\r\n    (component) => {\r\n        let { viewModel, childContainer } = component;\r\n        component.router = router;\r\n        component.config = config;\r\n        if ('configureRouter' in viewModel) {\r\n            let childRouter = childContainer.getChildRouter();\r\n            component.childRouter = childRouter;\r\n            return childRouter\r\n                .configure(c => viewModel.configureRouter(c, childRouter, lifecycleArgs[0], lifecycleArgs[1], lifecycleArgs[2]))\r\n                .then(() => component);\r\n        }\r\n        return component;\r\n    });\r\n};\n\n/**\r\n * Abstract class that is responsible for loading view / view model from a route config\r\n * The default implementation can be found in `aurelia-templating-router`\r\n */\r\nclass RouteLoader {\r\n    /**\r\n     * Load a route config based on its viewmodel / view configuration\r\n     */\r\n    // return typing: return typings used to be never\r\n    // as it was a throw. Changing it to Promise<any> should not cause any issues\r\n    loadRoute(router, config, navigationInstruction) {\r\n        throw new Error('Route loaders must implement \"loadRoute(router, config, navigationInstruction)\".');\r\n    }\r\n}\n\n/**\r\n * A pipeline step responsible for loading a route config of a navigation instruction\r\n */\r\nclass LoadRouteStep {\r\n    /**@internal */\r\n    static inject() { return [RouteLoader]; }\r\n    constructor(routeLoader) {\r\n        this.routeLoader = routeLoader;\r\n    }\r\n    /**\r\n     * Run the internal to load route config of a navigation instruction to prepare for next steps in the pipeline\r\n     */\r\n    run(navigationInstruction, next) {\r\n        return loadNewRoute(this.routeLoader, navigationInstruction)\r\n            .then(next, next.cancel);\r\n    }\r\n}\n\n/**\r\n * A pipeline step for instructing a piepline to commit changes on a navigation instruction\r\n */\r\nclass CommitChangesStep {\r\n    run(navigationInstruction, next) {\r\n        return navigationInstruction\r\n            ._commitChanges(/*wait to swap?*/ true)\r\n            .then(() => {\r\n            navigationInstruction._updateTitle();\r\n            return next();\r\n        });\r\n    }\r\n}\n\n/**\r\n * An optional interface describing the available activation strategies.\r\n * @internal Used internally.\r\n */\r\nvar InternalActivationStrategy;\r\n(function (InternalActivationStrategy) {\r\n    /**\r\n     * Reuse the existing view model, without invoking Router lifecycle hooks.\r\n     */\r\n    InternalActivationStrategy[\"NoChange\"] = \"no-change\";\r\n    /**\r\n     * Reuse the existing view model, invoking Router lifecycle hooks.\r\n     */\r\n    InternalActivationStrategy[\"InvokeLifecycle\"] = \"invoke-lifecycle\";\r\n    /**\r\n     * Replace the existing view model, invoking Router lifecycle hooks.\r\n     */\r\n    InternalActivationStrategy[\"Replace\"] = \"replace\";\r\n})(InternalActivationStrategy || (InternalActivationStrategy = {}));\r\n/**\r\n * The strategy to use when activating modules during navigation.\r\n */\r\n// kept for compat reason\r\nconst activationStrategy = {\r\n    noChange: \"no-change\" /* NoChange */,\r\n    invokeLifecycle: \"invoke-lifecycle\" /* InvokeLifecycle */,\r\n    replace: \"replace\" /* Replace */\r\n};\n\n/**\r\n * Recursively find list of deactivate-able view models\r\n * and invoke the either 'canDeactivate' or 'deactivate' on each\r\n * @internal exported for unit testing\r\n */\r\nconst processDeactivatable = (navigationInstruction, callbackName, next, ignoreResult) => {\r\n    let plan = navigationInstruction.plan;\r\n    let infos = findDeactivatable(plan, callbackName);\r\n    let i = infos.length; // query from inside out\r\n    function inspect(val) {\r\n        if (ignoreResult || shouldContinue(val)) {\r\n            return iterate();\r\n        }\r\n        return next.cancel(val);\r\n    }\r\n    function iterate() {\r\n        if (i--) {\r\n            try {\r\n                let viewModel = infos[i];\r\n                let result = viewModel[callbackName](navigationInstruction);\r\n                return processPotential(result, inspect, next.cancel);\r\n            }\r\n            catch (error) {\r\n                return next.cancel(error);\r\n            }\r\n        }\r\n        navigationInstruction.router.couldDeactivate = true;\r\n        return next();\r\n    }\r\n    return iterate();\r\n};\r\n/**\r\n * Recursively find and returns a list of deactivate-able view models\r\n * @internal exported for unit testing\r\n */\r\nconst findDeactivatable = (plan, callbackName, list = []) => {\r\n    for (let viewPortName in plan) {\r\n        let viewPortPlan = plan[viewPortName];\r\n        let prevComponent = viewPortPlan.prevComponent;\r\n        if ((viewPortPlan.strategy === activationStrategy.invokeLifecycle || viewPortPlan.strategy === activationStrategy.replace)\r\n            && prevComponent) {\r\n            let viewModel = prevComponent.viewModel;\r\n            if (callbackName in viewModel) {\r\n                list.push(viewModel);\r\n            }\r\n        }\r\n        if (viewPortPlan.strategy === activationStrategy.replace && prevComponent) {\r\n            addPreviousDeactivatable(prevComponent, callbackName, list);\r\n        }\r\n        else if (viewPortPlan.childNavigationInstruction) {\r\n            findDeactivatable(viewPortPlan.childNavigationInstruction.plan, callbackName, list);\r\n        }\r\n    }\r\n    return list;\r\n};\r\n/**\r\n * @internal exported for unit testing\r\n */\r\nconst addPreviousDeactivatable = (component, callbackName, list) => {\r\n    let childRouter = component.childRouter;\r\n    if (childRouter && childRouter.currentInstruction) {\r\n        let viewPortInstructions = childRouter.currentInstruction.viewPortInstructions;\r\n        for (let viewPortName in viewPortInstructions) {\r\n            let viewPortInstruction = viewPortInstructions[viewPortName];\r\n            let prevComponent = viewPortInstruction.component;\r\n            let prevViewModel = prevComponent.viewModel;\r\n            if (callbackName in prevViewModel) {\r\n                list.push(prevViewModel);\r\n            }\r\n            addPreviousDeactivatable(prevComponent, callbackName, list);\r\n        }\r\n    }\r\n};\r\n/**\r\n * @internal exported for unit testing\r\n */\r\nconst processActivatable = (navigationInstruction, callbackName, next, ignoreResult) => {\r\n    let infos = findActivatable(navigationInstruction, callbackName);\r\n    let length = infos.length;\r\n    let i = -1; // query from top down\r\n    function inspect(val, router) {\r\n        if (ignoreResult || shouldContinue(val, router)) {\r\n            return iterate();\r\n        }\r\n        return next.cancel(val);\r\n    }\r\n    function iterate() {\r\n        i++;\r\n        if (i < length) {\r\n            try {\r\n                let current = infos[i];\r\n                let result = current.viewModel[callbackName](...current.lifecycleArgs);\r\n                return processPotential(result, (val) => inspect(val, current.router), next.cancel);\r\n            }\r\n            catch (error) {\r\n                return next.cancel(error);\r\n            }\r\n        }\r\n        return next();\r\n    }\r\n    return iterate();\r\n};\r\n/**\r\n * Find list of activatable view model and add to list (3rd parameter)\r\n * @internal exported for unit testing\r\n */\r\nconst findActivatable = (navigationInstruction, callbackName, list = [], router) => {\r\n    let plan = navigationInstruction.plan;\r\n    Object\r\n        .keys(plan)\r\n        .forEach((viewPortName) => {\r\n        let viewPortPlan = plan[viewPortName];\r\n        let viewPortInstruction = navigationInstruction.viewPortInstructions[viewPortName];\r\n        let viewPortComponent = viewPortInstruction.component;\r\n        let viewModel = viewPortComponent.viewModel;\r\n        if ((viewPortPlan.strategy === activationStrategy.invokeLifecycle\r\n            || viewPortPlan.strategy === activationStrategy.replace)\r\n            && callbackName in viewModel) {\r\n            list.push({\r\n                viewModel,\r\n                lifecycleArgs: viewPortInstruction.lifecycleArgs,\r\n                router\r\n            });\r\n        }\r\n        let childNavInstruction = viewPortPlan.childNavigationInstruction;\r\n        if (childNavInstruction) {\r\n            findActivatable(childNavInstruction, callbackName, list, viewPortComponent.childRouter || router);\r\n        }\r\n    });\r\n    return list;\r\n};\r\nconst shouldContinue = (output, router) => {\r\n    if (output instanceof Error) {\r\n        return false;\r\n    }\r\n    if (isNavigationCommand(output)) {\r\n        if (typeof output.setRouter === 'function') {\r\n            output.setRouter(router);\r\n        }\r\n        return !!output.shouldContinueProcessing;\r\n    }\r\n    if (output === undefined) {\r\n        return true;\r\n    }\r\n    return output;\r\n};\r\n/**\r\n * wraps a subscription, allowing unsubscribe calls even if\r\n * the first value comes synchronously\r\n */\r\nclass SafeSubscription {\r\n    constructor(subscriptionFunc) {\r\n        this._subscribed = true;\r\n        this._subscription = subscriptionFunc(this);\r\n        if (!this._subscribed) {\r\n            this.unsubscribe();\r\n        }\r\n    }\r\n    get subscribed() {\r\n        return this._subscribed;\r\n    }\r\n    unsubscribe() {\r\n        if (this._subscribed && this._subscription) {\r\n            this._subscription.unsubscribe();\r\n        }\r\n        this._subscribed = false;\r\n    }\r\n}\r\n/**\r\n * A function to process return value from `activate`/`canActivate` steps\r\n * Supports observable/promise\r\n *\r\n * For observable, resolve at first next() or on complete()\r\n */\r\nconst processPotential = (obj, resolve, reject) => {\r\n    // if promise like\r\n    if (obj && typeof obj.then === 'function') {\r\n        return Promise.resolve(obj).then(resolve).catch(reject);\r\n    }\r\n    // if observable\r\n    if (obj && typeof obj.subscribe === 'function') {\r\n        let obs = obj;\r\n        return new SafeSubscription(sub => obs.subscribe({\r\n            next() {\r\n                if (sub.subscribed) {\r\n                    sub.unsubscribe();\r\n                    resolve(obj);\r\n                }\r\n            },\r\n            error(error) {\r\n                if (sub.subscribed) {\r\n                    sub.unsubscribe();\r\n                    reject(error);\r\n                }\r\n            },\r\n            complete() {\r\n                if (sub.subscribed) {\r\n                    sub.unsubscribe();\r\n                    resolve(obj);\r\n                }\r\n            }\r\n        }));\r\n    }\r\n    // else just resolve\r\n    try {\r\n        return resolve(obj);\r\n    }\r\n    catch (error) {\r\n        return reject(error);\r\n    }\r\n};\n\n/**\r\n * A pipeline step responsible for finding and activating method `canDeactivate` on a view model of a route\r\n */\r\nclass CanDeactivatePreviousStep {\r\n    run(navigationInstruction, next) {\r\n        return processDeactivatable(navigationInstruction, 'canDeactivate', next);\r\n    }\r\n}\r\n/**\r\n * A pipeline step responsible for finding and activating method `canActivate` on a view model of a route\r\n */\r\nclass CanActivateNextStep {\r\n    run(navigationInstruction, next) {\r\n        return processActivatable(navigationInstruction, 'canActivate', next);\r\n    }\r\n}\r\n/**\r\n * A pipeline step responsible for finding and activating method `deactivate` on a view model of a route\r\n */\r\nclass DeactivatePreviousStep {\r\n    run(navigationInstruction, next) {\r\n        return processDeactivatable(navigationInstruction, 'deactivate', next, true);\r\n    }\r\n}\r\n/**\r\n * A pipeline step responsible for finding and activating method `activate` on a view model of a route\r\n */\r\nclass ActivateNextStep {\r\n    run(navigationInstruction, next) {\r\n        return processActivatable(navigationInstruction, 'activate', next, true);\r\n    }\r\n}\n\n/**\r\n * A multi-slots Pipeline Placeholder Step for hooking into a pipeline execution\r\n */\r\nclass PipelineSlot {\r\n    constructor(container, name, alias) {\r\n        this.steps = [];\r\n        this.container = container;\r\n        this.slotName = name;\r\n        this.slotAlias = alias;\r\n    }\r\n    getSteps() {\r\n        return this.steps.map(x => this.container.get(x));\r\n    }\r\n}\r\n/**\r\n * Class responsible for creating the navigation pipeline.\r\n */\r\nclass PipelineProvider {\r\n    /**@internal */\r\n    static inject() { return [aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"Container\"]]; }\r\n    constructor(container) {\r\n        this.container = container;\r\n        this.steps = [\r\n            BuildNavigationPlanStep,\r\n            CanDeactivatePreviousStep,\r\n            LoadRouteStep,\r\n            createPipelineSlot(container, \"authorize\" /* Authorize */),\r\n            CanActivateNextStep,\r\n            createPipelineSlot(container, \"preActivate\" /* PreActivate */, 'modelbind'),\r\n            // NOTE: app state changes start below - point of no return\r\n            DeactivatePreviousStep,\r\n            ActivateNextStep,\r\n            createPipelineSlot(container, \"preRender\" /* PreRender */, 'precommit'),\r\n            CommitChangesStep,\r\n            createPipelineSlot(container, \"postRender\" /* PostRender */, 'postcomplete')\r\n        ];\r\n    }\r\n    /**\r\n     * Create the navigation pipeline.\r\n     */\r\n    createPipeline(useCanDeactivateStep = true) {\r\n        let pipeline = new Pipeline();\r\n        this.steps.forEach(step => {\r\n            if (useCanDeactivateStep || step !== CanDeactivatePreviousStep) {\r\n                pipeline.addStep(this.container.get(step));\r\n            }\r\n        });\r\n        return pipeline;\r\n    }\r\n    /**@internal */\r\n    _findStep(name) {\r\n        // Steps that are not PipelineSlots are constructor functions, and they will automatically fail. Probably.\r\n        return this.steps.find(x => x.slotName === name || x.slotAlias === name);\r\n    }\r\n    /**\r\n     * Adds a step into the pipeline at a known slot location.\r\n     */\r\n    addStep(name, step) {\r\n        let found = this._findStep(name);\r\n        if (found) {\r\n            let slotSteps = found.steps;\r\n            // prevent duplicates\r\n            if (!slotSteps.includes(step)) {\r\n                slotSteps.push(step);\r\n            }\r\n        }\r\n        else {\r\n            throw new Error(`Invalid pipeline slot name: ${name}.`);\r\n        }\r\n    }\r\n    /**\r\n     * Removes a step from a slot in the pipeline\r\n     */\r\n    removeStep(name, step) {\r\n        let slot = this._findStep(name);\r\n        if (slot) {\r\n            let slotSteps = slot.steps;\r\n            slotSteps.splice(slotSteps.indexOf(step), 1);\r\n        }\r\n    }\r\n    /**\r\n     * Clears all steps from a slot in the pipeline\r\n     * @internal\r\n     */\r\n    _clearSteps(name = '') {\r\n        let slot = this._findStep(name);\r\n        if (slot) {\r\n            slot.steps = [];\r\n        }\r\n    }\r\n    /**\r\n     * Resets all pipeline slots\r\n     */\r\n    reset() {\r\n        this._clearSteps(\"authorize\" /* Authorize */);\r\n        this._clearSteps(\"preActivate\" /* PreActivate */);\r\n        this._clearSteps(\"preRender\" /* PreRender */);\r\n        this._clearSteps(\"postRender\" /* PostRender */);\r\n    }\r\n}\r\n/**@internal */\r\nconst createPipelineSlot = (container, name, alias) => {\r\n    return new PipelineSlot(container, name, alias);\r\n};\n\nconst logger = Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"])('app-router');\r\n/**\r\n * The main application router.\r\n */\r\nclass AppRouter extends Router {\r\n    /**@internal */\r\n    static inject() { return [aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"Container\"], aurelia_history__WEBPACK_IMPORTED_MODULE_2__[\"History\"], PipelineProvider, aurelia_event_aggregator__WEBPACK_IMPORTED_MODULE_4__[\"EventAggregator\"]]; }\r\n    constructor(container, history, pipelineProvider, events) {\r\n        super(container, history); // Note the super will call reset internally.\r\n        this.pipelineProvider = pipelineProvider;\r\n        this.events = events;\r\n    }\r\n    /**\r\n     * Fully resets the router's internal state. Primarily used internally by the framework when multiple calls to setRoot are made.\r\n     * Use with caution (actually, avoid using this). Do not use this to simply change your navigation model.\r\n     */\r\n    reset() {\r\n        super.reset();\r\n        this.maxInstructionCount = 10;\r\n        if (!this._queue) {\r\n            this._queue = [];\r\n        }\r\n        else {\r\n            this._queue.length = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Loads the specified URL.\r\n     *\r\n     * @param url The URL fragment to load.\r\n     */\r\n    loadUrl(url) {\r\n        return this\r\n            ._createNavigationInstruction(url)\r\n            .then(instruction => this._queueInstruction(instruction))\r\n            .catch(error => {\r\n            logger.error(error);\r\n            restorePreviousLocation(this);\r\n        });\r\n    }\r\n    /**\r\n     * Registers a viewPort to be used as a rendering target for activated routes.\r\n     *\r\n     * @param viewPort The viewPort. This is typically a <router-view/> element in Aurelia default impl\r\n     * @param name The name of the viewPort. 'default' if unspecified.\r\n     */\r\n    registerViewPort(viewPort, name) {\r\n        // having strong typing without changing public API\r\n        const $viewPort = viewPort;\r\n        super.registerViewPort($viewPort, name);\r\n        // beside adding viewport to the registry of this instance\r\n        // AppRouter also configure routing/history to start routing functionality\r\n        // There are situation where there are more than 1 <router-view/> element at root view\r\n        // in that case, still only activate once via the following guard\r\n        if (!this.isActive) {\r\n            const viewModel = this._findViewModel($viewPort);\r\n            if ('configureRouter' in viewModel) {\r\n                // If there are more than one <router-view/> element at root view\r\n                // use this flag to guard against configure method being invoked multiple times\r\n                // this flag is set inside method configure\r\n                if (!this.isConfigured) {\r\n                    // replace the real resolve with a noop to guarantee that any action in base class Router\r\n                    // won't resolve the configurePromise prematurely\r\n                    const resolveConfiguredPromise = this._resolveConfiguredPromise;\r\n                    this._resolveConfiguredPromise = () => { };\r\n                    return this\r\n                        .configure(config => Promise\r\n                        .resolve(viewModel.configureRouter(config, this))\r\n                        // an issue with configure interface. Should be fixed there\r\n                        // todo: fix this via configure interface in router\r\n                        .then(() => config))\r\n                        .then(() => {\r\n                        this.activate();\r\n                        resolveConfiguredPromise();\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                this.activate();\r\n            }\r\n        }\r\n        // when a viewport is added dynamically to a root view that is already activated\r\n        // just process the navigation instruction\r\n        else {\r\n            this._dequeueInstruction();\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    /**\r\n     * Activates the router. This instructs the router to begin listening for history changes and processing instructions.\r\n     *\r\n     * @params options The set of options to activate the router with.\r\n     */\r\n    activate(options) {\r\n        if (this.isActive) {\r\n            return;\r\n        }\r\n        this.isActive = true;\r\n        // route handler property is responsible for handling url change\r\n        // the interface of aurelia-history isn't clear on this perspective\r\n        this.options = Object.assign({ routeHandler: this.loadUrl.bind(this) }, this.options, options);\r\n        this.history.activate(this.options);\r\n        this._dequeueInstruction();\r\n    }\r\n    /**\r\n     * Deactivates the router.\r\n     */\r\n    deactivate() {\r\n        this.isActive = false;\r\n        this.history.deactivate();\r\n    }\r\n    /**@internal */\r\n    _queueInstruction(instruction) {\r\n        return new Promise((resolve) => {\r\n            instruction.resolve = resolve;\r\n            this._queue.unshift(instruction);\r\n            this._dequeueInstruction();\r\n        });\r\n    }\r\n    /**@internal */\r\n    _dequeueInstruction(instructionCount = 0) {\r\n        return Promise.resolve().then(() => {\r\n            if (this.isNavigating && !instructionCount) {\r\n                // ts complains about inconsistent returns without void 0\r\n                return void 0;\r\n            }\r\n            let instruction = this._queue.shift();\r\n            this._queue.length = 0;\r\n            if (!instruction) {\r\n                // ts complains about inconsistent returns without void 0\r\n                return void 0;\r\n            }\r\n            this.isNavigating = true;\r\n            let navtracker = this.history.getState('NavigationTracker');\r\n            let currentNavTracker = this.currentNavigationTracker;\r\n            if (!navtracker && !currentNavTracker) {\r\n                this.isNavigatingFirst = true;\r\n                this.isNavigatingNew = true;\r\n            }\r\n            else if (!navtracker) {\r\n                this.isNavigatingNew = true;\r\n            }\r\n            else if (!currentNavTracker) {\r\n                this.isNavigatingRefresh = true;\r\n            }\r\n            else if (currentNavTracker < navtracker) {\r\n                this.isNavigatingForward = true;\r\n            }\r\n            else if (currentNavTracker > navtracker) {\r\n                this.isNavigatingBack = true;\r\n            }\r\n            if (!navtracker) {\r\n                navtracker = Date.now();\r\n                this.history.setState('NavigationTracker', navtracker);\r\n            }\r\n            this.currentNavigationTracker = navtracker;\r\n            instruction.previousInstruction = this.currentInstruction;\r\n            let maxInstructionCount = this.maxInstructionCount;\r\n            if (!instructionCount) {\r\n                this.events.publish(\"router:navigation:processing\" /* Processing */, { instruction });\r\n            }\r\n            else if (instructionCount === maxInstructionCount - 1) {\r\n                logger.error(`${instructionCount + 1} navigation instructions have been attempted without success. Restoring last known good location.`);\r\n                restorePreviousLocation(this);\r\n                return this._dequeueInstruction(instructionCount + 1);\r\n            }\r\n            else if (instructionCount > maxInstructionCount) {\r\n                throw new Error('Maximum navigation attempts exceeded. Giving up.');\r\n            }\r\n            let pipeline = this.pipelineProvider.createPipeline(!this.couldDeactivate);\r\n            return pipeline\r\n                .run(instruction)\r\n                .then(result => processResult(instruction, result, instructionCount, this))\r\n                .catch(error => {\r\n                return { output: error instanceof Error ? error : new Error(error) };\r\n            })\r\n                .then(result => resolveInstruction(instruction, result, !!instructionCount, this));\r\n        });\r\n    }\r\n    /**@internal */\r\n    _findViewModel(viewPort) {\r\n        if (this.container.viewModel) {\r\n            return this.container.viewModel;\r\n        }\r\n        if (viewPort.container) {\r\n            let container = viewPort.container;\r\n            while (container) {\r\n                if (container.viewModel) {\r\n                    this.container.viewModel = container.viewModel;\r\n                    return container.viewModel;\r\n                }\r\n                container = container.parent;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\nconst processResult = (instruction, result, instructionCount, router) => {\r\n    if (!(result && 'completed' in result && 'output' in result)) {\r\n        result = result || {};\r\n        result.output = new Error(`Expected router pipeline to return a navigation result, but got [${JSON.stringify(result)}] instead.`);\r\n    }\r\n    let finalResult = null;\r\n    let navigationCommandResult = null;\r\n    if (isNavigationCommand(result.output)) {\r\n        navigationCommandResult = result.output.navigate(router);\r\n    }\r\n    else {\r\n        finalResult = result;\r\n        if (!result.completed) {\r\n            if (result.output instanceof Error) {\r\n                logger.error(result.output.toString());\r\n            }\r\n            restorePreviousLocation(router);\r\n        }\r\n    }\r\n    return Promise.resolve(navigationCommandResult)\r\n        .then(_ => router._dequeueInstruction(instructionCount + 1))\r\n        .then(innerResult => finalResult || innerResult || result);\r\n};\r\nconst resolveInstruction = (instruction, result, isInnerInstruction, router) => {\r\n    instruction.resolve(result);\r\n    let eventAggregator = router.events;\r\n    let eventArgs = { instruction, result };\r\n    if (!isInnerInstruction) {\r\n        router.isNavigating = false;\r\n        router.isExplicitNavigation = false;\r\n        router.isExplicitNavigationBack = false;\r\n        router.isNavigatingFirst = false;\r\n        router.isNavigatingNew = false;\r\n        router.isNavigatingRefresh = false;\r\n        router.isNavigatingForward = false;\r\n        router.isNavigatingBack = false;\r\n        router.couldDeactivate = false;\r\n        let eventName;\r\n        if (result.output instanceof Error) {\r\n            eventName = \"router:navigation:error\" /* Error */;\r\n        }\r\n        else if (!result.completed) {\r\n            eventName = \"router:navigation:canceled\" /* Canceled */;\r\n        }\r\n        else {\r\n            let queryString = instruction.queryString ? ('?' + instruction.queryString) : '';\r\n            router.history.previousLocation = instruction.fragment + queryString;\r\n            eventName = \"router:navigation:success\" /* Success */;\r\n        }\r\n        eventAggregator.publish(eventName, eventArgs);\r\n        eventAggregator.publish(\"router:navigation:complete\" /* Complete */, eventArgs);\r\n    }\r\n    else {\r\n        eventAggregator.publish(\"router:navigation:child:complete\" /* ChildComplete */, eventArgs);\r\n    }\r\n    return result;\r\n};\r\nconst restorePreviousLocation = (router) => {\r\n    let previousLocation = router.history.previousLocation;\r\n    if (previousLocation) {\r\n        router.navigate(previousLocation, { trigger: false, replace: true });\r\n    }\r\n    else if (router.fallbackRoute) {\r\n        router.navigate(router.fallbackRoute, { trigger: true, replace: true });\r\n    }\r\n    else {\r\n        logger.error('Router navigation failed, and no previous location or fallbackRoute could be restored.');\r\n    }\r\n};\n\n/**\r\n* The status of a Pipeline.\r\n*/\r\nvar PipelineStatus;\r\n(function (PipelineStatus) {\r\n    PipelineStatus[\"Completed\"] = \"completed\";\r\n    PipelineStatus[\"Canceled\"] = \"canceled\";\r\n    PipelineStatus[\"Rejected\"] = \"rejected\";\r\n    PipelineStatus[\"Running\"] = \"running\";\r\n})(PipelineStatus || (PipelineStatus = {}));\n\n/**\r\n * A list of known router events used by the Aurelia router\r\n * to signal the pipeline has come to a certain state\r\n */\r\n// const enum is preserved in tsconfig\r\nvar RouterEvent;\r\n(function (RouterEvent) {\r\n    RouterEvent[\"Processing\"] = \"router:navigation:processing\";\r\n    RouterEvent[\"Error\"] = \"router:navigation:error\";\r\n    RouterEvent[\"Canceled\"] = \"router:navigation:canceled\";\r\n    RouterEvent[\"Complete\"] = \"router:navigation:complete\";\r\n    RouterEvent[\"Success\"] = \"router:navigation:success\";\r\n    RouterEvent[\"ChildComplete\"] = \"router:navigation:child:complete\";\r\n})(RouterEvent || (RouterEvent = {}));\n\n/**\r\n * Available pipeline slot names to insert interceptor into router pipeline\r\n */\r\n// const enum is preserved in tsconfig\r\nvar PipelineSlotName;\r\n(function (PipelineSlotName) {\r\n    /**\r\n     * Authorization slot. Invoked early in the pipeline,\r\n     * before `canActivate` hook of incoming route\r\n     */\r\n    PipelineSlotName[\"Authorize\"] = \"authorize\";\r\n    /**\r\n     * Pre-activation slot. Invoked early in the pipeline,\r\n     * Invoked timing:\r\n     *   - after Authorization slot\r\n     *   - after canActivate hook on new view model\r\n     *   - before deactivate hook on old view model\r\n     *   - before activate hook on new view model\r\n     */\r\n    PipelineSlotName[\"PreActivate\"] = \"preActivate\";\r\n    /**\r\n     * Pre-render slot. Invoked later in the pipeline\r\n     * Invokcation timing:\r\n     *   - after activate hook on new view model\r\n     *   - before commit step on new navigation instruction\r\n     */\r\n    PipelineSlotName[\"PreRender\"] = \"preRender\";\r\n    /**\r\n     * Post-render slot. Invoked last in the pipeline\r\n     */\r\n    PipelineSlotName[\"PostRender\"] = \"postRender\";\r\n})(PipelineSlotName || (PipelineSlotName = {}));\n\n\n//# sourceMappingURL=aurelia-router.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1yb3V0ZXIvZGlzdC9lczIwMTUvYXVyZWxpYS1yb3V0ZXIuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1yb3V0ZXIvZGlzdC9lczIwMTUvYXVyZWxpYS1yb3V0ZXIuanM/MjAwZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRMb2dnZXIgfSBmcm9tICdhdXJlbGlhLWxvZ2dpbmcnO1xuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSAnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbic7XG5pbXBvcnQgeyBIaXN0b3J5IH0gZnJvbSAnYXVyZWxpYS1oaXN0b3J5JztcbmltcG9ydCB7IFJvdXRlUmVjb2duaXplciB9IGZyb20gJ2F1cmVsaWEtcm91dGUtcmVjb2duaXplcic7XG5pbXBvcnQgeyBFdmVudEFnZ3JlZ2F0b3IgfSBmcm9tICdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InO1xuXG4vKipcclxuICogQ2xhc3MgdXNlZCB0byByZXByZXNlbnQgYW4gaW5zdHJ1Y3Rpb24gZHVyaW5nIGEgbmF2aWdhdGlvbi5cclxuICovXHJcbmNsYXNzIE5hdmlnYXRpb25JbnN0cnVjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcihpbml0KSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ3VycmVudCBidWlsdCB2aWV3cG9ydCBwbGFuIG9mIHRoaXMgbmF2IGluc3RydWN0aW9uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wbGFuID0gbnVsbDtcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSB7fTtcclxuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIGluaXQpO1xyXG4gICAgICAgIHRoaXMucGFyYW1zID0gdGhpcy5wYXJhbXMgfHwge307XHJcbiAgICAgICAgdGhpcy52aWV3UG9ydEluc3RydWN0aW9ucyA9IHt9O1xyXG4gICAgICAgIGxldCBhbmNlc3RvclBhcmFtcyA9IFtdO1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcztcclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50UGFyYW1zID0gT2JqZWN0LmFzc2lnbih7fSwgY3VycmVudC5wYXJhbXMpO1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudC5jb25maWcgJiYgY3VycmVudC5jb25maWcuaGFzQ2hpbGRSb3V0ZXIpIHtcclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgcGFyYW0gZm9yIHRoZSBpbmplY3RlZCBjaGlsZCByb3V0ZSBzZWdtZW50XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgY3VycmVudFBhcmFtc1tjdXJyZW50LmdldFdpbGRDYXJkTmFtZSgpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhbmNlc3RvclBhcmFtcy51bnNoaWZ0KGN1cnJlbnRQYXJhbXMpO1xyXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnRJbnN0cnVjdGlvbjtcclxuICAgICAgICB9IHdoaWxlIChjdXJyZW50KTtcclxuICAgICAgICBsZXQgYWxsUGFyYW1zID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5xdWVyeVBhcmFtcywgLi4uYW5jZXN0b3JQYXJhbXMpO1xyXG4gICAgICAgIHRoaXMubGlmZWN5Y2xlQXJncyA9IFthbGxQYXJhbXMsIHRoaXMuY29uZmlnLCB0aGlzXTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyBhbiBhcnJheSBjb250YWluaW5nIHRoaXMgaW5zdHJ1Y3Rpb24gYW5kIGFsbCBjaGlsZCBpbnN0cnVjdGlvbnMgZm9yIHRoZSBjdXJyZW50IG5hdmlnYXRpb24uXHJcbiAgICAgKi9cclxuICAgIGdldEFsbEluc3RydWN0aW9ucygpIHtcclxuICAgICAgICBsZXQgaW5zdHJ1Y3Rpb25zID0gW3RoaXNdO1xyXG4gICAgICAgIGxldCB2aWV3UG9ydEluc3RydWN0aW9ucyA9IHRoaXMudmlld1BvcnRJbnN0cnVjdGlvbnM7XHJcbiAgICAgICAgZm9yIChsZXQga2V5IGluIHZpZXdQb3J0SW5zdHJ1Y3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGxldCBjaGlsZEluc3RydWN0aW9uID0gdmlld1BvcnRJbnN0cnVjdGlvbnNba2V5XS5jaGlsZE5hdmlnYXRpb25JbnN0cnVjdGlvbjtcclxuICAgICAgICAgICAgaWYgKGNoaWxkSW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9ucy5wdXNoKC4uLmNoaWxkSW5zdHJ1Y3Rpb24uZ2V0QWxsSW5zdHJ1Y3Rpb25zKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbnN0cnVjdGlvbnM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEdldHMgYW4gYXJyYXkgY29udGFpbmluZyB0aGUgaW5zdHJ1Y3Rpb24gYW5kIGFsbCBjaGlsZCBpbnN0cnVjdGlvbnMgZm9yIHRoZSBwcmV2aW91cyBuYXZpZ2F0aW9uLlxyXG4gICAgICogUHJldmlvdXMgaW5zdHJ1Y3Rpb25zIGFyZSBubyBsb25nZXIgYXZhaWxhYmxlIGFmdGVyIG5hdmlnYXRpb24gY29tcGxldGVzLlxyXG4gICAgICovXHJcbiAgICBnZXRBbGxQcmV2aW91c0luc3RydWN0aW9ucygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxJbnN0cnVjdGlvbnMoKS5tYXAoYyA9PiBjLnByZXZpb3VzSW5zdHJ1Y3Rpb24pLmZpbHRlcihjID0+IGMpO1xyXG4gICAgfVxyXG4gICAgYWRkVmlld1BvcnRJbnN0cnVjdGlvbihuYW1lT3JJbml0T3B0aW9ucywgc3RyYXRlZ3ksIG1vZHVsZUlkLCBjb21wb25lbnQpIHtcclxuICAgICAgICBsZXQgdmlld1BvcnRJbnN0cnVjdGlvbjtcclxuICAgICAgICBsZXQgdmlld1BvcnROYW1lID0gdHlwZW9mIG5hbWVPckluaXRPcHRpb25zID09PSAnc3RyaW5nJyA/IG5hbWVPckluaXRPcHRpb25zIDogbmFtZU9ySW5pdE9wdGlvbnMubmFtZTtcclxuICAgICAgICBjb25zdCBsaWZlY3ljbGVBcmdzID0gdGhpcy5saWZlY3ljbGVBcmdzO1xyXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGxpZmVjeWNsZUFyZ3NbMV0sIHsgY3VycmVudFZpZXdQb3J0OiB2aWV3UG9ydE5hbWUgfSk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lT3JJbml0T3B0aW9ucyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgdmlld1BvcnRJbnN0cnVjdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVPckluaXRPcHRpb25zLFxyXG4gICAgICAgICAgICAgICAgc3RyYXRlZ3k6IHN0cmF0ZWd5LFxyXG4gICAgICAgICAgICAgICAgbW9kdWxlSWQ6IG1vZHVsZUlkLFxyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiBjb21wb25lbnQsXHJcbiAgICAgICAgICAgICAgICBjaGlsZFJvdXRlcjogY29tcG9uZW50LmNoaWxkUm91dGVyLFxyXG4gICAgICAgICAgICAgICAgbGlmZWN5Y2xlQXJnczogW2xpZmVjeWNsZUFyZ3NbMF0sIGNvbmZpZywgbGlmZWN5Y2xlQXJnc1syXV1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SW5zdHJ1Y3Rpb24gPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB2aWV3UG9ydE5hbWUsXHJcbiAgICAgICAgICAgICAgICBzdHJhdGVneTogbmFtZU9ySW5pdE9wdGlvbnMuc3RyYXRlZ3ksXHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6IG5hbWVPckluaXRPcHRpb25zLmNvbXBvbmVudCxcclxuICAgICAgICAgICAgICAgIG1vZHVsZUlkOiBuYW1lT3JJbml0T3B0aW9ucy5tb2R1bGVJZCxcclxuICAgICAgICAgICAgICAgIGNoaWxkUm91dGVyOiBuYW1lT3JJbml0T3B0aW9ucy5jb21wb25lbnQuY2hpbGRSb3V0ZXIsXHJcbiAgICAgICAgICAgICAgICBsaWZlY3ljbGVBcmdzOiBbbGlmZWN5Y2xlQXJnc1swXSwgY29uZmlnLCBsaWZlY3ljbGVBcmdzWzJdXVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3UG9ydEluc3RydWN0aW9uc1t2aWV3UG9ydE5hbWVdID0gdmlld1BvcnRJbnN0cnVjdGlvbjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyB0aGUgbmFtZSBvZiB0aGUgcm91dGUgcGF0dGVybidzIHdpbGRjYXJkIHBhcmFtZXRlciwgaWYgYXBwbGljYWJsZS5cclxuICAgICAqL1xyXG4gICAgZ2V0V2lsZENhcmROYW1lKCkge1xyXG4gICAgICAgIC8vIHRvZG86IHBvdGVudGlhbCBpc3N1ZSwgb3IgYXQgbGVhc3QgdW5zYWZlIHR5cGluZ3NcclxuICAgICAgICBsZXQgY29uZmlnUm91dGUgPSB0aGlzLmNvbmZpZy5yb3V0ZTtcclxuICAgICAgICBsZXQgd2lsZGNhcmRJbmRleCA9IGNvbmZpZ1JvdXRlLmxhc3RJbmRleE9mKCcqJyk7XHJcbiAgICAgICAgcmV0dXJuIGNvbmZpZ1JvdXRlLnN1YnN0cih3aWxkY2FyZEluZGV4ICsgMSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEdldHMgdGhlIHBhdGggYW5kIHF1ZXJ5IHN0cmluZyBjcmVhdGVkIGJ5IGZpbGxpbmcgdGhlIHJvdXRlXHJcbiAgICAgKiBwYXR0ZXJuJ3Mgd2lsZGNhcmQgcGFyYW1ldGVyIHdpdGggdGhlIG1hdGNoaW5nIHBhcmFtLlxyXG4gICAgICovXHJcbiAgICBnZXRXaWxkY2FyZFBhdGgoKSB7XHJcbiAgICAgICAgbGV0IHdpbGRjYXJkTmFtZSA9IHRoaXMuZ2V0V2lsZENhcmROYW1lKCk7XHJcbiAgICAgICAgbGV0IHBhdGggPSB0aGlzLnBhcmFtc1t3aWxkY2FyZE5hbWVdIHx8ICcnO1xyXG4gICAgICAgIGxldCBxdWVyeVN0cmluZyA9IHRoaXMucXVlcnlTdHJpbmc7XHJcbiAgICAgICAgaWYgKHF1ZXJ5U3RyaW5nKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gJz8nICsgcXVlcnlTdHJpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBpbnN0cnVjdGlvbidzIGJhc2UgVVJMLCBhY2NvdW50aW5nIGZvciB3aWxkY2FyZCByb3V0ZSBwYXJhbWV0ZXJzLlxyXG4gICAgICovXHJcbiAgICBnZXRCYXNlVXJsKCkge1xyXG4gICAgICAgIGxldCAkZW5jb2RlVVJJID0gZW5jb2RlVVJJO1xyXG4gICAgICAgIGxldCBmcmFnbWVudCA9IGRlY29kZVVSSSh0aGlzLmZyYWdtZW50KTtcclxuICAgICAgICBpZiAoZnJhZ21lbnQgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIGxldCBub25FbXB0eVJvdXRlID0gdGhpcy5yb3V0ZXIucm91dGVzLmZpbmQocm91dGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvdXRlLm5hbWUgPT09IHRoaXMuY29uZmlnLm5hbWUgJiZcclxuICAgICAgICAgICAgICAgICAgICByb3V0ZS5yb3V0ZSAhPT0gJyc7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAobm9uRW1wdHlSb3V0ZSkge1xyXG4gICAgICAgICAgICAgICAgZnJhZ21lbnQgPSBub25FbXB0eVJvdXRlLnJvdXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5wYXJhbXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRlbmNvZGVVUkkoZnJhZ21lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgd2lsZGNhcmROYW1lID0gdGhpcy5nZXRXaWxkQ2FyZE5hbWUoKTtcclxuICAgICAgICBsZXQgcGF0aCA9IHRoaXMucGFyYW1zW3dpbGRjYXJkTmFtZV0gfHwgJyc7XHJcbiAgICAgICAgaWYgKCFwYXRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkZW5jb2RlVVJJKGZyYWdtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICRlbmNvZGVVUkkoZnJhZ21lbnQuc3Vic3RyKDAsIGZyYWdtZW50Lmxhc3RJbmRleE9mKHBhdGgpKSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEZpbmFsaXplIGEgdmlld3BvcnQgaW5zdHJ1Y3Rpb25cclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICovXHJcbiAgICBfY29tbWl0Q2hhbmdlcyh3YWl0VG9Td2FwKSB7XHJcbiAgICAgICAgbGV0IHJvdXRlciA9IHRoaXMucm91dGVyO1xyXG4gICAgICAgIHJvdXRlci5jdXJyZW50SW5zdHJ1Y3Rpb24gPSB0aGlzO1xyXG4gICAgICAgIGNvbnN0IHByZXZpb3VzSW5zdHJ1Y3Rpb24gPSB0aGlzLnByZXZpb3VzSW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgaWYgKHByZXZpb3VzSW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgcHJldmlvdXNJbnN0cnVjdGlvbi5jb25maWcubmF2TW9kZWwuaXNBY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb25maWcubmF2TW9kZWwuaXNBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHJvdXRlci5yZWZyZXNoTmF2aWdhdGlvbigpO1xyXG4gICAgICAgIGxldCBsb2FkcyA9IFtdO1xyXG4gICAgICAgIGxldCBkZWxheVN3YXBzID0gW107XHJcbiAgICAgICAgbGV0IHZpZXdQb3J0SW5zdHJ1Y3Rpb25zID0gdGhpcy52aWV3UG9ydEluc3RydWN0aW9ucztcclxuICAgICAgICBmb3IgKGxldCB2aWV3UG9ydE5hbWUgaW4gdmlld1BvcnRJbnN0cnVjdGlvbnMpIHtcclxuICAgICAgICAgICAgbGV0IHZpZXdQb3J0SW5zdHJ1Y3Rpb24gPSB2aWV3UG9ydEluc3RydWN0aW9uc1t2aWV3UG9ydE5hbWVdO1xyXG4gICAgICAgICAgICBsZXQgdmlld1BvcnQgPSByb3V0ZXIudmlld1BvcnRzW3ZpZXdQb3J0TmFtZV07XHJcbiAgICAgICAgICAgIGlmICghdmlld1BvcnQpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlcmUgd2FzIG5vIHJvdXRlci12aWV3IGZvdW5kIGluIHRoZSB2aWV3IGZvciAke3ZpZXdQb3J0SW5zdHJ1Y3Rpb24ubW9kdWxlSWR9LmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBjaGlsZE5hdkluc3RydWN0aW9uID0gdmlld1BvcnRJbnN0cnVjdGlvbi5jaGlsZE5hdmlnYXRpb25JbnN0cnVjdGlvbjtcclxuICAgICAgICAgICAgaWYgKHZpZXdQb3J0SW5zdHJ1Y3Rpb24uc3RyYXRlZ3kgPT09IFwicmVwbGFjZVwiIC8qIFJlcGxhY2UgKi8pIHtcclxuICAgICAgICAgICAgICAgIGlmIChjaGlsZE5hdkluc3RydWN0aW9uICYmIGNoaWxkTmF2SW5zdHJ1Y3Rpb24ucGFyZW50Q2F0Y2hIYW5kbGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9hZHMucHVzaChjaGlsZE5hdkluc3RydWN0aW9uLl9jb21taXRDaGFuZ2VzKHdhaXRUb1N3YXApKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh3YWl0VG9Td2FwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5U3dhcHMucHVzaCh7IHZpZXdQb3J0LCB2aWV3UG9ydEluc3RydWN0aW9uIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBsb2Fkcy5wdXNoKHZpZXdQb3J0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wcm9jZXNzKHZpZXdQb3J0SW5zdHJ1Y3Rpb24sIHdhaXRUb1N3YXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IGNoaWxkTmF2SW5zdHJ1Y3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBjaGlsZE5hdkluc3RydWN0aW9uLl9jb21taXRDaGFuZ2VzKHdhaXRUb1N3YXApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogUHJvbWlzZS5yZXNvbHZlKCkpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChjaGlsZE5hdkluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9hZHMucHVzaChjaGlsZE5hdkluc3RydWN0aW9uLl9jb21taXRDaGFuZ2VzKHdhaXRUb1N3YXApKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZVxyXG4gICAgICAgICAgICAuYWxsKGxvYWRzKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGRlbGF5U3dhcHMuZm9yRWFjaCh4ID0+IHgudmlld1BvcnQuc3dhcCh4LnZpZXdQb3J0SW5zdHJ1Y3Rpb24pKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4gcHJ1bmUodGhpcykpO1xyXG4gICAgfVxyXG4gICAgLyoqQGludGVybmFsICovXHJcbiAgICBfdXBkYXRlVGl0bGUoKSB7XHJcbiAgICAgICAgbGV0IHJvdXRlciA9IHRoaXMucm91dGVyO1xyXG4gICAgICAgIGxldCB0aXRsZSA9IHRoaXMuX2J1aWxkVGl0bGUocm91dGVyLnRpdGxlU2VwYXJhdG9yKTtcclxuICAgICAgICBpZiAodGl0bGUpIHtcclxuICAgICAgICAgICAgcm91dGVyLmhpc3Rvcnkuc2V0VGl0bGUodGl0bGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgX2J1aWxkVGl0bGUoc2VwYXJhdG9yID0gJyB8ICcpIHtcclxuICAgICAgICBsZXQgdGl0bGUgPSAnJztcclxuICAgICAgICBsZXQgY2hpbGRUaXRsZXMgPSBbXTtcclxuICAgICAgICBsZXQgbmF2TW9kZWxUaXRsZSA9IHRoaXMuY29uZmlnLm5hdk1vZGVsLnRpdGxlO1xyXG4gICAgICAgIGxldCBpbnN0cnVjdGlvblJvdXRlciA9IHRoaXMucm91dGVyO1xyXG4gICAgICAgIGxldCB2aWV3UG9ydEluc3RydWN0aW9ucyA9IHRoaXMudmlld1BvcnRJbnN0cnVjdGlvbnM7XHJcbiAgICAgICAgaWYgKG5hdk1vZGVsVGl0bGUpIHtcclxuICAgICAgICAgICAgdGl0bGUgPSBpbnN0cnVjdGlvblJvdXRlci50cmFuc2Zvcm1UaXRsZShuYXZNb2RlbFRpdGxlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgdmlld1BvcnROYW1lIGluIHZpZXdQb3J0SW5zdHJ1Y3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGxldCB2aWV3UG9ydEluc3RydWN0aW9uID0gdmlld1BvcnRJbnN0cnVjdGlvbnNbdmlld1BvcnROYW1lXTtcclxuICAgICAgICAgICAgbGV0IGNoaWxkX25hdl9pbnN0cnVjdGlvbiA9IHZpZXdQb3J0SW5zdHJ1Y3Rpb24uY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgICAgIGlmIChjaGlsZF9uYXZfaW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGxldCBjaGlsZFRpdGxlID0gY2hpbGRfbmF2X2luc3RydWN0aW9uLl9idWlsZFRpdGxlKHNlcGFyYXRvcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRUaXRsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkVGl0bGVzLnB1c2goY2hpbGRUaXRsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNoaWxkVGl0bGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aXRsZSA9IGNoaWxkVGl0bGVzLmpvaW4oc2VwYXJhdG9yKSArICh0aXRsZSA/IHNlcGFyYXRvciA6ICcnKSArIHRpdGxlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaW5zdHJ1Y3Rpb25Sb3V0ZXIudGl0bGUpIHtcclxuICAgICAgICAgICAgdGl0bGUgKz0gKHRpdGxlID8gc2VwYXJhdG9yIDogJycpICsgaW5zdHJ1Y3Rpb25Sb3V0ZXIudHJhbnNmb3JtVGl0bGUoaW5zdHJ1Y3Rpb25Sb3V0ZXIudGl0bGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGl0bGU7XHJcbiAgICB9XHJcbn1cclxuY29uc3QgcHJ1bmUgPSAoaW5zdHJ1Y3Rpb24pID0+IHtcclxuICAgIGluc3RydWN0aW9uLnByZXZpb3VzSW5zdHJ1Y3Rpb24gPSBudWxsO1xyXG4gICAgaW5zdHJ1Y3Rpb24ucGxhbiA9IG51bGw7XHJcbn07XG5cbi8qKlxyXG4qIENsYXNzIGZvciBzdG9yaW5nIGFuZCBpbnRlcmFjdGluZyB3aXRoIGEgcm91dGUncyBuYXZpZ2F0aW9uIHNldHRpbmdzLlxyXG4qL1xyXG5jbGFzcyBOYXZNb2RlbCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihyb3V0ZXIsIHJlbGF0aXZlSHJlZikge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICogVHJ1ZSBpZiB0aGlzIG5hdiBpdGVtIGlzIGN1cnJlbnRseSBhY3RpdmUuXHJcbiAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmlzQWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgKiBUaGUgdGl0bGUuXHJcbiAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRpdGxlID0gbnVsbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAqIFRoaXMgbmF2IGl0ZW0ncyBhYnNvbHV0ZSBocmVmLlxyXG4gICAgICAgICovXHJcbiAgICAgICAgdGhpcy5ocmVmID0gbnVsbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAqIFRoaXMgbmF2IGl0ZW0ncyByZWxhdGl2ZSBocmVmLlxyXG4gICAgICAgICovXHJcbiAgICAgICAgdGhpcy5yZWxhdGl2ZUhyZWYgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICogRGF0YSBhdHRhY2hlZCB0byB0aGUgcm91dGUgYXQgY29uZmlndXJhdGlvbiB0aW1lLlxyXG4gICAgICAgICovXHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHt9O1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICogVGhlIHJvdXRlIGNvbmZpZy5cclxuICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuY29uZmlnID0gbnVsbDtcclxuICAgICAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcclxuICAgICAgICB0aGlzLnJlbGF0aXZlSHJlZiA9IHJlbGF0aXZlSHJlZjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgKiBTZXRzIHRoZSByb3V0ZSdzIHRpdGxlIGFuZCB1cGRhdGVzIGRvY3VtZW50LnRpdGxlLlxyXG4gICAgKiAgSWYgdGhlIGEgbmF2aWdhdGlvbiBpcyBpbiBwcm9ncmVzcywgdGhlIGNoYW5nZSB3aWxsIGJlIGFwcGxpZWRcclxuICAgICogIHRvIGRvY3VtZW50LnRpdGxlIHdoZW4gdGhlIG5hdmlnYXRpb24gY29tcGxldGVzLlxyXG4gICAgKlxyXG4gICAgKiBAcGFyYW0gdGl0bGUgVGhlIG5ldyB0aXRsZS5cclxuICAgICovXHJcbiAgICBzZXRUaXRsZSh0aXRsZSkge1xyXG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcclxuICAgICAgICBpZiAodGhpcy5pc0FjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnJvdXRlci51cGRhdGVUaXRsZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5mdW5jdGlvbiBfbm9ybWFsaXplQWJzb2x1dGVQYXRoKHBhdGgsIGhhc1B1c2hTdGF0ZSwgYWJzb2x1dGUgPSBmYWxzZSkge1xyXG4gICAgaWYgKCFoYXNQdXNoU3RhdGUgJiYgcGF0aFswXSAhPT0gJyMnKSB7XHJcbiAgICAgICAgcGF0aCA9ICcjJyArIHBhdGg7XHJcbiAgICB9XHJcbiAgICBpZiAoaGFzUHVzaFN0YXRlICYmIGFic29sdXRlKSB7XHJcbiAgICAgICAgcGF0aCA9IHBhdGguc3Vic3RyaW5nKDEsIHBhdGgubGVuZ3RoKTtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXRoO1xyXG59XHJcbmZ1bmN0aW9uIF9jcmVhdGVSb290ZWRQYXRoKGZyYWdtZW50LCBiYXNlVXJsLCBoYXNQdXNoU3RhdGUsIGFic29sdXRlKSB7XHJcbiAgICBpZiAoaXNBYnNvbHV0ZVVybC50ZXN0KGZyYWdtZW50KSkge1xyXG4gICAgICAgIHJldHVybiBmcmFnbWVudDtcclxuICAgIH1cclxuICAgIGxldCBwYXRoID0gJyc7XHJcbiAgICBpZiAoYmFzZVVybC5sZW5ndGggJiYgYmFzZVVybFswXSAhPT0gJy8nKSB7XHJcbiAgICAgICAgcGF0aCArPSAnLyc7XHJcbiAgICB9XHJcbiAgICBwYXRoICs9IGJhc2VVcmw7XHJcbiAgICBpZiAoKCFwYXRoLmxlbmd0aCB8fCBwYXRoW3BhdGgubGVuZ3RoIC0gMV0gIT09ICcvJykgJiYgZnJhZ21lbnRbMF0gIT09ICcvJykge1xyXG4gICAgICAgIHBhdGggKz0gJy8nO1xyXG4gICAgfVxyXG4gICAgaWYgKHBhdGgubGVuZ3RoICYmIHBhdGhbcGF0aC5sZW5ndGggLSAxXSA9PT0gJy8nICYmIGZyYWdtZW50WzBdID09PSAnLycpIHtcclxuICAgICAgICBwYXRoID0gcGF0aC5zdWJzdHJpbmcoMCwgcGF0aC5sZW5ndGggLSAxKTtcclxuICAgIH1cclxuICAgIHJldHVybiBfbm9ybWFsaXplQWJzb2x1dGVQYXRoKHBhdGggKyBmcmFnbWVudCwgaGFzUHVzaFN0YXRlLCBhYnNvbHV0ZSk7XHJcbn1cclxuZnVuY3Rpb24gX3Jlc29sdmVVcmwoZnJhZ21lbnQsIGJhc2VVcmwsIGhhc1B1c2hTdGF0ZSkge1xyXG4gICAgaWYgKGlzUm9vdGVkUGF0aC50ZXN0KGZyYWdtZW50KSkge1xyXG4gICAgICAgIHJldHVybiBfbm9ybWFsaXplQWJzb2x1dGVQYXRoKGZyYWdtZW50LCBoYXNQdXNoU3RhdGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9jcmVhdGVSb290ZWRQYXRoKGZyYWdtZW50LCBiYXNlVXJsLCBoYXNQdXNoU3RhdGUpO1xyXG59XHJcbmZ1bmN0aW9uIF9lbnN1cmVBcnJheVdpdGhTaW5nbGVSb3V0ZVBlckNvbmZpZyhjb25maWcpIHtcclxuICAgIGxldCByb3V0ZUNvbmZpZ3MgPSBbXTtcclxuICAgIGlmIChBcnJheS5pc0FycmF5KGNvbmZpZy5yb3V0ZSkpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjb25maWcucm91dGUubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudCA9IE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIGN1cnJlbnQucm91dGUgPSBjb25maWcucm91dGVbaV07XHJcbiAgICAgICAgICAgIHJvdXRlQ29uZmlncy5wdXNoKGN1cnJlbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJvdXRlQ29uZmlncy5wdXNoKE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZykpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJvdXRlQ29uZmlncztcclxufVxyXG5jb25zdCBpc1Jvb3RlZFBhdGggPSAvXiM/XFwvLztcclxuY29uc3QgaXNBYnNvbHV0ZVVybCA9IC9eKFthLXpdW2EtejAtOStcXC0uXSo6KT9cXC9cXC8vaTtcblxuLyoqXHJcbiAqIENsYXNzIHVzZWQgdG8gY29uZmlndXJlIGEgW1tSb3V0ZXJdXSBpbnN0YW5jZS5cclxuICpcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5jbGFzcyBSb3V0ZXJDb25maWd1cmF0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuaW5zdHJ1Y3Rpb25zID0gW107XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0ge307XHJcbiAgICAgICAgdGhpcy5waXBlbGluZVN0ZXBzID0gW107XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgYSBzdGVwIHRvIGJlIHJ1biBkdXJpbmcgdGhlIFtbUm91dGVyXV0ncyBuYXZpZ2F0aW9uIHBpcGVsaW5lLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBwaXBlbGluZSBzbG90IHRvIGluc2VydCB0aGUgc3RlcCBpbnRvLlxyXG4gICAgICogQHBhcmFtIHN0ZXAgVGhlIHBpcGVsaW5lIHN0ZXAuXHJcbiAgICAgKiBAY2hhaW5hYmxlXHJcbiAgICAgKi9cclxuICAgIGFkZFBpcGVsaW5lU3RlcChuYW1lLCBzdGVwKSB7XHJcbiAgICAgICAgaWYgKHN0ZXAgPT09IG51bGwgfHwgc3RlcCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGlwZWxpbmUgc3RlcCBjYW5ub3QgYmUgbnVsbCBvciB1bmRlZmluZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucGlwZWxpbmVTdGVwcy5wdXNoKHsgbmFtZSwgc3RlcCB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhIHN0ZXAgdG8gYmUgcnVuIGR1cmluZyB0aGUgW1tSb3V0ZXJdXSdzIGF1dGhvcml6ZSBwaXBlbGluZSBzbG90LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzdGVwIFRoZSBwaXBlbGluZSBzdGVwLlxyXG4gICAgICogQGNoYWluYWJsZVxyXG4gICAgICovXHJcbiAgICBhZGRBdXRob3JpemVTdGVwKHN0ZXApIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hZGRQaXBlbGluZVN0ZXAoXCJhdXRob3JpemVcIiAvKiBBdXRob3JpemUgKi8sIHN0ZXApO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgc3RlcCB0byBiZSBydW4gZHVyaW5nIHRoZSBbW1JvdXRlcl1dJ3MgcHJlQWN0aXZhdGUgcGlwZWxpbmUgc2xvdC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gc3RlcCBUaGUgcGlwZWxpbmUgc3RlcC5cclxuICAgICAqIEBjaGFpbmFibGVcclxuICAgICAqL1xyXG4gICAgYWRkUHJlQWN0aXZhdGVTdGVwKHN0ZXApIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hZGRQaXBlbGluZVN0ZXAoXCJwcmVBY3RpdmF0ZVwiIC8qIFByZUFjdGl2YXRlICovLCBzdGVwKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhIHN0ZXAgdG8gYmUgcnVuIGR1cmluZyB0aGUgW1tSb3V0ZXJdXSdzIHByZVJlbmRlciBwaXBlbGluZSBzbG90LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzdGVwIFRoZSBwaXBlbGluZSBzdGVwLlxyXG4gICAgICogQGNoYWluYWJsZVxyXG4gICAgICovXHJcbiAgICBhZGRQcmVSZW5kZXJTdGVwKHN0ZXApIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hZGRQaXBlbGluZVN0ZXAoXCJwcmVSZW5kZXJcIiAvKiBQcmVSZW5kZXIgKi8sIHN0ZXApO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgc3RlcCB0byBiZSBydW4gZHVyaW5nIHRoZSBbW1JvdXRlcl1dJ3MgcG9zdFJlbmRlciBwaXBlbGluZSBzbG90LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzdGVwIFRoZSBwaXBlbGluZSBzdGVwLlxyXG4gICAgICogQGNoYWluYWJsZVxyXG4gICAgICovXHJcbiAgICBhZGRQb3N0UmVuZGVyU3RlcChzdGVwKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkUGlwZWxpbmVTdGVwKFwicG9zdFJlbmRlclwiIC8qIFBvc3RSZW5kZXIgKi8sIHN0ZXApO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25maWd1cmVzIGEgcm91dGUgdGhhdCB3aWxsIGJlIHVzZWQgaWYgdGhlcmUgaXMgbm8gcHJldmlvdXMgbG9jYXRpb24gYXZhaWxhYmxlIG9uIG5hdmlnYXRpb24gY2FuY2VsbGF0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBmcmFnbWVudCBUaGUgVVJMIGZyYWdtZW50IHRvIHVzZSBhcyB0aGUgbmF2aWdhdGlvbiBkZXN0aW5hdGlvbi5cclxuICAgICAqIEBjaGFpbmFibGVcclxuICAgICAqL1xyXG4gICAgZmFsbGJhY2tSb3V0ZShmcmFnbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2ZhbGxiYWNrUm91dGUgPSBmcmFnbWVudDtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBvbmUgb3IgbW9yZSByb3V0ZXMgdG8gYmUgcmVnaXN0ZXJlZCB3aXRoIHRoZSByb3V0ZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHJvdXRlIFRoZSBbW1JvdXRlQ29uZmlnXV0gdG8gbWFwLCBvciBhbiBhcnJheSBvZiBbW1JvdXRlQ29uZmlnXV0gdG8gbWFwLlxyXG4gICAgICogQGNoYWluYWJsZVxyXG4gICAgICovXHJcbiAgICBtYXAocm91dGUpIHtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShyb3V0ZSkpIHtcclxuICAgICAgICAgICAgcm91dGUuZm9yRWFjaChyID0+IHRoaXMubWFwKHIpKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLm1hcFJvdXRlKHJvdXRlKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ29uZmlndXJlcyBkZWZhdWx0cyB0byB1c2UgZm9yIGFueSB2aWV3IHBvcnRzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2aWV3UG9ydENvbmZpZyBhIHZpZXcgcG9ydCBjb25maWd1cmF0aW9uIG9iamVjdCB0byB1c2UgYXMgYVxyXG4gICAgICogIGRlZmF1bHQsIG9mIHRoZSBmb3JtIHsgdmlld1BvcnROYW1lOiB7IG1vZHVsZUlkIH0gfS5cclxuICAgICAqIEBjaGFpbmFibGVcclxuICAgICAqL1xyXG4gICAgdXNlVmlld1BvcnREZWZhdWx0cyh2aWV3UG9ydENvbmZpZykge1xyXG4gICAgICAgIHRoaXMudmlld1BvcnREZWZhdWx0cyA9IHZpZXdQb3J0Q29uZmlnO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIGEgc2luZ2xlIHJvdXRlIHRvIGJlIHJlZ2lzdGVyZWQgd2l0aCB0aGUgcm91dGVyLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSByb3V0ZSBUaGUgW1tSb3V0ZUNvbmZpZ11dIHRvIG1hcC5cclxuICAgICAqIEBjaGFpbmFibGVcclxuICAgICAqL1xyXG4gICAgbWFwUm91dGUoY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5pbnN0cnVjdGlvbnMucHVzaChyb3V0ZXIgPT4ge1xyXG4gICAgICAgICAgICBsZXQgcm91dGVDb25maWdzID0gX2Vuc3VyZUFycmF5V2l0aFNpbmdsZVJvdXRlUGVyQ29uZmlnKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIGxldCBuYXZNb2RlbDtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gcm91dGVDb25maWdzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGxldCByb3V0ZUNvbmZpZyA9IHJvdXRlQ29uZmlnc1tpXTtcclxuICAgICAgICAgICAgICAgIHJvdXRlQ29uZmlnLnNldHRpbmdzID0gcm91dGVDb25maWcuc2V0dGluZ3MgfHwge307XHJcbiAgICAgICAgICAgICAgICBpZiAoIW5hdk1vZGVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmF2TW9kZWwgPSByb3V0ZXIuY3JlYXRlTmF2TW9kZWwocm91dGVDb25maWcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcm91dGVyLmFkZFJvdXRlKHJvdXRlQ29uZmlnLCBuYXZNb2RlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXJzIGFuIHVua25vd24gcm91dGUgaGFuZGxlciB0byBiZSBydW4gd2hlbiB0aGUgVVJMIGZyYWdtZW50IGRvZXNuJ3QgbWF0Y2ggYW55IHJlZ2lzdGVyZWQgcm91dGVzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjb25maWcgQSBzdHJpbmcgY29udGFpbmluZyBhIG1vZHVsZUlkIHRvIGxvYWQsIG9yIGEgW1tSb3V0ZUNvbmZpZ11dLCBvciBhIGZ1bmN0aW9uIHRoYXQgdGFrZXMgdGhlXHJcbiAgICAgKiAgW1tOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb25dXSBhbmQgc2VsZWN0cyBhIG1vZHVsZUlkIHRvIGxvYWQuXHJcbiAgICAgKiBAY2hhaW5hYmxlXHJcbiAgICAgKi9cclxuICAgIG1hcFVua25vd25Sb3V0ZXMoY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy51bmtub3duUm91dGVDb25maWcgPSBjb25maWc7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFwcGxpZXMgdGhlIGN1cnJlbnQgY29uZmlndXJhdGlvbiB0byB0aGUgc3BlY2lmaWVkIFtbUm91dGVyXV0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHJvdXRlciBUaGUgW1tSb3V0ZXJdXSB0byBhcHBseSB0aGUgY29uZmlndXJhdGlvbiB0by5cclxuICAgICAqL1xyXG4gICAgZXhwb3J0VG9Sb3V0ZXIocm91dGVyKSB7XHJcbiAgICAgICAgbGV0IGluc3RydWN0aW9ucyA9IHRoaXMuaW5zdHJ1Y3Rpb25zO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGluc3RydWN0aW9ucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uc1tpXShyb3V0ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgeyB0aXRsZSwgdGl0bGVTZXBhcmF0b3IsIHVua25vd25Sb3V0ZUNvbmZpZywgX2ZhbGxiYWNrUm91dGUsIHZpZXdQb3J0RGVmYXVsdHMgfSA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRpdGxlKSB7XHJcbiAgICAgICAgICAgIHJvdXRlci50aXRsZSA9IHRpdGxlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGl0bGVTZXBhcmF0b3IpIHtcclxuICAgICAgICAgICAgcm91dGVyLnRpdGxlU2VwYXJhdG9yID0gdGl0bGVTZXBhcmF0b3I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh1bmtub3duUm91dGVDb25maWcpIHtcclxuICAgICAgICAgICAgcm91dGVyLmhhbmRsZVVua25vd25Sb3V0ZXModW5rbm93blJvdXRlQ29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKF9mYWxsYmFja1JvdXRlKSB7XHJcbiAgICAgICAgICAgIHJvdXRlci5mYWxsYmFja1JvdXRlID0gX2ZhbGxiYWNrUm91dGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2aWV3UG9ydERlZmF1bHRzKSB7XHJcbiAgICAgICAgICAgIHJvdXRlci51c2VWaWV3UG9ydERlZmF1bHRzKHZpZXdQb3J0RGVmYXVsdHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBPYmplY3QuYXNzaWduKHJvdXRlci5vcHRpb25zLCB0aGlzLm9wdGlvbnMpO1xyXG4gICAgICAgIGxldCBwaXBlbGluZVN0ZXBzID0gdGhpcy5waXBlbGluZVN0ZXBzO1xyXG4gICAgICAgIGxldCBwaXBlbGluZVN0ZXBDb3VudCA9IHBpcGVsaW5lU3RlcHMubGVuZ3RoO1xyXG4gICAgICAgIGlmIChwaXBlbGluZVN0ZXBDb3VudCkge1xyXG4gICAgICAgICAgICBpZiAoIXJvdXRlci5pc1Jvb3QpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGlwZWxpbmUgc3RlcHMgY2FuIG9ubHkgYmUgYWRkZWQgdG8gdGhlIHJvb3Qgcm91dGVyJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IHBpcGVsaW5lUHJvdmlkZXIgPSByb3V0ZXIucGlwZWxpbmVQcm92aWRlcjtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gcGlwZWxpbmVTdGVwQ291bnQ7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgeyBuYW1lLCBzdGVwIH0gPSBwaXBlbGluZVN0ZXBzW2ldO1xyXG4gICAgICAgICAgICAgICAgcGlwZWxpbmVQcm92aWRlci5hZGRTdGVwKG5hbWUsIHN0ZXApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBUaGUgcHJpbWFyeSBjbGFzcyByZXNwb25zaWJsZSBmb3IgaGFuZGxpbmcgcm91dGluZyBhbmQgbmF2aWdhdGlvbi5cclxuICovXHJcbmNsYXNzIFJvdXRlciB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBjb250YWluZXIgVGhlIFtbQ29udGFpbmVyXV0gdG8gdXNlIHdoZW4gY2hpbGQgcm91dGVycy5cclxuICAgICAqIEBwYXJhbSBoaXN0b3J5IFRoZSBbW0hpc3RvcnldXSBpbXBsZW1lbnRhdGlvbiB0byBkZWxlZ2F0ZSBuYXZpZ2F0aW9uIHJlcXVlc3RzIHRvLlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcihjb250YWluZXIsIGhpc3RvcnkpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgcGFyZW50IHJvdXRlciwgb3IgbnVsbCBpZiB0aGlzIGluc3RhbmNlIGlzIG5vdCBhIGNoaWxkIHJvdXRlci5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0ge307XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGRlZmF1bHRzIHVzZWQgd2hlbiBhIHZpZXdwb3J0IGxhY2tzIHNwZWNpZmllZCBjb250ZW50XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy52aWV3UG9ydERlZmF1bHRzID0ge307XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRXh0ZW5zaW9uIHBvaW50IHRvIHRyYW5zZm9ybSB0aGUgZG9jdW1lbnQgdGl0bGUgYmVmb3JlIGl0IGlzIGJ1aWx0IGFuZCBkaXNwbGF5ZWQuXHJcbiAgICAgICAgICogQnkgZGVmYXVsdCwgY2hpbGQgcm91dGVycyBkZWxlZ2F0ZSB0byB0aGUgcGFyZW50IHJvdXRlciwgYW5kIHRoZSBhcHAgcm91dGVyXHJcbiAgICAgICAgICogcmV0dXJucyB0aGUgdGl0bGUgdW5jaGFuZ2VkLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMudHJhbnNmb3JtVGl0bGUgPSAodGl0bGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQudHJhbnNmb3JtVGl0bGUodGl0bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aXRsZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuaGlzdG9yeSA9IGhpc3Rvcnk7XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBGdWxseSByZXNldHMgdGhlIHJvdXRlcidzIGludGVybmFsIHN0YXRlLiBQcmltYXJpbHkgdXNlZCBpbnRlcm5hbGx5IGJ5IHRoZSBmcmFtZXdvcmsgd2hlbiBtdWx0aXBsZSBjYWxscyB0byBzZXRSb290IGFyZSBtYWRlLlxyXG4gICAgICogVXNlIHdpdGggY2F1dGlvbiAoYWN0dWFsbHksIGF2b2lkIHVzaW5nIHRoaXMpLiBEbyBub3QgdXNlIHRoaXMgdG8gc2ltcGx5IGNoYW5nZSB5b3VyIG5hdmlnYXRpb24gbW9kZWwuXHJcbiAgICAgKi9cclxuICAgIHJlc2V0KCkge1xyXG4gICAgICAgIHRoaXMudmlld1BvcnRzID0ge307XHJcbiAgICAgICAgdGhpcy5yb3V0ZXMgPSBbXTtcclxuICAgICAgICB0aGlzLmJhc2VVcmwgPSAnJztcclxuICAgICAgICB0aGlzLmlzQ29uZmlndXJlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNOYXZpZ2F0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc0V4cGxpY2l0TmF2aWdhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNFeHBsaWNpdE5hdmlnYXRpb25CYWNrID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc05hdmlnYXRpbmdGaXJzdCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNOYXZpZ2F0aW5nTmV3ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc05hdmlnYXRpbmdSZWZyZXNoID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc05hdmlnYXRpbmdGb3J3YXJkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc05hdmlnYXRpbmdCYWNrID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jb3VsZERlYWN0aXZhdGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5hdmlnYXRpb24gPSBbXTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRJbnN0cnVjdGlvbiA9IG51bGw7XHJcbiAgICAgICAgdGhpcy52aWV3UG9ydERlZmF1bHRzID0ge307XHJcbiAgICAgICAgdGhpcy5fZmFsbGJhY2tPcmRlciA9IDEwMDtcclxuICAgICAgICB0aGlzLl9yZWNvZ25pemVyID0gbmV3IFJvdXRlUmVjb2duaXplcigpO1xyXG4gICAgICAgIHRoaXMuX2NoaWxkUmVjb2duaXplciA9IG5ldyBSb3V0ZVJlY29nbml6ZXIoKTtcclxuICAgICAgICB0aGlzLl9jb25maWd1cmVkUHJvbWlzZSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlQ29uZmlndXJlZFByb21pc2UgPSByZXNvbHZlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIGEgdmFsdWUgaW5kaWNhdGluZyB3aGV0aGVyIG9yIG5vdCB0aGlzIFtbUm91dGVyXV0gaXMgdGhlIHJvb3QgaW4gdGhlIHJvdXRlciB0cmVlLiBJLmUuLCBpdCBoYXMgbm8gcGFyZW50LlxyXG4gICAgICovXHJcbiAgICBnZXQgaXNSb290KCkge1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5wYXJlbnQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJlZ2lzdGVycyBhIHZpZXdQb3J0IHRvIGJlIHVzZWQgYXMgYSByZW5kZXJpbmcgdGFyZ2V0IGZvciBhY3RpdmF0ZWQgcm91dGVzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2aWV3UG9ydCBUaGUgdmlld1BvcnQuXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBUaGUgbmFtZSBvZiB0aGUgdmlld1BvcnQuICdkZWZhdWx0JyBpZiB1bnNwZWNpZmllZC5cclxuICAgICAqL1xyXG4gICAgcmVnaXN0ZXJWaWV3UG9ydCh2aWV3UG9ydCwgbmFtZSkge1xyXG4gICAgICAgIG5hbWUgPSBuYW1lIHx8ICdkZWZhdWx0JztcclxuICAgICAgICB0aGlzLnZpZXdQb3J0c1tuYW1lXSA9IHZpZXdQb3J0O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gdGhlIHJvdXRlciBpcyBjb25maWd1cmVkLlxyXG4gICAgICovXHJcbiAgICBlbnN1cmVDb25maWd1cmVkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb25maWd1cmVkUHJvbWlzZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ29uZmlndXJlcyB0aGUgcm91dGVyLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjYWxsYmFja09yQ29uZmlnIFRoZSBbW1JvdXRlckNvbmZpZ3VyYXRpb25dXSBvciBhIGNhbGxiYWNrIHRoYXQgdGFrZXMgYSBbW1JvdXRlckNvbmZpZ3VyYXRpb25dXS5cclxuICAgICAqL1xyXG4gICAgY29uZmlndXJlKGNhbGxiYWNrT3JDb25maWcpIHtcclxuICAgICAgICB0aGlzLmlzQ29uZmlndXJlZCA9IHRydWU7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IGNhbGxiYWNrT3JDb25maWc7XHJcbiAgICAgICAgbGV0IGNvbmZpZztcclxuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrT3JDb25maWcgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgY29uZmlnID0gbmV3IFJvdXRlckNvbmZpZ3VyYXRpb24oKTtcclxuICAgICAgICAgICAgcmVzdWx0ID0gY2FsbGJhY2tPckNvbmZpZyhjb25maWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZVxyXG4gICAgICAgICAgICAucmVzb2x2ZShyZXN1bHQpXHJcbiAgICAgICAgICAgIC50aGVuKChjKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjICYmIGMuZXhwb3J0VG9Sb3V0ZXIpIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZyA9IGM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uZmlnLmV4cG9ydFRvUm91dGVyKHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLmlzQ29uZmlndXJlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmVDb25maWd1cmVkUHJvbWlzZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBOYXZpZ2F0ZXMgdG8gYSBuZXcgbG9jYXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGZyYWdtZW50IFRoZSBVUkwgZnJhZ21lbnQgdG8gdXNlIGFzIHRoZSBuYXZpZ2F0aW9uIGRlc3RpbmF0aW9uLlxyXG4gICAgICogQHBhcmFtIG9wdGlvbnMgVGhlIG5hdmlnYXRpb24gb3B0aW9ucy5cclxuICAgICAqL1xyXG4gICAgbmF2aWdhdGUoZnJhZ21lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNDb25maWd1cmVkICYmIHRoaXMucGFyZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5uYXZpZ2F0ZShmcmFnbWVudCwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXNFeHBsaWNpdE5hdmlnYXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhpc3RvcnkubmF2aWdhdGUoX3Jlc29sdmVVcmwoZnJhZ21lbnQsIHRoaXMuYmFzZVVybCwgdGhpcy5oaXN0b3J5Ll9oYXNQdXNoU3RhdGUpLCBvcHRpb25zKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTmF2aWdhdGVzIHRvIGEgbmV3IGxvY2F0aW9uIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHJvdXRlIGFuZCBwYXJhbXMgc3BlY2lmaWVkLiBFcXVpdmFsbGVudCB0byBbW1JvdXRlci5nZW5lcmF0ZV1dIGZvbGxvd2VkXHJcbiAgICAgKiBieSBbW1JvdXRlci5uYXZpZ2F0ZV1dLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSByb3V0ZSBUaGUgbmFtZSBvZiB0aGUgcm91dGUgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyB0aGUgbmF2aWdhdGlvbiBsb2NhdGlvbi5cclxuICAgICAqIEBwYXJhbSBwYXJhbXMgVGhlIHJvdXRlIHBhcmFtZXRlcnMgdG8gYmUgdXNlZCB3aGVuIHBvcHVsYXRpbmcgdGhlIHJvdXRlIHBhdHRlcm4uXHJcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyBUaGUgbmF2aWdhdGlvbiBvcHRpb25zLlxyXG4gICAgICovXHJcbiAgICBuYXZpZ2F0ZVRvUm91dGUocm91dGUsIHBhcmFtcywgb3B0aW9ucykge1xyXG4gICAgICAgIGxldCBwYXRoID0gdGhpcy5nZW5lcmF0ZShyb3V0ZSwgcGFyYW1zKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5uYXZpZ2F0ZShwYXRoLCBvcHRpb25zKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTmF2aWdhdGVzIGJhY2sgdG8gdGhlIG1vc3QgcmVjZW50IGxvY2F0aW9uIGluIGhpc3RvcnkuXHJcbiAgICAgKi9cclxuICAgIG5hdmlnYXRlQmFjaygpIHtcclxuICAgICAgICB0aGlzLmlzRXhwbGljaXROYXZpZ2F0aW9uQmFjayA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5oaXN0b3J5Lm5hdmlnYXRlQmFjaygpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgY2hpbGQgcm91dGVyIG9mIHRoZSBjdXJyZW50IHJvdXRlci5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyIFRoZSBbW0NvbnRhaW5lcl1dIHRvIHByb3ZpZGUgdG8gdGhlIGNoaWxkIHJvdXRlci4gVXNlcyB0aGUgY3VycmVudCBbW1JvdXRlcl1dJ3MgW1tDb250YWluZXJdXSBpZiB1bnNwZWNpZmllZC5cclxuICAgICAqIEByZXR1cm5zIHtSb3V0ZXJ9IFRoZSBuZXcgY2hpbGQgUm91dGVyLlxyXG4gICAgICovXHJcbiAgICBjcmVhdGVDaGlsZChjb250YWluZXIpIHtcclxuICAgICAgICBsZXQgY2hpbGRSb3V0ZXIgPSBuZXcgUm91dGVyKGNvbnRhaW5lciB8fCB0aGlzLmNvbnRhaW5lci5jcmVhdGVDaGlsZCgpLCB0aGlzLmhpc3RvcnkpO1xyXG4gICAgICAgIGNoaWxkUm91dGVyLnBhcmVudCA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIGNoaWxkUm91dGVyO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBHZW5lcmF0ZXMgYSBVUkwgZnJhZ21lbnQgbWF0Y2hpbmcgdGhlIHNwZWNpZmllZCByb3V0ZSBwYXR0ZXJuLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIG9mIHRoZSByb3V0ZSB3aG9zZSBwYXR0ZXJuIHNob3VsZCBiZSB1c2VkIHRvIGdlbmVyYXRlIHRoZSBmcmFnbWVudC5cclxuICAgICAqIEBwYXJhbSBwYXJhbXMgVGhlIHJvdXRlIHBhcmFtcyB0byBiZSB1c2VkIHRvIHBvcHVsYXRlIHRoZSByb3V0ZSBwYXR0ZXJuLlxyXG4gICAgICogQHBhcmFtIG9wdGlvbnMgSWYgb3B0aW9ucy5hYnNvbHV0ZSA9IHRydWUsIHRoZW4gYWJzb2x1dGUgdXJsIHdpbGwgYmUgZ2VuZXJhdGVkOyBvdGhlcndpc2UsIGl0IHdpbGwgYmUgcmVsYXRpdmUgdXJsLlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ30gQSBzdHJpbmcgY29udGFpbmluZyB0aGUgZ2VuZXJhdGVkIFVSTCBmcmFnbWVudC5cclxuICAgICAqL1xyXG4gICAgZ2VuZXJhdGUobmFtZU9yUm91dGUsIHBhcmFtcyA9IHt9LCBvcHRpb25zID0ge30pIHtcclxuICAgICAgICAvLyBBIGNoaWxkIHJlY29nbml6ZXIgZ2VuZXJhdGVzIHJvdXRlcyBmb3IgcG90ZW50aWFsIGNoaWxkIHJvdXRlcy4gQW55IHBvdGVudGlhbCBjaGlsZCByb3V0ZSBpcyBhZGRlZFxyXG4gICAgICAgIC8vIHRvIHRoZSBjaGlsZFJvdXRlIHByb3BlcnR5IG9mIHBhcmFtcyBmb3IgdGhlIGNoaWxkUm91dGVyIHRvIHJlY29nbml6ZS4gV2hlbiBnZW5lcmF0aW5nIHJvdXRlcywgd2VcclxuICAgICAgICAvLyB1c2UgdGhlIGNoaWxkUmVjb2duaXplciB3aGVuIGNoaWxkUm91dGUgcGFyYW1zIGFyZSBhdmFpbGFibGUgdG8gZ2VuZXJhdGUgYSBjaGlsZCByb3V0ZXIgZW5hYmxlZCByb3V0ZS5cclxuICAgICAgICBsZXQgcmVjb2duaXplciA9ICdjaGlsZFJvdXRlJyBpbiBwYXJhbXMgPyB0aGlzLl9jaGlsZFJlY29nbml6ZXIgOiB0aGlzLl9yZWNvZ25pemVyO1xyXG4gICAgICAgIGxldCBoYXNSb3V0ZSA9IHJlY29nbml6ZXIuaGFzUm91dGUobmFtZU9yUm91dGUpO1xyXG4gICAgICAgIGlmICghaGFzUm91dGUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZ2VuZXJhdGUobmFtZU9yUm91dGUsIHBhcmFtcywgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBIHJvdXRlIHdpdGggbmFtZSAnJHtuYW1lT3JSb3V0ZX0nIGNvdWxkIG5vdCBiZSBmb3VuZC4gQ2hlY2sgdGhhdCBcXGBuYW1lOiAnJHtuYW1lT3JSb3V0ZX0nXFxgIHdhcyBzcGVjaWZpZWQgaW4gdGhlIHJvdXRlJ3MgY29uZmlnLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgcGF0aCA9IHJlY29nbml6ZXIuZ2VuZXJhdGUobmFtZU9yUm91dGUsIHBhcmFtcyk7XHJcbiAgICAgICAgbGV0IHJvb3RlZFBhdGggPSBfY3JlYXRlUm9vdGVkUGF0aChwYXRoLCB0aGlzLmJhc2VVcmwsIHRoaXMuaGlzdG9yeS5faGFzUHVzaFN0YXRlLCBvcHRpb25zLmFic29sdXRlKTtcclxuICAgICAgICByZXR1cm4gb3B0aW9ucy5hYnNvbHV0ZSA/IGAke3RoaXMuaGlzdG9yeS5nZXRBYnNvbHV0ZVJvb3QoKX0ke3Jvb3RlZFBhdGh9YCA6IHJvb3RlZFBhdGg7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBbW05hdk1vZGVsXV0gZm9yIHRoZSBzcGVjaWZpZWQgcm91dGUgY29uZmlnLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjb25maWcgVGhlIHJvdXRlIGNvbmZpZy5cclxuICAgICAqL1xyXG4gICAgY3JlYXRlTmF2TW9kZWwoY29uZmlnKSB7XHJcbiAgICAgICAgbGV0IG5hdk1vZGVsID0gbmV3IE5hdk1vZGVsKHRoaXMsICdocmVmJyBpbiBjb25maWdcclxuICAgICAgICAgICAgPyBjb25maWcuaHJlZlxyXG4gICAgICAgICAgICAvLyBwb3RlbnRpYWwgZXJyb3Igd2hlbiBjb25maWcucm91dGUgaXMgYSBzdHJpbmdbXSA/XHJcbiAgICAgICAgICAgIDogY29uZmlnLnJvdXRlKTtcclxuICAgICAgICBuYXZNb2RlbC50aXRsZSA9IGNvbmZpZy50aXRsZTtcclxuICAgICAgICBuYXZNb2RlbC5vcmRlciA9IGNvbmZpZy5uYXY7XHJcbiAgICAgICAgbmF2TW9kZWwuaHJlZiA9IGNvbmZpZy5ocmVmO1xyXG4gICAgICAgIG5hdk1vZGVsLnNldHRpbmdzID0gY29uZmlnLnNldHRpbmdzO1xyXG4gICAgICAgIG5hdk1vZGVsLmNvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICByZXR1cm4gbmF2TW9kZWw7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJlZ2lzdGVycyBhIG5ldyByb3V0ZSB3aXRoIHRoZSByb3V0ZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGNvbmZpZyBUaGUgW1tSb3V0ZUNvbmZpZ11dLlxyXG4gICAgICogQHBhcmFtIG5hdk1vZGVsIFRoZSBbW05hdk1vZGVsXV0gdG8gdXNlIGZvciB0aGUgcm91dGUuIE1heSBiZSBvbWl0dGVkIGZvciBzaW5nbGUtcGF0dGVybiByb3V0ZXMuXHJcbiAgICAgKi9cclxuICAgIGFkZFJvdXRlKGNvbmZpZywgbmF2TW9kZWwpIHtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb25maWcucm91dGUpKSB7XHJcbiAgICAgICAgICAgIGxldCByb3V0ZUNvbmZpZ3MgPSBfZW5zdXJlQXJyYXlXaXRoU2luZ2xlUm91dGVQZXJDb25maWcoY29uZmlnKTtcclxuICAgICAgICAgICAgLy8gdGhlIGZvbGxvd2luZyBpcyB3cm9uZy4gdG9kbzogZml4IHRoaXMgYWZ0ZXIgVFMgcmVmYWN0b3JpbmcgcmVsZWFzZVxyXG4gICAgICAgICAgICByb3V0ZUNvbmZpZ3MuZm9yRWFjaCh0aGlzLmFkZFJvdXRlLmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlUm91dGVDb25maWcoY29uZmlnKTtcclxuICAgICAgICBpZiAoISgndmlld1BvcnRzJyBpbiBjb25maWcpICYmICFjb25maWcubmF2aWdhdGlvblN0cmF0ZWd5KSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy52aWV3UG9ydHMgPSB7XHJcbiAgICAgICAgICAgICAgICAnZGVmYXVsdCc6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2R1bGVJZDogY29uZmlnLm1vZHVsZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6IGNvbmZpZy52aWV3XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbmF2TW9kZWwpIHtcclxuICAgICAgICAgICAgbmF2TW9kZWwgPSB0aGlzLmNyZWF0ZU5hdk1vZGVsKGNvbmZpZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucm91dGVzLnB1c2goY29uZmlnKTtcclxuICAgICAgICBsZXQgcGF0aCA9IGNvbmZpZy5yb3V0ZTtcclxuICAgICAgICBpZiAocGF0aC5jaGFyQXQoMCkgPT09ICcvJykge1xyXG4gICAgICAgICAgICBwYXRoID0gcGF0aC5zdWJzdHIoMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBjYXNlU2Vuc2l0aXZlID0gY29uZmlnLmNhc2VTZW5zaXRpdmUgPT09IHRydWU7XHJcbiAgICAgICAgbGV0IHN0YXRlID0gdGhpcy5fcmVjb2duaXplci5hZGQoe1xyXG4gICAgICAgICAgICBwYXRoOiBwYXRoLFxyXG4gICAgICAgICAgICBoYW5kbGVyOiBjb25maWcsXHJcbiAgICAgICAgICAgIGNhc2VTZW5zaXRpdmU6IGNhc2VTZW5zaXRpdmVcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAocGF0aCkge1xyXG4gICAgICAgICAgICBsZXQgc2V0dGluZ3MgPSBjb25maWcuc2V0dGluZ3M7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBjb25maWcuc2V0dGluZ3M7XHJcbiAgICAgICAgICAgIGxldCB3aXRoQ2hpbGQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbmZpZykpO1xyXG4gICAgICAgICAgICBjb25maWcuc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgICAgICAgICAgd2l0aENoaWxkLnJvdXRlID0gYCR7cGF0aH0vKmNoaWxkUm91dGVgO1xyXG4gICAgICAgICAgICB3aXRoQ2hpbGQuaGFzQ2hpbGRSb3V0ZXIgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9jaGlsZFJlY29nbml6ZXIuYWRkKHtcclxuICAgICAgICAgICAgICAgIHBhdGg6IHdpdGhDaGlsZC5yb3V0ZSxcclxuICAgICAgICAgICAgICAgIGhhbmRsZXI6IHdpdGhDaGlsZCxcclxuICAgICAgICAgICAgICAgIGNhc2VTZW5zaXRpdmU6IGNhc2VTZW5zaXRpdmVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHdpdGhDaGlsZC5uYXZNb2RlbCA9IG5hdk1vZGVsO1xyXG4gICAgICAgICAgICB3aXRoQ2hpbGQuc2V0dGluZ3MgPSBjb25maWcuc2V0dGluZ3M7XHJcbiAgICAgICAgICAgIHdpdGhDaGlsZC5uYXZpZ2F0aW9uU3RyYXRlZ3kgPSBjb25maWcubmF2aWdhdGlvblN0cmF0ZWd5O1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25maWcubmF2TW9kZWwgPSBuYXZNb2RlbDtcclxuICAgICAgICBsZXQgbmF2aWdhdGlvbiA9IHRoaXMubmF2aWdhdGlvbjtcclxuICAgICAgICBpZiAoKG5hdk1vZGVsLm9yZGVyIHx8IG5hdk1vZGVsLm9yZGVyID09PSAwKSAmJiBuYXZpZ2F0aW9uLmluZGV4T2YobmF2TW9kZWwpID09PSAtMSkge1xyXG4gICAgICAgICAgICBpZiAoKCFuYXZNb2RlbC5ocmVmICYmIG5hdk1vZGVsLmhyZWYgIT09ICcnKSAmJiAoc3RhdGUudHlwZXMuZHluYW1pY3MgfHwgc3RhdGUudHlwZXMuc3RhcnMpKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcm91dGUgY29uZmlnIGZvciBcIicgKyBjb25maWcucm91dGUgKyAnXCIgOiBkeW5hbWljIHJvdXRlcyBtdXN0IHNwZWNpZnkgYW4gXCJocmVmOlwiIHRvIGJlIGluY2x1ZGVkIGluIHRoZSBuYXZpZ2F0aW9uIG1vZGVsLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbmF2TW9kZWwub3JkZXIgIT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgICAgICBuYXZNb2RlbC5vcmRlciA9ICsrdGhpcy5fZmFsbGJhY2tPcmRlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBuYXZpZ2F0aW9uLnB1c2gobmF2TW9kZWwpO1xyXG4gICAgICAgICAgICAvLyB0aGlzIGlzIGEgcG90ZW50aWFsIGVycm9yIC8gaW5jb25zaXN0ZW5jeSBiZXR3ZWVuIGJyb3dzZXJzXHJcbiAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgIC8vIE1ETjogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvc29ydFxyXG4gICAgICAgICAgICAvLyBJZiBjb21wYXJlRnVuY3Rpb24oYSwgYikgcmV0dXJucyAwLCBsZWF2ZSBhIGFuZCBiIHVuY2hhbmdlZCB3aXRoIHJlc3BlY3QgdG8gZWFjaCBvdGhlcixcclxuICAgICAgICAgICAgLy8gYnV0IHNvcnRlZCB3aXRoIHJlc3BlY3QgdG8gYWxsIGRpZmZlcmVudCBlbGVtZW50cy5cclxuICAgICAgICAgICAgLy8gTm90ZTogdGhlIEVDTUFzY3JpcHQgc3RhbmRhcmQgZG9lcyBub3QgZ3VhcmFudGVlIHRoaXMgYmVoYXZpb3VyLFxyXG4gICAgICAgICAgICAvLyBhbmQgdGh1cyBub3QgYWxsIGJyb3dzZXJzIChlLmcuIE1vemlsbGEgdmVyc2lvbnMgZGF0aW5nIGJhY2sgdG8gYXQgbGVhc3QgMjAwMykgcmVzcGVjdCB0aGlzLlxyXG4gICAgICAgICAgICBuYXZpZ2F0aW9uLnNvcnQoKGEsIGIpID0+IGEub3JkZXIgLSBiLm9yZGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEdldHMgYSB2YWx1ZSBpbmRpY2F0aW5nIHdoZXRoZXIgb3Igbm90IHRoaXMgW1tSb3V0ZXJdXSBvciBvbmUgb2YgaXRzIGFuY2VzdG9ycyBoYXMgYSByb3V0ZSByZWdpc3RlcmVkIHdpdGggdGhlIHNwZWNpZmllZCBuYW1lLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIG9mIHRoZSByb3V0ZSB0byBjaGVjay5cclxuICAgICAqL1xyXG4gICAgaGFzUm91dGUobmFtZSkge1xyXG4gICAgICAgIHJldHVybiAhISh0aGlzLl9yZWNvZ25pemVyLmhhc1JvdXRlKG5hbWUpIHx8IHRoaXMucGFyZW50ICYmIHRoaXMucGFyZW50Lmhhc1JvdXRlKG5hbWUpKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyBhIHZhbHVlIGluZGljYXRpbmcgd2hldGhlciBvciBub3QgdGhpcyBbW1JvdXRlcl1dIGhhcyBhIHJvdXRlIHJlZ2lzdGVyZWQgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG5hbWUgVGhlIG5hbWUgb2YgdGhlIHJvdXRlIHRvIGNoZWNrLlxyXG4gICAgICovXHJcbiAgICBoYXNPd25Sb3V0ZShuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlY29nbml6ZXIuaGFzUm91dGUobmFtZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJlZ2lzdGVyIGEgaGFuZGxlciB0byB1c2Ugd2hlbiB0aGUgaW5jb21pbmcgVVJMIGZyYWdtZW50IGRvZXNuJ3QgbWF0Y2ggYW55IHJlZ2lzdGVyZWQgcm91dGVzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjb25maWcgVGhlIG1vZHVsZUlkLCBvciBhIGZ1bmN0aW9uIHRoYXQgc2VsZWN0cyB0aGUgbW9kdWxlSWQsIG9yIGEgW1tSb3V0ZUNvbmZpZ11dLlxyXG4gICAgICovXHJcbiAgICBoYW5kbGVVbmtub3duUm91dGVzKGNvbmZpZykge1xyXG4gICAgICAgIGlmICghY29uZmlnKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB1bmtub3duIHJvdXRlIGhhbmRsZXInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYXRjaEFsbEhhbmRsZXIgPSBpbnN0cnVjdGlvbiA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgICAgICAuX2NyZWF0ZVJvdXRlQ29uZmlnKGNvbmZpZywgaW5zdHJ1Y3Rpb24pXHJcbiAgICAgICAgICAgICAgICAudGhlbihjID0+IHtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uLmNvbmZpZyA9IGM7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgdGhlIGRvY3VtZW50IHRpdGxlIHVzaW5nIHRoZSBjdXJyZW50IG5hdmlnYXRpb24gaW5zdHJ1Y3Rpb24uXHJcbiAgICAgKi9cclxuICAgIHVwZGF0ZVRpdGxlKCkge1xyXG4gICAgICAgIGxldCBwYXJlbnRSb3V0ZXIgPSB0aGlzLnBhcmVudDtcclxuICAgICAgICBpZiAocGFyZW50Um91dGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnRSb3V0ZXIudXBkYXRlVGl0bGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGN1cnJlbnRJbnN0cnVjdGlvbiA9IHRoaXMuY3VycmVudEluc3RydWN0aW9uO1xyXG4gICAgICAgIGlmIChjdXJyZW50SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgY3VycmVudEluc3RydWN0aW9uLl91cGRhdGVUaXRsZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSBuYXZpZ2F0aW9uIHJvdXRlcyB3aXRoIGhyZWZzIHJlbGF0aXZlIHRvIHRoZSBjdXJyZW50IGxvY2F0aW9uLlxyXG4gICAgICogTm90ZTogVGhpcyBtZXRob2Qgd2lsbCBsaWtlbHkgbW92ZSB0byBhIHBsdWdpbiBpbiBhIGZ1dHVyZSByZWxlYXNlLlxyXG4gICAgICovXHJcbiAgICByZWZyZXNoTmF2aWdhdGlvbigpIHtcclxuICAgICAgICBsZXQgbmF2ID0gdGhpcy5uYXZpZ2F0aW9uO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBuYXYubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnQgPSBuYXZbaV07XHJcbiAgICAgICAgICAgIGlmICghY3VycmVudC5jb25maWcuaHJlZikge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudC5ocmVmID0gX2NyZWF0ZVJvb3RlZFBhdGgoY3VycmVudC5yZWxhdGl2ZUhyZWYsIHRoaXMuYmFzZVVybCwgdGhpcy5oaXN0b3J5Ll9oYXNQdXNoU3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudC5ocmVmID0gX25vcm1hbGl6ZUFic29sdXRlUGF0aChjdXJyZW50LmNvbmZpZy5ocmVmLCB0aGlzLmhpc3RvcnkuX2hhc1B1c2hTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFNldHMgdGhlIGRlZmF1bHQgY29uZmlndXJhdGlvbiBmb3IgdGhlIHZpZXcgcG9ydHMuIFRoaXMgc3BlY2lmaWVzIGhvdyB0b1xyXG4gICAgICogIHBvcHVsYXRlIGEgdmlldyBwb3J0IGZvciB3aGljaCBubyBtb2R1bGUgaXMgc3BlY2lmaWVkLiBUaGUgZGVmYXVsdCBpc1xyXG4gICAgICogIGFuIGVtcHR5IHZpZXcvdmlldy1tb2RlbCBwYWlyLlxyXG4gICAgICovXHJcbiAgICB1c2VWaWV3UG9ydERlZmF1bHRzKCR2aWV3UG9ydERlZmF1bHRzKSB7XHJcbiAgICAgICAgLy8gYSB3b3JrYXJvdW5kIHRvIGhhdmUgc3Ryb25nIHR5cGluZ3Mgd2hpbGUgbm90IHJlcXVpcmluZyB0byBleHBvc2UgaW50ZXJmYWNlIFZpZXdQb3J0SW5zdHJ1Y3Rpb25cclxuICAgICAgICBsZXQgdmlld1BvcnREZWZhdWx0cyA9ICR2aWV3UG9ydERlZmF1bHRzO1xyXG4gICAgICAgIGZvciAobGV0IHZpZXdQb3J0TmFtZSBpbiB2aWV3UG9ydERlZmF1bHRzKSB7XHJcbiAgICAgICAgICAgIGxldCB2aWV3UG9ydENvbmZpZyA9IHZpZXdQb3J0RGVmYXVsdHNbdmlld1BvcnROYW1lXTtcclxuICAgICAgICAgICAgdGhpcy52aWV3UG9ydERlZmF1bHRzW3ZpZXdQb3J0TmFtZV0gPSB7XHJcbiAgICAgICAgICAgICAgICBtb2R1bGVJZDogdmlld1BvcnRDb25maWcubW9kdWxlSWRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipAaW50ZXJuYWwgKi9cclxuICAgIF9yZWZyZXNoQmFzZVVybCgpIHtcclxuICAgICAgICBsZXQgcGFyZW50Um91dGVyID0gdGhpcy5wYXJlbnQ7XHJcbiAgICAgICAgaWYgKHBhcmVudFJvdXRlcikge1xyXG4gICAgICAgICAgICB0aGlzLmJhc2VVcmwgPSBnZW5lcmF0ZUJhc2VVcmwocGFyZW50Um91dGVyLCBwYXJlbnRSb3V0ZXIuY3VycmVudEluc3RydWN0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipAaW50ZXJuYWwgKi9cclxuICAgIF9jcmVhdGVOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24odXJsID0gJycsIHBhcmVudEluc3RydWN0aW9uID0gbnVsbCkge1xyXG4gICAgICAgIGxldCBmcmFnbWVudCA9IHVybDtcclxuICAgICAgICBsZXQgcXVlcnlTdHJpbmcgPSAnJztcclxuICAgICAgICBsZXQgcXVlcnlJbmRleCA9IHVybC5pbmRleE9mKCc/Jyk7XHJcbiAgICAgICAgaWYgKHF1ZXJ5SW5kZXggIT09IC0xKSB7XHJcbiAgICAgICAgICAgIGZyYWdtZW50ID0gdXJsLnN1YnN0cigwLCBxdWVyeUluZGV4KTtcclxuICAgICAgICAgICAgcXVlcnlTdHJpbmcgPSB1cmwuc3Vic3RyKHF1ZXJ5SW5kZXggKyAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHVybFJlY29nbml6YXRpb25SZXN1bHRzID0gdGhpcy5fcmVjb2duaXplci5yZWNvZ25pemUodXJsKTtcclxuICAgICAgICBpZiAoIXVybFJlY29nbml6YXRpb25SZXN1bHRzIHx8ICF1cmxSZWNvZ25pemF0aW9uUmVzdWx0cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdXJsUmVjb2duaXphdGlvblJlc3VsdHMgPSB0aGlzLl9jaGlsZFJlY29nbml6ZXIucmVjb2duaXplKHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpbnN0cnVjdGlvbkluaXQgPSB7XHJcbiAgICAgICAgICAgIGZyYWdtZW50LFxyXG4gICAgICAgICAgICBxdWVyeVN0cmluZyxcclxuICAgICAgICAgICAgY29uZmlnOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJlbnRJbnN0cnVjdGlvbixcclxuICAgICAgICAgICAgcHJldmlvdXNJbnN0cnVjdGlvbjogdGhpcy5jdXJyZW50SW5zdHJ1Y3Rpb24sXHJcbiAgICAgICAgICAgIHJvdXRlcjogdGhpcyxcclxuICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgY29tcGFyZVF1ZXJ5UGFyYW1zOiB0aGlzLm9wdGlvbnMuY29tcGFyZVF1ZXJ5UGFyYW1zXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCByZXN1bHQ7XHJcbiAgICAgICAgaWYgKHVybFJlY29nbml6YXRpb25SZXN1bHRzICYmIHVybFJlY29nbml6YXRpb25SZXN1bHRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBsZXQgZmlyc3QgPSB1cmxSZWNvZ25pemF0aW9uUmVzdWx0c1swXTtcclxuICAgICAgICAgICAgbGV0IGluc3RydWN0aW9uID0gbmV3IE5hdmlnYXRpb25JbnN0cnVjdGlvbihPYmplY3QuYXNzaWduKHt9LCBpbnN0cnVjdGlvbkluaXQsIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtczogZmlyc3QucGFyYW1zLFxyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXM6IGZpcnN0LnF1ZXJ5UGFyYW1zIHx8IHVybFJlY29nbml6YXRpb25SZXN1bHRzLnF1ZXJ5UGFyYW1zLFxyXG4gICAgICAgICAgICAgICAgY29uZmlnOiBmaXJzdC5jb25maWcgfHwgZmlyc3QuaGFuZGxlclxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZmlyc3QuaGFuZGxlciA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gZXZhbHVhdGVOYXZpZ2F0aW9uU3RyYXRlZ3koaW5zdHJ1Y3Rpb24sIGZpcnN0LmhhbmRsZXIsIGZpcnN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChmaXJzdC5oYW5kbGVyICYmIHR5cGVvZiBmaXJzdC5oYW5kbGVyLm5hdmlnYXRpb25TdHJhdGVneSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gZXZhbHVhdGVOYXZpZ2F0aW9uU3RyYXRlZ3koaW5zdHJ1Y3Rpb24sIGZpcnN0LmhhbmRsZXIubmF2aWdhdGlvblN0cmF0ZWd5LCBmaXJzdC5oYW5kbGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFByb21pc2UucmVzb2x2ZShpbnN0cnVjdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5jYXRjaEFsbEhhbmRsZXIpIHtcclxuICAgICAgICAgICAgbGV0IGluc3RydWN0aW9uID0gbmV3IE5hdmlnYXRpb25JbnN0cnVjdGlvbihPYmplY3QuYXNzaWduKHt9LCBpbnN0cnVjdGlvbkluaXQsIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtczogeyBwYXRoOiBmcmFnbWVudCB9LFxyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXM6IHVybFJlY29nbml6YXRpb25SZXN1bHRzID8gdXJsUmVjb2duaXphdGlvblJlc3VsdHMucXVlcnlQYXJhbXMgOiB7fSxcclxuICAgICAgICAgICAgICAgIGNvbmZpZzogbnVsbCAvLyBjb25maWcgd2lsbCBiZSBjcmVhdGVkIGJ5IHRoZSBjYXRjaEFsbEhhbmRsZXJcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICByZXN1bHQgPSBldmFsdWF0ZU5hdmlnYXRpb25TdHJhdGVneShpbnN0cnVjdGlvbiwgdGhpcy5jYXRjaEFsbEhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLnBhcmVudCkge1xyXG4gICAgICAgICAgICBsZXQgcm91dGVyID0gdGhpcy5fcGFyZW50Q2F0Y2hBbGxIYW5kbGVyKHRoaXMucGFyZW50KTtcclxuICAgICAgICAgICAgaWYgKHJvdXRlcikge1xyXG4gICAgICAgICAgICAgICAgbGV0IG5ld1BhcmVudEluc3RydWN0aW9uID0gdGhpcy5fZmluZFBhcmVudEluc3RydWN0aW9uRnJvbVJvdXRlcihyb3V0ZXIsIHBhcmVudEluc3RydWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIGxldCBpbnN0cnVjdGlvbiA9IG5ldyBOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24oT2JqZWN0LmFzc2lnbih7fSwgaW5zdHJ1Y3Rpb25Jbml0LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7IHBhdGg6IGZyYWdtZW50IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXM6IHVybFJlY29nbml6YXRpb25SZXN1bHRzID8gdXJsUmVjb2duaXphdGlvblJlc3VsdHMucXVlcnlQYXJhbXMgOiB7fSxcclxuICAgICAgICAgICAgICAgICAgICByb3V0ZXI6IHJvdXRlcixcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRJbnN0cnVjdGlvbjogbmV3UGFyZW50SW5zdHJ1Y3Rpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Q2F0Y2hIYW5kbGVyOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZzogbnVsbCAvLyBjb25maWcgd2lsbCBiZSBjcmVhdGVkIGJ5IHRoZSBjaGFpbmVkIHBhcmVudCBjYXRjaEFsbEhhbmRsZXJcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGV2YWx1YXRlTmF2aWdhdGlvblN0cmF0ZWd5KGluc3RydWN0aW9uLCByb3V0ZXIuY2F0Y2hBbGxIYW5kbGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocmVzdWx0ICYmIHBhcmVudEluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmFzZVVybCA9IGdlbmVyYXRlQmFzZVVybCh0aGlzLnBhcmVudCwgcGFyZW50SW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihgUm91dGUgbm90IGZvdW5kOiAke3VybH1gKSk7XHJcbiAgICB9XHJcbiAgICAvKipAaW50ZXJuYWwgKi9cclxuICAgIF9maW5kUGFyZW50SW5zdHJ1Y3Rpb25Gcm9tUm91dGVyKHJvdXRlciwgaW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICBpZiAoaW5zdHJ1Y3Rpb24ucm91dGVyID09PSByb3V0ZXIpIHtcclxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24uZnJhZ21lbnQgPSByb3V0ZXIuYmFzZVVybDsgLy8gbmVlZCB0byBjaGFuZ2UgdGhlIGZyYWdtZW50IGluIGNhc2Ugb2YgYSByZWRpcmVjdCBpbnN0ZWFkIG9mIG1vZHVsZUlkXHJcbiAgICAgICAgICAgIHJldHVybiBpbnN0cnVjdGlvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5zdHJ1Y3Rpb24ucGFyZW50SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbmRQYXJlbnRJbnN0cnVjdGlvbkZyb21Sb3V0ZXIocm91dGVyLCBpbnN0cnVjdGlvbi5wYXJlbnRJbnN0cnVjdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICAvKipAaW50ZXJuYWwgKi9cclxuICAgIF9wYXJlbnRDYXRjaEFsbEhhbmRsZXIocm91dGVyKSB7XHJcbiAgICAgICAgaWYgKHJvdXRlci5jYXRjaEFsbEhhbmRsZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJvdXRlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocm91dGVyLnBhcmVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcGFyZW50Q2F0Y2hBbGxIYW5kbGVyKHJvdXRlci5wYXJlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICovXHJcbiAgICBfY3JlYXRlUm91dGVDb25maWcoY29uZmlnLCBpbnN0cnVjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlXHJcbiAgICAgICAgICAgIC5yZXNvbHZlKGNvbmZpZylcclxuICAgICAgICAgICAgLnRoZW4oKGMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgbW9kdWxlSWQ6IGMgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgYyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGMoaW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC8vIHR5cGluZyBoZXJlIGNvdWxkIGJlIGVpdGhlciBSb3V0ZUNvbmZpZyBvciBSZWRpcmVjdENvbmZpZ1xyXG4gICAgICAgICAgICAvLyBidXQgdGVtcG9yYXJpbHkgdHJlYXQgYm90aCBhcyBSb3V0ZUNvbmZpZ1xyXG4gICAgICAgICAgICAvLyB0b2RvOiBpbXByb3ZlIHR5cGluZ3MgcHJlY2lzaW9uXHJcbiAgICAgICAgICAgIC50aGVuKChjKSA9PiB0eXBlb2YgYyA9PT0gJ3N0cmluZycgPyB7IG1vZHVsZUlkOiBjIH0gOiBjKVxyXG4gICAgICAgICAgICAudGhlbigoYykgPT4ge1xyXG4gICAgICAgICAgICBjLnJvdXRlID0gaW5zdHJ1Y3Rpb24ucGFyYW1zLnBhdGg7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlUm91dGVDb25maWcoYyk7XHJcbiAgICAgICAgICAgIGlmICghYy5uYXZNb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgYy5uYXZNb2RlbCA9IHRoaXMuY3JlYXRlTmF2TW9kZWwoYyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGM7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuLyogQGludGVybmFsIGV4cG9ydGVkIGZvciB1bml0IHRlc3RpbmcgKi9cclxuY29uc3QgZ2VuZXJhdGVCYXNlVXJsID0gKHJvdXRlciwgaW5zdHJ1Y3Rpb24pID0+IHtcclxuICAgIHJldHVybiBgJHtyb3V0ZXIuYmFzZVVybCB8fCAnJ30ke2luc3RydWN0aW9uLmdldEJhc2VVcmwoKSB8fCAnJ31gO1xyXG59O1xyXG4vKiBAaW50ZXJuYWwgZXhwb3J0ZWQgZm9yIHVuaXQgdGVzdGluZyAqL1xyXG5jb25zdCB2YWxpZGF0ZVJvdXRlQ29uZmlnID0gKGNvbmZpZykgPT4ge1xyXG4gICAgaWYgKHR5cGVvZiBjb25maWcgIT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIFJvdXRlIENvbmZpZycpO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBjb25maWcucm91dGUgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgbGV0IG5hbWUgPSBjb25maWcubmFtZSB8fCAnKG5vIG5hbWUpJztcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgUm91dGUgQ29uZmlnIGZvciBcIicgKyBuYW1lICsgJ1wiOiBZb3UgbXVzdCBzcGVjaWZ5IGEgXCJyb3V0ZTpcIiBwYXR0ZXJuLicpO1xyXG4gICAgfVxyXG4gICAgaWYgKCEoJ3JlZGlyZWN0JyBpbiBjb25maWcgfHwgY29uZmlnLm1vZHVsZUlkIHx8IGNvbmZpZy5uYXZpZ2F0aW9uU3RyYXRlZ3kgfHwgY29uZmlnLnZpZXdQb3J0cykpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgUm91dGUgQ29uZmlnIGZvciBcIicgKyBjb25maWcucm91dGUgKyAnXCI6IFlvdSBtdXN0IHNwZWNpZnkgYSBcIm1vZHVsZUlkOlwiLCBcInJlZGlyZWN0OlwiLCBcIm5hdmlnYXRpb25TdHJhdGVneTpcIiwgb3IgXCJ2aWV3UG9ydHM6XCIuJyk7XHJcbiAgICB9XHJcbn07XHJcbi8qIEBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nICovXHJcbmNvbnN0IGV2YWx1YXRlTmF2aWdhdGlvblN0cmF0ZWd5ID0gKGluc3RydWN0aW9uLCBldmFsdWF0b3IsIGNvbnRleHQpID0+IHtcclxuICAgIHJldHVybiBQcm9taXNlXHJcbiAgICAgICAgLnJlc29sdmUoZXZhbHVhdG9yLmNhbGwoY29udGV4dCwgaW5zdHJ1Y3Rpb24pKVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBpZiAoISgndmlld1BvcnRzJyBpbiBpbnN0cnVjdGlvbi5jb25maWcpKSB7XHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uLmNvbmZpZy52aWV3UG9ydHMgPSB7XHJcbiAgICAgICAgICAgICAgICAnZGVmYXVsdCc6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2R1bGVJZDogaW5zdHJ1Y3Rpb24uY29uZmlnLm1vZHVsZUlkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbnN0cnVjdGlvbjtcclxuICAgIH0pO1xyXG59O1xuXG4vKipAaW50ZXJuYWwgZXhwb3J0ZWQgZm9yIHVuaXQgdGVzdGluZyAqL1xyXG5jb25zdCBjcmVhdGVOZXh0Rm4gPSAoaW5zdHJ1Y3Rpb24sIHN0ZXBzKSA9PiB7XHJcbiAgICBsZXQgaW5kZXggPSAtMTtcclxuICAgIGNvbnN0IG5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaW5kZXgrKztcclxuICAgICAgICBpZiAoaW5kZXggPCBzdGVwcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnRTdGVwID0gc3RlcHNbaW5kZXhdO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRTdGVwKGluc3RydWN0aW9uLCBuZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5leHQucmVqZWN0KGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV4dC5jb21wbGV0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBuZXh0LmNvbXBsZXRlID0gY3JlYXRlQ29tcGxldGlvbkhhbmRsZXIobmV4dCwgXCJjb21wbGV0ZWRcIiAvKiBDb21wbGV0ZWQgKi8pO1xyXG4gICAgbmV4dC5jYW5jZWwgPSBjcmVhdGVDb21wbGV0aW9uSGFuZGxlcihuZXh0LCBcImNhbmNlbGVkXCIgLyogQ2FuY2VsZWQgKi8pO1xyXG4gICAgbmV4dC5yZWplY3QgPSBjcmVhdGVDb21wbGV0aW9uSGFuZGxlcihuZXh0LCBcInJlamVjdGVkXCIgLyogUmVqZWN0ZWQgKi8pO1xyXG4gICAgcmV0dXJuIG5leHQ7XHJcbn07XHJcbi8qKkBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nICovXHJcbmNvbnN0IGNyZWF0ZUNvbXBsZXRpb25IYW5kbGVyID0gKG5leHQsIHN0YXR1cykgPT4ge1xyXG4gICAgcmV0dXJuIChvdXRwdXQpID0+IFByb21pc2VcclxuICAgICAgICAucmVzb2x2ZSh7XHJcbiAgICAgICAgc3RhdHVzLFxyXG4gICAgICAgIG91dHB1dCxcclxuICAgICAgICBjb21wbGV0ZWQ6IHN0YXR1cyA9PT0gXCJjb21wbGV0ZWRcIiAvKiBDb21wbGV0ZWQgKi9cclxuICAgIH0pO1xyXG59O1xuXG4vKipcclxuICogVGhlIGNsYXNzIHJlc3BvbnNpYmxlIGZvciBtYW5hZ2luZyBhbmQgcHJvY2Vzc2luZyB0aGUgbmF2aWdhdGlvbiBwaXBlbGluZS5cclxuICovXHJcbmNsYXNzIFBpcGVsaW5lIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBwaXBlbGluZSBzdGVwcy4gQW5kIHN0ZXBzIGFkZGVkIHZpYSBhZGRTdGVwIHdpbGwgYmUgY29udmVydGVkIHRvIGEgZnVuY3Rpb25cclxuICAgICAgICAgKiBUaGUgYWN0dWFseSBydW5uaW5nIGZ1bmN0aW9ucyB3aXRoIGNvcnJlY3Qgc3RlcCBjb250ZXh0cyBvZiB0aGlzIHBpcGVsaW5lXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5zdGVwcyA9IFtdO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgc3RlcCB0byB0aGUgcGlwZWxpbmUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHN0ZXAgVGhlIHBpcGVsaW5lIHN0ZXAuXHJcbiAgICAgKi9cclxuICAgIGFkZFN0ZXAoc3RlcCkge1xyXG4gICAgICAgIGxldCBydW47XHJcbiAgICAgICAgaWYgKHR5cGVvZiBzdGVwID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHJ1biA9IHN0ZXA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBzdGVwLmdldFN0ZXBzID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIC8vIGdldFN0ZXBzIGlzIHRvIGVuYWJsZSBzdXBwb3J0IG9wZW4gc2xvdHNcclxuICAgICAgICAgICAgLy8gd2hlcmUgZGV2cyBjYW4gYWRkIG11bHRpcGxlIHN0ZXBzIGludG8gdGhlIHNhbWUgc2xvdCBuYW1lXHJcbiAgICAgICAgICAgIGxldCBzdGVwcyA9IHN0ZXAuZ2V0U3RlcHMoKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzdGVwcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkU3RlcChzdGVwc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBydW4gPSBzdGVwLnJ1bi5iaW5kKHN0ZXApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnN0ZXBzLnB1c2gocnVuKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUnVucyB0aGUgcGlwZWxpbmUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGluc3RydWN0aW9uIFRoZSBuYXZpZ2F0aW9uIGluc3RydWN0aW9uIHRvIHByb2Nlc3MuXHJcbiAgICAgKi9cclxuICAgIHJ1bihpbnN0cnVjdGlvbikge1xyXG4gICAgICAgIGNvbnN0IG5leHRGbiA9IGNyZWF0ZU5leHRGbihpbnN0cnVjdGlvbiwgdGhpcy5zdGVwcyk7XHJcbiAgICAgICAgcmV0dXJuIG5leHRGbigpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4qIERldGVybWluZXMgaWYgdGhlIHByb3ZpZGVkIG9iamVjdCBpcyBhIG5hdmlnYXRpb24gY29tbWFuZC5cclxuKiBBIG5hdmlnYXRpb24gY29tbWFuZCBpcyBhbnl0aGluZyB3aXRoIGEgbmF2aWdhdGUgbWV0aG9kLlxyXG4qXHJcbiogQHBhcmFtIG9iaiBUaGUgb2JqZWN0IHRvIGNoZWNrLlxyXG4qL1xyXG5mdW5jdGlvbiBpc05hdmlnYXRpb25Db21tYW5kKG9iaikge1xyXG4gICAgcmV0dXJuIG9iaiAmJiB0eXBlb2Ygb2JqLm5hdmlnYXRlID09PSAnZnVuY3Rpb24nO1xyXG59XHJcbi8qKlxyXG4qIFVzZWQgZHVyaW5nIHRoZSBhY3RpdmF0aW9uIGxpZmVjeWNsZSB0byBjYXVzZSBhIHJlZGlyZWN0LlxyXG4qL1xyXG5jbGFzcyBSZWRpcmVjdCB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSB1cmwgVGhlIFVSTCBmcmFnbWVudCB0byB1c2UgYXMgdGhlIG5hdmlnYXRpb24gZGVzdGluYXRpb24uXHJcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyBUaGUgbmF2aWdhdGlvbiBvcHRpb25zLlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcih1cmwsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgICAgIHRoaXMudXJsID0gdXJsO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyB0cmlnZ2VyOiB0cnVlLCByZXBsYWNlOiB0cnVlIH0sIG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuc2hvdWxkQ29udGludWVQcm9jZXNzaW5nID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCBieSB0aGUgYWN0aXZhdGlvbiBzeXN0ZW0gdG8gc2V0IHRoZSBjaGlsZCByb3V0ZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHJvdXRlciBUaGUgcm91dGVyLlxyXG4gICAgICovXHJcbiAgICBzZXRSb3V0ZXIocm91dGVyKSB7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCBieSB0aGUgbmF2aWdhdGlvbiBwaXBlbGluZSB0byBuYXZpZ2F0ZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXBwUm91dGVyIFRoZSByb3V0ZXIgdG8gYmUgcmVkaXJlY3RlZC5cclxuICAgICAqL1xyXG4gICAgbmF2aWdhdGUoYXBwUm91dGVyKSB7XHJcbiAgICAgICAgbGV0IG5hdmlnYXRpbmdSb3V0ZXIgPSB0aGlzLm9wdGlvbnMudXNlQXBwUm91dGVyID8gYXBwUm91dGVyIDogKHRoaXMucm91dGVyIHx8IGFwcFJvdXRlcik7XHJcbiAgICAgICAgbmF2aWdhdGluZ1JvdXRlci5uYXZpZ2F0ZSh0aGlzLnVybCwgdGhpcy5vcHRpb25zKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVXNlZCBkdXJpbmcgdGhlIGFjdGl2YXRpb24gbGlmZWN5Y2xlIHRvIGNhdXNlIGEgcmVkaXJlY3QgdG8gYSBuYW1lZCByb3V0ZS5cclxuICovXHJcbmNsYXNzIFJlZGlyZWN0VG9Sb3V0ZSB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSByb3V0ZSBUaGUgbmFtZSBvZiB0aGUgcm91dGUuXHJcbiAgICAgKiBAcGFyYW0gcGFyYW1zIFRoZSBwYXJhbWV0ZXJzIHRvIGJlIHNlbnQgdG8gdGhlIGFjdGl2YXRpb24gbWV0aG9kLlxyXG4gICAgICogQHBhcmFtIG9wdGlvbnMgVGhlIG9wdGlvbnMgdG8gdXNlIGZvciBuYXZpZ2F0aW9uLlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcihyb3V0ZSwgcGFyYW1zID0ge30sIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgICAgIHRoaXMucm91dGUgPSByb3V0ZTtcclxuICAgICAgICB0aGlzLnBhcmFtcyA9IHBhcmFtcztcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgdHJpZ2dlcjogdHJ1ZSwgcmVwbGFjZTogdHJ1ZSB9LCBvcHRpb25zKTtcclxuICAgICAgICB0aGlzLnNob3VsZENvbnRpbnVlUHJvY2Vzc2luZyA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgYnkgdGhlIGFjdGl2YXRpb24gc3lzdGVtIHRvIHNldCB0aGUgY2hpbGQgcm91dGVyLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSByb3V0ZXIgVGhlIHJvdXRlci5cclxuICAgICAqL1xyXG4gICAgc2V0Um91dGVyKHJvdXRlcikge1xyXG4gICAgICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgYnkgdGhlIG5hdmlnYXRpb24gcGlwZWxpbmUgdG8gbmF2aWdhdGUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGFwcFJvdXRlciBUaGUgcm91dGVyIHRvIGJlIHJlZGlyZWN0ZWQuXHJcbiAgICAgKi9cclxuICAgIG5hdmlnYXRlKGFwcFJvdXRlcikge1xyXG4gICAgICAgIGxldCBuYXZpZ2F0aW5nUm91dGVyID0gdGhpcy5vcHRpb25zLnVzZUFwcFJvdXRlciA/IGFwcFJvdXRlciA6ICh0aGlzLnJvdXRlciB8fCBhcHBSb3V0ZXIpO1xyXG4gICAgICAgIG5hdmlnYXRpbmdSb3V0ZXIubmF2aWdhdGVUb1JvdXRlKHRoaXMucm91dGUsIHRoaXMucGFyYW1zLCB0aGlzLm9wdGlvbnMpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAaW50ZXJuYWwgZXhwb3J0ZWQgZm9yIHVuaXQgdGVzdGluZ1xyXG4gKi9cclxuZnVuY3Rpb24gX2J1aWxkTmF2aWdhdGlvblBsYW4oaW5zdHJ1Y3Rpb24sIGZvcmNlTGlmZWN5Y2xlTWluaW11bSkge1xyXG4gICAgbGV0IGNvbmZpZyA9IGluc3RydWN0aW9uLmNvbmZpZztcclxuICAgIGlmICgncmVkaXJlY3QnIGluIGNvbmZpZykge1xyXG4gICAgICAgIHJldHVybiBidWlsZFJlZGlyZWN0UGxhbihpbnN0cnVjdGlvbik7XHJcbiAgICB9XHJcbiAgICBjb25zdCBwcmV2SW5zdHJ1Y3Rpb24gPSBpbnN0cnVjdGlvbi5wcmV2aW91c0luc3RydWN0aW9uO1xyXG4gICAgY29uc3QgZGVmYXVsdFZpZXdQb3J0Q29uZmlncyA9IGluc3RydWN0aW9uLnJvdXRlci52aWV3UG9ydERlZmF1bHRzO1xyXG4gICAgaWYgKHByZXZJbnN0cnVjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBidWlsZFRyYW5zaXRpb25QbGFucyhpbnN0cnVjdGlvbiwgcHJldkluc3RydWN0aW9uLCBkZWZhdWx0Vmlld1BvcnRDb25maWdzLCBmb3JjZUxpZmVjeWNsZU1pbmltdW0pO1xyXG4gICAgfVxyXG4gICAgLy8gZmlyc3QgbmF2aWdhdGlvbiwgb25seSBuZWVkIHRvIHByZXBhcmUgYSBmZXcgaW5mb3JtYXRpb24gZm9yIGVhY2ggdmlld3BvcnQgcGxhblxyXG4gICAgY29uc3Qgdmlld1BvcnRQbGFucyA9IHt9O1xyXG4gICAgbGV0IHZpZXdQb3J0Q29uZmlncyA9IGNvbmZpZy52aWV3UG9ydHM7XHJcbiAgICBmb3IgKGxldCB2aWV3UG9ydE5hbWUgaW4gdmlld1BvcnRDb25maWdzKSB7XHJcbiAgICAgICAgbGV0IHZpZXdQb3J0Q29uZmlnID0gdmlld1BvcnRDb25maWdzW3ZpZXdQb3J0TmFtZV07XHJcbiAgICAgICAgaWYgKHZpZXdQb3J0Q29uZmlnLm1vZHVsZUlkID09PSBudWxsICYmIHZpZXdQb3J0TmFtZSBpbiBkZWZhdWx0Vmlld1BvcnRDb25maWdzKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0Q29uZmlnID0gZGVmYXVsdFZpZXdQb3J0Q29uZmlnc1t2aWV3UG9ydE5hbWVdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2aWV3UG9ydFBsYW5zW3ZpZXdQb3J0TmFtZV0gPSB7XHJcbiAgICAgICAgICAgIG5hbWU6IHZpZXdQb3J0TmFtZSxcclxuICAgICAgICAgICAgc3RyYXRlZ3k6IFwicmVwbGFjZVwiIC8qIFJlcGxhY2UgKi8sXHJcbiAgICAgICAgICAgIGNvbmZpZzogdmlld1BvcnRDb25maWdcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2aWV3UG9ydFBsYW5zKTtcclxufVxyXG4vKipcclxuICogQnVpbGQgcmVkaXJlY3QgcGxhbiBiYXNlZCBvbiBjb25maWcgb2YgYSBuYXZpZ2F0aW9uIGluc3RydWN0aW9uXHJcbiAqIEBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nXHJcbiAqL1xyXG5jb25zdCBidWlsZFJlZGlyZWN0UGxhbiA9IChpbnN0cnVjdGlvbikgPT4ge1xyXG4gICAgY29uc3QgY29uZmlnID0gaW5zdHJ1Y3Rpb24uY29uZmlnO1xyXG4gICAgY29uc3Qgcm91dGVyID0gaW5zdHJ1Y3Rpb24ucm91dGVyO1xyXG4gICAgcmV0dXJuIHJvdXRlclxyXG4gICAgICAgIC5fY3JlYXRlTmF2aWdhdGlvbkluc3RydWN0aW9uKGNvbmZpZy5yZWRpcmVjdClcclxuICAgICAgICAudGhlbihyZWRpcmVjdEluc3RydWN0aW9uID0+IHtcclxuICAgICAgICBjb25zdCBwYXJhbXMgPSB7fTtcclxuICAgICAgICBjb25zdCBvcmlnaW5hbEluc3RydWN0aW9uUGFyYW1zID0gaW5zdHJ1Y3Rpb24ucGFyYW1zO1xyXG4gICAgICAgIGNvbnN0IHJlZGlyZWN0SW5zdHJ1Y3Rpb25QYXJhbXMgPSByZWRpcmVjdEluc3RydWN0aW9uLnBhcmFtcztcclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gcmVkaXJlY3RJbnN0cnVjdGlvblBhcmFtcykge1xyXG4gICAgICAgICAgICAvLyBJZiB0aGUgcGFyYW0gb24gdGhlIHJlZGlyZWN0IHBvaW50cyB0byBhbm90aGVyIHBhcmFtLCBlLmcuIHsgcm91dGU6IGZpcnN0Lzp0aGlzLCByZWRpcmVjdDogc2Vjb25kLzp0aGlzIH1cclxuICAgICAgICAgICAgbGV0IHZhbCA9IHJlZGlyZWN0SW5zdHJ1Y3Rpb25QYXJhbXNba2V5XTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnICYmIHZhbFswXSA9PT0gJzonKSB7XHJcbiAgICAgICAgICAgICAgICB2YWwgPSB2YWwuc2xpY2UoMSk7XHJcbiAgICAgICAgICAgICAgICAvLyBBbmQgaWYgdGhhdCBwYXJhbSBpcyBmb3VuZCBvbiB0aGUgb3JpZ2luYWwgaW5zdHJ1Y3Rpb24gdGhlbiB1c2UgaXRcclxuICAgICAgICAgICAgICAgIGlmICh2YWwgaW4gb3JpZ2luYWxJbnN0cnVjdGlvblBhcmFtcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtc1trZXldID0gb3JpZ2luYWxJbnN0cnVjdGlvblBhcmFtc1t2YWxdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zW2tleV0gPSByZWRpcmVjdEluc3RydWN0aW9uUGFyYW1zW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHJlZGlyZWN0TG9jYXRpb24gPSByb3V0ZXIuZ2VuZXJhdGUocmVkaXJlY3RJbnN0cnVjdGlvbi5jb25maWcsIHBhcmFtcywgaW5zdHJ1Y3Rpb24ub3B0aW9ucyk7XHJcbiAgICAgICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgY2hpbGQgcm91dGVzXHJcbiAgICAgICAgZm9yIChsZXQga2V5IGluIG9yaWdpbmFsSW5zdHJ1Y3Rpb25QYXJhbXMpIHtcclxuICAgICAgICAgICAgcmVkaXJlY3RMb2NhdGlvbiA9IHJlZGlyZWN0TG9jYXRpb24ucmVwbGFjZShgOiR7a2V5fWAsIG9yaWdpbmFsSW5zdHJ1Y3Rpb25QYXJhbXNba2V5XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBxdWVyeVN0cmluZyA9IGluc3RydWN0aW9uLnF1ZXJ5U3RyaW5nO1xyXG4gICAgICAgIGlmIChxdWVyeVN0cmluZykge1xyXG4gICAgICAgICAgICByZWRpcmVjdExvY2F0aW9uICs9ICc/JyArIHF1ZXJ5U3RyaW5nO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBSZWRpcmVjdChyZWRpcmVjdExvY2F0aW9uKSk7XHJcbiAgICB9KTtcclxufTtcclxuLyoqXHJcbiAqIEBwYXJhbSB2aWV3UG9ydFBsYW5zIHRoZSBQbGFuIHJlY29yZCB0aGF0IGhvbGRzIGluZm9ybWF0aW9uIGFib3V0IGJ1aWx0IHBsYW5zXHJcbiAqIEBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nXHJcbiAqL1xyXG5jb25zdCBidWlsZFRyYW5zaXRpb25QbGFucyA9IChjdXJyZW50SW5zdHJ1Y3Rpb24sIHByZXZpb3VzSW5zdHJ1Y3Rpb24sIGRlZmF1bHRWaWV3UG9ydENvbmZpZ3MsIGZvcmNlTGlmZWN5Y2xlTWluaW11bSkgPT4ge1xyXG4gICAgbGV0IHZpZXdQb3J0UGxhbnMgPSB7fTtcclxuICAgIGxldCBuZXdJbnN0cnVjdGlvbkNvbmZpZyA9IGN1cnJlbnRJbnN0cnVjdGlvbi5jb25maWc7XHJcbiAgICBsZXQgaGFzTmV3UGFyYW1zID0gaGFzRGlmZmVyZW50UGFyYW1ldGVyVmFsdWVzKHByZXZpb3VzSW5zdHJ1Y3Rpb24sIGN1cnJlbnRJbnN0cnVjdGlvbik7XHJcbiAgICBsZXQgcGVuZGluZyA9IFtdO1xyXG4gICAgbGV0IHByZXZpb3VzVmlld1BvcnRJbnN0cnVjdGlvbnMgPSBwcmV2aW91c0luc3RydWN0aW9uLnZpZXdQb3J0SW5zdHJ1Y3Rpb25zO1xyXG4gICAgZm9yIChsZXQgdmlld1BvcnROYW1lIGluIHByZXZpb3VzVmlld1BvcnRJbnN0cnVjdGlvbnMpIHtcclxuICAgICAgICBjb25zdCBwcmV2Vmlld1BvcnRJbnN0cnVjdGlvbiA9IHByZXZpb3VzVmlld1BvcnRJbnN0cnVjdGlvbnNbdmlld1BvcnROYW1lXTtcclxuICAgICAgICBjb25zdCBwcmV2Vmlld1BvcnRDb21wb25lbnQgPSBwcmV2Vmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQ7XHJcbiAgICAgICAgY29uc3QgbmV3SW5zdHJ1Y3Rpb25WaWV3UG9ydENvbmZpZ3MgPSBuZXdJbnN0cnVjdGlvbkNvbmZpZy52aWV3UG9ydHM7XHJcbiAgICAgICAgLy8gaWYgdGhpcyBpcyBpbnZva2VkIG9uIGEgdmlld3BvcnQgd2l0aG91dCBhbnkgY2hhbmdlcywgYmFzZWQgb24gbmV3IHVybCxcclxuICAgICAgICAvLyBuZXdWaWV3UG9ydENvbmZpZyB3aWxsIGJlIHRoZSBleGlzdGluZyB2aWV3cG9ydCBpbnN0cnVjdGlvblxyXG4gICAgICAgIGxldCBuZXh0Vmlld1BvcnRDb25maWcgPSB2aWV3UG9ydE5hbWUgaW4gbmV3SW5zdHJ1Y3Rpb25WaWV3UG9ydENvbmZpZ3NcclxuICAgICAgICAgICAgPyBuZXdJbnN0cnVjdGlvblZpZXdQb3J0Q29uZmlnc1t2aWV3UG9ydE5hbWVdXHJcbiAgICAgICAgICAgIDogcHJldlZpZXdQb3J0SW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgaWYgKG5leHRWaWV3UG9ydENvbmZpZy5tb2R1bGVJZCA9PT0gbnVsbCAmJiB2aWV3UG9ydE5hbWUgaW4gZGVmYXVsdFZpZXdQb3J0Q29uZmlncykge1xyXG4gICAgICAgICAgICBuZXh0Vmlld1BvcnRDb25maWcgPSBkZWZhdWx0Vmlld1BvcnRDb25maWdzW3ZpZXdQb3J0TmFtZV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHZpZXdQb3J0QWN0aXZhdGlvblN0cmF0ZWd5ID0gZGV0ZXJtaW5lQWN0aXZhdGlvblN0cmF0ZWd5KGN1cnJlbnRJbnN0cnVjdGlvbiwgcHJldlZpZXdQb3J0SW5zdHJ1Y3Rpb24sIG5leHRWaWV3UG9ydENvbmZpZywgaGFzTmV3UGFyYW1zLCBmb3JjZUxpZmVjeWNsZU1pbmltdW0pO1xyXG4gICAgICAgIGNvbnN0IHZpZXdQb3J0UGxhbiA9IHZpZXdQb3J0UGxhbnNbdmlld1BvcnROYW1lXSA9IHtcclxuICAgICAgICAgICAgbmFtZTogdmlld1BvcnROYW1lLFxyXG4gICAgICAgICAgICAvLyBWaWV3UG9ydEluc3RydWN0aW9uIGNhbiBxdWFjayBsaWtlIGEgUm91dGVDb25maWdcclxuICAgICAgICAgICAgY29uZmlnOiBuZXh0Vmlld1BvcnRDb25maWcsXHJcbiAgICAgICAgICAgIHByZXZDb21wb25lbnQ6IHByZXZWaWV3UG9ydENvbXBvbmVudCxcclxuICAgICAgICAgICAgcHJldk1vZHVsZUlkOiBwcmV2Vmlld1BvcnRJbnN0cnVjdGlvbi5tb2R1bGVJZCxcclxuICAgICAgICAgICAgc3RyYXRlZ3k6IHZpZXdQb3J0QWN0aXZhdGlvblN0cmF0ZWd5XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyByZWN1cnNpdmVseSBidWlsZCBuYXYgcGxhbnMgZm9yIGFsbCBleGlzdGluZyBjaGlsZCByb3V0ZXJzL3ZpZXdwb3J0cyBvZiB0aGlzIHZpZXdwb3J0XHJcbiAgICAgICAgLy8gdGhpcyBpcyBwb3NzaWJsZSBiZWNhdXNlIGV4aXN0aW5nIGNoaWxkIHZpZXdwb3J0cyBhbmQgcm91dGVycyBhbHJlYWR5IGhhdmUgbmVjZXNzYXJ5IGluZm9ybWF0aW9uXHJcbiAgICAgICAgLy8gdG8gcHJvY2VzcyB0aGUgd2lsZGNhcmQgcGF0aCBmcm9tIHBhcmVudCBpbnN0cnVjdGlvblxyXG4gICAgICAgIGlmICh2aWV3UG9ydEFjdGl2YXRpb25TdHJhdGVneSAhPT0gXCJyZXBsYWNlXCIgLyogUmVwbGFjZSAqLyAmJiBwcmV2Vmlld1BvcnRJbnN0cnVjdGlvbi5jaGlsZFJvdXRlcikge1xyXG4gICAgICAgICAgICBjb25zdCBwYXRoID0gY3VycmVudEluc3RydWN0aW9uLmdldFdpbGRjYXJkUGF0aCgpO1xyXG4gICAgICAgICAgICBjb25zdCB0YXNrID0gcHJldlZpZXdQb3J0SW5zdHJ1Y3Rpb25cclxuICAgICAgICAgICAgICAgIC5jaGlsZFJvdXRlclxyXG4gICAgICAgICAgICAgICAgLl9jcmVhdGVOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ocGF0aCwgY3VycmVudEluc3RydWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKGNoaWxkSW5zdHJ1Y3Rpb24pID0+IHtcclxuICAgICAgICAgICAgICAgIHZpZXdQb3J0UGxhbi5jaGlsZE5hdmlnYXRpb25JbnN0cnVjdGlvbiA9IGNoaWxkSW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX2J1aWxkTmF2aWdhdGlvblBsYW4oY2hpbGRJbnN0cnVjdGlvbiwgXHJcbiAgICAgICAgICAgICAgICAvLyBpcyBpdCBzYWZlIHRvIGFzc3VtZSB2aWV3UG9ydFBsYW4gaGFzIG5vdCBiZWVuIGNoYW5nZWQgZnJvbSBwcmV2aW91cyBhc3NpZ25tZW50P1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgc28sIGNhbiBqdXN0IHVzZSBsb2NhbCB2YXJpYWJsZSB2aWV3UG9ydFBsYW5TdHJhdGVneVxyXG4gICAgICAgICAgICAgICAgLy8gdGhlcmUgY291bGQgYmUgdXNlciBjb2RlIG1vZGlmeWluZyB2aWV3cG9ydCBwbGFuIGR1cmluZyBfY3JlYXRlTmF2aWdhdGlvbkluc3RydWN0aW9uP1xyXG4gICAgICAgICAgICAgICAgdmlld1BvcnRQbGFuLnN0cmF0ZWd5ID09PSBcImludm9rZS1saWZlY3ljbGVcIiAvKiBJbnZva2VMaWZlY3ljbGUgKi8pXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oY2hpbGRQbGFuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRQbGFuIGluc3RhbmNlb2YgUmVkaXJlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGNoaWxkUGxhbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkSW5zdHJ1Y3Rpb24ucGxhbiA9IGNoaWxkUGxhbjtcclxuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgYmx1ZWJpcmQgP1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBwZW5kaW5nLnB1c2godGFzayk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHBlbmRpbmcpLnRoZW4oKCkgPT4gdmlld1BvcnRQbGFucyk7XHJcbn07XHJcbi8qKlxyXG4gKiBAcGFyYW0gbmV3Vmlld1BvcnRDb25maWcgaWYgdGhpcyBpcyBpbnZva2VkIG9uIGEgdmlld3BvcnQgd2l0aG91dCBhbnkgY2hhbmdlcywgYmFzZWQgb24gbmV3IHVybCwgbmV3Vmlld1BvcnRDb25maWcgd2lsbCBiZSB0aGUgZXhpc3Rpbmcgdmlld3BvcnQgaW5zdHJ1Y3Rpb25cclxuICogQGludGVybmFsIGV4cG9ydGVkIGZvciB1bml0IHRlc3RpbmdcclxuICovXHJcbmNvbnN0IGRldGVybWluZUFjdGl2YXRpb25TdHJhdGVneSA9IChjdXJyZW50TmF2SW5zdHJ1Y3Rpb24sIHByZXZWaWV3UG9ydEluc3RydWN0aW9uLCBuZXdWaWV3UG9ydENvbmZpZywgXHJcbi8vIGluZGljYXRlcyB3aGV0aGVyIHRoZXJlIGlzIGRpZmZlcmVuY2UgYmV0d2VlbiBvbGQgYW5kIG5ldyB1cmwgcGFyYW1zXHJcbmhhc05ld1BhcmFtcywgZm9yY2VMaWZlY3ljbGVNaW5pbXVtKSA9PiB7XHJcbiAgICBsZXQgbmV3SW5zdHJ1Y3Rpb25Db25maWcgPSBjdXJyZW50TmF2SW5zdHJ1Y3Rpb24uY29uZmlnO1xyXG4gICAgbGV0IHByZXZWaWV3UG9ydFZpZXdNb2RlbCA9IHByZXZWaWV3UG9ydEluc3RydWN0aW9uLmNvbXBvbmVudC52aWV3TW9kZWw7XHJcbiAgICBsZXQgdmlld1BvcnRQbGFuU3RyYXRlZ3k7XHJcbiAgICBpZiAocHJldlZpZXdQb3J0SW5zdHJ1Y3Rpb24ubW9kdWxlSWQgIT09IG5ld1ZpZXdQb3J0Q29uZmlnLm1vZHVsZUlkKSB7XHJcbiAgICAgICAgdmlld1BvcnRQbGFuU3RyYXRlZ3kgPSBcInJlcGxhY2VcIiAvKiBSZXBsYWNlICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoJ2RldGVybWluZUFjdGl2YXRpb25TdHJhdGVneScgaW4gcHJldlZpZXdQb3J0Vmlld01vZGVsKSB7XHJcbiAgICAgICAgdmlld1BvcnRQbGFuU3RyYXRlZ3kgPSBwcmV2Vmlld1BvcnRWaWV3TW9kZWwuZGV0ZXJtaW5lQWN0aXZhdGlvblN0cmF0ZWd5KC4uLmN1cnJlbnROYXZJbnN0cnVjdGlvbi5saWZlY3ljbGVBcmdzKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKG5ld0luc3RydWN0aW9uQ29uZmlnLmFjdGl2YXRpb25TdHJhdGVneSkge1xyXG4gICAgICAgIHZpZXdQb3J0UGxhblN0cmF0ZWd5ID0gbmV3SW5zdHJ1Y3Rpb25Db25maWcuYWN0aXZhdGlvblN0cmF0ZWd5O1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaGFzTmV3UGFyYW1zIHx8IGZvcmNlTGlmZWN5Y2xlTWluaW11bSkge1xyXG4gICAgICAgIHZpZXdQb3J0UGxhblN0cmF0ZWd5ID0gXCJpbnZva2UtbGlmZWN5Y2xlXCIgLyogSW52b2tlTGlmZWN5Y2xlICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdmlld1BvcnRQbGFuU3RyYXRlZ3kgPSBcIm5vLWNoYW5nZVwiIC8qIE5vQ2hhbmdlICovO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZpZXdQb3J0UGxhblN0cmF0ZWd5O1xyXG59O1xyXG4vKipAaW50ZXJuYWwgZXhwb3J0ZWQgZm9yIHVuaXQgdGVzdGluZyAqL1xyXG5jb25zdCBoYXNEaWZmZXJlbnRQYXJhbWV0ZXJWYWx1ZXMgPSAocHJldiwgbmV4dCkgPT4ge1xyXG4gICAgbGV0IHByZXZQYXJhbXMgPSBwcmV2LnBhcmFtcztcclxuICAgIGxldCBuZXh0UGFyYW1zID0gbmV4dC5wYXJhbXM7XHJcbiAgICBsZXQgbmV4dFdpbGRDYXJkTmFtZSA9IG5leHQuY29uZmlnLmhhc0NoaWxkUm91dGVyID8gbmV4dC5nZXRXaWxkQ2FyZE5hbWUoKSA6IG51bGw7XHJcbiAgICBmb3IgKGxldCBrZXkgaW4gbmV4dFBhcmFtcykge1xyXG4gICAgICAgIGlmIChrZXkgPT09IG5leHRXaWxkQ2FyZE5hbWUpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwcmV2UGFyYW1zW2tleV0gIT09IG5leHRQYXJhbXNba2V5XSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBrZXkgaW4gcHJldlBhcmFtcykge1xyXG4gICAgICAgIGlmIChrZXkgPT09IG5leHRXaWxkQ2FyZE5hbWUpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwcmV2UGFyYW1zW2tleV0gIT09IG5leHRQYXJhbXNba2V5XSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoIW5leHQub3B0aW9ucy5jb21wYXJlUXVlcnlQYXJhbXMpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBsZXQgcHJldlF1ZXJ5UGFyYW1zID0gcHJldi5xdWVyeVBhcmFtcztcclxuICAgIGxldCBuZXh0UXVlcnlQYXJhbXMgPSBuZXh0LnF1ZXJ5UGFyYW1zO1xyXG4gICAgZm9yIChsZXQga2V5IGluIG5leHRRdWVyeVBhcmFtcykge1xyXG4gICAgICAgIGlmIChwcmV2UXVlcnlQYXJhbXNba2V5XSAhPT0gbmV4dFF1ZXJ5UGFyYW1zW2tleV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yIChsZXQga2V5IGluIHByZXZRdWVyeVBhcmFtcykge1xyXG4gICAgICAgIGlmIChwcmV2UXVlcnlQYXJhbXNba2V5XSAhPT0gbmV4dFF1ZXJ5UGFyYW1zW2tleV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59O1xuXG4vKipcclxuICogVHJhbnNmb3JtIGEgbmF2aWdhdGlvbiBpbnN0cnVjdGlvbiBpbnRvIHZpZXdwb3J0IHBsYW4gcmVjb3JkIG9iamVjdCxcclxuICogb3IgYSByZWRpcmVjdCByZXF1ZXN0IGlmIHVzZXIgdmlld21vZGVsIGRlbWFuZHNcclxuICovXHJcbmNsYXNzIEJ1aWxkTmF2aWdhdGlvblBsYW5TdGVwIHtcclxuICAgIHJ1bihuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIG5leHQpIHtcclxuICAgICAgICByZXR1cm4gX2J1aWxkTmF2aWdhdGlvblBsYW4obmF2aWdhdGlvbkluc3RydWN0aW9uKVxyXG4gICAgICAgICAgICAudGhlbihwbGFuID0+IHtcclxuICAgICAgICAgICAgaWYgKHBsYW4gaW5zdGFuY2VvZiBSZWRpcmVjdCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuY2FuY2VsKHBsYW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5hdmlnYXRpb25JbnN0cnVjdGlvbi5wbGFuID0gcGxhbjtcclxuICAgICAgICAgICAgcmV0dXJuIG5leHQoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2gobmV4dC5jYW5jZWwpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAaW50ZXJuYWwgRXhwb3J0ZWQgZm9yIHVuaXQgdGVzdGluZ1xyXG4gKi9cclxuY29uc3QgbG9hZE5ld1JvdXRlID0gKHJvdXRlTG9hZGVyLCBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24pID0+IHtcclxuICAgIGxldCBsb2FkaW5nUGxhbnMgPSBkZXRlcm1pbmVMb2FkaW5nUGxhbnMobmF2aWdhdGlvbkluc3RydWN0aW9uKTtcclxuICAgIGxldCBsb2FkUHJvbWlzZXMgPSBsb2FkaW5nUGxhbnMubWFwKChsb2FkaW5nUGxhbikgPT4gbG9hZFJvdXRlKHJvdXRlTG9hZGVyLCBsb2FkaW5nUGxhbi5uYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIGxvYWRpbmdQbGFuLnZpZXdQb3J0UGxhbikpO1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKGxvYWRQcm9taXNlcyk7XHJcbn07XHJcbi8qKlxyXG4gKiBAaW50ZXJuYWwgRXhwb3J0ZWQgZm9yIHVuaXQgdGVzdGluZ1xyXG4gKi9cclxuY29uc3QgZGV0ZXJtaW5lTG9hZGluZ1BsYW5zID0gKG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgbG9hZGluZ1BsYW5zID0gW10pID0+IHtcclxuICAgIGxldCB2aWV3UG9ydFBsYW5zID0gbmF2aWdhdGlvbkluc3RydWN0aW9uLnBsYW47XHJcbiAgICBmb3IgKGxldCB2aWV3UG9ydE5hbWUgaW4gdmlld1BvcnRQbGFucykge1xyXG4gICAgICAgIGxldCB2aWV3UG9ydFBsYW4gPSB2aWV3UG9ydFBsYW5zW3ZpZXdQb3J0TmFtZV07XHJcbiAgICAgICAgbGV0IGNoaWxkTmF2SW5zdHJ1Y3Rpb24gPSB2aWV3UG9ydFBsYW4uY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgaWYgKHZpZXdQb3J0UGxhbi5zdHJhdGVneSA9PT0gXCJyZXBsYWNlXCIgLyogUmVwbGFjZSAqLykge1xyXG4gICAgICAgICAgICBsb2FkaW5nUGxhbnMucHVzaCh7IHZpZXdQb3J0UGxhbiwgbmF2aWdhdGlvbkluc3RydWN0aW9uIH0pO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGROYXZJbnN0cnVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgZGV0ZXJtaW5lTG9hZGluZ1BsYW5zKGNoaWxkTmF2SW5zdHJ1Y3Rpb24sIGxvYWRpbmdQbGFucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCB2aWV3UG9ydEluc3RydWN0aW9uID0gbmF2aWdhdGlvbkluc3RydWN0aW9uLmFkZFZpZXdQb3J0SW5zdHJ1Y3Rpb24oe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogdmlld1BvcnROYW1lLFxyXG4gICAgICAgICAgICAgICAgc3RyYXRlZ3k6IHZpZXdQb3J0UGxhbi5zdHJhdGVneSxcclxuICAgICAgICAgICAgICAgIG1vZHVsZUlkOiB2aWV3UG9ydFBsYW4ucHJldk1vZHVsZUlkLFxyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiB2aWV3UG9ydFBsYW4ucHJldkNvbXBvbmVudFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkTmF2SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIHZpZXdQb3J0SW5zdHJ1Y3Rpb24uY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24gPSBjaGlsZE5hdkluc3RydWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgZGV0ZXJtaW5lTG9hZGluZ1BsYW5zKGNoaWxkTmF2SW5zdHJ1Y3Rpb24sIGxvYWRpbmdQbGFucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbG9hZGluZ1BsYW5zO1xyXG59O1xyXG4vKipcclxuICogQGludGVybmFsIEV4cG9ydGVkIGZvciB1bml0IHRlc3RpbmdcclxuICovXHJcbmNvbnN0IGxvYWRSb3V0ZSA9IChyb3V0ZUxvYWRlciwgbmF2aWdhdGlvbkluc3RydWN0aW9uLCB2aWV3UG9ydFBsYW4pID0+IHtcclxuICAgIGxldCBwbGFuQ29uZmlnID0gdmlld1BvcnRQbGFuLmNvbmZpZztcclxuICAgIGxldCBtb2R1bGVJZCA9IHBsYW5Db25maWcgPyBwbGFuQ29uZmlnLm1vZHVsZUlkIDogbnVsbDtcclxuICAgIHJldHVybiBsb2FkQ29tcG9uZW50KHJvdXRlTG9hZGVyLCBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIHBsYW5Db25maWcpXHJcbiAgICAgICAgLnRoZW4oKGNvbXBvbmVudCkgPT4ge1xyXG4gICAgICAgIGxldCB2aWV3UG9ydEluc3RydWN0aW9uID0gbmF2aWdhdGlvbkluc3RydWN0aW9uLmFkZFZpZXdQb3J0SW5zdHJ1Y3Rpb24oe1xyXG4gICAgICAgICAgICBuYW1lOiB2aWV3UG9ydFBsYW4ubmFtZSxcclxuICAgICAgICAgICAgc3RyYXRlZ3k6IHZpZXdQb3J0UGxhbi5zdHJhdGVneSxcclxuICAgICAgICAgICAgbW9kdWxlSWQ6IG1vZHVsZUlkLFxyXG4gICAgICAgICAgICBjb21wb25lbnQ6IGNvbXBvbmVudFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGxldCBjaGlsZFJvdXRlciA9IGNvbXBvbmVudC5jaGlsZFJvdXRlcjtcclxuICAgICAgICBpZiAoY2hpbGRSb3V0ZXIpIHtcclxuICAgICAgICAgICAgbGV0IHBhdGggPSBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24uZ2V0V2lsZGNhcmRQYXRoKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZFJvdXRlclxyXG4gICAgICAgICAgICAgICAgLl9jcmVhdGVOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ocGF0aCwgbmF2aWdhdGlvbkluc3RydWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKGNoaWxkSW5zdHJ1Y3Rpb24pID0+IHtcclxuICAgICAgICAgICAgICAgIHZpZXdQb3J0UGxhbi5jaGlsZE5hdmlnYXRpb25JbnN0cnVjdGlvbiA9IGNoaWxkSW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX2J1aWxkTmF2aWdhdGlvblBsYW4oY2hpbGRJbnN0cnVjdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAudGhlbigoY2hpbGRQbGFuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkUGxhbiBpbnN0YW5jZW9mIFJlZGlyZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChjaGlsZFBsYW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjaGlsZEluc3RydWN0aW9uLnBsYW4gPSBjaGlsZFBsYW47XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld1BvcnRJbnN0cnVjdGlvbi5jaGlsZE5hdmlnYXRpb25JbnN0cnVjdGlvbiA9IGNoaWxkSW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvYWROZXdSb3V0ZShyb3V0ZUxvYWRlciwgY2hpbGRJbnN0cnVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHRzIGNvbXBsYWlucyB3aXRob3V0IHRoaXMsIHRob3VnaCB0aGV5IGFyZSBzYW1lXHJcbiAgICAgICAgcmV0dXJuIHZvaWQgMDtcclxuICAgIH0pO1xyXG59O1xyXG4vKipcclxuICogTG9hZCBhIHJvdXRlZC1jb21wb25lbnQgYmFzZWQgb24gbmF2aWdhdGlvbiBpbnN0cnVjdGlvbiBhbmQgcm91dGUgY29uZmlnXHJcbiAqIEBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nIG9ubHlcclxuICovXHJcbmNvbnN0IGxvYWRDb21wb25lbnQgPSAocm91dGVMb2FkZXIsIG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgY29uZmlnKSA9PiB7XHJcbiAgICBsZXQgcm91dGVyID0gbmF2aWdhdGlvbkluc3RydWN0aW9uLnJvdXRlcjtcclxuICAgIGxldCBsaWZlY3ljbGVBcmdzID0gbmF2aWdhdGlvbkluc3RydWN0aW9uLmxpZmVjeWNsZUFyZ3M7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICAgICAgICAudGhlbigoKSA9PiByb3V0ZUxvYWRlci5sb2FkUm91dGUocm91dGVyLCBjb25maWcsIG5hdmlnYXRpb25JbnN0cnVjdGlvbikpXHJcbiAgICAgICAgLnRoZW4oXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBjb21wb25lbnQgYW4gb2JqZWN0IGNhcnJ5aW5nIGluZm9ybWF0aW9uIGFib3V0IGxvYWRlZCByb3V0ZVxyXG4gICAgICogdHlwaWNhbGx5IGNvbnRhaW5zIGluZm9ybWF0aW9uIGFib3V0IHZpZXcgbW9kZWwsIGNoaWxkQ29udGFpbmVyLCB2aWV3IGFuZCByb3V0ZXJcclxuICAgICAqL1xyXG4gICAgKGNvbXBvbmVudCkgPT4ge1xyXG4gICAgICAgIGxldCB7IHZpZXdNb2RlbCwgY2hpbGRDb250YWluZXIgfSA9IGNvbXBvbmVudDtcclxuICAgICAgICBjb21wb25lbnQucm91dGVyID0gcm91dGVyO1xyXG4gICAgICAgIGNvbXBvbmVudC5jb25maWcgPSBjb25maWc7XHJcbiAgICAgICAgaWYgKCdjb25maWd1cmVSb3V0ZXInIGluIHZpZXdNb2RlbCkge1xyXG4gICAgICAgICAgICBsZXQgY2hpbGRSb3V0ZXIgPSBjaGlsZENvbnRhaW5lci5nZXRDaGlsZFJvdXRlcigpO1xyXG4gICAgICAgICAgICBjb21wb25lbnQuY2hpbGRSb3V0ZXIgPSBjaGlsZFJvdXRlcjtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkUm91dGVyXHJcbiAgICAgICAgICAgICAgICAuY29uZmlndXJlKGMgPT4gdmlld01vZGVsLmNvbmZpZ3VyZVJvdXRlcihjLCBjaGlsZFJvdXRlciwgbGlmZWN5Y2xlQXJnc1swXSwgbGlmZWN5Y2xlQXJnc1sxXSwgbGlmZWN5Y2xlQXJnc1syXSkpXHJcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiBjb21wb25lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG4gICAgfSk7XHJcbn07XG5cbi8qKlxyXG4gKiBBYnN0cmFjdCBjbGFzcyB0aGF0IGlzIHJlc3BvbnNpYmxlIGZvciBsb2FkaW5nIHZpZXcgLyB2aWV3IG1vZGVsIGZyb20gYSByb3V0ZSBjb25maWdcclxuICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gY2FuIGJlIGZvdW5kIGluIGBhdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyYFxyXG4gKi9cclxuY2xhc3MgUm91dGVMb2FkZXIge1xyXG4gICAgLyoqXHJcbiAgICAgKiBMb2FkIGEgcm91dGUgY29uZmlnIGJhc2VkIG9uIGl0cyB2aWV3bW9kZWwgLyB2aWV3IGNvbmZpZ3VyYXRpb25cclxuICAgICAqL1xyXG4gICAgLy8gcmV0dXJuIHR5cGluZzogcmV0dXJuIHR5cGluZ3MgdXNlZCB0byBiZSBuZXZlclxyXG4gICAgLy8gYXMgaXQgd2FzIGEgdGhyb3cuIENoYW5naW5nIGl0IHRvIFByb21pc2U8YW55PiBzaG91bGQgbm90IGNhdXNlIGFueSBpc3N1ZXNcclxuICAgIGxvYWRSb3V0ZShyb3V0ZXIsIGNvbmZpZywgbmF2aWdhdGlvbkluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSb3V0ZSBsb2FkZXJzIG11c3QgaW1wbGVtZW50IFwibG9hZFJvdXRlKHJvdXRlciwgY29uZmlnLCBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24pXCIuJyk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEEgcGlwZWxpbmUgc3RlcCByZXNwb25zaWJsZSBmb3IgbG9hZGluZyBhIHJvdXRlIGNvbmZpZyBvZiBhIG5hdmlnYXRpb24gaW5zdHJ1Y3Rpb25cclxuICovXHJcbmNsYXNzIExvYWRSb3V0ZVN0ZXAge1xyXG4gICAgLyoqQGludGVybmFsICovXHJcbiAgICBzdGF0aWMgaW5qZWN0KCkgeyByZXR1cm4gW1JvdXRlTG9hZGVyXTsgfVxyXG4gICAgY29uc3RydWN0b3Iocm91dGVMb2FkZXIpIHtcclxuICAgICAgICB0aGlzLnJvdXRlTG9hZGVyID0gcm91dGVMb2FkZXI7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJ1biB0aGUgaW50ZXJuYWwgdG8gbG9hZCByb3V0ZSBjb25maWcgb2YgYSBuYXZpZ2F0aW9uIGluc3RydWN0aW9uIHRvIHByZXBhcmUgZm9yIG5leHQgc3RlcHMgaW4gdGhlIHBpcGVsaW5lXHJcbiAgICAgKi9cclxuICAgIHJ1bihuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIG5leHQpIHtcclxuICAgICAgICByZXR1cm4gbG9hZE5ld1JvdXRlKHRoaXMucm91dGVMb2FkZXIsIG5hdmlnYXRpb25JbnN0cnVjdGlvbilcclxuICAgICAgICAgICAgLnRoZW4obmV4dCwgbmV4dC5jYW5jZWwpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBBIHBpcGVsaW5lIHN0ZXAgZm9yIGluc3RydWN0aW5nIGEgcGllcGxpbmUgdG8gY29tbWl0IGNoYW5nZXMgb24gYSBuYXZpZ2F0aW9uIGluc3RydWN0aW9uXHJcbiAqL1xyXG5jbGFzcyBDb21taXRDaGFuZ2VzU3RlcCB7XHJcbiAgICBydW4obmF2aWdhdGlvbkluc3RydWN0aW9uLCBuZXh0KSB7XHJcbiAgICAgICAgcmV0dXJuIG5hdmlnYXRpb25JbnN0cnVjdGlvblxyXG4gICAgICAgICAgICAuX2NvbW1pdENoYW5nZXMoLyp3YWl0IHRvIHN3YXA/Ki8gdHJ1ZSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24uX3VwZGF0ZVRpdGxlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXh0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEFuIG9wdGlvbmFsIGludGVyZmFjZSBkZXNjcmliaW5nIHRoZSBhdmFpbGFibGUgYWN0aXZhdGlvbiBzdHJhdGVnaWVzLlxyXG4gKiBAaW50ZXJuYWwgVXNlZCBpbnRlcm5hbGx5LlxyXG4gKi9cclxudmFyIEludGVybmFsQWN0aXZhdGlvblN0cmF0ZWd5O1xyXG4oZnVuY3Rpb24gKEludGVybmFsQWN0aXZhdGlvblN0cmF0ZWd5KSB7XHJcbiAgICAvKipcclxuICAgICAqIFJldXNlIHRoZSBleGlzdGluZyB2aWV3IG1vZGVsLCB3aXRob3V0IGludm9raW5nIFJvdXRlciBsaWZlY3ljbGUgaG9va3MuXHJcbiAgICAgKi9cclxuICAgIEludGVybmFsQWN0aXZhdGlvblN0cmF0ZWd5W1wiTm9DaGFuZ2VcIl0gPSBcIm5vLWNoYW5nZVwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXVzZSB0aGUgZXhpc3RpbmcgdmlldyBtb2RlbCwgaW52b2tpbmcgUm91dGVyIGxpZmVjeWNsZSBob29rcy5cclxuICAgICAqL1xyXG4gICAgSW50ZXJuYWxBY3RpdmF0aW9uU3RyYXRlZ3lbXCJJbnZva2VMaWZlY3ljbGVcIl0gPSBcImludm9rZS1saWZlY3ljbGVcIjtcclxuICAgIC8qKlxyXG4gICAgICogUmVwbGFjZSB0aGUgZXhpc3RpbmcgdmlldyBtb2RlbCwgaW52b2tpbmcgUm91dGVyIGxpZmVjeWNsZSBob29rcy5cclxuICAgICAqL1xyXG4gICAgSW50ZXJuYWxBY3RpdmF0aW9uU3RyYXRlZ3lbXCJSZXBsYWNlXCJdID0gXCJyZXBsYWNlXCI7XHJcbn0pKEludGVybmFsQWN0aXZhdGlvblN0cmF0ZWd5IHx8IChJbnRlcm5hbEFjdGl2YXRpb25TdHJhdGVneSA9IHt9KSk7XHJcbi8qKlxyXG4gKiBUaGUgc3RyYXRlZ3kgdG8gdXNlIHdoZW4gYWN0aXZhdGluZyBtb2R1bGVzIGR1cmluZyBuYXZpZ2F0aW9uLlxyXG4gKi9cclxuLy8ga2VwdCBmb3IgY29tcGF0IHJlYXNvblxyXG5jb25zdCBhY3RpdmF0aW9uU3RyYXRlZ3kgPSB7XHJcbiAgICBub0NoYW5nZTogXCJuby1jaGFuZ2VcIiAvKiBOb0NoYW5nZSAqLyxcclxuICAgIGludm9rZUxpZmVjeWNsZTogXCJpbnZva2UtbGlmZWN5Y2xlXCIgLyogSW52b2tlTGlmZWN5Y2xlICovLFxyXG4gICAgcmVwbGFjZTogXCJyZXBsYWNlXCIgLyogUmVwbGFjZSAqL1xyXG59O1xuXG4vKipcclxuICogUmVjdXJzaXZlbHkgZmluZCBsaXN0IG9mIGRlYWN0aXZhdGUtYWJsZSB2aWV3IG1vZGVsc1xyXG4gKiBhbmQgaW52b2tlIHRoZSBlaXRoZXIgJ2NhbkRlYWN0aXZhdGUnIG9yICdkZWFjdGl2YXRlJyBvbiBlYWNoXHJcbiAqIEBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nXHJcbiAqL1xyXG5jb25zdCBwcm9jZXNzRGVhY3RpdmF0YWJsZSA9IChuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIGNhbGxiYWNrTmFtZSwgbmV4dCwgaWdub3JlUmVzdWx0KSA9PiB7XHJcbiAgICBsZXQgcGxhbiA9IG5hdmlnYXRpb25JbnN0cnVjdGlvbi5wbGFuO1xyXG4gICAgbGV0IGluZm9zID0gZmluZERlYWN0aXZhdGFibGUocGxhbiwgY2FsbGJhY2tOYW1lKTtcclxuICAgIGxldCBpID0gaW5mb3MubGVuZ3RoOyAvLyBxdWVyeSBmcm9tIGluc2lkZSBvdXRcclxuICAgIGZ1bmN0aW9uIGluc3BlY3QodmFsKSB7XHJcbiAgICAgICAgaWYgKGlnbm9yZVJlc3VsdCB8fCBzaG91bGRDb250aW51ZSh2YWwpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVyYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXh0LmNhbmNlbCh2YWwpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaXRlcmF0ZSgpIHtcclxuICAgICAgICBpZiAoaS0tKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdmlld01vZGVsID0gaW5mb3NbaV07XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gdmlld01vZGVsW2NhbGxiYWNrTmFtZV0obmF2aWdhdGlvbkluc3RydWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9jZXNzUG90ZW50aWFsKHJlc3VsdCwgaW5zcGVjdCwgbmV4dC5jYW5jZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuY2FuY2VsKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ucm91dGVyLmNvdWxkRGVhY3RpdmF0ZSA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuIG5leHQoKTtcclxuICAgIH1cclxuICAgIHJldHVybiBpdGVyYXRlKCk7XHJcbn07XHJcbi8qKlxyXG4gKiBSZWN1cnNpdmVseSBmaW5kIGFuZCByZXR1cm5zIGEgbGlzdCBvZiBkZWFjdGl2YXRlLWFibGUgdmlldyBtb2RlbHNcclxuICogQGludGVybmFsIGV4cG9ydGVkIGZvciB1bml0IHRlc3RpbmdcclxuICovXHJcbmNvbnN0IGZpbmREZWFjdGl2YXRhYmxlID0gKHBsYW4sIGNhbGxiYWNrTmFtZSwgbGlzdCA9IFtdKSA9PiB7XHJcbiAgICBmb3IgKGxldCB2aWV3UG9ydE5hbWUgaW4gcGxhbikge1xyXG4gICAgICAgIGxldCB2aWV3UG9ydFBsYW4gPSBwbGFuW3ZpZXdQb3J0TmFtZV07XHJcbiAgICAgICAgbGV0IHByZXZDb21wb25lbnQgPSB2aWV3UG9ydFBsYW4ucHJldkNvbXBvbmVudDtcclxuICAgICAgICBpZiAoKHZpZXdQb3J0UGxhbi5zdHJhdGVneSA9PT0gYWN0aXZhdGlvblN0cmF0ZWd5Lmludm9rZUxpZmVjeWNsZSB8fCB2aWV3UG9ydFBsYW4uc3RyYXRlZ3kgPT09IGFjdGl2YXRpb25TdHJhdGVneS5yZXBsYWNlKVxyXG4gICAgICAgICAgICAmJiBwcmV2Q29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIGxldCB2aWV3TW9kZWwgPSBwcmV2Q29tcG9uZW50LnZpZXdNb2RlbDtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrTmFtZSBpbiB2aWV3TW9kZWwpIHtcclxuICAgICAgICAgICAgICAgIGxpc3QucHVzaCh2aWV3TW9kZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2aWV3UG9ydFBsYW4uc3RyYXRlZ3kgPT09IGFjdGl2YXRpb25TdHJhdGVneS5yZXBsYWNlICYmIHByZXZDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgYWRkUHJldmlvdXNEZWFjdGl2YXRhYmxlKHByZXZDb21wb25lbnQsIGNhbGxiYWNrTmFtZSwgbGlzdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZpZXdQb3J0UGxhbi5jaGlsZE5hdmlnYXRpb25JbnN0cnVjdGlvbikge1xyXG4gICAgICAgICAgICBmaW5kRGVhY3RpdmF0YWJsZSh2aWV3UG9ydFBsYW4uY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ucGxhbiwgY2FsbGJhY2tOYW1lLCBsaXN0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbGlzdDtcclxufTtcclxuLyoqXHJcbiAqIEBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nXHJcbiAqL1xyXG5jb25zdCBhZGRQcmV2aW91c0RlYWN0aXZhdGFibGUgPSAoY29tcG9uZW50LCBjYWxsYmFja05hbWUsIGxpc3QpID0+IHtcclxuICAgIGxldCBjaGlsZFJvdXRlciA9IGNvbXBvbmVudC5jaGlsZFJvdXRlcjtcclxuICAgIGlmIChjaGlsZFJvdXRlciAmJiBjaGlsZFJvdXRlci5jdXJyZW50SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICBsZXQgdmlld1BvcnRJbnN0cnVjdGlvbnMgPSBjaGlsZFJvdXRlci5jdXJyZW50SW5zdHJ1Y3Rpb24udmlld1BvcnRJbnN0cnVjdGlvbnM7XHJcbiAgICAgICAgZm9yIChsZXQgdmlld1BvcnROYW1lIGluIHZpZXdQb3J0SW5zdHJ1Y3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGxldCB2aWV3UG9ydEluc3RydWN0aW9uID0gdmlld1BvcnRJbnN0cnVjdGlvbnNbdmlld1BvcnROYW1lXTtcclxuICAgICAgICAgICAgbGV0IHByZXZDb21wb25lbnQgPSB2aWV3UG9ydEluc3RydWN0aW9uLmNvbXBvbmVudDtcclxuICAgICAgICAgICAgbGV0IHByZXZWaWV3TW9kZWwgPSBwcmV2Q29tcG9uZW50LnZpZXdNb2RlbDtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrTmFtZSBpbiBwcmV2Vmlld01vZGVsKSB7XHJcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2gocHJldlZpZXdNb2RlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYWRkUHJldmlvdXNEZWFjdGl2YXRhYmxlKHByZXZDb21wb25lbnQsIGNhbGxiYWNrTmFtZSwgbGlzdCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogQGludGVybmFsIGV4cG9ydGVkIGZvciB1bml0IHRlc3RpbmdcclxuICovXHJcbmNvbnN0IHByb2Nlc3NBY3RpdmF0YWJsZSA9IChuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIGNhbGxiYWNrTmFtZSwgbmV4dCwgaWdub3JlUmVzdWx0KSA9PiB7XHJcbiAgICBsZXQgaW5mb3MgPSBmaW5kQWN0aXZhdGFibGUobmF2aWdhdGlvbkluc3RydWN0aW9uLCBjYWxsYmFja05hbWUpO1xyXG4gICAgbGV0IGxlbmd0aCA9IGluZm9zLmxlbmd0aDtcclxuICAgIGxldCBpID0gLTE7IC8vIHF1ZXJ5IGZyb20gdG9wIGRvd25cclxuICAgIGZ1bmN0aW9uIGluc3BlY3QodmFsLCByb3V0ZXIpIHtcclxuICAgICAgICBpZiAoaWdub3JlUmVzdWx0IHx8IHNob3VsZENvbnRpbnVlKHZhbCwgcm91dGVyKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlcmF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV4dC5jYW5jZWwodmFsKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGl0ZXJhdGUoKSB7XHJcbiAgICAgICAgaSsrO1xyXG4gICAgICAgIGlmIChpIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IGluZm9zW2ldO1xyXG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGN1cnJlbnQudmlld01vZGVsW2NhbGxiYWNrTmFtZV0oLi4uY3VycmVudC5saWZlY3ljbGVBcmdzKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9jZXNzUG90ZW50aWFsKHJlc3VsdCwgKHZhbCkgPT4gaW5zcGVjdCh2YWwsIGN1cnJlbnQucm91dGVyKSwgbmV4dC5jYW5jZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuY2FuY2VsKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV4dCgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGl0ZXJhdGUoKTtcclxufTtcclxuLyoqXHJcbiAqIEZpbmQgbGlzdCBvZiBhY3RpdmF0YWJsZSB2aWV3IG1vZGVsIGFuZCBhZGQgdG8gbGlzdCAoM3JkIHBhcmFtZXRlcilcclxuICogQGludGVybmFsIGV4cG9ydGVkIGZvciB1bml0IHRlc3RpbmdcclxuICovXHJcbmNvbnN0IGZpbmRBY3RpdmF0YWJsZSA9IChuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIGNhbGxiYWNrTmFtZSwgbGlzdCA9IFtdLCByb3V0ZXIpID0+IHtcclxuICAgIGxldCBwbGFuID0gbmF2aWdhdGlvbkluc3RydWN0aW9uLnBsYW47XHJcbiAgICBPYmplY3RcclxuICAgICAgICAua2V5cyhwbGFuKVxyXG4gICAgICAgIC5mb3JFYWNoKCh2aWV3UG9ydE5hbWUpID0+IHtcclxuICAgICAgICBsZXQgdmlld1BvcnRQbGFuID0gcGxhblt2aWV3UG9ydE5hbWVdO1xyXG4gICAgICAgIGxldCB2aWV3UG9ydEluc3RydWN0aW9uID0gbmF2aWdhdGlvbkluc3RydWN0aW9uLnZpZXdQb3J0SW5zdHJ1Y3Rpb25zW3ZpZXdQb3J0TmFtZV07XHJcbiAgICAgICAgbGV0IHZpZXdQb3J0Q29tcG9uZW50ID0gdmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQ7XHJcbiAgICAgICAgbGV0IHZpZXdNb2RlbCA9IHZpZXdQb3J0Q29tcG9uZW50LnZpZXdNb2RlbDtcclxuICAgICAgICBpZiAoKHZpZXdQb3J0UGxhbi5zdHJhdGVneSA9PT0gYWN0aXZhdGlvblN0cmF0ZWd5Lmludm9rZUxpZmVjeWNsZVxyXG4gICAgICAgICAgICB8fCB2aWV3UG9ydFBsYW4uc3RyYXRlZ3kgPT09IGFjdGl2YXRpb25TdHJhdGVneS5yZXBsYWNlKVxyXG4gICAgICAgICAgICAmJiBjYWxsYmFja05hbWUgaW4gdmlld01vZGVsKSB7XHJcbiAgICAgICAgICAgIGxpc3QucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB2aWV3TW9kZWwsXHJcbiAgICAgICAgICAgICAgICBsaWZlY3ljbGVBcmdzOiB2aWV3UG9ydEluc3RydWN0aW9uLmxpZmVjeWNsZUFyZ3MsXHJcbiAgICAgICAgICAgICAgICByb3V0ZXJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBjaGlsZE5hdkluc3RydWN0aW9uID0gdmlld1BvcnRQbGFuLmNoaWxkTmF2aWdhdGlvbkluc3RydWN0aW9uO1xyXG4gICAgICAgIGlmIChjaGlsZE5hdkluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGZpbmRBY3RpdmF0YWJsZShjaGlsZE5hdkluc3RydWN0aW9uLCBjYWxsYmFja05hbWUsIGxpc3QsIHZpZXdQb3J0Q29tcG9uZW50LmNoaWxkUm91dGVyIHx8IHJvdXRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbGlzdDtcclxufTtcclxuY29uc3Qgc2hvdWxkQ29udGludWUgPSAob3V0cHV0LCByb3V0ZXIpID0+IHtcclxuICAgIGlmIChvdXRwdXQgaW5zdGFuY2VvZiBFcnJvcikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmIChpc05hdmlnYXRpb25Db21tYW5kKG91dHB1dCkpIHtcclxuICAgICAgICBpZiAodHlwZW9mIG91dHB1dC5zZXRSb3V0ZXIgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgb3V0cHV0LnNldFJvdXRlcihyb3V0ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gISFvdXRwdXQuc2hvdWxkQ29udGludWVQcm9jZXNzaW5nO1xyXG4gICAgfVxyXG4gICAgaWYgKG91dHB1dCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0cHV0O1xyXG59O1xyXG4vKipcclxuICogd3JhcHMgYSBzdWJzY3JpcHRpb24sIGFsbG93aW5nIHVuc3Vic2NyaWJlIGNhbGxzIGV2ZW4gaWZcclxuICogdGhlIGZpcnN0IHZhbHVlIGNvbWVzIHN5bmNocm9ub3VzbHlcclxuICovXHJcbmNsYXNzIFNhZmVTdWJzY3JpcHRpb24ge1xyXG4gICAgY29uc3RydWN0b3Ioc3Vic2NyaXB0aW9uRnVuYykge1xyXG4gICAgICAgIHRoaXMuX3N1YnNjcmliZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbiA9IHN1YnNjcmlwdGlvbkZ1bmModGhpcyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9zdWJzY3JpYmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgc3Vic2NyaWJlZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlZDtcclxuICAgIH1cclxuICAgIHVuc3Vic2NyaWJlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9zdWJzY3JpYmVkICYmIHRoaXMuX3N1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBBIGZ1bmN0aW9uIHRvIHByb2Nlc3MgcmV0dXJuIHZhbHVlIGZyb20gYGFjdGl2YXRlYC9gY2FuQWN0aXZhdGVgIHN0ZXBzXHJcbiAqIFN1cHBvcnRzIG9ic2VydmFibGUvcHJvbWlzZVxyXG4gKlxyXG4gKiBGb3Igb2JzZXJ2YWJsZSwgcmVzb2x2ZSBhdCBmaXJzdCBuZXh0KCkgb3Igb24gY29tcGxldGUoKVxyXG4gKi9cclxuY29uc3QgcHJvY2Vzc1BvdGVudGlhbCA9IChvYmosIHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgLy8gaWYgcHJvbWlzZSBsaWtlXHJcbiAgICBpZiAob2JqICYmIHR5cGVvZiBvYmoudGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUob2JqKS50aGVuKHJlc29sdmUpLmNhdGNoKHJlamVjdCk7XHJcbiAgICB9XHJcbiAgICAvLyBpZiBvYnNlcnZhYmxlXHJcbiAgICBpZiAob2JqICYmIHR5cGVvZiBvYmouc3Vic2NyaWJlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgbGV0IG9icyA9IG9iajtcclxuICAgICAgICByZXR1cm4gbmV3IFNhZmVTdWJzY3JpcHRpb24oc3ViID0+IG9icy5zdWJzY3JpYmUoe1xyXG4gICAgICAgICAgICBuZXh0KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN1Yi5zdWJzY3JpYmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvYmopO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN1Yi5zdWJzY3JpYmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY29tcGxldGUoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3ViLnN1YnNjcmliZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSk7XHJcbiAgICB9XHJcbiAgICAvLyBlbHNlIGp1c3QgcmVzb2x2ZVxyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShvYmopO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlamVjdChlcnJvcik7XHJcbiAgICB9XHJcbn07XG5cbi8qKlxyXG4gKiBBIHBpcGVsaW5lIHN0ZXAgcmVzcG9uc2libGUgZm9yIGZpbmRpbmcgYW5kIGFjdGl2YXRpbmcgbWV0aG9kIGBjYW5EZWFjdGl2YXRlYCBvbiBhIHZpZXcgbW9kZWwgb2YgYSByb3V0ZVxyXG4gKi9cclxuY2xhc3MgQ2FuRGVhY3RpdmF0ZVByZXZpb3VzU3RlcCB7XHJcbiAgICBydW4obmF2aWdhdGlvbkluc3RydWN0aW9uLCBuZXh0KSB7XHJcbiAgICAgICAgcmV0dXJuIHByb2Nlc3NEZWFjdGl2YXRhYmxlKG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgJ2NhbkRlYWN0aXZhdGUnLCBuZXh0KTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogQSBwaXBlbGluZSBzdGVwIHJlc3BvbnNpYmxlIGZvciBmaW5kaW5nIGFuZCBhY3RpdmF0aW5nIG1ldGhvZCBgY2FuQWN0aXZhdGVgIG9uIGEgdmlldyBtb2RlbCBvZiBhIHJvdXRlXHJcbiAqL1xyXG5jbGFzcyBDYW5BY3RpdmF0ZU5leHRTdGVwIHtcclxuICAgIHJ1bihuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIG5leHQpIHtcclxuICAgICAgICByZXR1cm4gcHJvY2Vzc0FjdGl2YXRhYmxlKG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgJ2NhbkFjdGl2YXRlJywgbmV4dCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEEgcGlwZWxpbmUgc3RlcCByZXNwb25zaWJsZSBmb3IgZmluZGluZyBhbmQgYWN0aXZhdGluZyBtZXRob2QgYGRlYWN0aXZhdGVgIG9uIGEgdmlldyBtb2RlbCBvZiBhIHJvdXRlXHJcbiAqL1xyXG5jbGFzcyBEZWFjdGl2YXRlUHJldmlvdXNTdGVwIHtcclxuICAgIHJ1bihuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIG5leHQpIHtcclxuICAgICAgICByZXR1cm4gcHJvY2Vzc0RlYWN0aXZhdGFibGUobmF2aWdhdGlvbkluc3RydWN0aW9uLCAnZGVhY3RpdmF0ZScsIG5leHQsIHRydWUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBBIHBpcGVsaW5lIHN0ZXAgcmVzcG9uc2libGUgZm9yIGZpbmRpbmcgYW5kIGFjdGl2YXRpbmcgbWV0aG9kIGBhY3RpdmF0ZWAgb24gYSB2aWV3IG1vZGVsIG9mIGEgcm91dGVcclxuICovXHJcbmNsYXNzIEFjdGl2YXRlTmV4dFN0ZXAge1xyXG4gICAgcnVuKG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgbmV4dCkge1xyXG4gICAgICAgIHJldHVybiBwcm9jZXNzQWN0aXZhdGFibGUobmF2aWdhdGlvbkluc3RydWN0aW9uLCAnYWN0aXZhdGUnLCBuZXh0LCB0cnVlKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQSBtdWx0aS1zbG90cyBQaXBlbGluZSBQbGFjZWhvbGRlciBTdGVwIGZvciBob29raW5nIGludG8gYSBwaXBlbGluZSBleGVjdXRpb25cclxuICovXHJcbmNsYXNzIFBpcGVsaW5lU2xvdCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb250YWluZXIsIG5hbWUsIGFsaWFzKSB7XHJcbiAgICAgICAgdGhpcy5zdGVwcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuc2xvdE5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuc2xvdEFsaWFzID0gYWxpYXM7XHJcbiAgICB9XHJcbiAgICBnZXRTdGVwcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdGVwcy5tYXAoeCA9PiB0aGlzLmNvbnRhaW5lci5nZXQoeCkpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBDbGFzcyByZXNwb25zaWJsZSBmb3IgY3JlYXRpbmcgdGhlIG5hdmlnYXRpb24gcGlwZWxpbmUuXHJcbiAqL1xyXG5jbGFzcyBQaXBlbGluZVByb3ZpZGVyIHtcclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgc3RhdGljIGluamVjdCgpIHsgcmV0dXJuIFtDb250YWluZXJdOyB9XHJcbiAgICBjb25zdHJ1Y3Rvcihjb250YWluZXIpIHtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgICAgICB0aGlzLnN0ZXBzID0gW1xyXG4gICAgICAgICAgICBCdWlsZE5hdmlnYXRpb25QbGFuU3RlcCxcclxuICAgICAgICAgICAgQ2FuRGVhY3RpdmF0ZVByZXZpb3VzU3RlcCxcclxuICAgICAgICAgICAgTG9hZFJvdXRlU3RlcCxcclxuICAgICAgICAgICAgY3JlYXRlUGlwZWxpbmVTbG90KGNvbnRhaW5lciwgXCJhdXRob3JpemVcIiAvKiBBdXRob3JpemUgKi8pLFxyXG4gICAgICAgICAgICBDYW5BY3RpdmF0ZU5leHRTdGVwLFxyXG4gICAgICAgICAgICBjcmVhdGVQaXBlbGluZVNsb3QoY29udGFpbmVyLCBcInByZUFjdGl2YXRlXCIgLyogUHJlQWN0aXZhdGUgKi8sICdtb2RlbGJpbmQnKSxcclxuICAgICAgICAgICAgLy8gTk9URTogYXBwIHN0YXRlIGNoYW5nZXMgc3RhcnQgYmVsb3cgLSBwb2ludCBvZiBubyByZXR1cm5cclxuICAgICAgICAgICAgRGVhY3RpdmF0ZVByZXZpb3VzU3RlcCxcclxuICAgICAgICAgICAgQWN0aXZhdGVOZXh0U3RlcCxcclxuICAgICAgICAgICAgY3JlYXRlUGlwZWxpbmVTbG90KGNvbnRhaW5lciwgXCJwcmVSZW5kZXJcIiAvKiBQcmVSZW5kZXIgKi8sICdwcmVjb21taXQnKSxcclxuICAgICAgICAgICAgQ29tbWl0Q2hhbmdlc1N0ZXAsXHJcbiAgICAgICAgICAgIGNyZWF0ZVBpcGVsaW5lU2xvdChjb250YWluZXIsIFwicG9zdFJlbmRlclwiIC8qIFBvc3RSZW5kZXIgKi8sICdwb3N0Y29tcGxldGUnKVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSB0aGUgbmF2aWdhdGlvbiBwaXBlbGluZS5cclxuICAgICAqL1xyXG4gICAgY3JlYXRlUGlwZWxpbmUodXNlQ2FuRGVhY3RpdmF0ZVN0ZXAgPSB0cnVlKSB7XHJcbiAgICAgICAgbGV0IHBpcGVsaW5lID0gbmV3IFBpcGVsaW5lKCk7XHJcbiAgICAgICAgdGhpcy5zdGVwcy5mb3JFYWNoKHN0ZXAgPT4ge1xyXG4gICAgICAgICAgICBpZiAodXNlQ2FuRGVhY3RpdmF0ZVN0ZXAgfHwgc3RlcCAhPT0gQ2FuRGVhY3RpdmF0ZVByZXZpb3VzU3RlcCkge1xyXG4gICAgICAgICAgICAgICAgcGlwZWxpbmUuYWRkU3RlcCh0aGlzLmNvbnRhaW5lci5nZXQoc3RlcCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHBpcGVsaW5lO1xyXG4gICAgfVxyXG4gICAgLyoqQGludGVybmFsICovXHJcbiAgICBfZmluZFN0ZXAobmFtZSkge1xyXG4gICAgICAgIC8vIFN0ZXBzIHRoYXQgYXJlIG5vdCBQaXBlbGluZVNsb3RzIGFyZSBjb25zdHJ1Y3RvciBmdW5jdGlvbnMsIGFuZCB0aGV5IHdpbGwgYXV0b21hdGljYWxseSBmYWlsLiBQcm9iYWJseS5cclxuICAgICAgICByZXR1cm4gdGhpcy5zdGVwcy5maW5kKHggPT4geC5zbG90TmFtZSA9PT0gbmFtZSB8fCB4LnNsb3RBbGlhcyA9PT0gbmFtZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgYSBzdGVwIGludG8gdGhlIHBpcGVsaW5lIGF0IGEga25vd24gc2xvdCBsb2NhdGlvbi5cclxuICAgICAqL1xyXG4gICAgYWRkU3RlcChuYW1lLCBzdGVwKSB7XHJcbiAgICAgICAgbGV0IGZvdW5kID0gdGhpcy5fZmluZFN0ZXAobmFtZSk7XHJcbiAgICAgICAgaWYgKGZvdW5kKSB7XHJcbiAgICAgICAgICAgIGxldCBzbG90U3RlcHMgPSBmb3VuZC5zdGVwcztcclxuICAgICAgICAgICAgLy8gcHJldmVudCBkdXBsaWNhdGVzXHJcbiAgICAgICAgICAgIGlmICghc2xvdFN0ZXBzLmluY2x1ZGVzKHN0ZXApKSB7XHJcbiAgICAgICAgICAgICAgICBzbG90U3RlcHMucHVzaChzdGVwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHBpcGVsaW5lIHNsb3QgbmFtZTogJHtuYW1lfS5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgYSBzdGVwIGZyb20gYSBzbG90IGluIHRoZSBwaXBlbGluZVxyXG4gICAgICovXHJcbiAgICByZW1vdmVTdGVwKG5hbWUsIHN0ZXApIHtcclxuICAgICAgICBsZXQgc2xvdCA9IHRoaXMuX2ZpbmRTdGVwKG5hbWUpO1xyXG4gICAgICAgIGlmIChzbG90KSB7XHJcbiAgICAgICAgICAgIGxldCBzbG90U3RlcHMgPSBzbG90LnN0ZXBzO1xyXG4gICAgICAgICAgICBzbG90U3RlcHMuc3BsaWNlKHNsb3RTdGVwcy5pbmRleE9mKHN0ZXApLCAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENsZWFycyBhbGwgc3RlcHMgZnJvbSBhIHNsb3QgaW4gdGhlIHBpcGVsaW5lXHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgX2NsZWFyU3RlcHMobmFtZSA9ICcnKSB7XHJcbiAgICAgICAgbGV0IHNsb3QgPSB0aGlzLl9maW5kU3RlcChuYW1lKTtcclxuICAgICAgICBpZiAoc2xvdCkge1xyXG4gICAgICAgICAgICBzbG90LnN0ZXBzID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgYWxsIHBpcGVsaW5lIHNsb3RzXHJcbiAgICAgKi9cclxuICAgIHJlc2V0KCkge1xyXG4gICAgICAgIHRoaXMuX2NsZWFyU3RlcHMoXCJhdXRob3JpemVcIiAvKiBBdXRob3JpemUgKi8pO1xyXG4gICAgICAgIHRoaXMuX2NsZWFyU3RlcHMoXCJwcmVBY3RpdmF0ZVwiIC8qIFByZUFjdGl2YXRlICovKTtcclxuICAgICAgICB0aGlzLl9jbGVhclN0ZXBzKFwicHJlUmVuZGVyXCIgLyogUHJlUmVuZGVyICovKTtcclxuICAgICAgICB0aGlzLl9jbGVhclN0ZXBzKFwicG9zdFJlbmRlclwiIC8qIFBvc3RSZW5kZXIgKi8pO1xyXG4gICAgfVxyXG59XHJcbi8qKkBpbnRlcm5hbCAqL1xyXG5jb25zdCBjcmVhdGVQaXBlbGluZVNsb3QgPSAoY29udGFpbmVyLCBuYW1lLCBhbGlhcykgPT4ge1xyXG4gICAgcmV0dXJuIG5ldyBQaXBlbGluZVNsb3QoY29udGFpbmVyLCBuYW1lLCBhbGlhcyk7XHJcbn07XG5cbmNvbnN0IGxvZ2dlciA9IGdldExvZ2dlcignYXBwLXJvdXRlcicpO1xyXG4vKipcclxuICogVGhlIG1haW4gYXBwbGljYXRpb24gcm91dGVyLlxyXG4gKi9cclxuY2xhc3MgQXBwUm91dGVyIGV4dGVuZHMgUm91dGVyIHtcclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgc3RhdGljIGluamVjdCgpIHsgcmV0dXJuIFtDb250YWluZXIsIEhpc3RvcnksIFBpcGVsaW5lUHJvdmlkZXIsIEV2ZW50QWdncmVnYXRvcl07IH1cclxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgaGlzdG9yeSwgcGlwZWxpbmVQcm92aWRlciwgZXZlbnRzKSB7XHJcbiAgICAgICAgc3VwZXIoY29udGFpbmVyLCBoaXN0b3J5KTsgLy8gTm90ZSB0aGUgc3VwZXIgd2lsbCBjYWxsIHJlc2V0IGludGVybmFsbHkuXHJcbiAgICAgICAgdGhpcy5waXBlbGluZVByb3ZpZGVyID0gcGlwZWxpbmVQcm92aWRlcjtcclxuICAgICAgICB0aGlzLmV2ZW50cyA9IGV2ZW50cztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRnVsbHkgcmVzZXRzIHRoZSByb3V0ZXIncyBpbnRlcm5hbCBzdGF0ZS4gUHJpbWFyaWx5IHVzZWQgaW50ZXJuYWxseSBieSB0aGUgZnJhbWV3b3JrIHdoZW4gbXVsdGlwbGUgY2FsbHMgdG8gc2V0Um9vdCBhcmUgbWFkZS5cclxuICAgICAqIFVzZSB3aXRoIGNhdXRpb24gKGFjdHVhbGx5LCBhdm9pZCB1c2luZyB0aGlzKS4gRG8gbm90IHVzZSB0aGlzIHRvIHNpbXBseSBjaGFuZ2UgeW91ciBuYXZpZ2F0aW9uIG1vZGVsLlxyXG4gICAgICovXHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICBzdXBlci5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMubWF4SW5zdHJ1Y3Rpb25Db3VudCA9IDEwO1xyXG4gICAgICAgIGlmICghdGhpcy5fcXVldWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fcXVldWUgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3F1ZXVlLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBMb2FkcyB0aGUgc3BlY2lmaWVkIFVSTC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXJsIFRoZSBVUkwgZnJhZ21lbnQgdG8gbG9hZC5cclxuICAgICAqL1xyXG4gICAgbG9hZFVybCh1cmwpIHtcclxuICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICAuX2NyZWF0ZU5hdmlnYXRpb25JbnN0cnVjdGlvbih1cmwpXHJcbiAgICAgICAgICAgIC50aGVuKGluc3RydWN0aW9uID0+IHRoaXMuX3F1ZXVlSW5zdHJ1Y3Rpb24oaW5zdHJ1Y3Rpb24pKVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICByZXN0b3JlUHJldmlvdXNMb2NhdGlvbih0aGlzKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXJzIGEgdmlld1BvcnQgdG8gYmUgdXNlZCBhcyBhIHJlbmRlcmluZyB0YXJnZXQgZm9yIGFjdGl2YXRlZCByb3V0ZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZpZXdQb3J0IFRoZSB2aWV3UG9ydC4gVGhpcyBpcyB0eXBpY2FsbHkgYSA8cm91dGVyLXZpZXcvPiBlbGVtZW50IGluIEF1cmVsaWEgZGVmYXVsdCBpbXBsXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBUaGUgbmFtZSBvZiB0aGUgdmlld1BvcnQuICdkZWZhdWx0JyBpZiB1bnNwZWNpZmllZC5cclxuICAgICAqL1xyXG4gICAgcmVnaXN0ZXJWaWV3UG9ydCh2aWV3UG9ydCwgbmFtZSkge1xyXG4gICAgICAgIC8vIGhhdmluZyBzdHJvbmcgdHlwaW5nIHdpdGhvdXQgY2hhbmdpbmcgcHVibGljIEFQSVxyXG4gICAgICAgIGNvbnN0ICR2aWV3UG9ydCA9IHZpZXdQb3J0O1xyXG4gICAgICAgIHN1cGVyLnJlZ2lzdGVyVmlld1BvcnQoJHZpZXdQb3J0LCBuYW1lKTtcclxuICAgICAgICAvLyBiZXNpZGUgYWRkaW5nIHZpZXdwb3J0IHRvIHRoZSByZWdpc3RyeSBvZiB0aGlzIGluc3RhbmNlXHJcbiAgICAgICAgLy8gQXBwUm91dGVyIGFsc28gY29uZmlndXJlIHJvdXRpbmcvaGlzdG9yeSB0byBzdGFydCByb3V0aW5nIGZ1bmN0aW9uYWxpdHlcclxuICAgICAgICAvLyBUaGVyZSBhcmUgc2l0dWF0aW9uIHdoZXJlIHRoZXJlIGFyZSBtb3JlIHRoYW4gMSA8cm91dGVyLXZpZXcvPiBlbGVtZW50IGF0IHJvb3Qgdmlld1xyXG4gICAgICAgIC8vIGluIHRoYXQgY2FzZSwgc3RpbGwgb25seSBhY3RpdmF0ZSBvbmNlIHZpYSB0aGUgZm9sbG93aW5nIGd1YXJkXHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXdNb2RlbCA9IHRoaXMuX2ZpbmRWaWV3TW9kZWwoJHZpZXdQb3J0KTtcclxuICAgICAgICAgICAgaWYgKCdjb25maWd1cmVSb3V0ZXInIGluIHZpZXdNb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgPHJvdXRlci12aWV3Lz4gZWxlbWVudCBhdCByb290IHZpZXdcclxuICAgICAgICAgICAgICAgIC8vIHVzZSB0aGlzIGZsYWcgdG8gZ3VhcmQgYWdhaW5zdCBjb25maWd1cmUgbWV0aG9kIGJlaW5nIGludm9rZWQgbXVsdGlwbGUgdGltZXNcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgZmxhZyBpcyBzZXQgaW5zaWRlIG1ldGhvZCBjb25maWd1cmVcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0NvbmZpZ3VyZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyByZXBsYWNlIHRoZSByZWFsIHJlc29sdmUgd2l0aCBhIG5vb3AgdG8gZ3VhcmFudGVlIHRoYXQgYW55IGFjdGlvbiBpbiBiYXNlIGNsYXNzIFJvdXRlclxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdvbid0IHJlc29sdmUgdGhlIGNvbmZpZ3VyZVByb21pc2UgcHJlbWF0dXJlbHlcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNvbHZlQ29uZmlndXJlZFByb21pc2UgPSB0aGlzLl9yZXNvbHZlQ29uZmlndXJlZFByb21pc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZUNvbmZpZ3VyZWRQcm9taXNlID0gKCkgPT4geyB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb25maWd1cmUoY29uZmlnID0+IFByb21pc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlc29sdmUodmlld01vZGVsLmNvbmZpZ3VyZVJvdXRlcihjb25maWcsIHRoaXMpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbiBpc3N1ZSB3aXRoIGNvbmZpZ3VyZSBpbnRlcmZhY2UuIFNob3VsZCBiZSBmaXhlZCB0aGVyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0b2RvOiBmaXggdGhpcyB2aWEgY29uZmlndXJlIGludGVyZmFjZSBpbiByb3V0ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gY29uZmlnKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDb25maWd1cmVkUHJvbWlzZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHdoZW4gYSB2aWV3cG9ydCBpcyBhZGRlZCBkeW5hbWljYWxseSB0byBhIHJvb3QgdmlldyB0aGF0IGlzIGFscmVhZHkgYWN0aXZhdGVkXHJcbiAgICAgICAgLy8ganVzdCBwcm9jZXNzIHRoZSBuYXZpZ2F0aW9uIGluc3RydWN0aW9uXHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlcXVldWVJbnN0cnVjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFjdGl2YXRlcyB0aGUgcm91dGVyLiBUaGlzIGluc3RydWN0cyB0aGUgcm91dGVyIHRvIGJlZ2luIGxpc3RlbmluZyBmb3IgaGlzdG9yeSBjaGFuZ2VzIGFuZCBwcm9jZXNzaW5nIGluc3RydWN0aW9ucy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW1zIG9wdGlvbnMgVGhlIHNldCBvZiBvcHRpb25zIHRvIGFjdGl2YXRlIHRoZSByb3V0ZXIgd2l0aC5cclxuICAgICAqL1xyXG4gICAgYWN0aXZhdGUob3B0aW9ucykge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc0FjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gcm91dGUgaGFuZGxlciBwcm9wZXJ0eSBpcyByZXNwb25zaWJsZSBmb3IgaGFuZGxpbmcgdXJsIGNoYW5nZVxyXG4gICAgICAgIC8vIHRoZSBpbnRlcmZhY2Ugb2YgYXVyZWxpYS1oaXN0b3J5IGlzbid0IGNsZWFyIG9uIHRoaXMgcGVyc3BlY3RpdmVcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgcm91dGVIYW5kbGVyOiB0aGlzLmxvYWRVcmwuYmluZCh0aGlzKSB9LCB0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuaGlzdG9yeS5hY3RpdmF0ZSh0aGlzLm9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuX2RlcXVldWVJbnN0cnVjdGlvbigpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWFjdGl2YXRlcyB0aGUgcm91dGVyLlxyXG4gICAgICovXHJcbiAgICBkZWFjdGl2YXRlKCkge1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmhpc3RvcnkuZGVhY3RpdmF0ZSgpO1xyXG4gICAgfVxyXG4gICAgLyoqQGludGVybmFsICovXHJcbiAgICBfcXVldWVJbnN0cnVjdGlvbihpbnN0cnVjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgICAgICBpbnN0cnVjdGlvbi5yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgdGhpcy5fcXVldWUudW5zaGlmdChpbnN0cnVjdGlvbik7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlcXVldWVJbnN0cnVjdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqQGludGVybmFsICovXHJcbiAgICBfZGVxdWV1ZUluc3RydWN0aW9uKGluc3RydWN0aW9uQ291bnQgPSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc05hdmlnYXRpbmcgJiYgIWluc3RydWN0aW9uQ291bnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIHRzIGNvbXBsYWlucyBhYm91dCBpbmNvbnNpc3RlbnQgcmV0dXJucyB3aXRob3V0IHZvaWQgMFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQgMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgaW5zdHJ1Y3Rpb24gPSB0aGlzLl9xdWV1ZS5zaGlmdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9xdWV1ZS5sZW5ndGggPSAwO1xyXG4gICAgICAgICAgICBpZiAoIWluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB0cyBjb21wbGFpbnMgYWJvdXQgaW5jb25zaXN0ZW50IHJldHVybnMgd2l0aG91dCB2b2lkIDBcclxuICAgICAgICAgICAgICAgIHJldHVybiB2b2lkIDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5pc05hdmlnYXRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICBsZXQgbmF2dHJhY2tlciA9IHRoaXMuaGlzdG9yeS5nZXRTdGF0ZSgnTmF2aWdhdGlvblRyYWNrZXInKTtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnROYXZUcmFja2VyID0gdGhpcy5jdXJyZW50TmF2aWdhdGlvblRyYWNrZXI7XHJcbiAgICAgICAgICAgIGlmICghbmF2dHJhY2tlciAmJiAhY3VycmVudE5hdlRyYWNrZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNOYXZpZ2F0aW5nRmlyc3QgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc05hdmlnYXRpbmdOZXcgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCFuYXZ0cmFja2VyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzTmF2aWdhdGluZ05ldyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoIWN1cnJlbnROYXZUcmFja2VyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzTmF2aWdhdGluZ1JlZnJlc2ggPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGN1cnJlbnROYXZUcmFja2VyIDwgbmF2dHJhY2tlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc05hdmlnYXRpbmdGb3J3YXJkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjdXJyZW50TmF2VHJhY2tlciA+IG5hdnRyYWNrZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNOYXZpZ2F0aW5nQmFjayA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFuYXZ0cmFja2VyKSB7XHJcbiAgICAgICAgICAgICAgICBuYXZ0cmFja2VyID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGlzdG9yeS5zZXRTdGF0ZSgnTmF2aWdhdGlvblRyYWNrZXInLCBuYXZ0cmFja2VyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnROYXZpZ2F0aW9uVHJhY2tlciA9IG5hdnRyYWNrZXI7XHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uLnByZXZpb3VzSW5zdHJ1Y3Rpb24gPSB0aGlzLmN1cnJlbnRJbnN0cnVjdGlvbjtcclxuICAgICAgICAgICAgbGV0IG1heEluc3RydWN0aW9uQ291bnQgPSB0aGlzLm1heEluc3RydWN0aW9uQ291bnQ7XHJcbiAgICAgICAgICAgIGlmICghaW5zdHJ1Y3Rpb25Db3VudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ldmVudHMucHVibGlzaChcInJvdXRlcjpuYXZpZ2F0aW9uOnByb2Nlc3NpbmdcIiAvKiBQcm9jZXNzaW5nICovLCB7IGluc3RydWN0aW9uIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGluc3RydWN0aW9uQ291bnQgPT09IG1heEluc3RydWN0aW9uQ291bnQgLSAxKSB7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoYCR7aW5zdHJ1Y3Rpb25Db3VudCArIDF9IG5hdmlnYXRpb24gaW5zdHJ1Y3Rpb25zIGhhdmUgYmVlbiBhdHRlbXB0ZWQgd2l0aG91dCBzdWNjZXNzLiBSZXN0b3JpbmcgbGFzdCBrbm93biBnb29kIGxvY2F0aW9uLmApO1xyXG4gICAgICAgICAgICAgICAgcmVzdG9yZVByZXZpb3VzTG9jYXRpb24odGhpcyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZGVxdWV1ZUluc3RydWN0aW9uKGluc3RydWN0aW9uQ291bnQgKyAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChpbnN0cnVjdGlvbkNvdW50ID4gbWF4SW5zdHJ1Y3Rpb25Db3VudCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNYXhpbXVtIG5hdmlnYXRpb24gYXR0ZW1wdHMgZXhjZWVkZWQuIEdpdmluZyB1cC4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgcGlwZWxpbmUgPSB0aGlzLnBpcGVsaW5lUHJvdmlkZXIuY3JlYXRlUGlwZWxpbmUoIXRoaXMuY291bGREZWFjdGl2YXRlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHBpcGVsaW5lXHJcbiAgICAgICAgICAgICAgICAucnVuKGluc3RydWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHByb2Nlc3NSZXN1bHQoaW5zdHJ1Y3Rpb24sIHJlc3VsdCwgaW5zdHJ1Y3Rpb25Db3VudCwgdGhpcykpXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgb3V0cHV0OiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoZXJyb3IpIH07XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbihyZXN1bHQgPT4gcmVzb2x2ZUluc3RydWN0aW9uKGluc3RydWN0aW9uLCByZXN1bHQsICEhaW5zdHJ1Y3Rpb25Db3VudCwgdGhpcykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqQGludGVybmFsICovXHJcbiAgICBfZmluZFZpZXdNb2RlbCh2aWV3UG9ydCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbnRhaW5lci52aWV3TW9kZWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVyLnZpZXdNb2RlbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZpZXdQb3J0LmNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICBsZXQgY29udGFpbmVyID0gdmlld1BvcnQuY29udGFpbmVyO1xyXG4gICAgICAgICAgICB3aGlsZSAoY29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLnZpZXdNb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnZpZXdNb2RlbCA9IGNvbnRhaW5lci52aWV3TW9kZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRhaW5lci52aWV3TW9kZWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIgPSBjb250YWluZXIucGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbn1cclxuY29uc3QgcHJvY2Vzc1Jlc3VsdCA9IChpbnN0cnVjdGlvbiwgcmVzdWx0LCBpbnN0cnVjdGlvbkNvdW50LCByb3V0ZXIpID0+IHtcclxuICAgIGlmICghKHJlc3VsdCAmJiAnY29tcGxldGVkJyBpbiByZXN1bHQgJiYgJ291dHB1dCcgaW4gcmVzdWx0KSkge1xyXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCB8fCB7fTtcclxuICAgICAgICByZXN1bHQub3V0cHV0ID0gbmV3IEVycm9yKGBFeHBlY3RlZCByb3V0ZXIgcGlwZWxpbmUgdG8gcmV0dXJuIGEgbmF2aWdhdGlvbiByZXN1bHQsIGJ1dCBnb3QgWyR7SlNPTi5zdHJpbmdpZnkocmVzdWx0KX1dIGluc3RlYWQuYCk7XHJcbiAgICB9XHJcbiAgICBsZXQgZmluYWxSZXN1bHQgPSBudWxsO1xyXG4gICAgbGV0IG5hdmlnYXRpb25Db21tYW5kUmVzdWx0ID0gbnVsbDtcclxuICAgIGlmIChpc05hdmlnYXRpb25Db21tYW5kKHJlc3VsdC5vdXRwdXQpKSB7XHJcbiAgICAgICAgbmF2aWdhdGlvbkNvbW1hbmRSZXN1bHQgPSByZXN1bHQub3V0cHV0Lm5hdmlnYXRlKHJvdXRlcik7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBmaW5hbFJlc3VsdCA9IHJlc3VsdDtcclxuICAgICAgICBpZiAoIXJlc3VsdC5jb21wbGV0ZWQpIHtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdC5vdXRwdXQgaW5zdGFuY2VvZiBFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKHJlc3VsdC5vdXRwdXQudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVzdG9yZVByZXZpb3VzTG9jYXRpb24ocm91dGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5hdmlnYXRpb25Db21tYW5kUmVzdWx0KVxyXG4gICAgICAgIC50aGVuKF8gPT4gcm91dGVyLl9kZXF1ZXVlSW5zdHJ1Y3Rpb24oaW5zdHJ1Y3Rpb25Db3VudCArIDEpKVxyXG4gICAgICAgIC50aGVuKGlubmVyUmVzdWx0ID0+IGZpbmFsUmVzdWx0IHx8IGlubmVyUmVzdWx0IHx8IHJlc3VsdCk7XHJcbn07XHJcbmNvbnN0IHJlc29sdmVJbnN0cnVjdGlvbiA9IChpbnN0cnVjdGlvbiwgcmVzdWx0LCBpc0lubmVySW5zdHJ1Y3Rpb24sIHJvdXRlcikgPT4ge1xyXG4gICAgaW5zdHJ1Y3Rpb24ucmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgbGV0IGV2ZW50QWdncmVnYXRvciA9IHJvdXRlci5ldmVudHM7XHJcbiAgICBsZXQgZXZlbnRBcmdzID0geyBpbnN0cnVjdGlvbiwgcmVzdWx0IH07XHJcbiAgICBpZiAoIWlzSW5uZXJJbnN0cnVjdGlvbikge1xyXG4gICAgICAgIHJvdXRlci5pc05hdmlnYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICByb3V0ZXIuaXNFeHBsaWNpdE5hdmlnYXRpb24gPSBmYWxzZTtcclxuICAgICAgICByb3V0ZXIuaXNFeHBsaWNpdE5hdmlnYXRpb25CYWNrID0gZmFsc2U7XHJcbiAgICAgICAgcm91dGVyLmlzTmF2aWdhdGluZ0ZpcnN0ID0gZmFsc2U7XHJcbiAgICAgICAgcm91dGVyLmlzTmF2aWdhdGluZ05ldyA9IGZhbHNlO1xyXG4gICAgICAgIHJvdXRlci5pc05hdmlnYXRpbmdSZWZyZXNoID0gZmFsc2U7XHJcbiAgICAgICAgcm91dGVyLmlzTmF2aWdhdGluZ0ZvcndhcmQgPSBmYWxzZTtcclxuICAgICAgICByb3V0ZXIuaXNOYXZpZ2F0aW5nQmFjayA9IGZhbHNlO1xyXG4gICAgICAgIHJvdXRlci5jb3VsZERlYWN0aXZhdGUgPSBmYWxzZTtcclxuICAgICAgICBsZXQgZXZlbnROYW1lO1xyXG4gICAgICAgIGlmIChyZXN1bHQub3V0cHV0IGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgICAgICAgZXZlbnROYW1lID0gXCJyb3V0ZXI6bmF2aWdhdGlvbjplcnJvclwiIC8qIEVycm9yICovO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICghcmVzdWx0LmNvbXBsZXRlZCkge1xyXG4gICAgICAgICAgICBldmVudE5hbWUgPSBcInJvdXRlcjpuYXZpZ2F0aW9uOmNhbmNlbGVkXCIgLyogQ2FuY2VsZWQgKi87XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgcXVlcnlTdHJpbmcgPSBpbnN0cnVjdGlvbi5xdWVyeVN0cmluZyA/ICgnPycgKyBpbnN0cnVjdGlvbi5xdWVyeVN0cmluZykgOiAnJztcclxuICAgICAgICAgICAgcm91dGVyLmhpc3RvcnkucHJldmlvdXNMb2NhdGlvbiA9IGluc3RydWN0aW9uLmZyYWdtZW50ICsgcXVlcnlTdHJpbmc7XHJcbiAgICAgICAgICAgIGV2ZW50TmFtZSA9IFwicm91dGVyOm5hdmlnYXRpb246c3VjY2Vzc1wiIC8qIFN1Y2Nlc3MgKi87XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV2ZW50QWdncmVnYXRvci5wdWJsaXNoKGV2ZW50TmFtZSwgZXZlbnRBcmdzKTtcclxuICAgICAgICBldmVudEFnZ3JlZ2F0b3IucHVibGlzaChcInJvdXRlcjpuYXZpZ2F0aW9uOmNvbXBsZXRlXCIgLyogQ29tcGxldGUgKi8sIGV2ZW50QXJncyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBldmVudEFnZ3JlZ2F0b3IucHVibGlzaChcInJvdXRlcjpuYXZpZ2F0aW9uOmNoaWxkOmNvbXBsZXRlXCIgLyogQ2hpbGRDb21wbGV0ZSAqLywgZXZlbnRBcmdzKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn07XHJcbmNvbnN0IHJlc3RvcmVQcmV2aW91c0xvY2F0aW9uID0gKHJvdXRlcikgPT4ge1xyXG4gICAgbGV0IHByZXZpb3VzTG9jYXRpb24gPSByb3V0ZXIuaGlzdG9yeS5wcmV2aW91c0xvY2F0aW9uO1xyXG4gICAgaWYgKHByZXZpb3VzTG9jYXRpb24pIHtcclxuICAgICAgICByb3V0ZXIubmF2aWdhdGUocHJldmlvdXNMb2NhdGlvbiwgeyB0cmlnZ2VyOiBmYWxzZSwgcmVwbGFjZTogdHJ1ZSB9KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHJvdXRlci5mYWxsYmFja1JvdXRlKSB7XHJcbiAgICAgICAgcm91dGVyLm5hdmlnYXRlKHJvdXRlci5mYWxsYmFja1JvdXRlLCB7IHRyaWdnZXI6IHRydWUsIHJlcGxhY2U6IHRydWUgfSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBsb2dnZXIuZXJyb3IoJ1JvdXRlciBuYXZpZ2F0aW9uIGZhaWxlZCwgYW5kIG5vIHByZXZpb3VzIGxvY2F0aW9uIG9yIGZhbGxiYWNrUm91dGUgY291bGQgYmUgcmVzdG9yZWQuJyk7XHJcbiAgICB9XHJcbn07XG5cbi8qKlxyXG4qIFRoZSBzdGF0dXMgb2YgYSBQaXBlbGluZS5cclxuKi9cclxudmFyIFBpcGVsaW5lU3RhdHVzO1xyXG4oZnVuY3Rpb24gKFBpcGVsaW5lU3RhdHVzKSB7XHJcbiAgICBQaXBlbGluZVN0YXR1c1tcIkNvbXBsZXRlZFwiXSA9IFwiY29tcGxldGVkXCI7XHJcbiAgICBQaXBlbGluZVN0YXR1c1tcIkNhbmNlbGVkXCJdID0gXCJjYW5jZWxlZFwiO1xyXG4gICAgUGlwZWxpbmVTdGF0dXNbXCJSZWplY3RlZFwiXSA9IFwicmVqZWN0ZWRcIjtcclxuICAgIFBpcGVsaW5lU3RhdHVzW1wiUnVubmluZ1wiXSA9IFwicnVubmluZ1wiO1xyXG59KShQaXBlbGluZVN0YXR1cyB8fCAoUGlwZWxpbmVTdGF0dXMgPSB7fSkpO1xuXG4vKipcclxuICogQSBsaXN0IG9mIGtub3duIHJvdXRlciBldmVudHMgdXNlZCBieSB0aGUgQXVyZWxpYSByb3V0ZXJcclxuICogdG8gc2lnbmFsIHRoZSBwaXBlbGluZSBoYXMgY29tZSB0byBhIGNlcnRhaW4gc3RhdGVcclxuICovXHJcbi8vIGNvbnN0IGVudW0gaXMgcHJlc2VydmVkIGluIHRzY29uZmlnXHJcbnZhciBSb3V0ZXJFdmVudDtcclxuKGZ1bmN0aW9uIChSb3V0ZXJFdmVudCkge1xyXG4gICAgUm91dGVyRXZlbnRbXCJQcm9jZXNzaW5nXCJdID0gXCJyb3V0ZXI6bmF2aWdhdGlvbjpwcm9jZXNzaW5nXCI7XHJcbiAgICBSb3V0ZXJFdmVudFtcIkVycm9yXCJdID0gXCJyb3V0ZXI6bmF2aWdhdGlvbjplcnJvclwiO1xyXG4gICAgUm91dGVyRXZlbnRbXCJDYW5jZWxlZFwiXSA9IFwicm91dGVyOm5hdmlnYXRpb246Y2FuY2VsZWRcIjtcclxuICAgIFJvdXRlckV2ZW50W1wiQ29tcGxldGVcIl0gPSBcInJvdXRlcjpuYXZpZ2F0aW9uOmNvbXBsZXRlXCI7XHJcbiAgICBSb3V0ZXJFdmVudFtcIlN1Y2Nlc3NcIl0gPSBcInJvdXRlcjpuYXZpZ2F0aW9uOnN1Y2Nlc3NcIjtcclxuICAgIFJvdXRlckV2ZW50W1wiQ2hpbGRDb21wbGV0ZVwiXSA9IFwicm91dGVyOm5hdmlnYXRpb246Y2hpbGQ6Y29tcGxldGVcIjtcclxufSkoUm91dGVyRXZlbnQgfHwgKFJvdXRlckV2ZW50ID0ge30pKTtcblxuLyoqXHJcbiAqIEF2YWlsYWJsZSBwaXBlbGluZSBzbG90IG5hbWVzIHRvIGluc2VydCBpbnRlcmNlcHRvciBpbnRvIHJvdXRlciBwaXBlbGluZVxyXG4gKi9cclxuLy8gY29uc3QgZW51bSBpcyBwcmVzZXJ2ZWQgaW4gdHNjb25maWdcclxudmFyIFBpcGVsaW5lU2xvdE5hbWU7XHJcbihmdW5jdGlvbiAoUGlwZWxpbmVTbG90TmFtZSkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBBdXRob3JpemF0aW9uIHNsb3QuIEludm9rZWQgZWFybHkgaW4gdGhlIHBpcGVsaW5lLFxyXG4gICAgICogYmVmb3JlIGBjYW5BY3RpdmF0ZWAgaG9vayBvZiBpbmNvbWluZyByb3V0ZVxyXG4gICAgICovXHJcbiAgICBQaXBlbGluZVNsb3ROYW1lW1wiQXV0aG9yaXplXCJdID0gXCJhdXRob3JpemVcIjtcclxuICAgIC8qKlxyXG4gICAgICogUHJlLWFjdGl2YXRpb24gc2xvdC4gSW52b2tlZCBlYXJseSBpbiB0aGUgcGlwZWxpbmUsXHJcbiAgICAgKiBJbnZva2VkIHRpbWluZzpcclxuICAgICAqICAgLSBhZnRlciBBdXRob3JpemF0aW9uIHNsb3RcclxuICAgICAqICAgLSBhZnRlciBjYW5BY3RpdmF0ZSBob29rIG9uIG5ldyB2aWV3IG1vZGVsXHJcbiAgICAgKiAgIC0gYmVmb3JlIGRlYWN0aXZhdGUgaG9vayBvbiBvbGQgdmlldyBtb2RlbFxyXG4gICAgICogICAtIGJlZm9yZSBhY3RpdmF0ZSBob29rIG9uIG5ldyB2aWV3IG1vZGVsXHJcbiAgICAgKi9cclxuICAgIFBpcGVsaW5lU2xvdE5hbWVbXCJQcmVBY3RpdmF0ZVwiXSA9IFwicHJlQWN0aXZhdGVcIjtcclxuICAgIC8qKlxyXG4gICAgICogUHJlLXJlbmRlciBzbG90LiBJbnZva2VkIGxhdGVyIGluIHRoZSBwaXBlbGluZVxyXG4gICAgICogSW52b2tjYXRpb24gdGltaW5nOlxyXG4gICAgICogICAtIGFmdGVyIGFjdGl2YXRlIGhvb2sgb24gbmV3IHZpZXcgbW9kZWxcclxuICAgICAqICAgLSBiZWZvcmUgY29tbWl0IHN0ZXAgb24gbmV3IG5hdmlnYXRpb24gaW5zdHJ1Y3Rpb25cclxuICAgICAqL1xyXG4gICAgUGlwZWxpbmVTbG90TmFtZVtcIlByZVJlbmRlclwiXSA9IFwicHJlUmVuZGVyXCI7XHJcbiAgICAvKipcclxuICAgICAqIFBvc3QtcmVuZGVyIHNsb3QuIEludm9rZWQgbGFzdCBpbiB0aGUgcGlwZWxpbmVcclxuICAgICAqL1xyXG4gICAgUGlwZWxpbmVTbG90TmFtZVtcIlBvc3RSZW5kZXJcIl0gPSBcInBvc3RSZW5kZXJcIjtcclxufSkoUGlwZWxpbmVTbG90TmFtZSB8fCAoUGlwZWxpbmVTbG90TmFtZSA9IHt9KSk7XG5cbmV4cG9ydCB7IEFjdGl2YXRlTmV4dFN0ZXAsIEFwcFJvdXRlciwgQnVpbGROYXZpZ2F0aW9uUGxhblN0ZXAsIENhbkFjdGl2YXRlTmV4dFN0ZXAsIENhbkRlYWN0aXZhdGVQcmV2aW91c1N0ZXAsIENvbW1pdENoYW5nZXNTdGVwLCBEZWFjdGl2YXRlUHJldmlvdXNTdGVwLCBMb2FkUm91dGVTdGVwLCBOYXZNb2RlbCwgTmF2aWdhdGlvbkluc3RydWN0aW9uLCBQaXBlbGluZSwgUGlwZWxpbmVQcm92aWRlciwgUGlwZWxpbmVTbG90TmFtZSwgUGlwZWxpbmVTdGF0dXMsIFJlZGlyZWN0LCBSZWRpcmVjdFRvUm91dGUsIFJvdXRlTG9hZGVyLCBSb3V0ZXIsIFJvdXRlckNvbmZpZ3VyYXRpb24sIFJvdXRlckV2ZW50LCBhY3RpdmF0aW9uU3RyYXRlZ3ksIGlzTmF2aWdhdGlvbkNvbW1hbmQgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWF1cmVsaWEtcm91dGVyLmpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/aurelia-router/dist/es2015/aurelia-router.js\n");

/***/ }),

/***/ "./node_modules/aurelia-task-queue/dist/es2015/aurelia-task-queue.js":
/*!***************************************************************************!*\
  !*** ./node_modules/aurelia-task-queue/dist/es2015/aurelia-task-queue.js ***!
  \***************************************************************************/
/*! exports provided: TaskQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TaskQueue\", function() { return TaskQueue; });\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n\n\nconst stackSeparator = '\\nEnqueued in TaskQueue by:\\n';\nconst microStackSeparator = '\\nEnqueued in MicroTaskQueue by:\\n';\n\nfunction makeRequestFlushFromMutationObserver(flush) {\n  let observer = aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"DOM\"].createMutationObserver(flush);\n  let val = 'a';\n  let node = aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"DOM\"].createTextNode('a');\n  let values = Object.create(null);\n  values.a = 'b';\n  values.b = 'a';\n  observer.observe(node, { characterData: true });\n  return function requestFlush() {\n    node.data = val = values[val];\n  };\n}\n\nfunction makeRequestFlushFromTimer(flush) {\n  return function requestFlush() {\n    let timeoutHandle = setTimeout(handleFlushTimer, 0);\n\n    let intervalHandle = setInterval(handleFlushTimer, 50);\n    function handleFlushTimer() {\n      clearTimeout(timeoutHandle);\n      clearInterval(intervalHandle);\n      flush();\n    }\n  };\n}\n\nfunction onError(error, task, longStacks) {\n  if (longStacks && task.stack && typeof error === 'object' && error !== null) {\n    error.stack = filterFlushStack(error.stack) + task.stack;\n  }\n\n  if ('onError' in task) {\n    task.onError(error);\n  } else {\n    setTimeout(() => {\n      throw error;\n    }, 0);\n  }\n}\n\nlet TaskQueue = class TaskQueue {\n  constructor() {\n    this.flushing = false;\n    this.longStacks = false;\n\n    this.microTaskQueue = [];\n    this.microTaskQueueCapacity = 1024;\n    this.taskQueue = [];\n\n    if (aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"FEATURE\"].mutationObserver) {\n      this.requestFlushMicroTaskQueue = makeRequestFlushFromMutationObserver(() => this.flushMicroTaskQueue());\n    } else {\n      this.requestFlushMicroTaskQueue = makeRequestFlushFromTimer(() => this.flushMicroTaskQueue());\n    }\n\n    this.requestFlushTaskQueue = makeRequestFlushFromTimer(() => this.flushTaskQueue());\n  }\n\n  _flushQueue(queue, capacity) {\n    let index = 0;\n    let task;\n\n    try {\n      this.flushing = true;\n      while (index < queue.length) {\n        task = queue[index];\n        if (this.longStacks) {\n          this.stack = typeof task.stack === 'string' ? task.stack : undefined;\n        }\n        task.call();\n        index++;\n\n        if (index > capacity) {\n          for (let scan = 0, newLength = queue.length - index; scan < newLength; scan++) {\n            queue[scan] = queue[scan + index];\n          }\n\n          queue.length -= index;\n          index = 0;\n        }\n      }\n    } catch (error) {\n      onError(error, task, this.longStacks);\n    } finally {\n      this.flushing = false;\n    }\n  }\n\n  queueMicroTask(task) {\n    if (this.microTaskQueue.length < 1) {\n      this.requestFlushMicroTaskQueue();\n    }\n\n    if (this.longStacks) {\n      task.stack = this.prepareQueueStack(microStackSeparator);\n    }\n\n    this.microTaskQueue.push(task);\n  }\n\n  queueTask(task) {\n    if (this.taskQueue.length < 1) {\n      this.requestFlushTaskQueue();\n    }\n\n    if (this.longStacks) {\n      task.stack = this.prepareQueueStack(stackSeparator);\n    }\n\n    this.taskQueue.push(task);\n  }\n\n  flushTaskQueue() {\n    let queue = this.taskQueue;\n    this.taskQueue = [];\n    this._flushQueue(queue, Number.MAX_VALUE);\n  }\n\n  flushMicroTaskQueue() {\n    let queue = this.microTaskQueue;\n    this._flushQueue(queue, this.microTaskQueueCapacity);\n    queue.length = 0;\n  }\n\n  prepareQueueStack(separator) {\n    let stack = separator + filterQueueStack(captureStack());\n\n    if (typeof this.stack === 'string') {\n      stack = filterFlushStack(stack) + this.stack;\n    }\n\n    return stack;\n  }\n};\n\nfunction captureStack() {\n  let error = new Error();\n\n  if (error.stack) {\n    return error.stack;\n  }\n\n  try {\n    throw error;\n  } catch (e) {\n    return e.stack;\n  }\n}\n\nfunction filterQueueStack(stack) {\n  return stack.replace(/^[\\s\\S]*?\\bqueue(Micro)?Task\\b[^\\n]*\\n/, '');\n}\n\nfunction filterFlushStack(stack) {\n  let index = stack.lastIndexOf('flushMicroTaskQueue');\n\n  if (index < 0) {\n    index = stack.lastIndexOf('flushTaskQueue');\n    if (index < 0) {\n      return stack;\n    }\n  }\n\n  index = stack.lastIndexOf('\\n', index);\n\n  return index < 0 ? stack : stack.substr(0, index);\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS10YXNrLXF1ZXVlL2Rpc3QvZXMyMDE1L2F1cmVsaWEtdGFzay1xdWV1ZS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRhc2stcXVldWUvZGlzdC9lczIwMTUvYXVyZWxpYS10YXNrLXF1ZXVlLmpzPzY5NjYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRE9NLCBGRUFUVVJFIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuXG5jb25zdCBzdGFja1NlcGFyYXRvciA9ICdcXG5FbnF1ZXVlZCBpbiBUYXNrUXVldWUgYnk6XFxuJztcbmNvbnN0IG1pY3JvU3RhY2tTZXBhcmF0b3IgPSAnXFxuRW5xdWV1ZWQgaW4gTWljcm9UYXNrUXVldWUgYnk6XFxuJztcblxuZnVuY3Rpb24gbWFrZVJlcXVlc3RGbHVzaEZyb21NdXRhdGlvbk9ic2VydmVyKGZsdXNoKSB7XG4gIGxldCBvYnNlcnZlciA9IERPTS5jcmVhdGVNdXRhdGlvbk9ic2VydmVyKGZsdXNoKTtcbiAgbGV0IHZhbCA9ICdhJztcbiAgbGV0IG5vZGUgPSBET00uY3JlYXRlVGV4dE5vZGUoJ2EnKTtcbiAgbGV0IHZhbHVlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIHZhbHVlcy5hID0gJ2InO1xuICB2YWx1ZXMuYiA9ICdhJztcbiAgb2JzZXJ2ZXIub2JzZXJ2ZShub2RlLCB7IGNoYXJhY3RlckRhdGE6IHRydWUgfSk7XG4gIHJldHVybiBmdW5jdGlvbiByZXF1ZXN0Rmx1c2goKSB7XG4gICAgbm9kZS5kYXRhID0gdmFsID0gdmFsdWVzW3ZhbF07XG4gIH07XG59XG5cbmZ1bmN0aW9uIG1ha2VSZXF1ZXN0Rmx1c2hGcm9tVGltZXIoZmx1c2gpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHJlcXVlc3RGbHVzaCgpIHtcbiAgICBsZXQgdGltZW91dEhhbmRsZSA9IHNldFRpbWVvdXQoaGFuZGxlRmx1c2hUaW1lciwgMCk7XG5cbiAgICBsZXQgaW50ZXJ2YWxIYW5kbGUgPSBzZXRJbnRlcnZhbChoYW5kbGVGbHVzaFRpbWVyLCA1MCk7XG4gICAgZnVuY3Rpb24gaGFuZGxlRmx1c2hUaW1lcigpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SGFuZGxlKTtcbiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxIYW5kbGUpO1xuICAgICAgZmx1c2goKTtcbiAgICB9XG4gIH07XG59XG5cbmZ1bmN0aW9uIG9uRXJyb3IoZXJyb3IsIHRhc2ssIGxvbmdTdGFja3MpIHtcbiAgaWYgKGxvbmdTdGFja3MgJiYgdGFzay5zdGFjayAmJiB0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnICYmIGVycm9yICE9PSBudWxsKSB7XG4gICAgZXJyb3Iuc3RhY2sgPSBmaWx0ZXJGbHVzaFN0YWNrKGVycm9yLnN0YWNrKSArIHRhc2suc3RhY2s7XG4gIH1cblxuICBpZiAoJ29uRXJyb3InIGluIHRhc2spIHtcbiAgICB0YXNrLm9uRXJyb3IoZXJyb3IpO1xuICB9IGVsc2Uge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfSwgMCk7XG4gIH1cbn1cblxuZXhwb3J0IGxldCBUYXNrUXVldWUgPSBjbGFzcyBUYXNrUXVldWUge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmZsdXNoaW5nID0gZmFsc2U7XG4gICAgdGhpcy5sb25nU3RhY2tzID0gZmFsc2U7XG5cbiAgICB0aGlzLm1pY3JvVGFza1F1ZXVlID0gW107XG4gICAgdGhpcy5taWNyb1Rhc2tRdWV1ZUNhcGFjaXR5ID0gMTAyNDtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IFtdO1xuXG4gICAgaWYgKEZFQVRVUkUubXV0YXRpb25PYnNlcnZlcikge1xuICAgICAgdGhpcy5yZXF1ZXN0Rmx1c2hNaWNyb1Rhc2tRdWV1ZSA9IG1ha2VSZXF1ZXN0Rmx1c2hGcm9tTXV0YXRpb25PYnNlcnZlcigoKSA9PiB0aGlzLmZsdXNoTWljcm9UYXNrUXVldWUoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVxdWVzdEZsdXNoTWljcm9UYXNrUXVldWUgPSBtYWtlUmVxdWVzdEZsdXNoRnJvbVRpbWVyKCgpID0+IHRoaXMuZmx1c2hNaWNyb1Rhc2tRdWV1ZSgpKTtcbiAgICB9XG5cbiAgICB0aGlzLnJlcXVlc3RGbHVzaFRhc2tRdWV1ZSA9IG1ha2VSZXF1ZXN0Rmx1c2hGcm9tVGltZXIoKCkgPT4gdGhpcy5mbHVzaFRhc2tRdWV1ZSgpKTtcbiAgfVxuXG4gIF9mbHVzaFF1ZXVlKHF1ZXVlLCBjYXBhY2l0eSkge1xuICAgIGxldCBpbmRleCA9IDA7XG4gICAgbGV0IHRhc2s7XG5cbiAgICB0cnkge1xuICAgICAgdGhpcy5mbHVzaGluZyA9IHRydWU7XG4gICAgICB3aGlsZSAoaW5kZXggPCBxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgdGFzayA9IHF1ZXVlW2luZGV4XTtcbiAgICAgICAgaWYgKHRoaXMubG9uZ1N0YWNrcykge1xuICAgICAgICAgIHRoaXMuc3RhY2sgPSB0eXBlb2YgdGFzay5zdGFjayA9PT0gJ3N0cmluZycgPyB0YXNrLnN0YWNrIDogdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRhc2suY2FsbCgpO1xuICAgICAgICBpbmRleCsrO1xuXG4gICAgICAgIGlmIChpbmRleCA+IGNhcGFjaXR5KSB7XG4gICAgICAgICAgZm9yIChsZXQgc2NhbiA9IDAsIG5ld0xlbmd0aCA9IHF1ZXVlLmxlbmd0aCAtIGluZGV4OyBzY2FuIDwgbmV3TGVuZ3RoOyBzY2FuKyspIHtcbiAgICAgICAgICAgIHF1ZXVlW3NjYW5dID0gcXVldWVbc2NhbiArIGluZGV4XTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBxdWV1ZS5sZW5ndGggLT0gaW5kZXg7XG4gICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIG9uRXJyb3IoZXJyb3IsIHRhc2ssIHRoaXMubG9uZ1N0YWNrcyk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuZmx1c2hpbmcgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBxdWV1ZU1pY3JvVGFzayh0YXNrKSB7XG4gICAgaWYgKHRoaXMubWljcm9UYXNrUXVldWUubGVuZ3RoIDwgMSkge1xuICAgICAgdGhpcy5yZXF1ZXN0Rmx1c2hNaWNyb1Rhc2tRdWV1ZSgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmxvbmdTdGFja3MpIHtcbiAgICAgIHRhc2suc3RhY2sgPSB0aGlzLnByZXBhcmVRdWV1ZVN0YWNrKG1pY3JvU3RhY2tTZXBhcmF0b3IpO1xuICAgIH1cblxuICAgIHRoaXMubWljcm9UYXNrUXVldWUucHVzaCh0YXNrKTtcbiAgfVxuXG4gIHF1ZXVlVGFzayh0YXNrKSB7XG4gICAgaWYgKHRoaXMudGFza1F1ZXVlLmxlbmd0aCA8IDEpIHtcbiAgICAgIHRoaXMucmVxdWVzdEZsdXNoVGFza1F1ZXVlKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubG9uZ1N0YWNrcykge1xuICAgICAgdGFzay5zdGFjayA9IHRoaXMucHJlcGFyZVF1ZXVlU3RhY2soc3RhY2tTZXBhcmF0b3IpO1xuICAgIH1cblxuICAgIHRoaXMudGFza1F1ZXVlLnB1c2godGFzayk7XG4gIH1cblxuICBmbHVzaFRhc2tRdWV1ZSgpIHtcbiAgICBsZXQgcXVldWUgPSB0aGlzLnRhc2tRdWV1ZTtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IFtdO1xuICAgIHRoaXMuX2ZsdXNoUXVldWUocXVldWUsIE51bWJlci5NQVhfVkFMVUUpO1xuICB9XG5cbiAgZmx1c2hNaWNyb1Rhc2tRdWV1ZSgpIHtcbiAgICBsZXQgcXVldWUgPSB0aGlzLm1pY3JvVGFza1F1ZXVlO1xuICAgIHRoaXMuX2ZsdXNoUXVldWUocXVldWUsIHRoaXMubWljcm9UYXNrUXVldWVDYXBhY2l0eSk7XG4gICAgcXVldWUubGVuZ3RoID0gMDtcbiAgfVxuXG4gIHByZXBhcmVRdWV1ZVN0YWNrKHNlcGFyYXRvcikge1xuICAgIGxldCBzdGFjayA9IHNlcGFyYXRvciArIGZpbHRlclF1ZXVlU3RhY2soY2FwdHVyZVN0YWNrKCkpO1xuXG4gICAgaWYgKHR5cGVvZiB0aGlzLnN0YWNrID09PSAnc3RyaW5nJykge1xuICAgICAgc3RhY2sgPSBmaWx0ZXJGbHVzaFN0YWNrKHN0YWNrKSArIHRoaXMuc3RhY2s7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YWNrO1xuICB9XG59O1xuXG5mdW5jdGlvbiBjYXB0dXJlU3RhY2soKSB7XG4gIGxldCBlcnJvciA9IG5ldyBFcnJvcigpO1xuXG4gIGlmIChlcnJvci5zdGFjaykge1xuICAgIHJldHVybiBlcnJvci5zdGFjaztcbiAgfVxuXG4gIHRyeSB7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZS5zdGFjaztcbiAgfVxufVxuXG5mdW5jdGlvbiBmaWx0ZXJRdWV1ZVN0YWNrKHN0YWNrKSB7XG4gIHJldHVybiBzdGFjay5yZXBsYWNlKC9eW1xcc1xcU10qP1xcYnF1ZXVlKE1pY3JvKT9UYXNrXFxiW15cXG5dKlxcbi8sICcnKTtcbn1cblxuZnVuY3Rpb24gZmlsdGVyRmx1c2hTdGFjayhzdGFjaykge1xuICBsZXQgaW5kZXggPSBzdGFjay5sYXN0SW5kZXhPZignZmx1c2hNaWNyb1Rhc2tRdWV1ZScpO1xuXG4gIGlmIChpbmRleCA8IDApIHtcbiAgICBpbmRleCA9IHN0YWNrLmxhc3RJbmRleE9mKCdmbHVzaFRhc2tRdWV1ZScpO1xuICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgIHJldHVybiBzdGFjaztcbiAgICB9XG4gIH1cblxuICBpbmRleCA9IHN0YWNrLmxhc3RJbmRleE9mKCdcXG4nLCBpbmRleCk7XG5cbiAgcmV0dXJuIGluZGV4IDwgMCA/IHN0YWNrIDogc3RhY2suc3Vic3RyKDAsIGluZGV4KTtcbn0iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/aurelia-task-queue/dist/es2015/aurelia-task-queue.js\n");

/***/ }),

/***/ "./node_modules/aurelia-templating/dist/es2015/aurelia-templating.js":
/*!***************************************************************************!*\
  !*** ./node_modules/aurelia-templating/dist/es2015/aurelia-templating.js ***!
  \***************************************************************************/
/*! exports provided: animationEvent, Animator, CompositionTransactionNotifier, CompositionTransactionOwnershipToken, CompositionTransaction, _hyphenate, _isAllWhitespace, ViewEngineHooksResource, viewEngineHooks, ElementEvents, ResourceLoadContext, ViewCompileInstruction, BehaviorInstruction, TargetInstruction, viewStrategy, RelativeViewStrategy, ConventionalViewStrategy, NoViewStrategy, TemplateRegistryViewStrategy, InlineViewStrategy, StaticViewStrategy, ViewLocator, BindingLanguage, SlotCustomAttribute, PassThroughSlot, ShadowSlot, ShadowDOM, validateBehaviorName, ViewResources, View, ViewSlot, BoundViewFactory, ViewFactory, ViewCompiler, ResourceModule, ResourceDescription, ModuleAnalyzer, ViewEngine, Controller, BehaviorPropertyObserver, BindableProperty, HtmlBehaviorResource, children, child, SwapStrategies, CompositionEngine, ElementConfigResource, resource, behavior, customElement, customAttribute, templateController, bindable, dynamicOptions, useShadowDOM, processAttributes, processContent, containerless, useViewStrategy, useView, inlineView, noView, view, elementConfig, viewResources, TemplatingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"animationEvent\", function() { return animationEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Animator\", function() { return Animator; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CompositionTransactionNotifier\", function() { return CompositionTransactionNotifier; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CompositionTransactionOwnershipToken\", function() { return CompositionTransactionOwnershipToken; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CompositionTransaction\", function() { return CompositionTransaction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_hyphenate\", function() { return _hyphenate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_isAllWhitespace\", function() { return _isAllWhitespace; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ViewEngineHooksResource\", function() { return ViewEngineHooksResource; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"viewEngineHooks\", function() { return viewEngineHooks; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ElementEvents\", function() { return ElementEvents; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ResourceLoadContext\", function() { return ResourceLoadContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ViewCompileInstruction\", function() { return ViewCompileInstruction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BehaviorInstruction\", function() { return BehaviorInstruction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TargetInstruction\", function() { return TargetInstruction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"viewStrategy\", function() { return viewStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RelativeViewStrategy\", function() { return RelativeViewStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ConventionalViewStrategy\", function() { return ConventionalViewStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NoViewStrategy\", function() { return NoViewStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplateRegistryViewStrategy\", function() { return TemplateRegistryViewStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InlineViewStrategy\", function() { return InlineViewStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StaticViewStrategy\", function() { return StaticViewStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ViewLocator\", function() { return ViewLocator; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindingLanguage\", function() { return BindingLanguage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SlotCustomAttribute\", function() { return SlotCustomAttribute; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PassThroughSlot\", function() { return PassThroughSlot; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShadowSlot\", function() { return ShadowSlot; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShadowDOM\", function() { return ShadowDOM; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"validateBehaviorName\", function() { return validateBehaviorName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ViewResources\", function() { return ViewResources; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"View\", function() { return View; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ViewSlot\", function() { return ViewSlot; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BoundViewFactory\", function() { return BoundViewFactory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ViewFactory\", function() { return ViewFactory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ViewCompiler\", function() { return ViewCompiler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ResourceModule\", function() { return ResourceModule; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ResourceDescription\", function() { return ResourceDescription; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ModuleAnalyzer\", function() { return ModuleAnalyzer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ViewEngine\", function() { return ViewEngine; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Controller\", function() { return Controller; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BehaviorPropertyObserver\", function() { return BehaviorPropertyObserver; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindableProperty\", function() { return BindableProperty; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HtmlBehaviorResource\", function() { return HtmlBehaviorResource; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"children\", function() { return children; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"child\", function() { return child; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SwapStrategies\", function() { return SwapStrategies; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CompositionEngine\", function() { return CompositionEngine; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ElementConfigResource\", function() { return ElementConfigResource; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"resource\", function() { return resource; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"behavior\", function() { return behavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"customElement\", function() { return customElement; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"customAttribute\", function() { return customAttribute; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"templateController\", function() { return templateController; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bindable\", function() { return bindable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dynamicOptions\", function() { return dynamicOptions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"useShadowDOM\", function() { return useShadowDOM; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"processAttributes\", function() { return processAttributes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"processContent\", function() { return processContent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"containerless\", function() { return containerless; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"useViewStrategy\", function() { return useViewStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"useView\", function() { return useView; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"inlineView\", function() { return inlineView; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"noView\", function() { return noView; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"view\", function() { return view; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"elementConfig\", function() { return elementConfig; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"viewResources\", function() { return viewResources; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplatingEngine\", function() { return TemplatingEngine; });\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-logging */ \"./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-metadata */ \"./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n/* harmony import */ var aurelia_loader__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-loader */ \"./node_modules/aurelia-loader/dist/es2015/aurelia-loader.js\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-path */ \"./node_modules/aurelia-path/dist/es2015/aurelia-path.js\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-binding */ \"./node_modules/aurelia-binding/dist/es2015/aurelia-binding.js\");\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-dependency-injection */ \"./node_modules/aurelia-dependency-injection/dist/es2015/aurelia-dependency-injection.js\");\n/* harmony import */ var aurelia_task_queue__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-task-queue */ \"./node_modules/aurelia-task-queue/dist/es2015/aurelia-task-queue.js\");\nvar _class, _temp, _class2, _temp2, _dec, _class3, _dec2, _class4, _dec3, _class5, _dec4, _class6, _dec5, _class7, _dec6, _class8, _class9, _temp3, _class10, _temp4, _class12, _dec7, _class14, _dec8, _class15, _class16, _temp5, _dec9, _class17, _dec10, _class18, _dec11, _class19;\n\n\n\n\n\n\n\n\n\n\nconst animationEvent = {\n  enterBegin: 'animation:enter:begin',\n  enterActive: 'animation:enter:active',\n  enterDone: 'animation:enter:done',\n  enterTimeout: 'animation:enter:timeout',\n\n  leaveBegin: 'animation:leave:begin',\n  leaveActive: 'animation:leave:active',\n  leaveDone: 'animation:leave:done',\n  leaveTimeout: 'animation:leave:timeout',\n\n  staggerNext: 'animation:stagger:next',\n\n  removeClassBegin: 'animation:remove-class:begin',\n  removeClassActive: 'animation:remove-class:active',\n  removeClassDone: 'animation:remove-class:done',\n  removeClassTimeout: 'animation:remove-class:timeout',\n\n  addClassBegin: 'animation:add-class:begin',\n  addClassActive: 'animation:add-class:active',\n  addClassDone: 'animation:add-class:done',\n  addClassTimeout: 'animation:add-class:timeout',\n\n  animateBegin: 'animation:animate:begin',\n  animateActive: 'animation:animate:active',\n  animateDone: 'animation:animate:done',\n  animateTimeout: 'animation:animate:timeout',\n\n  sequenceBegin: 'animation:sequence:begin',\n  sequenceDone: 'animation:sequence:done'\n};\n\nlet Animator = class Animator {\n  enter(element) {\n    return Promise.resolve(false);\n  }\n\n  leave(element) {\n    return Promise.resolve(false);\n  }\n\n  removeClass(element, className) {\n    element.classList.remove(className);\n    return Promise.resolve(false);\n  }\n\n  addClass(element, className) {\n    element.classList.add(className);\n    return Promise.resolve(false);\n  }\n\n  animate(element, className) {\n    return Promise.resolve(false);\n  }\n\n  runSequence(animations) {}\n\n  registerEffect(effectName, properties) {}\n\n  unregisterEffect(effectName) {}\n};\n\nlet CompositionTransactionNotifier = class CompositionTransactionNotifier {\n  constructor(owner) {\n    this.owner = owner;\n    this.owner._compositionCount++;\n  }\n\n  done() {\n    this.owner._compositionCount--;\n    this.owner._tryCompleteTransaction();\n  }\n};\n\nlet CompositionTransactionOwnershipToken = class CompositionTransactionOwnershipToken {\n  constructor(owner) {\n    this.owner = owner;\n    this.owner._ownershipToken = this;\n    this.thenable = this._createThenable();\n  }\n\n  waitForCompositionComplete() {\n    this.owner._tryCompleteTransaction();\n    return this.thenable;\n  }\n\n  resolve() {\n    this._resolveCallback();\n  }\n\n  _createThenable() {\n    return new Promise((resolve, reject) => {\n      this._resolveCallback = resolve;\n    });\n  }\n};\n\nlet CompositionTransaction = class CompositionTransaction {\n  constructor() {\n    this._ownershipToken = null;\n    this._compositionCount = 0;\n  }\n\n  tryCapture() {\n    return this._ownershipToken === null ? new CompositionTransactionOwnershipToken(this) : null;\n  }\n\n  enlist() {\n    return new CompositionTransactionNotifier(this);\n  }\n\n  _tryCompleteTransaction() {\n    if (this._compositionCount <= 0) {\n      this._compositionCount = 0;\n\n      if (this._ownershipToken !== null) {\n        let token = this._ownershipToken;\n        this._ownershipToken = null;\n        token.resolve();\n      }\n    }\n  }\n};\n\nconst capitalMatcher = /([A-Z])/g;\n\nfunction addHyphenAndLower(char) {\n  return '-' + char.toLowerCase();\n}\n\nfunction _hyphenate(name) {\n  return (name.charAt(0).toLowerCase() + name.slice(1)).replace(capitalMatcher, addHyphenAndLower);\n}\n\nfunction _isAllWhitespace(node) {\n  return !(node.auInterpolationTarget || /[^\\t\\n\\r ]/.test(node.textContent));\n}\n\nlet ViewEngineHooksResource = class ViewEngineHooksResource {\n  constructor() {}\n\n  initialize(container, target) {\n    this.instance = container.get(target);\n  }\n\n  register(registry, name) {\n    registry.registerViewEngineHooks(this.instance);\n  }\n\n  load(container, target) {}\n\n  static convention(name) {\n    if (name.endsWith('ViewEngineHooks')) {\n      return new ViewEngineHooksResource();\n    }\n  }\n};\n\nfunction viewEngineHooks(target) {\n  let deco = function (t) {\n    aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, new ViewEngineHooksResource(), t);\n  };\n\n  return target ? deco(target) : deco;\n}\n\nlet ElementEvents = (_temp = _class = class ElementEvents {\n\n  constructor(element) {\n    this.element = element;\n    this.subscriptions = {};\n  }\n\n  _enqueueHandler(handler) {\n    this.subscriptions[handler.eventName] = this.subscriptions[handler.eventName] || [];\n    this.subscriptions[handler.eventName].push(handler);\n  }\n\n  _dequeueHandler(handler) {\n    let index;\n    let subscriptions = this.subscriptions[handler.eventName];\n    if (subscriptions) {\n      index = subscriptions.indexOf(handler);\n      if (index > -1) {\n        subscriptions.splice(index, 1);\n      }\n    }\n    return handler;\n  }\n\n  publish(eventName, detail = {}, bubbles = true, cancelable = true) {\n    let event = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createCustomEvent(eventName, { cancelable, bubbles, detail });\n    this.element.dispatchEvent(event);\n  }\n\n  subscribe(eventName, handler, captureOrOptions) {\n    if (typeof handler === 'function') {\n      if (captureOrOptions === undefined) {\n        captureOrOptions = ElementEvents.defaultListenerOptions;\n      }\n      const eventHandler = new EventHandlerImpl(this, eventName, handler, captureOrOptions, false);\n      return eventHandler;\n    }\n\n    return undefined;\n  }\n\n  subscribeOnce(eventName, handler, captureOrOptions) {\n    if (typeof handler === 'function') {\n      if (captureOrOptions === undefined) {\n        captureOrOptions = ElementEvents.defaultListenerOptions;\n      }\n      const eventHandler = new EventHandlerImpl(this, eventName, handler, captureOrOptions, true);\n      return eventHandler;\n    }\n\n    return undefined;\n  }\n\n  dispose(eventName) {\n    if (eventName && typeof eventName === 'string') {\n      let subscriptions = this.subscriptions[eventName];\n      if (subscriptions) {\n        while (subscriptions.length) {\n          let subscription = subscriptions.pop();\n          if (subscription) {\n            subscription.dispose();\n          }\n        }\n      }\n    } else {\n      this.disposeAll();\n    }\n  }\n\n  disposeAll() {\n    for (let key in this.subscriptions) {\n      this.dispose(key);\n    }\n  }\n}, _class.defaultListenerOptions = true, _temp);\n\nlet EventHandlerImpl = class EventHandlerImpl {\n  constructor(owner, eventName, handler, captureOrOptions, once) {\n    this.owner = owner;\n    this.eventName = eventName;\n    this.handler = handler;\n\n    this.capture = typeof captureOrOptions === 'boolean' ? captureOrOptions : captureOrOptions.capture;\n    this.bubbles = !this.capture;\n    this.captureOrOptions = captureOrOptions;\n    this.once = once;\n    owner.element.addEventListener(eventName, this, captureOrOptions);\n    owner._enqueueHandler(this);\n  }\n\n  handleEvent(e) {\n    const fn = this.handler;\n    fn(e);\n    if (this.once) {\n      this.dispose();\n    }\n  }\n\n  dispose() {\n    this.owner.element.removeEventListener(this.eventName, this, this.captureOrOptions);\n    this.owner._dequeueHandler(this);\n    this.owner = this.handler = null;\n  }\n};\n\nlet ResourceLoadContext = class ResourceLoadContext {\n  constructor() {\n    this.dependencies = {};\n  }\n\n  addDependency(url) {\n    this.dependencies[url] = true;\n  }\n\n  hasDependency(url) {\n    return url in this.dependencies;\n  }\n};\n\nlet ViewCompileInstruction = class ViewCompileInstruction {\n  constructor(targetShadowDOM = false, compileSurrogate = false) {\n    this.targetShadowDOM = targetShadowDOM;\n    this.compileSurrogate = compileSurrogate;\n    this.associatedModuleId = null;\n  }\n};\n\nViewCompileInstruction.normal = new ViewCompileInstruction();\n\nlet BehaviorInstruction = class BehaviorInstruction {\n  static enhance() {\n    let instruction = new BehaviorInstruction();\n    instruction.enhance = true;\n    return instruction;\n  }\n\n  static unitTest(type, attributes) {\n    let instruction = new BehaviorInstruction();\n    instruction.type = type;\n    instruction.attributes = attributes || {};\n    return instruction;\n  }\n\n  static element(node, type) {\n    let instruction = new BehaviorInstruction();\n    instruction.type = type;\n    instruction.attributes = {};\n    instruction.anchorIsContainer = !(node.hasAttribute('containerless') || type.containerless);\n    instruction.initiatedByBehavior = true;\n    return instruction;\n  }\n\n  static attribute(attrName, type) {\n    let instruction = new BehaviorInstruction();\n    instruction.attrName = attrName;\n    instruction.type = type || null;\n    instruction.attributes = {};\n    return instruction;\n  }\n\n  static dynamic(host, viewModel, viewFactory) {\n    let instruction = new BehaviorInstruction();\n    instruction.host = host;\n    instruction.viewModel = viewModel;\n    instruction.viewFactory = viewFactory;\n    instruction.inheritBindingContext = true;\n    return instruction;\n  }\n};\n\nconst biProto = BehaviorInstruction.prototype;\nbiProto.initiatedByBehavior = false;\nbiProto.enhance = false;\nbiProto.partReplacements = null;\nbiProto.viewFactory = null;\nbiProto.originalAttrName = null;\nbiProto.skipContentProcessing = false;\nbiProto.contentFactory = null;\nbiProto.viewModel = null;\nbiProto.anchorIsContainer = false;\nbiProto.host = null;\nbiProto.attributes = null;\nbiProto.type = null;\nbiProto.attrName = null;\nbiProto.inheritBindingContext = false;\n\nBehaviorInstruction.normal = new BehaviorInstruction();\n\nlet TargetInstruction = (_temp2 = _class2 = class TargetInstruction {\n  static shadowSlot(parentInjectorId) {\n    let instruction = new TargetInstruction();\n    instruction.parentInjectorId = parentInjectorId;\n    instruction.shadowSlot = true;\n    return instruction;\n  }\n\n  static contentExpression(expression) {\n    let instruction = new TargetInstruction();\n    instruction.contentExpression = expression;\n    return instruction;\n  }\n\n  static letElement(expressions) {\n    let instruction = new TargetInstruction();\n    instruction.expressions = expressions;\n    instruction.letElement = true;\n    return instruction;\n  }\n\n  static lifting(parentInjectorId, liftingInstruction) {\n    let instruction = new TargetInstruction();\n    instruction.parentInjectorId = parentInjectorId;\n    instruction.expressions = TargetInstruction.noExpressions;\n    instruction.behaviorInstructions = [liftingInstruction];\n    instruction.viewFactory = liftingInstruction.viewFactory;\n    instruction.providers = [liftingInstruction.type.target];\n    instruction.lifting = true;\n    return instruction;\n  }\n\n  static normal(injectorId, parentInjectorId, providers, behaviorInstructions, expressions, elementInstruction) {\n    let instruction = new TargetInstruction();\n    instruction.injectorId = injectorId;\n    instruction.parentInjectorId = parentInjectorId;\n    instruction.providers = providers;\n    instruction.behaviorInstructions = behaviorInstructions;\n    instruction.expressions = expressions;\n    instruction.anchorIsContainer = elementInstruction ? elementInstruction.anchorIsContainer : true;\n    instruction.elementInstruction = elementInstruction;\n    return instruction;\n  }\n\n  static surrogate(providers, behaviorInstructions, expressions, values) {\n    let instruction = new TargetInstruction();\n    instruction.expressions = expressions;\n    instruction.behaviorInstructions = behaviorInstructions;\n    instruction.providers = providers;\n    instruction.values = values;\n    return instruction;\n  }\n}, _class2.noExpressions = Object.freeze([]), _temp2);\n\nconst tiProto = TargetInstruction.prototype;\n\ntiProto.injectorId = null;\ntiProto.parentInjectorId = null;\n\ntiProto.shadowSlot = false;\ntiProto.slotName = null;\ntiProto.slotFallbackFactory = null;\n\ntiProto.contentExpression = null;\ntiProto.letElement = false;\n\ntiProto.expressions = null;\ntiProto.expressions = null;\ntiProto.providers = null;\n\ntiProto.viewFactory = null;\n\ntiProto.anchorIsContainer = false;\ntiProto.elementInstruction = null;\ntiProto.lifting = false;\n\ntiProto.values = null;\n\nconst viewStrategy = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"protocol\"].create('aurelia:view-strategy', {\n  validate(target) {\n    if (!(typeof target.loadViewFactory === 'function')) {\n      return 'View strategies must implement: loadViewFactory(viewEngine: ViewEngine, compileInstruction: ViewCompileInstruction, loadContext?: ResourceLoadContext): Promise<ViewFactory>';\n    }\n\n    return true;\n  },\n  compose(target) {\n    if (!(typeof target.makeRelativeTo === 'function')) {\n      target.makeRelativeTo = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"PLATFORM\"].noop;\n    }\n  }\n});\n\nlet RelativeViewStrategy = (_dec = viewStrategy(), _dec(_class3 = class RelativeViewStrategy {\n  constructor(path) {\n    this.path = path;\n    this.absolutePath = null;\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    if (this.absolutePath === null && this.moduleId) {\n      this.absolutePath = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_4__[\"relativeToFile\"])(this.path, this.moduleId);\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(this.absolutePath || this.path, compileInstruction, loadContext, target);\n  }\n\n  makeRelativeTo(file) {\n    if (this.absolutePath === null) {\n      this.absolutePath = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_4__[\"relativeToFile\"])(this.path, file);\n    }\n  }\n}) || _class3);\n\nlet ConventionalViewStrategy = (_dec2 = viewStrategy(), _dec2(_class4 = class ConventionalViewStrategy {\n  constructor(viewLocator, origin) {\n    this.moduleId = origin.moduleId;\n    this.viewUrl = viewLocator.convertOriginToViewUrl(origin);\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(this.viewUrl, compileInstruction, loadContext, target);\n  }\n}) || _class4);\n\nlet NoViewStrategy = (_dec3 = viewStrategy(), _dec3(_class5 = class NoViewStrategy {\n  constructor(dependencies, dependencyBaseUrl) {\n    this.dependencies = dependencies || null;\n    this.dependencyBaseUrl = dependencyBaseUrl || '';\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    let entry = this.entry;\n    let dependencies = this.dependencies;\n\n    if (entry && entry.factoryIsReady) {\n      return Promise.resolve(null);\n    }\n\n    this.entry = entry = new aurelia_loader__WEBPACK_IMPORTED_MODULE_3__[\"TemplateRegistryEntry\"](this.moduleId || this.dependencyBaseUrl);\n\n    entry.dependencies = [];\n    entry.templateIsLoaded = true;\n\n    if (dependencies !== null) {\n      for (let i = 0, ii = dependencies.length; i < ii; ++i) {\n        let current = dependencies[i];\n\n        if (typeof current === 'string' || typeof current === 'function') {\n          entry.addDependency(current);\n        } else {\n          entry.addDependency(current.from, current.as);\n        }\n      }\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n\n    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext, target);\n  }\n}) || _class5);\n\nlet TemplateRegistryViewStrategy = (_dec4 = viewStrategy(), _dec4(_class6 = class TemplateRegistryViewStrategy {\n  constructor(moduleId, entry) {\n    this.moduleId = moduleId;\n    this.entry = entry;\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    let entry = this.entry;\n\n    if (entry.factoryIsReady) {\n      return Promise.resolve(entry.factory);\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext, target);\n  }\n}) || _class6);\n\nlet InlineViewStrategy = (_dec5 = viewStrategy(), _dec5(_class7 = class InlineViewStrategy {\n  constructor(markup, dependencies, dependencyBaseUrl) {\n    this.markup = markup;\n    this.dependencies = dependencies || null;\n    this.dependencyBaseUrl = dependencyBaseUrl || '';\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    let entry = this.entry;\n    let dependencies = this.dependencies;\n\n    if (entry && entry.factoryIsReady) {\n      return Promise.resolve(entry.factory);\n    }\n\n    this.entry = entry = new aurelia_loader__WEBPACK_IMPORTED_MODULE_3__[\"TemplateRegistryEntry\"](this.moduleId || this.dependencyBaseUrl);\n    entry.template = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createTemplateFromMarkup(this.markup);\n\n    if (dependencies !== null) {\n      for (let i = 0, ii = dependencies.length; i < ii; ++i) {\n        let current = dependencies[i];\n\n        if (typeof current === 'string' || typeof current === 'function') {\n          entry.addDependency(current);\n        } else {\n          entry.addDependency(current.from, current.as);\n        }\n      }\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext, target);\n  }\n}) || _class7);\n\nlet StaticViewStrategy = (_dec6 = viewStrategy(), _dec6(_class8 = class StaticViewStrategy {\n\n  constructor(config) {\n    if (typeof config === 'string' || config instanceof aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].Element && config.tagName === 'TEMPLATE') {\n      config = {\n        template: config\n      };\n    }\n    this.template = config.template;\n    this.dependencies = config.dependencies || [];\n    this.factoryIsReady = false;\n    this.onReady = null;\n    this.moduleId = 'undefined';\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    if (this.factoryIsReady) {\n      return Promise.resolve(this.factory);\n    }\n    let deps = this.dependencies;\n    deps = typeof deps === 'function' ? deps() : deps;\n    deps = deps ? deps : [];\n    deps = Array.isArray(deps) ? deps : [deps];\n\n    return Promise.all(deps).then(dependencies => {\n      const container = viewEngine.container;\n      const appResources = viewEngine.appResources;\n      const viewCompiler = viewEngine.viewCompiler;\n      const viewResources = new ViewResources(appResources);\n\n      let resource;\n      let elDeps = [];\n\n      if (target) {\n        viewResources.autoRegister(container, target);\n      }\n\n      for (let dep of dependencies) {\n        if (typeof dep === 'function') {\n          resource = viewResources.autoRegister(container, dep);\n          if (resource.elementName !== null) {\n            elDeps.push(resource);\n          }\n        } else if (dep && typeof dep === 'object') {\n          for (let key in dep) {\n            let exported = dep[key];\n            if (typeof exported === 'function') {\n              resource = viewResources.autoRegister(container, exported);\n              if (resource.elementName !== null) {\n                elDeps.push(resource);\n              }\n            }\n          }\n        } else {\n          throw new Error(`dependency neither function nor object. Received: \"${typeof dep}\"`);\n        }\n      }\n\n      return Promise.all(elDeps.map(el => el.load(container, el.target))).then(() => {\n        const factory = this.template !== null ? viewCompiler.compile(this.template, viewResources, compileInstruction) : null;\n        this.factoryIsReady = true;\n        this.factory = factory;\n        return factory;\n      });\n    });\n  }\n}) || _class8);\n\nlet ViewLocator = (_temp3 = _class9 = class ViewLocator {\n  getViewStrategy(value) {\n    if (!value) {\n      return null;\n    }\n\n    if (typeof value === 'object' && 'getViewStrategy' in value) {\n      let origin = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(value.constructor);\n\n      value = value.getViewStrategy();\n\n      if (typeof value === 'string') {\n        value = new RelativeViewStrategy(value);\n      }\n\n      viewStrategy.assert(value);\n\n      if (origin.moduleId) {\n        value.makeRelativeTo(origin.moduleId);\n      }\n\n      return value;\n    }\n\n    if (typeof value === 'string') {\n      value = new RelativeViewStrategy(value);\n    }\n\n    if (viewStrategy.validate(value)) {\n      return value;\n    }\n\n    if (typeof value !== 'function') {\n      value = value.constructor;\n    }\n\n    if ('$view' in value) {\n      let c = value.$view;\n      let view;\n      c = typeof c === 'function' ? c.call(value) : c;\n      if (c === null) {\n        view = new NoViewStrategy();\n      } else {\n        view = c instanceof StaticViewStrategy ? c : new StaticViewStrategy(c);\n      }\n      aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(ViewLocator.viewStrategyMetadataKey, view, value);\n      return view;\n    }\n\n    let origin = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(value);\n    let strategy = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].get(ViewLocator.viewStrategyMetadataKey, value);\n\n    if (!strategy) {\n      if (!origin.moduleId) {\n        throw new Error('Cannot determine default view strategy for object.', value);\n      }\n\n      strategy = this.createFallbackViewStrategy(origin);\n    } else if (origin.moduleId) {\n      strategy.moduleId = origin.moduleId;\n    }\n\n    return strategy;\n  }\n\n  createFallbackViewStrategy(origin) {\n    return new ConventionalViewStrategy(this, origin);\n  }\n\n  convertOriginToViewUrl(origin) {\n    let moduleId = origin.moduleId;\n    let id = moduleId.endsWith('.js') || moduleId.endsWith('.ts') ? moduleId.substring(0, moduleId.length - 3) : moduleId;\n    return id + '.html';\n  }\n}, _class9.viewStrategyMetadataKey = 'aurelia:view-strategy', _temp3);\n\nfunction mi(name) {\n  throw new Error(`BindingLanguage must implement ${name}().`);\n}\n\nlet BindingLanguage = class BindingLanguage {\n  inspectAttribute(resources, elementName, attrName, attrValue) {\n    mi('inspectAttribute');\n  }\n\n  createAttributeInstruction(resources, element, info, existingInstruction) {\n    mi('createAttributeInstruction');\n  }\n\n  createLetExpressions(resources, element) {\n    mi('createLetExpressions');\n  }\n\n  inspectTextContent(resources, value) {\n    mi('inspectTextContent');\n  }\n};\n\nlet noNodes = Object.freeze([]);\n\nlet SlotCustomAttribute = class SlotCustomAttribute {\n  static inject() {\n    return [aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].Element];\n  }\n\n  constructor(element) {\n    this.element = element;\n    this.element.auSlotAttribute = this;\n  }\n\n  valueChanged(newValue, oldValue) {}\n};\n\nlet PassThroughSlot = class PassThroughSlot {\n  constructor(anchor, name, destinationName, fallbackFactory) {\n    this.anchor = anchor;\n    this.anchor.viewSlot = this;\n    this.name = name;\n    this.destinationName = destinationName;\n    this.fallbackFactory = fallbackFactory;\n    this.destinationSlot = null;\n    this.projections = 0;\n    this.contentView = null;\n\n    let attr = new SlotCustomAttribute(this.anchor);\n    attr.value = this.destinationName;\n  }\n\n  get needsFallbackRendering() {\n    return this.fallbackFactory && this.projections === 0;\n  }\n\n  renderFallbackContent(view, nodes, projectionSource, index) {\n    if (this.contentView === null) {\n      this.contentView = this.fallbackFactory.create(this.ownerView.container);\n      this.contentView.bind(this.ownerView.bindingContext, this.ownerView.overrideContext);\n\n      let slots = Object.create(null);\n      slots[this.destinationSlot.name] = this.destinationSlot;\n\n      ShadowDOM.distributeView(this.contentView, slots, projectionSource, index, this.destinationSlot.name);\n    }\n  }\n\n  passThroughTo(destinationSlot) {\n    this.destinationSlot = destinationSlot;\n  }\n\n  addNode(view, node, projectionSource, index) {\n    if (this.contentView !== null) {\n      this.contentView.removeNodes();\n      this.contentView.detached();\n      this.contentView.unbind();\n      this.contentView = null;\n    }\n\n    if (node.viewSlot instanceof PassThroughSlot) {\n      node.viewSlot.passThroughTo(this);\n      return;\n    }\n\n    this.projections++;\n    this.destinationSlot.addNode(view, node, projectionSource, index);\n  }\n\n  removeView(view, projectionSource) {\n    this.projections--;\n    this.destinationSlot.removeView(view, projectionSource);\n\n    if (this.needsFallbackRendering) {\n      this.renderFallbackContent(null, noNodes, projectionSource);\n    }\n  }\n\n  removeAll(projectionSource) {\n    this.projections = 0;\n    this.destinationSlot.removeAll(projectionSource);\n\n    if (this.needsFallbackRendering) {\n      this.renderFallbackContent(null, noNodes, projectionSource);\n    }\n  }\n\n  projectFrom(view, projectionSource) {\n    this.destinationSlot.projectFrom(view, projectionSource);\n  }\n\n  created(ownerView) {\n    this.ownerView = ownerView;\n  }\n\n  bind(view) {\n    if (this.contentView) {\n      this.contentView.bind(view.bindingContext, view.overrideContext);\n    }\n  }\n\n  attached() {\n    if (this.contentView) {\n      this.contentView.attached();\n    }\n  }\n\n  detached() {\n    if (this.contentView) {\n      this.contentView.detached();\n    }\n  }\n\n  unbind() {\n    if (this.contentView) {\n      this.contentView.unbind();\n    }\n  }\n};\n\nlet ShadowSlot = class ShadowSlot {\n  constructor(anchor, name, fallbackFactory) {\n    this.anchor = anchor;\n    this.anchor.isContentProjectionSource = true;\n    this.anchor.viewSlot = this;\n    this.name = name;\n    this.fallbackFactory = fallbackFactory;\n    this.contentView = null;\n    this.projections = 0;\n    this.children = [];\n    this.projectFromAnchors = null;\n    this.destinationSlots = null;\n  }\n\n  get needsFallbackRendering() {\n    return this.fallbackFactory && this.projections === 0;\n  }\n\n  addNode(view, node, projectionSource, index, destination) {\n    if (this.contentView !== null) {\n      this.contentView.removeNodes();\n      this.contentView.detached();\n      this.contentView.unbind();\n      this.contentView = null;\n    }\n\n    if (node.viewSlot instanceof PassThroughSlot) {\n      node.viewSlot.passThroughTo(this);\n      return;\n    }\n\n    if (this.destinationSlots !== null) {\n      ShadowDOM.distributeNodes(view, [node], this.destinationSlots, this, index);\n    } else {\n      node.auOwnerView = view;\n      node.auProjectionSource = projectionSource;\n      node.auAssignedSlot = this;\n\n      let anchor = this._findAnchor(view, node, projectionSource, index);\n      let parent = anchor.parentNode;\n\n      parent.insertBefore(node, anchor);\n      this.children.push(node);\n      this.projections++;\n    }\n  }\n\n  removeView(view, projectionSource) {\n    if (this.destinationSlots !== null) {\n      ShadowDOM.undistributeView(view, this.destinationSlots, this);\n    } else if (this.contentView && this.contentView.hasSlots) {\n      ShadowDOM.undistributeView(view, this.contentView.slots, projectionSource);\n    } else {\n      let found = this.children.find(x => x.auSlotProjectFrom === projectionSource);\n      if (found) {\n        let children = found.auProjectionChildren;\n\n        for (let i = 0, ii = children.length; i < ii; ++i) {\n          let child = children[i];\n\n          if (child.auOwnerView === view) {\n            children.splice(i, 1);\n            view.fragment.appendChild(child);\n            i--;ii--;\n            this.projections--;\n          }\n        }\n\n        if (this.needsFallbackRendering) {\n          this.renderFallbackContent(view, noNodes, projectionSource);\n        }\n      }\n    }\n  }\n\n  removeAll(projectionSource) {\n    if (this.destinationSlots !== null) {\n      ShadowDOM.undistributeAll(this.destinationSlots, this);\n    } else if (this.contentView && this.contentView.hasSlots) {\n      ShadowDOM.undistributeAll(this.contentView.slots, projectionSource);\n    } else {\n      let found = this.children.find(x => x.auSlotProjectFrom === projectionSource);\n\n      if (found) {\n        let children = found.auProjectionChildren;\n        for (let i = 0, ii = children.length; i < ii; ++i) {\n          let child = children[i];\n          child.auOwnerView.fragment.appendChild(child);\n          this.projections--;\n        }\n\n        found.auProjectionChildren = [];\n\n        if (this.needsFallbackRendering) {\n          this.renderFallbackContent(null, noNodes, projectionSource);\n        }\n      }\n    }\n  }\n\n  _findAnchor(view, node, projectionSource, index) {\n    if (projectionSource) {\n      let found = this.children.find(x => x.auSlotProjectFrom === projectionSource);\n      if (found) {\n        if (index !== undefined) {\n          let children = found.auProjectionChildren;\n          let viewIndex = -1;\n          let lastView;\n\n          for (let i = 0, ii = children.length; i < ii; ++i) {\n            let current = children[i];\n\n            if (current.auOwnerView !== lastView) {\n              viewIndex++;\n              lastView = current.auOwnerView;\n\n              if (viewIndex >= index && lastView !== view) {\n                children.splice(i, 0, node);\n                return current;\n              }\n            }\n          }\n        }\n\n        found.auProjectionChildren.push(node);\n        return found;\n      }\n    }\n\n    return this.anchor;\n  }\n\n  projectTo(slots) {\n    this.destinationSlots = slots;\n  }\n\n  projectFrom(view, projectionSource) {\n    let anchor = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createComment('anchor');\n    let parent = this.anchor.parentNode;\n    anchor.auSlotProjectFrom = projectionSource;\n    anchor.auOwnerView = view;\n    anchor.auProjectionChildren = [];\n    parent.insertBefore(anchor, this.anchor);\n    this.children.push(anchor);\n\n    if (this.projectFromAnchors === null) {\n      this.projectFromAnchors = [];\n    }\n\n    this.projectFromAnchors.push(anchor);\n  }\n\n  renderFallbackContent(view, nodes, projectionSource, index) {\n    if (this.contentView === null) {\n      this.contentView = this.fallbackFactory.create(this.ownerView.container);\n      this.contentView.bind(this.ownerView.bindingContext, this.ownerView.overrideContext);\n      this.contentView.insertNodesBefore(this.anchor);\n    }\n\n    if (this.contentView.hasSlots) {\n      let slots = this.contentView.slots;\n      let projectFromAnchors = this.projectFromAnchors;\n\n      if (projectFromAnchors !== null) {\n        for (let slotName in slots) {\n          let slot = slots[slotName];\n\n          for (let i = 0, ii = projectFromAnchors.length; i < ii; ++i) {\n            let anchor = projectFromAnchors[i];\n            slot.projectFrom(anchor.auOwnerView, anchor.auSlotProjectFrom);\n          }\n        }\n      }\n\n      this.fallbackSlots = slots;\n      ShadowDOM.distributeNodes(view, nodes, slots, projectionSource, index);\n    }\n  }\n\n  created(ownerView) {\n    this.ownerView = ownerView;\n  }\n\n  bind(view) {\n    if (this.contentView) {\n      this.contentView.bind(view.bindingContext, view.overrideContext);\n    }\n  }\n\n  attached() {\n    if (this.contentView) {\n      this.contentView.attached();\n    }\n  }\n\n  detached() {\n    if (this.contentView) {\n      this.contentView.detached();\n    }\n  }\n\n  unbind() {\n    if (this.contentView) {\n      this.contentView.unbind();\n    }\n  }\n};\n\nlet ShadowDOM = (_temp4 = _class10 = class ShadowDOM {\n\n  static getSlotName(node) {\n    if (node.auSlotAttribute === undefined) {\n      return ShadowDOM.defaultSlotKey;\n    }\n\n    return node.auSlotAttribute.value;\n  }\n\n  static distributeView(view, slots, projectionSource, index, destinationOverride) {\n    let nodes;\n\n    if (view === null) {\n      nodes = noNodes;\n    } else {\n      let childNodes = view.fragment.childNodes;\n      let ii = childNodes.length;\n      nodes = new Array(ii);\n\n      for (let i = 0; i < ii; ++i) {\n        nodes[i] = childNodes[i];\n      }\n    }\n\n    ShadowDOM.distributeNodes(view, nodes, slots, projectionSource, index, destinationOverride);\n  }\n\n  static undistributeView(view, slots, projectionSource) {\n    for (let slotName in slots) {\n      slots[slotName].removeView(view, projectionSource);\n    }\n  }\n\n  static undistributeAll(slots, projectionSource) {\n    for (let slotName in slots) {\n      slots[slotName].removeAll(projectionSource);\n    }\n  }\n\n  static distributeNodes(view, nodes, slots, projectionSource, index, destinationOverride) {\n    for (let i = 0, ii = nodes.length; i < ii; ++i) {\n      let currentNode = nodes[i];\n      let nodeType = currentNode.nodeType;\n\n      if (currentNode.isContentProjectionSource) {\n        currentNode.viewSlot.projectTo(slots);\n\n        for (let slotName in slots) {\n          slots[slotName].projectFrom(view, currentNode.viewSlot);\n        }\n\n        nodes.splice(i, 1);\n        ii--;i--;\n      } else if (nodeType === 1 || nodeType === 3 || currentNode.viewSlot instanceof PassThroughSlot) {\n        if (nodeType === 3 && _isAllWhitespace(currentNode)) {\n          nodes.splice(i, 1);\n          ii--;i--;\n        } else {\n          let found = slots[destinationOverride || ShadowDOM.getSlotName(currentNode)];\n\n          if (found) {\n            found.addNode(view, currentNode, projectionSource, index);\n            nodes.splice(i, 1);\n            ii--;i--;\n          }\n        }\n      } else {\n        nodes.splice(i, 1);\n        ii--;i--;\n      }\n    }\n\n    for (let slotName in slots) {\n      let slot = slots[slotName];\n\n      if (slot.needsFallbackRendering) {\n        slot.renderFallbackContent(view, nodes, projectionSource, index);\n      }\n    }\n  }\n}, _class10.defaultSlotKey = '__au-default-slot-key__', _temp4);\n\nfunction register(lookup, name, resource, type) {\n  if (!name) {\n    return;\n  }\n\n  let existing = lookup[name];\n  if (existing) {\n    if (existing !== resource) {\n      throw new Error(`Attempted to register ${type} when one with the same name already exists. Name: ${name}.`);\n    }\n\n    return;\n  }\n\n  lookup[name] = resource;\n}\n\nfunction validateBehaviorName(name, type) {\n  if (/[A-Z]/.test(name)) {\n    let newName = _hyphenate(name);\n    aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating').warn(`'${name}' is not a valid ${type} name and has been converted to '${newName}'. Upper-case letters are not allowed because the DOM is not case-sensitive.`);\n    return newName;\n  }\n  return name;\n}\n\nconst conventionMark = '__au_resource__';\n\nlet ViewResources = class ViewResources {\n  static convention(target, existing) {\n    let resource;\n\n    if (existing && conventionMark in existing) {\n      return existing;\n    }\n    if ('$resource' in target) {\n      let config = target.$resource;\n\n      if (typeof config === 'string') {\n        resource = existing || new HtmlBehaviorResource();\n        resource[conventionMark] = true;\n        if (!resource.elementName) {\n          resource.elementName = validateBehaviorName(config, 'custom element');\n        }\n      } else {\n        if (typeof config === 'function') {\n          config = config.call(target);\n        }\n        if (typeof config === 'string') {\n          config = { name: config };\n        }\n\n        config = Object.assign({}, config);\n\n        let resourceType = config.type || 'element';\n\n        let name = config.name;\n        switch (resourceType) {\n          case 'element':case 'attribute':\n            resource = existing || new HtmlBehaviorResource();\n            resource[conventionMark] = true;\n            if (resourceType === 'element') {\n              if (!resource.elementName) {\n                resource.elementName = name ? validateBehaviorName(name, 'custom element') : _hyphenate(target.name);\n              }\n            } else {\n              if (!resource.attributeName) {\n                resource.attributeName = name ? validateBehaviorName(name, 'custom attribute') : _hyphenate(target.name);\n              }\n            }\n            if ('templateController' in config) {\n              config.liftsContent = config.templateController;\n              delete config.templateController;\n            }\n            if ('defaultBindingMode' in config && resource.attributeDefaultBindingMode !== undefined) {\n              config.attributeDefaultBindingMode = config.defaultBindingMode;\n              delete config.defaultBindingMode;\n            }\n\n            delete config.name;\n\n            Object.assign(resource, config);\n            break;\n          case 'valueConverter':\n            resource = new aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"ValueConverterResource\"](Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"camelCase\"])(name || target.name));\n            break;\n          case 'bindingBehavior':\n            resource = new aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"BindingBehaviorResource\"](Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"camelCase\"])(name || target.name));\n            break;\n          case 'viewEngineHooks':\n            resource = new ViewEngineHooksResource();\n            break;\n        }\n      }\n\n      if (resource instanceof HtmlBehaviorResource) {\n        let bindables = typeof config === 'string' ? undefined : config.bindables;\n        let currentProps = resource.properties;\n        if (Array.isArray(bindables)) {\n          for (let i = 0, ii = bindables.length; ii > i; ++i) {\n            let prop = bindables[i];\n            if (!prop || typeof prop !== 'string' && !prop.name) {\n              throw new Error(`Invalid bindable property at \"${i}\" for class \"${target.name}\". Expected either a string or an object with \"name\" property.`);\n            }\n            let newProp = new BindableProperty(prop);\n\n            let existed = false;\n            for (let j = 0, jj = currentProps.length; jj > j; ++j) {\n              if (currentProps[j].name === newProp.name) {\n                existed = true;\n                break;\n              }\n            }\n            if (existed) {\n              continue;\n            }\n            newProp.registerWith(target, resource);\n          }\n        }\n      }\n    }\n    return resource;\n  }\n\n  constructor(parent, viewUrl) {\n    this.bindingLanguage = null;\n\n    this.parent = parent || null;\n    this.hasParent = this.parent !== null;\n    this.viewUrl = viewUrl || '';\n    this.lookupFunctions = {\n      valueConverters: this.getValueConverter.bind(this),\n      bindingBehaviors: this.getBindingBehavior.bind(this)\n    };\n    this.attributes = Object.create(null);\n    this.elements = Object.create(null);\n    this.valueConverters = Object.create(null);\n    this.bindingBehaviors = Object.create(null);\n    this.attributeMap = Object.create(null);\n    this.values = Object.create(null);\n    this.beforeCompile = this.afterCompile = this.beforeCreate = this.afterCreate = this.beforeBind = this.beforeUnbind = false;\n  }\n\n  _tryAddHook(obj, name) {\n    if (typeof obj[name] === 'function') {\n      let func = obj[name].bind(obj);\n      let counter = 1;\n      let callbackName;\n\n      while (this[callbackName = name + counter.toString()] !== undefined) {\n        counter++;\n      }\n\n      this[name] = true;\n      this[callbackName] = func;\n    }\n  }\n\n  _invokeHook(name, one, two, three, four) {\n    if (this.hasParent) {\n      this.parent._invokeHook(name, one, two, three, four);\n    }\n\n    if (this[name]) {\n      this[name + '1'](one, two, three, four);\n\n      let callbackName = name + '2';\n      if (this[callbackName]) {\n        this[callbackName](one, two, three, four);\n\n        callbackName = name + '3';\n        if (this[callbackName]) {\n          this[callbackName](one, two, three, four);\n\n          let counter = 4;\n\n          while (this[callbackName = name + counter.toString()] !== undefined) {\n            this[callbackName](one, two, three, four);\n            counter++;\n          }\n        }\n      }\n    }\n  }\n\n  registerViewEngineHooks(hooks) {\n    this._tryAddHook(hooks, 'beforeCompile');\n    this._tryAddHook(hooks, 'afterCompile');\n    this._tryAddHook(hooks, 'beforeCreate');\n    this._tryAddHook(hooks, 'afterCreate');\n    this._tryAddHook(hooks, 'beforeBind');\n    this._tryAddHook(hooks, 'beforeUnbind');\n  }\n\n  getBindingLanguage(bindingLanguageFallback) {\n    return this.bindingLanguage || (this.bindingLanguage = bindingLanguageFallback);\n  }\n\n  patchInParent(newParent) {\n    let originalParent = this.parent;\n\n    this.parent = newParent || null;\n    this.hasParent = this.parent !== null;\n\n    if (newParent.parent === null) {\n      newParent.parent = originalParent;\n      newParent.hasParent = originalParent !== null;\n    }\n  }\n\n  relativeToView(path) {\n    return Object(aurelia_path__WEBPACK_IMPORTED_MODULE_4__[\"relativeToFile\"])(path, this.viewUrl);\n  }\n\n  registerElement(tagName, behavior) {\n    register(this.elements, tagName, behavior, 'an Element');\n  }\n\n  getElement(tagName) {\n    return this.elements[tagName] || (this.hasParent ? this.parent.getElement(tagName) : null);\n  }\n\n  mapAttribute(attribute) {\n    return this.attributeMap[attribute] || (this.hasParent ? this.parent.mapAttribute(attribute) : null);\n  }\n\n  registerAttribute(attribute, behavior, knownAttribute) {\n    this.attributeMap[attribute] = knownAttribute;\n    register(this.attributes, attribute, behavior, 'an Attribute');\n  }\n\n  getAttribute(attribute) {\n    return this.attributes[attribute] || (this.hasParent ? this.parent.getAttribute(attribute) : null);\n  }\n\n  registerValueConverter(name, valueConverter) {\n    register(this.valueConverters, name, valueConverter, 'a ValueConverter');\n  }\n\n  getValueConverter(name) {\n    return this.valueConverters[name] || (this.hasParent ? this.parent.getValueConverter(name) : null);\n  }\n\n  registerBindingBehavior(name, bindingBehavior) {\n    register(this.bindingBehaviors, name, bindingBehavior, 'a BindingBehavior');\n  }\n\n  getBindingBehavior(name) {\n    return this.bindingBehaviors[name] || (this.hasParent ? this.parent.getBindingBehavior(name) : null);\n  }\n\n  registerValue(name, value) {\n    register(this.values, name, value, 'a value');\n  }\n\n  getValue(name) {\n    return this.values[name] || (this.hasParent ? this.parent.getValue(name) : null);\n  }\n\n  autoRegister(container, impl) {\n    let resourceTypeMeta = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, impl);\n    if (resourceTypeMeta) {\n      if (resourceTypeMeta instanceof HtmlBehaviorResource) {\n        ViewResources.convention(impl, resourceTypeMeta);\n\n        if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n          HtmlBehaviorResource.convention(impl.name, resourceTypeMeta);\n        }\n        if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n          resourceTypeMeta.elementName = _hyphenate(impl.name);\n        }\n      }\n    } else {\n      resourceTypeMeta = ViewResources.convention(impl) || HtmlBehaviorResource.convention(impl.name) || aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"ValueConverterResource\"].convention(impl.name) || aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"BindingBehaviorResource\"].convention(impl.name) || ViewEngineHooksResource.convention(impl.name);\n      if (!resourceTypeMeta) {\n        resourceTypeMeta = new HtmlBehaviorResource();\n        resourceTypeMeta.elementName = _hyphenate(impl.name);\n      }\n      aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, resourceTypeMeta, impl);\n    }\n    resourceTypeMeta.initialize(container, impl);\n    resourceTypeMeta.register(this);\n    return resourceTypeMeta;\n  }\n};\n\nlet View = class View {\n  constructor(container, viewFactory, fragment, controllers, bindings, children, slots) {\n    this.container = container;\n    this.viewFactory = viewFactory;\n    this.resources = viewFactory.resources;\n    this.fragment = fragment;\n    this.firstChild = fragment.firstChild;\n    this.lastChild = fragment.lastChild;\n    this.controllers = controllers;\n    this.bindings = bindings;\n    this.children = children;\n    this.slots = slots;\n    this.hasSlots = false;\n    this.fromCache = false;\n    this.isBound = false;\n    this.isAttached = false;\n    this.bindingContext = null;\n    this.overrideContext = null;\n    this.controller = null;\n    this.viewModelScope = null;\n    this.animatableElement = undefined;\n    this._isUserControlled = false;\n    this.contentView = null;\n\n    for (let key in slots) {\n      this.hasSlots = true;\n      break;\n    }\n  }\n\n  returnToCache() {\n    this.viewFactory.returnViewToCache(this);\n  }\n\n  created() {\n    let i;\n    let ii;\n    let controllers = this.controllers;\n\n    for (i = 0, ii = controllers.length; i < ii; ++i) {\n      controllers[i].created(this);\n    }\n  }\n\n  bind(bindingContext, overrideContext, _systemUpdate) {\n    let controllers;\n    let bindings;\n    let children;\n    let i;\n    let ii;\n\n    if (_systemUpdate && this._isUserControlled) {\n      return;\n    }\n\n    if (this.isBound) {\n      if (this.bindingContext === bindingContext) {\n        return;\n      }\n\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.bindingContext = bindingContext;\n    this.overrideContext = overrideContext || Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"createOverrideContext\"])(bindingContext);\n\n    this.resources._invokeHook('beforeBind', this);\n\n    bindings = this.bindings;\n    for (i = 0, ii = bindings.length; i < ii; ++i) {\n      bindings[i].bind(this);\n    }\n\n    if (this.viewModelScope !== null) {\n      bindingContext.bind(this.viewModelScope.bindingContext, this.viewModelScope.overrideContext);\n      this.viewModelScope = null;\n    }\n\n    controllers = this.controllers;\n    for (i = 0, ii = controllers.length; i < ii; ++i) {\n      controllers[i].bind(this);\n    }\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      children[i].bind(bindingContext, overrideContext, true);\n    }\n\n    if (this.hasSlots) {\n      ShadowDOM.distributeView(this.contentView, this.slots);\n    }\n  }\n\n  addBinding(binding) {\n    this.bindings.push(binding);\n\n    if (this.isBound) {\n      binding.bind(this);\n    }\n  }\n\n  unbind() {\n    let controllers;\n    let bindings;\n    let children;\n    let i;\n    let ii;\n\n    if (this.isBound) {\n      this.isBound = false;\n      this.resources._invokeHook('beforeUnbind', this);\n\n      if (this.controller !== null) {\n        this.controller.unbind();\n      }\n\n      bindings = this.bindings;\n      for (i = 0, ii = bindings.length; i < ii; ++i) {\n        bindings[i].unbind();\n      }\n\n      controllers = this.controllers;\n      for (i = 0, ii = controllers.length; i < ii; ++i) {\n        controllers[i].unbind();\n      }\n\n      children = this.children;\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].unbind();\n      }\n\n      this.bindingContext = null;\n      this.overrideContext = null;\n    }\n  }\n\n  insertNodesBefore(refNode) {\n    refNode.parentNode.insertBefore(this.fragment, refNode);\n  }\n\n  appendNodesTo(parent) {\n    parent.appendChild(this.fragment);\n  }\n\n  removeNodes() {\n    let fragment = this.fragment;\n    let current = this.firstChild;\n    let end = this.lastChild;\n    let next;\n\n    while (current) {\n      next = current.nextSibling;\n      fragment.appendChild(current);\n\n      if (current === end) {\n        break;\n      }\n\n      current = next;\n    }\n  }\n\n  attached() {\n    let controllers;\n    let children;\n    let i;\n    let ii;\n\n    if (this.isAttached) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    if (this.controller !== null) {\n      this.controller.attached();\n    }\n\n    controllers = this.controllers;\n    for (i = 0, ii = controllers.length; i < ii; ++i) {\n      controllers[i].attached();\n    }\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      children[i].attached();\n    }\n  }\n\n  detached() {\n    let controllers;\n    let children;\n    let i;\n    let ii;\n\n    if (this.isAttached) {\n      this.isAttached = false;\n\n      if (this.controller !== null) {\n        this.controller.detached();\n      }\n\n      controllers = this.controllers;\n      for (i = 0, ii = controllers.length; i < ii; ++i) {\n        controllers[i].detached();\n      }\n\n      children = this.children;\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].detached();\n      }\n    }\n  }\n};\n\nfunction getAnimatableElement(view) {\n  if (view.animatableElement !== undefined) {\n    return view.animatableElement;\n  }\n\n  let current = view.firstChild;\n\n  while (current && current.nodeType !== 1) {\n    current = current.nextSibling;\n  }\n\n  if (current && current.nodeType === 1) {\n    return view.animatableElement = current.classList.contains('au-animate') ? current : null;\n  }\n\n  return view.animatableElement = null;\n}\n\nlet ViewSlot = class ViewSlot {\n  constructor(anchor, anchorIsContainer, animator = Animator.instance) {\n    this.anchor = anchor;\n    this.anchorIsContainer = anchorIsContainer;\n    this.bindingContext = null;\n    this.overrideContext = null;\n    this.animator = animator;\n    this.children = [];\n    this.isBound = false;\n    this.isAttached = false;\n    this.contentSelectors = null;\n    anchor.viewSlot = this;\n    anchor.isContentProjectionSource = false;\n  }\n\n  animateView(view, direction = 'enter') {\n    let animatableElement = getAnimatableElement(view);\n\n    if (animatableElement !== null) {\n      switch (direction) {\n        case 'enter':\n          return this.animator.enter(animatableElement);\n        case 'leave':\n          return this.animator.leave(animatableElement);\n        default:\n          throw new Error('Invalid animation direction: ' + direction);\n      }\n    }\n  }\n\n  transformChildNodesIntoView() {\n    let parent = this.anchor;\n\n    this.children.push({\n      fragment: parent,\n      firstChild: parent.firstChild,\n      lastChild: parent.lastChild,\n      returnToCache() {},\n      removeNodes() {\n        let last;\n\n        while (last = parent.lastChild) {\n          parent.removeChild(last);\n        }\n      },\n      created() {},\n      bind() {},\n      unbind() {},\n      attached() {},\n      detached() {}\n    });\n  }\n\n  bind(bindingContext, overrideContext) {\n    let i;\n    let ii;\n    let children;\n\n    if (this.isBound) {\n      if (this.bindingContext === bindingContext) {\n        return;\n      }\n\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.bindingContext = bindingContext = bindingContext || this.bindingContext;\n    this.overrideContext = overrideContext = overrideContext || this.overrideContext;\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      children[i].bind(bindingContext, overrideContext, true);\n    }\n  }\n\n  unbind() {\n    if (this.isBound) {\n      let i;\n      let ii;\n      let children = this.children;\n\n      this.isBound = false;\n      this.bindingContext = null;\n      this.overrideContext = null;\n\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].unbind();\n      }\n    }\n  }\n\n  add(view) {\n    if (this.anchorIsContainer) {\n      view.appendNodesTo(this.anchor);\n    } else {\n      view.insertNodesBefore(this.anchor);\n    }\n\n    this.children.push(view);\n\n    if (this.isAttached) {\n      view.attached();\n      return this.animateView(view, 'enter');\n    }\n  }\n\n  insert(index, view) {\n    let children = this.children;\n    let length = children.length;\n\n    if (index === 0 && length === 0 || index >= length) {\n      return this.add(view);\n    }\n\n    view.insertNodesBefore(children[index].firstChild);\n    children.splice(index, 0, view);\n\n    if (this.isAttached) {\n      view.attached();\n      return this.animateView(view, 'enter');\n    }\n  }\n\n  move(sourceIndex, targetIndex) {\n    if (sourceIndex === targetIndex) {\n      return;\n    }\n\n    const children = this.children;\n    const view = children[sourceIndex];\n\n    view.removeNodes();\n    view.insertNodesBefore(children[targetIndex].firstChild);\n    children.splice(sourceIndex, 1);\n    children.splice(targetIndex, 0, view);\n  }\n\n  remove(view, returnToCache, skipAnimation) {\n    return this.removeAt(this.children.indexOf(view), returnToCache, skipAnimation);\n  }\n\n  removeMany(viewsToRemove, returnToCache, skipAnimation) {\n    const children = this.children;\n    let ii = viewsToRemove.length;\n    let i;\n    let rmPromises = [];\n\n    viewsToRemove.forEach(child => {\n      if (skipAnimation) {\n        child.removeNodes();\n        return;\n      }\n\n      let animation = this.animateView(child, 'leave');\n      if (animation) {\n        rmPromises.push(animation.then(() => child.removeNodes()));\n      } else {\n        child.removeNodes();\n      }\n    });\n\n    let removeAction = () => {\n      if (this.isAttached) {\n        for (i = 0; i < ii; ++i) {\n          viewsToRemove[i].detached();\n        }\n      }\n\n      if (returnToCache) {\n        for (i = 0; i < ii; ++i) {\n          viewsToRemove[i].returnToCache();\n        }\n      }\n\n      for (i = 0; i < ii; ++i) {\n        const index = children.indexOf(viewsToRemove[i]);\n        if (index >= 0) {\n          children.splice(index, 1);\n        }\n      }\n    };\n\n    if (rmPromises.length > 0) {\n      return Promise.all(rmPromises).then(() => removeAction());\n    }\n\n    return removeAction();\n  }\n\n  removeAt(index, returnToCache, skipAnimation) {\n    let view = this.children[index];\n\n    let removeAction = () => {\n      index = this.children.indexOf(view);\n      view.removeNodes();\n      this.children.splice(index, 1);\n\n      if (this.isAttached) {\n        view.detached();\n      }\n\n      if (returnToCache) {\n        view.returnToCache();\n      }\n\n      return view;\n    };\n\n    if (!skipAnimation) {\n      let animation = this.animateView(view, 'leave');\n      if (animation) {\n        return animation.then(() => removeAction());\n      }\n    }\n\n    return removeAction();\n  }\n\n  removeAll(returnToCache, skipAnimation) {\n    let children = this.children;\n    let ii = children.length;\n    let i;\n    let rmPromises = [];\n\n    children.forEach(child => {\n      if (skipAnimation) {\n        child.removeNodes();\n        return;\n      }\n\n      let animation = this.animateView(child, 'leave');\n      if (animation) {\n        rmPromises.push(animation.then(() => child.removeNodes()));\n      } else {\n        child.removeNodes();\n      }\n    });\n\n    let removeAction = () => {\n      if (this.isAttached) {\n        for (i = 0; i < ii; ++i) {\n          children[i].detached();\n        }\n      }\n\n      if (returnToCache) {\n        for (i = 0; i < ii; ++i) {\n          const child = children[i];\n\n          if (child) {\n            child.returnToCache();\n          }\n        }\n      }\n\n      this.children = [];\n    };\n\n    if (rmPromises.length > 0) {\n      return Promise.all(rmPromises).then(() => removeAction());\n    }\n\n    return removeAction();\n  }\n\n  attached() {\n    let i;\n    let ii;\n    let children;\n    let child;\n\n    if (this.isAttached) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      child = children[i];\n      child.attached();\n      this.animateView(child, 'enter');\n    }\n  }\n\n  detached() {\n    let i;\n    let ii;\n    let children;\n\n    if (this.isAttached) {\n      this.isAttached = false;\n      children = this.children;\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].detached();\n      }\n    }\n  }\n\n  projectTo(slots) {\n    this.projectToSlots = slots;\n    this.add = this._projectionAdd;\n    this.insert = this._projectionInsert;\n    this.move = this._projectionMove;\n    this.remove = this._projectionRemove;\n    this.removeAt = this._projectionRemoveAt;\n    this.removeMany = this._projectionRemoveMany;\n    this.removeAll = this._projectionRemoveAll;\n    this.children.forEach(view => ShadowDOM.distributeView(view, slots, this));\n  }\n\n  _projectionAdd(view) {\n    ShadowDOM.distributeView(view, this.projectToSlots, this);\n\n    this.children.push(view);\n\n    if (this.isAttached) {\n      view.attached();\n    }\n  }\n\n  _projectionInsert(index, view) {\n    if (index === 0 && !this.children.length || index >= this.children.length) {\n      this.add(view);\n    } else {\n      ShadowDOM.distributeView(view, this.projectToSlots, this, index);\n\n      this.children.splice(index, 0, view);\n\n      if (this.isAttached) {\n        view.attached();\n      }\n    }\n  }\n\n  _projectionMove(sourceIndex, targetIndex) {\n    if (sourceIndex === targetIndex) {\n      return;\n    }\n\n    const children = this.children;\n    const view = children[sourceIndex];\n\n    ShadowDOM.undistributeView(view, this.projectToSlots, this);\n    ShadowDOM.distributeView(view, this.projectToSlots, this, targetIndex);\n\n    children.splice(sourceIndex, 1);\n    children.splice(targetIndex, 0, view);\n  }\n\n  _projectionRemove(view, returnToCache) {\n    ShadowDOM.undistributeView(view, this.projectToSlots, this);\n    this.children.splice(this.children.indexOf(view), 1);\n\n    if (this.isAttached) {\n      view.detached();\n    }\n    if (returnToCache) {\n      view.returnToCache();\n    }\n  }\n\n  _projectionRemoveAt(index, returnToCache) {\n    let view = this.children[index];\n\n    ShadowDOM.undistributeView(view, this.projectToSlots, this);\n    this.children.splice(index, 1);\n\n    if (this.isAttached) {\n      view.detached();\n    }\n    if (returnToCache) {\n      view.returnToCache();\n    }\n  }\n\n  _projectionRemoveMany(viewsToRemove, returnToCache) {\n    viewsToRemove.forEach(view => this.remove(view, returnToCache));\n  }\n\n  _projectionRemoveAll(returnToCache) {\n    ShadowDOM.undistributeAll(this.projectToSlots, this);\n\n    let children = this.children;\n    let ii = children.length;\n\n    for (let i = 0; i < ii; ++i) {\n      if (returnToCache) {\n        children[i].returnToCache();\n      } else if (this.isAttached) {\n        children[i].detached();\n      }\n    }\n\n    this.children = [];\n  }\n};\n\nlet ProviderResolver = Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__[\"resolver\"])(_class12 = class ProviderResolver {\n  get(container, key) {\n    let id = key.__providerId__;\n    return id in container ? container[id] : container[id] = container.invoke(key);\n  }\n}) || _class12;\n\nlet providerResolverInstance = new ProviderResolver();\n\nfunction elementContainerGet(key) {\n  if (key === aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].Element) {\n    return this.element;\n  }\n\n  if (key === BoundViewFactory) {\n    if (this.boundViewFactory) {\n      return this.boundViewFactory;\n    }\n\n    let factory = this.instruction.viewFactory;\n    let partReplacements = this.partReplacements;\n\n    if (partReplacements) {\n      factory = partReplacements[factory.part] || factory;\n    }\n\n    this.boundViewFactory = new BoundViewFactory(this, factory, partReplacements);\n    return this.boundViewFactory;\n  }\n\n  if (key === ViewSlot) {\n    if (this.viewSlot === undefined) {\n      this.viewSlot = new ViewSlot(this.element, this.instruction.anchorIsContainer);\n      this.element.isContentProjectionSource = this.instruction.lifting;\n      this.children.push(this.viewSlot);\n    }\n\n    return this.viewSlot;\n  }\n\n  if (key === ElementEvents) {\n    return this.elementEvents || (this.elementEvents = new ElementEvents(this.element));\n  }\n\n  if (key === CompositionTransaction) {\n    return this.compositionTransaction || (this.compositionTransaction = this.parent.get(key));\n  }\n\n  if (key === ViewResources) {\n    return this.viewResources;\n  }\n\n  if (key === TargetInstruction) {\n    return this.instruction;\n  }\n\n  return this.superGet(key);\n}\n\nfunction createElementContainer(parent, element, instruction, children, partReplacements, resources) {\n  let container = parent.createChild();\n  let providers;\n  let i;\n\n  container.element = element;\n  container.instruction = instruction;\n  container.children = children;\n  container.viewResources = resources;\n  container.partReplacements = partReplacements;\n\n  providers = instruction.providers;\n  i = providers.length;\n\n  while (i--) {\n    container._resolvers.set(providers[i], providerResolverInstance);\n  }\n\n  container.superGet = container.get;\n  container.get = elementContainerGet;\n\n  return container;\n}\n\nfunction hasAttribute(name) {\n  return this._element.hasAttribute(name);\n}\n\nfunction getAttribute(name) {\n  return this._element.getAttribute(name);\n}\n\nfunction setAttribute(name, value) {\n  this._element.setAttribute(name, value);\n}\n\nfunction makeElementIntoAnchor(element, elementInstruction) {\n  let anchor = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createComment('anchor');\n\n  if (elementInstruction) {\n    let firstChild = element.firstChild;\n\n    if (firstChild && firstChild.tagName === 'AU-CONTENT') {\n      anchor.contentElement = firstChild;\n    }\n\n    anchor._element = element;\n\n    anchor.hasAttribute = hasAttribute;\n    anchor.getAttribute = getAttribute;\n    anchor.setAttribute = setAttribute;\n  }\n\n  aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].replaceNode(anchor, element);\n\n  return anchor;\n}\n\nfunction applyInstructions(containers, element, instruction, controllers, bindings, children, shadowSlots, partReplacements, resources) {\n  let behaviorInstructions = instruction.behaviorInstructions;\n  let expressions = instruction.expressions;\n  let elementContainer;\n  let i;\n  let ii;\n  let current;\n  let instance;\n\n  if (instruction.contentExpression) {\n    bindings.push(instruction.contentExpression.createBinding(element.nextSibling));\n    element.nextSibling.auInterpolationTarget = true;\n    element.parentNode.removeChild(element);\n    return;\n  }\n\n  if (instruction.shadowSlot) {\n    let commentAnchor = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createComment('slot');\n    let slot;\n\n    if (instruction.slotDestination) {\n      slot = new PassThroughSlot(commentAnchor, instruction.slotName, instruction.slotDestination, instruction.slotFallbackFactory);\n    } else {\n      slot = new ShadowSlot(commentAnchor, instruction.slotName, instruction.slotFallbackFactory);\n    }\n\n    aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].replaceNode(commentAnchor, element);\n    shadowSlots[instruction.slotName] = slot;\n    controllers.push(slot);\n    return;\n  }\n\n  if (instruction.letElement) {\n    for (i = 0, ii = expressions.length; i < ii; ++i) {\n      bindings.push(expressions[i].createBinding());\n    }\n    element.parentNode.removeChild(element);\n    return;\n  }\n\n  if (behaviorInstructions.length) {\n    if (!instruction.anchorIsContainer) {\n      element = makeElementIntoAnchor(element, instruction.elementInstruction);\n    }\n\n    containers[instruction.injectorId] = elementContainer = createElementContainer(containers[instruction.parentInjectorId], element, instruction, children, partReplacements, resources);\n\n    for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n      current = behaviorInstructions[i];\n      instance = current.type.create(elementContainer, current, element, bindings);\n      controllers.push(instance);\n    }\n  }\n\n  for (i = 0, ii = expressions.length; i < ii; ++i) {\n    bindings.push(expressions[i].createBinding(element));\n  }\n}\n\nfunction styleStringToObject(style, target) {\n  let attributes = style.split(';');\n  let firstIndexOfColon;\n  let i;\n  let current;\n  let key;\n  let value;\n\n  target = target || {};\n\n  for (i = 0; i < attributes.length; i++) {\n    current = attributes[i];\n    firstIndexOfColon = current.indexOf(':');\n    key = current.substring(0, firstIndexOfColon).trim();\n    value = current.substring(firstIndexOfColon + 1).trim();\n    target[key] = value;\n  }\n\n  return target;\n}\n\nfunction styleObjectToString(obj) {\n  let result = '';\n\n  for (let key in obj) {\n    result += key + ':' + obj[key] + ';';\n  }\n\n  return result;\n}\n\nfunction applySurrogateInstruction(container, element, instruction, controllers, bindings, children) {\n  let behaviorInstructions = instruction.behaviorInstructions;\n  let expressions = instruction.expressions;\n  let providers = instruction.providers;\n  let values = instruction.values;\n  let i;\n  let ii;\n  let current;\n  let instance;\n  let currentAttributeValue;\n\n  i = providers.length;\n  while (i--) {\n    container._resolvers.set(providers[i], providerResolverInstance);\n  }\n\n  for (let key in values) {\n    currentAttributeValue = element.getAttribute(key);\n\n    if (currentAttributeValue) {\n      if (key === 'class') {\n        element.setAttribute('class', currentAttributeValue + ' ' + values[key]);\n      } else if (key === 'style') {\n        let styleObject = styleStringToObject(values[key]);\n        styleStringToObject(currentAttributeValue, styleObject);\n        element.setAttribute('style', styleObjectToString(styleObject));\n      }\n    } else {\n      element.setAttribute(key, values[key]);\n    }\n  }\n\n  if (behaviorInstructions.length) {\n    for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n      current = behaviorInstructions[i];\n      instance = current.type.create(container, current, element, bindings);\n\n      if (instance.contentView) {\n        children.push(instance.contentView);\n      }\n\n      controllers.push(instance);\n    }\n  }\n\n  for (i = 0, ii = expressions.length; i < ii; ++i) {\n    bindings.push(expressions[i].createBinding(element));\n  }\n}\n\nlet BoundViewFactory = class BoundViewFactory {\n  constructor(parentContainer, viewFactory, partReplacements) {\n    this.parentContainer = parentContainer;\n    this.viewFactory = viewFactory;\n    this.factoryCreateInstruction = { partReplacements: partReplacements };\n  }\n\n  create() {\n    let view = this.viewFactory.create(this.parentContainer.createChild(), this.factoryCreateInstruction);\n    view._isUserControlled = true;\n    return view;\n  }\n\n  get isCaching() {\n    return this.viewFactory.isCaching;\n  }\n\n  setCacheSize(size, doNotOverrideIfAlreadySet) {\n    this.viewFactory.setCacheSize(size, doNotOverrideIfAlreadySet);\n  }\n\n  getCachedView() {\n    return this.viewFactory.getCachedView();\n  }\n\n  returnViewToCache(view) {\n    this.viewFactory.returnViewToCache(view);\n  }\n};\n\nlet ViewFactory = class ViewFactory {\n  constructor(template, instructions, resources) {\n    this.isCaching = false;\n\n    this.template = template;\n    this.instructions = instructions;\n    this.resources = resources;\n    this.cacheSize = -1;\n    this.cache = null;\n  }\n\n  setCacheSize(size, doNotOverrideIfAlreadySet) {\n    if (size) {\n      if (size === '*') {\n        size = Number.MAX_VALUE;\n      } else if (typeof size === 'string') {\n        size = parseInt(size, 10);\n      }\n    }\n\n    if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {\n      this.cacheSize = size;\n    }\n\n    if (this.cacheSize > 0) {\n      this.cache = [];\n    } else {\n      this.cache = null;\n    }\n\n    this.isCaching = this.cacheSize > 0;\n  }\n\n  getCachedView() {\n    return this.cache !== null ? this.cache.pop() || null : null;\n  }\n\n  returnViewToCache(view) {\n    if (view.isAttached) {\n      view.detached();\n    }\n\n    if (view.isBound) {\n      view.unbind();\n    }\n\n    if (this.cache !== null && this.cache.length < this.cacheSize) {\n      view.fromCache = true;\n      this.cache.push(view);\n    }\n  }\n\n  create(container, createInstruction, element) {\n    createInstruction = createInstruction || BehaviorInstruction.normal;\n\n    let cachedView = this.getCachedView();\n    if (cachedView !== null) {\n      return cachedView;\n    }\n\n    let fragment = createInstruction.enhance ? this.template : this.template.cloneNode(true);\n    let instructables = fragment.querySelectorAll('.au-target');\n    let instructions = this.instructions;\n    let resources = this.resources;\n    let controllers = [];\n    let bindings = [];\n    let children = [];\n    let shadowSlots = Object.create(null);\n    let containers = { root: container };\n    let partReplacements = createInstruction.partReplacements;\n    let i;\n    let ii;\n    let view;\n    let instructable;\n    let instruction;\n\n    this.resources._invokeHook('beforeCreate', this, container, fragment, createInstruction);\n\n    if (element && this.surrogateInstruction !== null) {\n      applySurrogateInstruction(container, element, this.surrogateInstruction, controllers, bindings, children);\n    }\n\n    if (createInstruction.enhance && fragment.hasAttribute('au-target-id')) {\n      instructable = fragment;\n      instruction = instructions[instructable.getAttribute('au-target-id')];\n      applyInstructions(containers, instructable, instruction, controllers, bindings, children, shadowSlots, partReplacements, resources);\n    }\n\n    for (i = 0, ii = instructables.length; i < ii; ++i) {\n      instructable = instructables[i];\n      instruction = instructions[instructable.getAttribute('au-target-id')];\n      applyInstructions(containers, instructable, instruction, controllers, bindings, children, shadowSlots, partReplacements, resources);\n    }\n\n    view = new View(container, this, fragment, controllers, bindings, children, shadowSlots);\n\n    if (!createInstruction.initiatedByBehavior) {\n      view.created();\n    }\n\n    this.resources._invokeHook('afterCreate', view);\n\n    return view;\n  }\n};\n\nlet nextInjectorId = 0;\nfunction getNextInjectorId() {\n  return ++nextInjectorId;\n}\n\nlet lastAUTargetID = 0;\nfunction getNextAUTargetID() {\n  return (++lastAUTargetID).toString();\n}\n\nfunction makeIntoInstructionTarget(element) {\n  let value = element.getAttribute('class');\n  let auTargetID = getNextAUTargetID();\n\n  element.setAttribute('class', value ? value + ' au-target' : 'au-target');\n  element.setAttribute('au-target-id', auTargetID);\n\n  return auTargetID;\n}\n\nfunction makeShadowSlot(compiler, resources, node, instructions, parentInjectorId) {\n  let auShadowSlot = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createElement('au-shadow-slot');\n  aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].replaceNode(auShadowSlot, node);\n\n  let auTargetID = makeIntoInstructionTarget(auShadowSlot);\n  let instruction = TargetInstruction.shadowSlot(parentInjectorId);\n\n  instruction.slotName = node.getAttribute('name') || ShadowDOM.defaultSlotKey;\n  instruction.slotDestination = node.getAttribute('slot');\n\n  if (node.innerHTML.trim()) {\n    let fragment = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createDocumentFragment();\n    let child;\n\n    while (child = node.firstChild) {\n      fragment.appendChild(child);\n    }\n\n    instruction.slotFallbackFactory = compiler.compile(fragment, resources);\n  }\n\n  instructions[auTargetID] = instruction;\n\n  return auShadowSlot;\n}\n\nconst defaultLetHandler = BindingLanguage.prototype.createLetExpressions;\n\nlet ViewCompiler = (_dec7 = Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__[\"inject\"])(BindingLanguage, ViewResources), _dec7(_class14 = class ViewCompiler {\n  constructor(bindingLanguage, resources) {\n    this.bindingLanguage = bindingLanguage;\n    this.resources = resources;\n  }\n\n  compile(source, resources, compileInstruction) {\n    resources = resources || this.resources;\n    compileInstruction = compileInstruction || ViewCompileInstruction.normal;\n    source = typeof source === 'string' ? aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createTemplateFromMarkup(source) : source;\n\n    let content;\n    let part;\n    let cacheSize;\n\n    if (source.content) {\n      part = source.getAttribute('part');\n      cacheSize = source.getAttribute('view-cache');\n      content = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].adoptNode(source.content);\n    } else {\n      content = source;\n    }\n\n    compileInstruction.targetShadowDOM = compileInstruction.targetShadowDOM && aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"FEATURE\"].shadowDOM;\n    resources._invokeHook('beforeCompile', content, resources, compileInstruction);\n\n    let instructions = {};\n    this._compileNode(content, resources, instructions, source, 'root', !compileInstruction.targetShadowDOM);\n\n    let firstChild = content.firstChild;\n    if (firstChild && firstChild.nodeType === 1) {\n      let targetId = firstChild.getAttribute('au-target-id');\n      if (targetId) {\n        let ins = instructions[targetId];\n\n        if (ins.shadowSlot || ins.lifting || ins.elementInstruction && !ins.elementInstruction.anchorIsContainer) {\n          content.insertBefore(aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createComment('view'), firstChild);\n        }\n      }\n    }\n\n    let factory = new ViewFactory(content, instructions, resources);\n\n    factory.surrogateInstruction = compileInstruction.compileSurrogate ? this._compileSurrogate(source, resources) : null;\n    factory.part = part;\n\n    if (cacheSize) {\n      factory.setCacheSize(cacheSize);\n    }\n\n    resources._invokeHook('afterCompile', factory);\n\n    return factory;\n  }\n\n  _compileNode(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM) {\n    switch (node.nodeType) {\n      case 1:\n        return this._compileElement(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM);\n      case 3:\n        let expression = resources.getBindingLanguage(this.bindingLanguage).inspectTextContent(resources, node.wholeText);\n        if (expression) {\n          let marker = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createElement('au-marker');\n          let auTargetID = makeIntoInstructionTarget(marker);\n          (node.parentNode || parentNode).insertBefore(marker, node);\n          node.textContent = ' ';\n          instructions[auTargetID] = TargetInstruction.contentExpression(expression);\n\n          while (node.nextSibling && node.nextSibling.nodeType === 3) {\n            (node.parentNode || parentNode).removeChild(node.nextSibling);\n          }\n        } else {\n          while (node.nextSibling && node.nextSibling.nodeType === 3) {\n            node = node.nextSibling;\n          }\n        }\n        return node.nextSibling;\n      case 11:\n        let currentChild = node.firstChild;\n        while (currentChild) {\n          currentChild = this._compileNode(currentChild, resources, instructions, node, parentInjectorId, targetLightDOM);\n        }\n        break;\n      default:\n        break;\n    }\n\n    return node.nextSibling;\n  }\n\n  _compileSurrogate(node, resources) {\n    let tagName = node.tagName.toLowerCase();\n    let attributes = node.attributes;\n    let bindingLanguage = resources.getBindingLanguage(this.bindingLanguage);\n    let knownAttribute;\n    let property;\n    let instruction;\n    let i;\n    let ii;\n    let attr;\n    let attrName;\n    let attrValue;\n    let info;\n    let type;\n    let expressions = [];\n    let expression;\n    let behaviorInstructions = [];\n    let values = {};\n    let hasValues = false;\n    let providers = [];\n\n    for (i = 0, ii = attributes.length; i < ii; ++i) {\n      attr = attributes[i];\n      attrName = attr.name;\n      attrValue = attr.value;\n\n      info = bindingLanguage.inspectAttribute(resources, tagName, attrName, attrValue);\n      type = resources.getAttribute(info.attrName);\n\n      if (type) {\n        knownAttribute = resources.mapAttribute(info.attrName);\n        if (knownAttribute) {\n          property = type.attributes[knownAttribute];\n\n          if (property) {\n            info.defaultBindingMode = property.defaultBindingMode;\n\n            if (!info.command && !info.expression) {\n              info.command = property.hasOptions ? 'options' : null;\n            }\n\n            if (info.command && info.command !== 'options' && type.primaryProperty) {\n              const primaryProperty = type.primaryProperty;\n              attrName = info.attrName = primaryProperty.attribute;\n\n              info.defaultBindingMode = primaryProperty.defaultBindingMode;\n            }\n          }\n        }\n      }\n\n      instruction = bindingLanguage.createAttributeInstruction(resources, node, info, undefined, type);\n\n      if (instruction) {\n        if (instruction.alteredAttr) {\n          type = resources.getAttribute(instruction.attrName);\n        }\n\n        if (instruction.discrete) {\n          expressions.push(instruction);\n        } else {\n          if (type) {\n            instruction.type = type;\n            this._configureProperties(instruction, resources);\n\n            if (type.liftsContent) {\n              throw new Error('You cannot place a template controller on a surrogate element.');\n            } else {\n              behaviorInstructions.push(instruction);\n            }\n          } else {\n            expressions.push(instruction.attributes[instruction.attrName]);\n          }\n        }\n      } else {\n        if (type) {\n          instruction = BehaviorInstruction.attribute(attrName, type);\n          instruction.attributes[resources.mapAttribute(attrName)] = attrValue;\n\n          if (type.liftsContent) {\n            throw new Error('You cannot place a template controller on a surrogate element.');\n          } else {\n            behaviorInstructions.push(instruction);\n          }\n        } else if (attrName !== 'id' && attrName !== 'part' && attrName !== 'replace-part') {\n          hasValues = true;\n          values[attrName] = attrValue;\n        }\n      }\n    }\n\n    if (expressions.length || behaviorInstructions.length || hasValues) {\n      for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n        instruction = behaviorInstructions[i];\n        instruction.type.compile(this, resources, node, instruction);\n        providers.push(instruction.type.target);\n      }\n\n      for (i = 0, ii = expressions.length; i < ii; ++i) {\n        expression = expressions[i];\n        if (expression.attrToRemove !== undefined) {\n          node.removeAttribute(expression.attrToRemove);\n        }\n      }\n\n      return TargetInstruction.surrogate(providers, behaviorInstructions, expressions, values);\n    }\n\n    return null;\n  }\n\n  _compileElement(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM) {\n    let tagName = node.tagName.toLowerCase();\n    let attributes = node.attributes;\n    let expressions = [];\n    let expression;\n    let behaviorInstructions = [];\n    let providers = [];\n    let bindingLanguage = resources.getBindingLanguage(this.bindingLanguage);\n    let liftingInstruction;\n    let viewFactory;\n    let type;\n    let elementInstruction;\n    let elementProperty;\n    let i;\n    let ii;\n    let attr;\n    let attrName;\n    let attrValue;\n    let originalAttrName;\n    let instruction;\n    let info;\n    let property;\n    let knownAttribute;\n    let auTargetID;\n    let injectorId;\n\n    if (tagName === 'slot') {\n      if (targetLightDOM) {\n        node = makeShadowSlot(this, resources, node, instructions, parentInjectorId);\n      }\n      return node.nextSibling;\n    } else if (tagName === 'template') {\n      if (!('content' in node)) {\n        throw new Error('You cannot place a template element within ' + node.namespaceURI + ' namespace');\n      }\n      viewFactory = this.compile(node, resources);\n      viewFactory.part = node.getAttribute('part');\n    } else {\n      type = resources.getElement(node.getAttribute('as-element') || tagName);\n\n      if (tagName === 'let' && !type && bindingLanguage.createLetExpressions !== defaultLetHandler) {\n        expressions = bindingLanguage.createLetExpressions(resources, node);\n        auTargetID = makeIntoInstructionTarget(node);\n        instructions[auTargetID] = TargetInstruction.letElement(expressions);\n        return node.nextSibling;\n      }\n      if (type) {\n        elementInstruction = BehaviorInstruction.element(node, type);\n        type.processAttributes(this, resources, node, attributes, elementInstruction);\n        behaviorInstructions.push(elementInstruction);\n      }\n    }\n\n    for (i = 0, ii = attributes.length; i < ii; ++i) {\n      attr = attributes[i];\n      originalAttrName = attrName = attr.name;\n      attrValue = attr.value;\n      info = bindingLanguage.inspectAttribute(resources, tagName, attrName, attrValue);\n\n      if (targetLightDOM && info.attrName === 'slot') {\n        info.attrName = attrName = 'au-slot';\n      }\n\n      type = resources.getAttribute(info.attrName);\n      elementProperty = null;\n\n      if (type) {\n        knownAttribute = resources.mapAttribute(info.attrName);\n        if (knownAttribute) {\n          property = type.attributes[knownAttribute];\n\n          if (property) {\n            info.defaultBindingMode = property.defaultBindingMode;\n\n            if (!info.command && !info.expression) {\n              info.command = property.hasOptions ? 'options' : null;\n            }\n\n            if (info.command && info.command !== 'options' && type.primaryProperty) {\n              const primaryProperty = type.primaryProperty;\n              attrName = info.attrName = primaryProperty.attribute;\n\n              info.defaultBindingMode = primaryProperty.defaultBindingMode;\n            }\n          }\n        }\n      } else if (elementInstruction) {\n        elementProperty = elementInstruction.type.attributes[info.attrName];\n        if (elementProperty) {\n          info.defaultBindingMode = elementProperty.defaultBindingMode;\n        }\n      }\n\n      if (elementProperty) {\n        instruction = bindingLanguage.createAttributeInstruction(resources, node, info, elementInstruction);\n      } else {\n        instruction = bindingLanguage.createAttributeInstruction(resources, node, info, undefined, type);\n      }\n\n      if (instruction) {\n        if (instruction.alteredAttr) {\n          type = resources.getAttribute(instruction.attrName);\n        }\n\n        if (instruction.discrete) {\n          expressions.push(instruction);\n        } else {\n          if (type) {\n            instruction.type = type;\n            this._configureProperties(instruction, resources);\n\n            if (type.liftsContent) {\n              instruction.originalAttrName = originalAttrName;\n              liftingInstruction = instruction;\n              break;\n            } else {\n              behaviorInstructions.push(instruction);\n            }\n          } else if (elementProperty) {\n            elementInstruction.attributes[info.attrName].targetProperty = elementProperty.name;\n          } else {\n            expressions.push(instruction.attributes[instruction.attrName]);\n          }\n        }\n      } else {\n        if (type) {\n          instruction = BehaviorInstruction.attribute(attrName, type);\n          instruction.attributes[resources.mapAttribute(attrName)] = attrValue;\n\n          if (type.liftsContent) {\n            instruction.originalAttrName = originalAttrName;\n            liftingInstruction = instruction;\n            break;\n          } else {\n            behaviorInstructions.push(instruction);\n          }\n        } else if (elementProperty) {\n          elementInstruction.attributes[attrName] = attrValue;\n        }\n      }\n    }\n\n    if (liftingInstruction) {\n      liftingInstruction.viewFactory = viewFactory;\n      node = liftingInstruction.type.compile(this, resources, node, liftingInstruction, parentNode);\n      auTargetID = makeIntoInstructionTarget(node);\n      instructions[auTargetID] = TargetInstruction.lifting(parentInjectorId, liftingInstruction);\n    } else {\n      let skipContentProcessing = false;\n\n      if (expressions.length || behaviorInstructions.length) {\n        injectorId = behaviorInstructions.length ? getNextInjectorId() : false;\n\n        for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n          instruction = behaviorInstructions[i];\n          instruction.type.compile(this, resources, node, instruction, parentNode);\n          providers.push(instruction.type.target);\n          skipContentProcessing = skipContentProcessing || instruction.skipContentProcessing;\n        }\n\n        for (i = 0, ii = expressions.length; i < ii; ++i) {\n          expression = expressions[i];\n          if (expression.attrToRemove !== undefined) {\n            node.removeAttribute(expression.attrToRemove);\n          }\n        }\n\n        auTargetID = makeIntoInstructionTarget(node);\n        instructions[auTargetID] = TargetInstruction.normal(injectorId, parentInjectorId, providers, behaviorInstructions, expressions, elementInstruction);\n      }\n\n      if (skipContentProcessing) {\n        return node.nextSibling;\n      }\n\n      let currentChild = node.firstChild;\n      while (currentChild) {\n        currentChild = this._compileNode(currentChild, resources, instructions, node, injectorId || parentInjectorId, targetLightDOM);\n      }\n    }\n\n    return node.nextSibling;\n  }\n\n  _configureProperties(instruction, resources) {\n    let type = instruction.type;\n    let attrName = instruction.attrName;\n    let attributes = instruction.attributes;\n    let property;\n    let key;\n    let value;\n\n    let knownAttribute = resources.mapAttribute(attrName);\n    if (knownAttribute && attrName in attributes && knownAttribute !== attrName) {\n      attributes[knownAttribute] = attributes[attrName];\n      delete attributes[attrName];\n    }\n\n    for (key in attributes) {\n      value = attributes[key];\n\n      if (value !== null && typeof value === 'object') {\n        property = type.attributes[key];\n\n        if (property !== undefined) {\n          value.targetProperty = property.name;\n        } else {\n          value.targetProperty = key;\n        }\n      }\n    }\n  }\n}) || _class14);\n\nlet ResourceModule = class ResourceModule {\n  constructor(moduleId) {\n    this.id = moduleId;\n    this.moduleInstance = null;\n    this.mainResource = null;\n    this.resources = null;\n    this.viewStrategy = null;\n    this.isInitialized = false;\n    this.onLoaded = null;\n    this.loadContext = null;\n  }\n\n  initialize(container) {\n    let current = this.mainResource;\n    let resources = this.resources;\n    let vs = this.viewStrategy;\n\n    if (this.isInitialized) {\n      return;\n    }\n\n    this.isInitialized = true;\n\n    if (current !== undefined) {\n      current.metadata.viewStrategy = vs;\n      current.initialize(container);\n    }\n\n    for (let i = 0, ii = resources.length; i < ii; ++i) {\n      current = resources[i];\n      current.metadata.viewStrategy = vs;\n      current.initialize(container);\n    }\n  }\n\n  register(registry, name) {\n    let main = this.mainResource;\n    let resources = this.resources;\n\n    if (main !== undefined) {\n      main.register(registry, name);\n      name = null;\n    }\n\n    for (let i = 0, ii = resources.length; i < ii; ++i) {\n      resources[i].register(registry, name);\n      name = null;\n    }\n  }\n\n  load(container, loadContext) {\n    if (this.onLoaded !== null) {\n      return this.loadContext === loadContext ? Promise.resolve() : this.onLoaded;\n    }\n\n    let main = this.mainResource;\n    let resources = this.resources;\n    let loads;\n\n    if (main !== undefined) {\n      loads = new Array(resources.length + 1);\n      loads[0] = main.load(container, loadContext);\n      for (let i = 0, ii = resources.length; i < ii; ++i) {\n        loads[i + 1] = resources[i].load(container, loadContext);\n      }\n    } else {\n      loads = new Array(resources.length);\n      for (let i = 0, ii = resources.length; i < ii; ++i) {\n        loads[i] = resources[i].load(container, loadContext);\n      }\n    }\n\n    this.loadContext = loadContext;\n    this.onLoaded = Promise.all(loads);\n    return this.onLoaded;\n  }\n};\n\nlet ResourceDescription = class ResourceDescription {\n  constructor(key, exportedValue, resourceTypeMeta) {\n    if (!resourceTypeMeta) {\n      resourceTypeMeta = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].get(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, exportedValue);\n\n      if (!resourceTypeMeta) {\n        resourceTypeMeta = new HtmlBehaviorResource();\n        resourceTypeMeta.elementName = _hyphenate(key);\n        aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, resourceTypeMeta, exportedValue);\n      }\n    }\n\n    if (resourceTypeMeta instanceof HtmlBehaviorResource) {\n      if (resourceTypeMeta.elementName === undefined) {\n        resourceTypeMeta.elementName = _hyphenate(key);\n      } else if (resourceTypeMeta.attributeName === undefined) {\n        resourceTypeMeta.attributeName = _hyphenate(key);\n      } else if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n        HtmlBehaviorResource.convention(key, resourceTypeMeta);\n      }\n    } else if (!resourceTypeMeta.name) {\n      resourceTypeMeta.name = _hyphenate(key);\n    }\n\n    this.metadata = resourceTypeMeta;\n    this.value = exportedValue;\n  }\n\n  initialize(container) {\n    this.metadata.initialize(container, this.value);\n  }\n\n  register(registry, name) {\n    this.metadata.register(registry, name);\n  }\n\n  load(container, loadContext) {\n    return this.metadata.load(container, this.value, loadContext);\n  }\n};\n\nlet ModuleAnalyzer = class ModuleAnalyzer {\n  constructor() {\n    this.cache = Object.create(null);\n  }\n\n  getAnalysis(moduleId) {\n    return this.cache[moduleId];\n  }\n\n  analyze(moduleId, moduleInstance, mainResourceKey) {\n    let mainResource;\n    let fallbackValue;\n    let fallbackKey;\n    let resourceTypeMeta;\n    let key;\n    let exportedValue;\n    let resources = [];\n    let conventional;\n    let vs;\n    let resourceModule;\n\n    resourceModule = this.cache[moduleId];\n    if (resourceModule) {\n      return resourceModule;\n    }\n\n    resourceModule = new ResourceModule(moduleId);\n    this.cache[moduleId] = resourceModule;\n\n    if (typeof moduleInstance === 'function') {\n      moduleInstance = { 'default': moduleInstance };\n    }\n\n    if (mainResourceKey) {\n      mainResource = new ResourceDescription(mainResourceKey, moduleInstance[mainResourceKey]);\n    }\n\n    for (key in moduleInstance) {\n      exportedValue = moduleInstance[key];\n\n      if (key === mainResourceKey || typeof exportedValue !== 'function') {\n        continue;\n      }\n\n      resourceTypeMeta = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].get(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, exportedValue);\n\n      if (resourceTypeMeta) {\n        if (resourceTypeMeta instanceof HtmlBehaviorResource) {\n          ViewResources.convention(exportedValue, resourceTypeMeta);\n\n          if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n            HtmlBehaviorResource.convention(key, resourceTypeMeta);\n          }\n\n          if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n            resourceTypeMeta.elementName = _hyphenate(key);\n          }\n        }\n\n        if (!mainResource && resourceTypeMeta instanceof HtmlBehaviorResource && resourceTypeMeta.elementName !== null) {\n          mainResource = new ResourceDescription(key, exportedValue, resourceTypeMeta);\n        } else {\n          resources.push(new ResourceDescription(key, exportedValue, resourceTypeMeta));\n        }\n      } else if (viewStrategy.decorates(exportedValue)) {\n        vs = exportedValue;\n      } else if (exportedValue instanceof aurelia_loader__WEBPACK_IMPORTED_MODULE_3__[\"TemplateRegistryEntry\"]) {\n        vs = new TemplateRegistryViewStrategy(moduleId, exportedValue);\n      } else {\n        if (conventional = ViewResources.convention(exportedValue)) {\n          if (conventional.elementName !== null && !mainResource) {\n            mainResource = new ResourceDescription(key, exportedValue, conventional);\n          } else {\n            resources.push(new ResourceDescription(key, exportedValue, conventional));\n          }\n          aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, conventional, exportedValue);\n        } else if (conventional = HtmlBehaviorResource.convention(key)) {\n          if (conventional.elementName !== null && !mainResource) {\n            mainResource = new ResourceDescription(key, exportedValue, conventional);\n          } else {\n            resources.push(new ResourceDescription(key, exportedValue, conventional));\n          }\n\n          aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, conventional, exportedValue);\n        } else if (conventional = aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"ValueConverterResource\"].convention(key) || aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"BindingBehaviorResource\"].convention(key) || ViewEngineHooksResource.convention(key)) {\n          resources.push(new ResourceDescription(key, exportedValue, conventional));\n          aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, conventional, exportedValue);\n        } else if (!fallbackValue) {\n          fallbackValue = exportedValue;\n          fallbackKey = key;\n        }\n      }\n    }\n\n    if (!mainResource && fallbackValue) {\n      mainResource = new ResourceDescription(fallbackKey, fallbackValue);\n    }\n\n    resourceModule.moduleInstance = moduleInstance;\n    resourceModule.mainResource = mainResource;\n    resourceModule.resources = resources;\n    resourceModule.viewStrategy = vs;\n\n    return resourceModule;\n  }\n};\n\nlet logger = aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating');\n\nfunction ensureRegistryEntry(loader, urlOrRegistryEntry) {\n  if (urlOrRegistryEntry instanceof aurelia_loader__WEBPACK_IMPORTED_MODULE_3__[\"TemplateRegistryEntry\"]) {\n    return Promise.resolve(urlOrRegistryEntry);\n  }\n\n  return loader.loadTemplate(urlOrRegistryEntry);\n}\n\nlet ProxyViewFactory = class ProxyViewFactory {\n  constructor(promise) {\n    promise.then(x => this.viewFactory = x);\n  }\n\n  create(container, bindingContext, createInstruction, element) {\n    return this.viewFactory.create(container, bindingContext, createInstruction, element);\n  }\n\n  get isCaching() {\n    return this.viewFactory.isCaching;\n  }\n\n  setCacheSize(size, doNotOverrideIfAlreadySet) {\n    this.viewFactory.setCacheSize(size, doNotOverrideIfAlreadySet);\n  }\n\n  getCachedView() {\n    return this.viewFactory.getCachedView();\n  }\n\n  returnViewToCache(view) {\n    this.viewFactory.returnViewToCache(view);\n  }\n};\n\n\nlet auSlotBehavior = null;\n\nlet ViewEngine = (_dec8 = Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__[\"inject\"])(aurelia_loader__WEBPACK_IMPORTED_MODULE_3__[\"Loader\"], aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__[\"Container\"], ViewCompiler, ModuleAnalyzer, ViewResources), _dec8(_class15 = (_temp5 = _class16 = class ViewEngine {\n  constructor(loader, container, viewCompiler, moduleAnalyzer, appResources) {\n    this.loader = loader;\n    this.container = container;\n    this.viewCompiler = viewCompiler;\n    this.moduleAnalyzer = moduleAnalyzer;\n    this.appResources = appResources;\n    this._pluginMap = {};\n\n    if (auSlotBehavior === null) {\n      auSlotBehavior = new HtmlBehaviorResource();\n      auSlotBehavior.attributeName = 'au-slot';\n      aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, auSlotBehavior, SlotCustomAttribute);\n    }\n\n    auSlotBehavior.initialize(container, SlotCustomAttribute);\n    auSlotBehavior.register(appResources);\n  }\n\n  addResourcePlugin(extension, implementation) {\n    let name = extension.replace('.', '') + '-resource-plugin';\n    this._pluginMap[extension] = name;\n    this.loader.addPlugin(name, implementation);\n  }\n\n  loadViewFactory(urlOrRegistryEntry, compileInstruction, loadContext, target) {\n    loadContext = loadContext || new ResourceLoadContext();\n\n    return ensureRegistryEntry(this.loader, urlOrRegistryEntry).then(registryEntry => {\n      const url = registryEntry.address;\n\n      if (registryEntry.onReady) {\n        if (!loadContext.hasDependency(url)) {\n          loadContext.addDependency(url);\n          return registryEntry.onReady;\n        }\n\n        if (registryEntry.template === null) {\n          return registryEntry.onReady;\n        }\n\n        return Promise.resolve(new ProxyViewFactory(registryEntry.onReady));\n      }\n\n      loadContext.addDependency(url);\n\n      registryEntry.onReady = this.loadTemplateResources(registryEntry, compileInstruction, loadContext, target).then(resources => {\n        registryEntry.resources = resources;\n\n        if (registryEntry.template === null) {\n          return registryEntry.factory = null;\n        }\n\n        let viewFactory = this.viewCompiler.compile(registryEntry.template, resources, compileInstruction);\n        return registryEntry.factory = viewFactory;\n      });\n\n      return registryEntry.onReady;\n    });\n  }\n\n  loadTemplateResources(registryEntry, compileInstruction, loadContext, target) {\n    let resources = new ViewResources(this.appResources, registryEntry.address);\n    let dependencies = registryEntry.dependencies;\n    let importIds;\n    let names;\n\n    compileInstruction = compileInstruction || ViewCompileInstruction.normal;\n\n    if (dependencies.length === 0 && !compileInstruction.associatedModuleId) {\n      return Promise.resolve(resources);\n    }\n\n    importIds = dependencies.map(x => x.src);\n    names = dependencies.map(x => x.name);\n    logger.debug(`importing resources for ${registryEntry.address}`, importIds);\n\n    if (target) {\n      let viewModelRequires = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].get(ViewEngine.viewModelRequireMetadataKey, target);\n      if (viewModelRequires) {\n        let templateImportCount = importIds.length;\n        for (let i = 0, ii = viewModelRequires.length; i < ii; ++i) {\n          let req = viewModelRequires[i];\n          let importId = typeof req === 'function' ? aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(req).moduleId : Object(aurelia_path__WEBPACK_IMPORTED_MODULE_4__[\"relativeToFile\"])(req.src || req, registryEntry.address);\n\n          if (importIds.indexOf(importId) === -1) {\n            importIds.push(importId);\n            names.push(req.as);\n          }\n        }\n        logger.debug(`importing ViewModel resources for ${compileInstruction.associatedModuleId}`, importIds.slice(templateImportCount));\n      }\n    }\n\n    return this.importViewResources(importIds, names, resources, compileInstruction, loadContext);\n  }\n\n  importViewModelResource(moduleImport, moduleMember) {\n    return this.loader.loadModule(moduleImport).then(viewModelModule => {\n      let normalizedId = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(viewModelModule).moduleId;\n      let resourceModule = this.moduleAnalyzer.analyze(normalizedId, viewModelModule, moduleMember);\n\n      if (!resourceModule.mainResource) {\n        throw new Error(`No view model found in module \"${moduleImport}\".`);\n      }\n\n      resourceModule.initialize(this.container);\n\n      return resourceModule.mainResource;\n    });\n  }\n\n  importViewResources(moduleIds, names, resources, compileInstruction, loadContext) {\n    loadContext = loadContext || new ResourceLoadContext();\n    compileInstruction = compileInstruction || ViewCompileInstruction.normal;\n\n    moduleIds = moduleIds.map(x => this._applyLoaderPlugin(x));\n\n    return this.loader.loadAllModules(moduleIds).then(imports => {\n      let i;\n      let ii;\n      let analysis;\n      let normalizedId;\n      let current;\n      let associatedModule;\n      let container = this.container;\n      let moduleAnalyzer = this.moduleAnalyzer;\n      let allAnalysis = new Array(imports.length);\n\n      for (i = 0, ii = imports.length; i < ii; ++i) {\n        current = imports[i];\n        normalizedId = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(current).moduleId;\n\n        analysis = moduleAnalyzer.analyze(normalizedId, current);\n        analysis.initialize(container);\n        analysis.register(resources, names[i]);\n\n        allAnalysis[i] = analysis;\n      }\n\n      if (compileInstruction.associatedModuleId) {\n        associatedModule = moduleAnalyzer.getAnalysis(compileInstruction.associatedModuleId);\n\n        if (associatedModule) {\n          associatedModule.register(resources);\n        }\n      }\n\n      for (i = 0, ii = allAnalysis.length; i < ii; ++i) {\n        allAnalysis[i] = allAnalysis[i].load(container, loadContext);\n      }\n\n      return Promise.all(allAnalysis).then(() => resources);\n    });\n  }\n\n  _applyLoaderPlugin(id) {\n    let index = id.lastIndexOf('.');\n    if (index !== -1) {\n      let ext = id.substring(index);\n      let pluginName = this._pluginMap[ext];\n\n      if (pluginName === undefined) {\n        return id;\n      }\n\n      return this.loader.applyPluginToUrl(id, pluginName);\n    }\n\n    return id;\n  }\n}, _class16.viewModelRequireMetadataKey = 'aurelia:view-model-require', _temp5)) || _class15);\n\nlet Controller = class Controller {\n  constructor(behavior, instruction, viewModel, container) {\n    this.behavior = behavior;\n    this.instruction = instruction;\n    this.viewModel = viewModel;\n    this.isAttached = false;\n    this.view = null;\n    this.isBound = false;\n    this.scope = null;\n    this.container = container;\n    this.elementEvents = container.elementEvents || null;\n\n    let observerLookup = behavior.observerLocator.getOrCreateObserversLookup(viewModel);\n    let handlesBind = behavior.handlesBind;\n    let attributes = instruction.attributes;\n    let boundProperties = this.boundProperties = [];\n    let properties = behavior.properties;\n    let i;\n    let ii;\n\n    behavior._ensurePropertiesDefined(viewModel, observerLookup);\n\n    for (i = 0, ii = properties.length; i < ii; ++i) {\n      properties[i]._initialize(viewModel, observerLookup, attributes, handlesBind, boundProperties);\n    }\n  }\n\n  created(owningView) {\n    if (this.behavior.handlesCreated) {\n      this.viewModel.created(owningView, this.view);\n    }\n  }\n\n  automate(overrideContext, owningView) {\n    this.view.bindingContext = this.viewModel;\n    this.view.overrideContext = overrideContext || Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"createOverrideContext\"])(this.viewModel);\n    this.view._isUserControlled = true;\n\n    if (this.behavior.handlesCreated) {\n      this.viewModel.created(owningView || null, this.view);\n    }\n\n    this.bind(this.view);\n  }\n\n  bind(scope) {\n    let skipSelfSubscriber = this.behavior.handlesBind;\n    let boundProperties = this.boundProperties;\n    let i;\n    let ii;\n    let x;\n    let observer;\n    let selfSubscriber;\n\n    if (this.isBound) {\n      if (this.scope === scope) {\n        return;\n      }\n\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.scope = scope;\n\n    for (i = 0, ii = boundProperties.length; i < ii; ++i) {\n      x = boundProperties[i];\n      observer = x.observer;\n      selfSubscriber = observer.selfSubscriber;\n      observer.publishing = false;\n\n      if (skipSelfSubscriber) {\n        observer.selfSubscriber = null;\n      }\n\n      x.binding.bind(scope);\n      observer.call();\n\n      observer.publishing = true;\n      observer.selfSubscriber = selfSubscriber;\n    }\n\n    let overrideContext;\n    if (this.view !== null) {\n      if (skipSelfSubscriber) {\n        this.view.viewModelScope = scope;\n      }\n\n      if (this.viewModel === scope.overrideContext.bindingContext) {\n        overrideContext = scope.overrideContext;\n      } else if (this.instruction.inheritBindingContext) {\n        overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"createOverrideContext\"])(this.viewModel, scope.overrideContext);\n      } else {\n        overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"createOverrideContext\"])(this.viewModel);\n        overrideContext.__parentOverrideContext = scope.overrideContext;\n      }\n\n      this.view.bind(this.viewModel, overrideContext);\n    } else if (skipSelfSubscriber) {\n      overrideContext = scope.overrideContext;\n\n      if (scope.overrideContext.__parentOverrideContext !== undefined && this.viewModel.viewFactory && this.viewModel.viewFactory.factoryCreateInstruction.partReplacements) {\n        overrideContext = Object.assign({}, scope.overrideContext);\n        overrideContext.parentOverrideContext = scope.overrideContext.__parentOverrideContext;\n      }\n      this.viewModel.bind(scope.bindingContext, overrideContext);\n    }\n  }\n\n  unbind() {\n    if (this.isBound) {\n      let boundProperties = this.boundProperties;\n      let i;\n      let ii;\n\n      this.isBound = false;\n      this.scope = null;\n\n      if (this.view !== null) {\n        this.view.unbind();\n      }\n\n      if (this.behavior.handlesUnbind) {\n        this.viewModel.unbind();\n      }\n\n      if (this.elementEvents !== null) {\n        this.elementEvents.disposeAll();\n      }\n\n      for (i = 0, ii = boundProperties.length; i < ii; ++i) {\n        boundProperties[i].binding.unbind();\n      }\n    }\n  }\n\n  attached() {\n    if (this.isAttached) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    if (this.behavior.handlesAttached) {\n      this.viewModel.attached();\n    }\n\n    if (this.view !== null) {\n      this.view.attached();\n    }\n  }\n\n  detached() {\n    if (this.isAttached) {\n      this.isAttached = false;\n\n      if (this.view !== null) {\n        this.view.detached();\n      }\n\n      if (this.behavior.handlesDetached) {\n        this.viewModel.detached();\n      }\n    }\n  }\n};\n\nlet BehaviorPropertyObserver = (_dec9 = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"subscriberCollection\"])(), _dec9(_class17 = class BehaviorPropertyObserver {\n  constructor(taskQueue, obj, propertyName, selfSubscriber, initialValue) {\n    this.taskQueue = taskQueue;\n    this.obj = obj;\n    this.propertyName = propertyName;\n    this.notqueued = true;\n    this.publishing = false;\n    this.selfSubscriber = selfSubscriber;\n    this.currentValue = this.oldValue = initialValue;\n  }\n\n  getValue() {\n    return this.currentValue;\n  }\n\n  setValue(newValue) {\n    let oldValue = this.currentValue;\n\n    if (!Object.is(newValue, oldValue)) {\n      this.oldValue = oldValue;\n      this.currentValue = newValue;\n\n      if (this.publishing && this.notqueued) {\n        if (this.taskQueue.flushing) {\n          this.call();\n        } else {\n          this.notqueued = false;\n          this.taskQueue.queueMicroTask(this);\n        }\n      }\n    }\n  }\n\n  call() {\n    let oldValue = this.oldValue;\n    let newValue = this.currentValue;\n\n    this.notqueued = true;\n\n    if (Object.is(newValue, oldValue)) {\n      return;\n    }\n\n    if (this.selfSubscriber) {\n      this.selfSubscriber(newValue, oldValue);\n    }\n\n    this.callSubscribers(newValue, oldValue);\n    this.oldValue = newValue;\n  }\n\n  subscribe(context, callable) {\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    this.removeSubscriber(context, callable);\n  }\n}) || _class17);\n\nfunction getObserver(instance, name) {\n  let lookup = instance.__observers__;\n\n  if (lookup === undefined) {\n    let ctor = Object.getPrototypeOf(instance).constructor;\n    let behavior = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].get(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, ctor);\n    if (!behavior.isInitialized) {\n      behavior.initialize(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__[\"Container\"].instance || new aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__[\"Container\"](), instance.constructor);\n    }\n\n    lookup = behavior.observerLocator.getOrCreateObserversLookup(instance);\n    behavior._ensurePropertiesDefined(instance, lookup);\n  }\n\n  return lookup[name];\n}\n\nlet BindableProperty = class BindableProperty {\n  constructor(nameOrConfig) {\n    if (typeof nameOrConfig === 'string') {\n      this.name = nameOrConfig;\n    } else {\n      Object.assign(this, nameOrConfig);\n    }\n\n    this.attribute = this.attribute || _hyphenate(this.name);\n    let defaultBindingMode = this.defaultBindingMode;\n    if (defaultBindingMode === null || defaultBindingMode === undefined) {\n      this.defaultBindingMode = aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"bindingMode\"].oneWay;\n    } else if (typeof defaultBindingMode === 'string') {\n      this.defaultBindingMode = aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"bindingMode\"][defaultBindingMode] || aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"bindingMode\"].oneWay;\n    }\n    this.changeHandler = this.changeHandler || null;\n    this.owner = null;\n    this.descriptor = null;\n  }\n\n  registerWith(target, behavior, descriptor) {\n    behavior.properties.push(this);\n    behavior.attributes[this.attribute] = this;\n    this.owner = behavior;\n\n    if (descriptor) {\n      this.descriptor = descriptor;\n      return this._configureDescriptor(descriptor);\n    }\n\n    return undefined;\n  }\n\n  _configureDescriptor(descriptor) {\n    let name = this.name;\n\n    descriptor.configurable = true;\n    descriptor.enumerable = true;\n\n    if ('initializer' in descriptor) {\n      this.defaultValue = descriptor.initializer;\n      delete descriptor.initializer;\n      delete descriptor.writable;\n    }\n\n    if ('value' in descriptor) {\n      this.defaultValue = descriptor.value;\n      delete descriptor.value;\n      delete descriptor.writable;\n    }\n\n    descriptor.get = function () {\n      return getObserver(this, name).getValue();\n    };\n\n    descriptor.set = function (value) {\n      getObserver(this, name).setValue(value);\n    };\n\n    descriptor.get.getObserver = function (obj) {\n      return getObserver(obj, name);\n    };\n\n    return descriptor;\n  }\n\n  defineOn(target, behavior) {\n    let name = this.name;\n    let handlerName;\n\n    if (this.changeHandler === null) {\n      handlerName = name + 'Changed';\n      if (handlerName in target.prototype) {\n        this.changeHandler = handlerName;\n      }\n    }\n\n    if (this.descriptor === null) {\n      Object.defineProperty(target.prototype, name, this._configureDescriptor(behavior, {}));\n    }\n  }\n\n  createObserver(viewModel) {\n    let selfSubscriber = null;\n    let defaultValue = this.defaultValue;\n    let changeHandlerName = this.changeHandler;\n    let name = this.name;\n    let initialValue;\n\n    if (this.hasOptions) {\n      return undefined;\n    }\n\n    if (changeHandlerName in viewModel) {\n      if ('propertyChanged' in viewModel) {\n        selfSubscriber = (newValue, oldValue) => {\n          viewModel[changeHandlerName](newValue, oldValue);\n          viewModel.propertyChanged(name, newValue, oldValue);\n        };\n      } else {\n        selfSubscriber = (newValue, oldValue) => viewModel[changeHandlerName](newValue, oldValue);\n      }\n    } else if ('propertyChanged' in viewModel) {\n      selfSubscriber = (newValue, oldValue) => viewModel.propertyChanged(name, newValue, oldValue);\n    } else if (changeHandlerName !== null) {\n      throw new Error(`Change handler ${changeHandlerName} was specified but not declared on the class.`);\n    }\n\n    if (defaultValue !== undefined) {\n      initialValue = typeof defaultValue === 'function' ? defaultValue.call(viewModel) : defaultValue;\n    }\n\n    return new BehaviorPropertyObserver(this.owner.taskQueue, viewModel, this.name, selfSubscriber, initialValue);\n  }\n\n  _initialize(viewModel, observerLookup, attributes, behaviorHandlesBind, boundProperties) {\n    let selfSubscriber;\n    let observer;\n    let attribute;\n    let defaultValue = this.defaultValue;\n\n    if (this.isDynamic) {\n      for (let key in attributes) {\n        this._createDynamicProperty(viewModel, observerLookup, behaviorHandlesBind, key, attributes[key], boundProperties);\n      }\n    } else if (!this.hasOptions) {\n      observer = observerLookup[this.name];\n\n      if (attributes !== null) {\n        selfSubscriber = observer.selfSubscriber;\n        attribute = attributes[this.attribute];\n\n        if (behaviorHandlesBind) {\n          observer.selfSubscriber = null;\n        }\n\n        if (typeof attribute === 'string') {\n          viewModel[this.name] = attribute;\n          observer.call();\n        } else if (attribute) {\n          boundProperties.push({ observer: observer, binding: attribute.createBinding(viewModel) });\n        } else if (defaultValue !== undefined) {\n          observer.call();\n        }\n\n        observer.selfSubscriber = selfSubscriber;\n      }\n\n      observer.publishing = true;\n    }\n  }\n\n  _createDynamicProperty(viewModel, observerLookup, behaviorHandlesBind, name, attribute, boundProperties) {\n    let changeHandlerName = name + 'Changed';\n    let selfSubscriber = null;\n    let observer;\n    let info;\n\n    if (changeHandlerName in viewModel) {\n      if ('propertyChanged' in viewModel) {\n        selfSubscriber = (newValue, oldValue) => {\n          viewModel[changeHandlerName](newValue, oldValue);\n          viewModel.propertyChanged(name, newValue, oldValue);\n        };\n      } else {\n        selfSubscriber = (newValue, oldValue) => viewModel[changeHandlerName](newValue, oldValue);\n      }\n    } else if ('propertyChanged' in viewModel) {\n      selfSubscriber = (newValue, oldValue) => viewModel.propertyChanged(name, newValue, oldValue);\n    }\n\n    observer = observerLookup[name] = new BehaviorPropertyObserver(this.owner.taskQueue, viewModel, name, selfSubscriber);\n\n    Object.defineProperty(viewModel, name, {\n      configurable: true,\n      enumerable: true,\n      get: observer.getValue.bind(observer),\n      set: observer.setValue.bind(observer)\n    });\n\n    if (behaviorHandlesBind) {\n      observer.selfSubscriber = null;\n    }\n\n    if (typeof attribute === 'string') {\n      viewModel[name] = attribute;\n      observer.call();\n    } else if (attribute) {\n      info = { observer: observer, binding: attribute.createBinding(viewModel) };\n      boundProperties.push(info);\n    }\n\n    observer.publishing = true;\n    observer.selfSubscriber = selfSubscriber;\n  }\n};\n\nlet lastProviderId = 0;\n\nfunction nextProviderId() {\n  return ++lastProviderId;\n}\n\nfunction doProcessContent() {\n  return true;\n}\nfunction doProcessAttributes() {}\n\nlet HtmlBehaviorResource = class HtmlBehaviorResource {\n  constructor() {\n    this.elementName = null;\n    this.attributeName = null;\n    this.attributeDefaultBindingMode = undefined;\n    this.liftsContent = false;\n    this.targetShadowDOM = false;\n    this.shadowDOMOptions = null;\n    this.processAttributes = doProcessAttributes;\n    this.processContent = doProcessContent;\n    this.usesShadowDOM = false;\n    this.childBindings = null;\n    this.hasDynamicOptions = false;\n    this.containerless = false;\n    this.properties = [];\n    this.attributes = {};\n    this.isInitialized = false;\n    this.primaryProperty = null;\n  }\n\n  static convention(name, existing) {\n    let behavior;\n\n    if (name.endsWith('CustomAttribute')) {\n      behavior = existing || new HtmlBehaviorResource();\n      behavior.attributeName = _hyphenate(name.substring(0, name.length - 15));\n    }\n\n    if (name.endsWith('CustomElement')) {\n      behavior = existing || new HtmlBehaviorResource();\n      behavior.elementName = _hyphenate(name.substring(0, name.length - 13));\n    }\n\n    return behavior;\n  }\n\n  addChildBinding(behavior) {\n    if (this.childBindings === null) {\n      this.childBindings = [];\n    }\n\n    this.childBindings.push(behavior);\n  }\n\n  initialize(container, target) {\n    let proto = target.prototype;\n    let properties = this.properties;\n    let attributeName = this.attributeName;\n    let attributeDefaultBindingMode = this.attributeDefaultBindingMode;\n    let i;\n    let ii;\n    let current;\n\n    if (this.isInitialized) {\n      return;\n    }\n\n    this.isInitialized = true;\n    target.__providerId__ = nextProviderId();\n\n    this.observerLocator = container.get(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"ObserverLocator\"]);\n    this.taskQueue = container.get(aurelia_task_queue__WEBPACK_IMPORTED_MODULE_7__[\"TaskQueue\"]);\n\n    this.target = target;\n    this.usesShadowDOM = this.targetShadowDOM && aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"FEATURE\"].shadowDOM;\n    this.handlesCreated = 'created' in proto;\n    this.handlesBind = 'bind' in proto;\n    this.handlesUnbind = 'unbind' in proto;\n    this.handlesAttached = 'attached' in proto;\n    this.handlesDetached = 'detached' in proto;\n    this.htmlName = this.elementName || this.attributeName;\n\n    if (attributeName !== null) {\n      if (properties.length === 0) {\n        new BindableProperty({\n          name: 'value',\n          changeHandler: 'valueChanged' in proto ? 'valueChanged' : null,\n          attribute: attributeName,\n          defaultBindingMode: attributeDefaultBindingMode\n        }).registerWith(target, this);\n      }\n\n      current = properties[0];\n\n      if (properties.length === 1 && current.name === 'value') {\n        current.isDynamic = current.hasOptions = this.hasDynamicOptions;\n        current.defineOn(target, this);\n      } else {\n        for (i = 0, ii = properties.length; i < ii; ++i) {\n          properties[i].defineOn(target, this);\n          if (properties[i].primaryProperty) {\n            if (this.primaryProperty) {\n              throw new Error('Only one bindable property on a custom element can be defined as the default');\n            }\n            this.primaryProperty = properties[i];\n          }\n        }\n\n        current = new BindableProperty({\n          name: 'value',\n          changeHandler: 'valueChanged' in proto ? 'valueChanged' : null,\n          attribute: attributeName,\n          defaultBindingMode: attributeDefaultBindingMode\n        });\n\n        current.hasOptions = true;\n        current.registerWith(target, this);\n      }\n    } else {\n      for (i = 0, ii = properties.length; i < ii; ++i) {\n        properties[i].defineOn(target, this);\n      }\n\n      this._copyInheritedProperties(container, target);\n    }\n  }\n\n  register(registry, name) {\n    if (this.attributeName !== null) {\n      registry.registerAttribute(name || this.attributeName, this, this.attributeName);\n\n      if (Array.isArray(this.aliases)) {\n        this.aliases.forEach(alias => {\n          registry.registerAttribute(alias, this, this.attributeName);\n        });\n      }\n    }\n\n    if (this.elementName !== null) {\n      registry.registerElement(name || this.elementName, this);\n    }\n  }\n\n  load(container, target, loadContext, viewStrategy, transientView) {\n    let options;\n\n    if (this.elementName !== null) {\n      viewStrategy = container.get(ViewLocator).getViewStrategy(viewStrategy || this.viewStrategy || target);\n      options = new ViewCompileInstruction(this.targetShadowDOM, true);\n\n      if (!viewStrategy.moduleId) {\n        viewStrategy.moduleId = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(target).moduleId;\n      }\n\n      return viewStrategy.loadViewFactory(container.get(ViewEngine), options, loadContext, target).then(viewFactory => {\n        if (!transientView || !this.viewFactory) {\n          this.viewFactory = viewFactory;\n        }\n\n        return viewFactory;\n      });\n    }\n\n    return Promise.resolve(this);\n  }\n\n  compile(compiler, resources, node, instruction, parentNode) {\n    if (this.liftsContent) {\n      if (!instruction.viewFactory) {\n        let template = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createElement('template');\n        let fragment = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createDocumentFragment();\n        let cacheSize = node.getAttribute('view-cache');\n        let part = node.getAttribute('part');\n\n        node.removeAttribute(instruction.originalAttrName);\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].replaceNode(template, node, parentNode);\n        fragment.appendChild(node);\n        instruction.viewFactory = compiler.compile(fragment, resources);\n\n        if (part) {\n          instruction.viewFactory.part = part;\n          node.removeAttribute('part');\n        }\n\n        if (cacheSize) {\n          instruction.viewFactory.setCacheSize(cacheSize);\n          node.removeAttribute('view-cache');\n        }\n\n        node = template;\n      }\n    } else if (this.elementName !== null) {\n      let partReplacements = {};\n\n      if (this.processContent(compiler, resources, node, instruction) && node.hasChildNodes()) {\n        let currentChild = node.firstChild;\n        let contentElement = this.usesShadowDOM ? null : aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createElement('au-content');\n        let nextSibling;\n        let toReplace;\n\n        while (currentChild) {\n          nextSibling = currentChild.nextSibling;\n\n          if (currentChild.tagName === 'TEMPLATE' && (toReplace = currentChild.getAttribute('replace-part'))) {\n            partReplacements[toReplace] = compiler.compile(currentChild, resources);\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].removeNode(currentChild, parentNode);\n            instruction.partReplacements = partReplacements;\n          } else if (contentElement !== null) {\n            if (currentChild.nodeType === 3 && _isAllWhitespace(currentChild)) {\n              aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].removeNode(currentChild, parentNode);\n            } else {\n              contentElement.appendChild(currentChild);\n            }\n          }\n\n          currentChild = nextSibling;\n        }\n\n        if (contentElement !== null && contentElement.hasChildNodes()) {\n          node.appendChild(contentElement);\n        }\n\n        instruction.skipContentProcessing = false;\n      } else {\n        instruction.skipContentProcessing = true;\n      }\n    } else if (!this.processContent(compiler, resources, node, instruction)) {\n      instruction.skipContentProcessing = true;\n    }\n\n    return node;\n  }\n\n  create(container, instruction, element, bindings) {\n    let viewHost;\n    let au = null;\n\n    instruction = instruction || BehaviorInstruction.normal;\n    element = element || null;\n    bindings = bindings || null;\n\n    if (this.elementName !== null && element) {\n      if (this.usesShadowDOM) {\n        viewHost = element.attachShadow(this.shadowDOMOptions);\n        container.registerInstance(aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].boundary, viewHost);\n      } else {\n        viewHost = element;\n        if (this.targetShadowDOM) {\n          container.registerInstance(aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].boundary, viewHost);\n        }\n      }\n    }\n\n    if (element !== null) {\n      element.au = au = element.au || {};\n    }\n\n    let viewModel = instruction.viewModel || container.get(this.target);\n    let controller = new Controller(this, instruction, viewModel, container);\n    let childBindings = this.childBindings;\n    let viewFactory;\n\n    if (this.liftsContent) {\n      au.controller = controller;\n    } else if (this.elementName !== null) {\n      viewFactory = instruction.viewFactory || this.viewFactory;\n      container.viewModel = viewModel;\n\n      if (viewFactory) {\n        controller.view = viewFactory.create(container, instruction, element);\n      }\n\n      if (element !== null) {\n        au.controller = controller;\n\n        if (controller.view) {\n          if (!this.usesShadowDOM && (element.childNodes.length === 1 || element.contentElement)) {\n            let contentElement = element.childNodes[0] || element.contentElement;\n            controller.view.contentView = { fragment: contentElement };\n            contentElement.parentNode && aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].removeNode(contentElement);\n          }\n\n          if (instruction.anchorIsContainer) {\n            if (childBindings !== null) {\n              for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n                controller.view.addBinding(childBindings[i].create(element, viewModel, controller));\n              }\n            }\n\n            controller.view.appendNodesTo(viewHost);\n          } else {\n            controller.view.insertNodesBefore(viewHost);\n          }\n        } else if (childBindings !== null) {\n          for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n            bindings.push(childBindings[i].create(element, viewModel, controller));\n          }\n        }\n      } else if (controller.view) {\n        controller.view.controller = controller;\n\n        if (childBindings !== null) {\n          for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n            controller.view.addBinding(childBindings[i].create(instruction.host, viewModel, controller));\n          }\n        }\n      } else if (childBindings !== null) {\n        for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n          bindings.push(childBindings[i].create(instruction.host, viewModel, controller));\n        }\n      }\n    } else if (childBindings !== null) {\n      for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n        bindings.push(childBindings[i].create(element, viewModel, controller));\n      }\n    }\n\n    if (au !== null) {\n      au[this.htmlName] = controller;\n    }\n\n    if (instruction.initiatedByBehavior && viewFactory) {\n      controller.view.created();\n    }\n\n    return controller;\n  }\n\n  _ensurePropertiesDefined(instance, lookup) {\n    let properties;\n    let i;\n    let ii;\n    let observer;\n\n    if ('__propertiesDefined__' in lookup) {\n      return;\n    }\n\n    lookup.__propertiesDefined__ = true;\n    properties = this.properties;\n\n    for (i = 0, ii = properties.length; i < ii; ++i) {\n      observer = properties[i].createObserver(instance);\n\n      if (observer !== undefined) {\n        lookup[observer.propertyName] = observer;\n      }\n    }\n  }\n\n  _copyInheritedProperties(container, target) {\n    let behavior;\n    let derived = target;\n\n    while (true) {\n      let proto = Object.getPrototypeOf(target.prototype);\n      target = proto && proto.constructor;\n      if (!target) {\n        return;\n      }\n      behavior = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, target);\n      if (behavior) {\n        break;\n      }\n    }\n    behavior.initialize(container, target);\n    for (let i = 0, ii = behavior.properties.length; i < ii; ++i) {\n      let prop = behavior.properties[i];\n\n      if (this.properties.some(p => p.name === prop.name)) {\n        continue;\n      }\n\n      new BindableProperty(prop).registerWith(derived, this);\n    }\n  }\n};\n\nfunction createChildObserverDecorator(selectorOrConfig, all) {\n  return function (target, key, descriptor) {\n    let actualTarget = typeof key === 'string' ? target.constructor : target;\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, actualTarget);\n\n    if (typeof selectorOrConfig === 'string') {\n      selectorOrConfig = {\n        selector: selectorOrConfig,\n        name: key\n      };\n    }\n\n    if (descriptor) {\n      descriptor.writable = true;\n      descriptor.configurable = true;\n    }\n\n    selectorOrConfig.all = all;\n    r.addChildBinding(new ChildObserver(selectorOrConfig));\n  };\n}\n\nfunction children(selectorOrConfig) {\n  return createChildObserverDecorator(selectorOrConfig, true);\n}\n\nfunction child(selectorOrConfig) {\n  return createChildObserverDecorator(selectorOrConfig, false);\n}\n\nlet ChildObserver = class ChildObserver {\n  constructor(config) {\n    this.name = config.name;\n    this.changeHandler = config.changeHandler || this.name + 'Changed';\n    this.selector = config.selector;\n    this.all = config.all;\n  }\n\n  create(viewHost, viewModel, controller) {\n    return new ChildObserverBinder(this.selector, viewHost, this.name, viewModel, controller, this.changeHandler, this.all);\n  }\n};\n\n\nconst noMutations = [];\n\nfunction trackMutation(groupedMutations, binder, record) {\n  let mutations = groupedMutations.get(binder);\n\n  if (!mutations) {\n    mutations = [];\n    groupedMutations.set(binder, mutations);\n  }\n\n  mutations.push(record);\n}\n\nfunction onChildChange(mutations, observer) {\n  let binders = observer.binders;\n  let bindersLength = binders.length;\n  let groupedMutations = new Map();\n\n  for (let i = 0, ii = mutations.length; i < ii; ++i) {\n    let record = mutations[i];\n    let added = record.addedNodes;\n    let removed = record.removedNodes;\n\n    for (let j = 0, jj = removed.length; j < jj; ++j) {\n      let node = removed[j];\n      if (node.nodeType === 1) {\n        for (let k = 0; k < bindersLength; ++k) {\n          let binder = binders[k];\n          if (binder.onRemove(node)) {\n            trackMutation(groupedMutations, binder, record);\n          }\n        }\n      }\n    }\n\n    for (let j = 0, jj = added.length; j < jj; ++j) {\n      let node = added[j];\n      if (node.nodeType === 1) {\n        for (let k = 0; k < bindersLength; ++k) {\n          let binder = binders[k];\n          if (binder.onAdd(node)) {\n            trackMutation(groupedMutations, binder, record);\n          }\n        }\n      }\n    }\n  }\n\n  groupedMutations.forEach((value, key) => {\n    if (key.changeHandler !== null) {\n      key.viewModel[key.changeHandler](value);\n    }\n  });\n}\n\nlet ChildObserverBinder = class ChildObserverBinder {\n  constructor(selector, viewHost, property, viewModel, controller, changeHandler, all) {\n    this.selector = selector;\n    this.viewHost = viewHost;\n    this.property = property;\n    this.viewModel = viewModel;\n    this.controller = controller;\n    this.changeHandler = changeHandler in viewModel ? changeHandler : null;\n    this.usesShadowDOM = controller.behavior.usesShadowDOM;\n    this.all = all;\n\n    if (!this.usesShadowDOM && controller.view && controller.view.contentView) {\n      this.contentView = controller.view.contentView;\n    } else {\n      this.contentView = null;\n    }\n  }\n\n  matches(element) {\n    if (element.matches(this.selector)) {\n      if (this.contentView === null) {\n        return true;\n      }\n\n      let contentView = this.contentView;\n      let assignedSlot = element.auAssignedSlot;\n\n      if (assignedSlot && assignedSlot.projectFromAnchors) {\n        let anchors = assignedSlot.projectFromAnchors;\n\n        for (let i = 0, ii = anchors.length; i < ii; ++i) {\n          if (anchors[i].auOwnerView === contentView) {\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      return element.auOwnerView === contentView;\n    }\n\n    return false;\n  }\n\n  bind(source) {\n    let viewHost = this.viewHost;\n    let viewModel = this.viewModel;\n    let observer = viewHost.__childObserver__;\n\n    if (!observer) {\n      observer = viewHost.__childObserver__ = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createMutationObserver(onChildChange);\n\n      let options = {\n        childList: true,\n        subtree: !this.usesShadowDOM\n      };\n\n      observer.observe(viewHost, options);\n      observer.binders = [];\n    }\n\n    observer.binders.push(this);\n\n    if (this.usesShadowDOM) {\n      let current = viewHost.firstElementChild;\n\n      if (this.all) {\n        let items = viewModel[this.property];\n        if (!items) {\n          items = viewModel[this.property] = [];\n        } else {\n          items.splice(0);\n        }\n\n        while (current) {\n          if (this.matches(current)) {\n            items.push(current.au && current.au.controller ? current.au.controller.viewModel : current);\n          }\n\n          current = current.nextElementSibling;\n        }\n\n        if (this.changeHandler !== null) {\n          this.viewModel[this.changeHandler](noMutations);\n        }\n      } else {\n        while (current) {\n          if (this.matches(current)) {\n            let value = current.au && current.au.controller ? current.au.controller.viewModel : current;\n            this.viewModel[this.property] = value;\n\n            if (this.changeHandler !== null) {\n              this.viewModel[this.changeHandler](value);\n            }\n\n            break;\n          }\n\n          current = current.nextElementSibling;\n        }\n      }\n    }\n  }\n\n  onRemove(element) {\n    if (this.matches(element)) {\n      let value = element.au && element.au.controller ? element.au.controller.viewModel : element;\n\n      if (this.all) {\n        let items = this.viewModel[this.property] || (this.viewModel[this.property] = []);\n        let index = items.indexOf(value);\n\n        if (index !== -1) {\n          items.splice(index, 1);\n        }\n\n        return true;\n      }\n\n      return false;\n    }\n\n    return false;\n  }\n\n  onAdd(element) {\n    if (this.matches(element)) {\n      let value = element.au && element.au.controller ? element.au.controller.viewModel : element;\n\n      if (this.all) {\n        let items = this.viewModel[this.property] || (this.viewModel[this.property] = []);\n\n        if (this.selector === '*') {\n          items.push(value);\n          return true;\n        }\n\n        let index = 0;\n        let prev = element.previousElementSibling;\n\n        while (prev) {\n          if (this.matches(prev)) {\n            index++;\n          }\n\n          prev = prev.previousElementSibling;\n        }\n\n        items.splice(index, 0, value);\n        return true;\n      }\n\n      this.viewModel[this.property] = value;\n\n      if (this.changeHandler !== null) {\n        this.viewModel[this.changeHandler](value);\n      }\n    }\n\n    return false;\n  }\n\n  unbind() {\n    if (this.viewHost.__childObserver__) {\n      this.viewHost.__childObserver__.disconnect();\n      this.viewHost.__childObserver__ = null;\n      this.viewModel[this.property] = null;\n    }\n  }\n};\n\n\nfunction remove(viewSlot, previous) {\n  return Array.isArray(previous) ? viewSlot.removeMany(previous, true) : viewSlot.remove(previous, true);\n}\n\nconst SwapStrategies = {\n  before(viewSlot, previous, callback) {\n    return previous === undefined ? callback() : callback().then(() => remove(viewSlot, previous));\n  },\n\n  with(viewSlot, previous, callback) {\n    return previous === undefined ? callback() : Promise.all([remove(viewSlot, previous), callback()]);\n  },\n\n  after(viewSlot, previous, callback) {\n    return Promise.resolve(viewSlot.removeAll(true)).then(callback);\n  }\n};\n\nfunction tryActivateViewModel(context) {\n  if (context.skipActivation || typeof context.viewModel.activate !== 'function') {\n    return Promise.resolve();\n  }\n\n  return context.viewModel.activate(context.model) || Promise.resolve();\n}\n\nlet CompositionEngine = (_dec10 = Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__[\"inject\"])(ViewEngine, ViewLocator), _dec10(_class18 = class CompositionEngine {\n  constructor(viewEngine, viewLocator) {\n    this.viewEngine = viewEngine;\n    this.viewLocator = viewLocator;\n  }\n\n  _swap(context, view) {\n    let swapStrategy = SwapStrategies[context.swapOrder] || SwapStrategies.after;\n    let previousViews = context.viewSlot.children.slice();\n\n    return swapStrategy(context.viewSlot, previousViews, () => {\n      return Promise.resolve(context.viewSlot.add(view)).then(() => {\n        if (context.currentController) {\n          context.currentController.unbind();\n        }\n      });\n    }).then(() => {\n      if (context.compositionTransactionNotifier) {\n        context.compositionTransactionNotifier.done();\n      }\n    });\n  }\n\n  _createControllerAndSwap(context) {\n    return this.createController(context).then(controller => {\n      if (context.compositionTransactionOwnershipToken) {\n        return context.compositionTransactionOwnershipToken.waitForCompositionComplete().then(() => {\n          controller.automate(context.overrideContext, context.owningView);\n\n          return this._swap(context, controller.view);\n        }).then(() => controller);\n      }\n\n      controller.automate(context.overrideContext, context.owningView);\n\n      return this._swap(context, controller.view).then(() => controller);\n    });\n  }\n\n  createController(context) {\n    let childContainer;\n    let viewModel;\n    let viewModelResource;\n\n    let m;\n\n    return this.ensureViewModel(context).then(tryActivateViewModel).then(() => {\n      childContainer = context.childContainer;\n      viewModel = context.viewModel;\n      viewModelResource = context.viewModelResource;\n      m = viewModelResource.metadata;\n\n      let viewStrategy = this.viewLocator.getViewStrategy(context.view || viewModel);\n\n      if (context.viewResources) {\n        viewStrategy.makeRelativeTo(context.viewResources.viewUrl);\n      }\n\n      return m.load(childContainer, viewModelResource.value, null, viewStrategy, true);\n    }).then(viewFactory => m.create(childContainer, BehaviorInstruction.dynamic(context.host, viewModel, viewFactory)));\n  }\n\n  ensureViewModel(context) {\n    let childContainer = context.childContainer = context.childContainer || context.container.createChild();\n\n    if (typeof context.viewModel === 'string') {\n      context.viewModel = context.viewResources ? context.viewResources.relativeToView(context.viewModel) : context.viewModel;\n\n      return this.viewEngine.importViewModelResource(context.viewModel).then(viewModelResource => {\n        childContainer.autoRegister(viewModelResource.value);\n\n        if (context.host) {\n          childContainer.registerInstance(aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].Element, context.host);\n        }\n\n        context.viewModel = childContainer.viewModel = childContainer.get(viewModelResource.value);\n        context.viewModelResource = viewModelResource;\n        return context;\n      });\n    }\n\n    let ctor = context.viewModel.constructor;\n    let isClass = typeof context.viewModel === 'function';\n    if (isClass) {\n      ctor = context.viewModel;\n      childContainer.autoRegister(ctor);\n    }\n    let m = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, ctor);\n\n    m.elementName = m.elementName || 'dynamic-element';\n\n    m.initialize(isClass ? childContainer : context.container || childContainer, ctor);\n\n    context.viewModelResource = { metadata: m, value: ctor };\n\n    if (context.host) {\n      childContainer.registerInstance(aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].Element, context.host);\n    }\n    childContainer.viewModel = context.viewModel = isClass ? childContainer.get(ctor) : context.viewModel;\n    return Promise.resolve(context);\n  }\n\n  compose(context) {\n    context.childContainer = context.childContainer || context.container.createChild();\n    context.view = this.viewLocator.getViewStrategy(context.view);\n\n    let transaction = context.childContainer.get(CompositionTransaction);\n    let compositionTransactionOwnershipToken = transaction.tryCapture();\n\n    if (compositionTransactionOwnershipToken) {\n      context.compositionTransactionOwnershipToken = compositionTransactionOwnershipToken;\n    } else {\n      context.compositionTransactionNotifier = transaction.enlist();\n    }\n\n    if (context.viewModel) {\n      return this._createControllerAndSwap(context);\n    } else if (context.view) {\n      if (context.viewResources) {\n        context.view.makeRelativeTo(context.viewResources.viewUrl);\n      }\n\n      return context.view.loadViewFactory(this.viewEngine, new ViewCompileInstruction()).then(viewFactory => {\n        let result = viewFactory.create(context.childContainer);\n        result.bind(context.bindingContext, context.overrideContext);\n\n        if (context.compositionTransactionOwnershipToken) {\n          return context.compositionTransactionOwnershipToken.waitForCompositionComplete().then(() => this._swap(context, result)).then(() => result);\n        }\n\n        return this._swap(context, result).then(() => result);\n      });\n    } else if (context.viewSlot) {\n      context.viewSlot.removeAll();\n\n      if (context.compositionTransactionNotifier) {\n        context.compositionTransactionNotifier.done();\n      }\n\n      return Promise.resolve(null);\n    }\n\n    return Promise.resolve(null);\n  }\n}) || _class18);\n\nlet ElementConfigResource = class ElementConfigResource {\n  initialize(container, target) {}\n\n  register(registry, name) {}\n\n  load(container, target) {\n    let config = new target();\n    let eventManager = container.get(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"EventManager\"]);\n    eventManager.registerElementConfig(config);\n  }\n};\n\nfunction resource(instanceOrConfig) {\n  return function (target) {\n    let isConfig = typeof instanceOrConfig === 'string' || Object.getPrototypeOf(instanceOrConfig) === Object.prototype;\n    if (isConfig) {\n      target.$resource = instanceOrConfig;\n    } else {\n      aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, instanceOrConfig, target);\n    }\n  };\n}\n\nfunction behavior(override) {\n  return function (target) {\n    if (override instanceof HtmlBehaviorResource) {\n      aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, override, target);\n    } else {\n      let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, target);\n      Object.assign(r, override);\n    }\n  };\n}\n\nfunction customElement(name) {\n  return function (target) {\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, target);\n    r.elementName = validateBehaviorName(name, 'custom element');\n  };\n}\n\nfunction customAttribute(name, defaultBindingMode, aliases) {\n  return function (target) {\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, target);\n    r.attributeName = validateBehaviorName(name, 'custom attribute');\n    r.attributeDefaultBindingMode = defaultBindingMode;\n    r.aliases = aliases;\n  };\n}\n\nfunction templateController(target) {\n  let deco = function (t) {\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, t);\n    r.liftsContent = true;\n  };\n\n  return target ? deco(target) : deco;\n}\n\nfunction bindable(nameOrConfigOrTarget, key, descriptor) {\n  let deco = function (target, key2, descriptor2) {\n    let actualTarget = key2 ? target.constructor : target;\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, actualTarget);\n    let prop;\n\n    if (key2) {\n      nameOrConfigOrTarget = nameOrConfigOrTarget || {};\n      nameOrConfigOrTarget.name = key2;\n    }\n\n    prop = new BindableProperty(nameOrConfigOrTarget);\n    return prop.registerWith(actualTarget, r, descriptor2);\n  };\n\n  if (!nameOrConfigOrTarget) {\n    return deco;\n  }\n\n  if (key) {\n    let target = nameOrConfigOrTarget;\n    nameOrConfigOrTarget = null;\n    return deco(target, key, descriptor);\n  }\n\n  return deco;\n}\n\nfunction dynamicOptions(target) {\n  let deco = function (t) {\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, t);\n    r.hasDynamicOptions = true;\n  };\n\n  return target ? deco(target) : deco;\n}\n\nconst defaultShadowDOMOptions = { mode: 'open' };\n\nfunction useShadowDOM(targetOrOptions) {\n  let options = typeof targetOrOptions === 'function' || !targetOrOptions ? defaultShadowDOMOptions : targetOrOptions;\n\n  let deco = function (t) {\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, t);\n    r.targetShadowDOM = true;\n    r.shadowDOMOptions = options;\n  };\n\n  return typeof targetOrOptions === 'function' ? deco(targetOrOptions) : deco;\n}\n\nfunction processAttributes(processor) {\n  return function (t) {\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, t);\n    r.processAttributes = function (compiler, resources, node, attributes, elementInstruction) {\n      try {\n        processor(compiler, resources, node, attributes, elementInstruction);\n      } catch (error) {\n        aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating').error(error);\n      }\n    };\n  };\n}\n\nfunction doNotProcessContent() {\n  return false;\n}\n\nfunction processContent(processor) {\n  return function (t) {\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, t);\n    r.processContent = processor ? function (compiler, resources, node, instruction) {\n      try {\n        return processor(compiler, resources, node, instruction);\n      } catch (error) {\n        aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating').error(error);\n        return false;\n      }\n    } : doNotProcessContent;\n  };\n}\n\nfunction containerless(target) {\n  let deco = function (t) {\n    let r = aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].getOrCreateOwn(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, HtmlBehaviorResource, t);\n    r.containerless = true;\n  };\n\n  return target ? deco(target) : deco;\n}\n\nfunction useViewStrategy(strategy) {\n  return function (target) {\n    aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(ViewLocator.viewStrategyMetadataKey, strategy, target);\n  };\n}\n\nfunction useView(path) {\n  return useViewStrategy(new RelativeViewStrategy(path));\n}\n\nfunction inlineView(markup, dependencies, dependencyBaseUrl) {\n  return useViewStrategy(new InlineViewStrategy(markup, dependencies, dependencyBaseUrl));\n}\n\nfunction noView(targetOrDependencies, dependencyBaseUrl) {\n  let target;\n  let dependencies;\n  if (typeof targetOrDependencies === 'function') {\n    target = targetOrDependencies;\n  } else {\n    dependencies = targetOrDependencies;\n    target = undefined;\n  }\n\n  let deco = function (t) {\n    aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(ViewLocator.viewStrategyMetadataKey, new NoViewStrategy(dependencies, dependencyBaseUrl), t);\n  };\n\n  return target ? deco(target) : deco;\n}\n\nfunction view(templateOrConfig) {\n  return function (target) {\n    target.$view = templateOrConfig;\n  };\n}\n\nfunction elementConfig(target) {\n  let deco = function (t) {\n    aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].resource, new ElementConfigResource(), t);\n  };\n\n  return target ? deco(target) : deco;\n}\n\nfunction viewResources(...resources) {\n  return function (target) {\n    aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"metadata\"].define(ViewEngine.viewModelRequireMetadataKey, resources, target);\n  };\n}\n\nlet TemplatingEngine = (_dec11 = Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__[\"inject\"])(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_6__[\"Container\"], ModuleAnalyzer, ViewCompiler, CompositionEngine), _dec11(_class19 = class TemplatingEngine {\n  constructor(container, moduleAnalyzer, viewCompiler, compositionEngine) {\n    this._container = container;\n    this._moduleAnalyzer = moduleAnalyzer;\n    this._viewCompiler = viewCompiler;\n    this._compositionEngine = compositionEngine;\n    container.registerInstance(Animator, Animator.instance = new Animator());\n  }\n\n  configureAnimator(animator) {\n    this._container.unregister(Animator);\n    this._container.registerInstance(Animator, Animator.instance = animator);\n  }\n\n  compose(context) {\n    return this._compositionEngine.compose(context);\n  }\n\n  enhance(instruction) {\n    if (instruction instanceof aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].Element) {\n      instruction = { element: instruction };\n    }\n\n    let compilerInstructions = { letExpressions: [] };\n    let resources = instruction.resources || this._container.get(ViewResources);\n\n    this._viewCompiler._compileNode(instruction.element, resources, compilerInstructions, instruction.element.parentNode, 'root', true);\n\n    let factory = new ViewFactory(instruction.element, compilerInstructions, resources);\n    let container = instruction.container || this._container.createChild();\n    let view = factory.create(container, BehaviorInstruction.enhance());\n\n    view.bind(instruction.bindingContext || {}, instruction.overrideContext);\n\n    view.firstChild = view.lastChild = view.fragment;\n    view.fragment = aurelia_pal__WEBPACK_IMPORTED_MODULE_2__[\"DOM\"].createDocumentFragment();\n    view.attached();\n\n    return view;\n  }\n}) || _class19);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS10ZW1wbGF0aW5nL2Rpc3QvZXMyMDE1L2F1cmVsaWEtdGVtcGxhdGluZy5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmcvZGlzdC9lczIwMTUvYXVyZWxpYS10ZW1wbGF0aW5nLmpzPzRhNDMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9jbGFzcywgX3RlbXAsIF9jbGFzczIsIF90ZW1wMiwgX2RlYywgX2NsYXNzMywgX2RlYzIsIF9jbGFzczQsIF9kZWMzLCBfY2xhc3M1LCBfZGVjNCwgX2NsYXNzNiwgX2RlYzUsIF9jbGFzczcsIF9kZWM2LCBfY2xhc3M4LCBfY2xhc3M5LCBfdGVtcDMsIF9jbGFzczEwLCBfdGVtcDQsIF9jbGFzczEyLCBfZGVjNywgX2NsYXNzMTQsIF9kZWM4LCBfY2xhc3MxNSwgX2NsYXNzMTYsIF90ZW1wNSwgX2RlYzksIF9jbGFzczE3LCBfZGVjMTAsIF9jbGFzczE4LCBfZGVjMTEsIF9jbGFzczE5O1xuXG5pbXBvcnQgKiBhcyBMb2dNYW5hZ2VyIGZyb20gJ2F1cmVsaWEtbG9nZ2luZyc7XG5pbXBvcnQgeyBtZXRhZGF0YSwgT3JpZ2luLCBwcm90b2NvbCB9IGZyb20gJ2F1cmVsaWEtbWV0YWRhdGEnO1xuaW1wb3J0IHsgRE9NLCBQTEFURk9STSwgRkVBVFVSRSB9IGZyb20gJ2F1cmVsaWEtcGFsJztcbmltcG9ydCB7IFRlbXBsYXRlUmVnaXN0cnlFbnRyeSwgTG9hZGVyIH0gZnJvbSAnYXVyZWxpYS1sb2FkZXInO1xuaW1wb3J0IHsgcmVsYXRpdmVUb0ZpbGUgfSBmcm9tICdhdXJlbGlhLXBhdGgnO1xuaW1wb3J0IHsgU2NvcGUsIEV4cHJlc3Npb24sIFZhbHVlQ29udmVydGVyUmVzb3VyY2UsIEJpbmRpbmdCZWhhdmlvclJlc291cmNlLCBjYW1lbENhc2UsIEJpbmRpbmcsIGNyZWF0ZU92ZXJyaWRlQ29udGV4dCwgc3Vic2NyaWJlckNvbGxlY3Rpb24sIGJpbmRpbmdNb2RlLCBPYnNlcnZlckxvY2F0b3IsIEV2ZW50TWFuYWdlciB9IGZyb20gJ2F1cmVsaWEtYmluZGluZyc7XG5pbXBvcnQgeyBDb250YWluZXIsIHJlc29sdmVyLCBpbmplY3QgfSBmcm9tICdhdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uJztcbmltcG9ydCB7IFRhc2tRdWV1ZSB9IGZyb20gJ2F1cmVsaWEtdGFzay1xdWV1ZSc7XG5cbmV4cG9ydCBjb25zdCBhbmltYXRpb25FdmVudCA9IHtcbiAgZW50ZXJCZWdpbjogJ2FuaW1hdGlvbjplbnRlcjpiZWdpbicsXG4gIGVudGVyQWN0aXZlOiAnYW5pbWF0aW9uOmVudGVyOmFjdGl2ZScsXG4gIGVudGVyRG9uZTogJ2FuaW1hdGlvbjplbnRlcjpkb25lJyxcbiAgZW50ZXJUaW1lb3V0OiAnYW5pbWF0aW9uOmVudGVyOnRpbWVvdXQnLFxuXG4gIGxlYXZlQmVnaW46ICdhbmltYXRpb246bGVhdmU6YmVnaW4nLFxuICBsZWF2ZUFjdGl2ZTogJ2FuaW1hdGlvbjpsZWF2ZTphY3RpdmUnLFxuICBsZWF2ZURvbmU6ICdhbmltYXRpb246bGVhdmU6ZG9uZScsXG4gIGxlYXZlVGltZW91dDogJ2FuaW1hdGlvbjpsZWF2ZTp0aW1lb3V0JyxcblxuICBzdGFnZ2VyTmV4dDogJ2FuaW1hdGlvbjpzdGFnZ2VyOm5leHQnLFxuXG4gIHJlbW92ZUNsYXNzQmVnaW46ICdhbmltYXRpb246cmVtb3ZlLWNsYXNzOmJlZ2luJyxcbiAgcmVtb3ZlQ2xhc3NBY3RpdmU6ICdhbmltYXRpb246cmVtb3ZlLWNsYXNzOmFjdGl2ZScsXG4gIHJlbW92ZUNsYXNzRG9uZTogJ2FuaW1hdGlvbjpyZW1vdmUtY2xhc3M6ZG9uZScsXG4gIHJlbW92ZUNsYXNzVGltZW91dDogJ2FuaW1hdGlvbjpyZW1vdmUtY2xhc3M6dGltZW91dCcsXG5cbiAgYWRkQ2xhc3NCZWdpbjogJ2FuaW1hdGlvbjphZGQtY2xhc3M6YmVnaW4nLFxuICBhZGRDbGFzc0FjdGl2ZTogJ2FuaW1hdGlvbjphZGQtY2xhc3M6YWN0aXZlJyxcbiAgYWRkQ2xhc3NEb25lOiAnYW5pbWF0aW9uOmFkZC1jbGFzczpkb25lJyxcbiAgYWRkQ2xhc3NUaW1lb3V0OiAnYW5pbWF0aW9uOmFkZC1jbGFzczp0aW1lb3V0JyxcblxuICBhbmltYXRlQmVnaW46ICdhbmltYXRpb246YW5pbWF0ZTpiZWdpbicsXG4gIGFuaW1hdGVBY3RpdmU6ICdhbmltYXRpb246YW5pbWF0ZTphY3RpdmUnLFxuICBhbmltYXRlRG9uZTogJ2FuaW1hdGlvbjphbmltYXRlOmRvbmUnLFxuICBhbmltYXRlVGltZW91dDogJ2FuaW1hdGlvbjphbmltYXRlOnRpbWVvdXQnLFxuXG4gIHNlcXVlbmNlQmVnaW46ICdhbmltYXRpb246c2VxdWVuY2U6YmVnaW4nLFxuICBzZXF1ZW5jZURvbmU6ICdhbmltYXRpb246c2VxdWVuY2U6ZG9uZSdcbn07XG5cbmV4cG9ydCBsZXQgQW5pbWF0b3IgPSBjbGFzcyBBbmltYXRvciB7XG4gIGVudGVyKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgfVxuXG4gIGxlYXZlKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgfVxuXG4gIHJlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xuICB9XG5cbiAgYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XG4gIH1cblxuICBhbmltYXRlKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xuICB9XG5cbiAgcnVuU2VxdWVuY2UoYW5pbWF0aW9ucykge31cblxuICByZWdpc3RlckVmZmVjdChlZmZlY3ROYW1lLCBwcm9wZXJ0aWVzKSB7fVxuXG4gIHVucmVnaXN0ZXJFZmZlY3QoZWZmZWN0TmFtZSkge31cbn07XG5cbmV4cG9ydCBsZXQgQ29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyID0gY2xhc3MgQ29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyIHtcbiAgY29uc3RydWN0b3Iob3duZXIpIHtcbiAgICB0aGlzLm93bmVyID0gb3duZXI7XG4gICAgdGhpcy5vd25lci5fY29tcG9zaXRpb25Db3VudCsrO1xuICB9XG5cbiAgZG9uZSgpIHtcbiAgICB0aGlzLm93bmVyLl9jb21wb3NpdGlvbkNvdW50LS07XG4gICAgdGhpcy5vd25lci5fdHJ5Q29tcGxldGVUcmFuc2FjdGlvbigpO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IENvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbiA9IGNsYXNzIENvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbiB7XG4gIGNvbnN0cnVjdG9yKG93bmVyKSB7XG4gICAgdGhpcy5vd25lciA9IG93bmVyO1xuICAgIHRoaXMub3duZXIuX293bmVyc2hpcFRva2VuID0gdGhpcztcbiAgICB0aGlzLnRoZW5hYmxlID0gdGhpcy5fY3JlYXRlVGhlbmFibGUoKTtcbiAgfVxuXG4gIHdhaXRGb3JDb21wb3NpdGlvbkNvbXBsZXRlKCkge1xuICAgIHRoaXMub3duZXIuX3RyeUNvbXBsZXRlVHJhbnNhY3Rpb24oKTtcbiAgICByZXR1cm4gdGhpcy50aGVuYWJsZTtcbiAgfVxuXG4gIHJlc29sdmUoKSB7XG4gICAgdGhpcy5fcmVzb2x2ZUNhbGxiYWNrKCk7XG4gIH1cblxuICBfY3JlYXRlVGhlbmFibGUoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHRoaXMuX3Jlc29sdmVDYWxsYmFjayA9IHJlc29sdmU7XG4gICAgfSk7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgQ29tcG9zaXRpb25UcmFuc2FjdGlvbiA9IGNsYXNzIENvbXBvc2l0aW9uVHJhbnNhY3Rpb24ge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9vd25lcnNoaXBUb2tlbiA9IG51bGw7XG4gICAgdGhpcy5fY29tcG9zaXRpb25Db3VudCA9IDA7XG4gIH1cblxuICB0cnlDYXB0dXJlKCkge1xuICAgIHJldHVybiB0aGlzLl9vd25lcnNoaXBUb2tlbiA9PT0gbnVsbCA/IG5ldyBDb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4odGhpcykgOiBudWxsO1xuICB9XG5cbiAgZW5saXN0KCkge1xuICAgIHJldHVybiBuZXcgQ29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyKHRoaXMpO1xuICB9XG5cbiAgX3RyeUNvbXBsZXRlVHJhbnNhY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2NvbXBvc2l0aW9uQ291bnQgPD0gMCkge1xuICAgICAgdGhpcy5fY29tcG9zaXRpb25Db3VudCA9IDA7XG5cbiAgICAgIGlmICh0aGlzLl9vd25lcnNoaXBUb2tlbiAhPT0gbnVsbCkge1xuICAgICAgICBsZXQgdG9rZW4gPSB0aGlzLl9vd25lcnNoaXBUb2tlbjtcbiAgICAgICAgdGhpcy5fb3duZXJzaGlwVG9rZW4gPSBudWxsO1xuICAgICAgICB0b2tlbi5yZXNvbHZlKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG5jb25zdCBjYXBpdGFsTWF0Y2hlciA9IC8oW0EtWl0pL2c7XG5cbmZ1bmN0aW9uIGFkZEh5cGhlbkFuZExvd2VyKGNoYXIpIHtcbiAgcmV0dXJuICctJyArIGNoYXIudG9Mb3dlckNhc2UoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9oeXBoZW5hdGUobmFtZSkge1xuICByZXR1cm4gKG5hbWUuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpKS5yZXBsYWNlKGNhcGl0YWxNYXRjaGVyLCBhZGRIeXBoZW5BbmRMb3dlcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfaXNBbGxXaGl0ZXNwYWNlKG5vZGUpIHtcbiAgcmV0dXJuICEobm9kZS5hdUludGVycG9sYXRpb25UYXJnZXQgfHwgL1teXFx0XFxuXFxyIF0vLnRlc3Qobm9kZS50ZXh0Q29udGVudCkpO1xufVxuXG5leHBvcnQgbGV0IFZpZXdFbmdpbmVIb29rc1Jlc291cmNlID0gY2xhc3MgVmlld0VuZ2luZUhvb2tzUmVzb3VyY2Uge1xuICBjb25zdHJ1Y3RvcigpIHt9XG5cbiAgaW5pdGlhbGl6ZShjb250YWluZXIsIHRhcmdldCkge1xuICAgIHRoaXMuaW5zdGFuY2UgPSBjb250YWluZXIuZ2V0KHRhcmdldCk7XG4gIH1cblxuICByZWdpc3RlcihyZWdpc3RyeSwgbmFtZSkge1xuICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyVmlld0VuZ2luZUhvb2tzKHRoaXMuaW5zdGFuY2UpO1xuICB9XG5cbiAgbG9hZChjb250YWluZXIsIHRhcmdldCkge31cblxuICBzdGF0aWMgY29udmVudGlvbihuYW1lKSB7XG4gICAgaWYgKG5hbWUuZW5kc1dpdGgoJ1ZpZXdFbmdpbmVIb29rcycpKSB7XG4gICAgICByZXR1cm4gbmV3IFZpZXdFbmdpbmVIb29rc1Jlc291cmNlKCk7XG4gICAgfVxuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gdmlld0VuZ2luZUhvb2tzKHRhcmdldCkge1xuICBsZXQgZGVjbyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgbWV0YWRhdGEuZGVmaW5lKG1ldGFkYXRhLnJlc291cmNlLCBuZXcgVmlld0VuZ2luZUhvb2tzUmVzb3VyY2UoKSwgdCk7XG4gIH07XG5cbiAgcmV0dXJuIHRhcmdldCA/IGRlY28odGFyZ2V0KSA6IGRlY287XG59XG5cbmV4cG9ydCBsZXQgRWxlbWVudEV2ZW50cyA9IChfdGVtcCA9IF9jbGFzcyA9IGNsYXNzIEVsZW1lbnRFdmVudHMge1xuXG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQpIHtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IHt9O1xuICB9XG5cbiAgX2VucXVldWVIYW5kbGVyKGhhbmRsZXIpIHtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbnNbaGFuZGxlci5ldmVudE5hbWVdID0gdGhpcy5zdWJzY3JpcHRpb25zW2hhbmRsZXIuZXZlbnROYW1lXSB8fCBbXTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbnNbaGFuZGxlci5ldmVudE5hbWVdLnB1c2goaGFuZGxlcik7XG4gIH1cblxuICBfZGVxdWV1ZUhhbmRsZXIoaGFuZGxlcikge1xuICAgIGxldCBpbmRleDtcbiAgICBsZXQgc3Vic2NyaXB0aW9ucyA9IHRoaXMuc3Vic2NyaXB0aW9uc1toYW5kbGVyLmV2ZW50TmFtZV07XG4gICAgaWYgKHN1YnNjcmlwdGlvbnMpIHtcbiAgICAgIGluZGV4ID0gc3Vic2NyaXB0aW9ucy5pbmRleE9mKGhhbmRsZXIpO1xuICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgc3Vic2NyaXB0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaGFuZGxlcjtcbiAgfVxuXG4gIHB1Ymxpc2goZXZlbnROYW1lLCBkZXRhaWwgPSB7fSwgYnViYmxlcyA9IHRydWUsIGNhbmNlbGFibGUgPSB0cnVlKSB7XG4gICAgbGV0IGV2ZW50ID0gRE9NLmNyZWF0ZUN1c3RvbUV2ZW50KGV2ZW50TmFtZSwgeyBjYW5jZWxhYmxlLCBidWJibGVzLCBkZXRhaWwgfSk7XG4gICAgdGhpcy5lbGVtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICB9XG5cbiAgc3Vic2NyaWJlKGV2ZW50TmFtZSwgaGFuZGxlciwgY2FwdHVyZU9yT3B0aW9ucykge1xuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaWYgKGNhcHR1cmVPck9wdGlvbnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjYXB0dXJlT3JPcHRpb25zID0gRWxlbWVudEV2ZW50cy5kZWZhdWx0TGlzdGVuZXJPcHRpb25zO1xuICAgICAgfVxuICAgICAgY29uc3QgZXZlbnRIYW5kbGVyID0gbmV3IEV2ZW50SGFuZGxlckltcGwodGhpcywgZXZlbnROYW1lLCBoYW5kbGVyLCBjYXB0dXJlT3JPcHRpb25zLCBmYWxzZSk7XG4gICAgICByZXR1cm4gZXZlbnRIYW5kbGVyO1xuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBzdWJzY3JpYmVPbmNlKGV2ZW50TmFtZSwgaGFuZGxlciwgY2FwdHVyZU9yT3B0aW9ucykge1xuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaWYgKGNhcHR1cmVPck9wdGlvbnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjYXB0dXJlT3JPcHRpb25zID0gRWxlbWVudEV2ZW50cy5kZWZhdWx0TGlzdGVuZXJPcHRpb25zO1xuICAgICAgfVxuICAgICAgY29uc3QgZXZlbnRIYW5kbGVyID0gbmV3IEV2ZW50SGFuZGxlckltcGwodGhpcywgZXZlbnROYW1lLCBoYW5kbGVyLCBjYXB0dXJlT3JPcHRpb25zLCB0cnVlKTtcbiAgICAgIHJldHVybiBldmVudEhhbmRsZXI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGRpc3Bvc2UoZXZlbnROYW1lKSB7XG4gICAgaWYgKGV2ZW50TmFtZSAmJiB0eXBlb2YgZXZlbnROYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgbGV0IHN1YnNjcmlwdGlvbnMgPSB0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnROYW1lXTtcbiAgICAgIGlmIChzdWJzY3JpcHRpb25zKSB7XG4gICAgICAgIHdoaWxlIChzdWJzY3JpcHRpb25zLmxlbmd0aCkge1xuICAgICAgICAgIGxldCBzdWJzY3JpcHRpb24gPSBzdWJzY3JpcHRpb25zLnBvcCgpO1xuICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5kaXNwb3NlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGlzcG9zZUFsbCgpO1xuICAgIH1cbiAgfVxuXG4gIGRpc3Bvc2VBbGwoKSB7XG4gICAgZm9yIChsZXQga2V5IGluIHRoaXMuc3Vic2NyaXB0aW9ucykge1xuICAgICAgdGhpcy5kaXNwb3NlKGtleSk7XG4gICAgfVxuICB9XG59LCBfY2xhc3MuZGVmYXVsdExpc3RlbmVyT3B0aW9ucyA9IHRydWUsIF90ZW1wKTtcblxubGV0IEV2ZW50SGFuZGxlckltcGwgPSBjbGFzcyBFdmVudEhhbmRsZXJJbXBsIHtcbiAgY29uc3RydWN0b3Iob3duZXIsIGV2ZW50TmFtZSwgaGFuZGxlciwgY2FwdHVyZU9yT3B0aW9ucywgb25jZSkge1xuICAgIHRoaXMub3duZXIgPSBvd25lcjtcbiAgICB0aGlzLmV2ZW50TmFtZSA9IGV2ZW50TmFtZTtcbiAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyO1xuXG4gICAgdGhpcy5jYXB0dXJlID0gdHlwZW9mIGNhcHR1cmVPck9wdGlvbnMgPT09ICdib29sZWFuJyA/IGNhcHR1cmVPck9wdGlvbnMgOiBjYXB0dXJlT3JPcHRpb25zLmNhcHR1cmU7XG4gICAgdGhpcy5idWJibGVzID0gIXRoaXMuY2FwdHVyZTtcbiAgICB0aGlzLmNhcHR1cmVPck9wdGlvbnMgPSBjYXB0dXJlT3JPcHRpb25zO1xuICAgIHRoaXMub25jZSA9IG9uY2U7XG4gICAgb3duZXIuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgdGhpcywgY2FwdHVyZU9yT3B0aW9ucyk7XG4gICAgb3duZXIuX2VucXVldWVIYW5kbGVyKHRoaXMpO1xuICB9XG5cbiAgaGFuZGxlRXZlbnQoZSkge1xuICAgIGNvbnN0IGZuID0gdGhpcy5oYW5kbGVyO1xuICAgIGZuKGUpO1xuICAgIGlmICh0aGlzLm9uY2UpIHtcbiAgICAgIHRoaXMuZGlzcG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIGRpc3Bvc2UoKSB7XG4gICAgdGhpcy5vd25lci5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIHRoaXMsIHRoaXMuY2FwdHVyZU9yT3B0aW9ucyk7XG4gICAgdGhpcy5vd25lci5fZGVxdWV1ZUhhbmRsZXIodGhpcyk7XG4gICAgdGhpcy5vd25lciA9IHRoaXMuaGFuZGxlciA9IG51bGw7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgUmVzb3VyY2VMb2FkQ29udGV4dCA9IGNsYXNzIFJlc291cmNlTG9hZENvbnRleHQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmRlcGVuZGVuY2llcyA9IHt9O1xuICB9XG5cbiAgYWRkRGVwZW5kZW5jeSh1cmwpIHtcbiAgICB0aGlzLmRlcGVuZGVuY2llc1t1cmxdID0gdHJ1ZTtcbiAgfVxuXG4gIGhhc0RlcGVuZGVuY3kodXJsKSB7XG4gICAgcmV0dXJuIHVybCBpbiB0aGlzLmRlcGVuZGVuY2llcztcbiAgfVxufTtcblxuZXhwb3J0IGxldCBWaWV3Q29tcGlsZUluc3RydWN0aW9uID0gY2xhc3MgVmlld0NvbXBpbGVJbnN0cnVjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHRhcmdldFNoYWRvd0RPTSA9IGZhbHNlLCBjb21waWxlU3Vycm9nYXRlID0gZmFsc2UpIHtcbiAgICB0aGlzLnRhcmdldFNoYWRvd0RPTSA9IHRhcmdldFNoYWRvd0RPTTtcbiAgICB0aGlzLmNvbXBpbGVTdXJyb2dhdGUgPSBjb21waWxlU3Vycm9nYXRlO1xuICAgIHRoaXMuYXNzb2NpYXRlZE1vZHVsZUlkID0gbnVsbDtcbiAgfVxufTtcblxuVmlld0NvbXBpbGVJbnN0cnVjdGlvbi5ub3JtYWwgPSBuZXcgVmlld0NvbXBpbGVJbnN0cnVjdGlvbigpO1xuXG5leHBvcnQgbGV0IEJlaGF2aW9ySW5zdHJ1Y3Rpb24gPSBjbGFzcyBCZWhhdmlvckluc3RydWN0aW9uIHtcbiAgc3RhdGljIGVuaGFuY2UoKSB7XG4gICAgbGV0IGluc3RydWN0aW9uID0gbmV3IEJlaGF2aW9ySW5zdHJ1Y3Rpb24oKTtcbiAgICBpbnN0cnVjdGlvbi5lbmhhbmNlID0gdHJ1ZTtcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH1cblxuICBzdGF0aWMgdW5pdFRlc3QodHlwZSwgYXR0cmlidXRlcykge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IG5ldyBCZWhhdmlvckluc3RydWN0aW9uKCk7XG4gICAgaW5zdHJ1Y3Rpb24udHlwZSA9IHR5cGU7XG4gICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXMgfHwge307XG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgc3RhdGljIGVsZW1lbnQobm9kZSwgdHlwZSkge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IG5ldyBCZWhhdmlvckluc3RydWN0aW9uKCk7XG4gICAgaW5zdHJ1Y3Rpb24udHlwZSA9IHR5cGU7XG4gICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcyA9IHt9O1xuICAgIGluc3RydWN0aW9uLmFuY2hvcklzQ29udGFpbmVyID0gIShub2RlLmhhc0F0dHJpYnV0ZSgnY29udGFpbmVybGVzcycpIHx8IHR5cGUuY29udGFpbmVybGVzcyk7XG4gICAgaW5zdHJ1Y3Rpb24uaW5pdGlhdGVkQnlCZWhhdmlvciA9IHRydWU7XG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgc3RhdGljIGF0dHJpYnV0ZShhdHRyTmFtZSwgdHlwZSkge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IG5ldyBCZWhhdmlvckluc3RydWN0aW9uKCk7XG4gICAgaW5zdHJ1Y3Rpb24uYXR0ck5hbWUgPSBhdHRyTmFtZTtcbiAgICBpbnN0cnVjdGlvbi50eXBlID0gdHlwZSB8fCBudWxsO1xuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXMgPSB7fTtcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH1cblxuICBzdGF0aWMgZHluYW1pYyhob3N0LCB2aWV3TW9kZWwsIHZpZXdGYWN0b3J5KSB7XG4gICAgbGV0IGluc3RydWN0aW9uID0gbmV3IEJlaGF2aW9ySW5zdHJ1Y3Rpb24oKTtcbiAgICBpbnN0cnVjdGlvbi5ob3N0ID0gaG9zdDtcbiAgICBpbnN0cnVjdGlvbi52aWV3TW9kZWwgPSB2aWV3TW9kZWw7XG4gICAgaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICBpbnN0cnVjdGlvbi5pbmhlcml0QmluZGluZ0NvbnRleHQgPSB0cnVlO1xuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfVxufTtcblxuY29uc3QgYmlQcm90byA9IEJlaGF2aW9ySW5zdHJ1Y3Rpb24ucHJvdG90eXBlO1xuYmlQcm90by5pbml0aWF0ZWRCeUJlaGF2aW9yID0gZmFsc2U7XG5iaVByb3RvLmVuaGFuY2UgPSBmYWxzZTtcbmJpUHJvdG8ucGFydFJlcGxhY2VtZW50cyA9IG51bGw7XG5iaVByb3RvLnZpZXdGYWN0b3J5ID0gbnVsbDtcbmJpUHJvdG8ub3JpZ2luYWxBdHRyTmFtZSA9IG51bGw7XG5iaVByb3RvLnNraXBDb250ZW50UHJvY2Vzc2luZyA9IGZhbHNlO1xuYmlQcm90by5jb250ZW50RmFjdG9yeSA9IG51bGw7XG5iaVByb3RvLnZpZXdNb2RlbCA9IG51bGw7XG5iaVByb3RvLmFuY2hvcklzQ29udGFpbmVyID0gZmFsc2U7XG5iaVByb3RvLmhvc3QgPSBudWxsO1xuYmlQcm90by5hdHRyaWJ1dGVzID0gbnVsbDtcbmJpUHJvdG8udHlwZSA9IG51bGw7XG5iaVByb3RvLmF0dHJOYW1lID0gbnVsbDtcbmJpUHJvdG8uaW5oZXJpdEJpbmRpbmdDb250ZXh0ID0gZmFsc2U7XG5cbkJlaGF2aW9ySW5zdHJ1Y3Rpb24ubm9ybWFsID0gbmV3IEJlaGF2aW9ySW5zdHJ1Y3Rpb24oKTtcblxuZXhwb3J0IGxldCBUYXJnZXRJbnN0cnVjdGlvbiA9IChfdGVtcDIgPSBfY2xhc3MyID0gY2xhc3MgVGFyZ2V0SW5zdHJ1Y3Rpb24ge1xuICBzdGF0aWMgc2hhZG93U2xvdChwYXJlbnRJbmplY3RvcklkKSB7XG4gICAgbGV0IGluc3RydWN0aW9uID0gbmV3IFRhcmdldEluc3RydWN0aW9uKCk7XG4gICAgaW5zdHJ1Y3Rpb24ucGFyZW50SW5qZWN0b3JJZCA9IHBhcmVudEluamVjdG9ySWQ7XG4gICAgaW5zdHJ1Y3Rpb24uc2hhZG93U2xvdCA9IHRydWU7XG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgc3RhdGljIGNvbnRlbnRFeHByZXNzaW9uKGV4cHJlc3Npb24pIHtcbiAgICBsZXQgaW5zdHJ1Y3Rpb24gPSBuZXcgVGFyZ2V0SW5zdHJ1Y3Rpb24oKTtcbiAgICBpbnN0cnVjdGlvbi5jb250ZW50RXhwcmVzc2lvbiA9IGV4cHJlc3Npb247XG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgc3RhdGljIGxldEVsZW1lbnQoZXhwcmVzc2lvbnMpIHtcbiAgICBsZXQgaW5zdHJ1Y3Rpb24gPSBuZXcgVGFyZ2V0SW5zdHJ1Y3Rpb24oKTtcbiAgICBpbnN0cnVjdGlvbi5leHByZXNzaW9ucyA9IGV4cHJlc3Npb25zO1xuICAgIGluc3RydWN0aW9uLmxldEVsZW1lbnQgPSB0cnVlO1xuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfVxuXG4gIHN0YXRpYyBsaWZ0aW5nKHBhcmVudEluamVjdG9ySWQsIGxpZnRpbmdJbnN0cnVjdGlvbikge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IG5ldyBUYXJnZXRJbnN0cnVjdGlvbigpO1xuICAgIGluc3RydWN0aW9uLnBhcmVudEluamVjdG9ySWQgPSBwYXJlbnRJbmplY3RvcklkO1xuICAgIGluc3RydWN0aW9uLmV4cHJlc3Npb25zID0gVGFyZ2V0SW5zdHJ1Y3Rpb24ubm9FeHByZXNzaW9ucztcbiAgICBpbnN0cnVjdGlvbi5iZWhhdmlvckluc3RydWN0aW9ucyA9IFtsaWZ0aW5nSW5zdHJ1Y3Rpb25dO1xuICAgIGluc3RydWN0aW9uLnZpZXdGYWN0b3J5ID0gbGlmdGluZ0luc3RydWN0aW9uLnZpZXdGYWN0b3J5O1xuICAgIGluc3RydWN0aW9uLnByb3ZpZGVycyA9IFtsaWZ0aW5nSW5zdHJ1Y3Rpb24udHlwZS50YXJnZXRdO1xuICAgIGluc3RydWN0aW9uLmxpZnRpbmcgPSB0cnVlO1xuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfVxuXG4gIHN0YXRpYyBub3JtYWwoaW5qZWN0b3JJZCwgcGFyZW50SW5qZWN0b3JJZCwgcHJvdmlkZXJzLCBiZWhhdmlvckluc3RydWN0aW9ucywgZXhwcmVzc2lvbnMsIGVsZW1lbnRJbnN0cnVjdGlvbikge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IG5ldyBUYXJnZXRJbnN0cnVjdGlvbigpO1xuICAgIGluc3RydWN0aW9uLmluamVjdG9ySWQgPSBpbmplY3RvcklkO1xuICAgIGluc3RydWN0aW9uLnBhcmVudEluamVjdG9ySWQgPSBwYXJlbnRJbmplY3RvcklkO1xuICAgIGluc3RydWN0aW9uLnByb3ZpZGVycyA9IHByb3ZpZGVycztcbiAgICBpbnN0cnVjdGlvbi5iZWhhdmlvckluc3RydWN0aW9ucyA9IGJlaGF2aW9ySW5zdHJ1Y3Rpb25zO1xuICAgIGluc3RydWN0aW9uLmV4cHJlc3Npb25zID0gZXhwcmVzc2lvbnM7XG4gICAgaW5zdHJ1Y3Rpb24uYW5jaG9ySXNDb250YWluZXIgPSBlbGVtZW50SW5zdHJ1Y3Rpb24gPyBlbGVtZW50SW5zdHJ1Y3Rpb24uYW5jaG9ySXNDb250YWluZXIgOiB0cnVlO1xuICAgIGluc3RydWN0aW9uLmVsZW1lbnRJbnN0cnVjdGlvbiA9IGVsZW1lbnRJbnN0cnVjdGlvbjtcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH1cblxuICBzdGF0aWMgc3Vycm9nYXRlKHByb3ZpZGVycywgYmVoYXZpb3JJbnN0cnVjdGlvbnMsIGV4cHJlc3Npb25zLCB2YWx1ZXMpIHtcbiAgICBsZXQgaW5zdHJ1Y3Rpb24gPSBuZXcgVGFyZ2V0SW5zdHJ1Y3Rpb24oKTtcbiAgICBpbnN0cnVjdGlvbi5leHByZXNzaW9ucyA9IGV4cHJlc3Npb25zO1xuICAgIGluc3RydWN0aW9uLmJlaGF2aW9ySW5zdHJ1Y3Rpb25zID0gYmVoYXZpb3JJbnN0cnVjdGlvbnM7XG4gICAgaW5zdHJ1Y3Rpb24ucHJvdmlkZXJzID0gcHJvdmlkZXJzO1xuICAgIGluc3RydWN0aW9uLnZhbHVlcyA9IHZhbHVlcztcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH1cbn0sIF9jbGFzczIubm9FeHByZXNzaW9ucyA9IE9iamVjdC5mcmVlemUoW10pLCBfdGVtcDIpO1xuXG5jb25zdCB0aVByb3RvID0gVGFyZ2V0SW5zdHJ1Y3Rpb24ucHJvdG90eXBlO1xuXG50aVByb3RvLmluamVjdG9ySWQgPSBudWxsO1xudGlQcm90by5wYXJlbnRJbmplY3RvcklkID0gbnVsbDtcblxudGlQcm90by5zaGFkb3dTbG90ID0gZmFsc2U7XG50aVByb3RvLnNsb3ROYW1lID0gbnVsbDtcbnRpUHJvdG8uc2xvdEZhbGxiYWNrRmFjdG9yeSA9IG51bGw7XG5cbnRpUHJvdG8uY29udGVudEV4cHJlc3Npb24gPSBudWxsO1xudGlQcm90by5sZXRFbGVtZW50ID0gZmFsc2U7XG5cbnRpUHJvdG8uZXhwcmVzc2lvbnMgPSBudWxsO1xudGlQcm90by5leHByZXNzaW9ucyA9IG51bGw7XG50aVByb3RvLnByb3ZpZGVycyA9IG51bGw7XG5cbnRpUHJvdG8udmlld0ZhY3RvcnkgPSBudWxsO1xuXG50aVByb3RvLmFuY2hvcklzQ29udGFpbmVyID0gZmFsc2U7XG50aVByb3RvLmVsZW1lbnRJbnN0cnVjdGlvbiA9IG51bGw7XG50aVByb3RvLmxpZnRpbmcgPSBmYWxzZTtcblxudGlQcm90by52YWx1ZXMgPSBudWxsO1xuXG5leHBvcnQgY29uc3Qgdmlld1N0cmF0ZWd5ID0gcHJvdG9jb2wuY3JlYXRlKCdhdXJlbGlhOnZpZXctc3RyYXRlZ3knLCB7XG4gIHZhbGlkYXRlKHRhcmdldCkge1xuICAgIGlmICghKHR5cGVvZiB0YXJnZXQubG9hZFZpZXdGYWN0b3J5ID09PSAnZnVuY3Rpb24nKSkge1xuICAgICAgcmV0dXJuICdWaWV3IHN0cmF0ZWdpZXMgbXVzdCBpbXBsZW1lbnQ6IGxvYWRWaWV3RmFjdG9yeSh2aWV3RW5naW5lOiBWaWV3RW5naW5lLCBjb21waWxlSW5zdHJ1Y3Rpb246IFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0PzogUmVzb3VyY2VMb2FkQ29udGV4dCk6IFByb21pc2U8Vmlld0ZhY3Rvcnk+JztcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcbiAgY29tcG9zZSh0YXJnZXQpIHtcbiAgICBpZiAoISh0eXBlb2YgdGFyZ2V0Lm1ha2VSZWxhdGl2ZVRvID09PSAnZnVuY3Rpb24nKSkge1xuICAgICAgdGFyZ2V0Lm1ha2VSZWxhdGl2ZVRvID0gUExBVEZPUk0ubm9vcDtcbiAgICB9XG4gIH1cbn0pO1xuXG5leHBvcnQgbGV0IFJlbGF0aXZlVmlld1N0cmF0ZWd5ID0gKF9kZWMgPSB2aWV3U3RyYXRlZ3koKSwgX2RlYyhfY2xhc3MzID0gY2xhc3MgUmVsYXRpdmVWaWV3U3RyYXRlZ3kge1xuICBjb25zdHJ1Y3RvcihwYXRoKSB7XG4gICAgdGhpcy5wYXRoID0gcGF0aDtcbiAgICB0aGlzLmFic29sdXRlUGF0aCA9IG51bGw7XG4gIH1cblxuICBsb2FkVmlld0ZhY3Rvcnkodmlld0VuZ2luZSwgY29tcGlsZUluc3RydWN0aW9uLCBsb2FkQ29udGV4dCwgdGFyZ2V0KSB7XG4gICAgaWYgKHRoaXMuYWJzb2x1dGVQYXRoID09PSBudWxsICYmIHRoaXMubW9kdWxlSWQpIHtcbiAgICAgIHRoaXMuYWJzb2x1dGVQYXRoID0gcmVsYXRpdmVUb0ZpbGUodGhpcy5wYXRoLCB0aGlzLm1vZHVsZUlkKTtcbiAgICB9XG5cbiAgICBjb21waWxlSW5zdHJ1Y3Rpb24uYXNzb2NpYXRlZE1vZHVsZUlkID0gdGhpcy5tb2R1bGVJZDtcbiAgICByZXR1cm4gdmlld0VuZ2luZS5sb2FkVmlld0ZhY3RvcnkodGhpcy5hYnNvbHV0ZVBhdGggfHwgdGhpcy5wYXRoLCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0LCB0YXJnZXQpO1xuICB9XG5cbiAgbWFrZVJlbGF0aXZlVG8oZmlsZSkge1xuICAgIGlmICh0aGlzLmFic29sdXRlUGF0aCA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5hYnNvbHV0ZVBhdGggPSByZWxhdGl2ZVRvRmlsZSh0aGlzLnBhdGgsIGZpbGUpO1xuICAgIH1cbiAgfVxufSkgfHwgX2NsYXNzMyk7XG5cbmV4cG9ydCBsZXQgQ29udmVudGlvbmFsVmlld1N0cmF0ZWd5ID0gKF9kZWMyID0gdmlld1N0cmF0ZWd5KCksIF9kZWMyKF9jbGFzczQgPSBjbGFzcyBDb252ZW50aW9uYWxWaWV3U3RyYXRlZ3kge1xuICBjb25zdHJ1Y3Rvcih2aWV3TG9jYXRvciwgb3JpZ2luKSB7XG4gICAgdGhpcy5tb2R1bGVJZCA9IG9yaWdpbi5tb2R1bGVJZDtcbiAgICB0aGlzLnZpZXdVcmwgPSB2aWV3TG9jYXRvci5jb252ZXJ0T3JpZ2luVG9WaWV3VXJsKG9yaWdpbik7XG4gIH1cblxuICBsb2FkVmlld0ZhY3Rvcnkodmlld0VuZ2luZSwgY29tcGlsZUluc3RydWN0aW9uLCBsb2FkQ29udGV4dCwgdGFyZ2V0KSB7XG4gICAgY29tcGlsZUluc3RydWN0aW9uLmFzc29jaWF0ZWRNb2R1bGVJZCA9IHRoaXMubW9kdWxlSWQ7XG4gICAgcmV0dXJuIHZpZXdFbmdpbmUubG9hZFZpZXdGYWN0b3J5KHRoaXMudmlld1VybCwgY29tcGlsZUluc3RydWN0aW9uLCBsb2FkQ29udGV4dCwgdGFyZ2V0KTtcbiAgfVxufSkgfHwgX2NsYXNzNCk7XG5cbmV4cG9ydCBsZXQgTm9WaWV3U3RyYXRlZ3kgPSAoX2RlYzMgPSB2aWV3U3RyYXRlZ3koKSwgX2RlYzMoX2NsYXNzNSA9IGNsYXNzIE5vVmlld1N0cmF0ZWd5IHtcbiAgY29uc3RydWN0b3IoZGVwZW5kZW5jaWVzLCBkZXBlbmRlbmN5QmFzZVVybCkge1xuICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gZGVwZW5kZW5jaWVzIHx8IG51bGw7XG4gICAgdGhpcy5kZXBlbmRlbmN5QmFzZVVybCA9IGRlcGVuZGVuY3lCYXNlVXJsIHx8ICcnO1xuICB9XG5cbiAgbG9hZFZpZXdGYWN0b3J5KHZpZXdFbmdpbmUsIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQsIHRhcmdldCkge1xuICAgIGxldCBlbnRyeSA9IHRoaXMuZW50cnk7XG4gICAgbGV0IGRlcGVuZGVuY2llcyA9IHRoaXMuZGVwZW5kZW5jaWVzO1xuXG4gICAgaWYgKGVudHJ5ICYmIGVudHJ5LmZhY3RvcnlJc1JlYWR5KSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cblxuICAgIHRoaXMuZW50cnkgPSBlbnRyeSA9IG5ldyBUZW1wbGF0ZVJlZ2lzdHJ5RW50cnkodGhpcy5tb2R1bGVJZCB8fCB0aGlzLmRlcGVuZGVuY3lCYXNlVXJsKTtcblxuICAgIGVudHJ5LmRlcGVuZGVuY2llcyA9IFtdO1xuICAgIGVudHJ5LnRlbXBsYXRlSXNMb2FkZWQgPSB0cnVlO1xuXG4gICAgaWYgKGRlcGVuZGVuY2llcyAhPT0gbnVsbCkge1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGVwZW5kZW5jaWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgbGV0IGN1cnJlbnQgPSBkZXBlbmRlbmNpZXNbaV07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50ID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgY3VycmVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGVudHJ5LmFkZERlcGVuZGVuY3koY3VycmVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZW50cnkuYWRkRGVwZW5kZW5jeShjdXJyZW50LmZyb20sIGN1cnJlbnQuYXMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29tcGlsZUluc3RydWN0aW9uLmFzc29jaWF0ZWRNb2R1bGVJZCA9IHRoaXMubW9kdWxlSWQ7XG5cbiAgICByZXR1cm4gdmlld0VuZ2luZS5sb2FkVmlld0ZhY3RvcnkoZW50cnksIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQsIHRhcmdldCk7XG4gIH1cbn0pIHx8IF9jbGFzczUpO1xuXG5leHBvcnQgbGV0IFRlbXBsYXRlUmVnaXN0cnlWaWV3U3RyYXRlZ3kgPSAoX2RlYzQgPSB2aWV3U3RyYXRlZ3koKSwgX2RlYzQoX2NsYXNzNiA9IGNsYXNzIFRlbXBsYXRlUmVnaXN0cnlWaWV3U3RyYXRlZ3kge1xuICBjb25zdHJ1Y3Rvcihtb2R1bGVJZCwgZW50cnkpIHtcbiAgICB0aGlzLm1vZHVsZUlkID0gbW9kdWxlSWQ7XG4gICAgdGhpcy5lbnRyeSA9IGVudHJ5O1xuICB9XG5cbiAgbG9hZFZpZXdGYWN0b3J5KHZpZXdFbmdpbmUsIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQsIHRhcmdldCkge1xuICAgIGxldCBlbnRyeSA9IHRoaXMuZW50cnk7XG5cbiAgICBpZiAoZW50cnkuZmFjdG9yeUlzUmVhZHkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZW50cnkuZmFjdG9yeSk7XG4gICAgfVxuXG4gICAgY29tcGlsZUluc3RydWN0aW9uLmFzc29jaWF0ZWRNb2R1bGVJZCA9IHRoaXMubW9kdWxlSWQ7XG4gICAgcmV0dXJuIHZpZXdFbmdpbmUubG9hZFZpZXdGYWN0b3J5KGVudHJ5LCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0LCB0YXJnZXQpO1xuICB9XG59KSB8fCBfY2xhc3M2KTtcblxuZXhwb3J0IGxldCBJbmxpbmVWaWV3U3RyYXRlZ3kgPSAoX2RlYzUgPSB2aWV3U3RyYXRlZ3koKSwgX2RlYzUoX2NsYXNzNyA9IGNsYXNzIElubGluZVZpZXdTdHJhdGVneSB7XG4gIGNvbnN0cnVjdG9yKG1hcmt1cCwgZGVwZW5kZW5jaWVzLCBkZXBlbmRlbmN5QmFzZVVybCkge1xuICAgIHRoaXMubWFya3VwID0gbWFya3VwO1xuICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gZGVwZW5kZW5jaWVzIHx8IG51bGw7XG4gICAgdGhpcy5kZXBlbmRlbmN5QmFzZVVybCA9IGRlcGVuZGVuY3lCYXNlVXJsIHx8ICcnO1xuICB9XG5cbiAgbG9hZFZpZXdGYWN0b3J5KHZpZXdFbmdpbmUsIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQsIHRhcmdldCkge1xuICAgIGxldCBlbnRyeSA9IHRoaXMuZW50cnk7XG4gICAgbGV0IGRlcGVuZGVuY2llcyA9IHRoaXMuZGVwZW5kZW5jaWVzO1xuXG4gICAgaWYgKGVudHJ5ICYmIGVudHJ5LmZhY3RvcnlJc1JlYWR5KSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGVudHJ5LmZhY3RvcnkpO1xuICAgIH1cblxuICAgIHRoaXMuZW50cnkgPSBlbnRyeSA9IG5ldyBUZW1wbGF0ZVJlZ2lzdHJ5RW50cnkodGhpcy5tb2R1bGVJZCB8fCB0aGlzLmRlcGVuZGVuY3lCYXNlVXJsKTtcbiAgICBlbnRyeS50ZW1wbGF0ZSA9IERPTS5jcmVhdGVUZW1wbGF0ZUZyb21NYXJrdXAodGhpcy5tYXJrdXApO1xuXG4gICAgaWYgKGRlcGVuZGVuY2llcyAhPT0gbnVsbCkge1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gZGVwZW5kZW5jaWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgbGV0IGN1cnJlbnQgPSBkZXBlbmRlbmNpZXNbaV07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50ID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgY3VycmVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGVudHJ5LmFkZERlcGVuZGVuY3koY3VycmVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZW50cnkuYWRkRGVwZW5kZW5jeShjdXJyZW50LmZyb20sIGN1cnJlbnQuYXMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29tcGlsZUluc3RydWN0aW9uLmFzc29jaWF0ZWRNb2R1bGVJZCA9IHRoaXMubW9kdWxlSWQ7XG4gICAgcmV0dXJuIHZpZXdFbmdpbmUubG9hZFZpZXdGYWN0b3J5KGVudHJ5LCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0LCB0YXJnZXQpO1xuICB9XG59KSB8fCBfY2xhc3M3KTtcblxuZXhwb3J0IGxldCBTdGF0aWNWaWV3U3RyYXRlZ3kgPSAoX2RlYzYgPSB2aWV3U3RyYXRlZ3koKSwgX2RlYzYoX2NsYXNzOCA9IGNsYXNzIFN0YXRpY1ZpZXdTdHJhdGVneSB7XG5cbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdzdHJpbmcnIHx8IGNvbmZpZyBpbnN0YW5jZW9mIERPTS5FbGVtZW50ICYmIGNvbmZpZy50YWdOYW1lID09PSAnVEVNUExBVEUnKSB7XG4gICAgICBjb25maWcgPSB7XG4gICAgICAgIHRlbXBsYXRlOiBjb25maWdcbiAgICAgIH07XG4gICAgfVxuICAgIHRoaXMudGVtcGxhdGUgPSBjb25maWcudGVtcGxhdGU7XG4gICAgdGhpcy5kZXBlbmRlbmNpZXMgPSBjb25maWcuZGVwZW5kZW5jaWVzIHx8IFtdO1xuICAgIHRoaXMuZmFjdG9yeUlzUmVhZHkgPSBmYWxzZTtcbiAgICB0aGlzLm9uUmVhZHkgPSBudWxsO1xuICAgIHRoaXMubW9kdWxlSWQgPSAndW5kZWZpbmVkJztcbiAgfVxuXG4gIGxvYWRWaWV3RmFjdG9yeSh2aWV3RW5naW5lLCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0LCB0YXJnZXQpIHtcbiAgICBpZiAodGhpcy5mYWN0b3J5SXNSZWFkeSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLmZhY3RvcnkpO1xuICAgIH1cbiAgICBsZXQgZGVwcyA9IHRoaXMuZGVwZW5kZW5jaWVzO1xuICAgIGRlcHMgPSB0eXBlb2YgZGVwcyA9PT0gJ2Z1bmN0aW9uJyA/IGRlcHMoKSA6IGRlcHM7XG4gICAgZGVwcyA9IGRlcHMgPyBkZXBzIDogW107XG4gICAgZGVwcyA9IEFycmF5LmlzQXJyYXkoZGVwcykgPyBkZXBzIDogW2RlcHNdO1xuXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKGRlcHMpLnRoZW4oZGVwZW5kZW5jaWVzID0+IHtcbiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHZpZXdFbmdpbmUuY29udGFpbmVyO1xuICAgICAgY29uc3QgYXBwUmVzb3VyY2VzID0gdmlld0VuZ2luZS5hcHBSZXNvdXJjZXM7XG4gICAgICBjb25zdCB2aWV3Q29tcGlsZXIgPSB2aWV3RW5naW5lLnZpZXdDb21waWxlcjtcbiAgICAgIGNvbnN0IHZpZXdSZXNvdXJjZXMgPSBuZXcgVmlld1Jlc291cmNlcyhhcHBSZXNvdXJjZXMpO1xuXG4gICAgICBsZXQgcmVzb3VyY2U7XG4gICAgICBsZXQgZWxEZXBzID0gW107XG5cbiAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgdmlld1Jlc291cmNlcy5hdXRvUmVnaXN0ZXIoY29udGFpbmVyLCB0YXJnZXQpO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBkZXAgb2YgZGVwZW5kZW5jaWVzKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZGVwID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgcmVzb3VyY2UgPSB2aWV3UmVzb3VyY2VzLmF1dG9SZWdpc3Rlcihjb250YWluZXIsIGRlcCk7XG4gICAgICAgICAgaWYgKHJlc291cmNlLmVsZW1lbnROYW1lICE9PSBudWxsKSB7XG4gICAgICAgICAgICBlbERlcHMucHVzaChyZXNvdXJjZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGRlcCAmJiB0eXBlb2YgZGVwID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIGZvciAobGV0IGtleSBpbiBkZXApIHtcbiAgICAgICAgICAgIGxldCBleHBvcnRlZCA9IGRlcFtrZXldO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBleHBvcnRlZCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICByZXNvdXJjZSA9IHZpZXdSZXNvdXJjZXMuYXV0b1JlZ2lzdGVyKGNvbnRhaW5lciwgZXhwb3J0ZWQpO1xuICAgICAgICAgICAgICBpZiAocmVzb3VyY2UuZWxlbWVudE5hbWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbERlcHMucHVzaChyZXNvdXJjZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBkZXBlbmRlbmN5IG5laXRoZXIgZnVuY3Rpb24gbm9yIG9iamVjdC4gUmVjZWl2ZWQ6IFwiJHt0eXBlb2YgZGVwfVwiYCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGVsRGVwcy5tYXAoZWwgPT4gZWwubG9hZChjb250YWluZXIsIGVsLnRhcmdldCkpKS50aGVuKCgpID0+IHtcbiAgICAgICAgY29uc3QgZmFjdG9yeSA9IHRoaXMudGVtcGxhdGUgIT09IG51bGwgPyB2aWV3Q29tcGlsZXIuY29tcGlsZSh0aGlzLnRlbXBsYXRlLCB2aWV3UmVzb3VyY2VzLCBjb21waWxlSW5zdHJ1Y3Rpb24pIDogbnVsbDtcbiAgICAgICAgdGhpcy5mYWN0b3J5SXNSZWFkeSA9IHRydWU7XG4gICAgICAgIHRoaXMuZmFjdG9yeSA9IGZhY3Rvcnk7XG4gICAgICAgIHJldHVybiBmYWN0b3J5O1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn0pIHx8IF9jbGFzczgpO1xuXG5leHBvcnQgbGV0IFZpZXdMb2NhdG9yID0gKF90ZW1wMyA9IF9jbGFzczkgPSBjbGFzcyBWaWV3TG9jYXRvciB7XG4gIGdldFZpZXdTdHJhdGVneSh2YWx1ZSkge1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmICdnZXRWaWV3U3RyYXRlZ3knIGluIHZhbHVlKSB7XG4gICAgICBsZXQgb3JpZ2luID0gT3JpZ2luLmdldCh2YWx1ZS5jb25zdHJ1Y3Rvcik7XG5cbiAgICAgIHZhbHVlID0gdmFsdWUuZ2V0Vmlld1N0cmF0ZWd5KCk7XG5cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHZhbHVlID0gbmV3IFJlbGF0aXZlVmlld1N0cmF0ZWd5KHZhbHVlKTtcbiAgICAgIH1cblxuICAgICAgdmlld1N0cmF0ZWd5LmFzc2VydCh2YWx1ZSk7XG5cbiAgICAgIGlmIChvcmlnaW4ubW9kdWxlSWQpIHtcbiAgICAgICAgdmFsdWUubWFrZVJlbGF0aXZlVG8ob3JpZ2luLm1vZHVsZUlkKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICB2YWx1ZSA9IG5ldyBSZWxhdGl2ZVZpZXdTdHJhdGVneSh2YWx1ZSk7XG4gICAgfVxuXG4gICAgaWYgKHZpZXdTdHJhdGVneS52YWxpZGF0ZSh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlLmNvbnN0cnVjdG9yO1xuICAgIH1cblxuICAgIGlmICgnJHZpZXcnIGluIHZhbHVlKSB7XG4gICAgICBsZXQgYyA9IHZhbHVlLiR2aWV3O1xuICAgICAgbGV0IHZpZXc7XG4gICAgICBjID0gdHlwZW9mIGMgPT09ICdmdW5jdGlvbicgPyBjLmNhbGwodmFsdWUpIDogYztcbiAgICAgIGlmIChjID09PSBudWxsKSB7XG4gICAgICAgIHZpZXcgPSBuZXcgTm9WaWV3U3RyYXRlZ3koKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZpZXcgPSBjIGluc3RhbmNlb2YgU3RhdGljVmlld1N0cmF0ZWd5ID8gYyA6IG5ldyBTdGF0aWNWaWV3U3RyYXRlZ3koYyk7XG4gICAgICB9XG4gICAgICBtZXRhZGF0YS5kZWZpbmUoVmlld0xvY2F0b3Iudmlld1N0cmF0ZWd5TWV0YWRhdGFLZXksIHZpZXcsIHZhbHVlKTtcbiAgICAgIHJldHVybiB2aWV3O1xuICAgIH1cblxuICAgIGxldCBvcmlnaW4gPSBPcmlnaW4uZ2V0KHZhbHVlKTtcbiAgICBsZXQgc3RyYXRlZ3kgPSBtZXRhZGF0YS5nZXQoVmlld0xvY2F0b3Iudmlld1N0cmF0ZWd5TWV0YWRhdGFLZXksIHZhbHVlKTtcblxuICAgIGlmICghc3RyYXRlZ3kpIHtcbiAgICAgIGlmICghb3JpZ2luLm1vZHVsZUlkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGRldGVybWluZSBkZWZhdWx0IHZpZXcgc3RyYXRlZ3kgZm9yIG9iamVjdC4nLCB2YWx1ZSk7XG4gICAgICB9XG5cbiAgICAgIHN0cmF0ZWd5ID0gdGhpcy5jcmVhdGVGYWxsYmFja1ZpZXdTdHJhdGVneShvcmlnaW4pO1xuICAgIH0gZWxzZSBpZiAob3JpZ2luLm1vZHVsZUlkKSB7XG4gICAgICBzdHJhdGVneS5tb2R1bGVJZCA9IG9yaWdpbi5tb2R1bGVJZDtcbiAgICB9XG5cbiAgICByZXR1cm4gc3RyYXRlZ3k7XG4gIH1cblxuICBjcmVhdGVGYWxsYmFja1ZpZXdTdHJhdGVneShvcmlnaW4pIHtcbiAgICByZXR1cm4gbmV3IENvbnZlbnRpb25hbFZpZXdTdHJhdGVneSh0aGlzLCBvcmlnaW4pO1xuICB9XG5cbiAgY29udmVydE9yaWdpblRvVmlld1VybChvcmlnaW4pIHtcbiAgICBsZXQgbW9kdWxlSWQgPSBvcmlnaW4ubW9kdWxlSWQ7XG4gICAgbGV0IGlkID0gbW9kdWxlSWQuZW5kc1dpdGgoJy5qcycpIHx8IG1vZHVsZUlkLmVuZHNXaXRoKCcudHMnKSA/IG1vZHVsZUlkLnN1YnN0cmluZygwLCBtb2R1bGVJZC5sZW5ndGggLSAzKSA6IG1vZHVsZUlkO1xuICAgIHJldHVybiBpZCArICcuaHRtbCc7XG4gIH1cbn0sIF9jbGFzczkudmlld1N0cmF0ZWd5TWV0YWRhdGFLZXkgPSAnYXVyZWxpYTp2aWV3LXN0cmF0ZWd5JywgX3RlbXAzKTtcblxuZnVuY3Rpb24gbWkobmFtZSkge1xuICB0aHJvdyBuZXcgRXJyb3IoYEJpbmRpbmdMYW5ndWFnZSBtdXN0IGltcGxlbWVudCAke25hbWV9KCkuYCk7XG59XG5cbmV4cG9ydCBsZXQgQmluZGluZ0xhbmd1YWdlID0gY2xhc3MgQmluZGluZ0xhbmd1YWdlIHtcbiAgaW5zcGVjdEF0dHJpYnV0ZShyZXNvdXJjZXMsIGVsZW1lbnROYW1lLCBhdHRyTmFtZSwgYXR0clZhbHVlKSB7XG4gICAgbWkoJ2luc3BlY3RBdHRyaWJ1dGUnKTtcbiAgfVxuXG4gIGNyZWF0ZUF0dHJpYnV0ZUluc3RydWN0aW9uKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIG1pKCdjcmVhdGVBdHRyaWJ1dGVJbnN0cnVjdGlvbicpO1xuICB9XG5cbiAgY3JlYXRlTGV0RXhwcmVzc2lvbnMocmVzb3VyY2VzLCBlbGVtZW50KSB7XG4gICAgbWkoJ2NyZWF0ZUxldEV4cHJlc3Npb25zJyk7XG4gIH1cblxuICBpbnNwZWN0VGV4dENvbnRlbnQocmVzb3VyY2VzLCB2YWx1ZSkge1xuICAgIG1pKCdpbnNwZWN0VGV4dENvbnRlbnQnKTtcbiAgfVxufTtcblxubGV0IG5vTm9kZXMgPSBPYmplY3QuZnJlZXplKFtdKTtcblxuZXhwb3J0IGxldCBTbG90Q3VzdG9tQXR0cmlidXRlID0gY2xhc3MgU2xvdEN1c3RvbUF0dHJpYnV0ZSB7XG4gIHN0YXRpYyBpbmplY3QoKSB7XG4gICAgcmV0dXJuIFtET00uRWxlbWVudF07XG4gIH1cblxuICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmVsZW1lbnQuYXVTbG90QXR0cmlidXRlID0gdGhpcztcbiAgfVxuXG4gIHZhbHVlQ2hhbmdlZChuZXdWYWx1ZSwgb2xkVmFsdWUpIHt9XG59O1xuXG5leHBvcnQgbGV0IFBhc3NUaHJvdWdoU2xvdCA9IGNsYXNzIFBhc3NUaHJvdWdoU2xvdCB7XG4gIGNvbnN0cnVjdG9yKGFuY2hvciwgbmFtZSwgZGVzdGluYXRpb25OYW1lLCBmYWxsYmFja0ZhY3RvcnkpIHtcbiAgICB0aGlzLmFuY2hvciA9IGFuY2hvcjtcbiAgICB0aGlzLmFuY2hvci52aWV3U2xvdCA9IHRoaXM7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLmRlc3RpbmF0aW9uTmFtZSA9IGRlc3RpbmF0aW9uTmFtZTtcbiAgICB0aGlzLmZhbGxiYWNrRmFjdG9yeSA9IGZhbGxiYWNrRmFjdG9yeTtcbiAgICB0aGlzLmRlc3RpbmF0aW9uU2xvdCA9IG51bGw7XG4gICAgdGhpcy5wcm9qZWN0aW9ucyA9IDA7XG4gICAgdGhpcy5jb250ZW50VmlldyA9IG51bGw7XG5cbiAgICBsZXQgYXR0ciA9IG5ldyBTbG90Q3VzdG9tQXR0cmlidXRlKHRoaXMuYW5jaG9yKTtcbiAgICBhdHRyLnZhbHVlID0gdGhpcy5kZXN0aW5hdGlvbk5hbWU7XG4gIH1cblxuICBnZXQgbmVlZHNGYWxsYmFja1JlbmRlcmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5mYWxsYmFja0ZhY3RvcnkgJiYgdGhpcy5wcm9qZWN0aW9ucyA9PT0gMDtcbiAgfVxuXG4gIHJlbmRlckZhbGxiYWNrQ29udGVudCh2aWV3LCBub2RlcywgcHJvamVjdGlvblNvdXJjZSwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5jb250ZW50VmlldyA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5jb250ZW50VmlldyA9IHRoaXMuZmFsbGJhY2tGYWN0b3J5LmNyZWF0ZSh0aGlzLm93bmVyVmlldy5jb250YWluZXIpO1xuICAgICAgdGhpcy5jb250ZW50Vmlldy5iaW5kKHRoaXMub3duZXJWaWV3LmJpbmRpbmdDb250ZXh0LCB0aGlzLm93bmVyVmlldy5vdmVycmlkZUNvbnRleHQpO1xuXG4gICAgICBsZXQgc2xvdHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgc2xvdHNbdGhpcy5kZXN0aW5hdGlvblNsb3QubmFtZV0gPSB0aGlzLmRlc3RpbmF0aW9uU2xvdDtcblxuICAgICAgU2hhZG93RE9NLmRpc3RyaWJ1dGVWaWV3KHRoaXMuY29udGVudFZpZXcsIHNsb3RzLCBwcm9qZWN0aW9uU291cmNlLCBpbmRleCwgdGhpcy5kZXN0aW5hdGlvblNsb3QubmFtZSk7XG4gICAgfVxuICB9XG5cbiAgcGFzc1Rocm91Z2hUbyhkZXN0aW5hdGlvblNsb3QpIHtcbiAgICB0aGlzLmRlc3RpbmF0aW9uU2xvdCA9IGRlc3RpbmF0aW9uU2xvdDtcbiAgfVxuXG4gIGFkZE5vZGUodmlldywgbm9kZSwgcHJvamVjdGlvblNvdXJjZSwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5jb250ZW50VmlldyAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5jb250ZW50Vmlldy5yZW1vdmVOb2RlcygpO1xuICAgICAgdGhpcy5jb250ZW50Vmlldy5kZXRhY2hlZCgpO1xuICAgICAgdGhpcy5jb250ZW50Vmlldy51bmJpbmQoKTtcbiAgICAgIHRoaXMuY29udGVudFZpZXcgPSBudWxsO1xuICAgIH1cblxuICAgIGlmIChub2RlLnZpZXdTbG90IGluc3RhbmNlb2YgUGFzc1Rocm91Z2hTbG90KSB7XG4gICAgICBub2RlLnZpZXdTbG90LnBhc3NUaHJvdWdoVG8odGhpcyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5wcm9qZWN0aW9ucysrO1xuICAgIHRoaXMuZGVzdGluYXRpb25TbG90LmFkZE5vZGUodmlldywgbm9kZSwgcHJvamVjdGlvblNvdXJjZSwgaW5kZXgpO1xuICB9XG5cbiAgcmVtb3ZlVmlldyh2aWV3LCBwcm9qZWN0aW9uU291cmNlKSB7XG4gICAgdGhpcy5wcm9qZWN0aW9ucy0tO1xuICAgIHRoaXMuZGVzdGluYXRpb25TbG90LnJlbW92ZVZpZXcodmlldywgcHJvamVjdGlvblNvdXJjZSk7XG5cbiAgICBpZiAodGhpcy5uZWVkc0ZhbGxiYWNrUmVuZGVyaW5nKSB7XG4gICAgICB0aGlzLnJlbmRlckZhbGxiYWNrQ29udGVudChudWxsLCBub05vZGVzLCBwcm9qZWN0aW9uU291cmNlKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVBbGwocHJvamVjdGlvblNvdXJjZSkge1xuICAgIHRoaXMucHJvamVjdGlvbnMgPSAwO1xuICAgIHRoaXMuZGVzdGluYXRpb25TbG90LnJlbW92ZUFsbChwcm9qZWN0aW9uU291cmNlKTtcblxuICAgIGlmICh0aGlzLm5lZWRzRmFsbGJhY2tSZW5kZXJpbmcpIHtcbiAgICAgIHRoaXMucmVuZGVyRmFsbGJhY2tDb250ZW50KG51bGwsIG5vTm9kZXMsIHByb2plY3Rpb25Tb3VyY2UpO1xuICAgIH1cbiAgfVxuXG4gIHByb2plY3RGcm9tKHZpZXcsIHByb2plY3Rpb25Tb3VyY2UpIHtcbiAgICB0aGlzLmRlc3RpbmF0aW9uU2xvdC5wcm9qZWN0RnJvbSh2aWV3LCBwcm9qZWN0aW9uU291cmNlKTtcbiAgfVxuXG4gIGNyZWF0ZWQob3duZXJWaWV3KSB7XG4gICAgdGhpcy5vd25lclZpZXcgPSBvd25lclZpZXc7XG4gIH1cblxuICBiaW5kKHZpZXcpIHtcbiAgICBpZiAodGhpcy5jb250ZW50Vmlldykge1xuICAgICAgdGhpcy5jb250ZW50Vmlldy5iaW5kKHZpZXcuYmluZGluZ0NvbnRleHQsIHZpZXcub3ZlcnJpZGVDb250ZXh0KTtcbiAgICB9XG4gIH1cblxuICBhdHRhY2hlZCgpIHtcbiAgICBpZiAodGhpcy5jb250ZW50Vmlldykge1xuICAgICAgdGhpcy5jb250ZW50Vmlldy5hdHRhY2hlZCgpO1xuICAgIH1cbiAgfVxuXG4gIGRldGFjaGVkKCkge1xuICAgIGlmICh0aGlzLmNvbnRlbnRWaWV3KSB7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3LmRldGFjaGVkKCk7XG4gICAgfVxuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICh0aGlzLmNvbnRlbnRWaWV3KSB7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3LnVuYmluZCgpO1xuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGxldCBTaGFkb3dTbG90ID0gY2xhc3MgU2hhZG93U2xvdCB7XG4gIGNvbnN0cnVjdG9yKGFuY2hvciwgbmFtZSwgZmFsbGJhY2tGYWN0b3J5KSB7XG4gICAgdGhpcy5hbmNob3IgPSBhbmNob3I7XG4gICAgdGhpcy5hbmNob3IuaXNDb250ZW50UHJvamVjdGlvblNvdXJjZSA9IHRydWU7XG4gICAgdGhpcy5hbmNob3Iudmlld1Nsb3QgPSB0aGlzO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5mYWxsYmFja0ZhY3RvcnkgPSBmYWxsYmFja0ZhY3Rvcnk7XG4gICAgdGhpcy5jb250ZW50VmlldyA9IG51bGw7XG4gICAgdGhpcy5wcm9qZWN0aW9ucyA9IDA7XG4gICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuICAgIHRoaXMucHJvamVjdEZyb21BbmNob3JzID0gbnVsbDtcbiAgICB0aGlzLmRlc3RpbmF0aW9uU2xvdHMgPSBudWxsO1xuICB9XG5cbiAgZ2V0IG5lZWRzRmFsbGJhY2tSZW5kZXJpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmFsbGJhY2tGYWN0b3J5ICYmIHRoaXMucHJvamVjdGlvbnMgPT09IDA7XG4gIH1cblxuICBhZGROb2RlKHZpZXcsIG5vZGUsIHByb2plY3Rpb25Tb3VyY2UsIGluZGV4LCBkZXN0aW5hdGlvbikge1xuICAgIGlmICh0aGlzLmNvbnRlbnRWaWV3ICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3LnJlbW92ZU5vZGVzKCk7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3LmRldGFjaGVkKCk7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3LnVuYmluZCgpO1xuICAgICAgdGhpcy5jb250ZW50VmlldyA9IG51bGw7XG4gICAgfVxuXG4gICAgaWYgKG5vZGUudmlld1Nsb3QgaW5zdGFuY2VvZiBQYXNzVGhyb3VnaFNsb3QpIHtcbiAgICAgIG5vZGUudmlld1Nsb3QucGFzc1Rocm91Z2hUbyh0aGlzKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kZXN0aW5hdGlvblNsb3RzICE9PSBudWxsKSB7XG4gICAgICBTaGFkb3dET00uZGlzdHJpYnV0ZU5vZGVzKHZpZXcsIFtub2RlXSwgdGhpcy5kZXN0aW5hdGlvblNsb3RzLCB0aGlzLCBpbmRleCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5vZGUuYXVPd25lclZpZXcgPSB2aWV3O1xuICAgICAgbm9kZS5hdVByb2plY3Rpb25Tb3VyY2UgPSBwcm9qZWN0aW9uU291cmNlO1xuICAgICAgbm9kZS5hdUFzc2lnbmVkU2xvdCA9IHRoaXM7XG5cbiAgICAgIGxldCBhbmNob3IgPSB0aGlzLl9maW5kQW5jaG9yKHZpZXcsIG5vZGUsIHByb2plY3Rpb25Tb3VyY2UsIGluZGV4KTtcbiAgICAgIGxldCBwYXJlbnQgPSBhbmNob3IucGFyZW50Tm9kZTtcblxuICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShub2RlLCBhbmNob3IpO1xuICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKG5vZGUpO1xuICAgICAgdGhpcy5wcm9qZWN0aW9ucysrO1xuICAgIH1cbiAgfVxuXG4gIHJlbW92ZVZpZXcodmlldywgcHJvamVjdGlvblNvdXJjZSkge1xuICAgIGlmICh0aGlzLmRlc3RpbmF0aW9uU2xvdHMgIT09IG51bGwpIHtcbiAgICAgIFNoYWRvd0RPTS51bmRpc3RyaWJ1dGVWaWV3KHZpZXcsIHRoaXMuZGVzdGluYXRpb25TbG90cywgdGhpcyk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbnRlbnRWaWV3ICYmIHRoaXMuY29udGVudFZpZXcuaGFzU2xvdHMpIHtcbiAgICAgIFNoYWRvd0RPTS51bmRpc3RyaWJ1dGVWaWV3KHZpZXcsIHRoaXMuY29udGVudFZpZXcuc2xvdHMsIHByb2plY3Rpb25Tb3VyY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgZm91bmQgPSB0aGlzLmNoaWxkcmVuLmZpbmQoeCA9PiB4LmF1U2xvdFByb2plY3RGcm9tID09PSBwcm9qZWN0aW9uU291cmNlKTtcbiAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICBsZXQgY2hpbGRyZW4gPSBmb3VuZC5hdVByb2plY3Rpb25DaGlsZHJlbjtcblxuICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgbGV0IGNoaWxkID0gY2hpbGRyZW5baV07XG5cbiAgICAgICAgICBpZiAoY2hpbGQuYXVPd25lclZpZXcgPT09IHZpZXcpIHtcbiAgICAgICAgICAgIGNoaWxkcmVuLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIHZpZXcuZnJhZ21lbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgaS0tO2lpLS07XG4gICAgICAgICAgICB0aGlzLnByb2plY3Rpb25zLS07XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMubmVlZHNGYWxsYmFja1JlbmRlcmluZykge1xuICAgICAgICAgIHRoaXMucmVuZGVyRmFsbGJhY2tDb250ZW50KHZpZXcsIG5vTm9kZXMsIHByb2plY3Rpb25Tb3VyY2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmVtb3ZlQWxsKHByb2plY3Rpb25Tb3VyY2UpIHtcbiAgICBpZiAodGhpcy5kZXN0aW5hdGlvblNsb3RzICE9PSBudWxsKSB7XG4gICAgICBTaGFkb3dET00udW5kaXN0cmlidXRlQWxsKHRoaXMuZGVzdGluYXRpb25TbG90cywgdGhpcyk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbnRlbnRWaWV3ICYmIHRoaXMuY29udGVudFZpZXcuaGFzU2xvdHMpIHtcbiAgICAgIFNoYWRvd0RPTS51bmRpc3RyaWJ1dGVBbGwodGhpcy5jb250ZW50Vmlldy5zbG90cywgcHJvamVjdGlvblNvdXJjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBmb3VuZCA9IHRoaXMuY2hpbGRyZW4uZmluZCh4ID0+IHguYXVTbG90UHJvamVjdEZyb20gPT09IHByb2plY3Rpb25Tb3VyY2UpO1xuXG4gICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgbGV0IGNoaWxkcmVuID0gZm91bmQuYXVQcm9qZWN0aW9uQ2hpbGRyZW47XG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICBsZXQgY2hpbGQgPSBjaGlsZHJlbltpXTtcbiAgICAgICAgICBjaGlsZC5hdU93bmVyVmlldy5mcmFnbWVudC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgdGhpcy5wcm9qZWN0aW9ucy0tO1xuICAgICAgICB9XG5cbiAgICAgICAgZm91bmQuYXVQcm9qZWN0aW9uQ2hpbGRyZW4gPSBbXTtcblxuICAgICAgICBpZiAodGhpcy5uZWVkc0ZhbGxiYWNrUmVuZGVyaW5nKSB7XG4gICAgICAgICAgdGhpcy5yZW5kZXJGYWxsYmFja0NvbnRlbnQobnVsbCwgbm9Ob2RlcywgcHJvamVjdGlvblNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfZmluZEFuY2hvcih2aWV3LCBub2RlLCBwcm9qZWN0aW9uU291cmNlLCBpbmRleCkge1xuICAgIGlmIChwcm9qZWN0aW9uU291cmNlKSB7XG4gICAgICBsZXQgZm91bmQgPSB0aGlzLmNoaWxkcmVuLmZpbmQoeCA9PiB4LmF1U2xvdFByb2plY3RGcm9tID09PSBwcm9qZWN0aW9uU291cmNlKTtcbiAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICBpZiAoaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGxldCBjaGlsZHJlbiA9IGZvdW5kLmF1UHJvamVjdGlvbkNoaWxkcmVuO1xuICAgICAgICAgIGxldCB2aWV3SW5kZXggPSAtMTtcbiAgICAgICAgICBsZXQgbGFzdFZpZXc7XG5cbiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgICBsZXQgY3VycmVudCA9IGNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgICBpZiAoY3VycmVudC5hdU93bmVyVmlldyAhPT0gbGFzdFZpZXcpIHtcbiAgICAgICAgICAgICAgdmlld0luZGV4Kys7XG4gICAgICAgICAgICAgIGxhc3RWaWV3ID0gY3VycmVudC5hdU93bmVyVmlldztcblxuICAgICAgICAgICAgICBpZiAodmlld0luZGV4ID49IGluZGV4ICYmIGxhc3RWaWV3ICE9PSB2aWV3KSB7XG4gICAgICAgICAgICAgICAgY2hpbGRyZW4uc3BsaWNlKGksIDAsIG5vZGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm91bmQuYXVQcm9qZWN0aW9uQ2hpbGRyZW4ucHVzaChub2RlKTtcbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmFuY2hvcjtcbiAgfVxuXG4gIHByb2plY3RUbyhzbG90cykge1xuICAgIHRoaXMuZGVzdGluYXRpb25TbG90cyA9IHNsb3RzO1xuICB9XG5cbiAgcHJvamVjdEZyb20odmlldywgcHJvamVjdGlvblNvdXJjZSkge1xuICAgIGxldCBhbmNob3IgPSBET00uY3JlYXRlQ29tbWVudCgnYW5jaG9yJyk7XG4gICAgbGV0IHBhcmVudCA9IHRoaXMuYW5jaG9yLnBhcmVudE5vZGU7XG4gICAgYW5jaG9yLmF1U2xvdFByb2plY3RGcm9tID0gcHJvamVjdGlvblNvdXJjZTtcbiAgICBhbmNob3IuYXVPd25lclZpZXcgPSB2aWV3O1xuICAgIGFuY2hvci5hdVByb2plY3Rpb25DaGlsZHJlbiA9IFtdO1xuICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoYW5jaG9yLCB0aGlzLmFuY2hvcik7XG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKGFuY2hvcik7XG5cbiAgICBpZiAodGhpcy5wcm9qZWN0RnJvbUFuY2hvcnMgPT09IG51bGwpIHtcbiAgICAgIHRoaXMucHJvamVjdEZyb21BbmNob3JzID0gW107XG4gICAgfVxuXG4gICAgdGhpcy5wcm9qZWN0RnJvbUFuY2hvcnMucHVzaChhbmNob3IpO1xuICB9XG5cbiAgcmVuZGVyRmFsbGJhY2tDb250ZW50KHZpZXcsIG5vZGVzLCBwcm9qZWN0aW9uU291cmNlLCBpbmRleCkge1xuICAgIGlmICh0aGlzLmNvbnRlbnRWaWV3ID09PSBudWxsKSB7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3ID0gdGhpcy5mYWxsYmFja0ZhY3RvcnkuY3JlYXRlKHRoaXMub3duZXJWaWV3LmNvbnRhaW5lcik7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3LmJpbmQodGhpcy5vd25lclZpZXcuYmluZGluZ0NvbnRleHQsIHRoaXMub3duZXJWaWV3Lm92ZXJyaWRlQ29udGV4dCk7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3Lmluc2VydE5vZGVzQmVmb3JlKHRoaXMuYW5jaG9yKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jb250ZW50Vmlldy5oYXNTbG90cykge1xuICAgICAgbGV0IHNsb3RzID0gdGhpcy5jb250ZW50Vmlldy5zbG90cztcbiAgICAgIGxldCBwcm9qZWN0RnJvbUFuY2hvcnMgPSB0aGlzLnByb2plY3RGcm9tQW5jaG9ycztcblxuICAgICAgaWYgKHByb2plY3RGcm9tQW5jaG9ycyAhPT0gbnVsbCkge1xuICAgICAgICBmb3IgKGxldCBzbG90TmFtZSBpbiBzbG90cykge1xuICAgICAgICAgIGxldCBzbG90ID0gc2xvdHNbc2xvdE5hbWVdO1xuXG4gICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gcHJvamVjdEZyb21BbmNob3JzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICAgIGxldCBhbmNob3IgPSBwcm9qZWN0RnJvbUFuY2hvcnNbaV07XG4gICAgICAgICAgICBzbG90LnByb2plY3RGcm9tKGFuY2hvci5hdU93bmVyVmlldywgYW5jaG9yLmF1U2xvdFByb2plY3RGcm9tKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy5mYWxsYmFja1Nsb3RzID0gc2xvdHM7XG4gICAgICBTaGFkb3dET00uZGlzdHJpYnV0ZU5vZGVzKHZpZXcsIG5vZGVzLCBzbG90cywgcHJvamVjdGlvblNvdXJjZSwgaW5kZXgpO1xuICAgIH1cbiAgfVxuXG4gIGNyZWF0ZWQob3duZXJWaWV3KSB7XG4gICAgdGhpcy5vd25lclZpZXcgPSBvd25lclZpZXc7XG4gIH1cblxuICBiaW5kKHZpZXcpIHtcbiAgICBpZiAodGhpcy5jb250ZW50Vmlldykge1xuICAgICAgdGhpcy5jb250ZW50Vmlldy5iaW5kKHZpZXcuYmluZGluZ0NvbnRleHQsIHZpZXcub3ZlcnJpZGVDb250ZXh0KTtcbiAgICB9XG4gIH1cblxuICBhdHRhY2hlZCgpIHtcbiAgICBpZiAodGhpcy5jb250ZW50Vmlldykge1xuICAgICAgdGhpcy5jb250ZW50Vmlldy5hdHRhY2hlZCgpO1xuICAgIH1cbiAgfVxuXG4gIGRldGFjaGVkKCkge1xuICAgIGlmICh0aGlzLmNvbnRlbnRWaWV3KSB7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3LmRldGFjaGVkKCk7XG4gICAgfVxuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICh0aGlzLmNvbnRlbnRWaWV3KSB7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3LnVuYmluZCgpO1xuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGxldCBTaGFkb3dET00gPSAoX3RlbXA0ID0gX2NsYXNzMTAgPSBjbGFzcyBTaGFkb3dET00ge1xuXG4gIHN0YXRpYyBnZXRTbG90TmFtZShub2RlKSB7XG4gICAgaWYgKG5vZGUuYXVTbG90QXR0cmlidXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBTaGFkb3dET00uZGVmYXVsdFNsb3RLZXk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5vZGUuYXVTbG90QXR0cmlidXRlLnZhbHVlO1xuICB9XG5cbiAgc3RhdGljIGRpc3RyaWJ1dGVWaWV3KHZpZXcsIHNsb3RzLCBwcm9qZWN0aW9uU291cmNlLCBpbmRleCwgZGVzdGluYXRpb25PdmVycmlkZSkge1xuICAgIGxldCBub2RlcztcblxuICAgIGlmICh2aWV3ID09PSBudWxsKSB7XG4gICAgICBub2RlcyA9IG5vTm9kZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBjaGlsZE5vZGVzID0gdmlldy5mcmFnbWVudC5jaGlsZE5vZGVzO1xuICAgICAgbGV0IGlpID0gY2hpbGROb2Rlcy5sZW5ndGg7XG4gICAgICBub2RlcyA9IG5ldyBBcnJheShpaSk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBub2Rlc1tpXSA9IGNoaWxkTm9kZXNbaV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgU2hhZG93RE9NLmRpc3RyaWJ1dGVOb2Rlcyh2aWV3LCBub2Rlcywgc2xvdHMsIHByb2plY3Rpb25Tb3VyY2UsIGluZGV4LCBkZXN0aW5hdGlvbk92ZXJyaWRlKTtcbiAgfVxuXG4gIHN0YXRpYyB1bmRpc3RyaWJ1dGVWaWV3KHZpZXcsIHNsb3RzLCBwcm9qZWN0aW9uU291cmNlKSB7XG4gICAgZm9yIChsZXQgc2xvdE5hbWUgaW4gc2xvdHMpIHtcbiAgICAgIHNsb3RzW3Nsb3ROYW1lXS5yZW1vdmVWaWV3KHZpZXcsIHByb2plY3Rpb25Tb3VyY2UpO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyB1bmRpc3RyaWJ1dGVBbGwoc2xvdHMsIHByb2plY3Rpb25Tb3VyY2UpIHtcbiAgICBmb3IgKGxldCBzbG90TmFtZSBpbiBzbG90cykge1xuICAgICAgc2xvdHNbc2xvdE5hbWVdLnJlbW92ZUFsbChwcm9qZWN0aW9uU291cmNlKTtcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgZGlzdHJpYnV0ZU5vZGVzKHZpZXcsIG5vZGVzLCBzbG90cywgcHJvamVjdGlvblNvdXJjZSwgaW5kZXgsIGRlc3RpbmF0aW9uT3ZlcnJpZGUpIHtcbiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBub2Rlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBsZXQgY3VycmVudE5vZGUgPSBub2Rlc1tpXTtcbiAgICAgIGxldCBub2RlVHlwZSA9IGN1cnJlbnROb2RlLm5vZGVUeXBlO1xuXG4gICAgICBpZiAoY3VycmVudE5vZGUuaXNDb250ZW50UHJvamVjdGlvblNvdXJjZSkge1xuICAgICAgICBjdXJyZW50Tm9kZS52aWV3U2xvdC5wcm9qZWN0VG8oc2xvdHMpO1xuXG4gICAgICAgIGZvciAobGV0IHNsb3ROYW1lIGluIHNsb3RzKSB7XG4gICAgICAgICAgc2xvdHNbc2xvdE5hbWVdLnByb2plY3RGcm9tKHZpZXcsIGN1cnJlbnROb2RlLnZpZXdTbG90KTtcbiAgICAgICAgfVxuXG4gICAgICAgIG5vZGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgaWktLTtpLS07XG4gICAgICB9IGVsc2UgaWYgKG5vZGVUeXBlID09PSAxIHx8IG5vZGVUeXBlID09PSAzIHx8IGN1cnJlbnROb2RlLnZpZXdTbG90IGluc3RhbmNlb2YgUGFzc1Rocm91Z2hTbG90KSB7XG4gICAgICAgIGlmIChub2RlVHlwZSA9PT0gMyAmJiBfaXNBbGxXaGl0ZXNwYWNlKGN1cnJlbnROb2RlKSkge1xuICAgICAgICAgIG5vZGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICBpaS0tO2ktLTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsZXQgZm91bmQgPSBzbG90c1tkZXN0aW5hdGlvbk92ZXJyaWRlIHx8IFNoYWRvd0RPTS5nZXRTbG90TmFtZShjdXJyZW50Tm9kZSldO1xuXG4gICAgICAgICAgaWYgKGZvdW5kKSB7XG4gICAgICAgICAgICBmb3VuZC5hZGROb2RlKHZpZXcsIGN1cnJlbnROb2RlLCBwcm9qZWN0aW9uU291cmNlLCBpbmRleCk7XG4gICAgICAgICAgICBub2Rlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICBpaS0tO2ktLTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgaWktLTtpLS07XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChsZXQgc2xvdE5hbWUgaW4gc2xvdHMpIHtcbiAgICAgIGxldCBzbG90ID0gc2xvdHNbc2xvdE5hbWVdO1xuXG4gICAgICBpZiAoc2xvdC5uZWVkc0ZhbGxiYWNrUmVuZGVyaW5nKSB7XG4gICAgICAgIHNsb3QucmVuZGVyRmFsbGJhY2tDb250ZW50KHZpZXcsIG5vZGVzLCBwcm9qZWN0aW9uU291cmNlLCBpbmRleCk7XG4gICAgICB9XG4gICAgfVxuICB9XG59LCBfY2xhc3MxMC5kZWZhdWx0U2xvdEtleSA9ICdfX2F1LWRlZmF1bHQtc2xvdC1rZXlfXycsIF90ZW1wNCk7XG5cbmZ1bmN0aW9uIHJlZ2lzdGVyKGxvb2t1cCwgbmFtZSwgcmVzb3VyY2UsIHR5cGUpIHtcbiAgaWYgKCFuYW1lKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IGV4aXN0aW5nID0gbG9va3VwW25hbWVdO1xuICBpZiAoZXhpc3RpbmcpIHtcbiAgICBpZiAoZXhpc3RpbmcgIT09IHJlc291cmNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEF0dGVtcHRlZCB0byByZWdpc3RlciAke3R5cGV9IHdoZW4gb25lIHdpdGggdGhlIHNhbWUgbmFtZSBhbHJlYWR5IGV4aXN0cy4gTmFtZTogJHtuYW1lfS5gKTtcbiAgICB9XG5cbiAgICByZXR1cm47XG4gIH1cblxuICBsb29rdXBbbmFtZV0gPSByZXNvdXJjZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQmVoYXZpb3JOYW1lKG5hbWUsIHR5cGUpIHtcbiAgaWYgKC9bQS1aXS8udGVzdChuYW1lKSkge1xuICAgIGxldCBuZXdOYW1lID0gX2h5cGhlbmF0ZShuYW1lKTtcbiAgICBMb2dNYW5hZ2VyLmdldExvZ2dlcigndGVtcGxhdGluZycpLndhcm4oYCcke25hbWV9JyBpcyBub3QgYSB2YWxpZCAke3R5cGV9IG5hbWUgYW5kIGhhcyBiZWVuIGNvbnZlcnRlZCB0byAnJHtuZXdOYW1lfScuIFVwcGVyLWNhc2UgbGV0dGVycyBhcmUgbm90IGFsbG93ZWQgYmVjYXVzZSB0aGUgRE9NIGlzIG5vdCBjYXNlLXNlbnNpdGl2ZS5gKTtcbiAgICByZXR1cm4gbmV3TmFtZTtcbiAgfVxuICByZXR1cm4gbmFtZTtcbn1cblxuY29uc3QgY29udmVudGlvbk1hcmsgPSAnX19hdV9yZXNvdXJjZV9fJztcblxuZXhwb3J0IGxldCBWaWV3UmVzb3VyY2VzID0gY2xhc3MgVmlld1Jlc291cmNlcyB7XG4gIHN0YXRpYyBjb252ZW50aW9uKHRhcmdldCwgZXhpc3RpbmcpIHtcbiAgICBsZXQgcmVzb3VyY2U7XG5cbiAgICBpZiAoZXhpc3RpbmcgJiYgY29udmVudGlvbk1hcmsgaW4gZXhpc3RpbmcpIHtcbiAgICAgIHJldHVybiBleGlzdGluZztcbiAgICB9XG4gICAgaWYgKCckcmVzb3VyY2UnIGluIHRhcmdldCkge1xuICAgICAgbGV0IGNvbmZpZyA9IHRhcmdldC4kcmVzb3VyY2U7XG5cbiAgICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXNvdXJjZSA9IGV4aXN0aW5nIHx8IG5ldyBIdG1sQmVoYXZpb3JSZXNvdXJjZSgpO1xuICAgICAgICByZXNvdXJjZVtjb252ZW50aW9uTWFya10gPSB0cnVlO1xuICAgICAgICBpZiAoIXJlc291cmNlLmVsZW1lbnROYW1lKSB7XG4gICAgICAgICAgcmVzb3VyY2UuZWxlbWVudE5hbWUgPSB2YWxpZGF0ZUJlaGF2aW9yTmFtZShjb25maWcsICdjdXN0b20gZWxlbWVudCcpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZy5jYWxsKHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgY29uZmlnID0geyBuYW1lOiBjb25maWcgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZyk7XG5cbiAgICAgICAgbGV0IHJlc291cmNlVHlwZSA9IGNvbmZpZy50eXBlIHx8ICdlbGVtZW50JztcblxuICAgICAgICBsZXQgbmFtZSA9IGNvbmZpZy5uYW1lO1xuICAgICAgICBzd2l0Y2ggKHJlc291cmNlVHlwZSkge1xuICAgICAgICAgIGNhc2UgJ2VsZW1lbnQnOmNhc2UgJ2F0dHJpYnV0ZSc6XG4gICAgICAgICAgICByZXNvdXJjZSA9IGV4aXN0aW5nIHx8IG5ldyBIdG1sQmVoYXZpb3JSZXNvdXJjZSgpO1xuICAgICAgICAgICAgcmVzb3VyY2VbY29udmVudGlvbk1hcmtdID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChyZXNvdXJjZVR5cGUgPT09ICdlbGVtZW50Jykge1xuICAgICAgICAgICAgICBpZiAoIXJlc291cmNlLmVsZW1lbnROYW1lKSB7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2UuZWxlbWVudE5hbWUgPSBuYW1lID8gdmFsaWRhdGVCZWhhdmlvck5hbWUobmFtZSwgJ2N1c3RvbSBlbGVtZW50JykgOiBfaHlwaGVuYXRlKHRhcmdldC5uYW1lKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKCFyZXNvdXJjZS5hdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2UuYXR0cmlidXRlTmFtZSA9IG5hbWUgPyB2YWxpZGF0ZUJlaGF2aW9yTmFtZShuYW1lLCAnY3VzdG9tIGF0dHJpYnV0ZScpIDogX2h5cGhlbmF0ZSh0YXJnZXQubmFtZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgndGVtcGxhdGVDb250cm9sbGVyJyBpbiBjb25maWcpIHtcbiAgICAgICAgICAgICAgY29uZmlnLmxpZnRzQ29udGVudCA9IGNvbmZpZy50ZW1wbGF0ZUNvbnRyb2xsZXI7XG4gICAgICAgICAgICAgIGRlbGV0ZSBjb25maWcudGVtcGxhdGVDb250cm9sbGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCdkZWZhdWx0QmluZGluZ01vZGUnIGluIGNvbmZpZyAmJiByZXNvdXJjZS5hdHRyaWJ1dGVEZWZhdWx0QmluZGluZ01vZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICBjb25maWcuYXR0cmlidXRlRGVmYXVsdEJpbmRpbmdNb2RlID0gY29uZmlnLmRlZmF1bHRCaW5kaW5nTW9kZTtcbiAgICAgICAgICAgICAgZGVsZXRlIGNvbmZpZy5kZWZhdWx0QmluZGluZ01vZGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRlbGV0ZSBjb25maWcubmFtZTtcblxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihyZXNvdXJjZSwgY29uZmlnKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3ZhbHVlQ29udmVydGVyJzpcbiAgICAgICAgICAgIHJlc291cmNlID0gbmV3IFZhbHVlQ29udmVydGVyUmVzb3VyY2UoY2FtZWxDYXNlKG5hbWUgfHwgdGFyZ2V0Lm5hbWUpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ2JpbmRpbmdCZWhhdmlvcic6XG4gICAgICAgICAgICByZXNvdXJjZSA9IG5ldyBCaW5kaW5nQmVoYXZpb3JSZXNvdXJjZShjYW1lbENhc2UobmFtZSB8fCB0YXJnZXQubmFtZSkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAndmlld0VuZ2luZUhvb2tzJzpcbiAgICAgICAgICAgIHJlc291cmNlID0gbmV3IFZpZXdFbmdpbmVIb29rc1Jlc291cmNlKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAocmVzb3VyY2UgaW5zdGFuY2VvZiBIdG1sQmVoYXZpb3JSZXNvdXJjZSkge1xuICAgICAgICBsZXQgYmluZGFibGVzID0gdHlwZW9mIGNvbmZpZyA9PT0gJ3N0cmluZycgPyB1bmRlZmluZWQgOiBjb25maWcuYmluZGFibGVzO1xuICAgICAgICBsZXQgY3VycmVudFByb3BzID0gcmVzb3VyY2UucHJvcGVydGllcztcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYmluZGFibGVzKSkge1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGJpbmRhYmxlcy5sZW5ndGg7IGlpID4gaTsgKytpKSB7XG4gICAgICAgICAgICBsZXQgcHJvcCA9IGJpbmRhYmxlc1tpXTtcbiAgICAgICAgICAgIGlmICghcHJvcCB8fCB0eXBlb2YgcHJvcCAhPT0gJ3N0cmluZycgJiYgIXByb3AubmFtZSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgYmluZGFibGUgcHJvcGVydHkgYXQgXCIke2l9XCIgZm9yIGNsYXNzIFwiJHt0YXJnZXQubmFtZX1cIi4gRXhwZWN0ZWQgZWl0aGVyIGEgc3RyaW5nIG9yIGFuIG9iamVjdCB3aXRoIFwibmFtZVwiIHByb3BlcnR5LmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IG5ld1Byb3AgPSBuZXcgQmluZGFibGVQcm9wZXJ0eShwcm9wKTtcblxuICAgICAgICAgICAgbGV0IGV4aXN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBqaiA9IGN1cnJlbnRQcm9wcy5sZW5ndGg7IGpqID4gajsgKytqKSB7XG4gICAgICAgICAgICAgIGlmIChjdXJyZW50UHJvcHNbal0ubmFtZSA9PT0gbmV3UHJvcC5uYW1lKSB7XG4gICAgICAgICAgICAgICAgZXhpc3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChleGlzdGVkKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3UHJvcC5yZWdpc3RlcldpdGgodGFyZ2V0LCByZXNvdXJjZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXNvdXJjZTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHBhcmVudCwgdmlld1VybCkge1xuICAgIHRoaXMuYmluZGluZ0xhbmd1YWdlID0gbnVsbDtcblxuICAgIHRoaXMucGFyZW50ID0gcGFyZW50IHx8IG51bGw7XG4gICAgdGhpcy5oYXNQYXJlbnQgPSB0aGlzLnBhcmVudCAhPT0gbnVsbDtcbiAgICB0aGlzLnZpZXdVcmwgPSB2aWV3VXJsIHx8ICcnO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0ge1xuICAgICAgdmFsdWVDb252ZXJ0ZXJzOiB0aGlzLmdldFZhbHVlQ29udmVydGVyLmJpbmQodGhpcyksXG4gICAgICBiaW5kaW5nQmVoYXZpb3JzOiB0aGlzLmdldEJpbmRpbmdCZWhhdmlvci5iaW5kKHRoaXMpXG4gICAgfTtcbiAgICB0aGlzLmF0dHJpYnV0ZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRoaXMuZWxlbWVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRoaXMudmFsdWVDb252ZXJ0ZXJzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICB0aGlzLmJpbmRpbmdCZWhhdmlvcnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRoaXMuYXR0cmlidXRlTWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICB0aGlzLnZhbHVlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgdGhpcy5iZWZvcmVDb21waWxlID0gdGhpcy5hZnRlckNvbXBpbGUgPSB0aGlzLmJlZm9yZUNyZWF0ZSA9IHRoaXMuYWZ0ZXJDcmVhdGUgPSB0aGlzLmJlZm9yZUJpbmQgPSB0aGlzLmJlZm9yZVVuYmluZCA9IGZhbHNlO1xuICB9XG5cbiAgX3RyeUFkZEhvb2sob2JqLCBuYW1lKSB7XG4gICAgaWYgKHR5cGVvZiBvYmpbbmFtZV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGxldCBmdW5jID0gb2JqW25hbWVdLmJpbmQob2JqKTtcbiAgICAgIGxldCBjb3VudGVyID0gMTtcbiAgICAgIGxldCBjYWxsYmFja05hbWU7XG5cbiAgICAgIHdoaWxlICh0aGlzW2NhbGxiYWNrTmFtZSA9IG5hbWUgKyBjb3VudGVyLnRvU3RyaW5nKCldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY291bnRlcisrO1xuICAgICAgfVxuXG4gICAgICB0aGlzW25hbWVdID0gdHJ1ZTtcbiAgICAgIHRoaXNbY2FsbGJhY2tOYW1lXSA9IGZ1bmM7XG4gICAgfVxuICB9XG5cbiAgX2ludm9rZUhvb2sobmFtZSwgb25lLCB0d28sIHRocmVlLCBmb3VyKSB7XG4gICAgaWYgKHRoaXMuaGFzUGFyZW50KSB7XG4gICAgICB0aGlzLnBhcmVudC5faW52b2tlSG9vayhuYW1lLCBvbmUsIHR3bywgdGhyZWUsIGZvdXIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzW25hbWVdKSB7XG4gICAgICB0aGlzW25hbWUgKyAnMSddKG9uZSwgdHdvLCB0aHJlZSwgZm91cik7XG5cbiAgICAgIGxldCBjYWxsYmFja05hbWUgPSBuYW1lICsgJzInO1xuICAgICAgaWYgKHRoaXNbY2FsbGJhY2tOYW1lXSkge1xuICAgICAgICB0aGlzW2NhbGxiYWNrTmFtZV0ob25lLCB0d28sIHRocmVlLCBmb3VyKTtcblxuICAgICAgICBjYWxsYmFja05hbWUgPSBuYW1lICsgJzMnO1xuICAgICAgICBpZiAodGhpc1tjYWxsYmFja05hbWVdKSB7XG4gICAgICAgICAgdGhpc1tjYWxsYmFja05hbWVdKG9uZSwgdHdvLCB0aHJlZSwgZm91cik7XG5cbiAgICAgICAgICBsZXQgY291bnRlciA9IDQ7XG5cbiAgICAgICAgICB3aGlsZSAodGhpc1tjYWxsYmFja05hbWUgPSBuYW1lICsgY291bnRlci50b1N0cmluZygpXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzW2NhbGxiYWNrTmFtZV0ob25lLCB0d28sIHRocmVlLCBmb3VyKTtcbiAgICAgICAgICAgIGNvdW50ZXIrKztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZWdpc3RlclZpZXdFbmdpbmVIb29rcyhob29rcykge1xuICAgIHRoaXMuX3RyeUFkZEhvb2soaG9va3MsICdiZWZvcmVDb21waWxlJyk7XG4gICAgdGhpcy5fdHJ5QWRkSG9vayhob29rcywgJ2FmdGVyQ29tcGlsZScpO1xuICAgIHRoaXMuX3RyeUFkZEhvb2soaG9va3MsICdiZWZvcmVDcmVhdGUnKTtcbiAgICB0aGlzLl90cnlBZGRIb29rKGhvb2tzLCAnYWZ0ZXJDcmVhdGUnKTtcbiAgICB0aGlzLl90cnlBZGRIb29rKGhvb2tzLCAnYmVmb3JlQmluZCcpO1xuICAgIHRoaXMuX3RyeUFkZEhvb2soaG9va3MsICdiZWZvcmVVbmJpbmQnKTtcbiAgfVxuXG4gIGdldEJpbmRpbmdMYW5ndWFnZShiaW5kaW5nTGFuZ3VhZ2VGYWxsYmFjaykge1xuICAgIHJldHVybiB0aGlzLmJpbmRpbmdMYW5ndWFnZSB8fCAodGhpcy5iaW5kaW5nTGFuZ3VhZ2UgPSBiaW5kaW5nTGFuZ3VhZ2VGYWxsYmFjayk7XG4gIH1cblxuICBwYXRjaEluUGFyZW50KG5ld1BhcmVudCkge1xuICAgIGxldCBvcmlnaW5hbFBhcmVudCA9IHRoaXMucGFyZW50O1xuXG4gICAgdGhpcy5wYXJlbnQgPSBuZXdQYXJlbnQgfHwgbnVsbDtcbiAgICB0aGlzLmhhc1BhcmVudCA9IHRoaXMucGFyZW50ICE9PSBudWxsO1xuXG4gICAgaWYgKG5ld1BhcmVudC5wYXJlbnQgPT09IG51bGwpIHtcbiAgICAgIG5ld1BhcmVudC5wYXJlbnQgPSBvcmlnaW5hbFBhcmVudDtcbiAgICAgIG5ld1BhcmVudC5oYXNQYXJlbnQgPSBvcmlnaW5hbFBhcmVudCAhPT0gbnVsbDtcbiAgICB9XG4gIH1cblxuICByZWxhdGl2ZVRvVmlldyhwYXRoKSB7XG4gICAgcmV0dXJuIHJlbGF0aXZlVG9GaWxlKHBhdGgsIHRoaXMudmlld1VybCk7XG4gIH1cblxuICByZWdpc3RlckVsZW1lbnQodGFnTmFtZSwgYmVoYXZpb3IpIHtcbiAgICByZWdpc3Rlcih0aGlzLmVsZW1lbnRzLCB0YWdOYW1lLCBiZWhhdmlvciwgJ2FuIEVsZW1lbnQnKTtcbiAgfVxuXG4gIGdldEVsZW1lbnQodGFnTmFtZSkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnRzW3RhZ05hbWVdIHx8ICh0aGlzLmhhc1BhcmVudCA/IHRoaXMucGFyZW50LmdldEVsZW1lbnQodGFnTmFtZSkgOiBudWxsKTtcbiAgfVxuXG4gIG1hcEF0dHJpYnV0ZShhdHRyaWJ1dGUpIHtcbiAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVNYXBbYXR0cmlidXRlXSB8fCAodGhpcy5oYXNQYXJlbnQgPyB0aGlzLnBhcmVudC5tYXBBdHRyaWJ1dGUoYXR0cmlidXRlKSA6IG51bGwpO1xuICB9XG5cbiAgcmVnaXN0ZXJBdHRyaWJ1dGUoYXR0cmlidXRlLCBiZWhhdmlvciwga25vd25BdHRyaWJ1dGUpIHtcbiAgICB0aGlzLmF0dHJpYnV0ZU1hcFthdHRyaWJ1dGVdID0ga25vd25BdHRyaWJ1dGU7XG4gICAgcmVnaXN0ZXIodGhpcy5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGUsIGJlaGF2aW9yLCAnYW4gQXR0cmlidXRlJyk7XG4gIH1cblxuICBnZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSB7XG4gICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlc1thdHRyaWJ1dGVdIHx8ICh0aGlzLmhhc1BhcmVudCA/IHRoaXMucGFyZW50LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpIDogbnVsbCk7XG4gIH1cblxuICByZWdpc3RlclZhbHVlQ29udmVydGVyKG5hbWUsIHZhbHVlQ29udmVydGVyKSB7XG4gICAgcmVnaXN0ZXIodGhpcy52YWx1ZUNvbnZlcnRlcnMsIG5hbWUsIHZhbHVlQ29udmVydGVyLCAnYSBWYWx1ZUNvbnZlcnRlcicpO1xuICB9XG5cbiAgZ2V0VmFsdWVDb252ZXJ0ZXIobmFtZSkge1xuICAgIHJldHVybiB0aGlzLnZhbHVlQ29udmVydGVyc1tuYW1lXSB8fCAodGhpcy5oYXNQYXJlbnQgPyB0aGlzLnBhcmVudC5nZXRWYWx1ZUNvbnZlcnRlcihuYW1lKSA6IG51bGwpO1xuICB9XG5cbiAgcmVnaXN0ZXJCaW5kaW5nQmVoYXZpb3IobmFtZSwgYmluZGluZ0JlaGF2aW9yKSB7XG4gICAgcmVnaXN0ZXIodGhpcy5iaW5kaW5nQmVoYXZpb3JzLCBuYW1lLCBiaW5kaW5nQmVoYXZpb3IsICdhIEJpbmRpbmdCZWhhdmlvcicpO1xuICB9XG5cbiAgZ2V0QmluZGluZ0JlaGF2aW9yKG5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy5iaW5kaW5nQmVoYXZpb3JzW25hbWVdIHx8ICh0aGlzLmhhc1BhcmVudCA/IHRoaXMucGFyZW50LmdldEJpbmRpbmdCZWhhdmlvcihuYW1lKSA6IG51bGwpO1xuICB9XG5cbiAgcmVnaXN0ZXJWYWx1ZShuYW1lLCB2YWx1ZSkge1xuICAgIHJlZ2lzdGVyKHRoaXMudmFsdWVzLCBuYW1lLCB2YWx1ZSwgJ2EgdmFsdWUnKTtcbiAgfVxuXG4gIGdldFZhbHVlKG5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZXNbbmFtZV0gfHwgKHRoaXMuaGFzUGFyZW50ID8gdGhpcy5wYXJlbnQuZ2V0VmFsdWUobmFtZSkgOiBudWxsKTtcbiAgfVxuXG4gIGF1dG9SZWdpc3Rlcihjb250YWluZXIsIGltcGwpIHtcbiAgICBsZXQgcmVzb3VyY2VUeXBlTWV0YSA9IG1ldGFkYXRhLmdldE93bihtZXRhZGF0YS5yZXNvdXJjZSwgaW1wbCk7XG4gICAgaWYgKHJlc291cmNlVHlwZU1ldGEpIHtcbiAgICAgIGlmIChyZXNvdXJjZVR5cGVNZXRhIGluc3RhbmNlb2YgSHRtbEJlaGF2aW9yUmVzb3VyY2UpIHtcbiAgICAgICAgVmlld1Jlc291cmNlcy5jb252ZW50aW9uKGltcGwsIHJlc291cmNlVHlwZU1ldGEpO1xuXG4gICAgICAgIGlmIChyZXNvdXJjZVR5cGVNZXRhLmF0dHJpYnV0ZU5hbWUgPT09IG51bGwgJiYgcmVzb3VyY2VUeXBlTWV0YS5lbGVtZW50TmFtZSA9PT0gbnVsbCkge1xuICAgICAgICAgIEh0bWxCZWhhdmlvclJlc291cmNlLmNvbnZlbnRpb24oaW1wbC5uYW1lLCByZXNvdXJjZVR5cGVNZXRhKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzb3VyY2VUeXBlTWV0YS5hdHRyaWJ1dGVOYW1lID09PSBudWxsICYmIHJlc291cmNlVHlwZU1ldGEuZWxlbWVudE5hbWUgPT09IG51bGwpIHtcbiAgICAgICAgICByZXNvdXJjZVR5cGVNZXRhLmVsZW1lbnROYW1lID0gX2h5cGhlbmF0ZShpbXBsLm5hbWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc291cmNlVHlwZU1ldGEgPSBWaWV3UmVzb3VyY2VzLmNvbnZlbnRpb24oaW1wbCkgfHwgSHRtbEJlaGF2aW9yUmVzb3VyY2UuY29udmVudGlvbihpbXBsLm5hbWUpIHx8IFZhbHVlQ29udmVydGVyUmVzb3VyY2UuY29udmVudGlvbihpbXBsLm5hbWUpIHx8IEJpbmRpbmdCZWhhdmlvclJlc291cmNlLmNvbnZlbnRpb24oaW1wbC5uYW1lKSB8fCBWaWV3RW5naW5lSG9va3NSZXNvdXJjZS5jb252ZW50aW9uKGltcGwubmFtZSk7XG4gICAgICBpZiAoIXJlc291cmNlVHlwZU1ldGEpIHtcbiAgICAgICAgcmVzb3VyY2VUeXBlTWV0YSA9IG5ldyBIdG1sQmVoYXZpb3JSZXNvdXJjZSgpO1xuICAgICAgICByZXNvdXJjZVR5cGVNZXRhLmVsZW1lbnROYW1lID0gX2h5cGhlbmF0ZShpbXBsLm5hbWUpO1xuICAgICAgfVxuICAgICAgbWV0YWRhdGEuZGVmaW5lKG1ldGFkYXRhLnJlc291cmNlLCByZXNvdXJjZVR5cGVNZXRhLCBpbXBsKTtcbiAgICB9XG4gICAgcmVzb3VyY2VUeXBlTWV0YS5pbml0aWFsaXplKGNvbnRhaW5lciwgaW1wbCk7XG4gICAgcmVzb3VyY2VUeXBlTWV0YS5yZWdpc3Rlcih0aGlzKTtcbiAgICByZXR1cm4gcmVzb3VyY2VUeXBlTWV0YTtcbiAgfVxufTtcblxuZXhwb3J0IGxldCBWaWV3ID0gY2xhc3MgVmlldyB7XG4gIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgdmlld0ZhY3RvcnksIGZyYWdtZW50LCBjb250cm9sbGVycywgYmluZGluZ3MsIGNoaWxkcmVuLCBzbG90cykge1xuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICB0aGlzLnJlc291cmNlcyA9IHZpZXdGYWN0b3J5LnJlc291cmNlcztcbiAgICB0aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgdGhpcy5maXJzdENoaWxkID0gZnJhZ21lbnQuZmlyc3RDaGlsZDtcbiAgICB0aGlzLmxhc3RDaGlsZCA9IGZyYWdtZW50Lmxhc3RDaGlsZDtcbiAgICB0aGlzLmNvbnRyb2xsZXJzID0gY29udHJvbGxlcnM7XG4gICAgdGhpcy5iaW5kaW5ncyA9IGJpbmRpbmdzO1xuICAgIHRoaXMuY2hpbGRyZW4gPSBjaGlsZHJlbjtcbiAgICB0aGlzLnNsb3RzID0gc2xvdHM7XG4gICAgdGhpcy5oYXNTbG90cyA9IGZhbHNlO1xuICAgIHRoaXMuZnJvbUNhY2hlID0gZmFsc2U7XG4gICAgdGhpcy5pc0JvdW5kID0gZmFsc2U7XG4gICAgdGhpcy5pc0F0dGFjaGVkID0gZmFsc2U7XG4gICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IG51bGw7XG4gICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBudWxsO1xuICAgIHRoaXMuY29udHJvbGxlciA9IG51bGw7XG4gICAgdGhpcy52aWV3TW9kZWxTY29wZSA9IG51bGw7XG4gICAgdGhpcy5hbmltYXRhYmxlRWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl9pc1VzZXJDb250cm9sbGVkID0gZmFsc2U7XG4gICAgdGhpcy5jb250ZW50VmlldyA9IG51bGw7XG5cbiAgICBmb3IgKGxldCBrZXkgaW4gc2xvdHMpIHtcbiAgICAgIHRoaXMuaGFzU2xvdHMgPSB0cnVlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuVG9DYWNoZSgpIHtcbiAgICB0aGlzLnZpZXdGYWN0b3J5LnJldHVyblZpZXdUb0NhY2hlKHRoaXMpO1xuICB9XG5cbiAgY3JlYXRlZCgpIHtcbiAgICBsZXQgaTtcbiAgICBsZXQgaWk7XG4gICAgbGV0IGNvbnRyb2xsZXJzID0gdGhpcy5jb250cm9sbGVycztcblxuICAgIGZvciAoaSA9IDAsIGlpID0gY29udHJvbGxlcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgY29udHJvbGxlcnNbaV0uY3JlYXRlZCh0aGlzKTtcbiAgICB9XG4gIH1cblxuICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQsIF9zeXN0ZW1VcGRhdGUpIHtcbiAgICBsZXQgY29udHJvbGxlcnM7XG4gICAgbGV0IGJpbmRpbmdzO1xuICAgIGxldCBjaGlsZHJlbjtcbiAgICBsZXQgaTtcbiAgICBsZXQgaWk7XG5cbiAgICBpZiAoX3N5c3RlbVVwZGF0ZSAmJiB0aGlzLl9pc1VzZXJDb250cm9sbGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgaWYgKHRoaXMuYmluZGluZ0NvbnRleHQgPT09IGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBiaW5kaW5nQ29udGV4dDtcbiAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dCB8fCBjcmVhdGVPdmVycmlkZUNvbnRleHQoYmluZGluZ0NvbnRleHQpO1xuXG4gICAgdGhpcy5yZXNvdXJjZXMuX2ludm9rZUhvb2soJ2JlZm9yZUJpbmQnLCB0aGlzKTtcblxuICAgIGJpbmRpbmdzID0gdGhpcy5iaW5kaW5ncztcbiAgICBmb3IgKGkgPSAwLCBpaSA9IGJpbmRpbmdzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGJpbmRpbmdzW2ldLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlld01vZGVsU2NvcGUgIT09IG51bGwpIHtcbiAgICAgIGJpbmRpbmdDb250ZXh0LmJpbmQodGhpcy52aWV3TW9kZWxTY29wZS5iaW5kaW5nQ29udGV4dCwgdGhpcy52aWV3TW9kZWxTY29wZS5vdmVycmlkZUNvbnRleHQpO1xuICAgICAgdGhpcy52aWV3TW9kZWxTY29wZSA9IG51bGw7XG4gICAgfVxuXG4gICAgY29udHJvbGxlcnMgPSB0aGlzLmNvbnRyb2xsZXJzO1xuICAgIGZvciAoaSA9IDAsIGlpID0gY29udHJvbGxlcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgY29udHJvbGxlcnNbaV0uYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgZm9yIChpID0gMCwgaWkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjaGlsZHJlbltpXS5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQsIHRydWUpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmhhc1Nsb3RzKSB7XG4gICAgICBTaGFkb3dET00uZGlzdHJpYnV0ZVZpZXcodGhpcy5jb250ZW50VmlldywgdGhpcy5zbG90cyk7XG4gICAgfVxuICB9XG5cbiAgYWRkQmluZGluZyhiaW5kaW5nKSB7XG4gICAgdGhpcy5iaW5kaW5ncy5wdXNoKGJpbmRpbmcpO1xuXG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgYmluZGluZy5iaW5kKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIHVuYmluZCgpIHtcbiAgICBsZXQgY29udHJvbGxlcnM7XG4gICAgbGV0IGJpbmRpbmdzO1xuICAgIGxldCBjaGlsZHJlbjtcbiAgICBsZXQgaTtcbiAgICBsZXQgaWk7XG5cbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcbiAgICAgIHRoaXMucmVzb3VyY2VzLl9pbnZva2VIb29rKCdiZWZvcmVVbmJpbmQnLCB0aGlzKTtcblxuICAgICAgaWYgKHRoaXMuY29udHJvbGxlciAhPT0gbnVsbCkge1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIudW5iaW5kKCk7XG4gICAgICB9XG5cbiAgICAgIGJpbmRpbmdzID0gdGhpcy5iaW5kaW5ncztcbiAgICAgIGZvciAoaSA9IDAsIGlpID0gYmluZGluZ3MubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBiaW5kaW5nc1tpXS51bmJpbmQoKTtcbiAgICAgIH1cblxuICAgICAgY29udHJvbGxlcnMgPSB0aGlzLmNvbnRyb2xsZXJzO1xuICAgICAgZm9yIChpID0gMCwgaWkgPSBjb250cm9sbGVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGNvbnRyb2xsZXJzW2ldLnVuYmluZCgpO1xuICAgICAgfVxuXG4gICAgICBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgY2hpbGRyZW5baV0udW5iaW5kKCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBudWxsO1xuICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGluc2VydE5vZGVzQmVmb3JlKHJlZk5vZGUpIHtcbiAgICByZWZOb2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMuZnJhZ21lbnQsIHJlZk5vZGUpO1xuICB9XG5cbiAgYXBwZW5kTm9kZXNUbyhwYXJlbnQpIHtcbiAgICBwYXJlbnQuYXBwZW5kQ2hpbGQodGhpcy5mcmFnbWVudCk7XG4gIH1cblxuICByZW1vdmVOb2RlcygpIHtcbiAgICBsZXQgZnJhZ21lbnQgPSB0aGlzLmZyYWdtZW50O1xuICAgIGxldCBjdXJyZW50ID0gdGhpcy5maXJzdENoaWxkO1xuICAgIGxldCBlbmQgPSB0aGlzLmxhc3RDaGlsZDtcbiAgICBsZXQgbmV4dDtcblxuICAgIHdoaWxlIChjdXJyZW50KSB7XG4gICAgICBuZXh0ID0gY3VycmVudC5uZXh0U2libGluZztcbiAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGN1cnJlbnQpO1xuXG4gICAgICBpZiAoY3VycmVudCA9PT0gZW5kKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBjdXJyZW50ID0gbmV4dDtcbiAgICB9XG4gIH1cblxuICBhdHRhY2hlZCgpIHtcbiAgICBsZXQgY29udHJvbGxlcnM7XG4gICAgbGV0IGNoaWxkcmVuO1xuICAgIGxldCBpO1xuICAgIGxldCBpaTtcblxuICAgIGlmICh0aGlzLmlzQXR0YWNoZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmlzQXR0YWNoZWQgPSB0cnVlO1xuXG4gICAgaWYgKHRoaXMuY29udHJvbGxlciAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5jb250cm9sbGVyLmF0dGFjaGVkKCk7XG4gICAgfVxuXG4gICAgY29udHJvbGxlcnMgPSB0aGlzLmNvbnRyb2xsZXJzO1xuICAgIGZvciAoaSA9IDAsIGlpID0gY29udHJvbGxlcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgY29udHJvbGxlcnNbaV0uYXR0YWNoZWQoKTtcbiAgICB9XG5cbiAgICBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgZm9yIChpID0gMCwgaWkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjaGlsZHJlbltpXS5hdHRhY2hlZCgpO1xuICAgIH1cbiAgfVxuXG4gIGRldGFjaGVkKCkge1xuICAgIGxldCBjb250cm9sbGVycztcbiAgICBsZXQgY2hpbGRyZW47XG4gICAgbGV0IGk7XG4gICAgbGV0IGlpO1xuXG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgdGhpcy5pc0F0dGFjaGVkID0gZmFsc2U7XG5cbiAgICAgIGlmICh0aGlzLmNvbnRyb2xsZXIgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5jb250cm9sbGVyLmRldGFjaGVkKCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnRyb2xsZXJzID0gdGhpcy5jb250cm9sbGVycztcbiAgICAgIGZvciAoaSA9IDAsIGlpID0gY29udHJvbGxlcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBjb250cm9sbGVyc1tpXS5kZXRhY2hlZCgpO1xuICAgICAgfVxuXG4gICAgICBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgY2hpbGRyZW5baV0uZGV0YWNoZWQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGdldEFuaW1hdGFibGVFbGVtZW50KHZpZXcpIHtcbiAgaWYgKHZpZXcuYW5pbWF0YWJsZUVsZW1lbnQgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB2aWV3LmFuaW1hdGFibGVFbGVtZW50O1xuICB9XG5cbiAgbGV0IGN1cnJlbnQgPSB2aWV3LmZpcnN0Q2hpbGQ7XG5cbiAgd2hpbGUgKGN1cnJlbnQgJiYgY3VycmVudC5ub2RlVHlwZSAhPT0gMSkge1xuICAgIGN1cnJlbnQgPSBjdXJyZW50Lm5leHRTaWJsaW5nO1xuICB9XG5cbiAgaWYgKGN1cnJlbnQgJiYgY3VycmVudC5ub2RlVHlwZSA9PT0gMSkge1xuICAgIHJldHVybiB2aWV3LmFuaW1hdGFibGVFbGVtZW50ID0gY3VycmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2F1LWFuaW1hdGUnKSA/IGN1cnJlbnQgOiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIHZpZXcuYW5pbWF0YWJsZUVsZW1lbnQgPSBudWxsO1xufVxuXG5leHBvcnQgbGV0IFZpZXdTbG90ID0gY2xhc3MgVmlld1Nsb3Qge1xuICBjb25zdHJ1Y3RvcihhbmNob3IsIGFuY2hvcklzQ29udGFpbmVyLCBhbmltYXRvciA9IEFuaW1hdG9yLmluc3RhbmNlKSB7XG4gICAgdGhpcy5hbmNob3IgPSBhbmNob3I7XG4gICAgdGhpcy5hbmNob3JJc0NvbnRhaW5lciA9IGFuY2hvcklzQ29udGFpbmVyO1xuICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBudWxsO1xuICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcbiAgICB0aGlzLmFuaW1hdG9yID0gYW5pbWF0b3I7XG4gICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIHRoaXMuaXNBdHRhY2hlZCA9IGZhbHNlO1xuICAgIHRoaXMuY29udGVudFNlbGVjdG9ycyA9IG51bGw7XG4gICAgYW5jaG9yLnZpZXdTbG90ID0gdGhpcztcbiAgICBhbmNob3IuaXNDb250ZW50UHJvamVjdGlvblNvdXJjZSA9IGZhbHNlO1xuICB9XG5cbiAgYW5pbWF0ZVZpZXcodmlldywgZGlyZWN0aW9uID0gJ2VudGVyJykge1xuICAgIGxldCBhbmltYXRhYmxlRWxlbWVudCA9IGdldEFuaW1hdGFibGVFbGVtZW50KHZpZXcpO1xuXG4gICAgaWYgKGFuaW1hdGFibGVFbGVtZW50ICE9PSBudWxsKSB7XG4gICAgICBzd2l0Y2ggKGRpcmVjdGlvbikge1xuICAgICAgICBjYXNlICdlbnRlcic6XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0b3IuZW50ZXIoYW5pbWF0YWJsZUVsZW1lbnQpO1xuICAgICAgICBjYXNlICdsZWF2ZSc6XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0b3IubGVhdmUoYW5pbWF0YWJsZUVsZW1lbnQpO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhbmltYXRpb24gZGlyZWN0aW9uOiAnICsgZGlyZWN0aW9uKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB0cmFuc2Zvcm1DaGlsZE5vZGVzSW50b1ZpZXcoKSB7XG4gICAgbGV0IHBhcmVudCA9IHRoaXMuYW5jaG9yO1xuXG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKHtcbiAgICAgIGZyYWdtZW50OiBwYXJlbnQsXG4gICAgICBmaXJzdENoaWxkOiBwYXJlbnQuZmlyc3RDaGlsZCxcbiAgICAgIGxhc3RDaGlsZDogcGFyZW50Lmxhc3RDaGlsZCxcbiAgICAgIHJldHVyblRvQ2FjaGUoKSB7fSxcbiAgICAgIHJlbW92ZU5vZGVzKCkge1xuICAgICAgICBsZXQgbGFzdDtcblxuICAgICAgICB3aGlsZSAobGFzdCA9IHBhcmVudC5sYXN0Q2hpbGQpIHtcbiAgICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQobGFzdCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjcmVhdGVkKCkge30sXG4gICAgICBiaW5kKCkge30sXG4gICAgICB1bmJpbmQoKSB7fSxcbiAgICAgIGF0dGFjaGVkKCkge30sXG4gICAgICBkZXRhY2hlZCgpIHt9XG4gICAgfSk7XG4gIH1cblxuICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcbiAgICBsZXQgaTtcbiAgICBsZXQgaWk7XG4gICAgbGV0IGNoaWxkcmVuO1xuXG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgaWYgKHRoaXMuYmluZGluZ0NvbnRleHQgPT09IGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBiaW5kaW5nQ29udGV4dCA9IGJpbmRpbmdDb250ZXh0IHx8IHRoaXMuYmluZGluZ0NvbnRleHQ7XG4gICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQgfHwgdGhpcy5vdmVycmlkZUNvbnRleHQ7XG5cbiAgICBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgZm9yIChpID0gMCwgaWkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjaGlsZHJlbltpXS5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIHVuYmluZCgpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBsZXQgaTtcbiAgICAgIGxldCBpaTtcbiAgICAgIGxldCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG5cbiAgICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IG51bGw7XG4gICAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG51bGw7XG5cbiAgICAgIGZvciAoaSA9IDAsIGlpID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBjaGlsZHJlbltpXS51bmJpbmQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhZGQodmlldykge1xuICAgIGlmICh0aGlzLmFuY2hvcklzQ29udGFpbmVyKSB7XG4gICAgICB2aWV3LmFwcGVuZE5vZGVzVG8odGhpcy5hbmNob3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2aWV3Lmluc2VydE5vZGVzQmVmb3JlKHRoaXMuYW5jaG9yKTtcbiAgICB9XG5cbiAgICB0aGlzLmNoaWxkcmVuLnB1c2godmlldyk7XG5cbiAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICB2aWV3LmF0dGFjaGVkKCk7XG4gICAgICByZXR1cm4gdGhpcy5hbmltYXRlVmlldyh2aWV3LCAnZW50ZXInKTtcbiAgICB9XG4gIH1cblxuICBpbnNlcnQoaW5kZXgsIHZpZXcpIHtcbiAgICBsZXQgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xuICAgIGxldCBsZW5ndGggPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICBpZiAoaW5kZXggPT09IDAgJiYgbGVuZ3RoID09PSAwIHx8IGluZGV4ID49IGxlbmd0aCkge1xuICAgICAgcmV0dXJuIHRoaXMuYWRkKHZpZXcpO1xuICAgIH1cblxuICAgIHZpZXcuaW5zZXJ0Tm9kZXNCZWZvcmUoY2hpbGRyZW5baW5kZXhdLmZpcnN0Q2hpbGQpO1xuICAgIGNoaWxkcmVuLnNwbGljZShpbmRleCwgMCwgdmlldyk7XG5cbiAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICB2aWV3LmF0dGFjaGVkKCk7XG4gICAgICByZXR1cm4gdGhpcy5hbmltYXRlVmlldyh2aWV3LCAnZW50ZXInKTtcbiAgICB9XG4gIH1cblxuICBtb3ZlKHNvdXJjZUluZGV4LCB0YXJnZXRJbmRleCkge1xuICAgIGlmIChzb3VyY2VJbmRleCA9PT0gdGFyZ2V0SW5kZXgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgY29uc3QgdmlldyA9IGNoaWxkcmVuW3NvdXJjZUluZGV4XTtcblxuICAgIHZpZXcucmVtb3ZlTm9kZXMoKTtcbiAgICB2aWV3Lmluc2VydE5vZGVzQmVmb3JlKGNoaWxkcmVuW3RhcmdldEluZGV4XS5maXJzdENoaWxkKTtcbiAgICBjaGlsZHJlbi5zcGxpY2Uoc291cmNlSW5kZXgsIDEpO1xuICAgIGNoaWxkcmVuLnNwbGljZSh0YXJnZXRJbmRleCwgMCwgdmlldyk7XG4gIH1cblxuICByZW1vdmUodmlldywgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xuICAgIHJldHVybiB0aGlzLnJlbW92ZUF0KHRoaXMuY2hpbGRyZW4uaW5kZXhPZih2aWV3KSwgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbik7XG4gIH1cblxuICByZW1vdmVNYW55KHZpZXdzVG9SZW1vdmUsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcbiAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgbGV0IGlpID0gdmlld3NUb1JlbW92ZS5sZW5ndGg7XG4gICAgbGV0IGk7XG4gICAgbGV0IHJtUHJvbWlzZXMgPSBbXTtcblxuICAgIHZpZXdzVG9SZW1vdmUuZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICBpZiAoc2tpcEFuaW1hdGlvbikge1xuICAgICAgICBjaGlsZC5yZW1vdmVOb2RlcygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBhbmltYXRpb24gPSB0aGlzLmFuaW1hdGVWaWV3KGNoaWxkLCAnbGVhdmUnKTtcbiAgICAgIGlmIChhbmltYXRpb24pIHtcbiAgICAgICAgcm1Qcm9taXNlcy5wdXNoKGFuaW1hdGlvbi50aGVuKCgpID0+IGNoaWxkLnJlbW92ZU5vZGVzKCkpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoaWxkLnJlbW92ZU5vZGVzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBsZXQgcmVtb3ZlQWN0aW9uID0gKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgIHZpZXdzVG9SZW1vdmVbaV0uZGV0YWNoZWQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAocmV0dXJuVG9DYWNoZSkge1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgIHZpZXdzVG9SZW1vdmVbaV0ucmV0dXJuVG9DYWNoZSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gY2hpbGRyZW4uaW5kZXhPZih2aWV3c1RvUmVtb3ZlW2ldKTtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICBjaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmIChybVByb21pc2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChybVByb21pc2VzKS50aGVuKCgpID0+IHJlbW92ZUFjdGlvbigpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVtb3ZlQWN0aW9uKCk7XG4gIH1cblxuICByZW1vdmVBdChpbmRleCwgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xuICAgIGxldCB2aWV3ID0gdGhpcy5jaGlsZHJlbltpbmRleF07XG5cbiAgICBsZXQgcmVtb3ZlQWN0aW9uID0gKCkgPT4ge1xuICAgICAgaW5kZXggPSB0aGlzLmNoaWxkcmVuLmluZGV4T2Yodmlldyk7XG4gICAgICB2aWV3LnJlbW92ZU5vZGVzKCk7XG4gICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAgIGlmICh0aGlzLmlzQXR0YWNoZWQpIHtcbiAgICAgICAgdmlldy5kZXRhY2hlZCgpO1xuICAgICAgfVxuXG4gICAgICBpZiAocmV0dXJuVG9DYWNoZSkge1xuICAgICAgICB2aWV3LnJldHVyblRvQ2FjaGUoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHZpZXc7XG4gICAgfTtcblxuICAgIGlmICghc2tpcEFuaW1hdGlvbikge1xuICAgICAgbGV0IGFuaW1hdGlvbiA9IHRoaXMuYW5pbWF0ZVZpZXcodmlldywgJ2xlYXZlJyk7XG4gICAgICBpZiAoYW5pbWF0aW9uKSB7XG4gICAgICAgIHJldHVybiBhbmltYXRpb24udGhlbigoKSA9PiByZW1vdmVBY3Rpb24oKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlbW92ZUFjdGlvbigpO1xuICB9XG5cbiAgcmVtb3ZlQWxsKHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcbiAgICBsZXQgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xuICAgIGxldCBpaSA9IGNoaWxkcmVuLmxlbmd0aDtcbiAgICBsZXQgaTtcbiAgICBsZXQgcm1Qcm9taXNlcyA9IFtdO1xuXG4gICAgY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICBpZiAoc2tpcEFuaW1hdGlvbikge1xuICAgICAgICBjaGlsZC5yZW1vdmVOb2RlcygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBhbmltYXRpb24gPSB0aGlzLmFuaW1hdGVWaWV3KGNoaWxkLCAnbGVhdmUnKTtcbiAgICAgIGlmIChhbmltYXRpb24pIHtcbiAgICAgICAgcm1Qcm9taXNlcy5wdXNoKGFuaW1hdGlvbi50aGVuKCgpID0+IGNoaWxkLnJlbW92ZU5vZGVzKCkpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoaWxkLnJlbW92ZU5vZGVzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBsZXQgcmVtb3ZlQWN0aW9uID0gKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgIGNoaWxkcmVuW2ldLmRldGFjaGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHJldHVyblRvQ2FjaGUpIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgaWYgKGNoaWxkKSB7XG4gICAgICAgICAgICBjaGlsZC5yZXR1cm5Ub0NhY2hlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbiAgICB9O1xuXG4gICAgaWYgKHJtUHJvbWlzZXMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHJtUHJvbWlzZXMpLnRoZW4oKCkgPT4gcmVtb3ZlQWN0aW9uKCkpO1xuICAgIH1cblxuICAgIHJldHVybiByZW1vdmVBY3Rpb24oKTtcbiAgfVxuXG4gIGF0dGFjaGVkKCkge1xuICAgIGxldCBpO1xuICAgIGxldCBpaTtcbiAgICBsZXQgY2hpbGRyZW47XG4gICAgbGV0IGNoaWxkO1xuXG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNBdHRhY2hlZCA9IHRydWU7XG5cbiAgICBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgZm9yIChpID0gMCwgaWkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjaGlsZCA9IGNoaWxkcmVuW2ldO1xuICAgICAgY2hpbGQuYXR0YWNoZWQoKTtcbiAgICAgIHRoaXMuYW5pbWF0ZVZpZXcoY2hpbGQsICdlbnRlcicpO1xuICAgIH1cbiAgfVxuXG4gIGRldGFjaGVkKCkge1xuICAgIGxldCBpO1xuICAgIGxldCBpaTtcbiAgICBsZXQgY2hpbGRyZW47XG5cbiAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICB0aGlzLmlzQXR0YWNoZWQgPSBmYWxzZTtcbiAgICAgIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICAgIGZvciAoaSA9IDAsIGlpID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBjaGlsZHJlbltpXS5kZXRhY2hlZCgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByb2plY3RUbyhzbG90cykge1xuICAgIHRoaXMucHJvamVjdFRvU2xvdHMgPSBzbG90cztcbiAgICB0aGlzLmFkZCA9IHRoaXMuX3Byb2plY3Rpb25BZGQ7XG4gICAgdGhpcy5pbnNlcnQgPSB0aGlzLl9wcm9qZWN0aW9uSW5zZXJ0O1xuICAgIHRoaXMubW92ZSA9IHRoaXMuX3Byb2plY3Rpb25Nb3ZlO1xuICAgIHRoaXMucmVtb3ZlID0gdGhpcy5fcHJvamVjdGlvblJlbW92ZTtcbiAgICB0aGlzLnJlbW92ZUF0ID0gdGhpcy5fcHJvamVjdGlvblJlbW92ZUF0O1xuICAgIHRoaXMucmVtb3ZlTWFueSA9IHRoaXMuX3Byb2plY3Rpb25SZW1vdmVNYW55O1xuICAgIHRoaXMucmVtb3ZlQWxsID0gdGhpcy5fcHJvamVjdGlvblJlbW92ZUFsbDtcbiAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2godmlldyA9PiBTaGFkb3dET00uZGlzdHJpYnV0ZVZpZXcodmlldywgc2xvdHMsIHRoaXMpKTtcbiAgfVxuXG4gIF9wcm9qZWN0aW9uQWRkKHZpZXcpIHtcbiAgICBTaGFkb3dET00uZGlzdHJpYnV0ZVZpZXcodmlldywgdGhpcy5wcm9qZWN0VG9TbG90cywgdGhpcyk7XG5cbiAgICB0aGlzLmNoaWxkcmVuLnB1c2godmlldyk7XG5cbiAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICB2aWV3LmF0dGFjaGVkKCk7XG4gICAgfVxuICB9XG5cbiAgX3Byb2plY3Rpb25JbnNlcnQoaW5kZXgsIHZpZXcpIHtcbiAgICBpZiAoaW5kZXggPT09IDAgJiYgIXRoaXMuY2hpbGRyZW4ubGVuZ3RoIHx8IGluZGV4ID49IHRoaXMuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICB0aGlzLmFkZCh2aWV3KTtcbiAgICB9IGVsc2Uge1xuICAgICAgU2hhZG93RE9NLmRpc3RyaWJ1dGVWaWV3KHZpZXcsIHRoaXMucHJvamVjdFRvU2xvdHMsIHRoaXMsIGluZGV4KTtcblxuICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDAsIHZpZXcpO1xuXG4gICAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICAgIHZpZXcuYXR0YWNoZWQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfcHJvamVjdGlvbk1vdmUoc291cmNlSW5kZXgsIHRhcmdldEluZGV4KSB7XG4gICAgaWYgKHNvdXJjZUluZGV4ID09PSB0YXJnZXRJbmRleCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICBjb25zdCB2aWV3ID0gY2hpbGRyZW5bc291cmNlSW5kZXhdO1xuXG4gICAgU2hhZG93RE9NLnVuZGlzdHJpYnV0ZVZpZXcodmlldywgdGhpcy5wcm9qZWN0VG9TbG90cywgdGhpcyk7XG4gICAgU2hhZG93RE9NLmRpc3RyaWJ1dGVWaWV3KHZpZXcsIHRoaXMucHJvamVjdFRvU2xvdHMsIHRoaXMsIHRhcmdldEluZGV4KTtcblxuICAgIGNoaWxkcmVuLnNwbGljZShzb3VyY2VJbmRleCwgMSk7XG4gICAgY2hpbGRyZW4uc3BsaWNlKHRhcmdldEluZGV4LCAwLCB2aWV3KTtcbiAgfVxuXG4gIF9wcm9qZWN0aW9uUmVtb3ZlKHZpZXcsIHJldHVyblRvQ2FjaGUpIHtcbiAgICBTaGFkb3dET00udW5kaXN0cmlidXRlVmlldyh2aWV3LCB0aGlzLnByb2plY3RUb1Nsb3RzLCB0aGlzKTtcbiAgICB0aGlzLmNoaWxkcmVuLnNwbGljZSh0aGlzLmNoaWxkcmVuLmluZGV4T2YodmlldyksIDEpO1xuXG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgdmlldy5kZXRhY2hlZCgpO1xuICAgIH1cbiAgICBpZiAocmV0dXJuVG9DYWNoZSkge1xuICAgICAgdmlldy5yZXR1cm5Ub0NhY2hlKCk7XG4gICAgfVxuICB9XG5cbiAgX3Byb2plY3Rpb25SZW1vdmVBdChpbmRleCwgcmV0dXJuVG9DYWNoZSkge1xuICAgIGxldCB2aWV3ID0gdGhpcy5jaGlsZHJlbltpbmRleF07XG5cbiAgICBTaGFkb3dET00udW5kaXN0cmlidXRlVmlldyh2aWV3LCB0aGlzLnByb2plY3RUb1Nsb3RzLCB0aGlzKTtcbiAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICB2aWV3LmRldGFjaGVkKCk7XG4gICAgfVxuICAgIGlmIChyZXR1cm5Ub0NhY2hlKSB7XG4gICAgICB2aWV3LnJldHVyblRvQ2FjaGUoKTtcbiAgICB9XG4gIH1cblxuICBfcHJvamVjdGlvblJlbW92ZU1hbnkodmlld3NUb1JlbW92ZSwgcmV0dXJuVG9DYWNoZSkge1xuICAgIHZpZXdzVG9SZW1vdmUuZm9yRWFjaCh2aWV3ID0+IHRoaXMucmVtb3ZlKHZpZXcsIHJldHVyblRvQ2FjaGUpKTtcbiAgfVxuXG4gIF9wcm9qZWN0aW9uUmVtb3ZlQWxsKHJldHVyblRvQ2FjaGUpIHtcbiAgICBTaGFkb3dET00udW5kaXN0cmlidXRlQWxsKHRoaXMucHJvamVjdFRvU2xvdHMsIHRoaXMpO1xuXG4gICAgbGV0IGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICBsZXQgaWkgPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGlmIChyZXR1cm5Ub0NhY2hlKSB7XG4gICAgICAgIGNoaWxkcmVuW2ldLnJldHVyblRvQ2FjaGUoKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICAgIGNoaWxkcmVuW2ldLmRldGFjaGVkKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuICB9XG59O1xuXG5sZXQgUHJvdmlkZXJSZXNvbHZlciA9IHJlc29sdmVyKF9jbGFzczEyID0gY2xhc3MgUHJvdmlkZXJSZXNvbHZlciB7XG4gIGdldChjb250YWluZXIsIGtleSkge1xuICAgIGxldCBpZCA9IGtleS5fX3Byb3ZpZGVySWRfXztcbiAgICByZXR1cm4gaWQgaW4gY29udGFpbmVyID8gY29udGFpbmVyW2lkXSA6IGNvbnRhaW5lcltpZF0gPSBjb250YWluZXIuaW52b2tlKGtleSk7XG4gIH1cbn0pIHx8IF9jbGFzczEyO1xuXG5sZXQgcHJvdmlkZXJSZXNvbHZlckluc3RhbmNlID0gbmV3IFByb3ZpZGVyUmVzb2x2ZXIoKTtcblxuZnVuY3Rpb24gZWxlbWVudENvbnRhaW5lckdldChrZXkpIHtcbiAgaWYgKGtleSA9PT0gRE9NLkVsZW1lbnQpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50O1xuICB9XG5cbiAgaWYgKGtleSA9PT0gQm91bmRWaWV3RmFjdG9yeSkge1xuICAgIGlmICh0aGlzLmJvdW5kVmlld0ZhY3RvcnkpIHtcbiAgICAgIHJldHVybiB0aGlzLmJvdW5kVmlld0ZhY3Rvcnk7XG4gICAgfVxuXG4gICAgbGV0IGZhY3RvcnkgPSB0aGlzLmluc3RydWN0aW9uLnZpZXdGYWN0b3J5O1xuICAgIGxldCBwYXJ0UmVwbGFjZW1lbnRzID0gdGhpcy5wYXJ0UmVwbGFjZW1lbnRzO1xuXG4gICAgaWYgKHBhcnRSZXBsYWNlbWVudHMpIHtcbiAgICAgIGZhY3RvcnkgPSBwYXJ0UmVwbGFjZW1lbnRzW2ZhY3RvcnkucGFydF0gfHwgZmFjdG9yeTtcbiAgICB9XG5cbiAgICB0aGlzLmJvdW5kVmlld0ZhY3RvcnkgPSBuZXcgQm91bmRWaWV3RmFjdG9yeSh0aGlzLCBmYWN0b3J5LCBwYXJ0UmVwbGFjZW1lbnRzKTtcbiAgICByZXR1cm4gdGhpcy5ib3VuZFZpZXdGYWN0b3J5O1xuICB9XG5cbiAgaWYgKGtleSA9PT0gVmlld1Nsb3QpIHtcbiAgICBpZiAodGhpcy52aWV3U2xvdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnZpZXdTbG90ID0gbmV3IFZpZXdTbG90KHRoaXMuZWxlbWVudCwgdGhpcy5pbnN0cnVjdGlvbi5hbmNob3JJc0NvbnRhaW5lcik7XG4gICAgICB0aGlzLmVsZW1lbnQuaXNDb250ZW50UHJvamVjdGlvblNvdXJjZSA9IHRoaXMuaW5zdHJ1Y3Rpb24ubGlmdGluZztcbiAgICAgIHRoaXMuY2hpbGRyZW4ucHVzaCh0aGlzLnZpZXdTbG90KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy52aWV3U2xvdDtcbiAgfVxuXG4gIGlmIChrZXkgPT09IEVsZW1lbnRFdmVudHMpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50RXZlbnRzIHx8ICh0aGlzLmVsZW1lbnRFdmVudHMgPSBuZXcgRWxlbWVudEV2ZW50cyh0aGlzLmVsZW1lbnQpKTtcbiAgfVxuXG4gIGlmIChrZXkgPT09IENvbXBvc2l0aW9uVHJhbnNhY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uIHx8ICh0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb24gPSB0aGlzLnBhcmVudC5nZXQoa2V5KSk7XG4gIH1cblxuICBpZiAoa2V5ID09PSBWaWV3UmVzb3VyY2VzKSB7XG4gICAgcmV0dXJuIHRoaXMudmlld1Jlc291cmNlcztcbiAgfVxuXG4gIGlmIChrZXkgPT09IFRhcmdldEluc3RydWN0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5zdHJ1Y3Rpb247XG4gIH1cblxuICByZXR1cm4gdGhpcy5zdXBlckdldChrZXkpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVFbGVtZW50Q29udGFpbmVyKHBhcmVudCwgZWxlbWVudCwgaW5zdHJ1Y3Rpb24sIGNoaWxkcmVuLCBwYXJ0UmVwbGFjZW1lbnRzLCByZXNvdXJjZXMpIHtcbiAgbGV0IGNvbnRhaW5lciA9IHBhcmVudC5jcmVhdGVDaGlsZCgpO1xuICBsZXQgcHJvdmlkZXJzO1xuICBsZXQgaTtcblxuICBjb250YWluZXIuZWxlbWVudCA9IGVsZW1lbnQ7XG4gIGNvbnRhaW5lci5pbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uO1xuICBjb250YWluZXIuY2hpbGRyZW4gPSBjaGlsZHJlbjtcbiAgY29udGFpbmVyLnZpZXdSZXNvdXJjZXMgPSByZXNvdXJjZXM7XG4gIGNvbnRhaW5lci5wYXJ0UmVwbGFjZW1lbnRzID0gcGFydFJlcGxhY2VtZW50cztcblxuICBwcm92aWRlcnMgPSBpbnN0cnVjdGlvbi5wcm92aWRlcnM7XG4gIGkgPSBwcm92aWRlcnMubGVuZ3RoO1xuXG4gIHdoaWxlIChpLS0pIHtcbiAgICBjb250YWluZXIuX3Jlc29sdmVycy5zZXQocHJvdmlkZXJzW2ldLCBwcm92aWRlclJlc29sdmVySW5zdGFuY2UpO1xuICB9XG5cbiAgY29udGFpbmVyLnN1cGVyR2V0ID0gY29udGFpbmVyLmdldDtcbiAgY29udGFpbmVyLmdldCA9IGVsZW1lbnRDb250YWluZXJHZXQ7XG5cbiAgcmV0dXJuIGNvbnRhaW5lcjtcbn1cblxuZnVuY3Rpb24gaGFzQXR0cmlidXRlKG5hbWUpIHtcbiAgcmV0dXJuIHRoaXMuX2VsZW1lbnQuaGFzQXR0cmlidXRlKG5hbWUpO1xufVxuXG5mdW5jdGlvbiBnZXRBdHRyaWJ1dGUobmFtZSkge1xuICByZXR1cm4gdGhpcy5fZWxlbWVudC5nZXRBdHRyaWJ1dGUobmFtZSk7XG59XG5cbmZ1bmN0aW9uIHNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkge1xuICB0aGlzLl9lbGVtZW50LnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG59XG5cbmZ1bmN0aW9uIG1ha2VFbGVtZW50SW50b0FuY2hvcihlbGVtZW50LCBlbGVtZW50SW5zdHJ1Y3Rpb24pIHtcbiAgbGV0IGFuY2hvciA9IERPTS5jcmVhdGVDb21tZW50KCdhbmNob3InKTtcblxuICBpZiAoZWxlbWVudEluc3RydWN0aW9uKSB7XG4gICAgbGV0IGZpcnN0Q2hpbGQgPSBlbGVtZW50LmZpcnN0Q2hpbGQ7XG5cbiAgICBpZiAoZmlyc3RDaGlsZCAmJiBmaXJzdENoaWxkLnRhZ05hbWUgPT09ICdBVS1DT05URU5UJykge1xuICAgICAgYW5jaG9yLmNvbnRlbnRFbGVtZW50ID0gZmlyc3RDaGlsZDtcbiAgICB9XG5cbiAgICBhbmNob3IuX2VsZW1lbnQgPSBlbGVtZW50O1xuXG4gICAgYW5jaG9yLmhhc0F0dHJpYnV0ZSA9IGhhc0F0dHJpYnV0ZTtcbiAgICBhbmNob3IuZ2V0QXR0cmlidXRlID0gZ2V0QXR0cmlidXRlO1xuICAgIGFuY2hvci5zZXRBdHRyaWJ1dGUgPSBzZXRBdHRyaWJ1dGU7XG4gIH1cblxuICBET00ucmVwbGFjZU5vZGUoYW5jaG9yLCBlbGVtZW50KTtcblxuICByZXR1cm4gYW5jaG9yO1xufVxuXG5mdW5jdGlvbiBhcHBseUluc3RydWN0aW9ucyhjb250YWluZXJzLCBlbGVtZW50LCBpbnN0cnVjdGlvbiwgY29udHJvbGxlcnMsIGJpbmRpbmdzLCBjaGlsZHJlbiwgc2hhZG93U2xvdHMsIHBhcnRSZXBsYWNlbWVudHMsIHJlc291cmNlcykge1xuICBsZXQgYmVoYXZpb3JJbnN0cnVjdGlvbnMgPSBpbnN0cnVjdGlvbi5iZWhhdmlvckluc3RydWN0aW9ucztcbiAgbGV0IGV4cHJlc3Npb25zID0gaW5zdHJ1Y3Rpb24uZXhwcmVzc2lvbnM7XG4gIGxldCBlbGVtZW50Q29udGFpbmVyO1xuICBsZXQgaTtcbiAgbGV0IGlpO1xuICBsZXQgY3VycmVudDtcbiAgbGV0IGluc3RhbmNlO1xuXG4gIGlmIChpbnN0cnVjdGlvbi5jb250ZW50RXhwcmVzc2lvbikge1xuICAgIGJpbmRpbmdzLnB1c2goaW5zdHJ1Y3Rpb24uY29udGVudEV4cHJlc3Npb24uY3JlYXRlQmluZGluZyhlbGVtZW50Lm5leHRTaWJsaW5nKSk7XG4gICAgZWxlbWVudC5uZXh0U2libGluZy5hdUludGVycG9sYXRpb25UYXJnZXQgPSB0cnVlO1xuICAgIGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoaW5zdHJ1Y3Rpb24uc2hhZG93U2xvdCkge1xuICAgIGxldCBjb21tZW50QW5jaG9yID0gRE9NLmNyZWF0ZUNvbW1lbnQoJ3Nsb3QnKTtcbiAgICBsZXQgc2xvdDtcblxuICAgIGlmIChpbnN0cnVjdGlvbi5zbG90RGVzdGluYXRpb24pIHtcbiAgICAgIHNsb3QgPSBuZXcgUGFzc1Rocm91Z2hTbG90KGNvbW1lbnRBbmNob3IsIGluc3RydWN0aW9uLnNsb3ROYW1lLCBpbnN0cnVjdGlvbi5zbG90RGVzdGluYXRpb24sIGluc3RydWN0aW9uLnNsb3RGYWxsYmFja0ZhY3RvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzbG90ID0gbmV3IFNoYWRvd1Nsb3QoY29tbWVudEFuY2hvciwgaW5zdHJ1Y3Rpb24uc2xvdE5hbWUsIGluc3RydWN0aW9uLnNsb3RGYWxsYmFja0ZhY3RvcnkpO1xuICAgIH1cblxuICAgIERPTS5yZXBsYWNlTm9kZShjb21tZW50QW5jaG9yLCBlbGVtZW50KTtcbiAgICBzaGFkb3dTbG90c1tpbnN0cnVjdGlvbi5zbG90TmFtZV0gPSBzbG90O1xuICAgIGNvbnRyb2xsZXJzLnB1c2goc2xvdCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGluc3RydWN0aW9uLmxldEVsZW1lbnQpIHtcbiAgICBmb3IgKGkgPSAwLCBpaSA9IGV4cHJlc3Npb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGJpbmRpbmdzLnB1c2goZXhwcmVzc2lvbnNbaV0uY3JlYXRlQmluZGluZygpKTtcbiAgICB9XG4gICAgZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChiZWhhdmlvckluc3RydWN0aW9ucy5sZW5ndGgpIHtcbiAgICBpZiAoIWluc3RydWN0aW9uLmFuY2hvcklzQ29udGFpbmVyKSB7XG4gICAgICBlbGVtZW50ID0gbWFrZUVsZW1lbnRJbnRvQW5jaG9yKGVsZW1lbnQsIGluc3RydWN0aW9uLmVsZW1lbnRJbnN0cnVjdGlvbik7XG4gICAgfVxuXG4gICAgY29udGFpbmVyc1tpbnN0cnVjdGlvbi5pbmplY3RvcklkXSA9IGVsZW1lbnRDb250YWluZXIgPSBjcmVhdGVFbGVtZW50Q29udGFpbmVyKGNvbnRhaW5lcnNbaW5zdHJ1Y3Rpb24ucGFyZW50SW5qZWN0b3JJZF0sIGVsZW1lbnQsIGluc3RydWN0aW9uLCBjaGlsZHJlbiwgcGFydFJlcGxhY2VtZW50cywgcmVzb3VyY2VzKTtcblxuICAgIGZvciAoaSA9IDAsIGlpID0gYmVoYXZpb3JJbnN0cnVjdGlvbnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgY3VycmVudCA9IGJlaGF2aW9ySW5zdHJ1Y3Rpb25zW2ldO1xuICAgICAgaW5zdGFuY2UgPSBjdXJyZW50LnR5cGUuY3JlYXRlKGVsZW1lbnRDb250YWluZXIsIGN1cnJlbnQsIGVsZW1lbnQsIGJpbmRpbmdzKTtcbiAgICAgIGNvbnRyb2xsZXJzLnB1c2goaW5zdGFuY2UpO1xuICAgIH1cbiAgfVxuXG4gIGZvciAoaSA9IDAsIGlpID0gZXhwcmVzc2lvbnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgIGJpbmRpbmdzLnB1c2goZXhwcmVzc2lvbnNbaV0uY3JlYXRlQmluZGluZyhlbGVtZW50KSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc3R5bGVTdHJpbmdUb09iamVjdChzdHlsZSwgdGFyZ2V0KSB7XG4gIGxldCBhdHRyaWJ1dGVzID0gc3R5bGUuc3BsaXQoJzsnKTtcbiAgbGV0IGZpcnN0SW5kZXhPZkNvbG9uO1xuICBsZXQgaTtcbiAgbGV0IGN1cnJlbnQ7XG4gIGxldCBrZXk7XG4gIGxldCB2YWx1ZTtcblxuICB0YXJnZXQgPSB0YXJnZXQgfHwge307XG5cbiAgZm9yIChpID0gMDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBjdXJyZW50ID0gYXR0cmlidXRlc1tpXTtcbiAgICBmaXJzdEluZGV4T2ZDb2xvbiA9IGN1cnJlbnQuaW5kZXhPZignOicpO1xuICAgIGtleSA9IGN1cnJlbnQuc3Vic3RyaW5nKDAsIGZpcnN0SW5kZXhPZkNvbG9uKS50cmltKCk7XG4gICAgdmFsdWUgPSBjdXJyZW50LnN1YnN0cmluZyhmaXJzdEluZGV4T2ZDb2xvbiArIDEpLnRyaW0oKTtcbiAgICB0YXJnZXRba2V5XSA9IHZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuZnVuY3Rpb24gc3R5bGVPYmplY3RUb1N0cmluZyhvYmopIHtcbiAgbGV0IHJlc3VsdCA9ICcnO1xuXG4gIGZvciAobGV0IGtleSBpbiBvYmopIHtcbiAgICByZXN1bHQgKz0ga2V5ICsgJzonICsgb2JqW2tleV0gKyAnOyc7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBhcHBseVN1cnJvZ2F0ZUluc3RydWN0aW9uKGNvbnRhaW5lciwgZWxlbWVudCwgaW5zdHJ1Y3Rpb24sIGNvbnRyb2xsZXJzLCBiaW5kaW5ncywgY2hpbGRyZW4pIHtcbiAgbGV0IGJlaGF2aW9ySW5zdHJ1Y3Rpb25zID0gaW5zdHJ1Y3Rpb24uYmVoYXZpb3JJbnN0cnVjdGlvbnM7XG4gIGxldCBleHByZXNzaW9ucyA9IGluc3RydWN0aW9uLmV4cHJlc3Npb25zO1xuICBsZXQgcHJvdmlkZXJzID0gaW5zdHJ1Y3Rpb24ucHJvdmlkZXJzO1xuICBsZXQgdmFsdWVzID0gaW5zdHJ1Y3Rpb24udmFsdWVzO1xuICBsZXQgaTtcbiAgbGV0IGlpO1xuICBsZXQgY3VycmVudDtcbiAgbGV0IGluc3RhbmNlO1xuICBsZXQgY3VycmVudEF0dHJpYnV0ZVZhbHVlO1xuXG4gIGkgPSBwcm92aWRlcnMubGVuZ3RoO1xuICB3aGlsZSAoaS0tKSB7XG4gICAgY29udGFpbmVyLl9yZXNvbHZlcnMuc2V0KHByb3ZpZGVyc1tpXSwgcHJvdmlkZXJSZXNvbHZlckluc3RhbmNlKTtcbiAgfVxuXG4gIGZvciAobGV0IGtleSBpbiB2YWx1ZXMpIHtcbiAgICBjdXJyZW50QXR0cmlidXRlVmFsdWUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShrZXkpO1xuXG4gICAgaWYgKGN1cnJlbnRBdHRyaWJ1dGVWYWx1ZSkge1xuICAgICAgaWYgKGtleSA9PT0gJ2NsYXNzJykge1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBjdXJyZW50QXR0cmlidXRlVmFsdWUgKyAnICcgKyB2YWx1ZXNba2V5XSk7XG4gICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ3N0eWxlJykge1xuICAgICAgICBsZXQgc3R5bGVPYmplY3QgPSBzdHlsZVN0cmluZ1RvT2JqZWN0KHZhbHVlc1trZXldKTtcbiAgICAgICAgc3R5bGVTdHJpbmdUb09iamVjdChjdXJyZW50QXR0cmlidXRlVmFsdWUsIHN0eWxlT2JqZWN0KTtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgc3R5bGVPYmplY3RUb1N0cmluZyhzdHlsZU9iamVjdCkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShrZXksIHZhbHVlc1trZXldKTtcbiAgICB9XG4gIH1cblxuICBpZiAoYmVoYXZpb3JJbnN0cnVjdGlvbnMubGVuZ3RoKSB7XG4gICAgZm9yIChpID0gMCwgaWkgPSBiZWhhdmlvckluc3RydWN0aW9ucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjdXJyZW50ID0gYmVoYXZpb3JJbnN0cnVjdGlvbnNbaV07XG4gICAgICBpbnN0YW5jZSA9IGN1cnJlbnQudHlwZS5jcmVhdGUoY29udGFpbmVyLCBjdXJyZW50LCBlbGVtZW50LCBiaW5kaW5ncyk7XG5cbiAgICAgIGlmIChpbnN0YW5jZS5jb250ZW50Vmlldykge1xuICAgICAgICBjaGlsZHJlbi5wdXNoKGluc3RhbmNlLmNvbnRlbnRWaWV3KTtcbiAgICAgIH1cblxuICAgICAgY29udHJvbGxlcnMucHVzaChpbnN0YW5jZSk7XG4gICAgfVxuICB9XG5cbiAgZm9yIChpID0gMCwgaWkgPSBleHByZXNzaW9ucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgYmluZGluZ3MucHVzaChleHByZXNzaW9uc1tpXS5jcmVhdGVCaW5kaW5nKGVsZW1lbnQpKTtcbiAgfVxufVxuXG5leHBvcnQgbGV0IEJvdW5kVmlld0ZhY3RvcnkgPSBjbGFzcyBCb3VuZFZpZXdGYWN0b3J5IHtcbiAgY29uc3RydWN0b3IocGFyZW50Q29udGFpbmVyLCB2aWV3RmFjdG9yeSwgcGFydFJlcGxhY2VtZW50cykge1xuICAgIHRoaXMucGFyZW50Q29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyO1xuICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICB0aGlzLmZhY3RvcnlDcmVhdGVJbnN0cnVjdGlvbiA9IHsgcGFydFJlcGxhY2VtZW50czogcGFydFJlcGxhY2VtZW50cyB9O1xuICB9XG5cbiAgY3JlYXRlKCkge1xuICAgIGxldCB2aWV3ID0gdGhpcy52aWV3RmFjdG9yeS5jcmVhdGUodGhpcy5wYXJlbnRDb250YWluZXIuY3JlYXRlQ2hpbGQoKSwgdGhpcy5mYWN0b3J5Q3JlYXRlSW5zdHJ1Y3Rpb24pO1xuICAgIHZpZXcuX2lzVXNlckNvbnRyb2xsZWQgPSB0cnVlO1xuICAgIHJldHVybiB2aWV3O1xuICB9XG5cbiAgZ2V0IGlzQ2FjaGluZygpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3RmFjdG9yeS5pc0NhY2hpbmc7XG4gIH1cblxuICBzZXRDYWNoZVNpemUoc2l6ZSwgZG9Ob3RPdmVycmlkZUlmQWxyZWFkeVNldCkge1xuICAgIHRoaXMudmlld0ZhY3Rvcnkuc2V0Q2FjaGVTaXplKHNpemUsIGRvTm90T3ZlcnJpZGVJZkFscmVhZHlTZXQpO1xuICB9XG5cbiAgZ2V0Q2FjaGVkVmlldygpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3RmFjdG9yeS5nZXRDYWNoZWRWaWV3KCk7XG4gIH1cblxuICByZXR1cm5WaWV3VG9DYWNoZSh2aWV3KSB7XG4gICAgdGhpcy52aWV3RmFjdG9yeS5yZXR1cm5WaWV3VG9DYWNoZSh2aWV3KTtcbiAgfVxufTtcblxuZXhwb3J0IGxldCBWaWV3RmFjdG9yeSA9IGNsYXNzIFZpZXdGYWN0b3J5IHtcbiAgY29uc3RydWN0b3IodGVtcGxhdGUsIGluc3RydWN0aW9ucywgcmVzb3VyY2VzKSB7XG4gICAgdGhpcy5pc0NhY2hpbmcgPSBmYWxzZTtcblxuICAgIHRoaXMudGVtcGxhdGUgPSB0ZW1wbGF0ZTtcbiAgICB0aGlzLmluc3RydWN0aW9ucyA9IGluc3RydWN0aW9ucztcbiAgICB0aGlzLnJlc291cmNlcyA9IHJlc291cmNlcztcbiAgICB0aGlzLmNhY2hlU2l6ZSA9IC0xO1xuICAgIHRoaXMuY2FjaGUgPSBudWxsO1xuICB9XG5cbiAgc2V0Q2FjaGVTaXplKHNpemUsIGRvTm90T3ZlcnJpZGVJZkFscmVhZHlTZXQpIHtcbiAgICBpZiAoc2l6ZSkge1xuICAgICAgaWYgKHNpemUgPT09ICcqJykge1xuICAgICAgICBzaXplID0gTnVtYmVyLk1BWF9WQUxVRTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNpemUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHNpemUgPSBwYXJzZUludChzaXplLCAxMCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2FjaGVTaXplID09PSAtMSB8fCAhZG9Ob3RPdmVycmlkZUlmQWxyZWFkeVNldCkge1xuICAgICAgdGhpcy5jYWNoZVNpemUgPSBzaXplO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmNhY2hlU2l6ZSA+IDApIHtcbiAgICAgIHRoaXMuY2FjaGUgPSBbXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jYWNoZSA9IG51bGw7XG4gICAgfVxuXG4gICAgdGhpcy5pc0NhY2hpbmcgPSB0aGlzLmNhY2hlU2l6ZSA+IDA7XG4gIH1cblxuICBnZXRDYWNoZWRWaWV3KCkge1xuICAgIHJldHVybiB0aGlzLmNhY2hlICE9PSBudWxsID8gdGhpcy5jYWNoZS5wb3AoKSB8fCBudWxsIDogbnVsbDtcbiAgfVxuXG4gIHJldHVyblZpZXdUb0NhY2hlKHZpZXcpIHtcbiAgICBpZiAodmlldy5pc0F0dGFjaGVkKSB7XG4gICAgICB2aWV3LmRldGFjaGVkKCk7XG4gICAgfVxuXG4gICAgaWYgKHZpZXcuaXNCb3VuZCkge1xuICAgICAgdmlldy51bmJpbmQoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jYWNoZSAhPT0gbnVsbCAmJiB0aGlzLmNhY2hlLmxlbmd0aCA8IHRoaXMuY2FjaGVTaXplKSB7XG4gICAgICB2aWV3LmZyb21DYWNoZSA9IHRydWU7XG4gICAgICB0aGlzLmNhY2hlLnB1c2godmlldyk7XG4gICAgfVxuICB9XG5cbiAgY3JlYXRlKGNvbnRhaW5lciwgY3JlYXRlSW5zdHJ1Y3Rpb24sIGVsZW1lbnQpIHtcbiAgICBjcmVhdGVJbnN0cnVjdGlvbiA9IGNyZWF0ZUluc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24ubm9ybWFsO1xuXG4gICAgbGV0IGNhY2hlZFZpZXcgPSB0aGlzLmdldENhY2hlZFZpZXcoKTtcbiAgICBpZiAoY2FjaGVkVmlldyAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGNhY2hlZFZpZXc7XG4gICAgfVxuXG4gICAgbGV0IGZyYWdtZW50ID0gY3JlYXRlSW5zdHJ1Y3Rpb24uZW5oYW5jZSA/IHRoaXMudGVtcGxhdGUgOiB0aGlzLnRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcbiAgICBsZXQgaW5zdHJ1Y3RhYmxlcyA9IGZyYWdtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hdS10YXJnZXQnKTtcbiAgICBsZXQgaW5zdHJ1Y3Rpb25zID0gdGhpcy5pbnN0cnVjdGlvbnM7XG4gICAgbGV0IHJlc291cmNlcyA9IHRoaXMucmVzb3VyY2VzO1xuICAgIGxldCBjb250cm9sbGVycyA9IFtdO1xuICAgIGxldCBiaW5kaW5ncyA9IFtdO1xuICAgIGxldCBjaGlsZHJlbiA9IFtdO1xuICAgIGxldCBzaGFkb3dTbG90cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgbGV0IGNvbnRhaW5lcnMgPSB7IHJvb3Q6IGNvbnRhaW5lciB9O1xuICAgIGxldCBwYXJ0UmVwbGFjZW1lbnRzID0gY3JlYXRlSW5zdHJ1Y3Rpb24ucGFydFJlcGxhY2VtZW50cztcbiAgICBsZXQgaTtcbiAgICBsZXQgaWk7XG4gICAgbGV0IHZpZXc7XG4gICAgbGV0IGluc3RydWN0YWJsZTtcbiAgICBsZXQgaW5zdHJ1Y3Rpb247XG5cbiAgICB0aGlzLnJlc291cmNlcy5faW52b2tlSG9vaygnYmVmb3JlQ3JlYXRlJywgdGhpcywgY29udGFpbmVyLCBmcmFnbWVudCwgY3JlYXRlSW5zdHJ1Y3Rpb24pO1xuXG4gICAgaWYgKGVsZW1lbnQgJiYgdGhpcy5zdXJyb2dhdGVJbnN0cnVjdGlvbiAhPT0gbnVsbCkge1xuICAgICAgYXBwbHlTdXJyb2dhdGVJbnN0cnVjdGlvbihjb250YWluZXIsIGVsZW1lbnQsIHRoaXMuc3Vycm9nYXRlSW5zdHJ1Y3Rpb24sIGNvbnRyb2xsZXJzLCBiaW5kaW5ncywgY2hpbGRyZW4pO1xuICAgIH1cblxuICAgIGlmIChjcmVhdGVJbnN0cnVjdGlvbi5lbmhhbmNlICYmIGZyYWdtZW50Lmhhc0F0dHJpYnV0ZSgnYXUtdGFyZ2V0LWlkJykpIHtcbiAgICAgIGluc3RydWN0YWJsZSA9IGZyYWdtZW50O1xuICAgICAgaW5zdHJ1Y3Rpb24gPSBpbnN0cnVjdGlvbnNbaW5zdHJ1Y3RhYmxlLmdldEF0dHJpYnV0ZSgnYXUtdGFyZ2V0LWlkJyldO1xuICAgICAgYXBwbHlJbnN0cnVjdGlvbnMoY29udGFpbmVycywgaW5zdHJ1Y3RhYmxlLCBpbnN0cnVjdGlvbiwgY29udHJvbGxlcnMsIGJpbmRpbmdzLCBjaGlsZHJlbiwgc2hhZG93U2xvdHMsIHBhcnRSZXBsYWNlbWVudHMsIHJlc291cmNlcyk7XG4gICAgfVxuXG4gICAgZm9yIChpID0gMCwgaWkgPSBpbnN0cnVjdGFibGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGluc3RydWN0YWJsZSA9IGluc3RydWN0YWJsZXNbaV07XG4gICAgICBpbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uc1tpbnN0cnVjdGFibGUuZ2V0QXR0cmlidXRlKCdhdS10YXJnZXQtaWQnKV07XG4gICAgICBhcHBseUluc3RydWN0aW9ucyhjb250YWluZXJzLCBpbnN0cnVjdGFibGUsIGluc3RydWN0aW9uLCBjb250cm9sbGVycywgYmluZGluZ3MsIGNoaWxkcmVuLCBzaGFkb3dTbG90cywgcGFydFJlcGxhY2VtZW50cywgcmVzb3VyY2VzKTtcbiAgICB9XG5cbiAgICB2aWV3ID0gbmV3IFZpZXcoY29udGFpbmVyLCB0aGlzLCBmcmFnbWVudCwgY29udHJvbGxlcnMsIGJpbmRpbmdzLCBjaGlsZHJlbiwgc2hhZG93U2xvdHMpO1xuXG4gICAgaWYgKCFjcmVhdGVJbnN0cnVjdGlvbi5pbml0aWF0ZWRCeUJlaGF2aW9yKSB7XG4gICAgICB2aWV3LmNyZWF0ZWQoKTtcbiAgICB9XG5cbiAgICB0aGlzLnJlc291cmNlcy5faW52b2tlSG9vaygnYWZ0ZXJDcmVhdGUnLCB2aWV3KTtcblxuICAgIHJldHVybiB2aWV3O1xuICB9XG59O1xuXG5sZXQgbmV4dEluamVjdG9ySWQgPSAwO1xuZnVuY3Rpb24gZ2V0TmV4dEluamVjdG9ySWQoKSB7XG4gIHJldHVybiArK25leHRJbmplY3RvcklkO1xufVxuXG5sZXQgbGFzdEFVVGFyZ2V0SUQgPSAwO1xuZnVuY3Rpb24gZ2V0TmV4dEFVVGFyZ2V0SUQoKSB7XG4gIHJldHVybiAoKytsYXN0QVVUYXJnZXRJRCkudG9TdHJpbmcoKTtcbn1cblxuZnVuY3Rpb24gbWFrZUludG9JbnN0cnVjdGlvblRhcmdldChlbGVtZW50KSB7XG4gIGxldCB2YWx1ZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjbGFzcycpO1xuICBsZXQgYXVUYXJnZXRJRCA9IGdldE5leHRBVVRhcmdldElEKCk7XG5cbiAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgdmFsdWUgPyB2YWx1ZSArICcgYXUtdGFyZ2V0JyA6ICdhdS10YXJnZXQnKTtcbiAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2F1LXRhcmdldC1pZCcsIGF1VGFyZ2V0SUQpO1xuXG4gIHJldHVybiBhdVRhcmdldElEO1xufVxuXG5mdW5jdGlvbiBtYWtlU2hhZG93U2xvdChjb21waWxlciwgcmVzb3VyY2VzLCBub2RlLCBpbnN0cnVjdGlvbnMsIHBhcmVudEluamVjdG9ySWQpIHtcbiAgbGV0IGF1U2hhZG93U2xvdCA9IERPTS5jcmVhdGVFbGVtZW50KCdhdS1zaGFkb3ctc2xvdCcpO1xuICBET00ucmVwbGFjZU5vZGUoYXVTaGFkb3dTbG90LCBub2RlKTtcblxuICBsZXQgYXVUYXJnZXRJRCA9IG1ha2VJbnRvSW5zdHJ1Y3Rpb25UYXJnZXQoYXVTaGFkb3dTbG90KTtcbiAgbGV0IGluc3RydWN0aW9uID0gVGFyZ2V0SW5zdHJ1Y3Rpb24uc2hhZG93U2xvdChwYXJlbnRJbmplY3RvcklkKTtcblxuICBpbnN0cnVjdGlvbi5zbG90TmFtZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCduYW1lJykgfHwgU2hhZG93RE9NLmRlZmF1bHRTbG90S2V5O1xuICBpbnN0cnVjdGlvbi5zbG90RGVzdGluYXRpb24gPSBub2RlLmdldEF0dHJpYnV0ZSgnc2xvdCcpO1xuXG4gIGlmIChub2RlLmlubmVySFRNTC50cmltKCkpIHtcbiAgICBsZXQgZnJhZ21lbnQgPSBET00uY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIGxldCBjaGlsZDtcblxuICAgIHdoaWxlIChjaGlsZCA9IG5vZGUuZmlyc3RDaGlsZCkge1xuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgIH1cblxuICAgIGluc3RydWN0aW9uLnNsb3RGYWxsYmFja0ZhY3RvcnkgPSBjb21waWxlci5jb21waWxlKGZyYWdtZW50LCByZXNvdXJjZXMpO1xuICB9XG5cbiAgaW5zdHJ1Y3Rpb25zW2F1VGFyZ2V0SURdID0gaW5zdHJ1Y3Rpb247XG5cbiAgcmV0dXJuIGF1U2hhZG93U2xvdDtcbn1cblxuY29uc3QgZGVmYXVsdExldEhhbmRsZXIgPSBCaW5kaW5nTGFuZ3VhZ2UucHJvdG90eXBlLmNyZWF0ZUxldEV4cHJlc3Npb25zO1xuXG5leHBvcnQgbGV0IFZpZXdDb21waWxlciA9IChfZGVjNyA9IGluamVjdChCaW5kaW5nTGFuZ3VhZ2UsIFZpZXdSZXNvdXJjZXMpLCBfZGVjNyhfY2xhc3MxNCA9IGNsYXNzIFZpZXdDb21waWxlciB7XG4gIGNvbnN0cnVjdG9yKGJpbmRpbmdMYW5ndWFnZSwgcmVzb3VyY2VzKSB7XG4gICAgdGhpcy5iaW5kaW5nTGFuZ3VhZ2UgPSBiaW5kaW5nTGFuZ3VhZ2U7XG4gICAgdGhpcy5yZXNvdXJjZXMgPSByZXNvdXJjZXM7XG4gIH1cblxuICBjb21waWxlKHNvdXJjZSwgcmVzb3VyY2VzLCBjb21waWxlSW5zdHJ1Y3Rpb24pIHtcbiAgICByZXNvdXJjZXMgPSByZXNvdXJjZXMgfHwgdGhpcy5yZXNvdXJjZXM7XG4gICAgY29tcGlsZUluc3RydWN0aW9uID0gY29tcGlsZUluc3RydWN0aW9uIHx8IFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24ubm9ybWFsO1xuICAgIHNvdXJjZSA9IHR5cGVvZiBzb3VyY2UgPT09ICdzdHJpbmcnID8gRE9NLmNyZWF0ZVRlbXBsYXRlRnJvbU1hcmt1cChzb3VyY2UpIDogc291cmNlO1xuXG4gICAgbGV0IGNvbnRlbnQ7XG4gICAgbGV0IHBhcnQ7XG4gICAgbGV0IGNhY2hlU2l6ZTtcblxuICAgIGlmIChzb3VyY2UuY29udGVudCkge1xuICAgICAgcGFydCA9IHNvdXJjZS5nZXRBdHRyaWJ1dGUoJ3BhcnQnKTtcbiAgICAgIGNhY2hlU2l6ZSA9IHNvdXJjZS5nZXRBdHRyaWJ1dGUoJ3ZpZXctY2FjaGUnKTtcbiAgICAgIGNvbnRlbnQgPSBET00uYWRvcHROb2RlKHNvdXJjZS5jb250ZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29udGVudCA9IHNvdXJjZTtcbiAgICB9XG5cbiAgICBjb21waWxlSW5zdHJ1Y3Rpb24udGFyZ2V0U2hhZG93RE9NID0gY29tcGlsZUluc3RydWN0aW9uLnRhcmdldFNoYWRvd0RPTSAmJiBGRUFUVVJFLnNoYWRvd0RPTTtcbiAgICByZXNvdXJjZXMuX2ludm9rZUhvb2soJ2JlZm9yZUNvbXBpbGUnLCBjb250ZW50LCByZXNvdXJjZXMsIGNvbXBpbGVJbnN0cnVjdGlvbik7XG5cbiAgICBsZXQgaW5zdHJ1Y3Rpb25zID0ge307XG4gICAgdGhpcy5fY29tcGlsZU5vZGUoY29udGVudCwgcmVzb3VyY2VzLCBpbnN0cnVjdGlvbnMsIHNvdXJjZSwgJ3Jvb3QnLCAhY29tcGlsZUluc3RydWN0aW9uLnRhcmdldFNoYWRvd0RPTSk7XG5cbiAgICBsZXQgZmlyc3RDaGlsZCA9IGNvbnRlbnQuZmlyc3RDaGlsZDtcbiAgICBpZiAoZmlyc3RDaGlsZCAmJiBmaXJzdENoaWxkLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICBsZXQgdGFyZ2V0SWQgPSBmaXJzdENoaWxkLmdldEF0dHJpYnV0ZSgnYXUtdGFyZ2V0LWlkJyk7XG4gICAgICBpZiAodGFyZ2V0SWQpIHtcbiAgICAgICAgbGV0IGlucyA9IGluc3RydWN0aW9uc1t0YXJnZXRJZF07XG5cbiAgICAgICAgaWYgKGlucy5zaGFkb3dTbG90IHx8IGlucy5saWZ0aW5nIHx8IGlucy5lbGVtZW50SW5zdHJ1Y3Rpb24gJiYgIWlucy5lbGVtZW50SW5zdHJ1Y3Rpb24uYW5jaG9ySXNDb250YWluZXIpIHtcbiAgICAgICAgICBjb250ZW50Lmluc2VydEJlZm9yZShET00uY3JlYXRlQ29tbWVudCgndmlldycpLCBmaXJzdENoaWxkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBmYWN0b3J5ID0gbmV3IFZpZXdGYWN0b3J5KGNvbnRlbnQsIGluc3RydWN0aW9ucywgcmVzb3VyY2VzKTtcblxuICAgIGZhY3Rvcnkuc3Vycm9nYXRlSW5zdHJ1Y3Rpb24gPSBjb21waWxlSW5zdHJ1Y3Rpb24uY29tcGlsZVN1cnJvZ2F0ZSA/IHRoaXMuX2NvbXBpbGVTdXJyb2dhdGUoc291cmNlLCByZXNvdXJjZXMpIDogbnVsbDtcbiAgICBmYWN0b3J5LnBhcnQgPSBwYXJ0O1xuXG4gICAgaWYgKGNhY2hlU2l6ZSkge1xuICAgICAgZmFjdG9yeS5zZXRDYWNoZVNpemUoY2FjaGVTaXplKTtcbiAgICB9XG5cbiAgICByZXNvdXJjZXMuX2ludm9rZUhvb2soJ2FmdGVyQ29tcGlsZScsIGZhY3RvcnkpO1xuXG4gICAgcmV0dXJuIGZhY3Rvcnk7XG4gIH1cblxuICBfY29tcGlsZU5vZGUobm9kZSwgcmVzb3VyY2VzLCBpbnN0cnVjdGlvbnMsIHBhcmVudE5vZGUsIHBhcmVudEluamVjdG9ySWQsIHRhcmdldExpZ2h0RE9NKSB7XG4gICAgc3dpdGNoIChub2RlLm5vZGVUeXBlKSB7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIHJldHVybiB0aGlzLl9jb21waWxlRWxlbWVudChub2RlLCByZXNvdXJjZXMsIGluc3RydWN0aW9ucywgcGFyZW50Tm9kZSwgcGFyZW50SW5qZWN0b3JJZCwgdGFyZ2V0TGlnaHRET00pO1xuICAgICAgY2FzZSAzOlxuICAgICAgICBsZXQgZXhwcmVzc2lvbiA9IHJlc291cmNlcy5nZXRCaW5kaW5nTGFuZ3VhZ2UodGhpcy5iaW5kaW5nTGFuZ3VhZ2UpLmluc3BlY3RUZXh0Q29udGVudChyZXNvdXJjZXMsIG5vZGUud2hvbGVUZXh0KTtcbiAgICAgICAgaWYgKGV4cHJlc3Npb24pIHtcbiAgICAgICAgICBsZXQgbWFya2VyID0gRE9NLmNyZWF0ZUVsZW1lbnQoJ2F1LW1hcmtlcicpO1xuICAgICAgICAgIGxldCBhdVRhcmdldElEID0gbWFrZUludG9JbnN0cnVjdGlvblRhcmdldChtYXJrZXIpO1xuICAgICAgICAgIChub2RlLnBhcmVudE5vZGUgfHwgcGFyZW50Tm9kZSkuaW5zZXJ0QmVmb3JlKG1hcmtlciwgbm9kZSk7XG4gICAgICAgICAgbm9kZS50ZXh0Q29udGVudCA9ICcgJztcbiAgICAgICAgICBpbnN0cnVjdGlvbnNbYXVUYXJnZXRJRF0gPSBUYXJnZXRJbnN0cnVjdGlvbi5jb250ZW50RXhwcmVzc2lvbihleHByZXNzaW9uKTtcblxuICAgICAgICAgIHdoaWxlIChub2RlLm5leHRTaWJsaW5nICYmIG5vZGUubmV4dFNpYmxpbmcubm9kZVR5cGUgPT09IDMpIHtcbiAgICAgICAgICAgIChub2RlLnBhcmVudE5vZGUgfHwgcGFyZW50Tm9kZSkucmVtb3ZlQ2hpbGQobm9kZS5uZXh0U2libGluZyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdoaWxlIChub2RlLm5leHRTaWJsaW5nICYmIG5vZGUubmV4dFNpYmxpbmcubm9kZVR5cGUgPT09IDMpIHtcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLm5leHRTaWJsaW5nO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZztcbiAgICAgIGNhc2UgMTE6XG4gICAgICAgIGxldCBjdXJyZW50Q2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7XG4gICAgICAgIHdoaWxlIChjdXJyZW50Q2hpbGQpIHtcbiAgICAgICAgICBjdXJyZW50Q2hpbGQgPSB0aGlzLl9jb21waWxlTm9kZShjdXJyZW50Q2hpbGQsIHJlc291cmNlcywgaW5zdHJ1Y3Rpb25zLCBub2RlLCBwYXJlbnRJbmplY3RvcklkLCB0YXJnZXRMaWdodERPTSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZztcbiAgfVxuXG4gIF9jb21waWxlU3Vycm9nYXRlKG5vZGUsIHJlc291cmNlcykge1xuICAgIGxldCB0YWdOYW1lID0gbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IGF0dHJpYnV0ZXMgPSBub2RlLmF0dHJpYnV0ZXM7XG4gICAgbGV0IGJpbmRpbmdMYW5ndWFnZSA9IHJlc291cmNlcy5nZXRCaW5kaW5nTGFuZ3VhZ2UodGhpcy5iaW5kaW5nTGFuZ3VhZ2UpO1xuICAgIGxldCBrbm93bkF0dHJpYnV0ZTtcbiAgICBsZXQgcHJvcGVydHk7XG4gICAgbGV0IGluc3RydWN0aW9uO1xuICAgIGxldCBpO1xuICAgIGxldCBpaTtcbiAgICBsZXQgYXR0cjtcbiAgICBsZXQgYXR0ck5hbWU7XG4gICAgbGV0IGF0dHJWYWx1ZTtcbiAgICBsZXQgaW5mbztcbiAgICBsZXQgdHlwZTtcbiAgICBsZXQgZXhwcmVzc2lvbnMgPSBbXTtcbiAgICBsZXQgZXhwcmVzc2lvbjtcbiAgICBsZXQgYmVoYXZpb3JJbnN0cnVjdGlvbnMgPSBbXTtcbiAgICBsZXQgdmFsdWVzID0ge307XG4gICAgbGV0IGhhc1ZhbHVlcyA9IGZhbHNlO1xuICAgIGxldCBwcm92aWRlcnMgPSBbXTtcblxuICAgIGZvciAoaSA9IDAsIGlpID0gYXR0cmlidXRlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBhdHRyID0gYXR0cmlidXRlc1tpXTtcbiAgICAgIGF0dHJOYW1lID0gYXR0ci5uYW1lO1xuICAgICAgYXR0clZhbHVlID0gYXR0ci52YWx1ZTtcblxuICAgICAgaW5mbyA9IGJpbmRpbmdMYW5ndWFnZS5pbnNwZWN0QXR0cmlidXRlKHJlc291cmNlcywgdGFnTmFtZSwgYXR0ck5hbWUsIGF0dHJWYWx1ZSk7XG4gICAgICB0eXBlID0gcmVzb3VyY2VzLmdldEF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAga25vd25BdHRyaWJ1dGUgPSByZXNvdXJjZXMubWFwQXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuICAgICAgICBpZiAoa25vd25BdHRyaWJ1dGUpIHtcbiAgICAgICAgICBwcm9wZXJ0eSA9IHR5cGUuYXR0cmlidXRlc1trbm93bkF0dHJpYnV0ZV07XG5cbiAgICAgICAgICBpZiAocHJvcGVydHkpIHtcbiAgICAgICAgICAgIGluZm8uZGVmYXVsdEJpbmRpbmdNb2RlID0gcHJvcGVydHkuZGVmYXVsdEJpbmRpbmdNb2RlO1xuXG4gICAgICAgICAgICBpZiAoIWluZm8uY29tbWFuZCAmJiAhaW5mby5leHByZXNzaW9uKSB7XG4gICAgICAgICAgICAgIGluZm8uY29tbWFuZCA9IHByb3BlcnR5Lmhhc09wdGlvbnMgPyAnb3B0aW9ucycgOiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaW5mby5jb21tYW5kICYmIGluZm8uY29tbWFuZCAhPT0gJ29wdGlvbnMnICYmIHR5cGUucHJpbWFyeVByb3BlcnR5KSB7XG4gICAgICAgICAgICAgIGNvbnN0IHByaW1hcnlQcm9wZXJ0eSA9IHR5cGUucHJpbWFyeVByb3BlcnR5O1xuICAgICAgICAgICAgICBhdHRyTmFtZSA9IGluZm8uYXR0ck5hbWUgPSBwcmltYXJ5UHJvcGVydHkuYXR0cmlidXRlO1xuXG4gICAgICAgICAgICAgIGluZm8uZGVmYXVsdEJpbmRpbmdNb2RlID0gcHJpbWFyeVByb3BlcnR5LmRlZmF1bHRCaW5kaW5nTW9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaW5zdHJ1Y3Rpb24gPSBiaW5kaW5nTGFuZ3VhZ2UuY3JlYXRlQXR0cmlidXRlSW5zdHJ1Y3Rpb24ocmVzb3VyY2VzLCBub2RlLCBpbmZvLCB1bmRlZmluZWQsIHR5cGUpO1xuXG4gICAgICBpZiAoaW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgaWYgKGluc3RydWN0aW9uLmFsdGVyZWRBdHRyKSB7XG4gICAgICAgICAgdHlwZSA9IHJlc291cmNlcy5nZXRBdHRyaWJ1dGUoaW5zdHJ1Y3Rpb24uYXR0ck5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGluc3RydWN0aW9uLmRpc2NyZXRlKSB7XG4gICAgICAgICAgZXhwcmVzc2lvbnMucHVzaChpbnN0cnVjdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIGluc3RydWN0aW9uLnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdGhpcy5fY29uZmlndXJlUHJvcGVydGllcyhpbnN0cnVjdGlvbiwgcmVzb3VyY2VzKTtcblxuICAgICAgICAgICAgaWYgKHR5cGUubGlmdHNDb250ZW50KSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IGNhbm5vdCBwbGFjZSBhIHRlbXBsYXRlIGNvbnRyb2xsZXIgb24gYSBzdXJyb2dhdGUgZWxlbWVudC4nKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGJlaGF2aW9ySW5zdHJ1Y3Rpb25zLnB1c2goaW5zdHJ1Y3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleHByZXNzaW9ucy5wdXNoKGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5zdHJ1Y3Rpb24uYXR0ck5hbWVdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgaW5zdHJ1Y3Rpb24gPSBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShhdHRyTmFtZSwgdHlwZSk7XG4gICAgICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tyZXNvdXJjZXMubWFwQXR0cmlidXRlKGF0dHJOYW1lKV0gPSBhdHRyVmFsdWU7XG5cbiAgICAgICAgICBpZiAodHlwZS5saWZ0c0NvbnRlbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IGNhbm5vdCBwbGFjZSBhIHRlbXBsYXRlIGNvbnRyb2xsZXIgb24gYSBzdXJyb2dhdGUgZWxlbWVudC4nKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYmVoYXZpb3JJbnN0cnVjdGlvbnMucHVzaChpbnN0cnVjdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGF0dHJOYW1lICE9PSAnaWQnICYmIGF0dHJOYW1lICE9PSAncGFydCcgJiYgYXR0ck5hbWUgIT09ICdyZXBsYWNlLXBhcnQnKSB7XG4gICAgICAgICAgaGFzVmFsdWVzID0gdHJ1ZTtcbiAgICAgICAgICB2YWx1ZXNbYXR0ck5hbWVdID0gYXR0clZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGV4cHJlc3Npb25zLmxlbmd0aCB8fCBiZWhhdmlvckluc3RydWN0aW9ucy5sZW5ndGggfHwgaGFzVmFsdWVzKSB7XG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IGJlaGF2aW9ySW5zdHJ1Y3Rpb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgaW5zdHJ1Y3Rpb24gPSBiZWhhdmlvckluc3RydWN0aW9uc1tpXTtcbiAgICAgICAgaW5zdHJ1Y3Rpb24udHlwZS5jb21waWxlKHRoaXMsIHJlc291cmNlcywgbm9kZSwgaW5zdHJ1Y3Rpb24pO1xuICAgICAgICBwcm92aWRlcnMucHVzaChpbnN0cnVjdGlvbi50eXBlLnRhcmdldCk7XG4gICAgICB9XG5cbiAgICAgIGZvciAoaSA9IDAsIGlpID0gZXhwcmVzc2lvbnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBleHByZXNzaW9uID0gZXhwcmVzc2lvbnNbaV07XG4gICAgICAgIGlmIChleHByZXNzaW9uLmF0dHJUb1JlbW92ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoZXhwcmVzc2lvbi5hdHRyVG9SZW1vdmUpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBUYXJnZXRJbnN0cnVjdGlvbi5zdXJyb2dhdGUocHJvdmlkZXJzLCBiZWhhdmlvckluc3RydWN0aW9ucywgZXhwcmVzc2lvbnMsIHZhbHVlcyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBfY29tcGlsZUVsZW1lbnQobm9kZSwgcmVzb3VyY2VzLCBpbnN0cnVjdGlvbnMsIHBhcmVudE5vZGUsIHBhcmVudEluamVjdG9ySWQsIHRhcmdldExpZ2h0RE9NKSB7XG4gICAgbGV0IHRhZ05hbWUgPSBub2RlLnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICBsZXQgYXR0cmlidXRlcyA9IG5vZGUuYXR0cmlidXRlcztcbiAgICBsZXQgZXhwcmVzc2lvbnMgPSBbXTtcbiAgICBsZXQgZXhwcmVzc2lvbjtcbiAgICBsZXQgYmVoYXZpb3JJbnN0cnVjdGlvbnMgPSBbXTtcbiAgICBsZXQgcHJvdmlkZXJzID0gW107XG4gICAgbGV0IGJpbmRpbmdMYW5ndWFnZSA9IHJlc291cmNlcy5nZXRCaW5kaW5nTGFuZ3VhZ2UodGhpcy5iaW5kaW5nTGFuZ3VhZ2UpO1xuICAgIGxldCBsaWZ0aW5nSW5zdHJ1Y3Rpb247XG4gICAgbGV0IHZpZXdGYWN0b3J5O1xuICAgIGxldCB0eXBlO1xuICAgIGxldCBlbGVtZW50SW5zdHJ1Y3Rpb247XG4gICAgbGV0IGVsZW1lbnRQcm9wZXJ0eTtcbiAgICBsZXQgaTtcbiAgICBsZXQgaWk7XG4gICAgbGV0IGF0dHI7XG4gICAgbGV0IGF0dHJOYW1lO1xuICAgIGxldCBhdHRyVmFsdWU7XG4gICAgbGV0IG9yaWdpbmFsQXR0ck5hbWU7XG4gICAgbGV0IGluc3RydWN0aW9uO1xuICAgIGxldCBpbmZvO1xuICAgIGxldCBwcm9wZXJ0eTtcbiAgICBsZXQga25vd25BdHRyaWJ1dGU7XG4gICAgbGV0IGF1VGFyZ2V0SUQ7XG4gICAgbGV0IGluamVjdG9ySWQ7XG5cbiAgICBpZiAodGFnTmFtZSA9PT0gJ3Nsb3QnKSB7XG4gICAgICBpZiAodGFyZ2V0TGlnaHRET00pIHtcbiAgICAgICAgbm9kZSA9IG1ha2VTaGFkb3dTbG90KHRoaXMsIHJlc291cmNlcywgbm9kZSwgaW5zdHJ1Y3Rpb25zLCBwYXJlbnRJbmplY3RvcklkKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBub2RlLm5leHRTaWJsaW5nO1xuICAgIH0gZWxzZSBpZiAodGFnTmFtZSA9PT0gJ3RlbXBsYXRlJykge1xuICAgICAgaWYgKCEoJ2NvbnRlbnQnIGluIG5vZGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IGNhbm5vdCBwbGFjZSBhIHRlbXBsYXRlIGVsZW1lbnQgd2l0aGluICcgKyBub2RlLm5hbWVzcGFjZVVSSSArICcgbmFtZXNwYWNlJyk7XG4gICAgICB9XG4gICAgICB2aWV3RmFjdG9yeSA9IHRoaXMuY29tcGlsZShub2RlLCByZXNvdXJjZXMpO1xuICAgICAgdmlld0ZhY3RvcnkucGFydCA9IG5vZGUuZ2V0QXR0cmlidXRlKCdwYXJ0Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHR5cGUgPSByZXNvdXJjZXMuZ2V0RWxlbWVudChub2RlLmdldEF0dHJpYnV0ZSgnYXMtZWxlbWVudCcpIHx8IHRhZ05hbWUpO1xuXG4gICAgICBpZiAodGFnTmFtZSA9PT0gJ2xldCcgJiYgIXR5cGUgJiYgYmluZGluZ0xhbmd1YWdlLmNyZWF0ZUxldEV4cHJlc3Npb25zICE9PSBkZWZhdWx0TGV0SGFuZGxlcikge1xuICAgICAgICBleHByZXNzaW9ucyA9IGJpbmRpbmdMYW5ndWFnZS5jcmVhdGVMZXRFeHByZXNzaW9ucyhyZXNvdXJjZXMsIG5vZGUpO1xuICAgICAgICBhdVRhcmdldElEID0gbWFrZUludG9JbnN0cnVjdGlvblRhcmdldChub2RlKTtcbiAgICAgICAgaW5zdHJ1Y3Rpb25zW2F1VGFyZ2V0SURdID0gVGFyZ2V0SW5zdHJ1Y3Rpb24ubGV0RWxlbWVudChleHByZXNzaW9ucyk7XG4gICAgICAgIHJldHVybiBub2RlLm5leHRTaWJsaW5nO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgZWxlbWVudEluc3RydWN0aW9uID0gQmVoYXZpb3JJbnN0cnVjdGlvbi5lbGVtZW50KG5vZGUsIHR5cGUpO1xuICAgICAgICB0eXBlLnByb2Nlc3NBdHRyaWJ1dGVzKHRoaXMsIHJlc291cmNlcywgbm9kZSwgYXR0cmlidXRlcywgZWxlbWVudEluc3RydWN0aW9uKTtcbiAgICAgICAgYmVoYXZpb3JJbnN0cnVjdGlvbnMucHVzaChlbGVtZW50SW5zdHJ1Y3Rpb24pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoaSA9IDAsIGlpID0gYXR0cmlidXRlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBhdHRyID0gYXR0cmlidXRlc1tpXTtcbiAgICAgIG9yaWdpbmFsQXR0ck5hbWUgPSBhdHRyTmFtZSA9IGF0dHIubmFtZTtcbiAgICAgIGF0dHJWYWx1ZSA9IGF0dHIudmFsdWU7XG4gICAgICBpbmZvID0gYmluZGluZ0xhbmd1YWdlLmluc3BlY3RBdHRyaWJ1dGUocmVzb3VyY2VzLCB0YWdOYW1lLCBhdHRyTmFtZSwgYXR0clZhbHVlKTtcblxuICAgICAgaWYgKHRhcmdldExpZ2h0RE9NICYmIGluZm8uYXR0ck5hbWUgPT09ICdzbG90Jykge1xuICAgICAgICBpbmZvLmF0dHJOYW1lID0gYXR0ck5hbWUgPSAnYXUtc2xvdCc7XG4gICAgICB9XG5cbiAgICAgIHR5cGUgPSByZXNvdXJjZXMuZ2V0QXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuICAgICAgZWxlbWVudFByb3BlcnR5ID0gbnVsbDtcblxuICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAga25vd25BdHRyaWJ1dGUgPSByZXNvdXJjZXMubWFwQXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuICAgICAgICBpZiAoa25vd25BdHRyaWJ1dGUpIHtcbiAgICAgICAgICBwcm9wZXJ0eSA9IHR5cGUuYXR0cmlidXRlc1trbm93bkF0dHJpYnV0ZV07XG5cbiAgICAgICAgICBpZiAocHJvcGVydHkpIHtcbiAgICAgICAgICAgIGluZm8uZGVmYXVsdEJpbmRpbmdNb2RlID0gcHJvcGVydHkuZGVmYXVsdEJpbmRpbmdNb2RlO1xuXG4gICAgICAgICAgICBpZiAoIWluZm8uY29tbWFuZCAmJiAhaW5mby5leHByZXNzaW9uKSB7XG4gICAgICAgICAgICAgIGluZm8uY29tbWFuZCA9IHByb3BlcnR5Lmhhc09wdGlvbnMgPyAnb3B0aW9ucycgOiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaW5mby5jb21tYW5kICYmIGluZm8uY29tbWFuZCAhPT0gJ29wdGlvbnMnICYmIHR5cGUucHJpbWFyeVByb3BlcnR5KSB7XG4gICAgICAgICAgICAgIGNvbnN0IHByaW1hcnlQcm9wZXJ0eSA9IHR5cGUucHJpbWFyeVByb3BlcnR5O1xuICAgICAgICAgICAgICBhdHRyTmFtZSA9IGluZm8uYXR0ck5hbWUgPSBwcmltYXJ5UHJvcGVydHkuYXR0cmlidXRlO1xuXG4gICAgICAgICAgICAgIGluZm8uZGVmYXVsdEJpbmRpbmdNb2RlID0gcHJpbWFyeVByb3BlcnR5LmRlZmF1bHRCaW5kaW5nTW9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZWxlbWVudEluc3RydWN0aW9uKSB7XG4gICAgICAgIGVsZW1lbnRQcm9wZXJ0eSA9IGVsZW1lbnRJbnN0cnVjdGlvbi50eXBlLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV07XG4gICAgICAgIGlmIChlbGVtZW50UHJvcGVydHkpIHtcbiAgICAgICAgICBpbmZvLmRlZmF1bHRCaW5kaW5nTW9kZSA9IGVsZW1lbnRQcm9wZXJ0eS5kZWZhdWx0QmluZGluZ01vZGU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGVsZW1lbnRQcm9wZXJ0eSkge1xuICAgICAgICBpbnN0cnVjdGlvbiA9IGJpbmRpbmdMYW5ndWFnZS5jcmVhdGVBdHRyaWJ1dGVJbnN0cnVjdGlvbihyZXNvdXJjZXMsIG5vZGUsIGluZm8sIGVsZW1lbnRJbnN0cnVjdGlvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnN0cnVjdGlvbiA9IGJpbmRpbmdMYW5ndWFnZS5jcmVhdGVBdHRyaWJ1dGVJbnN0cnVjdGlvbihyZXNvdXJjZXMsIG5vZGUsIGluZm8sIHVuZGVmaW5lZCwgdHlwZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpbnN0cnVjdGlvbikge1xuICAgICAgICBpZiAoaW5zdHJ1Y3Rpb24uYWx0ZXJlZEF0dHIpIHtcbiAgICAgICAgICB0eXBlID0gcmVzb3VyY2VzLmdldEF0dHJpYnV0ZShpbnN0cnVjdGlvbi5hdHRyTmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW5zdHJ1Y3Rpb24uZGlzY3JldGUpIHtcbiAgICAgICAgICBleHByZXNzaW9ucy5wdXNoKGluc3RydWN0aW9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24udHlwZSA9IHR5cGU7XG4gICAgICAgICAgICB0aGlzLl9jb25maWd1cmVQcm9wZXJ0aWVzKGluc3RydWN0aW9uLCByZXNvdXJjZXMpO1xuXG4gICAgICAgICAgICBpZiAodHlwZS5saWZ0c0NvbnRlbnQpIHtcbiAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb24ub3JpZ2luYWxBdHRyTmFtZSA9IG9yaWdpbmFsQXR0ck5hbWU7XG4gICAgICAgICAgICAgIGxpZnRpbmdJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGJlaGF2aW9ySW5zdHJ1Y3Rpb25zLnB1c2goaW5zdHJ1Y3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudFByb3BlcnR5KSB7XG4gICAgICAgICAgICBlbGVtZW50SW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXS50YXJnZXRQcm9wZXJ0eSA9IGVsZW1lbnRQcm9wZXJ0eS5uYW1lO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleHByZXNzaW9ucy5wdXNoKGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5zdHJ1Y3Rpb24uYXR0ck5hbWVdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgaW5zdHJ1Y3Rpb24gPSBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShhdHRyTmFtZSwgdHlwZSk7XG4gICAgICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tyZXNvdXJjZXMubWFwQXR0cmlidXRlKGF0dHJOYW1lKV0gPSBhdHRyVmFsdWU7XG5cbiAgICAgICAgICBpZiAodHlwZS5saWZ0c0NvbnRlbnQpIHtcbiAgICAgICAgICAgIGluc3RydWN0aW9uLm9yaWdpbmFsQXR0ck5hbWUgPSBvcmlnaW5hbEF0dHJOYW1lO1xuICAgICAgICAgICAgbGlmdGluZ0luc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb247XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYmVoYXZpb3JJbnN0cnVjdGlvbnMucHVzaChpbnN0cnVjdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnRQcm9wZXJ0eSkge1xuICAgICAgICAgIGVsZW1lbnRJbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2F0dHJOYW1lXSA9IGF0dHJWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChsaWZ0aW5nSW5zdHJ1Y3Rpb24pIHtcbiAgICAgIGxpZnRpbmdJbnN0cnVjdGlvbi52aWV3RmFjdG9yeSA9IHZpZXdGYWN0b3J5O1xuICAgICAgbm9kZSA9IGxpZnRpbmdJbnN0cnVjdGlvbi50eXBlLmNvbXBpbGUodGhpcywgcmVzb3VyY2VzLCBub2RlLCBsaWZ0aW5nSW5zdHJ1Y3Rpb24sIHBhcmVudE5vZGUpO1xuICAgICAgYXVUYXJnZXRJRCA9IG1ha2VJbnRvSW5zdHJ1Y3Rpb25UYXJnZXQobm9kZSk7XG4gICAgICBpbnN0cnVjdGlvbnNbYXVUYXJnZXRJRF0gPSBUYXJnZXRJbnN0cnVjdGlvbi5saWZ0aW5nKHBhcmVudEluamVjdG9ySWQsIGxpZnRpbmdJbnN0cnVjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBza2lwQ29udGVudFByb2Nlc3NpbmcgPSBmYWxzZTtcblxuICAgICAgaWYgKGV4cHJlc3Npb25zLmxlbmd0aCB8fCBiZWhhdmlvckluc3RydWN0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgaW5qZWN0b3JJZCA9IGJlaGF2aW9ySW5zdHJ1Y3Rpb25zLmxlbmd0aCA/IGdldE5leHRJbmplY3RvcklkKCkgOiBmYWxzZTtcblxuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IGJlaGF2aW9ySW5zdHJ1Y3Rpb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICBpbnN0cnVjdGlvbiA9IGJlaGF2aW9ySW5zdHJ1Y3Rpb25zW2ldO1xuICAgICAgICAgIGluc3RydWN0aW9uLnR5cGUuY29tcGlsZSh0aGlzLCByZXNvdXJjZXMsIG5vZGUsIGluc3RydWN0aW9uLCBwYXJlbnROb2RlKTtcbiAgICAgICAgICBwcm92aWRlcnMucHVzaChpbnN0cnVjdGlvbi50eXBlLnRhcmdldCk7XG4gICAgICAgICAgc2tpcENvbnRlbnRQcm9jZXNzaW5nID0gc2tpcENvbnRlbnRQcm9jZXNzaW5nIHx8IGluc3RydWN0aW9uLnNraXBDb250ZW50UHJvY2Vzc2luZztcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gZXhwcmVzc2lvbnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgIGV4cHJlc3Npb24gPSBleHByZXNzaW9uc1tpXTtcbiAgICAgICAgICBpZiAoZXhwcmVzc2lvbi5hdHRyVG9SZW1vdmUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoZXhwcmVzc2lvbi5hdHRyVG9SZW1vdmUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGF1VGFyZ2V0SUQgPSBtYWtlSW50b0luc3RydWN0aW9uVGFyZ2V0KG5vZGUpO1xuICAgICAgICBpbnN0cnVjdGlvbnNbYXVUYXJnZXRJRF0gPSBUYXJnZXRJbnN0cnVjdGlvbi5ub3JtYWwoaW5qZWN0b3JJZCwgcGFyZW50SW5qZWN0b3JJZCwgcHJvdmlkZXJzLCBiZWhhdmlvckluc3RydWN0aW9ucywgZXhwcmVzc2lvbnMsIGVsZW1lbnRJbnN0cnVjdGlvbik7XG4gICAgICB9XG5cbiAgICAgIGlmIChza2lwQ29udGVudFByb2Nlc3NpbmcpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUubmV4dFNpYmxpbmc7XG4gICAgICB9XG5cbiAgICAgIGxldCBjdXJyZW50Q2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7XG4gICAgICB3aGlsZSAoY3VycmVudENoaWxkKSB7XG4gICAgICAgIGN1cnJlbnRDaGlsZCA9IHRoaXMuX2NvbXBpbGVOb2RlKGN1cnJlbnRDaGlsZCwgcmVzb3VyY2VzLCBpbnN0cnVjdGlvbnMsIG5vZGUsIGluamVjdG9ySWQgfHwgcGFyZW50SW5qZWN0b3JJZCwgdGFyZ2V0TGlnaHRET00pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBub2RlLm5leHRTaWJsaW5nO1xuICB9XG5cbiAgX2NvbmZpZ3VyZVByb3BlcnRpZXMoaW5zdHJ1Y3Rpb24sIHJlc291cmNlcykge1xuICAgIGxldCB0eXBlID0gaW5zdHJ1Y3Rpb24udHlwZTtcbiAgICBsZXQgYXR0ck5hbWUgPSBpbnN0cnVjdGlvbi5hdHRyTmFtZTtcbiAgICBsZXQgYXR0cmlidXRlcyA9IGluc3RydWN0aW9uLmF0dHJpYnV0ZXM7XG4gICAgbGV0IHByb3BlcnR5O1xuICAgIGxldCBrZXk7XG4gICAgbGV0IHZhbHVlO1xuXG4gICAgbGV0IGtub3duQXR0cmlidXRlID0gcmVzb3VyY2VzLm1hcEF0dHJpYnV0ZShhdHRyTmFtZSk7XG4gICAgaWYgKGtub3duQXR0cmlidXRlICYmIGF0dHJOYW1lIGluIGF0dHJpYnV0ZXMgJiYga25vd25BdHRyaWJ1dGUgIT09IGF0dHJOYW1lKSB7XG4gICAgICBhdHRyaWJ1dGVzW2tub3duQXR0cmlidXRlXSA9IGF0dHJpYnV0ZXNbYXR0ck5hbWVdO1xuICAgICAgZGVsZXRlIGF0dHJpYnV0ZXNbYXR0ck5hbWVdO1xuICAgIH1cblxuICAgIGZvciAoa2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgIHZhbHVlID0gYXR0cmlidXRlc1trZXldO1xuXG4gICAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICBwcm9wZXJ0eSA9IHR5cGUuYXR0cmlidXRlc1trZXldO1xuXG4gICAgICAgIGlmIChwcm9wZXJ0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdmFsdWUudGFyZ2V0UHJvcGVydHkgPSBwcm9wZXJ0eS5uYW1lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhbHVlLnRhcmdldFByb3BlcnR5ID0ga2V5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59KSB8fCBfY2xhc3MxNCk7XG5cbmV4cG9ydCBsZXQgUmVzb3VyY2VNb2R1bGUgPSBjbGFzcyBSZXNvdXJjZU1vZHVsZSB7XG4gIGNvbnN0cnVjdG9yKG1vZHVsZUlkKSB7XG4gICAgdGhpcy5pZCA9IG1vZHVsZUlkO1xuICAgIHRoaXMubW9kdWxlSW5zdGFuY2UgPSBudWxsO1xuICAgIHRoaXMubWFpblJlc291cmNlID0gbnVsbDtcbiAgICB0aGlzLnJlc291cmNlcyA9IG51bGw7XG4gICAgdGhpcy52aWV3U3RyYXRlZ3kgPSBudWxsO1xuICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IGZhbHNlO1xuICAgIHRoaXMub25Mb2FkZWQgPSBudWxsO1xuICAgIHRoaXMubG9hZENvbnRleHQgPSBudWxsO1xuICB9XG5cbiAgaW5pdGlhbGl6ZShjb250YWluZXIpIHtcbiAgICBsZXQgY3VycmVudCA9IHRoaXMubWFpblJlc291cmNlO1xuICAgIGxldCByZXNvdXJjZXMgPSB0aGlzLnJlc291cmNlcztcbiAgICBsZXQgdnMgPSB0aGlzLnZpZXdTdHJhdGVneTtcblxuICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuXG4gICAgaWYgKGN1cnJlbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY3VycmVudC5tZXRhZGF0YS52aWV3U3RyYXRlZ3kgPSB2cztcbiAgICAgIGN1cnJlbnQuaW5pdGlhbGl6ZShjb250YWluZXIpO1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHJlc291cmNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjdXJyZW50ID0gcmVzb3VyY2VzW2ldO1xuICAgICAgY3VycmVudC5tZXRhZGF0YS52aWV3U3RyYXRlZ3kgPSB2cztcbiAgICAgIGN1cnJlbnQuaW5pdGlhbGl6ZShjb250YWluZXIpO1xuICAgIH1cbiAgfVxuXG4gIHJlZ2lzdGVyKHJlZ2lzdHJ5LCBuYW1lKSB7XG4gICAgbGV0IG1haW4gPSB0aGlzLm1haW5SZXNvdXJjZTtcbiAgICBsZXQgcmVzb3VyY2VzID0gdGhpcy5yZXNvdXJjZXM7XG5cbiAgICBpZiAobWFpbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBtYWluLnJlZ2lzdGVyKHJlZ2lzdHJ5LCBuYW1lKTtcbiAgICAgIG5hbWUgPSBudWxsO1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHJlc291cmNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICByZXNvdXJjZXNbaV0ucmVnaXN0ZXIocmVnaXN0cnksIG5hbWUpO1xuICAgICAgbmFtZSA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgbG9hZChjb250YWluZXIsIGxvYWRDb250ZXh0KSB7XG4gICAgaWYgKHRoaXMub25Mb2FkZWQgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiB0aGlzLmxvYWRDb250ZXh0ID09PSBsb2FkQ29udGV4dCA/IFByb21pc2UucmVzb2x2ZSgpIDogdGhpcy5vbkxvYWRlZDtcbiAgICB9XG5cbiAgICBsZXQgbWFpbiA9IHRoaXMubWFpblJlc291cmNlO1xuICAgIGxldCByZXNvdXJjZXMgPSB0aGlzLnJlc291cmNlcztcbiAgICBsZXQgbG9hZHM7XG5cbiAgICBpZiAobWFpbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBsb2FkcyA9IG5ldyBBcnJheShyZXNvdXJjZXMubGVuZ3RoICsgMSk7XG4gICAgICBsb2Fkc1swXSA9IG1haW4ubG9hZChjb250YWluZXIsIGxvYWRDb250ZXh0KTtcbiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHJlc291cmNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGxvYWRzW2kgKyAxXSA9IHJlc291cmNlc1tpXS5sb2FkKGNvbnRhaW5lciwgbG9hZENvbnRleHQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBsb2FkcyA9IG5ldyBBcnJheShyZXNvdXJjZXMubGVuZ3RoKTtcbiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHJlc291cmNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGxvYWRzW2ldID0gcmVzb3VyY2VzW2ldLmxvYWQoY29udGFpbmVyLCBsb2FkQ29udGV4dCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5sb2FkQ29udGV4dCA9IGxvYWRDb250ZXh0O1xuICAgIHRoaXMub25Mb2FkZWQgPSBQcm9taXNlLmFsbChsb2Fkcyk7XG4gICAgcmV0dXJuIHRoaXMub25Mb2FkZWQ7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgUmVzb3VyY2VEZXNjcmlwdGlvbiA9IGNsYXNzIFJlc291cmNlRGVzY3JpcHRpb24ge1xuICBjb25zdHJ1Y3RvcihrZXksIGV4cG9ydGVkVmFsdWUsIHJlc291cmNlVHlwZU1ldGEpIHtcbiAgICBpZiAoIXJlc291cmNlVHlwZU1ldGEpIHtcbiAgICAgIHJlc291cmNlVHlwZU1ldGEgPSBtZXRhZGF0YS5nZXQobWV0YWRhdGEucmVzb3VyY2UsIGV4cG9ydGVkVmFsdWUpO1xuXG4gICAgICBpZiAoIXJlc291cmNlVHlwZU1ldGEpIHtcbiAgICAgICAgcmVzb3VyY2VUeXBlTWV0YSA9IG5ldyBIdG1sQmVoYXZpb3JSZXNvdXJjZSgpO1xuICAgICAgICByZXNvdXJjZVR5cGVNZXRhLmVsZW1lbnROYW1lID0gX2h5cGhlbmF0ZShrZXkpO1xuICAgICAgICBtZXRhZGF0YS5kZWZpbmUobWV0YWRhdGEucmVzb3VyY2UsIHJlc291cmNlVHlwZU1ldGEsIGV4cG9ydGVkVmFsdWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChyZXNvdXJjZVR5cGVNZXRhIGluc3RhbmNlb2YgSHRtbEJlaGF2aW9yUmVzb3VyY2UpIHtcbiAgICAgIGlmIChyZXNvdXJjZVR5cGVNZXRhLmVsZW1lbnROYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmVzb3VyY2VUeXBlTWV0YS5lbGVtZW50TmFtZSA9IF9oeXBoZW5hdGUoa2V5KTtcbiAgICAgIH0gZWxzZSBpZiAocmVzb3VyY2VUeXBlTWV0YS5hdHRyaWJ1dGVOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmVzb3VyY2VUeXBlTWV0YS5hdHRyaWJ1dGVOYW1lID0gX2h5cGhlbmF0ZShrZXkpO1xuICAgICAgfSBlbHNlIGlmIChyZXNvdXJjZVR5cGVNZXRhLmF0dHJpYnV0ZU5hbWUgPT09IG51bGwgJiYgcmVzb3VyY2VUeXBlTWV0YS5lbGVtZW50TmFtZSA9PT0gbnVsbCkge1xuICAgICAgICBIdG1sQmVoYXZpb3JSZXNvdXJjZS5jb252ZW50aW9uKGtleSwgcmVzb3VyY2VUeXBlTWV0YSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICghcmVzb3VyY2VUeXBlTWV0YS5uYW1lKSB7XG4gICAgICByZXNvdXJjZVR5cGVNZXRhLm5hbWUgPSBfaHlwaGVuYXRlKGtleSk7XG4gICAgfVxuXG4gICAgdGhpcy5tZXRhZGF0YSA9IHJlc291cmNlVHlwZU1ldGE7XG4gICAgdGhpcy52YWx1ZSA9IGV4cG9ydGVkVmFsdWU7XG4gIH1cblxuICBpbml0aWFsaXplKGNvbnRhaW5lcikge1xuICAgIHRoaXMubWV0YWRhdGEuaW5pdGlhbGl6ZShjb250YWluZXIsIHRoaXMudmFsdWUpO1xuICB9XG5cbiAgcmVnaXN0ZXIocmVnaXN0cnksIG5hbWUpIHtcbiAgICB0aGlzLm1ldGFkYXRhLnJlZ2lzdGVyKHJlZ2lzdHJ5LCBuYW1lKTtcbiAgfVxuXG4gIGxvYWQoY29udGFpbmVyLCBsb2FkQ29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLm1ldGFkYXRhLmxvYWQoY29udGFpbmVyLCB0aGlzLnZhbHVlLCBsb2FkQ29udGV4dCk7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgTW9kdWxlQW5hbHl6ZXIgPSBjbGFzcyBNb2R1bGVBbmFseXplciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICB9XG5cbiAgZ2V0QW5hbHlzaXMobW9kdWxlSWQpIHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZVttb2R1bGVJZF07XG4gIH1cblxuICBhbmFseXplKG1vZHVsZUlkLCBtb2R1bGVJbnN0YW5jZSwgbWFpblJlc291cmNlS2V5KSB7XG4gICAgbGV0IG1haW5SZXNvdXJjZTtcbiAgICBsZXQgZmFsbGJhY2tWYWx1ZTtcbiAgICBsZXQgZmFsbGJhY2tLZXk7XG4gICAgbGV0IHJlc291cmNlVHlwZU1ldGE7XG4gICAgbGV0IGtleTtcbiAgICBsZXQgZXhwb3J0ZWRWYWx1ZTtcbiAgICBsZXQgcmVzb3VyY2VzID0gW107XG4gICAgbGV0IGNvbnZlbnRpb25hbDtcbiAgICBsZXQgdnM7XG4gICAgbGV0IHJlc291cmNlTW9kdWxlO1xuXG4gICAgcmVzb3VyY2VNb2R1bGUgPSB0aGlzLmNhY2hlW21vZHVsZUlkXTtcbiAgICBpZiAocmVzb3VyY2VNb2R1bGUpIHtcbiAgICAgIHJldHVybiByZXNvdXJjZU1vZHVsZTtcbiAgICB9XG5cbiAgICByZXNvdXJjZU1vZHVsZSA9IG5ldyBSZXNvdXJjZU1vZHVsZShtb2R1bGVJZCk7XG4gICAgdGhpcy5jYWNoZVttb2R1bGVJZF0gPSByZXNvdXJjZU1vZHVsZTtcblxuICAgIGlmICh0eXBlb2YgbW9kdWxlSW5zdGFuY2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIG1vZHVsZUluc3RhbmNlID0geyAnZGVmYXVsdCc6IG1vZHVsZUluc3RhbmNlIH07XG4gICAgfVxuXG4gICAgaWYgKG1haW5SZXNvdXJjZUtleSkge1xuICAgICAgbWFpblJlc291cmNlID0gbmV3IFJlc291cmNlRGVzY3JpcHRpb24obWFpblJlc291cmNlS2V5LCBtb2R1bGVJbnN0YW5jZVttYWluUmVzb3VyY2VLZXldKTtcbiAgICB9XG5cbiAgICBmb3IgKGtleSBpbiBtb2R1bGVJbnN0YW5jZSkge1xuICAgICAgZXhwb3J0ZWRWYWx1ZSA9IG1vZHVsZUluc3RhbmNlW2tleV07XG5cbiAgICAgIGlmIChrZXkgPT09IG1haW5SZXNvdXJjZUtleSB8fCB0eXBlb2YgZXhwb3J0ZWRWYWx1ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgcmVzb3VyY2VUeXBlTWV0YSA9IG1ldGFkYXRhLmdldChtZXRhZGF0YS5yZXNvdXJjZSwgZXhwb3J0ZWRWYWx1ZSk7XG5cbiAgICAgIGlmIChyZXNvdXJjZVR5cGVNZXRhKSB7XG4gICAgICAgIGlmIChyZXNvdXJjZVR5cGVNZXRhIGluc3RhbmNlb2YgSHRtbEJlaGF2aW9yUmVzb3VyY2UpIHtcbiAgICAgICAgICBWaWV3UmVzb3VyY2VzLmNvbnZlbnRpb24oZXhwb3J0ZWRWYWx1ZSwgcmVzb3VyY2VUeXBlTWV0YSk7XG5cbiAgICAgICAgICBpZiAocmVzb3VyY2VUeXBlTWV0YS5hdHRyaWJ1dGVOYW1lID09PSBudWxsICYmIHJlc291cmNlVHlwZU1ldGEuZWxlbWVudE5hbWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgIEh0bWxCZWhhdmlvclJlc291cmNlLmNvbnZlbnRpb24oa2V5LCByZXNvdXJjZVR5cGVNZXRhKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAocmVzb3VyY2VUeXBlTWV0YS5hdHRyaWJ1dGVOYW1lID09PSBudWxsICYmIHJlc291cmNlVHlwZU1ldGEuZWxlbWVudE5hbWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJlc291cmNlVHlwZU1ldGEuZWxlbWVudE5hbWUgPSBfaHlwaGVuYXRlKGtleSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFtYWluUmVzb3VyY2UgJiYgcmVzb3VyY2VUeXBlTWV0YSBpbnN0YW5jZW9mIEh0bWxCZWhhdmlvclJlc291cmNlICYmIHJlc291cmNlVHlwZU1ldGEuZWxlbWVudE5hbWUgIT09IG51bGwpIHtcbiAgICAgICAgICBtYWluUmVzb3VyY2UgPSBuZXcgUmVzb3VyY2VEZXNjcmlwdGlvbihrZXksIGV4cG9ydGVkVmFsdWUsIHJlc291cmNlVHlwZU1ldGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc291cmNlcy5wdXNoKG5ldyBSZXNvdXJjZURlc2NyaXB0aW9uKGtleSwgZXhwb3J0ZWRWYWx1ZSwgcmVzb3VyY2VUeXBlTWV0YSkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHZpZXdTdHJhdGVneS5kZWNvcmF0ZXMoZXhwb3J0ZWRWYWx1ZSkpIHtcbiAgICAgICAgdnMgPSBleHBvcnRlZFZhbHVlO1xuICAgICAgfSBlbHNlIGlmIChleHBvcnRlZFZhbHVlIGluc3RhbmNlb2YgVGVtcGxhdGVSZWdpc3RyeUVudHJ5KSB7XG4gICAgICAgIHZzID0gbmV3IFRlbXBsYXRlUmVnaXN0cnlWaWV3U3RyYXRlZ3kobW9kdWxlSWQsIGV4cG9ydGVkVmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGNvbnZlbnRpb25hbCA9IFZpZXdSZXNvdXJjZXMuY29udmVudGlvbihleHBvcnRlZFZhbHVlKSkge1xuICAgICAgICAgIGlmIChjb252ZW50aW9uYWwuZWxlbWVudE5hbWUgIT09IG51bGwgJiYgIW1haW5SZXNvdXJjZSkge1xuICAgICAgICAgICAgbWFpblJlc291cmNlID0gbmV3IFJlc291cmNlRGVzY3JpcHRpb24oa2V5LCBleHBvcnRlZFZhbHVlLCBjb252ZW50aW9uYWwpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNvdXJjZXMucHVzaChuZXcgUmVzb3VyY2VEZXNjcmlwdGlvbihrZXksIGV4cG9ydGVkVmFsdWUsIGNvbnZlbnRpb25hbCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXRhZGF0YS5kZWZpbmUobWV0YWRhdGEucmVzb3VyY2UsIGNvbnZlbnRpb25hbCwgZXhwb3J0ZWRWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29udmVudGlvbmFsID0gSHRtbEJlaGF2aW9yUmVzb3VyY2UuY29udmVudGlvbihrZXkpKSB7XG4gICAgICAgICAgaWYgKGNvbnZlbnRpb25hbC5lbGVtZW50TmFtZSAhPT0gbnVsbCAmJiAhbWFpblJlc291cmNlKSB7XG4gICAgICAgICAgICBtYWluUmVzb3VyY2UgPSBuZXcgUmVzb3VyY2VEZXNjcmlwdGlvbihrZXksIGV4cG9ydGVkVmFsdWUsIGNvbnZlbnRpb25hbCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc291cmNlcy5wdXNoKG5ldyBSZXNvdXJjZURlc2NyaXB0aW9uKGtleSwgZXhwb3J0ZWRWYWx1ZSwgY29udmVudGlvbmFsKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbWV0YWRhdGEuZGVmaW5lKG1ldGFkYXRhLnJlc291cmNlLCBjb252ZW50aW9uYWwsIGV4cG9ydGVkVmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbnZlbnRpb25hbCA9IFZhbHVlQ29udmVydGVyUmVzb3VyY2UuY29udmVudGlvbihrZXkpIHx8IEJpbmRpbmdCZWhhdmlvclJlc291cmNlLmNvbnZlbnRpb24oa2V5KSB8fCBWaWV3RW5naW5lSG9va3NSZXNvdXJjZS5jb252ZW50aW9uKGtleSkpIHtcbiAgICAgICAgICByZXNvdXJjZXMucHVzaChuZXcgUmVzb3VyY2VEZXNjcmlwdGlvbihrZXksIGV4cG9ydGVkVmFsdWUsIGNvbnZlbnRpb25hbCkpO1xuICAgICAgICAgIG1ldGFkYXRhLmRlZmluZShtZXRhZGF0YS5yZXNvdXJjZSwgY29udmVudGlvbmFsLCBleHBvcnRlZFZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmICghZmFsbGJhY2tWYWx1ZSkge1xuICAgICAgICAgIGZhbGxiYWNrVmFsdWUgPSBleHBvcnRlZFZhbHVlO1xuICAgICAgICAgIGZhbGxiYWNrS2V5ID0ga2V5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFtYWluUmVzb3VyY2UgJiYgZmFsbGJhY2tWYWx1ZSkge1xuICAgICAgbWFpblJlc291cmNlID0gbmV3IFJlc291cmNlRGVzY3JpcHRpb24oZmFsbGJhY2tLZXksIGZhbGxiYWNrVmFsdWUpO1xuICAgIH1cblxuICAgIHJlc291cmNlTW9kdWxlLm1vZHVsZUluc3RhbmNlID0gbW9kdWxlSW5zdGFuY2U7XG4gICAgcmVzb3VyY2VNb2R1bGUubWFpblJlc291cmNlID0gbWFpblJlc291cmNlO1xuICAgIHJlc291cmNlTW9kdWxlLnJlc291cmNlcyA9IHJlc291cmNlcztcbiAgICByZXNvdXJjZU1vZHVsZS52aWV3U3RyYXRlZ3kgPSB2cztcblxuICAgIHJldHVybiByZXNvdXJjZU1vZHVsZTtcbiAgfVxufTtcblxubGV0IGxvZ2dlciA9IExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCd0ZW1wbGF0aW5nJyk7XG5cbmZ1bmN0aW9uIGVuc3VyZVJlZ2lzdHJ5RW50cnkobG9hZGVyLCB1cmxPclJlZ2lzdHJ5RW50cnkpIHtcbiAgaWYgKHVybE9yUmVnaXN0cnlFbnRyeSBpbnN0YW5jZW9mIFRlbXBsYXRlUmVnaXN0cnlFbnRyeSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodXJsT3JSZWdpc3RyeUVudHJ5KTtcbiAgfVxuXG4gIHJldHVybiBsb2FkZXIubG9hZFRlbXBsYXRlKHVybE9yUmVnaXN0cnlFbnRyeSk7XG59XG5cbmxldCBQcm94eVZpZXdGYWN0b3J5ID0gY2xhc3MgUHJveHlWaWV3RmFjdG9yeSB7XG4gIGNvbnN0cnVjdG9yKHByb21pc2UpIHtcbiAgICBwcm9taXNlLnRoZW4oeCA9PiB0aGlzLnZpZXdGYWN0b3J5ID0geCk7XG4gIH1cblxuICBjcmVhdGUoY29udGFpbmVyLCBiaW5kaW5nQ29udGV4dCwgY3JlYXRlSW5zdHJ1Y3Rpb24sIGVsZW1lbnQpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3RmFjdG9yeS5jcmVhdGUoY29udGFpbmVyLCBiaW5kaW5nQ29udGV4dCwgY3JlYXRlSW5zdHJ1Y3Rpb24sIGVsZW1lbnQpO1xuICB9XG5cbiAgZ2V0IGlzQ2FjaGluZygpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3RmFjdG9yeS5pc0NhY2hpbmc7XG4gIH1cblxuICBzZXRDYWNoZVNpemUoc2l6ZSwgZG9Ob3RPdmVycmlkZUlmQWxyZWFkeVNldCkge1xuICAgIHRoaXMudmlld0ZhY3Rvcnkuc2V0Q2FjaGVTaXplKHNpemUsIGRvTm90T3ZlcnJpZGVJZkFscmVhZHlTZXQpO1xuICB9XG5cbiAgZ2V0Q2FjaGVkVmlldygpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3RmFjdG9yeS5nZXRDYWNoZWRWaWV3KCk7XG4gIH1cblxuICByZXR1cm5WaWV3VG9DYWNoZSh2aWV3KSB7XG4gICAgdGhpcy52aWV3RmFjdG9yeS5yZXR1cm5WaWV3VG9DYWNoZSh2aWV3KTtcbiAgfVxufTtcblxuXG5sZXQgYXVTbG90QmVoYXZpb3IgPSBudWxsO1xuXG5leHBvcnQgbGV0IFZpZXdFbmdpbmUgPSAoX2RlYzggPSBpbmplY3QoTG9hZGVyLCBDb250YWluZXIsIFZpZXdDb21waWxlciwgTW9kdWxlQW5hbHl6ZXIsIFZpZXdSZXNvdXJjZXMpLCBfZGVjOChfY2xhc3MxNSA9IChfdGVtcDUgPSBfY2xhc3MxNiA9IGNsYXNzIFZpZXdFbmdpbmUge1xuICBjb25zdHJ1Y3Rvcihsb2FkZXIsIGNvbnRhaW5lciwgdmlld0NvbXBpbGVyLCBtb2R1bGVBbmFseXplciwgYXBwUmVzb3VyY2VzKSB7XG4gICAgdGhpcy5sb2FkZXIgPSBsb2FkZXI7XG4gICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgdGhpcy52aWV3Q29tcGlsZXIgPSB2aWV3Q29tcGlsZXI7XG4gICAgdGhpcy5tb2R1bGVBbmFseXplciA9IG1vZHVsZUFuYWx5emVyO1xuICAgIHRoaXMuYXBwUmVzb3VyY2VzID0gYXBwUmVzb3VyY2VzO1xuICAgIHRoaXMuX3BsdWdpbk1hcCA9IHt9O1xuXG4gICAgaWYgKGF1U2xvdEJlaGF2aW9yID09PSBudWxsKSB7XG4gICAgICBhdVNsb3RCZWhhdmlvciA9IG5ldyBIdG1sQmVoYXZpb3JSZXNvdXJjZSgpO1xuICAgICAgYXVTbG90QmVoYXZpb3IuYXR0cmlidXRlTmFtZSA9ICdhdS1zbG90JztcbiAgICAgIG1ldGFkYXRhLmRlZmluZShtZXRhZGF0YS5yZXNvdXJjZSwgYXVTbG90QmVoYXZpb3IsIFNsb3RDdXN0b21BdHRyaWJ1dGUpO1xuICAgIH1cblxuICAgIGF1U2xvdEJlaGF2aW9yLmluaXRpYWxpemUoY29udGFpbmVyLCBTbG90Q3VzdG9tQXR0cmlidXRlKTtcbiAgICBhdVNsb3RCZWhhdmlvci5yZWdpc3RlcihhcHBSZXNvdXJjZXMpO1xuICB9XG5cbiAgYWRkUmVzb3VyY2VQbHVnaW4oZXh0ZW5zaW9uLCBpbXBsZW1lbnRhdGlvbikge1xuICAgIGxldCBuYW1lID0gZXh0ZW5zaW9uLnJlcGxhY2UoJy4nLCAnJykgKyAnLXJlc291cmNlLXBsdWdpbic7XG4gICAgdGhpcy5fcGx1Z2luTWFwW2V4dGVuc2lvbl0gPSBuYW1lO1xuICAgIHRoaXMubG9hZGVyLmFkZFBsdWdpbihuYW1lLCBpbXBsZW1lbnRhdGlvbik7XG4gIH1cblxuICBsb2FkVmlld0ZhY3RvcnkodXJsT3JSZWdpc3RyeUVudHJ5LCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0LCB0YXJnZXQpIHtcbiAgICBsb2FkQ29udGV4dCA9IGxvYWRDb250ZXh0IHx8IG5ldyBSZXNvdXJjZUxvYWRDb250ZXh0KCk7XG5cbiAgICByZXR1cm4gZW5zdXJlUmVnaXN0cnlFbnRyeSh0aGlzLmxvYWRlciwgdXJsT3JSZWdpc3RyeUVudHJ5KS50aGVuKHJlZ2lzdHJ5RW50cnkgPT4ge1xuICAgICAgY29uc3QgdXJsID0gcmVnaXN0cnlFbnRyeS5hZGRyZXNzO1xuXG4gICAgICBpZiAocmVnaXN0cnlFbnRyeS5vblJlYWR5KSB7XG4gICAgICAgIGlmICghbG9hZENvbnRleHQuaGFzRGVwZW5kZW5jeSh1cmwpKSB7XG4gICAgICAgICAgbG9hZENvbnRleHQuYWRkRGVwZW5kZW5jeSh1cmwpO1xuICAgICAgICAgIHJldHVybiByZWdpc3RyeUVudHJ5Lm9uUmVhZHk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVnaXN0cnlFbnRyeS50ZW1wbGF0ZSA9PT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiByZWdpc3RyeUVudHJ5Lm9uUmVhZHk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBQcm94eVZpZXdGYWN0b3J5KHJlZ2lzdHJ5RW50cnkub25SZWFkeSkpO1xuICAgICAgfVxuXG4gICAgICBsb2FkQ29udGV4dC5hZGREZXBlbmRlbmN5KHVybCk7XG5cbiAgICAgIHJlZ2lzdHJ5RW50cnkub25SZWFkeSA9IHRoaXMubG9hZFRlbXBsYXRlUmVzb3VyY2VzKHJlZ2lzdHJ5RW50cnksIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQsIHRhcmdldCkudGhlbihyZXNvdXJjZXMgPT4ge1xuICAgICAgICByZWdpc3RyeUVudHJ5LnJlc291cmNlcyA9IHJlc291cmNlcztcblxuICAgICAgICBpZiAocmVnaXN0cnlFbnRyeS50ZW1wbGF0ZSA9PT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiByZWdpc3RyeUVudHJ5LmZhY3RvcnkgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHZpZXdGYWN0b3J5ID0gdGhpcy52aWV3Q29tcGlsZXIuY29tcGlsZShyZWdpc3RyeUVudHJ5LnRlbXBsYXRlLCByZXNvdXJjZXMsIGNvbXBpbGVJbnN0cnVjdGlvbik7XG4gICAgICAgIHJldHVybiByZWdpc3RyeUVudHJ5LmZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcmVnaXN0cnlFbnRyeS5vblJlYWR5O1xuICAgIH0pO1xuICB9XG5cbiAgbG9hZFRlbXBsYXRlUmVzb3VyY2VzKHJlZ2lzdHJ5RW50cnksIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQsIHRhcmdldCkge1xuICAgIGxldCByZXNvdXJjZXMgPSBuZXcgVmlld1Jlc291cmNlcyh0aGlzLmFwcFJlc291cmNlcywgcmVnaXN0cnlFbnRyeS5hZGRyZXNzKTtcbiAgICBsZXQgZGVwZW5kZW5jaWVzID0gcmVnaXN0cnlFbnRyeS5kZXBlbmRlbmNpZXM7XG4gICAgbGV0IGltcG9ydElkcztcbiAgICBsZXQgbmFtZXM7XG5cbiAgICBjb21waWxlSW5zdHJ1Y3Rpb24gPSBjb21waWxlSW5zdHJ1Y3Rpb24gfHwgVmlld0NvbXBpbGVJbnN0cnVjdGlvbi5ub3JtYWw7XG5cbiAgICBpZiAoZGVwZW5kZW5jaWVzLmxlbmd0aCA9PT0gMCAmJiAhY29tcGlsZUluc3RydWN0aW9uLmFzc29jaWF0ZWRNb2R1bGVJZCkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXNvdXJjZXMpO1xuICAgIH1cblxuICAgIGltcG9ydElkcyA9IGRlcGVuZGVuY2llcy5tYXAoeCA9PiB4LnNyYyk7XG4gICAgbmFtZXMgPSBkZXBlbmRlbmNpZXMubWFwKHggPT4geC5uYW1lKTtcbiAgICBsb2dnZXIuZGVidWcoYGltcG9ydGluZyByZXNvdXJjZXMgZm9yICR7cmVnaXN0cnlFbnRyeS5hZGRyZXNzfWAsIGltcG9ydElkcyk7XG5cbiAgICBpZiAodGFyZ2V0KSB7XG4gICAgICBsZXQgdmlld01vZGVsUmVxdWlyZXMgPSBtZXRhZGF0YS5nZXQoVmlld0VuZ2luZS52aWV3TW9kZWxSZXF1aXJlTWV0YWRhdGFLZXksIHRhcmdldCk7XG4gICAgICBpZiAodmlld01vZGVsUmVxdWlyZXMpIHtcbiAgICAgICAgbGV0IHRlbXBsYXRlSW1wb3J0Q291bnQgPSBpbXBvcnRJZHMubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB2aWV3TW9kZWxSZXF1aXJlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgbGV0IHJlcSA9IHZpZXdNb2RlbFJlcXVpcmVzW2ldO1xuICAgICAgICAgIGxldCBpbXBvcnRJZCA9IHR5cGVvZiByZXEgPT09ICdmdW5jdGlvbicgPyBPcmlnaW4uZ2V0KHJlcSkubW9kdWxlSWQgOiByZWxhdGl2ZVRvRmlsZShyZXEuc3JjIHx8IHJlcSwgcmVnaXN0cnlFbnRyeS5hZGRyZXNzKTtcblxuICAgICAgICAgIGlmIChpbXBvcnRJZHMuaW5kZXhPZihpbXBvcnRJZCkgPT09IC0xKSB7XG4gICAgICAgICAgICBpbXBvcnRJZHMucHVzaChpbXBvcnRJZCk7XG4gICAgICAgICAgICBuYW1lcy5wdXNoKHJlcS5hcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxvZ2dlci5kZWJ1ZyhgaW1wb3J0aW5nIFZpZXdNb2RlbCByZXNvdXJjZXMgZm9yICR7Y29tcGlsZUluc3RydWN0aW9uLmFzc29jaWF0ZWRNb2R1bGVJZH1gLCBpbXBvcnRJZHMuc2xpY2UodGVtcGxhdGVJbXBvcnRDb3VudCkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmltcG9ydFZpZXdSZXNvdXJjZXMoaW1wb3J0SWRzLCBuYW1lcywgcmVzb3VyY2VzLCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0KTtcbiAgfVxuXG4gIGltcG9ydFZpZXdNb2RlbFJlc291cmNlKG1vZHVsZUltcG9ydCwgbW9kdWxlTWVtYmVyKSB7XG4gICAgcmV0dXJuIHRoaXMubG9hZGVyLmxvYWRNb2R1bGUobW9kdWxlSW1wb3J0KS50aGVuKHZpZXdNb2RlbE1vZHVsZSA9PiB7XG4gICAgICBsZXQgbm9ybWFsaXplZElkID0gT3JpZ2luLmdldCh2aWV3TW9kZWxNb2R1bGUpLm1vZHVsZUlkO1xuICAgICAgbGV0IHJlc291cmNlTW9kdWxlID0gdGhpcy5tb2R1bGVBbmFseXplci5hbmFseXplKG5vcm1hbGl6ZWRJZCwgdmlld01vZGVsTW9kdWxlLCBtb2R1bGVNZW1iZXIpO1xuXG4gICAgICBpZiAoIXJlc291cmNlTW9kdWxlLm1haW5SZXNvdXJjZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIHZpZXcgbW9kZWwgZm91bmQgaW4gbW9kdWxlIFwiJHttb2R1bGVJbXBvcnR9XCIuYCk7XG4gICAgICB9XG5cbiAgICAgIHJlc291cmNlTW9kdWxlLmluaXRpYWxpemUodGhpcy5jb250YWluZXIpO1xuXG4gICAgICByZXR1cm4gcmVzb3VyY2VNb2R1bGUubWFpblJlc291cmNlO1xuICAgIH0pO1xuICB9XG5cbiAgaW1wb3J0Vmlld1Jlc291cmNlcyhtb2R1bGVJZHMsIG5hbWVzLCByZXNvdXJjZXMsIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQpIHtcbiAgICBsb2FkQ29udGV4dCA9IGxvYWRDb250ZXh0IHx8IG5ldyBSZXNvdXJjZUxvYWRDb250ZXh0KCk7XG4gICAgY29tcGlsZUluc3RydWN0aW9uID0gY29tcGlsZUluc3RydWN0aW9uIHx8IFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24ubm9ybWFsO1xuXG4gICAgbW9kdWxlSWRzID0gbW9kdWxlSWRzLm1hcCh4ID0+IHRoaXMuX2FwcGx5TG9hZGVyUGx1Z2luKHgpKTtcblxuICAgIHJldHVybiB0aGlzLmxvYWRlci5sb2FkQWxsTW9kdWxlcyhtb2R1bGVJZHMpLnRoZW4oaW1wb3J0cyA9PiB7XG4gICAgICBsZXQgaTtcbiAgICAgIGxldCBpaTtcbiAgICAgIGxldCBhbmFseXNpcztcbiAgICAgIGxldCBub3JtYWxpemVkSWQ7XG4gICAgICBsZXQgY3VycmVudDtcbiAgICAgIGxldCBhc3NvY2lhdGVkTW9kdWxlO1xuICAgICAgbGV0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyO1xuICAgICAgbGV0IG1vZHVsZUFuYWx5emVyID0gdGhpcy5tb2R1bGVBbmFseXplcjtcbiAgICAgIGxldCBhbGxBbmFseXNpcyA9IG5ldyBBcnJheShpbXBvcnRzLmxlbmd0aCk7XG5cbiAgICAgIGZvciAoaSA9IDAsIGlpID0gaW1wb3J0cy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGN1cnJlbnQgPSBpbXBvcnRzW2ldO1xuICAgICAgICBub3JtYWxpemVkSWQgPSBPcmlnaW4uZ2V0KGN1cnJlbnQpLm1vZHVsZUlkO1xuXG4gICAgICAgIGFuYWx5c2lzID0gbW9kdWxlQW5hbHl6ZXIuYW5hbHl6ZShub3JtYWxpemVkSWQsIGN1cnJlbnQpO1xuICAgICAgICBhbmFseXNpcy5pbml0aWFsaXplKGNvbnRhaW5lcik7XG4gICAgICAgIGFuYWx5c2lzLnJlZ2lzdGVyKHJlc291cmNlcywgbmFtZXNbaV0pO1xuXG4gICAgICAgIGFsbEFuYWx5c2lzW2ldID0gYW5hbHlzaXM7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb21waWxlSW5zdHJ1Y3Rpb24uYXNzb2NpYXRlZE1vZHVsZUlkKSB7XG4gICAgICAgIGFzc29jaWF0ZWRNb2R1bGUgPSBtb2R1bGVBbmFseXplci5nZXRBbmFseXNpcyhjb21waWxlSW5zdHJ1Y3Rpb24uYXNzb2NpYXRlZE1vZHVsZUlkKTtcblxuICAgICAgICBpZiAoYXNzb2NpYXRlZE1vZHVsZSkge1xuICAgICAgICAgIGFzc29jaWF0ZWRNb2R1bGUucmVnaXN0ZXIocmVzb3VyY2VzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IGFsbEFuYWx5c2lzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgYWxsQW5hbHlzaXNbaV0gPSBhbGxBbmFseXNpc1tpXS5sb2FkKGNvbnRhaW5lciwgbG9hZENvbnRleHQpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwoYWxsQW5hbHlzaXMpLnRoZW4oKCkgPT4gcmVzb3VyY2VzKTtcbiAgICB9KTtcbiAgfVxuXG4gIF9hcHBseUxvYWRlclBsdWdpbihpZCkge1xuICAgIGxldCBpbmRleCA9IGlkLmxhc3RJbmRleE9mKCcuJyk7XG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgbGV0IGV4dCA9IGlkLnN1YnN0cmluZyhpbmRleCk7XG4gICAgICBsZXQgcGx1Z2luTmFtZSA9IHRoaXMuX3BsdWdpbk1hcFtleHRdO1xuXG4gICAgICBpZiAocGx1Z2luTmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBpZDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMubG9hZGVyLmFwcGx5UGx1Z2luVG9VcmwoaWQsIHBsdWdpbk5hbWUpO1xuICAgIH1cblxuICAgIHJldHVybiBpZDtcbiAgfVxufSwgX2NsYXNzMTYudmlld01vZGVsUmVxdWlyZU1ldGFkYXRhS2V5ID0gJ2F1cmVsaWE6dmlldy1tb2RlbC1yZXF1aXJlJywgX3RlbXA1KSkgfHwgX2NsYXNzMTUpO1xuXG5leHBvcnQgbGV0IENvbnRyb2xsZXIgPSBjbGFzcyBDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IoYmVoYXZpb3IsIGluc3RydWN0aW9uLCB2aWV3TW9kZWwsIGNvbnRhaW5lcikge1xuICAgIHRoaXMuYmVoYXZpb3IgPSBiZWhhdmlvcjtcbiAgICB0aGlzLmluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb247XG4gICAgdGhpcy52aWV3TW9kZWwgPSB2aWV3TW9kZWw7XG4gICAgdGhpcy5pc0F0dGFjaGVkID0gZmFsc2U7XG4gICAgdGhpcy52aWV3ID0gbnVsbDtcbiAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcbiAgICB0aGlzLnNjb3BlID0gbnVsbDtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICB0aGlzLmVsZW1lbnRFdmVudHMgPSBjb250YWluZXIuZWxlbWVudEV2ZW50cyB8fCBudWxsO1xuXG4gICAgbGV0IG9ic2VydmVyTG9va3VwID0gYmVoYXZpb3Iub2JzZXJ2ZXJMb2NhdG9yLmdldE9yQ3JlYXRlT2JzZXJ2ZXJzTG9va3VwKHZpZXdNb2RlbCk7XG4gICAgbGV0IGhhbmRsZXNCaW5kID0gYmVoYXZpb3IuaGFuZGxlc0JpbmQ7XG4gICAgbGV0IGF0dHJpYnV0ZXMgPSBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzO1xuICAgIGxldCBib3VuZFByb3BlcnRpZXMgPSB0aGlzLmJvdW5kUHJvcGVydGllcyA9IFtdO1xuICAgIGxldCBwcm9wZXJ0aWVzID0gYmVoYXZpb3IucHJvcGVydGllcztcbiAgICBsZXQgaTtcbiAgICBsZXQgaWk7XG5cbiAgICBiZWhhdmlvci5fZW5zdXJlUHJvcGVydGllc0RlZmluZWQodmlld01vZGVsLCBvYnNlcnZlckxvb2t1cCk7XG5cbiAgICBmb3IgKGkgPSAwLCBpaSA9IHByb3BlcnRpZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgcHJvcGVydGllc1tpXS5faW5pdGlhbGl6ZSh2aWV3TW9kZWwsIG9ic2VydmVyTG9va3VwLCBhdHRyaWJ1dGVzLCBoYW5kbGVzQmluZCwgYm91bmRQcm9wZXJ0aWVzKTtcbiAgICB9XG4gIH1cblxuICBjcmVhdGVkKG93bmluZ1ZpZXcpIHtcbiAgICBpZiAodGhpcy5iZWhhdmlvci5oYW5kbGVzQ3JlYXRlZCkge1xuICAgICAgdGhpcy52aWV3TW9kZWwuY3JlYXRlZChvd25pbmdWaWV3LCB0aGlzLnZpZXcpO1xuICAgIH1cbiAgfVxuXG4gIGF1dG9tYXRlKG92ZXJyaWRlQ29udGV4dCwgb3duaW5nVmlldykge1xuICAgIHRoaXMudmlldy5iaW5kaW5nQ29udGV4dCA9IHRoaXMudmlld01vZGVsO1xuICAgIHRoaXMudmlldy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQgfHwgY3JlYXRlT3ZlcnJpZGVDb250ZXh0KHRoaXMudmlld01vZGVsKTtcbiAgICB0aGlzLnZpZXcuX2lzVXNlckNvbnRyb2xsZWQgPSB0cnVlO1xuXG4gICAgaWYgKHRoaXMuYmVoYXZpb3IuaGFuZGxlc0NyZWF0ZWQpIHtcbiAgICAgIHRoaXMudmlld01vZGVsLmNyZWF0ZWQob3duaW5nVmlldyB8fCBudWxsLCB0aGlzLnZpZXcpO1xuICAgIH1cblxuICAgIHRoaXMuYmluZCh0aGlzLnZpZXcpO1xuICB9XG5cbiAgYmluZChzY29wZSkge1xuICAgIGxldCBza2lwU2VsZlN1YnNjcmliZXIgPSB0aGlzLmJlaGF2aW9yLmhhbmRsZXNCaW5kO1xuICAgIGxldCBib3VuZFByb3BlcnRpZXMgPSB0aGlzLmJvdW5kUHJvcGVydGllcztcbiAgICBsZXQgaTtcbiAgICBsZXQgaWk7XG4gICAgbGV0IHg7XG4gICAgbGV0IG9ic2VydmVyO1xuICAgIGxldCBzZWxmU3Vic2NyaWJlcjtcblxuICAgIGlmICh0aGlzLmlzQm91bmQpIHtcbiAgICAgIGlmICh0aGlzLnNjb3BlID09PSBzY29wZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMudW5iaW5kKCk7XG4gICAgfVxuXG4gICAgdGhpcy5pc0JvdW5kID0gdHJ1ZTtcbiAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG5cbiAgICBmb3IgKGkgPSAwLCBpaSA9IGJvdW5kUHJvcGVydGllcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICB4ID0gYm91bmRQcm9wZXJ0aWVzW2ldO1xuICAgICAgb2JzZXJ2ZXIgPSB4Lm9ic2VydmVyO1xuICAgICAgc2VsZlN1YnNjcmliZXIgPSBvYnNlcnZlci5zZWxmU3Vic2NyaWJlcjtcbiAgICAgIG9ic2VydmVyLnB1Ymxpc2hpbmcgPSBmYWxzZTtcblxuICAgICAgaWYgKHNraXBTZWxmU3Vic2NyaWJlcikge1xuICAgICAgICBvYnNlcnZlci5zZWxmU3Vic2NyaWJlciA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIHguYmluZGluZy5iaW5kKHNjb3BlKTtcbiAgICAgIG9ic2VydmVyLmNhbGwoKTtcblxuICAgICAgb2JzZXJ2ZXIucHVibGlzaGluZyA9IHRydWU7XG4gICAgICBvYnNlcnZlci5zZWxmU3Vic2NyaWJlciA9IHNlbGZTdWJzY3JpYmVyO1xuICAgIH1cblxuICAgIGxldCBvdmVycmlkZUNvbnRleHQ7XG4gICAgaWYgKHRoaXMudmlldyAhPT0gbnVsbCkge1xuICAgICAgaWYgKHNraXBTZWxmU3Vic2NyaWJlcikge1xuICAgICAgICB0aGlzLnZpZXcudmlld01vZGVsU2NvcGUgPSBzY29wZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMudmlld01vZGVsID09PSBzY29wZS5vdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gc2NvcGUub3ZlcnJpZGVDb250ZXh0O1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmluc3RydWN0aW9uLmluaGVyaXRCaW5kaW5nQ29udGV4dCkge1xuICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVPdmVycmlkZUNvbnRleHQodGhpcy52aWV3TW9kZWwsIHNjb3BlLm92ZXJyaWRlQ29udGV4dCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVPdmVycmlkZUNvbnRleHQodGhpcy52aWV3TW9kZWwpO1xuICAgICAgICBvdmVycmlkZUNvbnRleHQuX19wYXJlbnRPdmVycmlkZUNvbnRleHQgPSBzY29wZS5vdmVycmlkZUNvbnRleHQ7XG4gICAgICB9XG5cbiAgICAgIHRoaXMudmlldy5iaW5kKHRoaXMudmlld01vZGVsLCBvdmVycmlkZUNvbnRleHQpO1xuICAgIH0gZWxzZSBpZiAoc2tpcFNlbGZTdWJzY3JpYmVyKSB7XG4gICAgICBvdmVycmlkZUNvbnRleHQgPSBzY29wZS5vdmVycmlkZUNvbnRleHQ7XG5cbiAgICAgIGlmIChzY29wZS5vdmVycmlkZUNvbnRleHQuX19wYXJlbnRPdmVycmlkZUNvbnRleHQgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnZpZXdNb2RlbC52aWV3RmFjdG9yeSAmJiB0aGlzLnZpZXdNb2RlbC52aWV3RmFjdG9yeS5mYWN0b3J5Q3JlYXRlSW5zdHJ1Y3Rpb24ucGFydFJlcGxhY2VtZW50cykge1xuICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBPYmplY3QuYXNzaWduKHt9LCBzY29wZS5vdmVycmlkZUNvbnRleHQpO1xuICAgICAgICBvdmVycmlkZUNvbnRleHQucGFyZW50T3ZlcnJpZGVDb250ZXh0ID0gc2NvcGUub3ZlcnJpZGVDb250ZXh0Ll9fcGFyZW50T3ZlcnJpZGVDb250ZXh0O1xuICAgICAgfVxuICAgICAgdGhpcy52aWV3TW9kZWwuYmluZChzY29wZS5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcbiAgICB9XG4gIH1cblxuICB1bmJpbmQoKSB7XG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgbGV0IGJvdW5kUHJvcGVydGllcyA9IHRoaXMuYm91bmRQcm9wZXJ0aWVzO1xuICAgICAgbGV0IGk7XG4gICAgICBsZXQgaWk7XG5cbiAgICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgICAgdGhpcy5zY29wZSA9IG51bGw7XG5cbiAgICAgIGlmICh0aGlzLnZpZXcgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy52aWV3LnVuYmluZCgpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5iZWhhdmlvci5oYW5kbGVzVW5iaW5kKSB7XG4gICAgICAgIHRoaXMudmlld01vZGVsLnVuYmluZCgpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5lbGVtZW50RXZlbnRzICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudEV2ZW50cy5kaXNwb3NlQWxsKCk7XG4gICAgICB9XG5cbiAgICAgIGZvciAoaSA9IDAsIGlpID0gYm91bmRQcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgYm91bmRQcm9wZXJ0aWVzW2ldLmJpbmRpbmcudW5iaW5kKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXR0YWNoZWQoKSB7XG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNBdHRhY2hlZCA9IHRydWU7XG5cbiAgICBpZiAodGhpcy5iZWhhdmlvci5oYW5kbGVzQXR0YWNoZWQpIHtcbiAgICAgIHRoaXMudmlld01vZGVsLmF0dGFjaGVkKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlldyAhPT0gbnVsbCkge1xuICAgICAgdGhpcy52aWV3LmF0dGFjaGVkKCk7XG4gICAgfVxuICB9XG5cbiAgZGV0YWNoZWQoKSB7XG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgdGhpcy5pc0F0dGFjaGVkID0gZmFsc2U7XG5cbiAgICAgIGlmICh0aGlzLnZpZXcgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy52aWV3LmRldGFjaGVkKCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmJlaGF2aW9yLmhhbmRsZXNEZXRhY2hlZCkge1xuICAgICAgICB0aGlzLnZpZXdNb2RlbC5kZXRhY2hlZCgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGxldCBCZWhhdmlvclByb3BlcnR5T2JzZXJ2ZXIgPSAoX2RlYzkgPSBzdWJzY3JpYmVyQ29sbGVjdGlvbigpLCBfZGVjOShfY2xhc3MxNyA9IGNsYXNzIEJlaGF2aW9yUHJvcGVydHlPYnNlcnZlciB7XG4gIGNvbnN0cnVjdG9yKHRhc2tRdWV1ZSwgb2JqLCBwcm9wZXJ0eU5hbWUsIHNlbGZTdWJzY3JpYmVyLCBpbml0aWFsVmFsdWUpIHtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IHRhc2tRdWV1ZTtcbiAgICB0aGlzLm9iaiA9IG9iajtcbiAgICB0aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgICB0aGlzLm5vdHF1ZXVlZCA9IHRydWU7XG4gICAgdGhpcy5wdWJsaXNoaW5nID0gZmFsc2U7XG4gICAgdGhpcy5zZWxmU3Vic2NyaWJlciA9IHNlbGZTdWJzY3JpYmVyO1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gdGhpcy5vbGRWYWx1ZSA9IGluaXRpYWxWYWx1ZTtcbiAgfVxuXG4gIGdldFZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYWx1ZTtcbiAgfVxuXG4gIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgbGV0IG9sZFZhbHVlID0gdGhpcy5jdXJyZW50VmFsdWU7XG5cbiAgICBpZiAoIU9iamVjdC5pcyhuZXdWYWx1ZSwgb2xkVmFsdWUpKSB7XG4gICAgICB0aGlzLm9sZFZhbHVlID0gb2xkVmFsdWU7XG4gICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IG5ld1ZhbHVlO1xuXG4gICAgICBpZiAodGhpcy5wdWJsaXNoaW5nICYmIHRoaXMubm90cXVldWVkKSB7XG4gICAgICAgIGlmICh0aGlzLnRhc2tRdWV1ZS5mbHVzaGluZykge1xuICAgICAgICAgIHRoaXMuY2FsbCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubm90cXVldWVkID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2sodGhpcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBjYWxsKCkge1xuICAgIGxldCBvbGRWYWx1ZSA9IHRoaXMub2xkVmFsdWU7XG4gICAgbGV0IG5ld1ZhbHVlID0gdGhpcy5jdXJyZW50VmFsdWU7XG5cbiAgICB0aGlzLm5vdHF1ZXVlZCA9IHRydWU7XG5cbiAgICBpZiAoT2JqZWN0LmlzKG5ld1ZhbHVlLCBvbGRWYWx1ZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zZWxmU3Vic2NyaWJlcikge1xuICAgICAgdGhpcy5zZWxmU3Vic2NyaWJlcihuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgIH1cblxuICAgIHRoaXMuY2FsbFN1YnNjcmliZXJzKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgdGhpcy5vbGRWYWx1ZSA9IG5ld1ZhbHVlO1xuICB9XG5cbiAgc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgdGhpcy5hZGRTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKTtcbiAgfVxuXG4gIHVuc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgdGhpcy5yZW1vdmVTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKTtcbiAgfVxufSkgfHwgX2NsYXNzMTcpO1xuXG5mdW5jdGlvbiBnZXRPYnNlcnZlcihpbnN0YW5jZSwgbmFtZSkge1xuICBsZXQgbG9va3VwID0gaW5zdGFuY2UuX19vYnNlcnZlcnNfXztcblxuICBpZiAobG9va3VwID09PSB1bmRlZmluZWQpIHtcbiAgICBsZXQgY3RvciA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihpbnN0YW5jZSkuY29uc3RydWN0b3I7XG4gICAgbGV0IGJlaGF2aW9yID0gbWV0YWRhdGEuZ2V0KG1ldGFkYXRhLnJlc291cmNlLCBjdG9yKTtcbiAgICBpZiAoIWJlaGF2aW9yLmlzSW5pdGlhbGl6ZWQpIHtcbiAgICAgIGJlaGF2aW9yLmluaXRpYWxpemUoQ29udGFpbmVyLmluc3RhbmNlIHx8IG5ldyBDb250YWluZXIoKSwgaW5zdGFuY2UuY29uc3RydWN0b3IpO1xuICAgIH1cblxuICAgIGxvb2t1cCA9IGJlaGF2aW9yLm9ic2VydmVyTG9jYXRvci5nZXRPckNyZWF0ZU9ic2VydmVyc0xvb2t1cChpbnN0YW5jZSk7XG4gICAgYmVoYXZpb3IuX2Vuc3VyZVByb3BlcnRpZXNEZWZpbmVkKGluc3RhbmNlLCBsb29rdXApO1xuICB9XG5cbiAgcmV0dXJuIGxvb2t1cFtuYW1lXTtcbn1cblxuZXhwb3J0IGxldCBCaW5kYWJsZVByb3BlcnR5ID0gY2xhc3MgQmluZGFibGVQcm9wZXJ0eSB7XG4gIGNvbnN0cnVjdG9yKG5hbWVPckNvbmZpZykge1xuICAgIGlmICh0eXBlb2YgbmFtZU9yQ29uZmlnID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5uYW1lID0gbmFtZU9yQ29uZmlnO1xuICAgIH0gZWxzZSB7XG4gICAgICBPYmplY3QuYXNzaWduKHRoaXMsIG5hbWVPckNvbmZpZyk7XG4gICAgfVxuXG4gICAgdGhpcy5hdHRyaWJ1dGUgPSB0aGlzLmF0dHJpYnV0ZSB8fCBfaHlwaGVuYXRlKHRoaXMubmFtZSk7XG4gICAgbGV0IGRlZmF1bHRCaW5kaW5nTW9kZSA9IHRoaXMuZGVmYXVsdEJpbmRpbmdNb2RlO1xuICAgIGlmIChkZWZhdWx0QmluZGluZ01vZGUgPT09IG51bGwgfHwgZGVmYXVsdEJpbmRpbmdNb2RlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuZGVmYXVsdEJpbmRpbmdNb2RlID0gYmluZGluZ01vZGUub25lV2F5O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGRlZmF1bHRCaW5kaW5nTW9kZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMuZGVmYXVsdEJpbmRpbmdNb2RlID0gYmluZGluZ01vZGVbZGVmYXVsdEJpbmRpbmdNb2RlXSB8fCBiaW5kaW5nTW9kZS5vbmVXYXk7XG4gICAgfVxuICAgIHRoaXMuY2hhbmdlSGFuZGxlciA9IHRoaXMuY2hhbmdlSGFuZGxlciB8fCBudWxsO1xuICAgIHRoaXMub3duZXIgPSBudWxsO1xuICAgIHRoaXMuZGVzY3JpcHRvciA9IG51bGw7XG4gIH1cblxuICByZWdpc3RlcldpdGgodGFyZ2V0LCBiZWhhdmlvciwgZGVzY3JpcHRvcikge1xuICAgIGJlaGF2aW9yLnByb3BlcnRpZXMucHVzaCh0aGlzKTtcbiAgICBiZWhhdmlvci5hdHRyaWJ1dGVzW3RoaXMuYXR0cmlidXRlXSA9IHRoaXM7XG4gICAgdGhpcy5vd25lciA9IGJlaGF2aW9yO1xuXG4gICAgaWYgKGRlc2NyaXB0b3IpIHtcbiAgICAgIHRoaXMuZGVzY3JpcHRvciA9IGRlc2NyaXB0b3I7XG4gICAgICByZXR1cm4gdGhpcy5fY29uZmlndXJlRGVzY3JpcHRvcihkZXNjcmlwdG9yKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgX2NvbmZpZ3VyZURlc2NyaXB0b3IoZGVzY3JpcHRvcikge1xuICAgIGxldCBuYW1lID0gdGhpcy5uYW1lO1xuXG4gICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IHRydWU7XG5cbiAgICBpZiAoJ2luaXRpYWxpemVyJyBpbiBkZXNjcmlwdG9yKSB7XG4gICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IGRlc2NyaXB0b3IuaW5pdGlhbGl6ZXI7XG4gICAgICBkZWxldGUgZGVzY3JpcHRvci5pbml0aWFsaXplcjtcbiAgICAgIGRlbGV0ZSBkZXNjcmlwdG9yLndyaXRhYmxlO1xuICAgIH1cblxuICAgIGlmICgndmFsdWUnIGluIGRlc2NyaXB0b3IpIHtcbiAgICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgIGRlbGV0ZSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgICAgZGVsZXRlIGRlc2NyaXB0b3Iud3JpdGFibGU7XG4gICAgfVxuXG4gICAgZGVzY3JpcHRvci5nZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZ2V0T2JzZXJ2ZXIodGhpcywgbmFtZSkuZ2V0VmFsdWUoKTtcbiAgICB9O1xuXG4gICAgZGVzY3JpcHRvci5zZXQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIGdldE9ic2VydmVyKHRoaXMsIG5hbWUpLnNldFZhbHVlKHZhbHVlKTtcbiAgICB9O1xuXG4gICAgZGVzY3JpcHRvci5nZXQuZ2V0T2JzZXJ2ZXIgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICByZXR1cm4gZ2V0T2JzZXJ2ZXIob2JqLCBuYW1lKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gIH1cblxuICBkZWZpbmVPbih0YXJnZXQsIGJlaGF2aW9yKSB7XG4gICAgbGV0IG5hbWUgPSB0aGlzLm5hbWU7XG4gICAgbGV0IGhhbmRsZXJOYW1lO1xuXG4gICAgaWYgKHRoaXMuY2hhbmdlSGFuZGxlciA9PT0gbnVsbCkge1xuICAgICAgaGFuZGxlck5hbWUgPSBuYW1lICsgJ0NoYW5nZWQnO1xuICAgICAgaWYgKGhhbmRsZXJOYW1lIGluIHRhcmdldC5wcm90b3R5cGUpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VIYW5kbGVyID0gaGFuZGxlck5hbWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGVzY3JpcHRvciA9PT0gbnVsbCkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldC5wcm90b3R5cGUsIG5hbWUsIHRoaXMuX2NvbmZpZ3VyZURlc2NyaXB0b3IoYmVoYXZpb3IsIHt9KSk7XG4gICAgfVxuICB9XG5cbiAgY3JlYXRlT2JzZXJ2ZXIodmlld01vZGVsKSB7XG4gICAgbGV0IHNlbGZTdWJzY3JpYmVyID0gbnVsbDtcbiAgICBsZXQgZGVmYXVsdFZhbHVlID0gdGhpcy5kZWZhdWx0VmFsdWU7XG4gICAgbGV0IGNoYW5nZUhhbmRsZXJOYW1lID0gdGhpcy5jaGFuZ2VIYW5kbGVyO1xuICAgIGxldCBuYW1lID0gdGhpcy5uYW1lO1xuICAgIGxldCBpbml0aWFsVmFsdWU7XG5cbiAgICBpZiAodGhpcy5oYXNPcHRpb25zKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VIYW5kbGVyTmFtZSBpbiB2aWV3TW9kZWwpIHtcbiAgICAgIGlmICgncHJvcGVydHlDaGFuZ2VkJyBpbiB2aWV3TW9kZWwpIHtcbiAgICAgICAgc2VsZlN1YnNjcmliZXIgPSAobmV3VmFsdWUsIG9sZFZhbHVlKSA9PiB7XG4gICAgICAgICAgdmlld01vZGVsW2NoYW5nZUhhbmRsZXJOYW1lXShuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICAgIHZpZXdNb2RlbC5wcm9wZXJ0eUNoYW5nZWQobmFtZSwgbmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbGZTdWJzY3JpYmVyID0gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgPT4gdmlld01vZGVsW2NoYW5nZUhhbmRsZXJOYW1lXShuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoJ3Byb3BlcnR5Q2hhbmdlZCcgaW4gdmlld01vZGVsKSB7XG4gICAgICBzZWxmU3Vic2NyaWJlciA9IChuZXdWYWx1ZSwgb2xkVmFsdWUpID0+IHZpZXdNb2RlbC5wcm9wZXJ0eUNoYW5nZWQobmFtZSwgbmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKGNoYW5nZUhhbmRsZXJOYW1lICE9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENoYW5nZSBoYW5kbGVyICR7Y2hhbmdlSGFuZGxlck5hbWV9IHdhcyBzcGVjaWZpZWQgYnV0IG5vdCBkZWNsYXJlZCBvbiB0aGUgY2xhc3MuYCk7XG4gICAgfVxuXG4gICAgaWYgKGRlZmF1bHRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpbml0aWFsVmFsdWUgPSB0eXBlb2YgZGVmYXVsdFZhbHVlID09PSAnZnVuY3Rpb24nID8gZGVmYXVsdFZhbHVlLmNhbGwodmlld01vZGVsKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEJlaGF2aW9yUHJvcGVydHlPYnNlcnZlcih0aGlzLm93bmVyLnRhc2tRdWV1ZSwgdmlld01vZGVsLCB0aGlzLm5hbWUsIHNlbGZTdWJzY3JpYmVyLCBpbml0aWFsVmFsdWUpO1xuICB9XG5cbiAgX2luaXRpYWxpemUodmlld01vZGVsLCBvYnNlcnZlckxvb2t1cCwgYXR0cmlidXRlcywgYmVoYXZpb3JIYW5kbGVzQmluZCwgYm91bmRQcm9wZXJ0aWVzKSB7XG4gICAgbGV0IHNlbGZTdWJzY3JpYmVyO1xuICAgIGxldCBvYnNlcnZlcjtcbiAgICBsZXQgYXR0cmlidXRlO1xuICAgIGxldCBkZWZhdWx0VmFsdWUgPSB0aGlzLmRlZmF1bHRWYWx1ZTtcblxuICAgIGlmICh0aGlzLmlzRHluYW1pYykge1xuICAgICAgZm9yIChsZXQga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgdGhpcy5fY3JlYXRlRHluYW1pY1Byb3BlcnR5KHZpZXdNb2RlbCwgb2JzZXJ2ZXJMb29rdXAsIGJlaGF2aW9ySGFuZGxlc0JpbmQsIGtleSwgYXR0cmlidXRlc1trZXldLCBib3VuZFByb3BlcnRpZXMpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoIXRoaXMuaGFzT3B0aW9ucykge1xuICAgICAgb2JzZXJ2ZXIgPSBvYnNlcnZlckxvb2t1cFt0aGlzLm5hbWVdO1xuXG4gICAgICBpZiAoYXR0cmlidXRlcyAhPT0gbnVsbCkge1xuICAgICAgICBzZWxmU3Vic2NyaWJlciA9IG9ic2VydmVyLnNlbGZTdWJzY3JpYmVyO1xuICAgICAgICBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzW3RoaXMuYXR0cmlidXRlXTtcblxuICAgICAgICBpZiAoYmVoYXZpb3JIYW5kbGVzQmluZCkge1xuICAgICAgICAgIG9ic2VydmVyLnNlbGZTdWJzY3JpYmVyID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgYXR0cmlidXRlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHZpZXdNb2RlbFt0aGlzLm5hbWVdID0gYXR0cmlidXRlO1xuICAgICAgICAgIG9ic2VydmVyLmNhbGwoKTtcbiAgICAgICAgfSBlbHNlIGlmIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICBib3VuZFByb3BlcnRpZXMucHVzaCh7IG9ic2VydmVyOiBvYnNlcnZlciwgYmluZGluZzogYXR0cmlidXRlLmNyZWF0ZUJpbmRpbmcodmlld01vZGVsKSB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChkZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIG9ic2VydmVyLmNhbGwoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9ic2VydmVyLnNlbGZTdWJzY3JpYmVyID0gc2VsZlN1YnNjcmliZXI7XG4gICAgICB9XG5cbiAgICAgIG9ic2VydmVyLnB1Ymxpc2hpbmcgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIF9jcmVhdGVEeW5hbWljUHJvcGVydHkodmlld01vZGVsLCBvYnNlcnZlckxvb2t1cCwgYmVoYXZpb3JIYW5kbGVzQmluZCwgbmFtZSwgYXR0cmlidXRlLCBib3VuZFByb3BlcnRpZXMpIHtcbiAgICBsZXQgY2hhbmdlSGFuZGxlck5hbWUgPSBuYW1lICsgJ0NoYW5nZWQnO1xuICAgIGxldCBzZWxmU3Vic2NyaWJlciA9IG51bGw7XG4gICAgbGV0IG9ic2VydmVyO1xuICAgIGxldCBpbmZvO1xuXG4gICAgaWYgKGNoYW5nZUhhbmRsZXJOYW1lIGluIHZpZXdNb2RlbCkge1xuICAgICAgaWYgKCdwcm9wZXJ0eUNoYW5nZWQnIGluIHZpZXdNb2RlbCkge1xuICAgICAgICBzZWxmU3Vic2NyaWJlciA9IChuZXdWYWx1ZSwgb2xkVmFsdWUpID0+IHtcbiAgICAgICAgICB2aWV3TW9kZWxbY2hhbmdlSGFuZGxlck5hbWVdKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICAgICAgdmlld01vZGVsLnByb3BlcnR5Q2hhbmdlZChuYW1lLCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VsZlN1YnNjcmliZXIgPSAobmV3VmFsdWUsIG9sZFZhbHVlKSA9PiB2aWV3TW9kZWxbY2hhbmdlSGFuZGxlck5hbWVdKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICgncHJvcGVydHlDaGFuZ2VkJyBpbiB2aWV3TW9kZWwpIHtcbiAgICAgIHNlbGZTdWJzY3JpYmVyID0gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgPT4gdmlld01vZGVsLnByb3BlcnR5Q2hhbmdlZChuYW1lLCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgIH1cblxuICAgIG9ic2VydmVyID0gb2JzZXJ2ZXJMb29rdXBbbmFtZV0gPSBuZXcgQmVoYXZpb3JQcm9wZXJ0eU9ic2VydmVyKHRoaXMub3duZXIudGFza1F1ZXVlLCB2aWV3TW9kZWwsIG5hbWUsIHNlbGZTdWJzY3JpYmVyKTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh2aWV3TW9kZWwsIG5hbWUsIHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBnZXQ6IG9ic2VydmVyLmdldFZhbHVlLmJpbmQob2JzZXJ2ZXIpLFxuICAgICAgc2V0OiBvYnNlcnZlci5zZXRWYWx1ZS5iaW5kKG9ic2VydmVyKVxuICAgIH0pO1xuXG4gICAgaWYgKGJlaGF2aW9ySGFuZGxlc0JpbmQpIHtcbiAgICAgIG9ic2VydmVyLnNlbGZTdWJzY3JpYmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGF0dHJpYnV0ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHZpZXdNb2RlbFtuYW1lXSA9IGF0dHJpYnV0ZTtcbiAgICAgIG9ic2VydmVyLmNhbGwoKTtcbiAgICB9IGVsc2UgaWYgKGF0dHJpYnV0ZSkge1xuICAgICAgaW5mbyA9IHsgb2JzZXJ2ZXI6IG9ic2VydmVyLCBiaW5kaW5nOiBhdHRyaWJ1dGUuY3JlYXRlQmluZGluZyh2aWV3TW9kZWwpIH07XG4gICAgICBib3VuZFByb3BlcnRpZXMucHVzaChpbmZvKTtcbiAgICB9XG5cbiAgICBvYnNlcnZlci5wdWJsaXNoaW5nID0gdHJ1ZTtcbiAgICBvYnNlcnZlci5zZWxmU3Vic2NyaWJlciA9IHNlbGZTdWJzY3JpYmVyO1xuICB9XG59O1xuXG5sZXQgbGFzdFByb3ZpZGVySWQgPSAwO1xuXG5mdW5jdGlvbiBuZXh0UHJvdmlkZXJJZCgpIHtcbiAgcmV0dXJuICsrbGFzdFByb3ZpZGVySWQ7XG59XG5cbmZ1bmN0aW9uIGRvUHJvY2Vzc0NvbnRlbnQoKSB7XG4gIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gZG9Qcm9jZXNzQXR0cmlidXRlcygpIHt9XG5cbmV4cG9ydCBsZXQgSHRtbEJlaGF2aW9yUmVzb3VyY2UgPSBjbGFzcyBIdG1sQmVoYXZpb3JSZXNvdXJjZSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZWxlbWVudE5hbWUgPSBudWxsO1xuICAgIHRoaXMuYXR0cmlidXRlTmFtZSA9IG51bGw7XG4gICAgdGhpcy5hdHRyaWJ1dGVEZWZhdWx0QmluZGluZ01vZGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5saWZ0c0NvbnRlbnQgPSBmYWxzZTtcbiAgICB0aGlzLnRhcmdldFNoYWRvd0RPTSA9IGZhbHNlO1xuICAgIHRoaXMuc2hhZG93RE9NT3B0aW9ucyA9IG51bGw7XG4gICAgdGhpcy5wcm9jZXNzQXR0cmlidXRlcyA9IGRvUHJvY2Vzc0F0dHJpYnV0ZXM7XG4gICAgdGhpcy5wcm9jZXNzQ29udGVudCA9IGRvUHJvY2Vzc0NvbnRlbnQ7XG4gICAgdGhpcy51c2VzU2hhZG93RE9NID0gZmFsc2U7XG4gICAgdGhpcy5jaGlsZEJpbmRpbmdzID0gbnVsbDtcbiAgICB0aGlzLmhhc0R5bmFtaWNPcHRpb25zID0gZmFsc2U7XG4gICAgdGhpcy5jb250YWluZXJsZXNzID0gZmFsc2U7XG4gICAgdGhpcy5wcm9wZXJ0aWVzID0gW107XG4gICAgdGhpcy5hdHRyaWJ1dGVzID0ge307XG4gICAgdGhpcy5pc0luaXRpYWxpemVkID0gZmFsc2U7XG4gICAgdGhpcy5wcmltYXJ5UHJvcGVydHkgPSBudWxsO1xuICB9XG5cbiAgc3RhdGljIGNvbnZlbnRpb24obmFtZSwgZXhpc3RpbmcpIHtcbiAgICBsZXQgYmVoYXZpb3I7XG5cbiAgICBpZiAobmFtZS5lbmRzV2l0aCgnQ3VzdG9tQXR0cmlidXRlJykpIHtcbiAgICAgIGJlaGF2aW9yID0gZXhpc3RpbmcgfHwgbmV3IEh0bWxCZWhhdmlvclJlc291cmNlKCk7XG4gICAgICBiZWhhdmlvci5hdHRyaWJ1dGVOYW1lID0gX2h5cGhlbmF0ZShuYW1lLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCAtIDE1KSk7XG4gICAgfVxuXG4gICAgaWYgKG5hbWUuZW5kc1dpdGgoJ0N1c3RvbUVsZW1lbnQnKSkge1xuICAgICAgYmVoYXZpb3IgPSBleGlzdGluZyB8fCBuZXcgSHRtbEJlaGF2aW9yUmVzb3VyY2UoKTtcbiAgICAgIGJlaGF2aW9yLmVsZW1lbnROYW1lID0gX2h5cGhlbmF0ZShuYW1lLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCAtIDEzKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJlaGF2aW9yO1xuICB9XG5cbiAgYWRkQ2hpbGRCaW5kaW5nKGJlaGF2aW9yKSB7XG4gICAgaWYgKHRoaXMuY2hpbGRCaW5kaW5ncyA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5jaGlsZEJpbmRpbmdzID0gW107XG4gICAgfVxuXG4gICAgdGhpcy5jaGlsZEJpbmRpbmdzLnB1c2goYmVoYXZpb3IpO1xuICB9XG5cbiAgaW5pdGlhbGl6ZShjb250YWluZXIsIHRhcmdldCkge1xuICAgIGxldCBwcm90byA9IHRhcmdldC5wcm90b3R5cGU7XG4gICAgbGV0IHByb3BlcnRpZXMgPSB0aGlzLnByb3BlcnRpZXM7XG4gICAgbGV0IGF0dHJpYnV0ZU5hbWUgPSB0aGlzLmF0dHJpYnV0ZU5hbWU7XG4gICAgbGV0IGF0dHJpYnV0ZURlZmF1bHRCaW5kaW5nTW9kZSA9IHRoaXMuYXR0cmlidXRlRGVmYXVsdEJpbmRpbmdNb2RlO1xuICAgIGxldCBpO1xuICAgIGxldCBpaTtcbiAgICBsZXQgY3VycmVudDtcblxuICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIHRhcmdldC5fX3Byb3ZpZGVySWRfXyA9IG5leHRQcm92aWRlcklkKCk7XG5cbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IGNvbnRhaW5lci5nZXQoT2JzZXJ2ZXJMb2NhdG9yKTtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IGNvbnRhaW5lci5nZXQoVGFza1F1ZXVlKTtcblxuICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgIHRoaXMudXNlc1NoYWRvd0RPTSA9IHRoaXMudGFyZ2V0U2hhZG93RE9NICYmIEZFQVRVUkUuc2hhZG93RE9NO1xuICAgIHRoaXMuaGFuZGxlc0NyZWF0ZWQgPSAnY3JlYXRlZCcgaW4gcHJvdG87XG4gICAgdGhpcy5oYW5kbGVzQmluZCA9ICdiaW5kJyBpbiBwcm90bztcbiAgICB0aGlzLmhhbmRsZXNVbmJpbmQgPSAndW5iaW5kJyBpbiBwcm90bztcbiAgICB0aGlzLmhhbmRsZXNBdHRhY2hlZCA9ICdhdHRhY2hlZCcgaW4gcHJvdG87XG4gICAgdGhpcy5oYW5kbGVzRGV0YWNoZWQgPSAnZGV0YWNoZWQnIGluIHByb3RvO1xuICAgIHRoaXMuaHRtbE5hbWUgPSB0aGlzLmVsZW1lbnROYW1lIHx8IHRoaXMuYXR0cmlidXRlTmFtZTtcblxuICAgIGlmIChhdHRyaWJ1dGVOYW1lICE9PSBudWxsKSB7XG4gICAgICBpZiAocHJvcGVydGllcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgbmV3IEJpbmRhYmxlUHJvcGVydHkoe1xuICAgICAgICAgIG5hbWU6ICd2YWx1ZScsXG4gICAgICAgICAgY2hhbmdlSGFuZGxlcjogJ3ZhbHVlQ2hhbmdlZCcgaW4gcHJvdG8gPyAndmFsdWVDaGFuZ2VkJyA6IG51bGwsXG4gICAgICAgICAgYXR0cmlidXRlOiBhdHRyaWJ1dGVOYW1lLFxuICAgICAgICAgIGRlZmF1bHRCaW5kaW5nTW9kZTogYXR0cmlidXRlRGVmYXVsdEJpbmRpbmdNb2RlXG4gICAgICAgIH0pLnJlZ2lzdGVyV2l0aCh0YXJnZXQsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICBjdXJyZW50ID0gcHJvcGVydGllc1swXTtcblxuICAgICAgaWYgKHByb3BlcnRpZXMubGVuZ3RoID09PSAxICYmIGN1cnJlbnQubmFtZSA9PT0gJ3ZhbHVlJykge1xuICAgICAgICBjdXJyZW50LmlzRHluYW1pYyA9IGN1cnJlbnQuaGFzT3B0aW9ucyA9IHRoaXMuaGFzRHluYW1pY09wdGlvbnM7XG4gICAgICAgIGN1cnJlbnQuZGVmaW5lT24odGFyZ2V0LCB0aGlzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gcHJvcGVydGllcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgcHJvcGVydGllc1tpXS5kZWZpbmVPbih0YXJnZXQsIHRoaXMpO1xuICAgICAgICAgIGlmIChwcm9wZXJ0aWVzW2ldLnByaW1hcnlQcm9wZXJ0eSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpbWFyeVByb3BlcnR5KSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT25seSBvbmUgYmluZGFibGUgcHJvcGVydHkgb24gYSBjdXN0b20gZWxlbWVudCBjYW4gYmUgZGVmaW5lZCBhcyB0aGUgZGVmYXVsdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcmltYXJ5UHJvcGVydHkgPSBwcm9wZXJ0aWVzW2ldO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGN1cnJlbnQgPSBuZXcgQmluZGFibGVQcm9wZXJ0eSh7XG4gICAgICAgICAgbmFtZTogJ3ZhbHVlJyxcbiAgICAgICAgICBjaGFuZ2VIYW5kbGVyOiAndmFsdWVDaGFuZ2VkJyBpbiBwcm90byA/ICd2YWx1ZUNoYW5nZWQnIDogbnVsbCxcbiAgICAgICAgICBhdHRyaWJ1dGU6IGF0dHJpYnV0ZU5hbWUsXG4gICAgICAgICAgZGVmYXVsdEJpbmRpbmdNb2RlOiBhdHRyaWJ1dGVEZWZhdWx0QmluZGluZ01vZGVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY3VycmVudC5oYXNPcHRpb25zID0gdHJ1ZTtcbiAgICAgICAgY3VycmVudC5yZWdpc3RlcldpdGgodGFyZ2V0LCB0aGlzKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChpID0gMCwgaWkgPSBwcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgcHJvcGVydGllc1tpXS5kZWZpbmVPbih0YXJnZXQsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9jb3B5SW5oZXJpdGVkUHJvcGVydGllcyhjb250YWluZXIsIHRhcmdldCk7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXIocmVnaXN0cnksIG5hbWUpIHtcbiAgICBpZiAodGhpcy5hdHRyaWJ1dGVOYW1lICE9PSBudWxsKSB7XG4gICAgICByZWdpc3RyeS5yZWdpc3RlckF0dHJpYnV0ZShuYW1lIHx8IHRoaXMuYXR0cmlidXRlTmFtZSwgdGhpcywgdGhpcy5hdHRyaWJ1dGVOYW1lKTtcblxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5hbGlhc2VzKSkge1xuICAgICAgICB0aGlzLmFsaWFzZXMuZm9yRWFjaChhbGlhcyA9PiB7XG4gICAgICAgICAgcmVnaXN0cnkucmVnaXN0ZXJBdHRyaWJ1dGUoYWxpYXMsIHRoaXMsIHRoaXMuYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmVsZW1lbnROYW1lICE9PSBudWxsKSB7XG4gICAgICByZWdpc3RyeS5yZWdpc3RlckVsZW1lbnQobmFtZSB8fCB0aGlzLmVsZW1lbnROYW1lLCB0aGlzKTtcbiAgICB9XG4gIH1cblxuICBsb2FkKGNvbnRhaW5lciwgdGFyZ2V0LCBsb2FkQ29udGV4dCwgdmlld1N0cmF0ZWd5LCB0cmFuc2llbnRWaWV3KSB7XG4gICAgbGV0IG9wdGlvbnM7XG5cbiAgICBpZiAodGhpcy5lbGVtZW50TmFtZSAhPT0gbnVsbCkge1xuICAgICAgdmlld1N0cmF0ZWd5ID0gY29udGFpbmVyLmdldChWaWV3TG9jYXRvcikuZ2V0Vmlld1N0cmF0ZWd5KHZpZXdTdHJhdGVneSB8fCB0aGlzLnZpZXdTdHJhdGVneSB8fCB0YXJnZXQpO1xuICAgICAgb3B0aW9ucyA9IG5ldyBWaWV3Q29tcGlsZUluc3RydWN0aW9uKHRoaXMudGFyZ2V0U2hhZG93RE9NLCB0cnVlKTtcblxuICAgICAgaWYgKCF2aWV3U3RyYXRlZ3kubW9kdWxlSWQpIHtcbiAgICAgICAgdmlld1N0cmF0ZWd5Lm1vZHVsZUlkID0gT3JpZ2luLmdldCh0YXJnZXQpLm1vZHVsZUlkO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdmlld1N0cmF0ZWd5LmxvYWRWaWV3RmFjdG9yeShjb250YWluZXIuZ2V0KFZpZXdFbmdpbmUpLCBvcHRpb25zLCBsb2FkQ29udGV4dCwgdGFyZ2V0KS50aGVuKHZpZXdGYWN0b3J5ID0+IHtcbiAgICAgICAgaWYgKCF0cmFuc2llbnRWaWV3IHx8ICF0aGlzLnZpZXdGYWN0b3J5KSB7XG4gICAgICAgICAgdGhpcy52aWV3RmFjdG9yeSA9IHZpZXdGYWN0b3J5O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHZpZXdGYWN0b3J5O1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzKTtcbiAgfVxuXG4gIGNvbXBpbGUoY29tcGlsZXIsIHJlc291cmNlcywgbm9kZSwgaW5zdHJ1Y3Rpb24sIHBhcmVudE5vZGUpIHtcbiAgICBpZiAodGhpcy5saWZ0c0NvbnRlbnQpIHtcbiAgICAgIGlmICghaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkpIHtcbiAgICAgICAgbGV0IHRlbXBsYXRlID0gRE9NLmNyZWF0ZUVsZW1lbnQoJ3RlbXBsYXRlJyk7XG4gICAgICAgIGxldCBmcmFnbWVudCA9IERPTS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIGxldCBjYWNoZVNpemUgPSBub2RlLmdldEF0dHJpYnV0ZSgndmlldy1jYWNoZScpO1xuICAgICAgICBsZXQgcGFydCA9IG5vZGUuZ2V0QXR0cmlidXRlKCdwYXJ0Jyk7XG5cbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoaW5zdHJ1Y3Rpb24ub3JpZ2luYWxBdHRyTmFtZSk7XG4gICAgICAgIERPTS5yZXBsYWNlTm9kZSh0ZW1wbGF0ZSwgbm9kZSwgcGFyZW50Tm9kZSk7XG4gICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgICBpbnN0cnVjdGlvbi52aWV3RmFjdG9yeSA9IGNvbXBpbGVyLmNvbXBpbGUoZnJhZ21lbnQsIHJlc291cmNlcyk7XG5cbiAgICAgICAgaWYgKHBhcnQpIHtcbiAgICAgICAgICBpbnN0cnVjdGlvbi52aWV3RmFjdG9yeS5wYXJ0ID0gcGFydDtcbiAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSgncGFydCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNhY2hlU2l6ZSkge1xuICAgICAgICAgIGluc3RydWN0aW9uLnZpZXdGYWN0b3J5LnNldENhY2hlU2l6ZShjYWNoZVNpemUpO1xuICAgICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKCd2aWV3LWNhY2hlJyk7XG4gICAgICAgIH1cblxuICAgICAgICBub2RlID0gdGVtcGxhdGU7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0aGlzLmVsZW1lbnROYW1lICE9PSBudWxsKSB7XG4gICAgICBsZXQgcGFydFJlcGxhY2VtZW50cyA9IHt9O1xuXG4gICAgICBpZiAodGhpcy5wcm9jZXNzQ29udGVudChjb21waWxlciwgcmVzb3VyY2VzLCBub2RlLCBpbnN0cnVjdGlvbikgJiYgbm9kZS5oYXNDaGlsZE5vZGVzKCkpIHtcbiAgICAgICAgbGV0IGN1cnJlbnRDaGlsZCA9IG5vZGUuZmlyc3RDaGlsZDtcbiAgICAgICAgbGV0IGNvbnRlbnRFbGVtZW50ID0gdGhpcy51c2VzU2hhZG93RE9NID8gbnVsbCA6IERPTS5jcmVhdGVFbGVtZW50KCdhdS1jb250ZW50Jyk7XG4gICAgICAgIGxldCBuZXh0U2libGluZztcbiAgICAgICAgbGV0IHRvUmVwbGFjZTtcblxuICAgICAgICB3aGlsZSAoY3VycmVudENoaWxkKSB7XG4gICAgICAgICAgbmV4dFNpYmxpbmcgPSBjdXJyZW50Q2hpbGQubmV4dFNpYmxpbmc7XG5cbiAgICAgICAgICBpZiAoY3VycmVudENoaWxkLnRhZ05hbWUgPT09ICdURU1QTEFURScgJiYgKHRvUmVwbGFjZSA9IGN1cnJlbnRDaGlsZC5nZXRBdHRyaWJ1dGUoJ3JlcGxhY2UtcGFydCcpKSkge1xuICAgICAgICAgICAgcGFydFJlcGxhY2VtZW50c1t0b1JlcGxhY2VdID0gY29tcGlsZXIuY29tcGlsZShjdXJyZW50Q2hpbGQsIHJlc291cmNlcyk7XG4gICAgICAgICAgICBET00ucmVtb3ZlTm9kZShjdXJyZW50Q2hpbGQsIHBhcmVudE5vZGUpO1xuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24ucGFydFJlcGxhY2VtZW50cyA9IHBhcnRSZXBsYWNlbWVudHM7XG4gICAgICAgICAgfSBlbHNlIGlmIChjb250ZW50RWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRDaGlsZC5ub2RlVHlwZSA9PT0gMyAmJiBfaXNBbGxXaGl0ZXNwYWNlKGN1cnJlbnRDaGlsZCkpIHtcbiAgICAgICAgICAgICAgRE9NLnJlbW92ZU5vZGUoY3VycmVudENoaWxkLCBwYXJlbnROb2RlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50LmFwcGVuZENoaWxkKGN1cnJlbnRDaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY3VycmVudENoaWxkID0gbmV4dFNpYmxpbmc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udGVudEVsZW1lbnQgIT09IG51bGwgJiYgY29udGVudEVsZW1lbnQuaGFzQ2hpbGROb2RlcygpKSB7XG4gICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChjb250ZW50RWxlbWVudCk7XG4gICAgICAgIH1cblxuICAgICAgICBpbnN0cnVjdGlvbi5za2lwQ29udGVudFByb2Nlc3NpbmcgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGluc3RydWN0aW9uLnNraXBDb250ZW50UHJvY2Vzc2luZyA9IHRydWU7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICghdGhpcy5wcm9jZXNzQ29udGVudChjb21waWxlciwgcmVzb3VyY2VzLCBub2RlLCBpbnN0cnVjdGlvbikpIHtcbiAgICAgIGluc3RydWN0aW9uLnNraXBDb250ZW50UHJvY2Vzc2luZyA9IHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICBjcmVhdGUoY29udGFpbmVyLCBpbnN0cnVjdGlvbiwgZWxlbWVudCwgYmluZGluZ3MpIHtcbiAgICBsZXQgdmlld0hvc3Q7XG4gICAgbGV0IGF1ID0gbnVsbDtcblxuICAgIGluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5ub3JtYWw7XG4gICAgZWxlbWVudCA9IGVsZW1lbnQgfHwgbnVsbDtcbiAgICBiaW5kaW5ncyA9IGJpbmRpbmdzIHx8IG51bGw7XG5cbiAgICBpZiAodGhpcy5lbGVtZW50TmFtZSAhPT0gbnVsbCAmJiBlbGVtZW50KSB7XG4gICAgICBpZiAodGhpcy51c2VzU2hhZG93RE9NKSB7XG4gICAgICAgIHZpZXdIb3N0ID0gZWxlbWVudC5hdHRhY2hTaGFkb3codGhpcy5zaGFkb3dET01PcHRpb25zKTtcbiAgICAgICAgY29udGFpbmVyLnJlZ2lzdGVySW5zdGFuY2UoRE9NLmJvdW5kYXJ5LCB2aWV3SG9zdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2aWV3SG9zdCA9IGVsZW1lbnQ7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldFNoYWRvd0RPTSkge1xuICAgICAgICAgIGNvbnRhaW5lci5yZWdpc3Rlckluc3RhbmNlKERPTS5ib3VuZGFyeSwgdmlld0hvc3QpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGVsZW1lbnQgIT09IG51bGwpIHtcbiAgICAgIGVsZW1lbnQuYXUgPSBhdSA9IGVsZW1lbnQuYXUgfHwge307XG4gICAgfVxuXG4gICAgbGV0IHZpZXdNb2RlbCA9IGluc3RydWN0aW9uLnZpZXdNb2RlbCB8fCBjb250YWluZXIuZ2V0KHRoaXMudGFyZ2V0KTtcbiAgICBsZXQgY29udHJvbGxlciA9IG5ldyBDb250cm9sbGVyKHRoaXMsIGluc3RydWN0aW9uLCB2aWV3TW9kZWwsIGNvbnRhaW5lcik7XG4gICAgbGV0IGNoaWxkQmluZGluZ3MgPSB0aGlzLmNoaWxkQmluZGluZ3M7XG4gICAgbGV0IHZpZXdGYWN0b3J5O1xuXG4gICAgaWYgKHRoaXMubGlmdHNDb250ZW50KSB7XG4gICAgICBhdS5jb250cm9sbGVyID0gY29udHJvbGxlcjtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZWxlbWVudE5hbWUgIT09IG51bGwpIHtcbiAgICAgIHZpZXdGYWN0b3J5ID0gaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkgfHwgdGhpcy52aWV3RmFjdG9yeTtcbiAgICAgIGNvbnRhaW5lci52aWV3TW9kZWwgPSB2aWV3TW9kZWw7XG5cbiAgICAgIGlmICh2aWV3RmFjdG9yeSkge1xuICAgICAgICBjb250cm9sbGVyLnZpZXcgPSB2aWV3RmFjdG9yeS5jcmVhdGUoY29udGFpbmVyLCBpbnN0cnVjdGlvbiwgZWxlbWVudCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChlbGVtZW50ICE9PSBudWxsKSB7XG4gICAgICAgIGF1LmNvbnRyb2xsZXIgPSBjb250cm9sbGVyO1xuXG4gICAgICAgIGlmIChjb250cm9sbGVyLnZpZXcpIHtcbiAgICAgICAgICBpZiAoIXRoaXMudXNlc1NoYWRvd0RPTSAmJiAoZWxlbWVudC5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMSB8fCBlbGVtZW50LmNvbnRlbnRFbGVtZW50KSkge1xuICAgICAgICAgICAgbGV0IGNvbnRlbnRFbGVtZW50ID0gZWxlbWVudC5jaGlsZE5vZGVzWzBdIHx8IGVsZW1lbnQuY29udGVudEVsZW1lbnQ7XG4gICAgICAgICAgICBjb250cm9sbGVyLnZpZXcuY29udGVudFZpZXcgPSB7IGZyYWdtZW50OiBjb250ZW50RWxlbWVudCB9O1xuICAgICAgICAgICAgY29udGVudEVsZW1lbnQucGFyZW50Tm9kZSAmJiBET00ucmVtb3ZlTm9kZShjb250ZW50RWxlbWVudCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGluc3RydWN0aW9uLmFuY2hvcklzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGRCaW5kaW5ncyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjaGlsZEJpbmRpbmdzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnZpZXcuYWRkQmluZGluZyhjaGlsZEJpbmRpbmdzW2ldLmNyZWF0ZShlbGVtZW50LCB2aWV3TW9kZWwsIGNvbnRyb2xsZXIpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb250cm9sbGVyLnZpZXcuYXBwZW5kTm9kZXNUbyh2aWV3SG9zdCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIudmlldy5pbnNlcnROb2Rlc0JlZm9yZSh2aWV3SG9zdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGNoaWxkQmluZGluZ3MgIT09IG51bGwpIHtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjaGlsZEJpbmRpbmdzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICAgIGJpbmRpbmdzLnB1c2goY2hpbGRCaW5kaW5nc1tpXS5jcmVhdGUoZWxlbWVudCwgdmlld01vZGVsLCBjb250cm9sbGVyKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNvbnRyb2xsZXIudmlldykge1xuICAgICAgICBjb250cm9sbGVyLnZpZXcuY29udHJvbGxlciA9IGNvbnRyb2xsZXI7XG5cbiAgICAgICAgaWYgKGNoaWxkQmluZGluZ3MgIT09IG51bGwpIHtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjaGlsZEJpbmRpbmdzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIudmlldy5hZGRCaW5kaW5nKGNoaWxkQmluZGluZ3NbaV0uY3JlYXRlKGluc3RydWN0aW9uLmhvc3QsIHZpZXdNb2RlbCwgY29udHJvbGxlcikpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjaGlsZEJpbmRpbmdzICE9PSBudWxsKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNoaWxkQmluZGluZ3MubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgIGJpbmRpbmdzLnB1c2goY2hpbGRCaW5kaW5nc1tpXS5jcmVhdGUoaW5zdHJ1Y3Rpb24uaG9zdCwgdmlld01vZGVsLCBjb250cm9sbGVyKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGNoaWxkQmluZGluZ3MgIT09IG51bGwpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGNoaWxkQmluZGluZ3MubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBiaW5kaW5ncy5wdXNoKGNoaWxkQmluZGluZ3NbaV0uY3JlYXRlKGVsZW1lbnQsIHZpZXdNb2RlbCwgY29udHJvbGxlcikpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChhdSAhPT0gbnVsbCkge1xuICAgICAgYXVbdGhpcy5odG1sTmFtZV0gPSBjb250cm9sbGVyO1xuICAgIH1cblxuICAgIGlmIChpbnN0cnVjdGlvbi5pbml0aWF0ZWRCeUJlaGF2aW9yICYmIHZpZXdGYWN0b3J5KSB7XG4gICAgICBjb250cm9sbGVyLnZpZXcuY3JlYXRlZCgpO1xuICAgIH1cblxuICAgIHJldHVybiBjb250cm9sbGVyO1xuICB9XG5cbiAgX2Vuc3VyZVByb3BlcnRpZXNEZWZpbmVkKGluc3RhbmNlLCBsb29rdXApIHtcbiAgICBsZXQgcHJvcGVydGllcztcbiAgICBsZXQgaTtcbiAgICBsZXQgaWk7XG4gICAgbGV0IG9ic2VydmVyO1xuXG4gICAgaWYgKCdfX3Byb3BlcnRpZXNEZWZpbmVkX18nIGluIGxvb2t1cCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxvb2t1cC5fX3Byb3BlcnRpZXNEZWZpbmVkX18gPSB0cnVlO1xuICAgIHByb3BlcnRpZXMgPSB0aGlzLnByb3BlcnRpZXM7XG5cbiAgICBmb3IgKGkgPSAwLCBpaSA9IHByb3BlcnRpZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgb2JzZXJ2ZXIgPSBwcm9wZXJ0aWVzW2ldLmNyZWF0ZU9ic2VydmVyKGluc3RhbmNlKTtcblxuICAgICAgaWYgKG9ic2VydmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbG9va3VwW29ic2VydmVyLnByb3BlcnR5TmFtZV0gPSBvYnNlcnZlcjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfY29weUluaGVyaXRlZFByb3BlcnRpZXMoY29udGFpbmVyLCB0YXJnZXQpIHtcbiAgICBsZXQgYmVoYXZpb3I7XG4gICAgbGV0IGRlcml2ZWQgPSB0YXJnZXQ7XG5cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgbGV0IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRhcmdldC5wcm90b3R5cGUpO1xuICAgICAgdGFyZ2V0ID0gcHJvdG8gJiYgcHJvdG8uY29uc3RydWN0b3I7XG4gICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBiZWhhdmlvciA9IG1ldGFkYXRhLmdldE93bihtZXRhZGF0YS5yZXNvdXJjZSwgdGFyZ2V0KTtcbiAgICAgIGlmIChiZWhhdmlvcikge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgYmVoYXZpb3IuaW5pdGlhbGl6ZShjb250YWluZXIsIHRhcmdldCk7XG4gICAgZm9yIChsZXQgaSA9IDAsIGlpID0gYmVoYXZpb3IucHJvcGVydGllcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBsZXQgcHJvcCA9IGJlaGF2aW9yLnByb3BlcnRpZXNbaV07XG5cbiAgICAgIGlmICh0aGlzLnByb3BlcnRpZXMuc29tZShwID0+IHAubmFtZSA9PT0gcHJvcC5uYW1lKSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgbmV3IEJpbmRhYmxlUHJvcGVydHkocHJvcCkucmVnaXN0ZXJXaXRoKGRlcml2ZWQsIHRoaXMpO1xuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gY3JlYXRlQ2hpbGRPYnNlcnZlckRlY29yYXRvcihzZWxlY3Rvck9yQ29uZmlnLCBhbGwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGxldCBhY3R1YWxUYXJnZXQgPSB0eXBlb2Yga2V5ID09PSAnc3RyaW5nJyA/IHRhcmdldC5jb25zdHJ1Y3RvciA6IHRhcmdldDtcbiAgICBsZXQgciA9IG1ldGFkYXRhLmdldE9yQ3JlYXRlT3duKG1ldGFkYXRhLnJlc291cmNlLCBIdG1sQmVoYXZpb3JSZXNvdXJjZSwgYWN0dWFsVGFyZ2V0KTtcblxuICAgIGlmICh0eXBlb2Ygc2VsZWN0b3JPckNvbmZpZyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHNlbGVjdG9yT3JDb25maWcgPSB7XG4gICAgICAgIHNlbGVjdG9yOiBzZWxlY3Rvck9yQ29uZmlnLFxuICAgICAgICBuYW1lOiBrZXlcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKGRlc2NyaXB0b3IpIHtcbiAgICAgIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgIH1cblxuICAgIHNlbGVjdG9yT3JDb25maWcuYWxsID0gYWxsO1xuICAgIHIuYWRkQ2hpbGRCaW5kaW5nKG5ldyBDaGlsZE9ic2VydmVyKHNlbGVjdG9yT3JDb25maWcpKTtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkcmVuKHNlbGVjdG9yT3JDb25maWcpIHtcbiAgcmV0dXJuIGNyZWF0ZUNoaWxkT2JzZXJ2ZXJEZWNvcmF0b3Ioc2VsZWN0b3JPckNvbmZpZywgdHJ1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZChzZWxlY3Rvck9yQ29uZmlnKSB7XG4gIHJldHVybiBjcmVhdGVDaGlsZE9ic2VydmVyRGVjb3JhdG9yKHNlbGVjdG9yT3JDb25maWcsIGZhbHNlKTtcbn1cblxubGV0IENoaWxkT2JzZXJ2ZXIgPSBjbGFzcyBDaGlsZE9ic2VydmVyIHtcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgdGhpcy5uYW1lID0gY29uZmlnLm5hbWU7XG4gICAgdGhpcy5jaGFuZ2VIYW5kbGVyID0gY29uZmlnLmNoYW5nZUhhbmRsZXIgfHwgdGhpcy5uYW1lICsgJ0NoYW5nZWQnO1xuICAgIHRoaXMuc2VsZWN0b3IgPSBjb25maWcuc2VsZWN0b3I7XG4gICAgdGhpcy5hbGwgPSBjb25maWcuYWxsO1xuICB9XG5cbiAgY3JlYXRlKHZpZXdIb3N0LCB2aWV3TW9kZWwsIGNvbnRyb2xsZXIpIHtcbiAgICByZXR1cm4gbmV3IENoaWxkT2JzZXJ2ZXJCaW5kZXIodGhpcy5zZWxlY3Rvciwgdmlld0hvc3QsIHRoaXMubmFtZSwgdmlld01vZGVsLCBjb250cm9sbGVyLCB0aGlzLmNoYW5nZUhhbmRsZXIsIHRoaXMuYWxsKTtcbiAgfVxufTtcblxuXG5jb25zdCBub011dGF0aW9ucyA9IFtdO1xuXG5mdW5jdGlvbiB0cmFja011dGF0aW9uKGdyb3VwZWRNdXRhdGlvbnMsIGJpbmRlciwgcmVjb3JkKSB7XG4gIGxldCBtdXRhdGlvbnMgPSBncm91cGVkTXV0YXRpb25zLmdldChiaW5kZXIpO1xuXG4gIGlmICghbXV0YXRpb25zKSB7XG4gICAgbXV0YXRpb25zID0gW107XG4gICAgZ3JvdXBlZE11dGF0aW9ucy5zZXQoYmluZGVyLCBtdXRhdGlvbnMpO1xuICB9XG5cbiAgbXV0YXRpb25zLnB1c2gocmVjb3JkKTtcbn1cblxuZnVuY3Rpb24gb25DaGlsZENoYW5nZShtdXRhdGlvbnMsIG9ic2VydmVyKSB7XG4gIGxldCBiaW5kZXJzID0gb2JzZXJ2ZXIuYmluZGVycztcbiAgbGV0IGJpbmRlcnNMZW5ndGggPSBiaW5kZXJzLmxlbmd0aDtcbiAgbGV0IGdyb3VwZWRNdXRhdGlvbnMgPSBuZXcgTWFwKCk7XG5cbiAgZm9yIChsZXQgaSA9IDAsIGlpID0gbXV0YXRpb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICBsZXQgcmVjb3JkID0gbXV0YXRpb25zW2ldO1xuICAgIGxldCBhZGRlZCA9IHJlY29yZC5hZGRlZE5vZGVzO1xuICAgIGxldCByZW1vdmVkID0gcmVjb3JkLnJlbW92ZWROb2RlcztcblxuICAgIGZvciAobGV0IGogPSAwLCBqaiA9IHJlbW92ZWQubGVuZ3RoOyBqIDwgamo7ICsraikge1xuICAgICAgbGV0IG5vZGUgPSByZW1vdmVkW2pdO1xuICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBiaW5kZXJzTGVuZ3RoOyArK2spIHtcbiAgICAgICAgICBsZXQgYmluZGVyID0gYmluZGVyc1trXTtcbiAgICAgICAgICBpZiAoYmluZGVyLm9uUmVtb3ZlKG5vZGUpKSB7XG4gICAgICAgICAgICB0cmFja011dGF0aW9uKGdyb3VwZWRNdXRhdGlvbnMsIGJpbmRlciwgcmVjb3JkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGxldCBqID0gMCwgamogPSBhZGRlZC5sZW5ndGg7IGogPCBqajsgKytqKSB7XG4gICAgICBsZXQgbm9kZSA9IGFkZGVkW2pdO1xuICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBiaW5kZXJzTGVuZ3RoOyArK2spIHtcbiAgICAgICAgICBsZXQgYmluZGVyID0gYmluZGVyc1trXTtcbiAgICAgICAgICBpZiAoYmluZGVyLm9uQWRkKG5vZGUpKSB7XG4gICAgICAgICAgICB0cmFja011dGF0aW9uKGdyb3VwZWRNdXRhdGlvbnMsIGJpbmRlciwgcmVjb3JkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBncm91cGVkTXV0YXRpb25zLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHtcbiAgICBpZiAoa2V5LmNoYW5nZUhhbmRsZXIgIT09IG51bGwpIHtcbiAgICAgIGtleS52aWV3TW9kZWxba2V5LmNoYW5nZUhhbmRsZXJdKHZhbHVlKTtcbiAgICB9XG4gIH0pO1xufVxuXG5sZXQgQ2hpbGRPYnNlcnZlckJpbmRlciA9IGNsYXNzIENoaWxkT2JzZXJ2ZXJCaW5kZXIge1xuICBjb25zdHJ1Y3RvcihzZWxlY3Rvciwgdmlld0hvc3QsIHByb3BlcnR5LCB2aWV3TW9kZWwsIGNvbnRyb2xsZXIsIGNoYW5nZUhhbmRsZXIsIGFsbCkge1xuICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICB0aGlzLnZpZXdIb3N0ID0gdmlld0hvc3Q7XG4gICAgdGhpcy5wcm9wZXJ0eSA9IHByb3BlcnR5O1xuICAgIHRoaXMudmlld01vZGVsID0gdmlld01vZGVsO1xuICAgIHRoaXMuY29udHJvbGxlciA9IGNvbnRyb2xsZXI7XG4gICAgdGhpcy5jaGFuZ2VIYW5kbGVyID0gY2hhbmdlSGFuZGxlciBpbiB2aWV3TW9kZWwgPyBjaGFuZ2VIYW5kbGVyIDogbnVsbDtcbiAgICB0aGlzLnVzZXNTaGFkb3dET00gPSBjb250cm9sbGVyLmJlaGF2aW9yLnVzZXNTaGFkb3dET007XG4gICAgdGhpcy5hbGwgPSBhbGw7XG5cbiAgICBpZiAoIXRoaXMudXNlc1NoYWRvd0RPTSAmJiBjb250cm9sbGVyLnZpZXcgJiYgY29udHJvbGxlci52aWV3LmNvbnRlbnRWaWV3KSB7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3ID0gY29udHJvbGxlci52aWV3LmNvbnRlbnRWaWV3O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNvbnRlbnRWaWV3ID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBtYXRjaGVzKGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudC5tYXRjaGVzKHRoaXMuc2VsZWN0b3IpKSB7XG4gICAgICBpZiAodGhpcy5jb250ZW50VmlldyA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgbGV0IGNvbnRlbnRWaWV3ID0gdGhpcy5jb250ZW50VmlldztcbiAgICAgIGxldCBhc3NpZ25lZFNsb3QgPSBlbGVtZW50LmF1QXNzaWduZWRTbG90O1xuXG4gICAgICBpZiAoYXNzaWduZWRTbG90ICYmIGFzc2lnbmVkU2xvdC5wcm9qZWN0RnJvbUFuY2hvcnMpIHtcbiAgICAgICAgbGV0IGFuY2hvcnMgPSBhc3NpZ25lZFNsb3QucHJvamVjdEZyb21BbmNob3JzO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IGFuY2hvcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgIGlmIChhbmNob3JzW2ldLmF1T3duZXJWaWV3ID09PSBjb250ZW50Vmlldykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZWxlbWVudC5hdU93bmVyVmlldyA9PT0gY29udGVudFZpZXc7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgYmluZChzb3VyY2UpIHtcbiAgICBsZXQgdmlld0hvc3QgPSB0aGlzLnZpZXdIb3N0O1xuICAgIGxldCB2aWV3TW9kZWwgPSB0aGlzLnZpZXdNb2RlbDtcbiAgICBsZXQgb2JzZXJ2ZXIgPSB2aWV3SG9zdC5fX2NoaWxkT2JzZXJ2ZXJfXztcblxuICAgIGlmICghb2JzZXJ2ZXIpIHtcbiAgICAgIG9ic2VydmVyID0gdmlld0hvc3QuX19jaGlsZE9ic2VydmVyX18gPSBET00uY3JlYXRlTXV0YXRpb25PYnNlcnZlcihvbkNoaWxkQ2hhbmdlKTtcblxuICAgICAgbGV0IG9wdGlvbnMgPSB7XG4gICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgc3VidHJlZTogIXRoaXMudXNlc1NoYWRvd0RPTVxuICAgICAgfTtcblxuICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh2aWV3SG9zdCwgb3B0aW9ucyk7XG4gICAgICBvYnNlcnZlci5iaW5kZXJzID0gW107XG4gICAgfVxuXG4gICAgb2JzZXJ2ZXIuYmluZGVycy5wdXNoKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMudXNlc1NoYWRvd0RPTSkge1xuICAgICAgbGV0IGN1cnJlbnQgPSB2aWV3SG9zdC5maXJzdEVsZW1lbnRDaGlsZDtcblxuICAgICAgaWYgKHRoaXMuYWxsKSB7XG4gICAgICAgIGxldCBpdGVtcyA9IHZpZXdNb2RlbFt0aGlzLnByb3BlcnR5XTtcbiAgICAgICAgaWYgKCFpdGVtcykge1xuICAgICAgICAgIGl0ZW1zID0gdmlld01vZGVsW3RoaXMucHJvcGVydHldID0gW107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbXMuc3BsaWNlKDApO1xuICAgICAgICB9XG5cbiAgICAgICAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICAgICAgICBpZiAodGhpcy5tYXRjaGVzKGN1cnJlbnQpKSB7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKGN1cnJlbnQuYXUgJiYgY3VycmVudC5hdS5jb250cm9sbGVyID8gY3VycmVudC5hdS5jb250cm9sbGVyLnZpZXdNb2RlbCA6IGN1cnJlbnQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50Lm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmNoYW5nZUhhbmRsZXIgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbFt0aGlzLmNoYW5nZUhhbmRsZXJdKG5vTXV0YXRpb25zKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICAgICAgICBpZiAodGhpcy5tYXRjaGVzKGN1cnJlbnQpKSB7XG4gICAgICAgICAgICBsZXQgdmFsdWUgPSBjdXJyZW50LmF1ICYmIGN1cnJlbnQuYXUuY29udHJvbGxlciA/IGN1cnJlbnQuYXUuY29udHJvbGxlci52aWV3TW9kZWwgOiBjdXJyZW50O1xuICAgICAgICAgICAgdGhpcy52aWV3TW9kZWxbdGhpcy5wcm9wZXJ0eV0gPSB2YWx1ZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuY2hhbmdlSGFuZGxlciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICB0aGlzLnZpZXdNb2RlbFt0aGlzLmNoYW5nZUhhbmRsZXJdKHZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgb25SZW1vdmUoZWxlbWVudCkge1xuICAgIGlmICh0aGlzLm1hdGNoZXMoZWxlbWVudCkpIHtcbiAgICAgIGxldCB2YWx1ZSA9IGVsZW1lbnQuYXUgJiYgZWxlbWVudC5hdS5jb250cm9sbGVyID8gZWxlbWVudC5hdS5jb250cm9sbGVyLnZpZXdNb2RlbCA6IGVsZW1lbnQ7XG5cbiAgICAgIGlmICh0aGlzLmFsbCkge1xuICAgICAgICBsZXQgaXRlbXMgPSB0aGlzLnZpZXdNb2RlbFt0aGlzLnByb3BlcnR5XSB8fCAodGhpcy52aWV3TW9kZWxbdGhpcy5wcm9wZXJ0eV0gPSBbXSk7XG4gICAgICAgIGxldCBpbmRleCA9IGl0ZW1zLmluZGV4T2YodmFsdWUpO1xuXG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICBpdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBvbkFkZChlbGVtZW50KSB7XG4gICAgaWYgKHRoaXMubWF0Y2hlcyhlbGVtZW50KSkge1xuICAgICAgbGV0IHZhbHVlID0gZWxlbWVudC5hdSAmJiBlbGVtZW50LmF1LmNvbnRyb2xsZXIgPyBlbGVtZW50LmF1LmNvbnRyb2xsZXIudmlld01vZGVsIDogZWxlbWVudDtcblxuICAgICAgaWYgKHRoaXMuYWxsKSB7XG4gICAgICAgIGxldCBpdGVtcyA9IHRoaXMudmlld01vZGVsW3RoaXMucHJvcGVydHldIHx8ICh0aGlzLnZpZXdNb2RlbFt0aGlzLnByb3BlcnR5XSA9IFtdKTtcblxuICAgICAgICBpZiAodGhpcy5zZWxlY3RvciA9PT0gJyonKSB7XG4gICAgICAgICAgaXRlbXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaW5kZXggPSAwO1xuICAgICAgICBsZXQgcHJldiA9IGVsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZztcblxuICAgICAgICB3aGlsZSAocHJldikge1xuICAgICAgICAgIGlmICh0aGlzLm1hdGNoZXMocHJldikpIHtcbiAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcHJldiA9IHByZXYucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgICAgICAgfVxuXG4gICAgICAgIGl0ZW1zLnNwbGljZShpbmRleCwgMCwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgdGhpcy52aWV3TW9kZWxbdGhpcy5wcm9wZXJ0eV0gPSB2YWx1ZTtcblxuICAgICAgaWYgKHRoaXMuY2hhbmdlSGFuZGxlciAhPT0gbnVsbCkge1xuICAgICAgICB0aGlzLnZpZXdNb2RlbFt0aGlzLmNoYW5nZUhhbmRsZXJdKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB1bmJpbmQoKSB7XG4gICAgaWYgKHRoaXMudmlld0hvc3QuX19jaGlsZE9ic2VydmVyX18pIHtcbiAgICAgIHRoaXMudmlld0hvc3QuX19jaGlsZE9ic2VydmVyX18uZGlzY29ubmVjdCgpO1xuICAgICAgdGhpcy52aWV3SG9zdC5fX2NoaWxkT2JzZXJ2ZXJfXyA9IG51bGw7XG4gICAgICB0aGlzLnZpZXdNb2RlbFt0aGlzLnByb3BlcnR5XSA9IG51bGw7XG4gICAgfVxuICB9XG59O1xuXG5cbmZ1bmN0aW9uIHJlbW92ZSh2aWV3U2xvdCwgcHJldmlvdXMpIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkocHJldmlvdXMpID8gdmlld1Nsb3QucmVtb3ZlTWFueShwcmV2aW91cywgdHJ1ZSkgOiB2aWV3U2xvdC5yZW1vdmUocHJldmlvdXMsIHRydWUpO1xufVxuXG5leHBvcnQgY29uc3QgU3dhcFN0cmF0ZWdpZXMgPSB7XG4gIGJlZm9yZSh2aWV3U2xvdCwgcHJldmlvdXMsIGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIHByZXZpb3VzID09PSB1bmRlZmluZWQgPyBjYWxsYmFjaygpIDogY2FsbGJhY2soKS50aGVuKCgpID0+IHJlbW92ZSh2aWV3U2xvdCwgcHJldmlvdXMpKTtcbiAgfSxcblxuICB3aXRoKHZpZXdTbG90LCBwcmV2aW91cywgY2FsbGJhY2spIHtcbiAgICByZXR1cm4gcHJldmlvdXMgPT09IHVuZGVmaW5lZCA/IGNhbGxiYWNrKCkgOiBQcm9taXNlLmFsbChbcmVtb3ZlKHZpZXdTbG90LCBwcmV2aW91cyksIGNhbGxiYWNrKCldKTtcbiAgfSxcblxuICBhZnRlcih2aWV3U2xvdCwgcHJldmlvdXMsIGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2aWV3U2xvdC5yZW1vdmVBbGwodHJ1ZSkpLnRoZW4oY2FsbGJhY2spO1xuICB9XG59O1xuXG5mdW5jdGlvbiB0cnlBY3RpdmF0ZVZpZXdNb2RlbChjb250ZXh0KSB7XG4gIGlmIChjb250ZXh0LnNraXBBY3RpdmF0aW9uIHx8IHR5cGVvZiBjb250ZXh0LnZpZXdNb2RlbC5hY3RpdmF0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIHJldHVybiBjb250ZXh0LnZpZXdNb2RlbC5hY3RpdmF0ZShjb250ZXh0Lm1vZGVsKSB8fCBQcm9taXNlLnJlc29sdmUoKTtcbn1cblxuZXhwb3J0IGxldCBDb21wb3NpdGlvbkVuZ2luZSA9IChfZGVjMTAgPSBpbmplY3QoVmlld0VuZ2luZSwgVmlld0xvY2F0b3IpLCBfZGVjMTAoX2NsYXNzMTggPSBjbGFzcyBDb21wb3NpdGlvbkVuZ2luZSB7XG4gIGNvbnN0cnVjdG9yKHZpZXdFbmdpbmUsIHZpZXdMb2NhdG9yKSB7XG4gICAgdGhpcy52aWV3RW5naW5lID0gdmlld0VuZ2luZTtcbiAgICB0aGlzLnZpZXdMb2NhdG9yID0gdmlld0xvY2F0b3I7XG4gIH1cblxuICBfc3dhcChjb250ZXh0LCB2aWV3KSB7XG4gICAgbGV0IHN3YXBTdHJhdGVneSA9IFN3YXBTdHJhdGVnaWVzW2NvbnRleHQuc3dhcE9yZGVyXSB8fCBTd2FwU3RyYXRlZ2llcy5hZnRlcjtcbiAgICBsZXQgcHJldmlvdXNWaWV3cyA9IGNvbnRleHQudmlld1Nsb3QuY2hpbGRyZW4uc2xpY2UoKTtcblxuICAgIHJldHVybiBzd2FwU3RyYXRlZ3koY29udGV4dC52aWV3U2xvdCwgcHJldmlvdXNWaWV3cywgKCkgPT4ge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjb250ZXh0LnZpZXdTbG90LmFkZCh2aWV3KSkudGhlbigoKSA9PiB7XG4gICAgICAgIGlmIChjb250ZXh0LmN1cnJlbnRDb250cm9sbGVyKSB7XG4gICAgICAgICAgY29udGV4dC5jdXJyZW50Q29udHJvbGxlci51bmJpbmQoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSkudGhlbigoKSA9PiB7XG4gICAgICBpZiAoY29udGV4dC5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIpIHtcbiAgICAgICAgY29udGV4dC5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIuZG9uZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgX2NyZWF0ZUNvbnRyb2xsZXJBbmRTd2FwKGNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVDb250cm9sbGVyKGNvbnRleHQpLnRoZW4oY29udHJvbGxlciA9PiB7XG4gICAgICBpZiAoY29udGV4dC5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIGNvbnRleHQuY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuLndhaXRGb3JDb21wb3NpdGlvbkNvbXBsZXRlKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgY29udHJvbGxlci5hdXRvbWF0ZShjb250ZXh0Lm92ZXJyaWRlQ29udGV4dCwgY29udGV4dC5vd25pbmdWaWV3KTtcblxuICAgICAgICAgIHJldHVybiB0aGlzLl9zd2FwKGNvbnRleHQsIGNvbnRyb2xsZXIudmlldyk7XG4gICAgICAgIH0pLnRoZW4oKCkgPT4gY29udHJvbGxlcik7XG4gICAgICB9XG5cbiAgICAgIGNvbnRyb2xsZXIuYXV0b21hdGUoY29udGV4dC5vdmVycmlkZUNvbnRleHQsIGNvbnRleHQub3duaW5nVmlldyk7XG5cbiAgICAgIHJldHVybiB0aGlzLl9zd2FwKGNvbnRleHQsIGNvbnRyb2xsZXIudmlldykudGhlbigoKSA9PiBjb250cm9sbGVyKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNyZWF0ZUNvbnRyb2xsZXIoY29udGV4dCkge1xuICAgIGxldCBjaGlsZENvbnRhaW5lcjtcbiAgICBsZXQgdmlld01vZGVsO1xuICAgIGxldCB2aWV3TW9kZWxSZXNvdXJjZTtcblxuICAgIGxldCBtO1xuXG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlVmlld01vZGVsKGNvbnRleHQpLnRoZW4odHJ5QWN0aXZhdGVWaWV3TW9kZWwpLnRoZW4oKCkgPT4ge1xuICAgICAgY2hpbGRDb250YWluZXIgPSBjb250ZXh0LmNoaWxkQ29udGFpbmVyO1xuICAgICAgdmlld01vZGVsID0gY29udGV4dC52aWV3TW9kZWw7XG4gICAgICB2aWV3TW9kZWxSZXNvdXJjZSA9IGNvbnRleHQudmlld01vZGVsUmVzb3VyY2U7XG4gICAgICBtID0gdmlld01vZGVsUmVzb3VyY2UubWV0YWRhdGE7XG5cbiAgICAgIGxldCB2aWV3U3RyYXRlZ3kgPSB0aGlzLnZpZXdMb2NhdG9yLmdldFZpZXdTdHJhdGVneShjb250ZXh0LnZpZXcgfHwgdmlld01vZGVsKTtcblxuICAgICAgaWYgKGNvbnRleHQudmlld1Jlc291cmNlcykge1xuICAgICAgICB2aWV3U3RyYXRlZ3kubWFrZVJlbGF0aXZlVG8oY29udGV4dC52aWV3UmVzb3VyY2VzLnZpZXdVcmwpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbS5sb2FkKGNoaWxkQ29udGFpbmVyLCB2aWV3TW9kZWxSZXNvdXJjZS52YWx1ZSwgbnVsbCwgdmlld1N0cmF0ZWd5LCB0cnVlKTtcbiAgICB9KS50aGVuKHZpZXdGYWN0b3J5ID0+IG0uY3JlYXRlKGNoaWxkQ29udGFpbmVyLCBCZWhhdmlvckluc3RydWN0aW9uLmR5bmFtaWMoY29udGV4dC5ob3N0LCB2aWV3TW9kZWwsIHZpZXdGYWN0b3J5KSkpO1xuICB9XG5cbiAgZW5zdXJlVmlld01vZGVsKGNvbnRleHQpIHtcbiAgICBsZXQgY2hpbGRDb250YWluZXIgPSBjb250ZXh0LmNoaWxkQ29udGFpbmVyID0gY29udGV4dC5jaGlsZENvbnRhaW5lciB8fCBjb250ZXh0LmNvbnRhaW5lci5jcmVhdGVDaGlsZCgpO1xuXG4gICAgaWYgKHR5cGVvZiBjb250ZXh0LnZpZXdNb2RlbCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGNvbnRleHQudmlld01vZGVsID0gY29udGV4dC52aWV3UmVzb3VyY2VzID8gY29udGV4dC52aWV3UmVzb3VyY2VzLnJlbGF0aXZlVG9WaWV3KGNvbnRleHQudmlld01vZGVsKSA6IGNvbnRleHQudmlld01vZGVsO1xuXG4gICAgICByZXR1cm4gdGhpcy52aWV3RW5naW5lLmltcG9ydFZpZXdNb2RlbFJlc291cmNlKGNvbnRleHQudmlld01vZGVsKS50aGVuKHZpZXdNb2RlbFJlc291cmNlID0+IHtcbiAgICAgICAgY2hpbGRDb250YWluZXIuYXV0b1JlZ2lzdGVyKHZpZXdNb2RlbFJlc291cmNlLnZhbHVlKTtcblxuICAgICAgICBpZiAoY29udGV4dC5ob3N0KSB7XG4gICAgICAgICAgY2hpbGRDb250YWluZXIucmVnaXN0ZXJJbnN0YW5jZShET00uRWxlbWVudCwgY29udGV4dC5ob3N0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRleHQudmlld01vZGVsID0gY2hpbGRDb250YWluZXIudmlld01vZGVsID0gY2hpbGRDb250YWluZXIuZ2V0KHZpZXdNb2RlbFJlc291cmNlLnZhbHVlKTtcbiAgICAgICAgY29udGV4dC52aWV3TW9kZWxSZXNvdXJjZSA9IHZpZXdNb2RlbFJlc291cmNlO1xuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGxldCBjdG9yID0gY29udGV4dC52aWV3TW9kZWwuY29uc3RydWN0b3I7XG4gICAgbGV0IGlzQ2xhc3MgPSB0eXBlb2YgY29udGV4dC52aWV3TW9kZWwgPT09ICdmdW5jdGlvbic7XG4gICAgaWYgKGlzQ2xhc3MpIHtcbiAgICAgIGN0b3IgPSBjb250ZXh0LnZpZXdNb2RlbDtcbiAgICAgIGNoaWxkQ29udGFpbmVyLmF1dG9SZWdpc3RlcihjdG9yKTtcbiAgICB9XG4gICAgbGV0IG0gPSBtZXRhZGF0YS5nZXRPckNyZWF0ZU93bihtZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIGN0b3IpO1xuXG4gICAgbS5lbGVtZW50TmFtZSA9IG0uZWxlbWVudE5hbWUgfHwgJ2R5bmFtaWMtZWxlbWVudCc7XG5cbiAgICBtLmluaXRpYWxpemUoaXNDbGFzcyA/IGNoaWxkQ29udGFpbmVyIDogY29udGV4dC5jb250YWluZXIgfHwgY2hpbGRDb250YWluZXIsIGN0b3IpO1xuXG4gICAgY29udGV4dC52aWV3TW9kZWxSZXNvdXJjZSA9IHsgbWV0YWRhdGE6IG0sIHZhbHVlOiBjdG9yIH07XG5cbiAgICBpZiAoY29udGV4dC5ob3N0KSB7XG4gICAgICBjaGlsZENvbnRhaW5lci5yZWdpc3Rlckluc3RhbmNlKERPTS5FbGVtZW50LCBjb250ZXh0Lmhvc3QpO1xuICAgIH1cbiAgICBjaGlsZENvbnRhaW5lci52aWV3TW9kZWwgPSBjb250ZXh0LnZpZXdNb2RlbCA9IGlzQ2xhc3MgPyBjaGlsZENvbnRhaW5lci5nZXQoY3RvcikgOiBjb250ZXh0LnZpZXdNb2RlbDtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNvbnRleHQpO1xuICB9XG5cbiAgY29tcG9zZShjb250ZXh0KSB7XG4gICAgY29udGV4dC5jaGlsZENvbnRhaW5lciA9IGNvbnRleHQuY2hpbGRDb250YWluZXIgfHwgY29udGV4dC5jb250YWluZXIuY3JlYXRlQ2hpbGQoKTtcbiAgICBjb250ZXh0LnZpZXcgPSB0aGlzLnZpZXdMb2NhdG9yLmdldFZpZXdTdHJhdGVneShjb250ZXh0LnZpZXcpO1xuXG4gICAgbGV0IHRyYW5zYWN0aW9uID0gY29udGV4dC5jaGlsZENvbnRhaW5lci5nZXQoQ29tcG9zaXRpb25UcmFuc2FjdGlvbik7XG4gICAgbGV0IGNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbiA9IHRyYW5zYWN0aW9uLnRyeUNhcHR1cmUoKTtcblxuICAgIGlmIChjb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4pIHtcbiAgICAgIGNvbnRleHQuY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuID0gY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZXh0LmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllciA9IHRyYW5zYWN0aW9uLmVubGlzdCgpO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnZpZXdNb2RlbCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUNvbnRyb2xsZXJBbmRTd2FwKGNvbnRleHQpO1xuICAgIH0gZWxzZSBpZiAoY29udGV4dC52aWV3KSB7XG4gICAgICBpZiAoY29udGV4dC52aWV3UmVzb3VyY2VzKSB7XG4gICAgICAgIGNvbnRleHQudmlldy5tYWtlUmVsYXRpdmVUbyhjb250ZXh0LnZpZXdSZXNvdXJjZXMudmlld1VybCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb250ZXh0LnZpZXcubG9hZFZpZXdGYWN0b3J5KHRoaXMudmlld0VuZ2luZSwgbmV3IFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24oKSkudGhlbih2aWV3RmFjdG9yeSA9PiB7XG4gICAgICAgIGxldCByZXN1bHQgPSB2aWV3RmFjdG9yeS5jcmVhdGUoY29udGV4dC5jaGlsZENvbnRhaW5lcik7XG4gICAgICAgIHJlc3VsdC5iaW5kKGNvbnRleHQuYmluZGluZ0NvbnRleHQsIGNvbnRleHQub3ZlcnJpZGVDb250ZXh0KTtcblxuICAgICAgICBpZiAoY29udGV4dC5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4pIHtcbiAgICAgICAgICByZXR1cm4gY29udGV4dC5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4ud2FpdEZvckNvbXBvc2l0aW9uQ29tcGxldGUoKS50aGVuKCgpID0+IHRoaXMuX3N3YXAoY29udGV4dCwgcmVzdWx0KSkudGhlbigoKSA9PiByZXN1bHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX3N3YXAoY29udGV4dCwgcmVzdWx0KS50aGVuKCgpID0+IHJlc3VsdCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGNvbnRleHQudmlld1Nsb3QpIHtcbiAgICAgIGNvbnRleHQudmlld1Nsb3QucmVtb3ZlQWxsKCk7XG5cbiAgICAgIGlmIChjb250ZXh0LmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllcikge1xuICAgICAgICBjb250ZXh0LmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllci5kb25lKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgfVxufSkgfHwgX2NsYXNzMTgpO1xuXG5leHBvcnQgbGV0IEVsZW1lbnRDb25maWdSZXNvdXJjZSA9IGNsYXNzIEVsZW1lbnRDb25maWdSZXNvdXJjZSB7XG4gIGluaXRpYWxpemUoY29udGFpbmVyLCB0YXJnZXQpIHt9XG5cbiAgcmVnaXN0ZXIocmVnaXN0cnksIG5hbWUpIHt9XG5cbiAgbG9hZChjb250YWluZXIsIHRhcmdldCkge1xuICAgIGxldCBjb25maWcgPSBuZXcgdGFyZ2V0KCk7XG4gICAgbGV0IGV2ZW50TWFuYWdlciA9IGNvbnRhaW5lci5nZXQoRXZlbnRNYW5hZ2VyKTtcbiAgICBldmVudE1hbmFnZXIucmVnaXN0ZXJFbGVtZW50Q29uZmlnKGNvbmZpZyk7XG4gIH1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNvdXJjZShpbnN0YW5jZU9yQ29uZmlnKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgbGV0IGlzQ29uZmlnID0gdHlwZW9mIGluc3RhbmNlT3JDb25maWcgPT09ICdzdHJpbmcnIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihpbnN0YW5jZU9yQ29uZmlnKSA9PT0gT2JqZWN0LnByb3RvdHlwZTtcbiAgICBpZiAoaXNDb25maWcpIHtcbiAgICAgIHRhcmdldC4kcmVzb3VyY2UgPSBpbnN0YW5jZU9yQ29uZmlnO1xuICAgIH0gZWxzZSB7XG4gICAgICBtZXRhZGF0YS5kZWZpbmUobWV0YWRhdGEucmVzb3VyY2UsIGluc3RhbmNlT3JDb25maWcsIHRhcmdldCk7XG4gICAgfVxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYmVoYXZpb3Iob3ZlcnJpZGUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICBpZiAob3ZlcnJpZGUgaW5zdGFuY2VvZiBIdG1sQmVoYXZpb3JSZXNvdXJjZSkge1xuICAgICAgbWV0YWRhdGEuZGVmaW5lKG1ldGFkYXRhLnJlc291cmNlLCBvdmVycmlkZSwgdGFyZ2V0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IHIgPSBtZXRhZGF0YS5nZXRPckNyZWF0ZU93bihtZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIHRhcmdldCk7XG4gICAgICBPYmplY3QuYXNzaWduKHIsIG92ZXJyaWRlKTtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjdXN0b21FbGVtZW50KG5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICBsZXQgciA9IG1ldGFkYXRhLmdldE9yQ3JlYXRlT3duKG1ldGFkYXRhLnJlc291cmNlLCBIdG1sQmVoYXZpb3JSZXNvdXJjZSwgdGFyZ2V0KTtcbiAgICByLmVsZW1lbnROYW1lID0gdmFsaWRhdGVCZWhhdmlvck5hbWUobmFtZSwgJ2N1c3RvbSBlbGVtZW50Jyk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjdXN0b21BdHRyaWJ1dGUobmFtZSwgZGVmYXVsdEJpbmRpbmdNb2RlLCBhbGlhc2VzKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgbGV0IHIgPSBtZXRhZGF0YS5nZXRPckNyZWF0ZU93bihtZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIHRhcmdldCk7XG4gICAgci5hdHRyaWJ1dGVOYW1lID0gdmFsaWRhdGVCZWhhdmlvck5hbWUobmFtZSwgJ2N1c3RvbSBhdHRyaWJ1dGUnKTtcbiAgICByLmF0dHJpYnV0ZURlZmF1bHRCaW5kaW5nTW9kZSA9IGRlZmF1bHRCaW5kaW5nTW9kZTtcbiAgICByLmFsaWFzZXMgPSBhbGlhc2VzO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdGVtcGxhdGVDb250cm9sbGVyKHRhcmdldCkge1xuICBsZXQgZGVjbyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgbGV0IHIgPSBtZXRhZGF0YS5nZXRPckNyZWF0ZU93bihtZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIHQpO1xuICAgIHIubGlmdHNDb250ZW50ID0gdHJ1ZTtcbiAgfTtcblxuICByZXR1cm4gdGFyZ2V0ID8gZGVjbyh0YXJnZXQpIDogZGVjbztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJpbmRhYmxlKG5hbWVPckNvbmZpZ09yVGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IpIHtcbiAgbGV0IGRlY28gPSBmdW5jdGlvbiAodGFyZ2V0LCBrZXkyLCBkZXNjcmlwdG9yMikge1xuICAgIGxldCBhY3R1YWxUYXJnZXQgPSBrZXkyID8gdGFyZ2V0LmNvbnN0cnVjdG9yIDogdGFyZ2V0O1xuICAgIGxldCByID0gbWV0YWRhdGEuZ2V0T3JDcmVhdGVPd24obWV0YWRhdGEucmVzb3VyY2UsIEh0bWxCZWhhdmlvclJlc291cmNlLCBhY3R1YWxUYXJnZXQpO1xuICAgIGxldCBwcm9wO1xuXG4gICAgaWYgKGtleTIpIHtcbiAgICAgIG5hbWVPckNvbmZpZ09yVGFyZ2V0ID0gbmFtZU9yQ29uZmlnT3JUYXJnZXQgfHwge307XG4gICAgICBuYW1lT3JDb25maWdPclRhcmdldC5uYW1lID0ga2V5MjtcbiAgICB9XG5cbiAgICBwcm9wID0gbmV3IEJpbmRhYmxlUHJvcGVydHkobmFtZU9yQ29uZmlnT3JUYXJnZXQpO1xuICAgIHJldHVybiBwcm9wLnJlZ2lzdGVyV2l0aChhY3R1YWxUYXJnZXQsIHIsIGRlc2NyaXB0b3IyKTtcbiAgfTtcblxuICBpZiAoIW5hbWVPckNvbmZpZ09yVGFyZ2V0KSB7XG4gICAgcmV0dXJuIGRlY287XG4gIH1cblxuICBpZiAoa2V5KSB7XG4gICAgbGV0IHRhcmdldCA9IG5hbWVPckNvbmZpZ09yVGFyZ2V0O1xuICAgIG5hbWVPckNvbmZpZ09yVGFyZ2V0ID0gbnVsbDtcbiAgICByZXR1cm4gZGVjbyh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcik7XG4gIH1cblxuICByZXR1cm4gZGVjbztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGR5bmFtaWNPcHRpb25zKHRhcmdldCkge1xuICBsZXQgZGVjbyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgbGV0IHIgPSBtZXRhZGF0YS5nZXRPckNyZWF0ZU93bihtZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIHQpO1xuICAgIHIuaGFzRHluYW1pY09wdGlvbnMgPSB0cnVlO1xuICB9O1xuXG4gIHJldHVybiB0YXJnZXQgPyBkZWNvKHRhcmdldCkgOiBkZWNvO1xufVxuXG5jb25zdCBkZWZhdWx0U2hhZG93RE9NT3B0aW9ucyA9IHsgbW9kZTogJ29wZW4nIH07XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VTaGFkb3dET00odGFyZ2V0T3JPcHRpb25zKSB7XG4gIGxldCBvcHRpb25zID0gdHlwZW9mIHRhcmdldE9yT3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJyB8fCAhdGFyZ2V0T3JPcHRpb25zID8gZGVmYXVsdFNoYWRvd0RPTU9wdGlvbnMgOiB0YXJnZXRPck9wdGlvbnM7XG5cbiAgbGV0IGRlY28gPSBmdW5jdGlvbiAodCkge1xuICAgIGxldCByID0gbWV0YWRhdGEuZ2V0T3JDcmVhdGVPd24obWV0YWRhdGEucmVzb3VyY2UsIEh0bWxCZWhhdmlvclJlc291cmNlLCB0KTtcbiAgICByLnRhcmdldFNoYWRvd0RPTSA9IHRydWU7XG4gICAgci5zaGFkb3dET01PcHRpb25zID0gb3B0aW9ucztcbiAgfTtcblxuICByZXR1cm4gdHlwZW9mIHRhcmdldE9yT3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJyA/IGRlY28odGFyZ2V0T3JPcHRpb25zKSA6IGRlY287XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9jZXNzQXR0cmlidXRlcyhwcm9jZXNzb3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7XG4gICAgbGV0IHIgPSBtZXRhZGF0YS5nZXRPckNyZWF0ZU93bihtZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIHQpO1xuICAgIHIucHJvY2Vzc0F0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoY29tcGlsZXIsIHJlc291cmNlcywgbm9kZSwgYXR0cmlidXRlcywgZWxlbWVudEluc3RydWN0aW9uKSB7XG4gICAgICB0cnkge1xuICAgICAgICBwcm9jZXNzb3IoY29tcGlsZXIsIHJlc291cmNlcywgbm9kZSwgYXR0cmlidXRlcywgZWxlbWVudEluc3RydWN0aW9uKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCd0ZW1wbGF0aW5nJykuZXJyb3IoZXJyb3IpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG59XG5cbmZ1bmN0aW9uIGRvTm90UHJvY2Vzc0NvbnRlbnQoKSB7XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByb2Nlc3NDb250ZW50KHByb2Nlc3Nvcikge1xuICByZXR1cm4gZnVuY3Rpb24gKHQpIHtcbiAgICBsZXQgciA9IG1ldGFkYXRhLmdldE9yQ3JlYXRlT3duKG1ldGFkYXRhLnJlc291cmNlLCBIdG1sQmVoYXZpb3JSZXNvdXJjZSwgdCk7XG4gICAgci5wcm9jZXNzQ29udGVudCA9IHByb2Nlc3NvciA/IGZ1bmN0aW9uIChjb21waWxlciwgcmVzb3VyY2VzLCBub2RlLCBpbnN0cnVjdGlvbikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHByb2Nlc3Nvcihjb21waWxlciwgcmVzb3VyY2VzLCBub2RlLCBpbnN0cnVjdGlvbik7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBMb2dNYW5hZ2VyLmdldExvZ2dlcigndGVtcGxhdGluZycpLmVycm9yKGVycm9yKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0gOiBkb05vdFByb2Nlc3NDb250ZW50O1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29udGFpbmVybGVzcyh0YXJnZXQpIHtcbiAgbGV0IGRlY28gPSBmdW5jdGlvbiAodCkge1xuICAgIGxldCByID0gbWV0YWRhdGEuZ2V0T3JDcmVhdGVPd24obWV0YWRhdGEucmVzb3VyY2UsIEh0bWxCZWhhdmlvclJlc291cmNlLCB0KTtcbiAgICByLmNvbnRhaW5lcmxlc3MgPSB0cnVlO1xuICB9O1xuXG4gIHJldHVybiB0YXJnZXQgPyBkZWNvKHRhcmdldCkgOiBkZWNvO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNlVmlld1N0cmF0ZWd5KHN0cmF0ZWd5KSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgbWV0YWRhdGEuZGVmaW5lKFZpZXdMb2NhdG9yLnZpZXdTdHJhdGVneU1ldGFkYXRhS2V5LCBzdHJhdGVneSwgdGFyZ2V0KTtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVZpZXcocGF0aCkge1xuICByZXR1cm4gdXNlVmlld1N0cmF0ZWd5KG5ldyBSZWxhdGl2ZVZpZXdTdHJhdGVneShwYXRoKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbmxpbmVWaWV3KG1hcmt1cCwgZGVwZW5kZW5jaWVzLCBkZXBlbmRlbmN5QmFzZVVybCkge1xuICByZXR1cm4gdXNlVmlld1N0cmF0ZWd5KG5ldyBJbmxpbmVWaWV3U3RyYXRlZ3kobWFya3VwLCBkZXBlbmRlbmNpZXMsIGRlcGVuZGVuY3lCYXNlVXJsKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub1ZpZXcodGFyZ2V0T3JEZXBlbmRlbmNpZXMsIGRlcGVuZGVuY3lCYXNlVXJsKSB7XG4gIGxldCB0YXJnZXQ7XG4gIGxldCBkZXBlbmRlbmNpZXM7XG4gIGlmICh0eXBlb2YgdGFyZ2V0T3JEZXBlbmRlbmNpZXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICB0YXJnZXQgPSB0YXJnZXRPckRlcGVuZGVuY2llcztcbiAgfSBlbHNlIHtcbiAgICBkZXBlbmRlbmNpZXMgPSB0YXJnZXRPckRlcGVuZGVuY2llcztcbiAgICB0YXJnZXQgPSB1bmRlZmluZWQ7XG4gIH1cblxuICBsZXQgZGVjbyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgbWV0YWRhdGEuZGVmaW5lKFZpZXdMb2NhdG9yLnZpZXdTdHJhdGVneU1ldGFkYXRhS2V5LCBuZXcgTm9WaWV3U3RyYXRlZ3koZGVwZW5kZW5jaWVzLCBkZXBlbmRlbmN5QmFzZVVybCksIHQpO1xuICB9O1xuXG4gIHJldHVybiB0YXJnZXQgPyBkZWNvKHRhcmdldCkgOiBkZWNvO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmlldyh0ZW1wbGF0ZU9yQ29uZmlnKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgdGFyZ2V0LiR2aWV3ID0gdGVtcGxhdGVPckNvbmZpZztcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVsZW1lbnRDb25maWcodGFyZ2V0KSB7XG4gIGxldCBkZWNvID0gZnVuY3Rpb24gKHQpIHtcbiAgICBtZXRhZGF0YS5kZWZpbmUobWV0YWRhdGEucmVzb3VyY2UsIG5ldyBFbGVtZW50Q29uZmlnUmVzb3VyY2UoKSwgdCk7XG4gIH07XG5cbiAgcmV0dXJuIHRhcmdldCA/IGRlY28odGFyZ2V0KSA6IGRlY287XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2aWV3UmVzb3VyY2VzKC4uLnJlc291cmNlcykge1xuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIG1ldGFkYXRhLmRlZmluZShWaWV3RW5naW5lLnZpZXdNb2RlbFJlcXVpcmVNZXRhZGF0YUtleSwgcmVzb3VyY2VzLCB0YXJnZXQpO1xuICB9O1xufVxuXG5leHBvcnQgbGV0IFRlbXBsYXRpbmdFbmdpbmUgPSAoX2RlYzExID0gaW5qZWN0KENvbnRhaW5lciwgTW9kdWxlQW5hbHl6ZXIsIFZpZXdDb21waWxlciwgQ29tcG9zaXRpb25FbmdpbmUpLCBfZGVjMTEoX2NsYXNzMTkgPSBjbGFzcyBUZW1wbGF0aW5nRW5naW5lIHtcbiAgY29uc3RydWN0b3IoY29udGFpbmVyLCBtb2R1bGVBbmFseXplciwgdmlld0NvbXBpbGVyLCBjb21wb3NpdGlvbkVuZ2luZSkge1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICB0aGlzLl9tb2R1bGVBbmFseXplciA9IG1vZHVsZUFuYWx5emVyO1xuICAgIHRoaXMuX3ZpZXdDb21waWxlciA9IHZpZXdDb21waWxlcjtcbiAgICB0aGlzLl9jb21wb3NpdGlvbkVuZ2luZSA9IGNvbXBvc2l0aW9uRW5naW5lO1xuICAgIGNvbnRhaW5lci5yZWdpc3Rlckluc3RhbmNlKEFuaW1hdG9yLCBBbmltYXRvci5pbnN0YW5jZSA9IG5ldyBBbmltYXRvcigpKTtcbiAgfVxuXG4gIGNvbmZpZ3VyZUFuaW1hdG9yKGFuaW1hdG9yKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnVucmVnaXN0ZXIoQW5pbWF0b3IpO1xuICAgIHRoaXMuX2NvbnRhaW5lci5yZWdpc3Rlckluc3RhbmNlKEFuaW1hdG9yLCBBbmltYXRvci5pbnN0YW5jZSA9IGFuaW1hdG9yKTtcbiAgfVxuXG4gIGNvbXBvc2UoY29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLl9jb21wb3NpdGlvbkVuZ2luZS5jb21wb3NlKGNvbnRleHQpO1xuICB9XG5cbiAgZW5oYW5jZShpbnN0cnVjdGlvbikge1xuICAgIGlmIChpbnN0cnVjdGlvbiBpbnN0YW5jZW9mIERPTS5FbGVtZW50KSB7XG4gICAgICBpbnN0cnVjdGlvbiA9IHsgZWxlbWVudDogaW5zdHJ1Y3Rpb24gfTtcbiAgICB9XG5cbiAgICBsZXQgY29tcGlsZXJJbnN0cnVjdGlvbnMgPSB7IGxldEV4cHJlc3Npb25zOiBbXSB9O1xuICAgIGxldCByZXNvdXJjZXMgPSBpbnN0cnVjdGlvbi5yZXNvdXJjZXMgfHwgdGhpcy5fY29udGFpbmVyLmdldChWaWV3UmVzb3VyY2VzKTtcblxuICAgIHRoaXMuX3ZpZXdDb21waWxlci5fY29tcGlsZU5vZGUoaW5zdHJ1Y3Rpb24uZWxlbWVudCwgcmVzb3VyY2VzLCBjb21waWxlckluc3RydWN0aW9ucywgaW5zdHJ1Y3Rpb24uZWxlbWVudC5wYXJlbnROb2RlLCAncm9vdCcsIHRydWUpO1xuXG4gICAgbGV0IGZhY3RvcnkgPSBuZXcgVmlld0ZhY3RvcnkoaW5zdHJ1Y3Rpb24uZWxlbWVudCwgY29tcGlsZXJJbnN0cnVjdGlvbnMsIHJlc291cmNlcyk7XG4gICAgbGV0IGNvbnRhaW5lciA9IGluc3RydWN0aW9uLmNvbnRhaW5lciB8fCB0aGlzLl9jb250YWluZXIuY3JlYXRlQ2hpbGQoKTtcbiAgICBsZXQgdmlldyA9IGZhY3RvcnkuY3JlYXRlKGNvbnRhaW5lciwgQmVoYXZpb3JJbnN0cnVjdGlvbi5lbmhhbmNlKCkpO1xuXG4gICAgdmlldy5iaW5kKGluc3RydWN0aW9uLmJpbmRpbmdDb250ZXh0IHx8IHt9LCBpbnN0cnVjdGlvbi5vdmVycmlkZUNvbnRleHQpO1xuXG4gICAgdmlldy5maXJzdENoaWxkID0gdmlldy5sYXN0Q2hpbGQgPSB2aWV3LmZyYWdtZW50O1xuICAgIHZpZXcuZnJhZ21lbnQgPSBET00uY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIHZpZXcuYXR0YWNoZWQoKTtcblxuICAgIHJldHVybiB2aWV3O1xuICB9XG59KSB8fCBfY2xhc3MxOSk7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/aurelia-templating/dist/es2015/aurelia-templating.js\n");

/***/ }),

/***/ "./node_modules/aurelia-webpack-plugin/runtime/empty-entry.js":
/*!********************************************************************!*\
  !*** ./node_modules/aurelia-webpack-plugin/runtime/empty-entry.js ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("// This file contains an empty module that does nothing.\n// It's meant to be added as an entry point to the main bundle\n// and helps reliably adding some Aurelia dependencies that are attached \n// to no module in particular, such as `includeAll` results or `aureliaApp`.\n//\n// Trying to attach those dependencies to, for example, 'aurelia-bootstrapper' \n// is unreliable if 'aurelia-bootstrapper' is in a DLL outside the bundle.\n//\n// Trying to attach to 'aurelia-loader-webpack' works well, unless a user\n// configures a customized loader instead (unlikely, but in theory supported).\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS13ZWJwYWNrLXBsdWdpbi9ydW50aW1lL2VtcHR5LWVudHJ5LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2F1cmVsaWEtd2VicGFjay1wbHVnaW4vcnVudGltZS9lbXB0eS1lbnRyeS5qcz8xODAzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoaXMgZmlsZSBjb250YWlucyBhbiBlbXB0eSBtb2R1bGUgdGhhdCBkb2VzIG5vdGhpbmcuXG4vLyBJdCdzIG1lYW50IHRvIGJlIGFkZGVkIGFzIGFuIGVudHJ5IHBvaW50IHRvIHRoZSBtYWluIGJ1bmRsZVxuLy8gYW5kIGhlbHBzIHJlbGlhYmx5IGFkZGluZyBzb21lIEF1cmVsaWEgZGVwZW5kZW5jaWVzIHRoYXQgYXJlIGF0dGFjaGVkIFxuLy8gdG8gbm8gbW9kdWxlIGluIHBhcnRpY3VsYXIsIHN1Y2ggYXMgYGluY2x1ZGVBbGxgIHJlc3VsdHMgb3IgYGF1cmVsaWFBcHBgLlxuLy9cbi8vIFRyeWluZyB0byBhdHRhY2ggdGhvc2UgZGVwZW5kZW5jaWVzIHRvLCBmb3IgZXhhbXBsZSwgJ2F1cmVsaWEtYm9vdHN0cmFwcGVyJyBcbi8vIGlzIHVucmVsaWFibGUgaWYgJ2F1cmVsaWEtYm9vdHN0cmFwcGVyJyBpcyBpbiBhIERMTCBvdXRzaWRlIHRoZSBidW5kbGUuXG4vL1xuLy8gVHJ5aW5nIHRvIGF0dGFjaCB0byAnYXVyZWxpYS1sb2FkZXItd2VicGFjaycgd29ya3Mgd2VsbCwgdW5sZXNzIGEgdXNlclxuLy8gY29uZmlndXJlcyBhIGN1c3RvbWl6ZWQgbG9hZGVyIGluc3RlYWQgKHVubGlrZWx5LCBidXQgaW4gdGhlb3J5IHN1cHBvcnRlZCkuXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/aurelia-webpack-plugin/runtime/empty-entry.js\n");

/***/ }),

/***/ "./node_modules/aurelia-webpack-plugin/runtime/pal-loader-entry.js":
/*!*************************************************************************!*\
  !*** ./node_modules/aurelia-webpack-plugin/runtime/pal-loader-entry.js ***!
  \*************************************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n// With default aurelia-loader-webpack config, this module is added as an extra entry\n// before any other code executes so that PAL.Loader is properly configured.\n// There are several tricky points worth noticing.\n// \n// We don't add aurelia-loader-webpack itself as an entry point (used to until 2.0 RC2)\n// because it (transitively) brings too much bagage with itself, most notably polyfills.\n// This made it super-hard to add other polyfills before Aurelia's and led to various bugs.\n//\n// We don't add custom code in aurelia-pal or aurelia-loader or aurelia-bootstrapper to detect\n// the Webpack environment and configure the loader because they might live in a DLL.\n// If they do, they would bring aurelia-loader-webpack along in the DLL and this is a special \n// library that *has to be in the main chunk.*\n//\n// The over-complicated design I've settled upon in the end is to use this special module\n// as an entry point that configures aurelia-loader-webpack. It has minimal static imports:\n// just aurelia-pal, which itself has no other dependencies and doesn't run much code.\n// It hacks the loader field into a getter so that it can synchronously load aurelia-loader-webpack\n// just in time when it is demanded by aurelia-bootstrapper.\n// This enables users to load polyfills before aurelia-loader-webpack is actually loaded.\n\n\n\nvar Loader;\n\nObject.defineProperty(aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"PLATFORM\"], \"Loader\", {\n  get: function() {\n    return Loader || (Loader = __webpack_require__(/*! aurelia-loader-webpack */ \"./node_modules/aurelia-loader-webpack/dist/es2015/aurelia-loader-webpack.js\").WebpackLoader);\n  },\n  set: function(value) {\n    Loader = value;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXVyZWxpYS13ZWJwYWNrLXBsdWdpbi9ydW50aW1lL3BhbC1sb2FkZXItZW50cnkuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS13ZWJwYWNrLXBsdWdpbi9ydW50aW1lL3BhbC1sb2FkZXItZW50cnkuanM/MWE2NiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBXaXRoIGRlZmF1bHQgYXVyZWxpYS1sb2FkZXItd2VicGFjayBjb25maWcsIHRoaXMgbW9kdWxlIGlzIGFkZGVkIGFzIGFuIGV4dHJhIGVudHJ5XG4vLyBiZWZvcmUgYW55IG90aGVyIGNvZGUgZXhlY3V0ZXMgc28gdGhhdCBQQUwuTG9hZGVyIGlzIHByb3Blcmx5IGNvbmZpZ3VyZWQuXG4vLyBUaGVyZSBhcmUgc2V2ZXJhbCB0cmlja3kgcG9pbnRzIHdvcnRoIG5vdGljaW5nLlxuLy8gXG4vLyBXZSBkb24ndCBhZGQgYXVyZWxpYS1sb2FkZXItd2VicGFjayBpdHNlbGYgYXMgYW4gZW50cnkgcG9pbnQgKHVzZWQgdG8gdW50aWwgMi4wIFJDMilcbi8vIGJlY2F1c2UgaXQgKHRyYW5zaXRpdmVseSkgYnJpbmdzIHRvbyBtdWNoIGJhZ2FnZSB3aXRoIGl0c2VsZiwgbW9zdCBub3RhYmx5IHBvbHlmaWxscy5cbi8vIFRoaXMgbWFkZSBpdCBzdXBlci1oYXJkIHRvIGFkZCBvdGhlciBwb2x5ZmlsbHMgYmVmb3JlIEF1cmVsaWEncyBhbmQgbGVkIHRvIHZhcmlvdXMgYnVncy5cbi8vXG4vLyBXZSBkb24ndCBhZGQgY3VzdG9tIGNvZGUgaW4gYXVyZWxpYS1wYWwgb3IgYXVyZWxpYS1sb2FkZXIgb3IgYXVyZWxpYS1ib290c3RyYXBwZXIgdG8gZGV0ZWN0XG4vLyB0aGUgV2VicGFjayBlbnZpcm9ubWVudCBhbmQgY29uZmlndXJlIHRoZSBsb2FkZXIgYmVjYXVzZSB0aGV5IG1pZ2h0IGxpdmUgaW4gYSBETEwuXG4vLyBJZiB0aGV5IGRvLCB0aGV5IHdvdWxkIGJyaW5nIGF1cmVsaWEtbG9hZGVyLXdlYnBhY2sgYWxvbmcgaW4gdGhlIERMTCBhbmQgdGhpcyBpcyBhIHNwZWNpYWwgXG4vLyBsaWJyYXJ5IHRoYXQgKmhhcyB0byBiZSBpbiB0aGUgbWFpbiBjaHVuay4qXG4vL1xuLy8gVGhlIG92ZXItY29tcGxpY2F0ZWQgZGVzaWduIEkndmUgc2V0dGxlZCB1cG9uIGluIHRoZSBlbmQgaXMgdG8gdXNlIHRoaXMgc3BlY2lhbCBtb2R1bGVcbi8vIGFzIGFuIGVudHJ5IHBvaW50IHRoYXQgY29uZmlndXJlcyBhdXJlbGlhLWxvYWRlci13ZWJwYWNrLiBJdCBoYXMgbWluaW1hbCBzdGF0aWMgaW1wb3J0czpcbi8vIGp1c3QgYXVyZWxpYS1wYWwsIHdoaWNoIGl0c2VsZiBoYXMgbm8gb3RoZXIgZGVwZW5kZW5jaWVzIGFuZCBkb2Vzbid0IHJ1biBtdWNoIGNvZGUuXG4vLyBJdCBoYWNrcyB0aGUgbG9hZGVyIGZpZWxkIGludG8gYSBnZXR0ZXIgc28gdGhhdCBpdCBjYW4gc3luY2hyb25vdXNseSBsb2FkIGF1cmVsaWEtbG9hZGVyLXdlYnBhY2tcbi8vIGp1c3QgaW4gdGltZSB3aGVuIGl0IGlzIGRlbWFuZGVkIGJ5IGF1cmVsaWEtYm9vdHN0cmFwcGVyLlxuLy8gVGhpcyBlbmFibGVzIHVzZXJzIHRvIGxvYWQgcG9seWZpbGxzIGJlZm9yZSBhdXJlbGlhLWxvYWRlci13ZWJwYWNrIGlzIGFjdHVhbGx5IGxvYWRlZC5cblxuaW1wb3J0IHsgUExBVEZPUk0gfSBmcm9tIFwiYXVyZWxpYS1wYWxcIjtcblxudmFyIExvYWRlcjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KFBMQVRGT1JNLCBcIkxvYWRlclwiLCB7XG4gIGdldDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIExvYWRlciB8fCAoTG9hZGVyID0gcmVxdWlyZShcImF1cmVsaWEtbG9hZGVyLXdlYnBhY2tcIikuV2VicGFja0xvYWRlcik7XG4gIH0sXG4gIHNldDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICBMb2FkZXIgPSB2YWx1ZTtcbiAgfVxufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/aurelia-webpack-plugin/runtime/pal-loader-entry.js\n");

/***/ }),

/***/ "./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcz9mMjhjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/process/browser.js\n");

/***/ }),

/***/ "./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay9idWlsZGluL2dsb2JhbC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9nbG9iYWwuanM/Y2QwMCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZztcblxuLy8gVGhpcyB3b3JrcyBpbiBub24tc3RyaWN0IG1vZGVcbmcgPSAoZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzO1xufSkoKTtcblxudHJ5IHtcblx0Ly8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApXG5cdGcgPSBnIHx8IG5ldyBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XG59IGNhdGNoIChlKSB7XG5cdC8vIFRoaXMgd29ya3MgaWYgdGhlIHdpbmRvdyByZWZlcmVuY2UgaXMgYXZhaWxhYmxlXG5cdGlmICh0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiKSBnID0gd2luZG93O1xufVxuXG4vLyBnIGNhbiBzdGlsbCBiZSB1bmRlZmluZWQsIGJ1dCBub3RoaW5nIHRvIGRvIGFib3V0IGl0Li4uXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xuLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGc7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/webpack/buildin/global.js\n");

/***/ }),

/***/ "./node_modules/webpack/buildin/harmony-module.js":
/*!*******************************************!*\
  !*** (webpack)/buildin/harmony-module.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay9idWlsZGluL2hhcm1vbnktbW9kdWxlLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL2hhcm1vbnktbW9kdWxlLmpzPzgyYjAiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvcmlnaW5hbE1vZHVsZSkge1xuXHRpZiAoIW9yaWdpbmFsTW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xuXHRcdHZhciBtb2R1bGUgPSBPYmplY3QuY3JlYXRlKG9yaWdpbmFsTW9kdWxlKTtcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcblx0XHRpZiAoIW1vZHVsZS5jaGlsZHJlbikgbW9kdWxlLmNoaWxkcmVuID0gW107XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJsb2FkZWRcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBtb2R1bGUubDtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImlkXCIsIHtcblx0XHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJleHBvcnRzXCIsIHtcblx0XHRcdGVudW1lcmFibGU6IHRydWVcblx0XHR9KTtcblx0XHRtb2R1bGUud2VicGFja1BvbHlmaWxsID0gMTtcblx0fVxuXHRyZXR1cm4gbW9kdWxlO1xufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/webpack/buildin/harmony-module.js\n");

/***/ }),

/***/ 0:
/*!*****************************************************************************************************************************!*\
  !*** multi aurelia-webpack-plugin/runtime/empty-entry aurelia-webpack-plugin/runtime/pal-loader-entry aurelia-bootstrapper ***!
  \*****************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! aurelia-webpack-plugin/runtime/empty-entry */"./node_modules/aurelia-webpack-plugin/runtime/empty-entry.js");
__webpack_require__(/*! aurelia-webpack-plugin/runtime/pal-loader-entry */"./node_modules/aurelia-webpack-plugin/runtime/pal-loader-entry.js");
module.exports = __webpack_require__(/*! aurelia-bootstrapper */"./node_modules/aurelia-bootstrapper/dist/es2015/aurelia-bootstrapper.js");


/***/ }),

/***/ "aurelia-event-aggregator":
/*!***************************************************************************************!*\
  !*** ./node_modules/aurelia-event-aggregator/dist/es2015/aurelia-event-aggregator.js ***!
  \***************************************************************************************/
/*! exports provided: EventAggregator, includeEventsIn, configure */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EventAggregator\", function() { return EventAggregator; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"includeEventsIn\", function() { return includeEventsIn; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-logging */ \"./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js\");\n\n\nconst logger = aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('event-aggregator');\n\nlet Handler = class Handler {\n  constructor(messageType, callback) {\n    this.messageType = messageType;\n    this.callback = callback;\n  }\n\n  handle(message) {\n    if (message instanceof this.messageType) {\n      this.callback.call(null, message);\n    }\n  }\n};\n\n\nfunction invokeCallback(callback, data, event) {\n  try {\n    callback(data, event);\n  } catch (e) {\n    logger.error(e);\n  }\n}\n\nfunction invokeHandler(handler, data) {\n  try {\n    handler.handle(data);\n  } catch (e) {\n    logger.error(e);\n  }\n}\n\nlet EventAggregator = class EventAggregator {\n  constructor() {\n    this.eventLookup = {};\n    this.messageHandlers = [];\n  }\n\n  publish(event, data) {\n    let subscribers;\n    let i;\n\n    if (!event) {\n      throw new Error('Event was invalid.');\n    }\n\n    if (typeof event === 'string') {\n      subscribers = this.eventLookup[event];\n      if (subscribers) {\n        subscribers = subscribers.slice();\n        i = subscribers.length;\n\n        while (i--) {\n          invokeCallback(subscribers[i], data, event);\n        }\n      }\n    } else {\n      subscribers = this.messageHandlers.slice();\n      i = subscribers.length;\n\n      while (i--) {\n        invokeHandler(subscribers[i], event);\n      }\n    }\n  }\n\n  subscribe(event, callback) {\n    let handler;\n    let subscribers;\n\n    if (!event) {\n      throw new Error('Event channel/type was invalid.');\n    }\n\n    if (typeof event === 'string') {\n      handler = callback;\n      subscribers = this.eventLookup[event] || (this.eventLookup[event] = []);\n    } else {\n      handler = new Handler(event, callback);\n      subscribers = this.messageHandlers;\n    }\n\n    subscribers.push(handler);\n\n    return {\n      dispose() {\n        let idx = subscribers.indexOf(handler);\n        if (idx !== -1) {\n          subscribers.splice(idx, 1);\n        }\n      }\n    };\n  }\n\n  subscribeOnce(event, callback) {\n    let sub = this.subscribe(event, (a, b) => {\n      sub.dispose();\n      return callback(a, b);\n    });\n\n    return sub;\n  }\n};\n\nfunction includeEventsIn(obj) {\n  let ea = new EventAggregator();\n\n  obj.subscribeOnce = function (event, callback) {\n    return ea.subscribeOnce(event, callback);\n  };\n\n  obj.subscribe = function (event, callback) {\n    return ea.subscribe(event, callback);\n  };\n\n  obj.publish = function (event, data) {\n    ea.publish(event, data);\n  };\n\n  return ea;\n}\n\nfunction configure(config) {\n  config.instance(EventAggregator, includeEventsIn(config.aurelia));\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS1ldmVudC1hZ2dyZWdhdG9yLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2F1cmVsaWEtZXZlbnQtYWdncmVnYXRvci9kaXN0L2VzMjAxNS9hdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3IuanM/ODc1MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBMb2dNYW5hZ2VyIGZyb20gJ2F1cmVsaWEtbG9nZ2luZyc7XG5cbmNvbnN0IGxvZ2dlciA9IExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCdldmVudC1hZ2dyZWdhdG9yJyk7XG5cbmxldCBIYW5kbGVyID0gY2xhc3MgSGFuZGxlciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2VUeXBlLCBjYWxsYmFjaykge1xuICAgIHRoaXMubWVzc2FnZVR5cGUgPSBtZXNzYWdlVHlwZTtcbiAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gIH1cblxuICBoYW5kbGUobWVzc2FnZSkge1xuICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgdGhpcy5tZXNzYWdlVHlwZSkge1xuICAgICAgdGhpcy5jYWxsYmFjay5jYWxsKG51bGwsIG1lc3NhZ2UpO1xuICAgIH1cbiAgfVxufTtcblxuXG5mdW5jdGlvbiBpbnZva2VDYWxsYmFjayhjYWxsYmFjaywgZGF0YSwgZXZlbnQpIHtcbiAgdHJ5IHtcbiAgICBjYWxsYmFjayhkYXRhLCBldmVudCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2dnZXIuZXJyb3IoZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW52b2tlSGFuZGxlcihoYW5kbGVyLCBkYXRhKSB7XG4gIHRyeSB7XG4gICAgaGFuZGxlci5oYW5kbGUoZGF0YSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2dnZXIuZXJyb3IoZSk7XG4gIH1cbn1cblxuZXhwb3J0IGxldCBFdmVudEFnZ3JlZ2F0b3IgPSBjbGFzcyBFdmVudEFnZ3JlZ2F0b3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmV2ZW50TG9va3VwID0ge307XG4gICAgdGhpcy5tZXNzYWdlSGFuZGxlcnMgPSBbXTtcbiAgfVxuXG4gIHB1Ymxpc2goZXZlbnQsIGRhdGEpIHtcbiAgICBsZXQgc3Vic2NyaWJlcnM7XG4gICAgbGV0IGk7XG5cbiAgICBpZiAoIWV2ZW50KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V2ZW50IHdhcyBpbnZhbGlkLicpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgZXZlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBzdWJzY3JpYmVycyA9IHRoaXMuZXZlbnRMb29rdXBbZXZlbnRdO1xuICAgICAgaWYgKHN1YnNjcmliZXJzKSB7XG4gICAgICAgIHN1YnNjcmliZXJzID0gc3Vic2NyaWJlcnMuc2xpY2UoKTtcbiAgICAgICAgaSA9IHN1YnNjcmliZXJzLmxlbmd0aDtcblxuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgaW52b2tlQ2FsbGJhY2soc3Vic2NyaWJlcnNbaV0sIGRhdGEsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzdWJzY3JpYmVycyA9IHRoaXMubWVzc2FnZUhhbmRsZXJzLnNsaWNlKCk7XG4gICAgICBpID0gc3Vic2NyaWJlcnMubGVuZ3RoO1xuXG4gICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGludm9rZUhhbmRsZXIoc3Vic2NyaWJlcnNbaV0sIGV2ZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzdWJzY3JpYmUoZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgbGV0IGhhbmRsZXI7XG4gICAgbGV0IHN1YnNjcmliZXJzO1xuXG4gICAgaWYgKCFldmVudCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdFdmVudCBjaGFubmVsL3R5cGUgd2FzIGludmFsaWQuJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBldmVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGhhbmRsZXIgPSBjYWxsYmFjaztcbiAgICAgIHN1YnNjcmliZXJzID0gdGhpcy5ldmVudExvb2t1cFtldmVudF0gfHwgKHRoaXMuZXZlbnRMb29rdXBbZXZlbnRdID0gW10pO1xuICAgIH0gZWxzZSB7XG4gICAgICBoYW5kbGVyID0gbmV3IEhhbmRsZXIoZXZlbnQsIGNhbGxiYWNrKTtcbiAgICAgIHN1YnNjcmliZXJzID0gdGhpcy5tZXNzYWdlSGFuZGxlcnM7XG4gICAgfVxuXG4gICAgc3Vic2NyaWJlcnMucHVzaChoYW5kbGVyKTtcblxuICAgIHJldHVybiB7XG4gICAgICBkaXNwb3NlKCkge1xuICAgICAgICBsZXQgaWR4ID0gc3Vic2NyaWJlcnMuaW5kZXhPZihoYW5kbGVyKTtcbiAgICAgICAgaWYgKGlkeCAhPT0gLTEpIHtcbiAgICAgICAgICBzdWJzY3JpYmVycy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBzdWJzY3JpYmVPbmNlKGV2ZW50LCBjYWxsYmFjaykge1xuICAgIGxldCBzdWIgPSB0aGlzLnN1YnNjcmliZShldmVudCwgKGEsIGIpID0+IHtcbiAgICAgIHN1Yi5kaXNwb3NlKCk7XG4gICAgICByZXR1cm4gY2FsbGJhY2soYSwgYik7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3ViO1xuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gaW5jbHVkZUV2ZW50c0luKG9iaikge1xuICBsZXQgZWEgPSBuZXcgRXZlbnRBZ2dyZWdhdG9yKCk7XG5cbiAgb2JqLnN1YnNjcmliZU9uY2UgPSBmdW5jdGlvbiAoZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIGVhLnN1YnNjcmliZU9uY2UoZXZlbnQsIGNhbGxiYWNrKTtcbiAgfTtcblxuICBvYmouc3Vic2NyaWJlID0gZnVuY3Rpb24gKGV2ZW50LCBjYWxsYmFjaykge1xuICAgIHJldHVybiBlYS5zdWJzY3JpYmUoZXZlbnQsIGNhbGxiYWNrKTtcbiAgfTtcblxuICBvYmoucHVibGlzaCA9IGZ1bmN0aW9uIChldmVudCwgZGF0YSkge1xuICAgIGVhLnB1Ymxpc2goZXZlbnQsIGRhdGEpO1xuICB9O1xuXG4gIHJldHVybiBlYTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbmZpZ3VyZShjb25maWcpIHtcbiAgY29uZmlnLmluc3RhbmNlKEV2ZW50QWdncmVnYXRvciwgaW5jbHVkZUV2ZW50c0luKGNvbmZpZy5hdXJlbGlhKSk7XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///aurelia-event-aggregator\n");

/***/ }),

/***/ "aurelia-framework":
/*!*************************************************************************!*\
  !*** ./node_modules/aurelia-framework/dist/es2015/aurelia-framework.js ***!
  \*************************************************************************/
/*! exports provided: Aurelia, FrameworkConfiguration, resolver, StrategyResolver, Lazy, All, Optional, Parent, Factory, NewInstance, getDecoratorDependencies, lazy, all, optional, parent, factory, newInstance, invoker, invokeAsFactory, FactoryInvoker, registration, transient, singleton, TransientRegistration, SingletonRegistration, _emptyParameters, InvocationHandler, Container, autoinject, inject, targetContext, sourceContext, camelCase, createOverrideContext, getContextFor, createScopeForTest, connectable, enqueueBindingConnect, setConnectQueueThreshold, enableConnectQueue, disableConnectQueue, getConnectQueueSize, subscriberCollection, ExpressionObserver, calcSplices, mergeSplice, projectArraySplices, getChangeRecords, ModifyCollectionObserver, CollectionLengthObserver, getArrayObserver, Expression, BindingBehavior, ValueConverter, Assign, Conditional, AccessThis, AccessScope, AccessMember, AccessKeyed, CallScope, CallMember, CallFunction, Binary, Unary, LiteralPrimitive, LiteralString, LiteralTemplate, LiteralArray, LiteralObject, Unparser, ExpressionCloner, cloneExpression, bindingMode, Parser, ParserImplementation, getMapObserver, delegationStrategy, EventManager, EventSubscriber, DirtyChecker, DirtyCheckProperty, propertyAccessor, PrimitiveObserver, SetterObserver, XLinkAttributeObserver, dataAttributeAccessor, DataAttributeObserver, StyleObserver, ValueAttributeObserver, CheckedObserver, SelectValueObserver, ClassObserver, hasDeclaredDependencies, declarePropertyDependencies, computedFrom, ComputedExpression, createComputedObserver, elements, presentationElements, presentationAttributes, SVGAnalyzer, ObserverLocator, ObjectObservationAdapter, BindingExpression, Binding, CallExpression, Call, ValueConverterResource, valueConverter, BindingBehaviorResource, bindingBehavior, ListenerExpression, Listener, NameExpression, BindingEngine, getSetObserver, observable, connectBindingToSignal, signalBindings, metadata, Origin, decorators, deprecated, mixin, protocol, animationEvent, Animator, CompositionTransactionNotifier, CompositionTransactionOwnershipToken, CompositionTransaction, _hyphenate, _isAllWhitespace, ViewEngineHooksResource, viewEngineHooks, ElementEvents, ResourceLoadContext, ViewCompileInstruction, BehaviorInstruction, TargetInstruction, viewStrategy, RelativeViewStrategy, ConventionalViewStrategy, NoViewStrategy, TemplateRegistryViewStrategy, InlineViewStrategy, StaticViewStrategy, ViewLocator, BindingLanguage, SlotCustomAttribute, PassThroughSlot, ShadowSlot, ShadowDOM, validateBehaviorName, ViewResources, View, ViewSlot, BoundViewFactory, ViewFactory, ViewCompiler, ResourceModule, ResourceDescription, ModuleAnalyzer, ViewEngine, Controller, BehaviorPropertyObserver, BindableProperty, HtmlBehaviorResource, children, child, SwapStrategies, CompositionEngine, ElementConfigResource, resource, behavior, customElement, customAttribute, templateController, bindable, dynamicOptions, useShadowDOM, processAttributes, processContent, containerless, useViewStrategy, useView, inlineView, noView, view, elementConfig, viewResources, TemplatingEngine, TemplateDependency, TemplateRegistryEntry, Loader, TaskQueue, relativeToFile, join, buildQueryString, parseQueryString, AggregateError, FEATURE, PLATFORM, DOM, isInitialized, initializePAL, reset, LogManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Aurelia\", function() { return Aurelia; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FrameworkConfiguration\", function() { return FrameworkConfiguration; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LogManager\", function() { return LogManager; });\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-logging */ \"./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js\");\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-dependency-injection */ \"./node_modules/aurelia-dependency-injection/dist/es2015/aurelia-dependency-injection.js\");\n/* harmony import */ var aurelia_loader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-loader */ \"./node_modules/aurelia-loader/dist/es2015/aurelia-loader.js\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-templating */ \"./node_modules/aurelia-templating/dist/es2015/aurelia-templating.js\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-path */ \"./node_modules/aurelia-path/dist/es2015/aurelia-path.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"resolver\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"resolver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"StrategyResolver\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"StrategyResolver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Lazy\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"Lazy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"All\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"All\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Optional\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"Optional\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Parent\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"Parent\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Factory\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"Factory\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NewInstance\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"NewInstance\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getDecoratorDependencies\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"getDecoratorDependencies\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"lazy\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"lazy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"all\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"all\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"optional\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"optional\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parent\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"parent\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"factory\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"factory\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"newInstance\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"newInstance\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"invoker\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"invoker\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"invokeAsFactory\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"invokeAsFactory\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FactoryInvoker\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"FactoryInvoker\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"registration\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"registration\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"transient\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"transient\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"singleton\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"singleton\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"TransientRegistration\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"TransientRegistration\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SingletonRegistration\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"SingletonRegistration\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"_emptyParameters\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"_emptyParameters\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"InvocationHandler\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"InvocationHandler\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Container\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"Container\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"autoinject\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"autoinject\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"inject\", function() { return aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"inject\"]; });\n\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-binding */ \"./node_modules/aurelia-binding/dist/es2015/aurelia-binding.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"targetContext\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"targetContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"sourceContext\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"sourceContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"camelCase\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"camelCase\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createOverrideContext\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"createOverrideContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getContextFor\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"getContextFor\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createScopeForTest\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"createScopeForTest\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"connectable\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"connectable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"enqueueBindingConnect\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"enqueueBindingConnect\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"setConnectQueueThreshold\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"setConnectQueueThreshold\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"enableConnectQueue\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"enableConnectQueue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"disableConnectQueue\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"disableConnectQueue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getConnectQueueSize\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"getConnectQueueSize\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"subscriberCollection\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"subscriberCollection\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ExpressionObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ExpressionObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"calcSplices\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"calcSplices\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"mergeSplice\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"mergeSplice\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"projectArraySplices\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"projectArraySplices\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getChangeRecords\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"getChangeRecords\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ModifyCollectionObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ModifyCollectionObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CollectionLengthObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"CollectionLengthObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getArrayObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"getArrayObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Expression\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Expression\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BindingBehavior\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"BindingBehavior\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ValueConverter\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ValueConverter\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Assign\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Assign\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Conditional\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Conditional\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AccessThis\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"AccessThis\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AccessScope\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"AccessScope\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AccessMember\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"AccessMember\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AccessKeyed\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"AccessKeyed\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CallScope\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"CallScope\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CallMember\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"CallMember\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CallFunction\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"CallFunction\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Binary\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Binary\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Unary\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Unary\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LiteralPrimitive\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"LiteralPrimitive\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LiteralString\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"LiteralString\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LiteralTemplate\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"LiteralTemplate\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LiteralArray\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"LiteralArray\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LiteralObject\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"LiteralObject\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Unparser\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Unparser\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ExpressionCloner\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ExpressionCloner\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"cloneExpression\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"cloneExpression\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"bindingMode\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"bindingMode\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Parser\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Parser\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ParserImplementation\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ParserImplementation\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getMapObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"getMapObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"delegationStrategy\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"delegationStrategy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"EventManager\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"EventManager\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"EventSubscriber\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"EventSubscriber\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DirtyChecker\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"DirtyChecker\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DirtyCheckProperty\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"DirtyCheckProperty\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"propertyAccessor\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"propertyAccessor\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"PrimitiveObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"PrimitiveObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SetterObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"SetterObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"XLinkAttributeObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"XLinkAttributeObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"dataAttributeAccessor\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"dataAttributeAccessor\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DataAttributeObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"DataAttributeObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"StyleObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"StyleObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ValueAttributeObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ValueAttributeObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CheckedObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"CheckedObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SelectValueObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"SelectValueObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ClassObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ClassObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"hasDeclaredDependencies\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"hasDeclaredDependencies\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"declarePropertyDependencies\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"declarePropertyDependencies\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"computedFrom\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"computedFrom\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ComputedExpression\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ComputedExpression\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"createComputedObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"createComputedObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"elements\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"elements\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"presentationElements\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"presentationElements\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"presentationAttributes\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"presentationAttributes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SVGAnalyzer\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"SVGAnalyzer\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ObserverLocator\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ObserverLocator\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ObjectObservationAdapter\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ObjectObservationAdapter\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BindingExpression\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"BindingExpression\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Binding\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Binding\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CallExpression\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"CallExpression\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Call\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Call\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ValueConverterResource\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ValueConverterResource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"valueConverter\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"valueConverter\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BindingBehaviorResource\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"BindingBehaviorResource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"bindingBehavior\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"bindingBehavior\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ListenerExpression\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"ListenerExpression\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Listener\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"Listener\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NameExpression\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"NameExpression\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BindingEngine\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"BindingEngine\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"getSetObserver\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"getSetObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"observable\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"observable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"connectBindingToSignal\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"connectBindingToSignal\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"signalBindings\", function() { return aurelia_binding__WEBPACK_IMPORTED_MODULE_6__[\"signalBindings\"]; });\n\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-metadata */ \"./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"metadata\", function() { return aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"metadata\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Origin\", function() { return aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"Origin\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"decorators\", function() { return aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"decorators\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"deprecated\", function() { return aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"deprecated\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"mixin\", function() { return aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"mixin\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"protocol\", function() { return aurelia_metadata__WEBPACK_IMPORTED_MODULE_7__[\"protocol\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"animationEvent\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"animationEvent\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Animator\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Animator\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CompositionTransactionNotifier\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionTransactionNotifier\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CompositionTransactionOwnershipToken\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionTransactionOwnershipToken\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CompositionTransaction\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionTransaction\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"_hyphenate\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"_hyphenate\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"_isAllWhitespace\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"_isAllWhitespace\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ViewEngineHooksResource\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngineHooksResource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"viewEngineHooks\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"viewEngineHooks\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ElementEvents\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ElementEvents\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ResourceLoadContext\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ResourceLoadContext\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ViewCompileInstruction\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewCompileInstruction\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BehaviorInstruction\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BehaviorInstruction\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"TargetInstruction\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"TargetInstruction\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"viewStrategy\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"viewStrategy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"RelativeViewStrategy\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"RelativeViewStrategy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ConventionalViewStrategy\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ConventionalViewStrategy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"NoViewStrategy\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"NoViewStrategy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"TemplateRegistryViewStrategy\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"TemplateRegistryViewStrategy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"InlineViewStrategy\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"InlineViewStrategy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"StaticViewStrategy\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"StaticViewStrategy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ViewLocator\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewLocator\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BindingLanguage\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BindingLanguage\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SlotCustomAttribute\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SlotCustomAttribute\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"PassThroughSlot\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"PassThroughSlot\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ShadowSlot\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ShadowSlot\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ShadowDOM\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ShadowDOM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"validateBehaviorName\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"validateBehaviorName\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ViewResources\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"View\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"View\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ViewSlot\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BoundViewFactory\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ViewFactory\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewFactory\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ViewCompiler\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewCompiler\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ResourceModule\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ResourceModule\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ResourceDescription\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ResourceDescription\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ModuleAnalyzer\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ModuleAnalyzer\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ViewEngine\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Controller\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Controller\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BehaviorPropertyObserver\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BehaviorPropertyObserver\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"BindableProperty\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BindableProperty\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"HtmlBehaviorResource\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"HtmlBehaviorResource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"children\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"children\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"child\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"child\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SwapStrategies\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SwapStrategies\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CompositionEngine\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ElementConfigResource\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ElementConfigResource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"resource\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"resource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"behavior\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"behavior\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"customElement\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"customAttribute\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"templateController\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"bindable\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"dynamicOptions\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"dynamicOptions\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"useShadowDOM\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"processAttributes\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"processAttributes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"processContent\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"processContent\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"containerless\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"containerless\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"useViewStrategy\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useViewStrategy\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"useView\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useView\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"inlineView\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"inlineView\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"noView\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"noView\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"view\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"view\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"elementConfig\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"elementConfig\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"viewResources\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"viewResources\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"TemplatingEngine\", function() { return aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"TemplatingEngine\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"TemplateDependency\", function() { return aurelia_loader__WEBPACK_IMPORTED_MODULE_2__[\"TemplateDependency\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"TemplateRegistryEntry\", function() { return aurelia_loader__WEBPACK_IMPORTED_MODULE_2__[\"TemplateRegistryEntry\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Loader\", function() { return aurelia_loader__WEBPACK_IMPORTED_MODULE_2__[\"Loader\"]; });\n\n/* harmony import */ var aurelia_task_queue__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! aurelia-task-queue */ \"./node_modules/aurelia-task-queue/dist/es2015/aurelia-task-queue.js\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"TaskQueue\", function() { return aurelia_task_queue__WEBPACK_IMPORTED_MODULE_8__[\"TaskQueue\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"relativeToFile\", function() { return aurelia_path__WEBPACK_IMPORTED_MODULE_5__[\"relativeToFile\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"join\", function() { return aurelia_path__WEBPACK_IMPORTED_MODULE_5__[\"join\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"buildQueryString\", function() { return aurelia_path__WEBPACK_IMPORTED_MODULE_5__[\"buildQueryString\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"parseQueryString\", function() { return aurelia_path__WEBPACK_IMPORTED_MODULE_5__[\"parseQueryString\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AggregateError\", function() { return aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"AggregateError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FEATURE\", function() { return aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"FEATURE\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"PLATFORM\", function() { return aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"PLATFORM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DOM\", function() { return aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"DOM\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"isInitialized\", function() { return aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"isInitialized\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"initializePAL\", function() { return aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"initializePAL\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"reset\", function() { return aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"reset\"]; });\n\n\n\n\n\n\n\n\nfunction preventActionlessFormSubmit() {\n  aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"DOM\"].addEventListener('submit', evt => {\n    const target = evt.target;\n    const action = target.action;\n\n    if (target.tagName.toLowerCase() === 'form' && !action) {\n      evt.preventDefault();\n    }\n  });\n}\n\nlet Aurelia = class Aurelia {\n  constructor(loader, container, resources) {\n    this.loader = loader || new aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"PLATFORM\"].Loader();\n    this.container = container || new aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_1__[\"Container\"]().makeGlobal();\n    this.resources = resources || new aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"]();\n    this.use = new FrameworkConfiguration(this);\n    this.logger = aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('aurelia');\n    this.hostConfigured = false;\n    this.host = null;\n\n    this.use.instance(Aurelia, this);\n    this.use.instance(aurelia_loader__WEBPACK_IMPORTED_MODULE_2__[\"Loader\"], this.loader);\n    this.use.instance(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"], this.resources);\n  }\n\n  start() {\n    if (this._started) {\n      return this._started;\n    }\n\n    this.logger.info('Aurelia Starting');\n    return this._started = this.use.apply().then(() => {\n      preventActionlessFormSubmit();\n\n      if (!this.container.hasResolver(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BindingLanguage\"])) {\n        let message = 'You must configure Aurelia with a BindingLanguage implementation.';\n        this.logger.error(message);\n        throw new Error(message);\n      }\n\n      this.logger.info('Aurelia Started');\n      let evt = aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"DOM\"].createCustomEvent('aurelia-started', { bubbles: true, cancelable: true });\n      aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"DOM\"].dispatchEvent(evt);\n      return this;\n    });\n  }\n\n  enhance(bindingContext = {}, applicationHost = null) {\n    this._configureHost(applicationHost || aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"DOM\"].querySelectorAll('body')[0]);\n\n    return new Promise(resolve => {\n      let engine = this.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"TemplatingEngine\"]);\n      this.root = engine.enhance({ container: this.container, element: this.host, resources: this.resources, bindingContext: bindingContext });\n      this.root.attached();\n      this._onAureliaComposed();\n      resolve(this);\n    });\n  }\n\n  setRoot(root = null, applicationHost = null) {\n    let instruction = {};\n\n    if (this.root && this.root.viewModel && this.root.viewModel.router) {\n      this.root.viewModel.router.deactivate();\n      this.root.viewModel.router.reset();\n    }\n\n    this._configureHost(applicationHost);\n\n    let engine = this.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"TemplatingEngine\"]);\n    let transaction = this.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionTransaction\"]);\n    delete transaction.initialComposition;\n\n    if (!root) {\n      if (this.configModuleId) {\n        root = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_5__[\"relativeToFile\"])('./app', this.configModuleId);\n      } else {\n        root = 'app';\n      }\n    }\n\n    instruction.viewModel = root;\n    instruction.container = instruction.childContainer = this.container;\n    instruction.viewSlot = this.hostSlot;\n    instruction.host = this.host;\n\n    return engine.compose(instruction).then(r => {\n      this.root = r;\n      instruction.viewSlot.attached();\n      this._onAureliaComposed();\n      return this;\n    });\n  }\n\n  _configureHost(applicationHost) {\n    if (this.hostConfigured) {\n      return;\n    }\n    applicationHost = applicationHost || this.host;\n\n    if (!applicationHost || typeof applicationHost === 'string') {\n      this.host = aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"DOM\"].getElementById(applicationHost || 'applicationHost');\n    } else {\n      this.host = applicationHost;\n    }\n\n    if (!this.host) {\n      throw new Error('No applicationHost was specified.');\n    }\n\n    this.hostConfigured = true;\n    this.host.aurelia = this;\n    this.hostSlot = new aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"](this.host, true);\n    this.hostSlot.transformChildNodesIntoView();\n    this.container.registerInstance(aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"DOM\"].boundary, this.host);\n  }\n\n  _onAureliaComposed() {\n    let evt = aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"DOM\"].createCustomEvent('aurelia-composed', { bubbles: true, cancelable: true });\n    setTimeout(() => aurelia_pal__WEBPACK_IMPORTED_MODULE_4__[\"DOM\"].dispatchEvent(evt), 1);\n  }\n};\n\nconst logger = aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('aurelia');\nconst extPattern = /\\.[^/.]+$/;\n\nfunction runTasks(config, tasks) {\n  let current;\n  let next = () => {\n    current = tasks.shift();\n    if (current) {\n      return Promise.resolve(current(config)).then(next);\n    }\n\n    return Promise.resolve();\n  };\n\n  return next();\n}\n\nfunction loadPlugin(fwConfig, loader, info) {\n  logger.debug(`Loading plugin ${info.moduleId}.`);\n  if (typeof info.moduleId === 'string') {\n    fwConfig.resourcesRelativeTo = info.resourcesRelativeTo;\n\n    let id = info.moduleId;\n\n    if (info.resourcesRelativeTo.length > 1) {\n      return loader.normalize(info.moduleId, info.resourcesRelativeTo[1]).then(normalizedId => _loadPlugin(normalizedId));\n    }\n\n    return _loadPlugin(id);\n  } else if (typeof info.configure === 'function') {\n    if (fwConfig.configuredPlugins.indexOf(info.configure) !== -1) {\n      return Promise.resolve();\n    }\n    fwConfig.configuredPlugins.push(info.configure);\n\n    return Promise.resolve(info.configure.call(null, fwConfig, info.config || {}));\n  }\n  throw new Error(invalidConfigMsg(info.moduleId || info.configure, 'plugin'));\n\n  function _loadPlugin(moduleId) {\n    return loader.loadModule(moduleId).then(m => {\n      if ('configure' in m) {\n        if (fwConfig.configuredPlugins.indexOf(m.configure) !== -1) {\n          return Promise.resolve();\n        }\n        return Promise.resolve(m.configure(fwConfig, info.config || {})).then(() => {\n          fwConfig.configuredPlugins.push(m.configure);\n          fwConfig.resourcesRelativeTo = null;\n          logger.debug(`Configured plugin ${info.moduleId}.`);\n        });\n      }\n\n      fwConfig.resourcesRelativeTo = null;\n      logger.debug(`Loaded plugin ${info.moduleId}.`);\n    });\n  }\n}\n\nfunction loadResources(aurelia, resourcesToLoad, appResources) {\n  if (Object.keys(resourcesToLoad).length === 0) {\n    return Promise.resolve();\n  }\n  let viewEngine = aurelia.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]);\n\n  return Promise.all(Object.keys(resourcesToLoad).map(n => _normalize(resourcesToLoad[n]))).then(loads => {\n    let names = [];\n    let importIds = [];\n\n    loads.forEach(l => {\n      names.push(undefined);\n      importIds.push(l.importId);\n    });\n\n    return viewEngine.importViewResources(importIds, names, appResources);\n  });\n\n  function _normalize(load) {\n    let moduleId = load.moduleId;\n    let ext = getExt(moduleId);\n\n    if (isOtherResource(moduleId)) {\n      moduleId = removeExt(moduleId);\n    }\n\n    return aurelia.loader.normalize(moduleId, load.relativeTo).then(normalized => {\n      return {\n        name: load.moduleId,\n        importId: isOtherResource(load.moduleId) ? addOriginalExt(normalized, ext) : normalized\n      };\n    });\n  }\n\n  function isOtherResource(name) {\n    let ext = getExt(name);\n    if (!ext) return false;\n    if (ext === '') return false;\n    if (ext === '.js' || ext === '.ts') return false;\n    return true;\n  }\n\n  function removeExt(name) {\n    return name.replace(extPattern, '');\n  }\n\n  function addOriginalExt(normalized, ext) {\n    return removeExt(normalized) + '.' + ext;\n  }\n}\n\nfunction getExt(name) {\n  let match = name.match(extPattern);\n  if (match && match.length > 0) {\n    return match[0].split('.')[1];\n  }\n}\n\nfunction loadBehaviors(config) {\n  return Promise.all(config.behaviorsToLoad.map(m => m.load(config.container, m.target))).then(() => {\n    config.behaviorsToLoad = null;\n  });\n}\n\nfunction assertProcessed(plugins) {\n  if (plugins.processed) {\n    throw new Error('This config instance has already been applied. To load more plugins or global resources, create a new FrameworkConfiguration instance.');\n  }\n}\n\nfunction invalidConfigMsg(cfg, type) {\n  return `Invalid ${type} [${cfg}], ${type} must be specified as functions or relative module IDs.`;\n}\n\nlet FrameworkConfiguration = class FrameworkConfiguration {\n  constructor(aurelia) {\n    this.aurelia = aurelia;\n    this.container = aurelia.container;\n\n    this.info = [];\n    this.processed = false;\n    this.preTasks = [];\n    this.postTasks = [];\n\n    this.behaviorsToLoad = [];\n\n    this.configuredPlugins = [];\n    this.resourcesToLoad = {};\n    this.preTask(() => aurelia.loader.normalize('aurelia-bootstrapper').then(name => this.bootstrapperName = name));\n    this.postTask(() => loadResources(aurelia, this.resourcesToLoad, aurelia.resources));\n  }\n\n  instance(type, instance) {\n    this.container.registerInstance(type, instance);\n    return this;\n  }\n\n  singleton(type, implementation) {\n    this.container.registerSingleton(type, implementation);\n    return this;\n  }\n\n  transient(type, implementation) {\n    this.container.registerTransient(type, implementation);\n    return this;\n  }\n\n  preTask(task) {\n    assertProcessed(this);\n    this.preTasks.push(task);\n    return this;\n  }\n\n  postTask(task) {\n    assertProcessed(this);\n    this.postTasks.push(task);\n    return this;\n  }\n\n  feature(plugin, config = {}) {\n    switch (typeof plugin) {\n      case 'string':\n        let hasIndex = /\\/index$/i.test(plugin);\n        let moduleId = hasIndex || getExt(plugin) ? plugin : plugin + '/index';\n        let root = hasIndex ? plugin.substr(0, plugin.length - 6) : plugin;\n        this.info.push({ moduleId, resourcesRelativeTo: [root, ''], config });\n        break;\n\n      case 'function':\n        this.info.push({ configure: plugin, config: config || {} });\n        break;\n      default:\n        throw new Error(invalidConfigMsg(plugin, 'feature'));\n    }\n    return this;\n  }\n\n  globalResources(resources) {\n    assertProcessed(this);\n\n    let toAdd = Array.isArray(resources) ? resources : arguments;\n    let resource;\n    let resourcesRelativeTo = this.resourcesRelativeTo || ['', ''];\n\n    for (let i = 0, ii = toAdd.length; i < ii; ++i) {\n      resource = toAdd[i];\n      switch (typeof resource) {\n        case 'string':\n          let parent = resourcesRelativeTo[0];\n          let grandParent = resourcesRelativeTo[1];\n          let name = resource;\n\n          if ((resource.startsWith('./') || resource.startsWith('../')) && parent !== '') {\n            name = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_5__[\"join\"])(parent, resource);\n          }\n\n          this.resourcesToLoad[name] = { moduleId: name, relativeTo: grandParent };\n          break;\n        case 'function':\n          let meta = this.aurelia.resources.autoRegister(this.container, resource);\n          if (meta instanceof aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"HtmlBehaviorResource\"] && meta.elementName !== null) {\n            if (this.behaviorsToLoad.push(meta) === 1) {\n              this.postTask(() => loadBehaviors(this));\n            }\n          }\n          break;\n        default:\n          throw new Error(invalidConfigMsg(resource, 'resource'));\n      }\n    }\n\n    return this;\n  }\n\n  globalName(resourcePath, newName) {\n    assertProcessed(this);\n    this.resourcesToLoad[resourcePath] = { moduleId: newName, relativeTo: '' };\n    return this;\n  }\n\n  plugin(plugin, pluginConfig) {\n    assertProcessed(this);\n\n    let info;\n    switch (typeof plugin) {\n      case 'string':\n        info = { moduleId: plugin, resourcesRelativeTo: [plugin, ''], config: pluginConfig || {} };\n        break;\n      case 'function':\n        info = { configure: plugin, config: pluginConfig || {} };\n        break;\n      default:\n        throw new Error(invalidConfigMsg(plugin, 'plugin'));\n    }\n    this.info.push(info);\n    return this;\n  }\n\n  _addNormalizedPlugin(name, config) {\n    let plugin = { moduleId: name, resourcesRelativeTo: [name, ''], config: config || {} };\n    this.info.push(plugin);\n\n    this.preTask(() => {\n      let relativeTo = [name, this.bootstrapperName];\n      plugin.moduleId = name;\n      plugin.resourcesRelativeTo = relativeTo;\n      return Promise.resolve();\n    });\n\n    return this;\n  }\n\n  defaultBindingLanguage() {\n    return this._addNormalizedPlugin('aurelia-templating-binding');\n  }\n\n  router() {\n    return this._addNormalizedPlugin('aurelia-templating-router');\n  }\n\n  history() {\n    return this._addNormalizedPlugin('aurelia-history-browser');\n  }\n\n  defaultResources() {\n    return this._addNormalizedPlugin('aurelia-templating-resources');\n  }\n\n  eventAggregator() {\n    return this._addNormalizedPlugin('aurelia-event-aggregator');\n  }\n\n  basicConfiguration() {\n    return this.defaultBindingLanguage().defaultResources().eventAggregator();\n  }\n\n  standardConfiguration() {\n    return this.basicConfiguration().history().router();\n  }\n\n  developmentLogging(level) {\n    let logLevel = level ? aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"logLevel\"][level] : undefined;\n\n    if (logLevel === undefined) {\n      logLevel = aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"logLevel\"].debug;\n    }\n\n    this.preTask(() => {\n      return this.aurelia.loader.normalize('aurelia-logging-console', this.bootstrapperName).then(name => {\n        return this.aurelia.loader.loadModule(name).then(m => {\n          aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"addAppender\"](new m.ConsoleAppender());\n          aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"setLevel\"](logLevel);\n        });\n      });\n    });\n\n    return this;\n  }\n\n  apply() {\n    if (this.processed) {\n      return Promise.resolve();\n    }\n\n    return runTasks(this, this.preTasks).then(() => {\n      let loader = this.aurelia.loader;\n      let info = this.info;\n      let current;\n\n      let next = () => {\n        current = info.shift();\n        if (current) {\n          return loadPlugin(this, loader, current).then(next);\n        }\n\n        this.processed = true;\n        this.configuredPlugins = null;\n        return Promise.resolve();\n      };\n\n      return next().then(() => runTasks(this, this.postTasks));\n    });\n  }\n};\n\n\n\n\n\n\n\n\n\n\nconst LogManager = aurelia_logging__WEBPACK_IMPORTED_MODULE_0__;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS1mcmFtZXdvcmsuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1mcmFtZXdvcmsvZGlzdC9lczIwMTUvYXVyZWxpYS1mcmFtZXdvcmsuanM/YzVmZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBUaGVMb2dNYW5hZ2VyIGZyb20gJ2F1cmVsaWEtbG9nZ2luZyc7XG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tICdhdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uJztcbmltcG9ydCB7IExvYWRlciB9IGZyb20gJ2F1cmVsaWEtbG9hZGVyJztcbmltcG9ydCB7IEJpbmRpbmdMYW5ndWFnZSwgVmlld1Nsb3QsIFZpZXdSZXNvdXJjZXMsIFRlbXBsYXRpbmdFbmdpbmUsIENvbXBvc2l0aW9uVHJhbnNhY3Rpb24sIFZpZXdFbmdpbmUsIEh0bWxCZWhhdmlvclJlc291cmNlIH0gZnJvbSAnYXVyZWxpYS10ZW1wbGF0aW5nJztcbmltcG9ydCB7IERPTSwgUExBVEZPUk0gfSBmcm9tICdhdXJlbGlhLXBhbCc7XG5pbXBvcnQgeyByZWxhdGl2ZVRvRmlsZSwgam9pbiB9IGZyb20gJ2F1cmVsaWEtcGF0aCc7XG5cbmZ1bmN0aW9uIHByZXZlbnRBY3Rpb25sZXNzRm9ybVN1Ym1pdCgpIHtcbiAgRE9NLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGV2dCA9PiB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcbiAgICBjb25zdCBhY3Rpb24gPSB0YXJnZXQuYWN0aW9uO1xuXG4gICAgaWYgKHRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdmb3JtJyAmJiAhYWN0aW9uKSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH0pO1xufVxuXG5leHBvcnQgbGV0IEF1cmVsaWEgPSBjbGFzcyBBdXJlbGlhIHtcbiAgY29uc3RydWN0b3IobG9hZGVyLCBjb250YWluZXIsIHJlc291cmNlcykge1xuICAgIHRoaXMubG9hZGVyID0gbG9hZGVyIHx8IG5ldyBQTEFURk9STS5Mb2FkZXIoKTtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lciB8fCBuZXcgQ29udGFpbmVyKCkubWFrZUdsb2JhbCgpO1xuICAgIHRoaXMucmVzb3VyY2VzID0gcmVzb3VyY2VzIHx8IG5ldyBWaWV3UmVzb3VyY2VzKCk7XG4gICAgdGhpcy51c2UgPSBuZXcgRnJhbWV3b3JrQ29uZmlndXJhdGlvbih0aGlzKTtcbiAgICB0aGlzLmxvZ2dlciA9IFRoZUxvZ01hbmFnZXIuZ2V0TG9nZ2VyKCdhdXJlbGlhJyk7XG4gICAgdGhpcy5ob3N0Q29uZmlndXJlZCA9IGZhbHNlO1xuICAgIHRoaXMuaG9zdCA9IG51bGw7XG5cbiAgICB0aGlzLnVzZS5pbnN0YW5jZShBdXJlbGlhLCB0aGlzKTtcbiAgICB0aGlzLnVzZS5pbnN0YW5jZShMb2FkZXIsIHRoaXMubG9hZGVyKTtcbiAgICB0aGlzLnVzZS5pbnN0YW5jZShWaWV3UmVzb3VyY2VzLCB0aGlzLnJlc291cmNlcyk7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICBpZiAodGhpcy5fc3RhcnRlZCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3N0YXJ0ZWQ7XG4gICAgfVxuXG4gICAgdGhpcy5sb2dnZXIuaW5mbygnQXVyZWxpYSBTdGFydGluZycpO1xuICAgIHJldHVybiB0aGlzLl9zdGFydGVkID0gdGhpcy51c2UuYXBwbHkoKS50aGVuKCgpID0+IHtcbiAgICAgIHByZXZlbnRBY3Rpb25sZXNzRm9ybVN1Ym1pdCgpO1xuXG4gICAgICBpZiAoIXRoaXMuY29udGFpbmVyLmhhc1Jlc29sdmVyKEJpbmRpbmdMYW5ndWFnZSkpIHtcbiAgICAgICAgbGV0IG1lc3NhZ2UgPSAnWW91IG11c3QgY29uZmlndXJlIEF1cmVsaWEgd2l0aCBhIEJpbmRpbmdMYW5ndWFnZSBpbXBsZW1lbnRhdGlvbi4nO1xuICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihtZXNzYWdlKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmxvZ2dlci5pbmZvKCdBdXJlbGlhIFN0YXJ0ZWQnKTtcbiAgICAgIGxldCBldnQgPSBET00uY3JlYXRlQ3VzdG9tRXZlbnQoJ2F1cmVsaWEtc3RhcnRlZCcsIHsgYnViYmxlczogdHJ1ZSwgY2FuY2VsYWJsZTogdHJ1ZSB9KTtcbiAgICAgIERPTS5kaXNwYXRjaEV2ZW50KGV2dCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9KTtcbiAgfVxuXG4gIGVuaGFuY2UoYmluZGluZ0NvbnRleHQgPSB7fSwgYXBwbGljYXRpb25Ib3N0ID0gbnVsbCkge1xuICAgIHRoaXMuX2NvbmZpZ3VyZUhvc3QoYXBwbGljYXRpb25Ib3N0IHx8IERPTS5xdWVyeVNlbGVjdG9yQWxsKCdib2R5JylbMF0pO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgbGV0IGVuZ2luZSA9IHRoaXMuY29udGFpbmVyLmdldChUZW1wbGF0aW5nRW5naW5lKTtcbiAgICAgIHRoaXMucm9vdCA9IGVuZ2luZS5lbmhhbmNlKHsgY29udGFpbmVyOiB0aGlzLmNvbnRhaW5lciwgZWxlbWVudDogdGhpcy5ob3N0LCByZXNvdXJjZXM6IHRoaXMucmVzb3VyY2VzLCBiaW5kaW5nQ29udGV4dDogYmluZGluZ0NvbnRleHQgfSk7XG4gICAgICB0aGlzLnJvb3QuYXR0YWNoZWQoKTtcbiAgICAgIHRoaXMuX29uQXVyZWxpYUNvbXBvc2VkKCk7XG4gICAgICByZXNvbHZlKHRoaXMpO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0Um9vdChyb290ID0gbnVsbCwgYXBwbGljYXRpb25Ib3N0ID0gbnVsbCkge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IHt9O1xuXG4gICAgaWYgKHRoaXMucm9vdCAmJiB0aGlzLnJvb3Qudmlld01vZGVsICYmIHRoaXMucm9vdC52aWV3TW9kZWwucm91dGVyKSB7XG4gICAgICB0aGlzLnJvb3Qudmlld01vZGVsLnJvdXRlci5kZWFjdGl2YXRlKCk7XG4gICAgICB0aGlzLnJvb3Qudmlld01vZGVsLnJvdXRlci5yZXNldCgpO1xuICAgIH1cblxuICAgIHRoaXMuX2NvbmZpZ3VyZUhvc3QoYXBwbGljYXRpb25Ib3N0KTtcblxuICAgIGxldCBlbmdpbmUgPSB0aGlzLmNvbnRhaW5lci5nZXQoVGVtcGxhdGluZ0VuZ2luZSk7XG4gICAgbGV0IHRyYW5zYWN0aW9uID0gdGhpcy5jb250YWluZXIuZ2V0KENvbXBvc2l0aW9uVHJhbnNhY3Rpb24pO1xuICAgIGRlbGV0ZSB0cmFuc2FjdGlvbi5pbml0aWFsQ29tcG9zaXRpb247XG5cbiAgICBpZiAoIXJvb3QpIHtcbiAgICAgIGlmICh0aGlzLmNvbmZpZ01vZHVsZUlkKSB7XG4gICAgICAgIHJvb3QgPSByZWxhdGl2ZVRvRmlsZSgnLi9hcHAnLCB0aGlzLmNvbmZpZ01vZHVsZUlkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJvb3QgPSAnYXBwJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpbnN0cnVjdGlvbi52aWV3TW9kZWwgPSByb290O1xuICAgIGluc3RydWN0aW9uLmNvbnRhaW5lciA9IGluc3RydWN0aW9uLmNoaWxkQ29udGFpbmVyID0gdGhpcy5jb250YWluZXI7XG4gICAgaW5zdHJ1Y3Rpb24udmlld1Nsb3QgPSB0aGlzLmhvc3RTbG90O1xuICAgIGluc3RydWN0aW9uLmhvc3QgPSB0aGlzLmhvc3Q7XG5cbiAgICByZXR1cm4gZW5naW5lLmNvbXBvc2UoaW5zdHJ1Y3Rpb24pLnRoZW4ociA9PiB7XG4gICAgICB0aGlzLnJvb3QgPSByO1xuICAgICAgaW5zdHJ1Y3Rpb24udmlld1Nsb3QuYXR0YWNoZWQoKTtcbiAgICAgIHRoaXMuX29uQXVyZWxpYUNvbXBvc2VkKCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9KTtcbiAgfVxuXG4gIF9jb25maWd1cmVIb3N0KGFwcGxpY2F0aW9uSG9zdCkge1xuICAgIGlmICh0aGlzLmhvc3RDb25maWd1cmVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGFwcGxpY2F0aW9uSG9zdCA9IGFwcGxpY2F0aW9uSG9zdCB8fCB0aGlzLmhvc3Q7XG5cbiAgICBpZiAoIWFwcGxpY2F0aW9uSG9zdCB8fCB0eXBlb2YgYXBwbGljYXRpb25Ib3N0ID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5ob3N0ID0gRE9NLmdldEVsZW1lbnRCeUlkKGFwcGxpY2F0aW9uSG9zdCB8fCAnYXBwbGljYXRpb25Ib3N0Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaG9zdCA9IGFwcGxpY2F0aW9uSG9zdDtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuaG9zdCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhcHBsaWNhdGlvbkhvc3Qgd2FzIHNwZWNpZmllZC4nKTtcbiAgICB9XG5cbiAgICB0aGlzLmhvc3RDb25maWd1cmVkID0gdHJ1ZTtcbiAgICB0aGlzLmhvc3QuYXVyZWxpYSA9IHRoaXM7XG4gICAgdGhpcy5ob3N0U2xvdCA9IG5ldyBWaWV3U2xvdCh0aGlzLmhvc3QsIHRydWUpO1xuICAgIHRoaXMuaG9zdFNsb3QudHJhbnNmb3JtQ2hpbGROb2Rlc0ludG9WaWV3KCk7XG4gICAgdGhpcy5jb250YWluZXIucmVnaXN0ZXJJbnN0YW5jZShET00uYm91bmRhcnksIHRoaXMuaG9zdCk7XG4gIH1cblxuICBfb25BdXJlbGlhQ29tcG9zZWQoKSB7XG4gICAgbGV0IGV2dCA9IERPTS5jcmVhdGVDdXN0b21FdmVudCgnYXVyZWxpYS1jb21wb3NlZCcsIHsgYnViYmxlczogdHJ1ZSwgY2FuY2VsYWJsZTogdHJ1ZSB9KTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IERPTS5kaXNwYXRjaEV2ZW50KGV2dCksIDEpO1xuICB9XG59O1xuXG5jb25zdCBsb2dnZXIgPSBUaGVMb2dNYW5hZ2VyLmdldExvZ2dlcignYXVyZWxpYScpO1xuY29uc3QgZXh0UGF0dGVybiA9IC9cXC5bXi8uXSskLztcblxuZnVuY3Rpb24gcnVuVGFza3MoY29uZmlnLCB0YXNrcykge1xuICBsZXQgY3VycmVudDtcbiAgbGV0IG5leHQgPSAoKSA9PiB7XG4gICAgY3VycmVudCA9IHRhc2tzLnNoaWZ0KCk7XG4gICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoY3VycmVudChjb25maWcpKS50aGVuKG5leHQpO1xuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfTtcblxuICByZXR1cm4gbmV4dCgpO1xufVxuXG5mdW5jdGlvbiBsb2FkUGx1Z2luKGZ3Q29uZmlnLCBsb2FkZXIsIGluZm8pIHtcbiAgbG9nZ2VyLmRlYnVnKGBMb2FkaW5nIHBsdWdpbiAke2luZm8ubW9kdWxlSWR9LmApO1xuICBpZiAodHlwZW9mIGluZm8ubW9kdWxlSWQgPT09ICdzdHJpbmcnKSB7XG4gICAgZndDb25maWcucmVzb3VyY2VzUmVsYXRpdmVUbyA9IGluZm8ucmVzb3VyY2VzUmVsYXRpdmVUbztcblxuICAgIGxldCBpZCA9IGluZm8ubW9kdWxlSWQ7XG5cbiAgICBpZiAoaW5mby5yZXNvdXJjZXNSZWxhdGl2ZVRvLmxlbmd0aCA+IDEpIHtcbiAgICAgIHJldHVybiBsb2FkZXIubm9ybWFsaXplKGluZm8ubW9kdWxlSWQsIGluZm8ucmVzb3VyY2VzUmVsYXRpdmVUb1sxXSkudGhlbihub3JtYWxpemVkSWQgPT4gX2xvYWRQbHVnaW4obm9ybWFsaXplZElkKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIF9sb2FkUGx1Z2luKGlkKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgaW5mby5jb25maWd1cmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICBpZiAoZndDb25maWcuY29uZmlndXJlZFBsdWdpbnMuaW5kZXhPZihpbmZvLmNvbmZpZ3VyZSkgIT09IC0xKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGZ3Q29uZmlnLmNvbmZpZ3VyZWRQbHVnaW5zLnB1c2goaW5mby5jb25maWd1cmUpO1xuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShpbmZvLmNvbmZpZ3VyZS5jYWxsKG51bGwsIGZ3Q29uZmlnLCBpbmZvLmNvbmZpZyB8fCB7fSkpO1xuICB9XG4gIHRocm93IG5ldyBFcnJvcihpbnZhbGlkQ29uZmlnTXNnKGluZm8ubW9kdWxlSWQgfHwgaW5mby5jb25maWd1cmUsICdwbHVnaW4nKSk7XG5cbiAgZnVuY3Rpb24gX2xvYWRQbHVnaW4obW9kdWxlSWQpIHtcbiAgICByZXR1cm4gbG9hZGVyLmxvYWRNb2R1bGUobW9kdWxlSWQpLnRoZW4obSA9PiB7XG4gICAgICBpZiAoJ2NvbmZpZ3VyZScgaW4gbSkge1xuICAgICAgICBpZiAoZndDb25maWcuY29uZmlndXJlZFBsdWdpbnMuaW5kZXhPZihtLmNvbmZpZ3VyZSkgIT09IC0xKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobS5jb25maWd1cmUoZndDb25maWcsIGluZm8uY29uZmlnIHx8IHt9KSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgZndDb25maWcuY29uZmlndXJlZFBsdWdpbnMucHVzaChtLmNvbmZpZ3VyZSk7XG4gICAgICAgICAgZndDb25maWcucmVzb3VyY2VzUmVsYXRpdmVUbyA9IG51bGw7XG4gICAgICAgICAgbG9nZ2VyLmRlYnVnKGBDb25maWd1cmVkIHBsdWdpbiAke2luZm8ubW9kdWxlSWR9LmApO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZndDb25maWcucmVzb3VyY2VzUmVsYXRpdmVUbyA9IG51bGw7XG4gICAgICBsb2dnZXIuZGVidWcoYExvYWRlZCBwbHVnaW4gJHtpbmZvLm1vZHVsZUlkfS5gKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBsb2FkUmVzb3VyY2VzKGF1cmVsaWEsIHJlc291cmNlc1RvTG9hZCwgYXBwUmVzb3VyY2VzKSB7XG4gIGlmIChPYmplY3Qua2V5cyhyZXNvdXJjZXNUb0xvYWQpLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuICBsZXQgdmlld0VuZ2luZSA9IGF1cmVsaWEuY29udGFpbmVyLmdldChWaWV3RW5naW5lKTtcblxuICByZXR1cm4gUHJvbWlzZS5hbGwoT2JqZWN0LmtleXMocmVzb3VyY2VzVG9Mb2FkKS5tYXAobiA9PiBfbm9ybWFsaXplKHJlc291cmNlc1RvTG9hZFtuXSkpKS50aGVuKGxvYWRzID0+IHtcbiAgICBsZXQgbmFtZXMgPSBbXTtcbiAgICBsZXQgaW1wb3J0SWRzID0gW107XG5cbiAgICBsb2Fkcy5mb3JFYWNoKGwgPT4ge1xuICAgICAgbmFtZXMucHVzaCh1bmRlZmluZWQpO1xuICAgICAgaW1wb3J0SWRzLnB1c2gobC5pbXBvcnRJZCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdmlld0VuZ2luZS5pbXBvcnRWaWV3UmVzb3VyY2VzKGltcG9ydElkcywgbmFtZXMsIGFwcFJlc291cmNlcyk7XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIF9ub3JtYWxpemUobG9hZCkge1xuICAgIGxldCBtb2R1bGVJZCA9IGxvYWQubW9kdWxlSWQ7XG4gICAgbGV0IGV4dCA9IGdldEV4dChtb2R1bGVJZCk7XG5cbiAgICBpZiAoaXNPdGhlclJlc291cmNlKG1vZHVsZUlkKSkge1xuICAgICAgbW9kdWxlSWQgPSByZW1vdmVFeHQobW9kdWxlSWQpO1xuICAgIH1cblxuICAgIHJldHVybiBhdXJlbGlhLmxvYWRlci5ub3JtYWxpemUobW9kdWxlSWQsIGxvYWQucmVsYXRpdmVUbykudGhlbihub3JtYWxpemVkID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IGxvYWQubW9kdWxlSWQsXG4gICAgICAgIGltcG9ydElkOiBpc090aGVyUmVzb3VyY2UobG9hZC5tb2R1bGVJZCkgPyBhZGRPcmlnaW5hbEV4dChub3JtYWxpemVkLCBleHQpIDogbm9ybWFsaXplZFxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzT3RoZXJSZXNvdXJjZShuYW1lKSB7XG4gICAgbGV0IGV4dCA9IGdldEV4dChuYW1lKTtcbiAgICBpZiAoIWV4dCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChleHQgPT09ICcnKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGV4dCA9PT0gJy5qcycgfHwgZXh0ID09PSAnLnRzJykgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlRXh0KG5hbWUpIHtcbiAgICByZXR1cm4gbmFtZS5yZXBsYWNlKGV4dFBhdHRlcm4sICcnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZE9yaWdpbmFsRXh0KG5vcm1hbGl6ZWQsIGV4dCkge1xuICAgIHJldHVybiByZW1vdmVFeHQobm9ybWFsaXplZCkgKyAnLicgKyBleHQ7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RXh0KG5hbWUpIHtcbiAgbGV0IG1hdGNoID0gbmFtZS5tYXRjaChleHRQYXR0ZXJuKTtcbiAgaWYgKG1hdGNoICYmIG1hdGNoLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gbWF0Y2hbMF0uc3BsaXQoJy4nKVsxXTtcbiAgfVxufVxuXG5mdW5jdGlvbiBsb2FkQmVoYXZpb3JzKGNvbmZpZykge1xuICByZXR1cm4gUHJvbWlzZS5hbGwoY29uZmlnLmJlaGF2aW9yc1RvTG9hZC5tYXAobSA9PiBtLmxvYWQoY29uZmlnLmNvbnRhaW5lciwgbS50YXJnZXQpKSkudGhlbigoKSA9PiB7XG4gICAgY29uZmlnLmJlaGF2aW9yc1RvTG9hZCA9IG51bGw7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBhc3NlcnRQcm9jZXNzZWQocGx1Z2lucykge1xuICBpZiAocGx1Z2lucy5wcm9jZXNzZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgY29uZmlnIGluc3RhbmNlIGhhcyBhbHJlYWR5IGJlZW4gYXBwbGllZC4gVG8gbG9hZCBtb3JlIHBsdWdpbnMgb3IgZ2xvYmFsIHJlc291cmNlcywgY3JlYXRlIGEgbmV3IEZyYW1ld29ya0NvbmZpZ3VyYXRpb24gaW5zdGFuY2UuJyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW52YWxpZENvbmZpZ01zZyhjZmcsIHR5cGUpIHtcbiAgcmV0dXJuIGBJbnZhbGlkICR7dHlwZX0gWyR7Y2ZnfV0sICR7dHlwZX0gbXVzdCBiZSBzcGVjaWZpZWQgYXMgZnVuY3Rpb25zIG9yIHJlbGF0aXZlIG1vZHVsZSBJRHMuYDtcbn1cblxuZXhwb3J0IGxldCBGcmFtZXdvcmtDb25maWd1cmF0aW9uID0gY2xhc3MgRnJhbWV3b3JrQ29uZmlndXJhdGlvbiB7XG4gIGNvbnN0cnVjdG9yKGF1cmVsaWEpIHtcbiAgICB0aGlzLmF1cmVsaWEgPSBhdXJlbGlhO1xuICAgIHRoaXMuY29udGFpbmVyID0gYXVyZWxpYS5jb250YWluZXI7XG5cbiAgICB0aGlzLmluZm8gPSBbXTtcbiAgICB0aGlzLnByb2Nlc3NlZCA9IGZhbHNlO1xuICAgIHRoaXMucHJlVGFza3MgPSBbXTtcbiAgICB0aGlzLnBvc3RUYXNrcyA9IFtdO1xuXG4gICAgdGhpcy5iZWhhdmlvcnNUb0xvYWQgPSBbXTtcblxuICAgIHRoaXMuY29uZmlndXJlZFBsdWdpbnMgPSBbXTtcbiAgICB0aGlzLnJlc291cmNlc1RvTG9hZCA9IHt9O1xuICAgIHRoaXMucHJlVGFzaygoKSA9PiBhdXJlbGlhLmxvYWRlci5ub3JtYWxpemUoJ2F1cmVsaWEtYm9vdHN0cmFwcGVyJykudGhlbihuYW1lID0+IHRoaXMuYm9vdHN0cmFwcGVyTmFtZSA9IG5hbWUpKTtcbiAgICB0aGlzLnBvc3RUYXNrKCgpID0+IGxvYWRSZXNvdXJjZXMoYXVyZWxpYSwgdGhpcy5yZXNvdXJjZXNUb0xvYWQsIGF1cmVsaWEucmVzb3VyY2VzKSk7XG4gIH1cblxuICBpbnN0YW5jZSh0eXBlLCBpbnN0YW5jZSkge1xuICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVySW5zdGFuY2UodHlwZSwgaW5zdGFuY2UpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgc2luZ2xldG9uKHR5cGUsIGltcGxlbWVudGF0aW9uKSB7XG4gICAgdGhpcy5jb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b24odHlwZSwgaW1wbGVtZW50YXRpb24pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgdHJhbnNpZW50KHR5cGUsIGltcGxlbWVudGF0aW9uKSB7XG4gICAgdGhpcy5jb250YWluZXIucmVnaXN0ZXJUcmFuc2llbnQodHlwZSwgaW1wbGVtZW50YXRpb24pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcHJlVGFzayh0YXNrKSB7XG4gICAgYXNzZXJ0UHJvY2Vzc2VkKHRoaXMpO1xuICAgIHRoaXMucHJlVGFza3MucHVzaCh0YXNrKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHBvc3RUYXNrKHRhc2spIHtcbiAgICBhc3NlcnRQcm9jZXNzZWQodGhpcyk7XG4gICAgdGhpcy5wb3N0VGFza3MucHVzaCh0YXNrKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGZlYXR1cmUocGx1Z2luLCBjb25maWcgPSB7fSkge1xuICAgIHN3aXRjaCAodHlwZW9mIHBsdWdpbikge1xuICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgbGV0IGhhc0luZGV4ID0gL1xcL2luZGV4JC9pLnRlc3QocGx1Z2luKTtcbiAgICAgICAgbGV0IG1vZHVsZUlkID0gaGFzSW5kZXggfHwgZ2V0RXh0KHBsdWdpbikgPyBwbHVnaW4gOiBwbHVnaW4gKyAnL2luZGV4JztcbiAgICAgICAgbGV0IHJvb3QgPSBoYXNJbmRleCA/IHBsdWdpbi5zdWJzdHIoMCwgcGx1Z2luLmxlbmd0aCAtIDYpIDogcGx1Z2luO1xuICAgICAgICB0aGlzLmluZm8ucHVzaCh7IG1vZHVsZUlkLCByZXNvdXJjZXNSZWxhdGl2ZVRvOiBbcm9vdCwgJyddLCBjb25maWcgfSk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdmdW5jdGlvbic6XG4gICAgICAgIHRoaXMuaW5mby5wdXNoKHsgY29uZmlndXJlOiBwbHVnaW4sIGNvbmZpZzogY29uZmlnIHx8IHt9IH0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihpbnZhbGlkQ29uZmlnTXNnKHBsdWdpbiwgJ2ZlYXR1cmUnKSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZ2xvYmFsUmVzb3VyY2VzKHJlc291cmNlcykge1xuICAgIGFzc2VydFByb2Nlc3NlZCh0aGlzKTtcblxuICAgIGxldCB0b0FkZCA9IEFycmF5LmlzQXJyYXkocmVzb3VyY2VzKSA/IHJlc291cmNlcyA6IGFyZ3VtZW50cztcbiAgICBsZXQgcmVzb3VyY2U7XG4gICAgbGV0IHJlc291cmNlc1JlbGF0aXZlVG8gPSB0aGlzLnJlc291cmNlc1JlbGF0aXZlVG8gfHwgWycnLCAnJ107XG5cbiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSB0b0FkZC5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICByZXNvdXJjZSA9IHRvQWRkW2ldO1xuICAgICAgc3dpdGNoICh0eXBlb2YgcmVzb3VyY2UpIHtcbiAgICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgICBsZXQgcGFyZW50ID0gcmVzb3VyY2VzUmVsYXRpdmVUb1swXTtcbiAgICAgICAgICBsZXQgZ3JhbmRQYXJlbnQgPSByZXNvdXJjZXNSZWxhdGl2ZVRvWzFdO1xuICAgICAgICAgIGxldCBuYW1lID0gcmVzb3VyY2U7XG5cbiAgICAgICAgICBpZiAoKHJlc291cmNlLnN0YXJ0c1dpdGgoJy4vJykgfHwgcmVzb3VyY2Uuc3RhcnRzV2l0aCgnLi4vJykpICYmIHBhcmVudCAhPT0gJycpIHtcbiAgICAgICAgICAgIG5hbWUgPSBqb2luKHBhcmVudCwgcmVzb3VyY2UpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMucmVzb3VyY2VzVG9Mb2FkW25hbWVdID0geyBtb2R1bGVJZDogbmFtZSwgcmVsYXRpdmVUbzogZ3JhbmRQYXJlbnQgfTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZnVuY3Rpb24nOlxuICAgICAgICAgIGxldCBtZXRhID0gdGhpcy5hdXJlbGlhLnJlc291cmNlcy5hdXRvUmVnaXN0ZXIodGhpcy5jb250YWluZXIsIHJlc291cmNlKTtcbiAgICAgICAgICBpZiAobWV0YSBpbnN0YW5jZW9mIEh0bWxCZWhhdmlvclJlc291cmNlICYmIG1ldGEuZWxlbWVudE5hbWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmJlaGF2aW9yc1RvTG9hZC5wdXNoKG1ldGEpID09PSAxKSB7XG4gICAgICAgICAgICAgIHRoaXMucG9zdFRhc2soKCkgPT4gbG9hZEJlaGF2aW9ycyh0aGlzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihpbnZhbGlkQ29uZmlnTXNnKHJlc291cmNlLCAncmVzb3VyY2UnKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBnbG9iYWxOYW1lKHJlc291cmNlUGF0aCwgbmV3TmFtZSkge1xuICAgIGFzc2VydFByb2Nlc3NlZCh0aGlzKTtcbiAgICB0aGlzLnJlc291cmNlc1RvTG9hZFtyZXNvdXJjZVBhdGhdID0geyBtb2R1bGVJZDogbmV3TmFtZSwgcmVsYXRpdmVUbzogJycgfTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHBsdWdpbihwbHVnaW4sIHBsdWdpbkNvbmZpZykge1xuICAgIGFzc2VydFByb2Nlc3NlZCh0aGlzKTtcblxuICAgIGxldCBpbmZvO1xuICAgIHN3aXRjaCAodHlwZW9mIHBsdWdpbikge1xuICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgaW5mbyA9IHsgbW9kdWxlSWQ6IHBsdWdpbiwgcmVzb3VyY2VzUmVsYXRpdmVUbzogW3BsdWdpbiwgJyddLCBjb25maWc6IHBsdWdpbkNvbmZpZyB8fCB7fSB9O1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Z1bmN0aW9uJzpcbiAgICAgICAgaW5mbyA9IHsgY29uZmlndXJlOiBwbHVnaW4sIGNvbmZpZzogcGx1Z2luQ29uZmlnIHx8IHt9IH07XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGludmFsaWRDb25maWdNc2cocGx1Z2luLCAncGx1Z2luJykpO1xuICAgIH1cbiAgICB0aGlzLmluZm8ucHVzaChpbmZvKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIF9hZGROb3JtYWxpemVkUGx1Z2luKG5hbWUsIGNvbmZpZykge1xuICAgIGxldCBwbHVnaW4gPSB7IG1vZHVsZUlkOiBuYW1lLCByZXNvdXJjZXNSZWxhdGl2ZVRvOiBbbmFtZSwgJyddLCBjb25maWc6IGNvbmZpZyB8fCB7fSB9O1xuICAgIHRoaXMuaW5mby5wdXNoKHBsdWdpbik7XG5cbiAgICB0aGlzLnByZVRhc2soKCkgPT4ge1xuICAgICAgbGV0IHJlbGF0aXZlVG8gPSBbbmFtZSwgdGhpcy5ib290c3RyYXBwZXJOYW1lXTtcbiAgICAgIHBsdWdpbi5tb2R1bGVJZCA9IG5hbWU7XG4gICAgICBwbHVnaW4ucmVzb3VyY2VzUmVsYXRpdmVUbyA9IHJlbGF0aXZlVG87XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGRlZmF1bHRCaW5kaW5nTGFuZ3VhZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2FkZE5vcm1hbGl6ZWRQbHVnaW4oJ2F1cmVsaWEtdGVtcGxhdGluZy1iaW5kaW5nJyk7XG4gIH1cblxuICByb3V0ZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2FkZE5vcm1hbGl6ZWRQbHVnaW4oJ2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXInKTtcbiAgfVxuXG4gIGhpc3RvcnkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2FkZE5vcm1hbGl6ZWRQbHVnaW4oJ2F1cmVsaWEtaGlzdG9yeS1icm93c2VyJyk7XG4gIH1cblxuICBkZWZhdWx0UmVzb3VyY2VzKCkge1xuICAgIHJldHVybiB0aGlzLl9hZGROb3JtYWxpemVkUGx1Z2luKCdhdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzJyk7XG4gIH1cblxuICBldmVudEFnZ3JlZ2F0b3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2FkZE5vcm1hbGl6ZWRQbHVnaW4oJ2F1cmVsaWEtZXZlbnQtYWdncmVnYXRvcicpO1xuICB9XG5cbiAgYmFzaWNDb25maWd1cmF0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmRlZmF1bHRCaW5kaW5nTGFuZ3VhZ2UoKS5kZWZhdWx0UmVzb3VyY2VzKCkuZXZlbnRBZ2dyZWdhdG9yKCk7XG4gIH1cblxuICBzdGFuZGFyZENvbmZpZ3VyYXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuYmFzaWNDb25maWd1cmF0aW9uKCkuaGlzdG9yeSgpLnJvdXRlcigpO1xuICB9XG5cbiAgZGV2ZWxvcG1lbnRMb2dnaW5nKGxldmVsKSB7XG4gICAgbGV0IGxvZ0xldmVsID0gbGV2ZWwgPyBUaGVMb2dNYW5hZ2VyLmxvZ0xldmVsW2xldmVsXSA6IHVuZGVmaW5lZDtcblxuICAgIGlmIChsb2dMZXZlbCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBsb2dMZXZlbCA9IFRoZUxvZ01hbmFnZXIubG9nTGV2ZWwuZGVidWc7XG4gICAgfVxuXG4gICAgdGhpcy5wcmVUYXNrKCgpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmF1cmVsaWEubG9hZGVyLm5vcm1hbGl6ZSgnYXVyZWxpYS1sb2dnaW5nLWNvbnNvbGUnLCB0aGlzLmJvb3RzdHJhcHBlck5hbWUpLnRoZW4obmFtZSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmF1cmVsaWEubG9hZGVyLmxvYWRNb2R1bGUobmFtZSkudGhlbihtID0+IHtcbiAgICAgICAgICBUaGVMb2dNYW5hZ2VyLmFkZEFwcGVuZGVyKG5ldyBtLkNvbnNvbGVBcHBlbmRlcigpKTtcbiAgICAgICAgICBUaGVMb2dNYW5hZ2VyLnNldExldmVsKGxvZ0xldmVsKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgYXBwbHkoKSB7XG4gICAgaWYgKHRoaXMucHJvY2Vzc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJ1blRhc2tzKHRoaXMsIHRoaXMucHJlVGFza3MpLnRoZW4oKCkgPT4ge1xuICAgICAgbGV0IGxvYWRlciA9IHRoaXMuYXVyZWxpYS5sb2FkZXI7XG4gICAgICBsZXQgaW5mbyA9IHRoaXMuaW5mbztcbiAgICAgIGxldCBjdXJyZW50O1xuXG4gICAgICBsZXQgbmV4dCA9ICgpID0+IHtcbiAgICAgICAgY3VycmVudCA9IGluZm8uc2hpZnQoKTtcbiAgICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgICByZXR1cm4gbG9hZFBsdWdpbih0aGlzLCBsb2FkZXIsIGN1cnJlbnQpLnRoZW4obmV4dCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuY29uZmlndXJlZFBsdWdpbnMgPSBudWxsO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gbmV4dCgpLnRoZW4oKCkgPT4gcnVuVGFza3ModGhpcywgdGhpcy5wb3N0VGFza3MpKTtcbiAgICB9KTtcbiAgfVxufTtcblxuZXhwb3J0ICogZnJvbSAnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbic7XG5leHBvcnQgKiBmcm9tICdhdXJlbGlhLWJpbmRpbmcnO1xuZXhwb3J0ICogZnJvbSAnYXVyZWxpYS1tZXRhZGF0YSc7XG5leHBvcnQgKiBmcm9tICdhdXJlbGlhLXRlbXBsYXRpbmcnO1xuZXhwb3J0ICogZnJvbSAnYXVyZWxpYS1sb2FkZXInO1xuZXhwb3J0ICogZnJvbSAnYXVyZWxpYS10YXNrLXF1ZXVlJztcbmV4cG9ydCAqIGZyb20gJ2F1cmVsaWEtcGF0aCc7XG5leHBvcnQgKiBmcm9tICdhdXJlbGlhLXBhbCc7XG5cbmV4cG9ydCBjb25zdCBMb2dNYW5hZ2VyID0gVGhlTG9nTWFuYWdlcjsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///aurelia-framework\n");

/***/ }),

/***/ "aurelia-history-browser":
/*!*************************************************************************************!*\
  !*** ./node_modules/aurelia-history-browser/dist/es2015/aurelia-history-browser.js ***!
  \*************************************************************************************/
/*! exports provided: BrowserHistory, DefaultLinkHandler, LinkHandler, configure */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrowserHistory\", function() { return BrowserHistory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DefaultLinkHandler\", function() { return DefaultLinkHandler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LinkHandler\", function() { return LinkHandler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony import */ var aurelia_history__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-history */ \"./node_modules/aurelia-history/dist/es2015/aurelia-history.js\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n\n\n\nclass LinkHandler {\r\n    activate(history) { }\r\n    deactivate() { }\r\n}\r\nclass DefaultLinkHandler extends LinkHandler {\r\n    constructor() {\r\n        super();\r\n        this.handler = (e) => {\r\n            let { shouldHandleEvent, href } = DefaultLinkHandler.getEventInfo(e);\r\n            if (shouldHandleEvent) {\r\n                e.preventDefault();\r\n                this.history.navigate(href);\r\n            }\r\n        };\r\n    }\r\n    activate(history) {\r\n        if (history._hasPushState) {\r\n            this.history = history;\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].addEventListener('click', this.handler, true);\r\n        }\r\n    }\r\n    deactivate() {\r\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].removeEventListener('click', this.handler, true);\r\n    }\r\n    static getEventInfo(event) {\r\n        let $event = event;\r\n        let info = {\r\n            shouldHandleEvent: false,\r\n            href: null,\r\n            anchor: null\r\n        };\r\n        let target = DefaultLinkHandler.findClosestAnchor($event.target);\r\n        if (!target || !DefaultLinkHandler.targetIsThisWindow(target)) {\r\n            return info;\r\n        }\r\n        if (hasAttribute(target, 'download')\r\n            || hasAttribute(target, 'router-ignore')\r\n            || hasAttribute(target, 'data-router-ignore')) {\r\n            return info;\r\n        }\r\n        if ($event.altKey || $event.ctrlKey || $event.metaKey || $event.shiftKey) {\r\n            return info;\r\n        }\r\n        let href = target.getAttribute('href');\r\n        info.anchor = target;\r\n        info.href = href;\r\n        let leftButtonClicked = $event.which === 1;\r\n        let isRelative = href && !(href.charAt(0) === '#' || (/^[a-z]+:/i).test(href));\r\n        info.shouldHandleEvent = leftButtonClicked && isRelative;\r\n        return info;\r\n    }\r\n    static findClosestAnchor(el) {\r\n        while (el) {\r\n            if (el.tagName === 'A') {\r\n                return el;\r\n            }\r\n            el = el.parentNode;\r\n        }\r\n    }\r\n    static targetIsThisWindow(target) {\r\n        let targetWindow = target.getAttribute('target');\r\n        let win = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].global;\r\n        return !targetWindow ||\r\n            targetWindow === win.name ||\r\n            targetWindow === '_self';\r\n    }\r\n}\r\nconst hasAttribute = (el, attr) => el.hasAttribute(attr);\n\nclass BrowserHistory extends aurelia_history__WEBPACK_IMPORTED_MODULE_0__[\"History\"] {\r\n    constructor(linkHandler) {\r\n        super();\r\n        this._isActive = false;\r\n        this._checkUrlCallback = this._checkUrl.bind(this);\r\n        this.location = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].location;\r\n        this.history = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].history;\r\n        this.linkHandler = linkHandler;\r\n    }\r\n    activate(options) {\r\n        if (this._isActive) {\r\n            throw new Error('History has already been activated.');\r\n        }\r\n        let $history = this.history;\r\n        let wantsPushState = !!options.pushState;\r\n        this._isActive = true;\r\n        let normalizedOptions = this.options = Object.assign({}, { root: '/' }, this.options, options);\r\n        let rootUrl = this.root = ('/' + normalizedOptions.root + '/').replace(rootStripper, '/');\r\n        let wantsHashChange = this._wantsHashChange = normalizedOptions.hashChange !== false;\r\n        let hasPushState = this._hasPushState = !!(normalizedOptions.pushState && $history && $history.pushState);\r\n        let eventName;\r\n        if (hasPushState) {\r\n            eventName = 'popstate';\r\n        }\r\n        else if (wantsHashChange) {\r\n            eventName = 'hashchange';\r\n        }\r\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].addEventListener(eventName, this._checkUrlCallback);\r\n        if (wantsHashChange && wantsPushState) {\r\n            let $location = this.location;\r\n            let atRoot = $location.pathname.replace(/[^\\/]$/, '$&/') === rootUrl;\r\n            if (!hasPushState && !atRoot) {\r\n                let fragment = this.fragment = this._getFragment(null, true);\r\n                $location.replace(rootUrl + $location.search + '#' + fragment);\r\n                return true;\r\n            }\r\n            else if (hasPushState && atRoot && $location.hash) {\r\n                let fragment = this.fragment = this._getHash().replace(routeStripper, '');\r\n                $history.replaceState({}, aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].title, rootUrl + fragment + $location.search);\r\n            }\r\n        }\r\n        if (!this.fragment) {\r\n            this.fragment = this._getFragment('');\r\n        }\r\n        this.linkHandler.activate(this);\r\n        if (!normalizedOptions.silent) {\r\n            return this._loadUrl('');\r\n        }\r\n    }\r\n    deactivate() {\r\n        const handler = this._checkUrlCallback;\r\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].removeEventListener('popstate', handler);\r\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"PLATFORM\"].removeEventListener('hashchange', handler);\r\n        this._isActive = false;\r\n        this.linkHandler.deactivate();\r\n    }\r\n    getAbsoluteRoot() {\r\n        let $location = this.location;\r\n        let origin = createOrigin($location.protocol, $location.hostname, $location.port);\r\n        return `${origin}${this.root}`;\r\n    }\r\n    navigate(fragment, { trigger = true, replace = false } = {}) {\r\n        let location = this.location;\r\n        if (fragment && absoluteUrl.test(fragment)) {\r\n            location.href = fragment;\r\n            return true;\r\n        }\r\n        if (!this._isActive) {\r\n            return false;\r\n        }\r\n        fragment = this._getFragment(fragment || '');\r\n        if (this.fragment === fragment && !replace) {\r\n            return false;\r\n        }\r\n        this.fragment = fragment;\r\n        let url = this.root + fragment;\r\n        if (fragment === '' && url !== '/') {\r\n            url = url.slice(0, -1);\r\n        }\r\n        if (this._hasPushState) {\r\n            url = url.replace('//', '/');\r\n            this.history[replace ? 'replaceState' : 'pushState']({}, aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].title, url);\r\n        }\r\n        else if (this._wantsHashChange) {\r\n            updateHash(location, fragment, replace);\r\n        }\r\n        else {\r\n            location.assign(url);\r\n        }\r\n        if (trigger) {\r\n            return this._loadUrl(fragment);\r\n        }\r\n        return true;\r\n    }\r\n    navigateBack() {\r\n        this.history.back();\r\n    }\r\n    setTitle(title) {\r\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].title = title;\r\n    }\r\n    setState(key, value) {\r\n        let $history = this.history;\r\n        let state = Object.assign({}, $history.state);\r\n        let { pathname, search, hash } = this.location;\r\n        state[key] = value;\r\n        $history.replaceState(state, null, `${pathname}${search}${hash}`);\r\n    }\r\n    getState(key) {\r\n        let state = Object.assign({}, this.history.state);\r\n        return state[key];\r\n    }\r\n    getHistoryIndex() {\r\n        let historyIndex = this.getState('HistoryIndex');\r\n        if (historyIndex === undefined) {\r\n            historyIndex = this.history.length - 1;\r\n            this.setState('HistoryIndex', historyIndex);\r\n        }\r\n        return historyIndex;\r\n    }\r\n    go(movement) {\r\n        this.history.go(movement);\r\n    }\r\n    _getHash() {\r\n        return this.location.hash.substr(1);\r\n    }\r\n    _getFragment(fragment, forcePushState) {\r\n        let rootUrl;\r\n        if (!fragment) {\r\n            if (this._hasPushState || !this._wantsHashChange || forcePushState) {\r\n                let location = this.location;\r\n                fragment = location.pathname + location.search;\r\n                rootUrl = this.root.replace(trailingSlash, '');\r\n                if (!fragment.indexOf(rootUrl)) {\r\n                    fragment = fragment.substr(rootUrl.length);\r\n                }\r\n            }\r\n            else {\r\n                fragment = this._getHash();\r\n            }\r\n        }\r\n        return '/' + fragment.replace(routeStripper, '');\r\n    }\r\n    _checkUrl() {\r\n        let current = this._getFragment('');\r\n        if (current !== this.fragment) {\r\n            this._loadUrl('');\r\n        }\r\n    }\r\n    _loadUrl(fragmentOverride) {\r\n        let fragment = this.fragment = this._getFragment(fragmentOverride);\r\n        return this.options.routeHandler ?\r\n            this.options.routeHandler(fragment) :\r\n            false;\r\n    }\r\n}\r\nBrowserHistory.inject = [LinkHandler];\r\nconst routeStripper = /^#?\\/*|\\s+$/g;\r\nconst rootStripper = /^\\/+|\\/+$/g;\r\nconst trailingSlash = /\\/$/;\r\nconst absoluteUrl = /^([a-z][a-z0-9+\\-.]*:)?\\/\\//i;\r\nfunction updateHash($location, fragment, replace) {\r\n    if (replace) {\r\n        let href = $location.href.replace(/(javascript:|#).*$/, '');\r\n        $location.replace(href + '#' + fragment);\r\n    }\r\n    else {\r\n        $location.hash = '#' + fragment;\r\n    }\r\n}\r\nfunction createOrigin(protocol, hostname, port) {\r\n    return `${protocol}//${hostname}${port ? ':' + port : ''}`;\r\n}\n\nfunction configure(config) {\r\n    const $config = config;\r\n    $config.singleton(aurelia_history__WEBPACK_IMPORTED_MODULE_0__[\"History\"], BrowserHistory);\r\n    $config.transient(LinkHandler, DefaultLinkHandler);\r\n}\n\n\n//# sourceMappingURL=aurelia-history-browser.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS1oaXN0b3J5LWJyb3dzZXIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1oaXN0b3J5LWJyb3dzZXIvZGlzdC9lczIwMTUvYXVyZWxpYS1oaXN0b3J5LWJyb3dzZXIuanM/Zjk3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIaXN0b3J5IH0gZnJvbSAnYXVyZWxpYS1oaXN0b3J5JztcbmltcG9ydCB7IERPTSwgUExBVEZPUk0gfSBmcm9tICdhdXJlbGlhLXBhbCc7XG5cbmNsYXNzIExpbmtIYW5kbGVyIHtcclxuICAgIGFjdGl2YXRlKGhpc3RvcnkpIHsgfVxyXG4gICAgZGVhY3RpdmF0ZSgpIHsgfVxyXG59XHJcbmNsYXNzIERlZmF1bHRMaW5rSGFuZGxlciBleHRlbmRzIExpbmtIYW5kbGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVyID0gKGUpID0+IHtcclxuICAgICAgICAgICAgbGV0IHsgc2hvdWxkSGFuZGxlRXZlbnQsIGhyZWYgfSA9IERlZmF1bHRMaW5rSGFuZGxlci5nZXRFdmVudEluZm8oZSk7XHJcbiAgICAgICAgICAgIGlmIChzaG91bGRIYW5kbGVFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oaXN0b3J5Lm5hdmlnYXRlKGhyZWYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIGFjdGl2YXRlKGhpc3RvcnkpIHtcclxuICAgICAgICBpZiAoaGlzdG9yeS5faGFzUHVzaFN0YXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlzdG9yeSA9IGhpc3Rvcnk7XHJcbiAgICAgICAgICAgIERPTS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlciwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZGVhY3RpdmF0ZSgpIHtcclxuICAgICAgICBET00ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZXIsIHRydWUpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGdldEV2ZW50SW5mbyhldmVudCkge1xyXG4gICAgICAgIGxldCAkZXZlbnQgPSBldmVudDtcclxuICAgICAgICBsZXQgaW5mbyA9IHtcclxuICAgICAgICAgICAgc2hvdWxkSGFuZGxlRXZlbnQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBocmVmOiBudWxsLFxyXG4gICAgICAgICAgICBhbmNob3I6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCB0YXJnZXQgPSBEZWZhdWx0TGlua0hhbmRsZXIuZmluZENsb3Nlc3RBbmNob3IoJGV2ZW50LnRhcmdldCk7XHJcbiAgICAgICAgaWYgKCF0YXJnZXQgfHwgIURlZmF1bHRMaW5rSGFuZGxlci50YXJnZXRJc1RoaXNXaW5kb3codGFyZ2V0KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5mbztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGhhc0F0dHJpYnV0ZSh0YXJnZXQsICdkb3dubG9hZCcpXHJcbiAgICAgICAgICAgIHx8IGhhc0F0dHJpYnV0ZSh0YXJnZXQsICdyb3V0ZXItaWdub3JlJylcclxuICAgICAgICAgICAgfHwgaGFzQXR0cmlidXRlKHRhcmdldCwgJ2RhdGEtcm91dGVyLWlnbm9yZScpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbmZvO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoJGV2ZW50LmFsdEtleSB8fCAkZXZlbnQuY3RybEtleSB8fCAkZXZlbnQubWV0YUtleSB8fCAkZXZlbnQuc2hpZnRLZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGluZm87XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBocmVmID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpO1xyXG4gICAgICAgIGluZm8uYW5jaG9yID0gdGFyZ2V0O1xyXG4gICAgICAgIGluZm8uaHJlZiA9IGhyZWY7XHJcbiAgICAgICAgbGV0IGxlZnRCdXR0b25DbGlja2VkID0gJGV2ZW50LndoaWNoID09PSAxO1xyXG4gICAgICAgIGxldCBpc1JlbGF0aXZlID0gaHJlZiAmJiAhKGhyZWYuY2hhckF0KDApID09PSAnIycgfHwgKC9eW2Etel0rOi9pKS50ZXN0KGhyZWYpKTtcclxuICAgICAgICBpbmZvLnNob3VsZEhhbmRsZUV2ZW50ID0gbGVmdEJ1dHRvbkNsaWNrZWQgJiYgaXNSZWxhdGl2ZTtcclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgIH1cclxuICAgIHN0YXRpYyBmaW5kQ2xvc2VzdEFuY2hvcihlbCkge1xyXG4gICAgICAgIHdoaWxlIChlbCkge1xyXG4gICAgICAgICAgICBpZiAoZWwudGFnTmFtZSA9PT0gJ0EnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWwgPSBlbC5wYXJlbnROb2RlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXRpYyB0YXJnZXRJc1RoaXNXaW5kb3codGFyZ2V0KSB7XHJcbiAgICAgICAgbGV0IHRhcmdldFdpbmRvdyA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ3RhcmdldCcpO1xyXG4gICAgICAgIGxldCB3aW4gPSBQTEFURk9STS5nbG9iYWw7XHJcbiAgICAgICAgcmV0dXJuICF0YXJnZXRXaW5kb3cgfHxcclxuICAgICAgICAgICAgdGFyZ2V0V2luZG93ID09PSB3aW4ubmFtZSB8fFxyXG4gICAgICAgICAgICB0YXJnZXRXaW5kb3cgPT09ICdfc2VsZic7XHJcbiAgICB9XHJcbn1cclxuY29uc3QgaGFzQXR0cmlidXRlID0gKGVsLCBhdHRyKSA9PiBlbC5oYXNBdHRyaWJ1dGUoYXR0cik7XG5cbmNsYXNzIEJyb3dzZXJIaXN0b3J5IGV4dGVuZHMgSGlzdG9yeSB7XHJcbiAgICBjb25zdHJ1Y3RvcihsaW5rSGFuZGxlcikge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5faXNBY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9jaGVja1VybENhbGxiYWNrID0gdGhpcy5fY2hlY2tVcmwuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLmxvY2F0aW9uID0gUExBVEZPUk0ubG9jYXRpb247XHJcbiAgICAgICAgdGhpcy5oaXN0b3J5ID0gUExBVEZPUk0uaGlzdG9yeTtcclxuICAgICAgICB0aGlzLmxpbmtIYW5kbGVyID0gbGlua0hhbmRsZXI7XHJcbiAgICB9XHJcbiAgICBhY3RpdmF0ZShvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSGlzdG9yeSBoYXMgYWxyZWFkeSBiZWVuIGFjdGl2YXRlZC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0ICRoaXN0b3J5ID0gdGhpcy5oaXN0b3J5O1xyXG4gICAgICAgIGxldCB3YW50c1B1c2hTdGF0ZSA9ICEhb3B0aW9ucy5wdXNoU3RhdGU7XHJcbiAgICAgICAgdGhpcy5faXNBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGxldCBub3JtYWxpemVkT3B0aW9ucyA9IHRoaXMub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIHsgcm9vdDogJy8nIH0sIHRoaXMub3B0aW9ucywgb3B0aW9ucyk7XHJcbiAgICAgICAgbGV0IHJvb3RVcmwgPSB0aGlzLnJvb3QgPSAoJy8nICsgbm9ybWFsaXplZE9wdGlvbnMucm9vdCArICcvJykucmVwbGFjZShyb290U3RyaXBwZXIsICcvJyk7XHJcbiAgICAgICAgbGV0IHdhbnRzSGFzaENoYW5nZSA9IHRoaXMuX3dhbnRzSGFzaENoYW5nZSA9IG5vcm1hbGl6ZWRPcHRpb25zLmhhc2hDaGFuZ2UgIT09IGZhbHNlO1xyXG4gICAgICAgIGxldCBoYXNQdXNoU3RhdGUgPSB0aGlzLl9oYXNQdXNoU3RhdGUgPSAhIShub3JtYWxpemVkT3B0aW9ucy5wdXNoU3RhdGUgJiYgJGhpc3RvcnkgJiYgJGhpc3RvcnkucHVzaFN0YXRlKTtcclxuICAgICAgICBsZXQgZXZlbnROYW1lO1xyXG4gICAgICAgIGlmIChoYXNQdXNoU3RhdGUpIHtcclxuICAgICAgICAgICAgZXZlbnROYW1lID0gJ3BvcHN0YXRlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAod2FudHNIYXNoQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGV2ZW50TmFtZSA9ICdoYXNoY2hhbmdlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgUExBVEZPUk0uYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIHRoaXMuX2NoZWNrVXJsQ2FsbGJhY2spO1xyXG4gICAgICAgIGlmICh3YW50c0hhc2hDaGFuZ2UgJiYgd2FudHNQdXNoU3RhdGUpIHtcclxuICAgICAgICAgICAgbGV0ICRsb2NhdGlvbiA9IHRoaXMubG9jYXRpb247XHJcbiAgICAgICAgICAgIGxldCBhdFJvb3QgPSAkbG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgvW15cXC9dJC8sICckJi8nKSA9PT0gcm9vdFVybDtcclxuICAgICAgICAgICAgaWYgKCFoYXNQdXNoU3RhdGUgJiYgIWF0Um9vdCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGZyYWdtZW50ID0gdGhpcy5mcmFnbWVudCA9IHRoaXMuX2dldEZyYWdtZW50KG51bGwsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnJlcGxhY2Uocm9vdFVybCArICRsb2NhdGlvbi5zZWFyY2ggKyAnIycgKyBmcmFnbWVudCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChoYXNQdXNoU3RhdGUgJiYgYXRSb290ICYmICRsb2NhdGlvbi5oYXNoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZnJhZ21lbnQgPSB0aGlzLmZyYWdtZW50ID0gdGhpcy5fZ2V0SGFzaCgpLnJlcGxhY2Uocm91dGVTdHJpcHBlciwgJycpO1xyXG4gICAgICAgICAgICAgICAgJGhpc3RvcnkucmVwbGFjZVN0YXRlKHt9LCBET00udGl0bGUsIHJvb3RVcmwgKyBmcmFnbWVudCArICRsb2NhdGlvbi5zZWFyY2gpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5mcmFnbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmZyYWdtZW50ID0gdGhpcy5fZ2V0RnJhZ21lbnQoJycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxpbmtIYW5kbGVyLmFjdGl2YXRlKHRoaXMpO1xyXG4gICAgICAgIGlmICghbm9ybWFsaXplZE9wdGlvbnMuc2lsZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkVXJsKCcnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBkZWFjdGl2YXRlKCkge1xyXG4gICAgICAgIGNvbnN0IGhhbmRsZXIgPSB0aGlzLl9jaGVja1VybENhbGxiYWNrO1xyXG4gICAgICAgIFBMQVRGT1JNLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvcHN0YXRlJywgaGFuZGxlcik7XHJcbiAgICAgICAgUExBVEZPUk0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIGhhbmRsZXIpO1xyXG4gICAgICAgIHRoaXMuX2lzQWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5saW5rSGFuZGxlci5kZWFjdGl2YXRlKCk7XHJcbiAgICB9XHJcbiAgICBnZXRBYnNvbHV0ZVJvb3QoKSB7XHJcbiAgICAgICAgbGV0ICRsb2NhdGlvbiA9IHRoaXMubG9jYXRpb247XHJcbiAgICAgICAgbGV0IG9yaWdpbiA9IGNyZWF0ZU9yaWdpbigkbG9jYXRpb24ucHJvdG9jb2wsICRsb2NhdGlvbi5ob3N0bmFtZSwgJGxvY2F0aW9uLnBvcnQpO1xyXG4gICAgICAgIHJldHVybiBgJHtvcmlnaW59JHt0aGlzLnJvb3R9YDtcclxuICAgIH1cclxuICAgIG5hdmlnYXRlKGZyYWdtZW50LCB7IHRyaWdnZXIgPSB0cnVlLCByZXBsYWNlID0gZmFsc2UgfSA9IHt9KSB7XHJcbiAgICAgICAgbGV0IGxvY2F0aW9uID0gdGhpcy5sb2NhdGlvbjtcclxuICAgICAgICBpZiAoZnJhZ21lbnQgJiYgYWJzb2x1dGVVcmwudGVzdChmcmFnbWVudCkpIHtcclxuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IGZyYWdtZW50O1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLl9pc0FjdGl2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZyYWdtZW50ID0gdGhpcy5fZ2V0RnJhZ21lbnQoZnJhZ21lbnQgfHwgJycpO1xyXG4gICAgICAgIGlmICh0aGlzLmZyYWdtZW50ID09PSBmcmFnbWVudCAmJiAhcmVwbGFjZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcclxuICAgICAgICBsZXQgdXJsID0gdGhpcy5yb290ICsgZnJhZ21lbnQ7XHJcbiAgICAgICAgaWYgKGZyYWdtZW50ID09PSAnJyAmJiB1cmwgIT09ICcvJykge1xyXG4gICAgICAgICAgICB1cmwgPSB1cmwuc2xpY2UoMCwgLTEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5faGFzUHVzaFN0YXRlKSB7XHJcbiAgICAgICAgICAgIHVybCA9IHVybC5yZXBsYWNlKCcvLycsICcvJyk7XHJcbiAgICAgICAgICAgIHRoaXMuaGlzdG9yeVtyZXBsYWNlID8gJ3JlcGxhY2VTdGF0ZScgOiAncHVzaFN0YXRlJ10oe30sIERPTS50aXRsZSwgdXJsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5fd2FudHNIYXNoQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZUhhc2gobG9jYXRpb24sIGZyYWdtZW50LCByZXBsYWNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLmFzc2lnbih1cmwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHJpZ2dlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9hZFVybChmcmFnbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgbmF2aWdhdGVCYWNrKCkge1xyXG4gICAgICAgIHRoaXMuaGlzdG9yeS5iYWNrKCk7XHJcbiAgICB9XHJcbiAgICBzZXRUaXRsZSh0aXRsZSkge1xyXG4gICAgICAgIERPTS50aXRsZSA9IHRpdGxlO1xyXG4gICAgfVxyXG4gICAgc2V0U3RhdGUoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIGxldCAkaGlzdG9yeSA9IHRoaXMuaGlzdG9yeTtcclxuICAgICAgICBsZXQgc3RhdGUgPSBPYmplY3QuYXNzaWduKHt9LCAkaGlzdG9yeS5zdGF0ZSk7XHJcbiAgICAgICAgbGV0IHsgcGF0aG5hbWUsIHNlYXJjaCwgaGFzaCB9ID0gdGhpcy5sb2NhdGlvbjtcclxuICAgICAgICBzdGF0ZVtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgJGhpc3RvcnkucmVwbGFjZVN0YXRlKHN0YXRlLCBudWxsLCBgJHtwYXRobmFtZX0ke3NlYXJjaH0ke2hhc2h9YCk7XHJcbiAgICB9XHJcbiAgICBnZXRTdGF0ZShrZXkpIHtcclxuICAgICAgICBsZXQgc3RhdGUgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmhpc3Rvcnkuc3RhdGUpO1xyXG4gICAgICAgIHJldHVybiBzdGF0ZVtrZXldO1xyXG4gICAgfVxyXG4gICAgZ2V0SGlzdG9yeUluZGV4KCkge1xyXG4gICAgICAgIGxldCBoaXN0b3J5SW5kZXggPSB0aGlzLmdldFN0YXRlKCdIaXN0b3J5SW5kZXgnKTtcclxuICAgICAgICBpZiAoaGlzdG9yeUluZGV4ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgaGlzdG9yeUluZGV4ID0gdGhpcy5oaXN0b3J5Lmxlbmd0aCAtIDE7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoJ0hpc3RvcnlJbmRleCcsIGhpc3RvcnlJbmRleCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBoaXN0b3J5SW5kZXg7XHJcbiAgICB9XHJcbiAgICBnbyhtb3ZlbWVudCkge1xyXG4gICAgICAgIHRoaXMuaGlzdG9yeS5nbyhtb3ZlbWVudCk7XHJcbiAgICB9XHJcbiAgICBfZ2V0SGFzaCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhdGlvbi5oYXNoLnN1YnN0cigxKTtcclxuICAgIH1cclxuICAgIF9nZXRGcmFnbWVudChmcmFnbWVudCwgZm9yY2VQdXNoU3RhdGUpIHtcclxuICAgICAgICBsZXQgcm9vdFVybDtcclxuICAgICAgICBpZiAoIWZyYWdtZW50KSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9oYXNQdXNoU3RhdGUgfHwgIXRoaXMuX3dhbnRzSGFzaENoYW5nZSB8fCBmb3JjZVB1c2hTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGxvY2F0aW9uID0gdGhpcy5sb2NhdGlvbjtcclxuICAgICAgICAgICAgICAgIGZyYWdtZW50ID0gbG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5zZWFyY2g7XHJcbiAgICAgICAgICAgICAgICByb290VXJsID0gdGhpcy5yb290LnJlcGxhY2UodHJhaWxpbmdTbGFzaCwgJycpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFmcmFnbWVudC5pbmRleE9mKHJvb3RVcmwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnJhZ21lbnQgPSBmcmFnbWVudC5zdWJzdHIocm9vdFVybC5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZnJhZ21lbnQgPSB0aGlzLl9nZXRIYXNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICcvJyArIGZyYWdtZW50LnJlcGxhY2Uocm91dGVTdHJpcHBlciwgJycpO1xyXG4gICAgfVxyXG4gICAgX2NoZWNrVXJsKCkge1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5fZ2V0RnJhZ21lbnQoJycpO1xyXG4gICAgICAgIGlmIChjdXJyZW50ICE9PSB0aGlzLmZyYWdtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWRVcmwoJycpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9sb2FkVXJsKGZyYWdtZW50T3ZlcnJpZGUpIHtcclxuICAgICAgICBsZXQgZnJhZ21lbnQgPSB0aGlzLmZyYWdtZW50ID0gdGhpcy5fZ2V0RnJhZ21lbnQoZnJhZ21lbnRPdmVycmlkZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5yb3V0ZUhhbmRsZXIgP1xyXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMucm91dGVIYW5kbGVyKGZyYWdtZW50KSA6XHJcbiAgICAgICAgICAgIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcbkJyb3dzZXJIaXN0b3J5LmluamVjdCA9IFtMaW5rSGFuZGxlcl07XHJcbmNvbnN0IHJvdXRlU3RyaXBwZXIgPSAvXiM/XFwvKnxcXHMrJC9nO1xyXG5jb25zdCByb290U3RyaXBwZXIgPSAvXlxcLyt8XFwvKyQvZztcclxuY29uc3QgdHJhaWxpbmdTbGFzaCA9IC9cXC8kLztcclxuY29uc3QgYWJzb2x1dGVVcmwgPSAvXihbYS16XVthLXowLTkrXFwtLl0qOik/XFwvXFwvL2k7XHJcbmZ1bmN0aW9uIHVwZGF0ZUhhc2goJGxvY2F0aW9uLCBmcmFnbWVudCwgcmVwbGFjZSkge1xyXG4gICAgaWYgKHJlcGxhY2UpIHtcclxuICAgICAgICBsZXQgaHJlZiA9ICRsb2NhdGlvbi5ocmVmLnJlcGxhY2UoLyhqYXZhc2NyaXB0OnwjKS4qJC8sICcnKTtcclxuICAgICAgICAkbG9jYXRpb24ucmVwbGFjZShocmVmICsgJyMnICsgZnJhZ21lbnQpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgJGxvY2F0aW9uLmhhc2ggPSAnIycgKyBmcmFnbWVudDtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjcmVhdGVPcmlnaW4ocHJvdG9jb2wsIGhvc3RuYW1lLCBwb3J0KSB7XHJcbiAgICByZXR1cm4gYCR7cHJvdG9jb2x9Ly8ke2hvc3RuYW1lfSR7cG9ydCA/ICc6JyArIHBvcnQgOiAnJ31gO1xyXG59XG5cbmZ1bmN0aW9uIGNvbmZpZ3VyZShjb25maWcpIHtcclxuICAgIGNvbnN0ICRjb25maWcgPSBjb25maWc7XHJcbiAgICAkY29uZmlnLnNpbmdsZXRvbihIaXN0b3J5LCBCcm93c2VySGlzdG9yeSk7XHJcbiAgICAkY29uZmlnLnRyYW5zaWVudChMaW5rSGFuZGxlciwgRGVmYXVsdExpbmtIYW5kbGVyKTtcclxufVxuXG5leHBvcnQgeyBCcm93c2VySGlzdG9yeSwgRGVmYXVsdExpbmtIYW5kbGVyLCBMaW5rSGFuZGxlciwgY29uZmlndXJlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hdXJlbGlhLWhpc3RvcnktYnJvd3Nlci5qcy5tYXBcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///aurelia-history-browser\n");

/***/ }),

/***/ "aurelia-logging-console":
/*!*************************************************************************************!*\
  !*** ./node_modules/aurelia-logging-console/dist/es2015/aurelia-logging-console.js ***!
  \*************************************************************************************/
/*! exports provided: ConsoleAppender */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ConsoleAppender\", function() { return ConsoleAppender; });\n\nlet ConsoleAppender = class ConsoleAppender {\n  debug(logger, ...rest) {\n    console.debug(`DEBUG [${logger.id}]`, ...rest);\n  }\n\n  info(logger, ...rest) {\n    console.info(`INFO [${logger.id}]`, ...rest);\n  }\n\n  warn(logger, ...rest) {\n    console.warn(`WARN [${logger.id}]`, ...rest);\n  }\n\n  error(logger, ...rest) {\n    console.error(`ERROR [${logger.id}]`, ...rest);\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS1sb2dnaW5nLWNvbnNvbGUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS1sb2dnaW5nLWNvbnNvbGUvZGlzdC9lczIwMTUvYXVyZWxpYS1sb2dnaW5nLWNvbnNvbGUuanM/MjExNCJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBsZXQgQ29uc29sZUFwcGVuZGVyID0gY2xhc3MgQ29uc29sZUFwcGVuZGVyIHtcbiAgZGVidWcobG9nZ2VyLCAuLi5yZXN0KSB7XG4gICAgY29uc29sZS5kZWJ1ZyhgREVCVUcgWyR7bG9nZ2VyLmlkfV1gLCAuLi5yZXN0KTtcbiAgfVxuXG4gIGluZm8obG9nZ2VyLCAuLi5yZXN0KSB7XG4gICAgY29uc29sZS5pbmZvKGBJTkZPIFske2xvZ2dlci5pZH1dYCwgLi4ucmVzdCk7XG4gIH1cblxuICB3YXJuKGxvZ2dlciwgLi4ucmVzdCkge1xuICAgIGNvbnNvbGUud2FybihgV0FSTiBbJHtsb2dnZXIuaWR9XWAsIC4uLnJlc3QpO1xuICB9XG5cbiAgZXJyb3IobG9nZ2VyLCAuLi5yZXN0KSB7XG4gICAgY29uc29sZS5lcnJvcihgRVJST1IgWyR7bG9nZ2VyLmlkfV1gLCAuLi5yZXN0KTtcbiAgfVxufTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///aurelia-logging-console\n");

/***/ }),

/***/ "aurelia-pal-browser":
/*!*****************************************************************************!*\
  !*** ./node_modules/aurelia-pal-browser/dist/es2015/aurelia-pal-browser.js ***!
  \*****************************************************************************/
/*! exports provided: _PLATFORM, _FEATURE, _DOM, initialize */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_PLATFORM\", function() { return _PLATFORM; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_FEATURE\", function() { return _FEATURE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"_DOM\", function() { return _DOM; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"initialize\", function() { return initialize; });\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n\n\nconst _PLATFORM = {\n  location: window.location,\n  history: window.history,\n  addEventListener(eventName, callback, capture) {\n    this.global.addEventListener(eventName, callback, capture);\n  },\n  removeEventListener(eventName, callback, capture) {\n    this.global.removeEventListener(eventName, callback, capture);\n  },\n  performance: window.performance,\n  requestAnimationFrame(callback) {\n    return this.global.requestAnimationFrame(callback);\n  }\n};\n\nif (typeof FEATURE_NO_IE === 'undefined') {\n  function test() {}\n\n  if (test.name === undefined) {\n    Object.defineProperty(Function.prototype, 'name', {\n      get: function () {\n        let name = this.toString().match(/^\\s*function\\s*(\\S*)\\s*\\(/)[1];\n\n        Object.defineProperty(this, 'name', { value: name });\n        return name;\n      }\n    });\n  }\n}\n\nif (typeof FEATURE_NO_IE === 'undefined') {\n  if (!('classList' in document.createElement('_')) || document.createElementNS && !('classList' in document.createElementNS('http://www.w3.org/2000/svg', 'g'))) {\n    let protoProp = 'prototype';\n    let strTrim = String.prototype.trim;\n    let arrIndexOf = Array.prototype.indexOf;\n    let emptyArray = [];\n\n    let DOMEx = function (type, message) {\n      this.name = type;\n      this.code = DOMException[type];\n      this.message = message;\n    };\n\n    let checkTokenAndGetIndex = function (classList, token) {\n      if (token === '') {\n        throw new DOMEx('SYNTAX_ERR', 'An invalid or illegal string was specified');\n      }\n\n      if (/\\s/.test(token)) {\n        throw new DOMEx('INVALID_CHARACTER_ERR', 'String contains an invalid character');\n      }\n\n      return arrIndexOf.call(classList, token);\n    };\n\n    let ClassList = function (elem) {\n      let trimmedClasses = strTrim.call(elem.getAttribute('class') || '');\n      let classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : emptyArray;\n\n      for (let i = 0, ii = classes.length; i < ii; ++i) {\n        this.push(classes[i]);\n      }\n\n      this._updateClassName = function () {\n        elem.setAttribute('class', this.toString());\n      };\n    };\n\n    let classListProto = ClassList[protoProp] = [];\n\n    DOMEx[protoProp] = Error[protoProp];\n\n    classListProto.item = function (i) {\n      return this[i] || null;\n    };\n\n    classListProto.contains = function (token) {\n      token += '';\n      return checkTokenAndGetIndex(this, token) !== -1;\n    };\n\n    classListProto.add = function () {\n      let tokens = arguments;\n      let i = 0;\n      let ii = tokens.length;\n      let token;\n      let updated = false;\n\n      do {\n        token = tokens[i] + '';\n        if (checkTokenAndGetIndex(this, token) === -1) {\n          this.push(token);\n          updated = true;\n        }\n      } while (++i < ii);\n\n      if (updated) {\n        this._updateClassName();\n      }\n    };\n\n    classListProto.remove = function () {\n      let tokens = arguments;\n      let i = 0;\n      let ii = tokens.length;\n      let token;\n      let updated = false;\n      let index;\n\n      do {\n        token = tokens[i] + '';\n        index = checkTokenAndGetIndex(this, token);\n        while (index !== -1) {\n          this.splice(index, 1);\n          updated = true;\n          index = checkTokenAndGetIndex(this, token);\n        }\n      } while (++i < ii);\n\n      if (updated) {\n        this._updateClassName();\n      }\n    };\n\n    classListProto.toggle = function (token, force) {\n      token += '';\n\n      let result = this.contains(token);\n      let method = result ? force !== true && 'remove' : force !== false && 'add';\n\n      if (method) {\n        this[method](token);\n      }\n\n      if (force === true || force === false) {\n        return force;\n      }\n\n      return !result;\n    };\n\n    classListProto.toString = function () {\n      return this.join(' ');\n    };\n\n    Object.defineProperty(Element.prototype, 'classList', {\n      get: function () {\n        return new ClassList(this);\n      },\n      enumerable: true,\n      configurable: true\n    });\n  } else {\n    let testElement = document.createElement('_');\n    testElement.classList.add('c1', 'c2');\n\n    if (!testElement.classList.contains('c2')) {\n      let createMethod = function (method) {\n        let original = DOMTokenList.prototype[method];\n\n        DOMTokenList.prototype[method] = function (token) {\n          for (let i = 0, ii = arguments.length; i < ii; ++i) {\n            token = arguments[i];\n            original.call(this, token);\n          }\n        };\n      };\n\n      createMethod('add');\n      createMethod('remove');\n    }\n\n    testElement.classList.toggle('c3', false);\n\n    if (testElement.classList.contains('c3')) {\n      let _toggle = DOMTokenList.prototype.toggle;\n\n      DOMTokenList.prototype.toggle = function (token, force) {\n        if (1 in arguments && !this.contains(token) === !force) {\n          return force;\n        }\n\n        return _toggle.call(this, token);\n      };\n    }\n\n    testElement = null;\n  }\n}\n\nif (typeof FEATURE_NO_IE === 'undefined') {\n  // @license http://opensource.org/licenses/MIT\n  if ('performance' in window === false) {\n    window.performance = {};\n  }\n\n  if ('now' in window.performance === false) {\n    let nowOffset = Date.now();\n\n    if (performance.timing && performance.timing.navigationStart) {\n      nowOffset = performance.timing.navigationStart;\n    }\n\n    window.performance.now = function now() {\n      return Date.now() - nowOffset;\n    };\n  }\n\n  const startOffset = Date.now ? Date.now() : +new Date();\n  const _entries = [];\n  const _marksIndex = {};\n\n  function _filterEntries(key, value) {\n    var i = 0,\n        n = _entries.length,\n        result = [];\n    for (; i < n; i++) {\n      if (_entries[i][key] == value) {\n        result.push(_entries[i]);\n      }\n    }\n    return result;\n  }\n\n  function _clearEntries(type, name) {\n    var i = _entries.length,\n        entry;\n    while (i--) {\n      entry = _entries[i];\n      if (entry.entryType == type && (name === void 0 || entry.name == name)) {\n        _entries.splice(i, 1);\n      }\n    }\n  };\n\n  if (!window.performance.mark) {\n    window.performance.mark = window.performance.webkitMark || function (name) {\n      const mark = {\n        name,\n        entryType: \"mark\",\n        startTime: window.performance.now(),\n        duration: 0\n      };\n\n      _entries.push(mark);\n      _marksIndex[name] = mark;\n    };\n  }\n\n  if (!window.performance.measure) {\n    window.performance.measure = window.performance.webkitMeasure || function (name, startMark, endMark) {\n      startMark = _marksIndex[startMark].startTime;\n      endMark = _marksIndex[endMark].startTime;\n\n      _entries.push({\n        name,\n        entryType: \"measure\",\n        startTime: startMark,\n        duration: endMark - startMark\n      });\n    };\n  }\n\n  if (!window.performance.getEntriesByType) {\n    window.performance.getEntriesByType = window.performance.webkitGetEntriesByType || function (type) {\n      return _filterEntries(\"entryType\", type);\n    };\n  }\n\n  if (!window.performance.getEntriesByName) {\n    window.performance.getEntriesByName = window.performance.webkitGetEntriesByName || function (name) {\n      return _filterEntries(\"name\", name);\n    };\n  }\n\n  if (!window.performance.clearMarks) {\n    window.performance.clearMarks = window.performance.webkitClearMarks || function (name) {\n      _clearEntries(\"mark\", name);\n    };\n  }\n\n  if (!window.performance.clearMeasures) {\n    window.performance.clearMeasures = window.performance.webkitClearMeasures || function (name) {\n      _clearEntries(\"measure\", name);\n    };\n  }\n\n  _PLATFORM.performance = window.performance;\n}\n\nif (typeof FEATURE_NO_IE === 'undefined') {\n  let con = window.console = window.console || {};\n  let nop = function () {};\n\n  if (!con.memory) con.memory = {};\n  ('assert,clear,count,debug,dir,dirxml,error,exception,group,' + 'groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,' + 'show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn').split(',').forEach(m => {\n    if (!con[m]) con[m] = nop;\n  });\n\n  if (typeof con.log === 'object') {\n    'log,info,warn,error,assert,dir,clear,profile,profileEnd'.split(',').forEach(function (method) {\n      console[method] = this.bind(console[method], console);\n    }, Function.prototype.call);\n  }\n}\n\nif (typeof FEATURE_NO_IE === 'undefined') {\n  if (!window.CustomEvent || typeof window.CustomEvent !== 'function') {\n    let CustomEvent = function (event, params) {\n      params = params || {\n        bubbles: false,\n        cancelable: false,\n        detail: undefined\n      };\n\n      let evt = document.createEvent('CustomEvent');\n      evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n      return evt;\n    };\n\n    CustomEvent.prototype = window.Event.prototype;\n    window.CustomEvent = CustomEvent;\n  }\n}\n\nif (Element && !Element.prototype.matches) {\n  let proto = Element.prototype;\n  proto.matches = proto.matchesSelector || proto.mozMatchesSelector || proto.msMatchesSelector || proto.oMatchesSelector || proto.webkitMatchesSelector;\n}\n\nconst _FEATURE = {\n  shadowDOM: !!HTMLElement.prototype.attachShadow,\n  scopedCSS: 'scoped' in document.createElement('style'),\n  htmlTemplateElement: function () {\n    let d = document.createElement('div');\n    d.innerHTML = '<template></template>';\n    return 'content' in d.children[0];\n  }(),\n  mutationObserver: !!(window.MutationObserver || window.WebKitMutationObserver),\n  ensureHTMLTemplateElement: t => t\n};\n\nif (typeof FEATURE_NO_IE === 'undefined') {\n  function isSVGTemplate(el) {\n    return el.tagName === 'template' && el.namespaceURI === 'http://www.w3.org/2000/svg';\n  }\n\n  function fixSVGTemplateElement(el) {\n    let template = el.ownerDocument.createElement('template');\n    let attrs = el.attributes;\n    let length = attrs.length;\n    let attr;\n\n    el.parentNode.insertBefore(template, el);\n\n    while (length-- > 0) {\n      attr = attrs[length];\n      template.setAttribute(attr.name, attr.value);\n      el.removeAttribute(attr.name);\n    }\n\n    el.parentNode.removeChild(el);\n\n    return fixHTMLTemplateElement(template);\n  }\n\n  function fixHTMLTemplateElement(template) {\n    let content = template.content = document.createDocumentFragment();\n    let child;\n\n    while (child = template.firstChild) {\n      content.appendChild(child);\n    }\n\n    return template;\n  }\n\n  function fixHTMLTemplateElementRoot(template) {\n    let content = fixHTMLTemplateElement(template).content;\n    let childTemplates = content.querySelectorAll('template');\n\n    for (let i = 0, ii = childTemplates.length; i < ii; ++i) {\n      let child = childTemplates[i];\n\n      if (isSVGTemplate(child)) {\n        fixSVGTemplateElement(child);\n      } else {\n        fixHTMLTemplateElement(child);\n      }\n    }\n\n    return template;\n  }\n\n  if (!_FEATURE.htmlTemplateElement) {\n    _FEATURE.ensureHTMLTemplateElement = fixHTMLTemplateElementRoot;\n  }\n}\n\nlet shadowPoly = window.ShadowDOMPolyfill || null;\n\nconst _DOM = {\n  Element: Element,\n  NodeList: NodeList,\n  SVGElement: SVGElement,\n  boundary: 'aurelia-dom-boundary',\n  addEventListener(eventName, callback, capture) {\n    document.addEventListener(eventName, callback, capture);\n  },\n  removeEventListener(eventName, callback, capture) {\n    document.removeEventListener(eventName, callback, capture);\n  },\n  adoptNode(node) {\n    return document.adoptNode(node);\n  },\n  createAttribute(name) {\n    return document.createAttribute(name);\n  },\n  createElement(tagName) {\n    return document.createElement(tagName);\n  },\n  createTextNode(text) {\n    return document.createTextNode(text);\n  },\n  createComment(text) {\n    return document.createComment(text);\n  },\n  createDocumentFragment() {\n    return document.createDocumentFragment();\n  },\n  createTemplateElement() {\n    let template = document.createElement('template');\n    return _FEATURE.ensureHTMLTemplateElement(template);\n  },\n  createMutationObserver(callback) {\n    return new (window.MutationObserver || window.WebKitMutationObserver)(callback);\n  },\n  createCustomEvent(eventType, options) {\n    return new window.CustomEvent(eventType, options);\n  },\n  dispatchEvent(evt) {\n    document.dispatchEvent(evt);\n  },\n  getComputedStyle(element) {\n    return window.getComputedStyle(element);\n  },\n  getElementById(id) {\n    return document.getElementById(id);\n  },\n  querySelector(query) {\n    return document.querySelector(query);\n  },\n  querySelectorAll(query) {\n    return document.querySelectorAll(query);\n  },\n  nextElementSibling(element) {\n    if (element.nextElementSibling) {\n      return element.nextElementSibling;\n    }\n    do {\n      element = element.nextSibling;\n    } while (element && element.nodeType !== 1);\n    return element;\n  },\n  createTemplateFromMarkup(markup) {\n    let parser = document.createElement('div');\n    parser.innerHTML = markup;\n\n    let temp = parser.firstElementChild;\n    if (!temp || temp.nodeName !== 'TEMPLATE') {\n      throw new Error('Template markup must be wrapped in a <template> element e.g. <template> <!-- markup here --> </template>');\n    }\n\n    return _FEATURE.ensureHTMLTemplateElement(temp);\n  },\n  appendNode(newNode, parentNode) {\n    (parentNode || document.body).appendChild(newNode);\n  },\n  replaceNode(newNode, node, parentNode) {\n    if (node.parentNode) {\n      node.parentNode.replaceChild(newNode, node);\n    } else if (shadowPoly !== null) {\n      shadowPoly.unwrap(parentNode).replaceChild(shadowPoly.unwrap(newNode), shadowPoly.unwrap(node));\n    } else {\n      parentNode.replaceChild(newNode, node);\n    }\n  },\n  removeNode(node, parentNode) {\n    if (node.parentNode) {\n      node.parentNode.removeChild(node);\n    } else if (parentNode) {\n      if (shadowPoly !== null) {\n        shadowPoly.unwrap(parentNode).removeChild(shadowPoly.unwrap(node));\n      } else {\n        parentNode.removeChild(node);\n      }\n    }\n  },\n  injectStyles(styles, destination, prepend, id) {\n    if (id) {\n      let oldStyle = document.getElementById(id);\n      if (oldStyle) {\n        let isStyleTag = oldStyle.tagName.toLowerCase() === 'style';\n\n        if (isStyleTag) {\n          oldStyle.innerHTML = styles;\n          return;\n        }\n\n        throw new Error('The provided id does not indicate a style tag.');\n      }\n    }\n\n    let node = document.createElement('style');\n    node.innerHTML = styles;\n    node.type = 'text/css';\n\n    if (id) {\n      node.id = id;\n    }\n\n    destination = destination || document.head;\n\n    if (prepend && destination.childNodes.length > 0) {\n      destination.insertBefore(node, destination.childNodes[0]);\n    } else {\n      destination.appendChild(node);\n    }\n\n    return node;\n  }\n};\n\nfunction initialize() {\n  if (aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"isInitialized\"]) {\n    return;\n  }\n\n  Object(aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"initializePAL\"])((platform, feature, dom) => {\n    Object.assign(platform, _PLATFORM);\n    Object.assign(feature, _FEATURE);\n    Object.assign(dom, _DOM);\n\n    Object.defineProperty(dom, 'title', {\n      get: () => document.title,\n      set: value => {\n        document.title = value;\n      }\n    });\n\n    Object.defineProperty(dom, 'activeElement', {\n      get: () => document.activeElement\n    });\n\n    Object.defineProperty(platform, 'XMLHttpRequest', {\n      get: () => platform.global.XMLHttpRequest\n    });\n  });\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS1wYWwtYnJvd3Nlci5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXBhbC1icm93c2VyL2Rpc3QvZXMyMDE1L2F1cmVsaWEtcGFsLWJyb3dzZXIuanM/OTlkMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpbml0aWFsaXplUEFMLCBpc0luaXRpYWxpemVkIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuXG5leHBvcnQgY29uc3QgX1BMQVRGT1JNID0ge1xuICBsb2NhdGlvbjogd2luZG93LmxvY2F0aW9uLFxuICBoaXN0b3J5OiB3aW5kb3cuaGlzdG9yeSxcbiAgYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGNhbGxiYWNrLCBjYXB0dXJlKSB7XG4gICAgdGhpcy5nbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGNhbGxiYWNrLCBjYXB0dXJlKTtcbiAgfSxcbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGNhbGxiYWNrLCBjYXB0dXJlKSB7XG4gICAgdGhpcy5nbG9iYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGNhbGxiYWNrLCBjYXB0dXJlKTtcbiAgfSxcbiAgcGVyZm9ybWFuY2U6IHdpbmRvdy5wZXJmb3JtYW5jZSxcbiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2xvYmFsLnJlcXVlc3RBbmltYXRpb25GcmFtZShjYWxsYmFjayk7XG4gIH1cbn07XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19JRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgZnVuY3Rpb24gdGVzdCgpIHt9XG5cbiAgaWYgKHRlc3QubmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZ1bmN0aW9uLnByb3RvdHlwZSwgJ25hbWUnLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRvU3RyaW5nKCkubWF0Y2goL15cXHMqZnVuY3Rpb25cXHMqKFxcUyopXFxzKlxcKC8pWzFdO1xuXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsgdmFsdWU6IG5hbWUgfSk7XG4gICAgICAgIHJldHVybiBuYW1lO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19JRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgaWYgKCEoJ2NsYXNzTGlzdCcgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnXycpKSB8fCBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMgJiYgISgnY2xhc3NMaXN0JyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2cnKSkpIHtcbiAgICBsZXQgcHJvdG9Qcm9wID0gJ3Byb3RvdHlwZSc7XG4gICAgbGV0IHN0clRyaW0gPSBTdHJpbmcucHJvdG90eXBlLnRyaW07XG4gICAgbGV0IGFyckluZGV4T2YgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZjtcbiAgICBsZXQgZW1wdHlBcnJheSA9IFtdO1xuXG4gICAgbGV0IERPTUV4ID0gZnVuY3Rpb24gKHR5cGUsIG1lc3NhZ2UpIHtcbiAgICAgIHRoaXMubmFtZSA9IHR5cGU7XG4gICAgICB0aGlzLmNvZGUgPSBET01FeGNlcHRpb25bdHlwZV07XG4gICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIH07XG5cbiAgICBsZXQgY2hlY2tUb2tlbkFuZEdldEluZGV4ID0gZnVuY3Rpb24gKGNsYXNzTGlzdCwgdG9rZW4pIHtcbiAgICAgIGlmICh0b2tlbiA9PT0gJycpIHtcbiAgICAgICAgdGhyb3cgbmV3IERPTUV4KCdTWU5UQVhfRVJSJywgJ0FuIGludmFsaWQgb3IgaWxsZWdhbCBzdHJpbmcgd2FzIHNwZWNpZmllZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoL1xccy8udGVzdCh0b2tlbikpIHtcbiAgICAgICAgdGhyb3cgbmV3IERPTUV4KCdJTlZBTElEX0NIQVJBQ1RFUl9FUlInLCAnU3RyaW5nIGNvbnRhaW5zIGFuIGludmFsaWQgY2hhcmFjdGVyJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBhcnJJbmRleE9mLmNhbGwoY2xhc3NMaXN0LCB0b2tlbik7XG4gICAgfTtcblxuICAgIGxldCBDbGFzc0xpc3QgPSBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgbGV0IHRyaW1tZWRDbGFzc2VzID0gc3RyVHJpbS5jYWxsKGVsZW0uZ2V0QXR0cmlidXRlKCdjbGFzcycpIHx8ICcnKTtcbiAgICAgIGxldCBjbGFzc2VzID0gdHJpbW1lZENsYXNzZXMgPyB0cmltbWVkQ2xhc3Nlcy5zcGxpdCgvXFxzKy8pIDogZW1wdHlBcnJheTtcblxuICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gY2xhc3Nlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIHRoaXMucHVzaChjbGFzc2VzW2ldKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB0aGlzLnRvU3RyaW5nKCkpO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgbGV0IGNsYXNzTGlzdFByb3RvID0gQ2xhc3NMaXN0W3Byb3RvUHJvcF0gPSBbXTtcblxuICAgIERPTUV4W3Byb3RvUHJvcF0gPSBFcnJvcltwcm90b1Byb3BdO1xuXG4gICAgY2xhc3NMaXN0UHJvdG8uaXRlbSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICByZXR1cm4gdGhpc1tpXSB8fCBudWxsO1xuICAgIH07XG5cbiAgICBjbGFzc0xpc3RQcm90by5jb250YWlucyA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgdG9rZW4gKz0gJyc7XG4gICAgICByZXR1cm4gY2hlY2tUb2tlbkFuZEdldEluZGV4KHRoaXMsIHRva2VuKSAhPT0gLTE7XG4gICAgfTtcblxuICAgIGNsYXNzTGlzdFByb3RvLmFkZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB0b2tlbnMgPSBhcmd1bWVudHM7XG4gICAgICBsZXQgaSA9IDA7XG4gICAgICBsZXQgaWkgPSB0b2tlbnMubGVuZ3RoO1xuICAgICAgbGV0IHRva2VuO1xuICAgICAgbGV0IHVwZGF0ZWQgPSBmYWxzZTtcblxuICAgICAgZG8ge1xuICAgICAgICB0b2tlbiA9IHRva2Vuc1tpXSArICcnO1xuICAgICAgICBpZiAoY2hlY2tUb2tlbkFuZEdldEluZGV4KHRoaXMsIHRva2VuKSA9PT0gLTEpIHtcbiAgICAgICAgICB0aGlzLnB1c2godG9rZW4pO1xuICAgICAgICAgIHVwZGF0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9IHdoaWxlICgrK2kgPCBpaSk7XG5cbiAgICAgIGlmICh1cGRhdGVkKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUNsYXNzTmFtZSgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBjbGFzc0xpc3RQcm90by5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgdG9rZW5zID0gYXJndW1lbnRzO1xuICAgICAgbGV0IGkgPSAwO1xuICAgICAgbGV0IGlpID0gdG9rZW5zLmxlbmd0aDtcbiAgICAgIGxldCB0b2tlbjtcbiAgICAgIGxldCB1cGRhdGVkID0gZmFsc2U7XG4gICAgICBsZXQgaW5kZXg7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgdG9rZW4gPSB0b2tlbnNbaV0gKyAnJztcbiAgICAgICAgaW5kZXggPSBjaGVja1Rva2VuQW5kR2V0SW5kZXgodGhpcywgdG9rZW4pO1xuICAgICAgICB3aGlsZSAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgdGhpcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgIHVwZGF0ZWQgPSB0cnVlO1xuICAgICAgICAgIGluZGV4ID0gY2hlY2tUb2tlbkFuZEdldEluZGV4KHRoaXMsIHRva2VuKTtcbiAgICAgICAgfVxuICAgICAgfSB3aGlsZSAoKytpIDwgaWkpO1xuXG4gICAgICBpZiAodXBkYXRlZCkge1xuICAgICAgICB0aGlzLl91cGRhdGVDbGFzc05hbWUoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY2xhc3NMaXN0UHJvdG8udG9nZ2xlID0gZnVuY3Rpb24gKHRva2VuLCBmb3JjZSkge1xuICAgICAgdG9rZW4gKz0gJyc7XG5cbiAgICAgIGxldCByZXN1bHQgPSB0aGlzLmNvbnRhaW5zKHRva2VuKTtcbiAgICAgIGxldCBtZXRob2QgPSByZXN1bHQgPyBmb3JjZSAhPT0gdHJ1ZSAmJiAncmVtb3ZlJyA6IGZvcmNlICE9PSBmYWxzZSAmJiAnYWRkJztcblxuICAgICAgaWYgKG1ldGhvZCkge1xuICAgICAgICB0aGlzW21ldGhvZF0odG9rZW4pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZm9yY2UgPT09IHRydWUgfHwgZm9yY2UgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiBmb3JjZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICFyZXN1bHQ7XG4gICAgfTtcblxuICAgIGNsYXNzTGlzdFByb3RvLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuam9pbignICcpO1xuICAgIH07XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWxlbWVudC5wcm90b3R5cGUsICdjbGFzc0xpc3QnLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDbGFzc0xpc3QodGhpcyk7XG4gICAgICB9LFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGxldCB0ZXN0RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ18nKTtcbiAgICB0ZXN0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjMScsICdjMicpO1xuXG4gICAgaWYgKCF0ZXN0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2MyJykpIHtcbiAgICAgIGxldCBjcmVhdGVNZXRob2QgPSBmdW5jdGlvbiAobWV0aG9kKSB7XG4gICAgICAgIGxldCBvcmlnaW5hbCA9IERPTVRva2VuTGlzdC5wcm90b3R5cGVbbWV0aG9kXTtcblxuICAgICAgICBET01Ub2tlbkxpc3QucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgICAgdG9rZW4gPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBvcmlnaW5hbC5jYWxsKHRoaXMsIHRva2VuKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9O1xuXG4gICAgICBjcmVhdGVNZXRob2QoJ2FkZCcpO1xuICAgICAgY3JlYXRlTWV0aG9kKCdyZW1vdmUnKTtcbiAgICB9XG5cbiAgICB0ZXN0RWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdjMycsIGZhbHNlKTtcblxuICAgIGlmICh0ZXN0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2MzJykpIHtcbiAgICAgIGxldCBfdG9nZ2xlID0gRE9NVG9rZW5MaXN0LnByb3RvdHlwZS50b2dnbGU7XG5cbiAgICAgIERPTVRva2VuTGlzdC5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKHRva2VuLCBmb3JjZSkge1xuICAgICAgICBpZiAoMSBpbiBhcmd1bWVudHMgJiYgIXRoaXMuY29udGFpbnModG9rZW4pID09PSAhZm9yY2UpIHtcbiAgICAgICAgICByZXR1cm4gZm9yY2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gX3RvZ2dsZS5jYWxsKHRoaXMsIHRva2VuKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgdGVzdEVsZW1lbnQgPSBudWxsO1xuICB9XG59XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19JRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgLy8gQGxpY2Vuc2UgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVFxuICBpZiAoJ3BlcmZvcm1hbmNlJyBpbiB3aW5kb3cgPT09IGZhbHNlKSB7XG4gICAgd2luZG93LnBlcmZvcm1hbmNlID0ge307XG4gIH1cblxuICBpZiAoJ25vdycgaW4gd2luZG93LnBlcmZvcm1hbmNlID09PSBmYWxzZSkge1xuICAgIGxldCBub3dPZmZzZXQgPSBEYXRlLm5vdygpO1xuXG4gICAgaWYgKHBlcmZvcm1hbmNlLnRpbWluZyAmJiBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0KSB7XG4gICAgICBub3dPZmZzZXQgPSBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0O1xuICAgIH1cblxuICAgIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cgPSBmdW5jdGlvbiBub3coKSB7XG4gICAgICByZXR1cm4gRGF0ZS5ub3coKSAtIG5vd09mZnNldDtcbiAgICB9O1xuICB9XG5cbiAgY29uc3Qgc3RhcnRPZmZzZXQgPSBEYXRlLm5vdyA/IERhdGUubm93KCkgOiArbmV3IERhdGUoKTtcbiAgY29uc3QgX2VudHJpZXMgPSBbXTtcbiAgY29uc3QgX21hcmtzSW5kZXggPSB7fTtcblxuICBmdW5jdGlvbiBfZmlsdGVyRW50cmllcyhrZXksIHZhbHVlKSB7XG4gICAgdmFyIGkgPSAwLFxuICAgICAgICBuID0gX2VudHJpZXMubGVuZ3RoLFxuICAgICAgICByZXN1bHQgPSBbXTtcbiAgICBmb3IgKDsgaSA8IG47IGkrKykge1xuICAgICAgaWYgKF9lbnRyaWVzW2ldW2tleV0gPT0gdmFsdWUpIHtcbiAgICAgICAgcmVzdWx0LnB1c2goX2VudHJpZXNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgZnVuY3Rpb24gX2NsZWFyRW50cmllcyh0eXBlLCBuYW1lKSB7XG4gICAgdmFyIGkgPSBfZW50cmllcy5sZW5ndGgsXG4gICAgICAgIGVudHJ5O1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGVudHJ5ID0gX2VudHJpZXNbaV07XG4gICAgICBpZiAoZW50cnkuZW50cnlUeXBlID09IHR5cGUgJiYgKG5hbWUgPT09IHZvaWQgMCB8fCBlbnRyeS5uYW1lID09IG5hbWUpKSB7XG4gICAgICAgIF9lbnRyaWVzLnNwbGljZShpLCAxKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgaWYgKCF3aW5kb3cucGVyZm9ybWFuY2UubWFyaykge1xuICAgIHdpbmRvdy5wZXJmb3JtYW5jZS5tYXJrID0gd2luZG93LnBlcmZvcm1hbmNlLndlYmtpdE1hcmsgfHwgZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIGNvbnN0IG1hcmsgPSB7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGVudHJ5VHlwZTogXCJtYXJrXCIsXG4gICAgICAgIHN0YXJ0VGltZTogd2luZG93LnBlcmZvcm1hbmNlLm5vdygpLFxuICAgICAgICBkdXJhdGlvbjogMFxuICAgICAgfTtcblxuICAgICAgX2VudHJpZXMucHVzaChtYXJrKTtcbiAgICAgIF9tYXJrc0luZGV4W25hbWVdID0gbWFyaztcbiAgICB9O1xuICB9XG5cbiAgaWYgKCF3aW5kb3cucGVyZm9ybWFuY2UubWVhc3VyZSkge1xuICAgIHdpbmRvdy5wZXJmb3JtYW5jZS5tZWFzdXJlID0gd2luZG93LnBlcmZvcm1hbmNlLndlYmtpdE1lYXN1cmUgfHwgZnVuY3Rpb24gKG5hbWUsIHN0YXJ0TWFyaywgZW5kTWFyaykge1xuICAgICAgc3RhcnRNYXJrID0gX21hcmtzSW5kZXhbc3RhcnRNYXJrXS5zdGFydFRpbWU7XG4gICAgICBlbmRNYXJrID0gX21hcmtzSW5kZXhbZW5kTWFya10uc3RhcnRUaW1lO1xuXG4gICAgICBfZW50cmllcy5wdXNoKHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZW50cnlUeXBlOiBcIm1lYXN1cmVcIixcbiAgICAgICAgc3RhcnRUaW1lOiBzdGFydE1hcmssXG4gICAgICAgIGR1cmF0aW9uOiBlbmRNYXJrIC0gc3RhcnRNYXJrXG4gICAgICB9KTtcbiAgICB9O1xuICB9XG5cbiAgaWYgKCF3aW5kb3cucGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZSkge1xuICAgIHdpbmRvdy5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlID0gd2luZG93LnBlcmZvcm1hbmNlLndlYmtpdEdldEVudHJpZXNCeVR5cGUgfHwgZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgIHJldHVybiBfZmlsdGVyRW50cmllcyhcImVudHJ5VHlwZVwiLCB0eXBlKTtcbiAgICB9O1xuICB9XG5cbiAgaWYgKCF3aW5kb3cucGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5TmFtZSkge1xuICAgIHdpbmRvdy5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlOYW1lID0gd2luZG93LnBlcmZvcm1hbmNlLndlYmtpdEdldEVudHJpZXNCeU5hbWUgfHwgZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIHJldHVybiBfZmlsdGVyRW50cmllcyhcIm5hbWVcIiwgbmFtZSk7XG4gICAgfTtcbiAgfVxuXG4gIGlmICghd2luZG93LnBlcmZvcm1hbmNlLmNsZWFyTWFya3MpIHtcbiAgICB3aW5kb3cucGVyZm9ybWFuY2UuY2xlYXJNYXJrcyA9IHdpbmRvdy5wZXJmb3JtYW5jZS53ZWJraXRDbGVhck1hcmtzIHx8IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICBfY2xlYXJFbnRyaWVzKFwibWFya1wiLCBuYW1lKTtcbiAgICB9O1xuICB9XG5cbiAgaWYgKCF3aW5kb3cucGVyZm9ybWFuY2UuY2xlYXJNZWFzdXJlcykge1xuICAgIHdpbmRvdy5wZXJmb3JtYW5jZS5jbGVhck1lYXN1cmVzID0gd2luZG93LnBlcmZvcm1hbmNlLndlYmtpdENsZWFyTWVhc3VyZXMgfHwgZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIF9jbGVhckVudHJpZXMoXCJtZWFzdXJlXCIsIG5hbWUpO1xuICAgIH07XG4gIH1cblxuICBfUExBVEZPUk0ucGVyZm9ybWFuY2UgPSB3aW5kb3cucGVyZm9ybWFuY2U7XG59XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19JRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgbGV0IGNvbiA9IHdpbmRvdy5jb25zb2xlID0gd2luZG93LmNvbnNvbGUgfHwge307XG4gIGxldCBub3AgPSBmdW5jdGlvbiAoKSB7fTtcblxuICBpZiAoIWNvbi5tZW1vcnkpIGNvbi5tZW1vcnkgPSB7fTtcbiAgKCdhc3NlcnQsY2xlYXIsY291bnQsZGVidWcsZGlyLGRpcnhtbCxlcnJvcixleGNlcHRpb24sZ3JvdXAsJyArICdncm91cENvbGxhcHNlZCxncm91cEVuZCxpbmZvLGxvZyxtYXJrVGltZWxpbmUscHJvZmlsZSxwcm9maWxlcyxwcm9maWxlRW5kLCcgKyAnc2hvdyx0YWJsZSx0aW1lLHRpbWVFbmQsdGltZWxpbmUsdGltZWxpbmVFbmQsdGltZVN0YW1wLHRyYWNlLHdhcm4nKS5zcGxpdCgnLCcpLmZvckVhY2gobSA9PiB7XG4gICAgaWYgKCFjb25bbV0pIGNvblttXSA9IG5vcDtcbiAgfSk7XG5cbiAgaWYgKHR5cGVvZiBjb24ubG9nID09PSAnb2JqZWN0Jykge1xuICAgICdsb2csaW5mbyx3YXJuLGVycm9yLGFzc2VydCxkaXIsY2xlYXIscHJvZmlsZSxwcm9maWxlRW5kJy5zcGxpdCgnLCcpLmZvckVhY2goZnVuY3Rpb24gKG1ldGhvZCkge1xuICAgICAgY29uc29sZVttZXRob2RdID0gdGhpcy5iaW5kKGNvbnNvbGVbbWV0aG9kXSwgY29uc29sZSk7XG4gICAgfSwgRnVuY3Rpb24ucHJvdG90eXBlLmNhbGwpO1xuICB9XG59XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19JRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgaWYgKCF3aW5kb3cuQ3VzdG9tRXZlbnQgfHwgdHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIGxldCBDdXN0b21FdmVudCA9IGZ1bmN0aW9uIChldmVudCwgcGFyYW1zKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMgfHwge1xuICAgICAgICBidWJibGVzOiBmYWxzZSxcbiAgICAgICAgY2FuY2VsYWJsZTogZmFsc2UsXG4gICAgICAgIGRldGFpbDogdW5kZWZpbmVkXG4gICAgICB9O1xuXG4gICAgICBsZXQgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgICBldnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50LCBwYXJhbXMuYnViYmxlcywgcGFyYW1zLmNhbmNlbGFibGUsIHBhcmFtcy5kZXRhaWwpO1xuICAgICAgcmV0dXJuIGV2dDtcbiAgICB9O1xuXG4gICAgQ3VzdG9tRXZlbnQucHJvdG90eXBlID0gd2luZG93LkV2ZW50LnByb3RvdHlwZTtcbiAgICB3aW5kb3cuQ3VzdG9tRXZlbnQgPSBDdXN0b21FdmVudDtcbiAgfVxufVxuXG5pZiAoRWxlbWVudCAmJiAhRWxlbWVudC5wcm90b3R5cGUubWF0Y2hlcykge1xuICBsZXQgcHJvdG8gPSBFbGVtZW50LnByb3RvdHlwZTtcbiAgcHJvdG8ubWF0Y2hlcyA9IHByb3RvLm1hdGNoZXNTZWxlY3RvciB8fCBwcm90by5tb3pNYXRjaGVzU2VsZWN0b3IgfHwgcHJvdG8ubXNNYXRjaGVzU2VsZWN0b3IgfHwgcHJvdG8ub01hdGNoZXNTZWxlY3RvciB8fCBwcm90by53ZWJraXRNYXRjaGVzU2VsZWN0b3I7XG59XG5cbmV4cG9ydCBjb25zdCBfRkVBVFVSRSA9IHtcbiAgc2hhZG93RE9NOiAhIUhUTUxFbGVtZW50LnByb3RvdHlwZS5hdHRhY2hTaGFkb3csXG4gIHNjb3BlZENTUzogJ3Njb3BlZCcgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKSxcbiAgaHRtbFRlbXBsYXRlRWxlbWVudDogZnVuY3Rpb24gKCkge1xuICAgIGxldCBkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZC5pbm5lckhUTUwgPSAnPHRlbXBsYXRlPjwvdGVtcGxhdGU+JztcbiAgICByZXR1cm4gJ2NvbnRlbnQnIGluIGQuY2hpbGRyZW5bMF07XG4gIH0oKSxcbiAgbXV0YXRpb25PYnNlcnZlcjogISEod2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIpLFxuICBlbnN1cmVIVE1MVGVtcGxhdGVFbGVtZW50OiB0ID0+IHRcbn07XG5cbmlmICh0eXBlb2YgRkVBVFVSRV9OT19JRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgZnVuY3Rpb24gaXNTVkdUZW1wbGF0ZShlbCkge1xuICAgIHJldHVybiBlbC50YWdOYW1lID09PSAndGVtcGxhdGUnICYmIGVsLm5hbWVzcGFjZVVSSSA9PT0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJztcbiAgfVxuXG4gIGZ1bmN0aW9uIGZpeFNWR1RlbXBsYXRlRWxlbWVudChlbCkge1xuICAgIGxldCB0ZW1wbGF0ZSA9IGVsLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGVtcGxhdGUnKTtcbiAgICBsZXQgYXR0cnMgPSBlbC5hdHRyaWJ1dGVzO1xuICAgIGxldCBsZW5ndGggPSBhdHRycy5sZW5ndGg7XG4gICAgbGV0IGF0dHI7XG5cbiAgICBlbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0ZW1wbGF0ZSwgZWwpO1xuXG4gICAgd2hpbGUgKGxlbmd0aC0tID4gMCkge1xuICAgICAgYXR0ciA9IGF0dHJzW2xlbmd0aF07XG4gICAgICB0ZW1wbGF0ZS5zZXRBdHRyaWJ1dGUoYXR0ci5uYW1lLCBhdHRyLnZhbHVlKTtcbiAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZShhdHRyLm5hbWUpO1xuICAgIH1cblxuICAgIGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpO1xuXG4gICAgcmV0dXJuIGZpeEhUTUxUZW1wbGF0ZUVsZW1lbnQodGVtcGxhdGUpO1xuICB9XG5cbiAgZnVuY3Rpb24gZml4SFRNTFRlbXBsYXRlRWxlbWVudCh0ZW1wbGF0ZSkge1xuICAgIGxldCBjb250ZW50ID0gdGVtcGxhdGUuY29udGVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICBsZXQgY2hpbGQ7XG5cbiAgICB3aGlsZSAoY2hpbGQgPSB0ZW1wbGF0ZS5maXJzdENoaWxkKSB7XG4gICAgICBjb250ZW50LmFwcGVuZENoaWxkKGNoaWxkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGVtcGxhdGU7XG4gIH1cblxuICBmdW5jdGlvbiBmaXhIVE1MVGVtcGxhdGVFbGVtZW50Um9vdCh0ZW1wbGF0ZSkge1xuICAgIGxldCBjb250ZW50ID0gZml4SFRNTFRlbXBsYXRlRWxlbWVudCh0ZW1wbGF0ZSkuY29udGVudDtcbiAgICBsZXQgY2hpbGRUZW1wbGF0ZXMgPSBjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RlbXBsYXRlJyk7XG5cbiAgICBmb3IgKGxldCBpID0gMCwgaWkgPSBjaGlsZFRlbXBsYXRlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBsZXQgY2hpbGQgPSBjaGlsZFRlbXBsYXRlc1tpXTtcblxuICAgICAgaWYgKGlzU1ZHVGVtcGxhdGUoY2hpbGQpKSB7XG4gICAgICAgIGZpeFNWR1RlbXBsYXRlRWxlbWVudChjaGlsZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmaXhIVE1MVGVtcGxhdGVFbGVtZW50KGNoaWxkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGVtcGxhdGU7XG4gIH1cblxuICBpZiAoIV9GRUFUVVJFLmh0bWxUZW1wbGF0ZUVsZW1lbnQpIHtcbiAgICBfRkVBVFVSRS5lbnN1cmVIVE1MVGVtcGxhdGVFbGVtZW50ID0gZml4SFRNTFRlbXBsYXRlRWxlbWVudFJvb3Q7XG4gIH1cbn1cblxubGV0IHNoYWRvd1BvbHkgPSB3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwgfHwgbnVsbDtcblxuZXhwb3J0IGNvbnN0IF9ET00gPSB7XG4gIEVsZW1lbnQ6IEVsZW1lbnQsXG4gIE5vZGVMaXN0OiBOb2RlTGlzdCxcbiAgU1ZHRWxlbWVudDogU1ZHRWxlbWVudCxcbiAgYm91bmRhcnk6ICdhdXJlbGlhLWRvbS1ib3VuZGFyeScsXG4gIGFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBjYWxsYmFjaywgY2FwdHVyZSkge1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBjYWxsYmFjaywgY2FwdHVyZSk7XG4gIH0sXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBjYWxsYmFjaywgY2FwdHVyZSkge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBjYWxsYmFjaywgY2FwdHVyZSk7XG4gIH0sXG4gIGFkb3B0Tm9kZShub2RlKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmFkb3B0Tm9kZShub2RlKTtcbiAgfSxcbiAgY3JlYXRlQXR0cmlidXRlKG5hbWUpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlQXR0cmlidXRlKG5hbWUpO1xuICB9LFxuICBjcmVhdGVFbGVtZW50KHRhZ05hbWUpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcbiAgfSxcbiAgY3JlYXRlVGV4dE5vZGUodGV4dCkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KTtcbiAgfSxcbiAgY3JlYXRlQ29tbWVudCh0ZXh0KSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQodGV4dCk7XG4gIH0sXG4gIGNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgfSxcbiAgY3JlYXRlVGVtcGxhdGVFbGVtZW50KCkge1xuICAgIGxldCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RlbXBsYXRlJyk7XG4gICAgcmV0dXJuIF9GRUFUVVJFLmVuc3VyZUhUTUxUZW1wbGF0ZUVsZW1lbnQodGVtcGxhdGUpO1xuICB9LFxuICBjcmVhdGVNdXRhdGlvbk9ic2VydmVyKGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIG5ldyAod2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIpKGNhbGxiYWNrKTtcbiAgfSxcbiAgY3JlYXRlQ3VzdG9tRXZlbnQoZXZlbnRUeXBlLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIG5ldyB3aW5kb3cuQ3VzdG9tRXZlbnQoZXZlbnRUeXBlLCBvcHRpb25zKTtcbiAgfSxcbiAgZGlzcGF0Y2hFdmVudChldnQpIHtcbiAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGV2dCk7XG4gIH0sXG4gIGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkge1xuICAgIHJldHVybiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbiAgfSxcbiAgZ2V0RWxlbWVudEJ5SWQoaWQpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICB9LFxuICBxdWVyeVNlbGVjdG9yKHF1ZXJ5KSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocXVlcnkpO1xuICB9LFxuICBxdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpO1xuICB9LFxuICBuZXh0RWxlbWVudFNpYmxpbmcoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50Lm5leHRFbGVtZW50U2libGluZykge1xuICAgICAgcmV0dXJuIGVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgIH1cbiAgICBkbyB7XG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5uZXh0U2libGluZztcbiAgICB9IHdoaWxlIChlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgIT09IDEpO1xuICAgIHJldHVybiBlbGVtZW50O1xuICB9LFxuICBjcmVhdGVUZW1wbGF0ZUZyb21NYXJrdXAobWFya3VwKSB7XG4gICAgbGV0IHBhcnNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHBhcnNlci5pbm5lckhUTUwgPSBtYXJrdXA7XG5cbiAgICBsZXQgdGVtcCA9IHBhcnNlci5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICBpZiAoIXRlbXAgfHwgdGVtcC5ub2RlTmFtZSAhPT0gJ1RFTVBMQVRFJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUZW1wbGF0ZSBtYXJrdXAgbXVzdCBiZSB3cmFwcGVkIGluIGEgPHRlbXBsYXRlPiBlbGVtZW50IGUuZy4gPHRlbXBsYXRlPiA8IS0tIG1hcmt1cCBoZXJlIC0tPiA8L3RlbXBsYXRlPicpO1xuICAgIH1cblxuICAgIHJldHVybiBfRkVBVFVSRS5lbnN1cmVIVE1MVGVtcGxhdGVFbGVtZW50KHRlbXApO1xuICB9LFxuICBhcHBlbmROb2RlKG5ld05vZGUsIHBhcmVudE5vZGUpIHtcbiAgICAocGFyZW50Tm9kZSB8fCBkb2N1bWVudC5ib2R5KS5hcHBlbmRDaGlsZChuZXdOb2RlKTtcbiAgfSxcbiAgcmVwbGFjZU5vZGUobmV3Tm9kZSwgbm9kZSwgcGFyZW50Tm9kZSkge1xuICAgIGlmIChub2RlLnBhcmVudE5vZGUpIHtcbiAgICAgIG5vZGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3Tm9kZSwgbm9kZSk7XG4gICAgfSBlbHNlIGlmIChzaGFkb3dQb2x5ICE9PSBudWxsKSB7XG4gICAgICBzaGFkb3dQb2x5LnVud3JhcChwYXJlbnROb2RlKS5yZXBsYWNlQ2hpbGQoc2hhZG93UG9seS51bndyYXAobmV3Tm9kZSksIHNoYWRvd1BvbHkudW53cmFwKG5vZGUpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3Tm9kZSwgbm9kZSk7XG4gICAgfVxuICB9LFxuICByZW1vdmVOb2RlKG5vZGUsIHBhcmVudE5vZGUpIHtcbiAgICBpZiAobm9kZS5wYXJlbnROb2RlKSB7XG4gICAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgfSBlbHNlIGlmIChwYXJlbnROb2RlKSB7XG4gICAgICBpZiAoc2hhZG93UG9seSAhPT0gbnVsbCkge1xuICAgICAgICBzaGFkb3dQb2x5LnVud3JhcChwYXJlbnROb2RlKS5yZW1vdmVDaGlsZChzaGFkb3dQb2x5LnVud3JhcChub2RlKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgaW5qZWN0U3R5bGVzKHN0eWxlcywgZGVzdGluYXRpb24sIHByZXBlbmQsIGlkKSB7XG4gICAgaWYgKGlkKSB7XG4gICAgICBsZXQgb2xkU3R5bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgICBpZiAob2xkU3R5bGUpIHtcbiAgICAgICAgbGV0IGlzU3R5bGVUYWcgPSBvbGRTdHlsZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzdHlsZSc7XG5cbiAgICAgICAgaWYgKGlzU3R5bGVUYWcpIHtcbiAgICAgICAgICBvbGRTdHlsZS5pbm5lckhUTUwgPSBzdHlsZXM7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgcHJvdmlkZWQgaWQgZG9lcyBub3QgaW5kaWNhdGUgYSBzdHlsZSB0YWcuJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgIG5vZGUuaW5uZXJIVE1MID0gc3R5bGVzO1xuICAgIG5vZGUudHlwZSA9ICd0ZXh0L2Nzcyc7XG5cbiAgICBpZiAoaWQpIHtcbiAgICAgIG5vZGUuaWQgPSBpZDtcbiAgICB9XG5cbiAgICBkZXN0aW5hdGlvbiA9IGRlc3RpbmF0aW9uIHx8IGRvY3VtZW50LmhlYWQ7XG5cbiAgICBpZiAocHJlcGVuZCAmJiBkZXN0aW5hdGlvbi5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGRlc3RpbmF0aW9uLmluc2VydEJlZm9yZShub2RlLCBkZXN0aW5hdGlvbi5jaGlsZE5vZGVzWzBdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGVzdGluYXRpb24uYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplKCkge1xuICBpZiAoaXNJbml0aWFsaXplZCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGluaXRpYWxpemVQQUwoKHBsYXRmb3JtLCBmZWF0dXJlLCBkb20pID0+IHtcbiAgICBPYmplY3QuYXNzaWduKHBsYXRmb3JtLCBfUExBVEZPUk0pO1xuICAgIE9iamVjdC5hc3NpZ24oZmVhdHVyZSwgX0ZFQVRVUkUpO1xuICAgIE9iamVjdC5hc3NpZ24oZG9tLCBfRE9NKTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShkb20sICd0aXRsZScsIHtcbiAgICAgIGdldDogKCkgPT4gZG9jdW1lbnQudGl0bGUsXG4gICAgICBzZXQ6IHZhbHVlID0+IHtcbiAgICAgICAgZG9jdW1lbnQudGl0bGUgPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShkb20sICdhY3RpdmVFbGVtZW50Jywge1xuICAgICAgZ2V0OiAoKSA9PiBkb2N1bWVudC5hY3RpdmVFbGVtZW50XG4gICAgfSk7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxhdGZvcm0sICdYTUxIdHRwUmVxdWVzdCcsIHtcbiAgICAgIGdldDogKCkgPT4gcGxhdGZvcm0uZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0XG4gICAgfSk7XG4gIH0pO1xufSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///aurelia-pal-browser\n");

/***/ }),

/***/ "aurelia-templating-binding":
/*!*******************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-binding/dist/es2015/aurelia-templating-binding.js ***!
  \*******************************************************************************************/
/*! exports provided: AttributeMap, InterpolationBindingExpression, InterpolationBinding, ChildInterpolationBinding, LetExpression, LetBinding, LetInterpolationBindingExpression, LetInterpolationBinding, SyntaxInterpreter, TemplatingBindingLanguage, configure */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AttributeMap\", function() { return AttributeMap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InterpolationBindingExpression\", function() { return InterpolationBindingExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InterpolationBinding\", function() { return InterpolationBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ChildInterpolationBinding\", function() { return ChildInterpolationBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetExpression\", function() { return LetExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetBinding\", function() { return LetBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetInterpolationBindingExpression\", function() { return LetInterpolationBindingExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LetInterpolationBinding\", function() { return LetInterpolationBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SyntaxInterpreter\", function() { return SyntaxInterpreter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplatingBindingLanguage\", function() { return TemplatingBindingLanguage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-logging */ \"./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-binding */ \"./node_modules/aurelia-binding/dist/es2015/aurelia-binding.js\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-templating */ \"./node_modules/aurelia-templating/dist/es2015/aurelia-templating.js\");\nvar _class, _temp, _dec, _class2, _dec2, _class3, _class4, _temp2, _class5, _temp3;\n\n\n\n\n\nlet AttributeMap = (_temp = _class = class AttributeMap {\n\n  constructor(svg) {\n    this.elements = Object.create(null);\n    this.allElements = Object.create(null);\n\n    this.svg = svg;\n\n    this.registerUniversal('accesskey', 'accessKey');\n    this.registerUniversal('contenteditable', 'contentEditable');\n    this.registerUniversal('tabindex', 'tabIndex');\n    this.registerUniversal('textcontent', 'textContent');\n    this.registerUniversal('innerhtml', 'innerHTML');\n    this.registerUniversal('scrolltop', 'scrollTop');\n    this.registerUniversal('scrollleft', 'scrollLeft');\n    this.registerUniversal('readonly', 'readOnly');\n\n    this.register('label', 'for', 'htmlFor');\n\n    this.register('img', 'usemap', 'useMap');\n\n    this.register('input', 'maxlength', 'maxLength');\n    this.register('input', 'minlength', 'minLength');\n    this.register('input', 'formaction', 'formAction');\n    this.register('input', 'formenctype', 'formEncType');\n    this.register('input', 'formmethod', 'formMethod');\n    this.register('input', 'formnovalidate', 'formNoValidate');\n    this.register('input', 'formtarget', 'formTarget');\n\n    this.register('textarea', 'maxlength', 'maxLength');\n\n    this.register('td', 'rowspan', 'rowSpan');\n    this.register('td', 'colspan', 'colSpan');\n    this.register('th', 'rowspan', 'rowSpan');\n    this.register('th', 'colspan', 'colSpan');\n  }\n\n  register(elementName, attributeName, propertyName) {\n    elementName = elementName.toLowerCase();\n    attributeName = attributeName.toLowerCase();\n    const element = this.elements[elementName] = this.elements[elementName] || Object.create(null);\n    element[attributeName] = propertyName;\n  }\n\n  registerUniversal(attributeName, propertyName) {\n    attributeName = attributeName.toLowerCase();\n    this.allElements[attributeName] = propertyName;\n  }\n\n  map(elementName, attributeName) {\n    if (this.svg.isStandardSvgAttribute(elementName, attributeName)) {\n      return attributeName;\n    }\n    elementName = elementName.toLowerCase();\n    attributeName = attributeName.toLowerCase();\n    const element = this.elements[elementName];\n    if (element !== undefined && attributeName in element) {\n      return element[attributeName];\n    }\n    if (attributeName in this.allElements) {\n      return this.allElements[attributeName];\n    }\n\n    if (/(?:^data-)|(?:^aria-)|:/.test(attributeName)) {\n      return attributeName;\n    }\n    return Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"camelCase\"])(attributeName);\n  }\n}, _class.inject = [aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"SVGAnalyzer\"]], _temp);\n\nlet InterpolationBindingExpression = class InterpolationBindingExpression {\n  constructor(observerLocator, targetProperty, parts, mode, lookupFunctions, attribute) {\n    this.observerLocator = observerLocator;\n    this.targetProperty = targetProperty;\n    this.parts = parts;\n    this.mode = mode;\n    this.lookupFunctions = lookupFunctions;\n    this.attribute = this.attrToRemove = attribute;\n    this.discrete = false;\n  }\n\n  createBinding(target) {\n    if (this.parts.length === 3) {\n      return new ChildInterpolationBinding(target, this.observerLocator, this.parts[1], this.mode, this.lookupFunctions, this.targetProperty, this.parts[0], this.parts[2]);\n    }\n    return new InterpolationBinding(this.observerLocator, this.parts, target, this.targetProperty, this.mode, this.lookupFunctions);\n  }\n};\n\nfunction validateTarget(target, propertyName) {\n  if (propertyName === 'style') {\n    aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating-binding').info('Internet Explorer does not support interpolation in \"style\" attributes.  Use the style attribute\\'s alias, \"css\" instead.');\n  } else if (target.parentElement && target.parentElement.nodeName === 'TEXTAREA' && propertyName === 'textContent') {\n    throw new Error('Interpolation binding cannot be used in the content of a textarea element.  Use <textarea value.bind=\"expression\"></textarea> instead.');\n  }\n}\n\nlet InterpolationBinding = class InterpolationBinding {\n  constructor(observerLocator, parts, target, targetProperty, mode, lookupFunctions) {\n    validateTarget(target, targetProperty);\n    this.observerLocator = observerLocator;\n    this.parts = parts;\n    this.target = target;\n    this.targetProperty = targetProperty;\n    this.targetAccessor = observerLocator.getAccessor(target, targetProperty);\n    this.mode = mode;\n    this.lookupFunctions = lookupFunctions;\n  }\n\n  interpolate() {\n    if (this.isBound) {\n      let value = '';\n      let parts = this.parts;\n      for (let i = 0, ii = parts.length; i < ii; i++) {\n        value += i % 2 === 0 ? parts[i] : this[`childBinding${i}`].value;\n      }\n      this.targetAccessor.setValue(value, this.target, this.targetProperty);\n    }\n  }\n\n  updateOneTimeBindings() {\n    for (let i = 1, ii = this.parts.length; i < ii; i += 2) {\n      let child = this[`childBinding${i}`];\n      if (child.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime) {\n        child.call();\n      }\n    }\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n    this.source = source;\n\n    let parts = this.parts;\n    for (let i = 1, ii = parts.length; i < ii; i += 2) {\n      let binding = new ChildInterpolationBinding(this, this.observerLocator, parts[i], this.mode, this.lookupFunctions);\n      binding.bind(source);\n      this[`childBinding${i}`] = binding;\n    }\n\n    this.isBound = true;\n    this.interpolate();\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    this.source = null;\n    let parts = this.parts;\n    for (let i = 1, ii = parts.length; i < ii; i += 2) {\n      let name = `childBinding${i}`;\n      this[name].unbind();\n    }\n  }\n};\n\nlet ChildInterpolationBinding = (_dec = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"connectable\"])(), _dec(_class2 = class ChildInterpolationBinding {\n  constructor(target, observerLocator, sourceExpression, mode, lookupFunctions, targetProperty, left, right) {\n    if (target instanceof InterpolationBinding) {\n      this.parent = target;\n    } else {\n      validateTarget(target, targetProperty);\n      this.target = target;\n      this.targetProperty = targetProperty;\n      this.targetAccessor = observerLocator.getAccessor(target, targetProperty);\n    }\n    this.observerLocator = observerLocator;\n    this.sourceExpression = sourceExpression;\n    this.mode = mode;\n    this.lookupFunctions = lookupFunctions;\n    this.left = left;\n    this.right = right;\n  }\n\n  updateTarget(value) {\n    value = value === null || value === undefined ? '' : value.toString();\n    if (value !== this.value) {\n      this.value = value;\n      if (this.parent) {\n        this.parent.interpolate();\n      } else {\n        this.targetAccessor.setValue(this.left + value + this.right, this.target, this.targetProperty);\n      }\n    }\n  }\n\n  call() {\n    if (!this.isBound) {\n      return;\n    }\n\n    this.rawValue = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\n    this.updateTarget(this.rawValue);\n\n    if (this.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime) {\n      this._version++;\n      this.sourceExpression.connect(this, this.source);\n      if (this.rawValue instanceof Array) {\n        this.observeArray(this.rawValue);\n      }\n      this.unobserve(false);\n    }\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n    this.isBound = true;\n    this.source = source;\n\n    let sourceExpression = this.sourceExpression;\n    if (sourceExpression.bind) {\n      sourceExpression.bind(this, source, this.lookupFunctions);\n    }\n\n    this.rawValue = sourceExpression.evaluate(source, this.lookupFunctions);\n    this.updateTarget(this.rawValue);\n\n    if (this.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay) {\n      Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"enqueueBindingConnect\"])(this);\n    }\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    let sourceExpression = this.sourceExpression;\n    if (sourceExpression.unbind) {\n      sourceExpression.unbind(this, this.source);\n    }\n    this.source = null;\n    this.value = null;\n    this.rawValue = null;\n    this.unobserve(true);\n  }\n\n  connect(evaluate) {\n    if (!this.isBound) {\n      return;\n    }\n    if (evaluate) {\n      this.rawValue = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\n      this.updateTarget(this.rawValue);\n    }\n    this.sourceExpression.connect(this, this.source);\n    if (this.rawValue instanceof Array) {\n      this.observeArray(this.rawValue);\n    }\n  }\n}) || _class2);\n\nlet LetExpression = class LetExpression {\n  constructor(observerLocator, targetProperty, sourceExpression, lookupFunctions, toBindingContext) {\n    this.observerLocator = observerLocator;\n    this.sourceExpression = sourceExpression;\n    this.targetProperty = targetProperty;\n    this.lookupFunctions = lookupFunctions;\n    this.toBindingContext = toBindingContext;\n  }\n\n  createBinding() {\n    return new LetBinding(this.observerLocator, this.sourceExpression, this.targetProperty, this.lookupFunctions, this.toBindingContext);\n  }\n};\n\nlet LetBinding = (_dec2 = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"connectable\"])(), _dec2(_class3 = class LetBinding {\n  constructor(observerLocator, sourceExpression, targetProperty, lookupFunctions, toBindingContext) {\n    this.observerLocator = observerLocator;\n    this.sourceExpression = sourceExpression;\n    this.targetProperty = targetProperty;\n    this.lookupFunctions = lookupFunctions;\n    this.source = null;\n    this.target = null;\n    this.toBindingContext = toBindingContext;\n  }\n\n  updateTarget() {\n    const value = this.sourceExpression.evaluate(this.source, this.lookupFunctions);\n    this.target[this.targetProperty] = value;\n  }\n\n  call(context) {\n    if (!this.isBound) {\n      return;\n    }\n    if (context === aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"sourceContext\"]) {\n      this.updateTarget();\n      return;\n    }\n    throw new Error(`Unexpected call context ${context}`);\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.source = source;\n    this.target = this.toBindingContext ? source.bindingContext : source.overrideContext;\n\n    if (this.sourceExpression.bind) {\n      this.sourceExpression.bind(this, source, this.lookupFunctions);\n    }\n\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"enqueueBindingConnect\"])(this);\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    if (this.sourceExpression.unbind) {\n      this.sourceExpression.unbind(this, this.source);\n    }\n    this.source = null;\n    this.target = null;\n    this.unobserve(true);\n  }\n\n  connect() {\n    if (!this.isBound) {\n      return;\n    }\n    this.updateTarget();\n    this.sourceExpression.connect(this, this.source);\n  }\n}) || _class3);\n\nlet LetInterpolationBindingExpression = class LetInterpolationBindingExpression {\n  constructor(observerLocator, targetProperty, parts, lookupFunctions, toBindingContext) {\n    this.observerLocator = observerLocator;\n    this.targetProperty = targetProperty;\n    this.parts = parts;\n    this.lookupFunctions = lookupFunctions;\n    this.toBindingContext = toBindingContext;\n  }\n\n  createBinding() {\n    return new LetInterpolationBinding(this.observerLocator, this.targetProperty, this.parts, this.lookupFunctions, this.toBindingContext);\n  }\n};\n\nlet LetInterpolationBinding = class LetInterpolationBinding {\n  constructor(observerLocator, targetProperty, parts, lookupFunctions, toBindingContext) {\n    this.observerLocator = observerLocator;\n    this.parts = parts;\n    this.targetProperty = targetProperty;\n    this.lookupFunctions = lookupFunctions;\n    this.toBindingContext = toBindingContext;\n    this.target = null;\n  }\n\n  bind(source) {\n    if (this.isBound) {\n      if (this.source === source) {\n        return;\n      }\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.source = source;\n    this.target = this.toBindingContext ? source.bindingContext : source.overrideContext;\n\n    this.interpolationBinding = this.createInterpolationBinding();\n    this.interpolationBinding.bind(source);\n  }\n\n  unbind() {\n    if (!this.isBound) {\n      return;\n    }\n    this.isBound = false;\n    this.source = null;\n    this.target = null;\n    this.interpolationBinding.unbind();\n    this.interpolationBinding = null;\n  }\n\n  createInterpolationBinding() {\n    if (this.parts.length === 3) {\n      return new ChildInterpolationBinding(this.target, this.observerLocator, this.parts[1], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, this.lookupFunctions, this.targetProperty, this.parts[0], this.parts[2]);\n    }\n    return new InterpolationBinding(this.observerLocator, this.parts, this.target, this.targetProperty, aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, this.lookupFunctions);\n  }\n};\n\nlet SyntaxInterpreter = (_temp2 = _class4 = class SyntaxInterpreter {\n\n  constructor(parser, observerLocator, eventManager, attributeMap) {\n    this.parser = parser;\n    this.observerLocator = observerLocator;\n    this.eventManager = eventManager;\n    this.attributeMap = attributeMap;\n  }\n\n  interpret(resources, element, info, existingInstruction, context) {\n    if (info.command in this) {\n      return this[info.command](resources, element, info, existingInstruction, context);\n    }\n\n    return this.handleUnknownCommand(resources, element, info, existingInstruction, context);\n  }\n\n  handleUnknownCommand(resources, element, info, existingInstruction, context) {\n    aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating-binding').warn('Unknown binding command.', info);\n    return existingInstruction;\n  }\n\n  determineDefaultBindingMode(element, attrName, context) {\n    let tagName = element.tagName.toLowerCase();\n\n    if (tagName === 'input' && (attrName === 'value' || attrName === 'files') && element.type !== 'checkbox' && element.type !== 'radio' || tagName === 'input' && attrName === 'checked' && (element.type === 'checkbox' || element.type === 'radio') || (tagName === 'textarea' || tagName === 'select') && attrName === 'value' || (attrName === 'textcontent' || attrName === 'innerhtml') && element.contentEditable === 'true' || attrName === 'scrolltop' || attrName === 'scrollleft') {\n      return aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].twoWay;\n    }\n\n    if (context && attrName in context.attributes && context.attributes[attrName] && context.attributes[attrName].defaultBindingMode >= aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime) {\n      return context.attributes[attrName].defaultBindingMode;\n    }\n\n    return aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay;\n  }\n\n  bind(resources, element, info, existingInstruction, context) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), info.defaultBindingMode === undefined || info.defaultBindingMode === null ? this.determineDefaultBindingMode(element, info.attrName, context) : info.defaultBindingMode, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  trigger(resources, element, info) {\n    return new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ListenerExpression\"](this.eventManager, info.attrName, this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"delegationStrategy\"].none, true, resources.lookupFunctions);\n  }\n\n  capture(resources, element, info) {\n    return new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ListenerExpression\"](this.eventManager, info.attrName, this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"delegationStrategy\"].capturing, true, resources.lookupFunctions);\n  }\n\n  delegate(resources, element, info) {\n    return new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ListenerExpression\"](this.eventManager, info.attrName, this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"delegationStrategy\"].bubbling, true, resources.lookupFunctions);\n  }\n\n  call(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"CallExpression\"](this.observerLocator, info.attrName, this.parser.parse(info.attrValue), resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  options(resources, element, info, existingInstruction, context) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n    let attrValue = info.attrValue;\n    let language = this.language;\n    let name = null;\n    let target = '';\n    let current;\n    let i;\n    let ii;\n    let inString = false;\n    let inEscape = false;\n    let foundName = false;\n\n    for (i = 0, ii = attrValue.length; i < ii; ++i) {\n      current = attrValue[i];\n\n      if (current === ';' && !inString) {\n        if (!foundName) {\n          name = this._getPrimaryPropertyName(resources, context);\n        }\n        info = language.inspectAttribute(resources, '?', name, target.trim());\n        language.createAttributeInstruction(resources, element, info, instruction, context);\n\n        if (!instruction.attributes[info.attrName]) {\n          instruction.attributes[info.attrName] = info.attrValue;\n        }\n\n        target = '';\n        name = null;\n      } else if (current === ':' && name === null) {\n        foundName = true;\n        name = target.trim();\n        target = '';\n      } else if (current === '\\\\') {\n        target += current;\n        inEscape = true;\n        continue;\n      } else {\n        target += current;\n\n        if (name !== null && inEscape === false && current === '\\'') {\n          inString = !inString;\n        }\n      }\n\n      inEscape = false;\n    }\n\n    if (!foundName) {\n      name = this._getPrimaryPropertyName(resources, context);\n    }\n\n    if (name !== null) {\n      info = language.inspectAttribute(resources, '?', name, target.trim());\n      language.createAttributeInstruction(resources, element, info, instruction, context);\n\n      if (!instruction.attributes[info.attrName]) {\n        instruction.attributes[info.attrName] = info.attrValue;\n      }\n    }\n\n    return instruction;\n  }\n\n  _getPrimaryPropertyName(resources, context) {\n    let type = resources.getAttribute(context.attributeName);\n    if (type && type.primaryProperty) {\n      return type.primaryProperty.attribute;\n    }\n    return null;\n  }\n\n  'for'(resources, element, info, existingInstruction) {\n    let parts;\n    let keyValue;\n    let instruction;\n    let attrValue;\n    let isDestructuring;\n\n    attrValue = info.attrValue;\n    isDestructuring = attrValue.match(/^ *[[].+[\\]]/);\n    parts = isDestructuring ? attrValue.split('of ') : attrValue.split(' of ');\n\n    if (parts.length !== 2) {\n      throw new Error('Incorrect syntax for \"for\". The form is: \"$local of $items\" or \"[$key, $value] of $items\".');\n    }\n\n    instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    if (isDestructuring) {\n      keyValue = parts[0].replace(/[[\\]]/g, '').replace(/,/g, ' ').replace(/\\s+/g, ' ').trim().split(' ');\n      instruction.attributes.key = keyValue[0];\n      instruction.attributes.value = keyValue[1];\n    } else {\n      instruction.attributes.local = parts[0];\n    }\n\n    instruction.attributes.items = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, 'items', this.parser.parse(parts[1]), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  'two-way'(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].twoWay, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  'to-view'(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].toView, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  'from-view'(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].fromView, resources.lookupFunctions);\n\n    return instruction;\n  }\n\n  'one-time'(resources, element, info, existingInstruction) {\n    let instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(info.attrName);\n\n    instruction.attributes[info.attrName] = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"BindingExpression\"](this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneTime, resources.lookupFunctions);\n\n    return instruction;\n  }\n}, _class4.inject = [aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"Parser\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ObserverLocator\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"EventManager\"], AttributeMap], _temp2);\n\nSyntaxInterpreter.prototype['one-way'] = SyntaxInterpreter.prototype['to-view'];\n\nlet info = {};\n\nlet TemplatingBindingLanguage = (_temp3 = _class5 = class TemplatingBindingLanguage extends aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BindingLanguage\"] {\n\n  constructor(parser, observerLocator, syntaxInterpreter, attributeMap) {\n    super();\n    this.parser = parser;\n    this.observerLocator = observerLocator;\n    this.syntaxInterpreter = syntaxInterpreter;\n    this.emptyStringExpression = this.parser.parse('\\'\\'');\n    syntaxInterpreter.language = this;\n    this.attributeMap = attributeMap;\n    this.toBindingContextAttr = 'to-binding-context';\n  }\n\n  inspectAttribute(resources, elementName, attrName, attrValue) {\n    let parts = attrName.split('.');\n\n    info.defaultBindingMode = null;\n\n    if (parts.length === 2) {\n      info.attrName = parts[0].trim();\n      info.attrValue = attrValue;\n      info.command = parts[1].trim();\n\n      if (info.command === 'ref') {\n        info.expression = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"NameExpression\"](this.parser.parse(attrValue), info.attrName, resources.lookupFunctions);\n        info.command = null;\n        info.attrName = 'ref';\n      } else {\n        info.expression = null;\n      }\n    } else if (attrName === 'ref') {\n      info.attrName = attrName;\n      info.attrValue = attrValue;\n      info.command = null;\n      info.expression = new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"NameExpression\"](this.parser.parse(attrValue), 'element', resources.lookupFunctions);\n    } else {\n      info.attrName = attrName;\n      info.attrValue = attrValue;\n      info.command = null;\n      const interpolationParts = this.parseInterpolation(resources, attrValue);\n      if (interpolationParts === null) {\n        info.expression = null;\n      } else {\n        info.expression = new InterpolationBindingExpression(this.observerLocator, this.attributeMap.map(elementName, attrName), interpolationParts, aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, resources.lookupFunctions, attrName);\n      }\n    }\n\n    return info;\n  }\n\n  createAttributeInstruction(resources, element, theInfo, existingInstruction, context) {\n    let instruction;\n\n    if (theInfo.expression) {\n      if (theInfo.attrName === 'ref') {\n        return theInfo.expression;\n      }\n\n      instruction = existingInstruction || aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BehaviorInstruction\"].attribute(theInfo.attrName);\n      instruction.attributes[theInfo.attrName] = theInfo.expression;\n    } else if (theInfo.command) {\n      instruction = this.syntaxInterpreter.interpret(resources, element, theInfo, existingInstruction, context);\n    }\n\n    return instruction;\n  }\n\n  createLetExpressions(resources, letElement) {\n    let expressions = [];\n    let attributes = letElement.attributes;\n\n    let attr;\n\n    let parts;\n    let attrName;\n    let attrValue;\n    let command;\n    let toBindingContextAttr = this.toBindingContextAttr;\n    let toBindingContext = letElement.hasAttribute(toBindingContextAttr);\n    for (let i = 0, ii = attributes.length; ii > i; ++i) {\n      attr = attributes[i];\n      attrName = attr.name;\n      attrValue = attr.nodeValue;\n      parts = attrName.split('.');\n\n      if (attrName === toBindingContextAttr) {\n        continue;\n      }\n\n      if (parts.length === 2) {\n        command = parts[1];\n        if (command !== 'bind') {\n          aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating-binding-language').warn(`Detected invalid let command. Expected \"${parts[0]}.bind\", given \"${attrName}\"`);\n          continue;\n        }\n        expressions.push(new LetExpression(this.observerLocator, Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"camelCase\"])(parts[0]), this.parser.parse(attrValue), resources.lookupFunctions, toBindingContext));\n      } else {\n        attrName = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"camelCase\"])(attrName);\n        parts = this.parseInterpolation(resources, attrValue);\n        if (parts === null) {\n          aurelia_logging__WEBPACK_IMPORTED_MODULE_0__[\"getLogger\"]('templating-binding-language').warn(`Detected string literal in let bindings. Did you mean \"${attrName}.bind=${attrValue}\" or \"${attrName}=\\${${attrValue}}\" ?`);\n        }\n        if (parts) {\n          expressions.push(new LetInterpolationBindingExpression(this.observerLocator, attrName, parts, resources.lookupFunctions, toBindingContext));\n        } else {\n          expressions.push(new LetExpression(this.observerLocator, attrName, new aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"LiteralString\"](attrValue), resources.lookupFunctions, toBindingContext));\n        }\n      }\n    }\n    return expressions;\n  }\n\n  inspectTextContent(resources, value) {\n    const parts = this.parseInterpolation(resources, value);\n    if (parts === null) {\n      return null;\n    }\n    return new InterpolationBindingExpression(this.observerLocator, 'textContent', parts, aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"bindingMode\"].oneWay, resources.lookupFunctions, 'textContent');\n  }\n\n  parseInterpolation(resources, value) {\n    let i = value.indexOf('${', 0);\n    let ii = value.length;\n    let char;\n    let pos = 0;\n    let open = 0;\n    let quote = null;\n    let interpolationStart;\n    let parts;\n    let partIndex = 0;\n\n    while (i >= 0 && i < ii - 2) {\n      open = 1;\n      interpolationStart = i;\n      i += 2;\n\n      do {\n        char = value[i];\n        i++;\n\n        if (char === \"'\" || char === '\"') {\n          if (quote === null) {\n            quote = char;\n          } else if (quote === char) {\n            quote = null;\n          }\n          continue;\n        }\n\n        if (char === '\\\\') {\n          i++;\n          continue;\n        }\n\n        if (quote !== null) {\n          continue;\n        }\n\n        if (char === '{') {\n          open++;\n        } else if (char === '}') {\n          open--;\n        }\n      } while (open > 0 && i < ii);\n\n      if (open === 0) {\n        parts = parts || [];\n        if (value[interpolationStart - 1] === '\\\\' && value[interpolationStart - 2] !== '\\\\') {\n          parts[partIndex] = value.substring(pos, interpolationStart - 1) + value.substring(interpolationStart, i);\n          partIndex++;\n          parts[partIndex] = this.emptyStringExpression;\n          partIndex++;\n        } else {\n          parts[partIndex] = value.substring(pos, interpolationStart);\n          partIndex++;\n          parts[partIndex] = this.parser.parse(value.substring(interpolationStart + 2, i - 1));\n          partIndex++;\n        }\n        pos = i;\n        i = value.indexOf('${', i);\n      } else {\n        break;\n      }\n    }\n\n    if (partIndex === 0) {\n      return null;\n    }\n\n    parts[partIndex] = value.substr(pos);\n    return parts;\n  }\n}, _class5.inject = [aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"Parser\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_1__[\"ObserverLocator\"], SyntaxInterpreter, AttributeMap], _temp3);\n\nfunction configure(config) {\n  config.container.registerSingleton(aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BindingLanguage\"], TemplatingBindingLanguage);\n  config.container.registerAlias(aurelia_templating__WEBPACK_IMPORTED_MODULE_2__[\"BindingLanguage\"], TemplatingBindingLanguage);\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcvZGlzdC9lczIwMTUvYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcuanM/NTcxNSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX2NsYXNzLCBfdGVtcCwgX2RlYywgX2NsYXNzMiwgX2RlYzIsIF9jbGFzczMsIF9jbGFzczQsIF90ZW1wMiwgX2NsYXNzNSwgX3RlbXAzO1xuXG5pbXBvcnQgKiBhcyBMb2dNYW5hZ2VyIGZyb20gJ2F1cmVsaWEtbG9nZ2luZyc7XG5pbXBvcnQgeyBjYW1lbENhc2UsIFNWR0FuYWx5emVyLCBiaW5kaW5nTW9kZSwgY29ubmVjdGFibGUsIGVucXVldWVCaW5kaW5nQ29ubmVjdCwgc291cmNlQ29udGV4dCwgUGFyc2VyLCBPYnNlcnZlckxvY2F0b3IsIEV2ZW50TWFuYWdlciwgTGlzdGVuZXJFeHByZXNzaW9uLCBCaW5kaW5nRXhwcmVzc2lvbiwgQ2FsbEV4cHJlc3Npb24sIGRlbGVnYXRpb25TdHJhdGVneSwgTmFtZUV4cHJlc3Npb24sIExpdGVyYWxTdHJpbmcgfSBmcm9tICdhdXJlbGlhLWJpbmRpbmcnO1xuaW1wb3J0IHsgQmVoYXZpb3JJbnN0cnVjdGlvbiwgQmluZGluZ0xhbmd1YWdlIH0gZnJvbSAnYXVyZWxpYS10ZW1wbGF0aW5nJztcblxuZXhwb3J0IGxldCBBdHRyaWJ1dGVNYXAgPSAoX3RlbXAgPSBfY2xhc3MgPSBjbGFzcyBBdHRyaWJ1dGVNYXAge1xuXG4gIGNvbnN0cnVjdG9yKHN2Zykge1xuICAgIHRoaXMuZWxlbWVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRoaXMuYWxsRWxlbWVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXG4gICAgdGhpcy5zdmcgPSBzdmc7XG5cbiAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCdhY2Nlc3NrZXknLCAnYWNjZXNzS2V5Jyk7XG4gICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgnY29udGVudGVkaXRhYmxlJywgJ2NvbnRlbnRFZGl0YWJsZScpO1xuICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ3RhYmluZGV4JywgJ3RhYkluZGV4Jyk7XG4gICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgndGV4dGNvbnRlbnQnLCAndGV4dENvbnRlbnQnKTtcbiAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCdpbm5lcmh0bWwnLCAnaW5uZXJIVE1MJyk7XG4gICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgnc2Nyb2xsdG9wJywgJ3Njcm9sbFRvcCcpO1xuICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ3Njcm9sbGxlZnQnLCAnc2Nyb2xsTGVmdCcpO1xuICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ3JlYWRvbmx5JywgJ3JlYWRPbmx5Jyk7XG5cbiAgICB0aGlzLnJlZ2lzdGVyKCdsYWJlbCcsICdmb3InLCAnaHRtbEZvcicpO1xuXG4gICAgdGhpcy5yZWdpc3RlcignaW1nJywgJ3VzZW1hcCcsICd1c2VNYXAnKTtcblxuICAgIHRoaXMucmVnaXN0ZXIoJ2lucHV0JywgJ21heGxlbmd0aCcsICdtYXhMZW5ndGgnKTtcbiAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdtaW5sZW5ndGgnLCAnbWluTGVuZ3RoJyk7XG4gICAgdGhpcy5yZWdpc3RlcignaW5wdXQnLCAnZm9ybWFjdGlvbicsICdmb3JtQWN0aW9uJyk7XG4gICAgdGhpcy5yZWdpc3RlcignaW5wdXQnLCAnZm9ybWVuY3R5cGUnLCAnZm9ybUVuY1R5cGUnKTtcbiAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdmb3JtbWV0aG9kJywgJ2Zvcm1NZXRob2QnKTtcbiAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdmb3Jtbm92YWxpZGF0ZScsICdmb3JtTm9WYWxpZGF0ZScpO1xuICAgIHRoaXMucmVnaXN0ZXIoJ2lucHV0JywgJ2Zvcm10YXJnZXQnLCAnZm9ybVRhcmdldCcpO1xuXG4gICAgdGhpcy5yZWdpc3RlcigndGV4dGFyZWEnLCAnbWF4bGVuZ3RoJywgJ21heExlbmd0aCcpO1xuXG4gICAgdGhpcy5yZWdpc3RlcigndGQnLCAncm93c3BhbicsICdyb3dTcGFuJyk7XG4gICAgdGhpcy5yZWdpc3RlcigndGQnLCAnY29sc3BhbicsICdjb2xTcGFuJyk7XG4gICAgdGhpcy5yZWdpc3RlcigndGgnLCAncm93c3BhbicsICdyb3dTcGFuJyk7XG4gICAgdGhpcy5yZWdpc3RlcigndGgnLCAnY29sc3BhbicsICdjb2xTcGFuJyk7XG4gIH1cblxuICByZWdpc3RlcihlbGVtZW50TmFtZSwgYXR0cmlidXRlTmFtZSwgcHJvcGVydHlOYW1lKSB7XG4gICAgZWxlbWVudE5hbWUgPSBlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIGF0dHJpYnV0ZU5hbWUgPSBhdHRyaWJ1dGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudHNbZWxlbWVudE5hbWVdID0gdGhpcy5lbGVtZW50c1tlbGVtZW50TmFtZV0gfHwgT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICBlbGVtZW50W2F0dHJpYnV0ZU5hbWVdID0gcHJvcGVydHlOYW1lO1xuICB9XG5cbiAgcmVnaXN0ZXJVbml2ZXJzYWwoYXR0cmlidXRlTmFtZSwgcHJvcGVydHlOYW1lKSB7XG4gICAgYXR0cmlidXRlTmFtZSA9IGF0dHJpYnV0ZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICB0aGlzLmFsbEVsZW1lbnRzW2F0dHJpYnV0ZU5hbWVdID0gcHJvcGVydHlOYW1lO1xuICB9XG5cbiAgbWFwKGVsZW1lbnROYW1lLCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgaWYgKHRoaXMuc3ZnLmlzU3RhbmRhcmRTdmdBdHRyaWJ1dGUoZWxlbWVudE5hbWUsIGF0dHJpYnV0ZU5hbWUpKSB7XG4gICAgICByZXR1cm4gYXR0cmlidXRlTmFtZTtcbiAgICB9XG4gICAgZWxlbWVudE5hbWUgPSBlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIGF0dHJpYnV0ZU5hbWUgPSBhdHRyaWJ1dGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudHNbZWxlbWVudE5hbWVdO1xuICAgIGlmIChlbGVtZW50ICE9PSB1bmRlZmluZWQgJiYgYXR0cmlidXRlTmFtZSBpbiBlbGVtZW50KSB7XG4gICAgICByZXR1cm4gZWxlbWVudFthdHRyaWJ1dGVOYW1lXTtcbiAgICB9XG4gICAgaWYgKGF0dHJpYnV0ZU5hbWUgaW4gdGhpcy5hbGxFbGVtZW50cykge1xuICAgICAgcmV0dXJuIHRoaXMuYWxsRWxlbWVudHNbYXR0cmlidXRlTmFtZV07XG4gICAgfVxuXG4gICAgaWYgKC8oPzpeZGF0YS0pfCg/Ol5hcmlhLSl8Oi8udGVzdChhdHRyaWJ1dGVOYW1lKSkge1xuICAgICAgcmV0dXJuIGF0dHJpYnV0ZU5hbWU7XG4gICAgfVxuICAgIHJldHVybiBjYW1lbENhc2UoYXR0cmlidXRlTmFtZSk7XG4gIH1cbn0sIF9jbGFzcy5pbmplY3QgPSBbU1ZHQW5hbHl6ZXJdLCBfdGVtcCk7XG5cbmV4cG9ydCBsZXQgSW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uID0gY2xhc3MgSW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uIHtcbiAgY29uc3RydWN0b3Iob2JzZXJ2ZXJMb2NhdG9yLCB0YXJnZXRQcm9wZXJ0eSwgcGFydHMsIG1vZGUsIGxvb2t1cEZ1bmN0aW9ucywgYXR0cmlidXRlKSB7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFByb3BlcnR5O1xuICAgIHRoaXMucGFydHMgPSBwYXJ0cztcbiAgICB0aGlzLm1vZGUgPSBtb2RlO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICAgIHRoaXMuYXR0cmlidXRlID0gdGhpcy5hdHRyVG9SZW1vdmUgPSBhdHRyaWJ1dGU7XG4gICAgdGhpcy5kaXNjcmV0ZSA9IGZhbHNlO1xuICB9XG5cbiAgY3JlYXRlQmluZGluZyh0YXJnZXQpIHtcbiAgICBpZiAodGhpcy5wYXJ0cy5sZW5ndGggPT09IDMpIHtcbiAgICAgIHJldHVybiBuZXcgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyh0YXJnZXQsIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLnBhcnRzWzFdLCB0aGlzLm1vZGUsIHRoaXMubG9va3VwRnVuY3Rpb25zLCB0aGlzLnRhcmdldFByb3BlcnR5LCB0aGlzLnBhcnRzWzBdLCB0aGlzLnBhcnRzWzJdKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBJbnRlcnBvbGF0aW9uQmluZGluZyh0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5wYXJ0cywgdGFyZ2V0LCB0aGlzLnRhcmdldFByb3BlcnR5LCB0aGlzLm1vZGUsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gdmFsaWRhdGVUYXJnZXQodGFyZ2V0LCBwcm9wZXJ0eU5hbWUpIHtcbiAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ3N0eWxlJykge1xuICAgIExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCd0ZW1wbGF0aW5nLWJpbmRpbmcnKS5pbmZvKCdJbnRlcm5ldCBFeHBsb3JlciBkb2VzIG5vdCBzdXBwb3J0IGludGVycG9sYXRpb24gaW4gXCJzdHlsZVwiIGF0dHJpYnV0ZXMuICBVc2UgdGhlIHN0eWxlIGF0dHJpYnV0ZVxcJ3MgYWxpYXMsIFwiY3NzXCIgaW5zdGVhZC4nKTtcbiAgfSBlbHNlIGlmICh0YXJnZXQucGFyZW50RWxlbWVudCAmJiB0YXJnZXQucGFyZW50RWxlbWVudC5ub2RlTmFtZSA9PT0gJ1RFWFRBUkVBJyAmJiBwcm9wZXJ0eU5hbWUgPT09ICd0ZXh0Q29udGVudCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGVycG9sYXRpb24gYmluZGluZyBjYW5ub3QgYmUgdXNlZCBpbiB0aGUgY29udGVudCBvZiBhIHRleHRhcmVhIGVsZW1lbnQuICBVc2UgPHRleHRhcmVhIHZhbHVlLmJpbmQ9XCJleHByZXNzaW9uXCI+PC90ZXh0YXJlYT4gaW5zdGVhZC4nKTtcbiAgfVxufVxuXG5leHBvcnQgbGV0IEludGVycG9sYXRpb25CaW5kaW5nID0gY2xhc3MgSW50ZXJwb2xhdGlvbkJpbmRpbmcge1xuICBjb25zdHJ1Y3RvcihvYnNlcnZlckxvY2F0b3IsIHBhcnRzLCB0YXJnZXQsIHRhcmdldFByb3BlcnR5LCBtb2RlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICB2YWxpZGF0ZVRhcmdldCh0YXJnZXQsIHRhcmdldFByb3BlcnR5KTtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnBhcnRzID0gcGFydHM7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFByb3BlcnR5O1xuICAgIHRoaXMudGFyZ2V0QWNjZXNzb3IgPSBvYnNlcnZlckxvY2F0b3IuZ2V0QWNjZXNzb3IodGFyZ2V0LCB0YXJnZXRQcm9wZXJ0eSk7XG4gICAgdGhpcy5tb2RlID0gbW9kZTtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgfVxuXG4gIGludGVycG9sYXRlKCkge1xuICAgIGlmICh0aGlzLmlzQm91bmQpIHtcbiAgICAgIGxldCB2YWx1ZSA9ICcnO1xuICAgICAgbGV0IHBhcnRzID0gdGhpcy5wYXJ0cztcbiAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHBhcnRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcbiAgICAgICAgdmFsdWUgKz0gaSAlIDIgPT09IDAgPyBwYXJ0c1tpXSA6IHRoaXNbYGNoaWxkQmluZGluZyR7aX1gXS52YWx1ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMudGFyZ2V0QWNjZXNzb3Iuc2V0VmFsdWUodmFsdWUsIHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldFByb3BlcnR5KTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVPbmVUaW1lQmluZGluZ3MoKSB7XG4gICAgZm9yIChsZXQgaSA9IDEsIGlpID0gdGhpcy5wYXJ0cy5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7XG4gICAgICBsZXQgY2hpbGQgPSB0aGlzW2BjaGlsZEJpbmRpbmcke2l9YF07XG4gICAgICBpZiAoY2hpbGQubW9kZSA9PT0gYmluZGluZ01vZGUub25lVGltZSkge1xuICAgICAgICBjaGlsZC5jYWxsKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYmluZChzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblxuICAgIGxldCBwYXJ0cyA9IHRoaXMucGFydHM7XG4gICAgZm9yIChsZXQgaSA9IDEsIGlpID0gcGFydHMubGVuZ3RoOyBpIDwgaWk7IGkgKz0gMikge1xuICAgICAgbGV0IGJpbmRpbmcgPSBuZXcgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyh0aGlzLCB0aGlzLm9ic2VydmVyTG9jYXRvciwgcGFydHNbaV0sIHRoaXMubW9kZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgICAgYmluZGluZy5iaW5kKHNvdXJjZSk7XG4gICAgICB0aGlzW2BjaGlsZEJpbmRpbmcke2l9YF0gPSBiaW5kaW5nO1xuICAgIH1cblxuICAgIHRoaXMuaXNCb3VuZCA9IHRydWU7XG4gICAgdGhpcy5pbnRlcnBvbGF0ZSgpO1xuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICBsZXQgcGFydHMgPSB0aGlzLnBhcnRzO1xuICAgIGZvciAobGV0IGkgPSAxLCBpaSA9IHBhcnRzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHtcbiAgICAgIGxldCBuYW1lID0gYGNoaWxkQmluZGluZyR7aX1gO1xuICAgICAgdGhpc1tuYW1lXS51bmJpbmQoKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyA9IChfZGVjID0gY29ubmVjdGFibGUoKSwgX2RlYyhfY2xhc3MyID0gY2xhc3MgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyB7XG4gIGNvbnN0cnVjdG9yKHRhcmdldCwgb2JzZXJ2ZXJMb2NhdG9yLCBzb3VyY2VFeHByZXNzaW9uLCBtb2RlLCBsb29rdXBGdW5jdGlvbnMsIHRhcmdldFByb3BlcnR5LCBsZWZ0LCByaWdodCkge1xuICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBJbnRlcnBvbGF0aW9uQmluZGluZykge1xuICAgICAgdGhpcy5wYXJlbnQgPSB0YXJnZXQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbGlkYXRlVGFyZ2V0KHRhcmdldCwgdGFyZ2V0UHJvcGVydHkpO1xuICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XG4gICAgICB0aGlzLnRhcmdldEFjY2Vzc29yID0gb2JzZXJ2ZXJMb2NhdG9yLmdldEFjY2Vzc29yKHRhcmdldCwgdGFyZ2V0UHJvcGVydHkpO1xuICAgIH1cbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMubW9kZSA9IG1vZGU7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gICAgdGhpcy5sZWZ0ID0gbGVmdDtcbiAgICB0aGlzLnJpZ2h0ID0gcmlnaHQ7XG4gIH1cblxuICB1cGRhdGVUYXJnZXQodmFsdWUpIHtcbiAgICB2YWx1ZSA9IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgPyAnJyA6IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgaWYgKHZhbHVlICE9PSB0aGlzLnZhbHVlKSB7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQuaW50ZXJwb2xhdGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudGFyZ2V0QWNjZXNzb3Iuc2V0VmFsdWUodGhpcy5sZWZ0ICsgdmFsdWUgKyB0aGlzLnJpZ2h0LCB0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY2FsbCgpIHtcbiAgICBpZiAoIXRoaXMuaXNCb3VuZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMucmF3VmFsdWUgPSB0aGlzLnNvdXJjZUV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICB0aGlzLnVwZGF0ZVRhcmdldCh0aGlzLnJhd1ZhbHVlKTtcblxuICAgIGlmICh0aGlzLm1vZGUgIT09IGJpbmRpbmdNb2RlLm9uZVRpbWUpIHtcbiAgICAgIHRoaXMuX3ZlcnNpb24rKztcbiAgICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbi5jb25uZWN0KHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICAgIGlmICh0aGlzLnJhd1ZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlQXJyYXkodGhpcy5yYXdWYWx1ZSk7XG4gICAgICB9XG4gICAgICB0aGlzLnVub2JzZXJ2ZShmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgYmluZChzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXG4gICAgbGV0IHNvdXJjZUV4cHJlc3Npb24gPSB0aGlzLnNvdXJjZUV4cHJlc3Npb247XG4gICAgaWYgKHNvdXJjZUV4cHJlc3Npb24uYmluZCkge1xuICAgICAgc291cmNlRXhwcmVzc2lvbi5iaW5kKHRoaXMsIHNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgIH1cblxuICAgIHRoaXMucmF3VmFsdWUgPSBzb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgIHRoaXMudXBkYXRlVGFyZ2V0KHRoaXMucmF3VmFsdWUpO1xuXG4gICAgaWYgKHRoaXMubW9kZSA9PT0gYmluZGluZ01vZGUub25lV2F5KSB7XG4gICAgICBlbnF1ZXVlQmluZGluZ0Nvbm5lY3QodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIGxldCBzb3VyY2VFeHByZXNzaW9uID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uO1xuICAgIGlmIChzb3VyY2VFeHByZXNzaW9uLnVuYmluZCkge1xuICAgICAgc291cmNlRXhwcmVzc2lvbi51bmJpbmQodGhpcywgdGhpcy5zb3VyY2UpO1xuICAgIH1cbiAgICB0aGlzLnNvdXJjZSA9IG51bGw7XG4gICAgdGhpcy52YWx1ZSA9IG51bGw7XG4gICAgdGhpcy5yYXdWYWx1ZSA9IG51bGw7XG4gICAgdGhpcy51bm9ic2VydmUodHJ1ZSk7XG4gIH1cblxuICBjb25uZWN0KGV2YWx1YXRlKSB7XG4gICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGV2YWx1YXRlKSB7XG4gICAgICB0aGlzLnJhd1ZhbHVlID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgICB0aGlzLnVwZGF0ZVRhcmdldCh0aGlzLnJhd1ZhbHVlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmNvbm5lY3QodGhpcywgdGhpcy5zb3VyY2UpO1xuICAgIGlmICh0aGlzLnJhd1ZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZUFycmF5KHRoaXMucmF3VmFsdWUpO1xuICAgIH1cbiAgfVxufSkgfHwgX2NsYXNzMik7XG5cbmV4cG9ydCBsZXQgTGV0RXhwcmVzc2lvbiA9IGNsYXNzIExldEV4cHJlc3Npb24ge1xuICBjb25zdHJ1Y3RvcihvYnNlcnZlckxvY2F0b3IsIHRhcmdldFByb3BlcnR5LCBzb3VyY2VFeHByZXNzaW9uLCBsb29rdXBGdW5jdGlvbnMsIHRvQmluZGluZ0NvbnRleHQpIHtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xuICB9XG5cbiAgY3JlYXRlQmluZGluZygpIHtcbiAgICByZXR1cm4gbmV3IExldEJpbmRpbmcodGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuc291cmNlRXhwcmVzc2lvbiwgdGhpcy50YXJnZXRQcm9wZXJ0eSwgdGhpcy5sb29rdXBGdW5jdGlvbnMsIHRoaXMudG9CaW5kaW5nQ29udGV4dCk7XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgTGV0QmluZGluZyA9IChfZGVjMiA9IGNvbm5lY3RhYmxlKCksIF9kZWMyKF9jbGFzczMgPSBjbGFzcyBMZXRCaW5kaW5nIHtcbiAgY29uc3RydWN0b3Iob2JzZXJ2ZXJMb2NhdG9yLCBzb3VyY2VFeHByZXNzaW9uLCB0YXJnZXRQcm9wZXJ0eSwgbG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSB7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uID0gc291cmNlRXhwcmVzc2lvbjtcbiAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xuICB9XG5cbiAgdXBkYXRlVGFyZ2V0KCkge1xuICAgIGNvbnN0IHZhbHVlID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgdGhpcy50YXJnZXRbdGhpcy50YXJnZXRQcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgfVxuXG4gIGNhbGwoY29udGV4dCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjb250ZXh0ID09PSBzb3VyY2VDb250ZXh0KSB7XG4gICAgICB0aGlzLnVwZGF0ZVRhcmdldCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgY2FsbCBjb250ZXh0ICR7Y29udGV4dH1gKTtcbiAgfVxuXG4gIGJpbmQoc291cmNlKSB7XG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgaWYgKHRoaXMuc291cmNlID09PSBzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgIHRoaXMudGFyZ2V0ID0gdGhpcy50b0JpbmRpbmdDb250ZXh0ID8gc291cmNlLmJpbmRpbmdDb250ZXh0IDogc291cmNlLm92ZXJyaWRlQ29udGV4dDtcblxuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24uYmluZCkge1xuICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmJpbmQodGhpcywgc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgfVxuXG4gICAgZW5xdWV1ZUJpbmRpbmdDb25uZWN0KHRoaXMpO1xuICB9XG5cbiAgdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgICB0aGlzLnVub2JzZXJ2ZSh0cnVlKTtcbiAgfVxuXG4gIGNvbm5lY3QoKSB7XG4gICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51cGRhdGVUYXJnZXQoKTtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uY29ubmVjdCh0aGlzLCB0aGlzLnNvdXJjZSk7XG4gIH1cbn0pIHx8IF9jbGFzczMpO1xuXG5leHBvcnQgbGV0IExldEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbiA9IGNsYXNzIExldEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbiB7XG4gIGNvbnN0cnVjdG9yKG9ic2VydmVyTG9jYXRvciwgdGFyZ2V0UHJvcGVydHksIHBhcnRzLCBsb29rdXBGdW5jdGlvbnMsIHRvQmluZGluZ0NvbnRleHQpIHtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XG4gICAgdGhpcy5wYXJ0cyA9IHBhcnRzO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICAgIHRoaXMudG9CaW5kaW5nQ29udGV4dCA9IHRvQmluZGluZ0NvbnRleHQ7XG4gIH1cblxuICBjcmVhdGVCaW5kaW5nKCkge1xuICAgIHJldHVybiBuZXcgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmcodGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMudGFyZ2V0UHJvcGVydHksIHRoaXMucGFydHMsIHRoaXMubG9va3VwRnVuY3Rpb25zLCB0aGlzLnRvQmluZGluZ0NvbnRleHQpO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IExldEludGVycG9sYXRpb25CaW5kaW5nID0gY2xhc3MgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmcge1xuICBjb25zdHJ1Y3RvcihvYnNlcnZlckxvY2F0b3IsIHRhcmdldFByb3BlcnR5LCBwYXJ0cywgbG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSB7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy5wYXJ0cyA9IHBhcnRzO1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgICB0aGlzLnRvQmluZGluZ0NvbnRleHQgPSB0b0JpbmRpbmdDb250ZXh0O1xuICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgfVxuXG4gIGJpbmQoc291cmNlKSB7XG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgaWYgKHRoaXMuc291cmNlID09PSBzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgIHRoaXMudGFyZ2V0ID0gdGhpcy50b0JpbmRpbmdDb250ZXh0ID8gc291cmNlLmJpbmRpbmdDb250ZXh0IDogc291cmNlLm92ZXJyaWRlQ29udGV4dDtcblxuICAgIHRoaXMuaW50ZXJwb2xhdGlvbkJpbmRpbmcgPSB0aGlzLmNyZWF0ZUludGVycG9sYXRpb25CaW5kaW5nKCk7XG4gICAgdGhpcy5pbnRlcnBvbGF0aW9uQmluZGluZy5iaW5kKHNvdXJjZSk7XG4gIH1cblxuICB1bmJpbmQoKSB7XG4gICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pc0JvdW5kID0gZmFsc2U7XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgICB0aGlzLmludGVycG9sYXRpb25CaW5kaW5nLnVuYmluZCgpO1xuICAgIHRoaXMuaW50ZXJwb2xhdGlvbkJpbmRpbmcgPSBudWxsO1xuICB9XG5cbiAgY3JlYXRlSW50ZXJwb2xhdGlvbkJpbmRpbmcoKSB7XG4gICAgaWYgKHRoaXMucGFydHMubGVuZ3RoID09PSAzKSB7XG4gICAgICByZXR1cm4gbmV3IENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcodGhpcy50YXJnZXQsIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLnBhcnRzWzFdLCBiaW5kaW5nTW9kZS5vbmVXYXksIHRoaXMubG9va3VwRnVuY3Rpb25zLCB0aGlzLnRhcmdldFByb3BlcnR5LCB0aGlzLnBhcnRzWzBdLCB0aGlzLnBhcnRzWzJdKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBJbnRlcnBvbGF0aW9uQmluZGluZyh0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5wYXJ0cywgdGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0UHJvcGVydHksIGJpbmRpbmdNb2RlLm9uZVdheSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IFN5bnRheEludGVycHJldGVyID0gKF90ZW1wMiA9IF9jbGFzczQgPSBjbGFzcyBTeW50YXhJbnRlcnByZXRlciB7XG5cbiAgY29uc3RydWN0b3IocGFyc2VyLCBvYnNlcnZlckxvY2F0b3IsIGV2ZW50TWFuYWdlciwgYXR0cmlidXRlTWFwKSB7XG4gICAgdGhpcy5wYXJzZXIgPSBwYXJzZXI7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXI7XG4gICAgdGhpcy5hdHRyaWJ1dGVNYXAgPSBhdHRyaWJ1dGVNYXA7XG4gIH1cblxuICBpbnRlcnByZXQocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KSB7XG4gICAgaWYgKGluZm8uY29tbWFuZCBpbiB0aGlzKSB7XG4gICAgICByZXR1cm4gdGhpc1tpbmZvLmNvbW1hbmRdKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbiwgY29udGV4dCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlVW5rbm93bkNvbW1hbmQocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KTtcbiAgfVxuXG4gIGhhbmRsZVVua25vd25Db21tYW5kKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbiwgY29udGV4dCkge1xuICAgIExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCd0ZW1wbGF0aW5nLWJpbmRpbmcnKS53YXJuKCdVbmtub3duIGJpbmRpbmcgY29tbWFuZC4nLCBpbmZvKTtcbiAgICByZXR1cm4gZXhpc3RpbmdJbnN0cnVjdGlvbjtcbiAgfVxuXG4gIGRldGVybWluZURlZmF1bHRCaW5kaW5nTW9kZShlbGVtZW50LCBhdHRyTmFtZSwgY29udGV4dCkge1xuICAgIGxldCB0YWdOYW1lID0gZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICBpZiAodGFnTmFtZSA9PT0gJ2lucHV0JyAmJiAoYXR0ck5hbWUgPT09ICd2YWx1ZScgfHwgYXR0ck5hbWUgPT09ICdmaWxlcycpICYmIGVsZW1lbnQudHlwZSAhPT0gJ2NoZWNrYm94JyAmJiBlbGVtZW50LnR5cGUgIT09ICdyYWRpbycgfHwgdGFnTmFtZSA9PT0gJ2lucHV0JyAmJiBhdHRyTmFtZSA9PT0gJ2NoZWNrZWQnICYmIChlbGVtZW50LnR5cGUgPT09ICdjaGVja2JveCcgfHwgZWxlbWVudC50eXBlID09PSAncmFkaW8nKSB8fCAodGFnTmFtZSA9PT0gJ3RleHRhcmVhJyB8fCB0YWdOYW1lID09PSAnc2VsZWN0JykgJiYgYXR0ck5hbWUgPT09ICd2YWx1ZScgfHwgKGF0dHJOYW1lID09PSAndGV4dGNvbnRlbnQnIHx8IGF0dHJOYW1lID09PSAnaW5uZXJodG1sJykgJiYgZWxlbWVudC5jb250ZW50RWRpdGFibGUgPT09ICd0cnVlJyB8fCBhdHRyTmFtZSA9PT0gJ3Njcm9sbHRvcCcgfHwgYXR0ck5hbWUgPT09ICdzY3JvbGxsZWZ0Jykge1xuICAgICAgcmV0dXJuIGJpbmRpbmdNb2RlLnR3b1dheTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dCAmJiBhdHRyTmFtZSBpbiBjb250ZXh0LmF0dHJpYnV0ZXMgJiYgY29udGV4dC5hdHRyaWJ1dGVzW2F0dHJOYW1lXSAmJiBjb250ZXh0LmF0dHJpYnV0ZXNbYXR0ck5hbWVdLmRlZmF1bHRCaW5kaW5nTW9kZSA+PSBiaW5kaW5nTW9kZS5vbmVUaW1lKSB7XG4gICAgICByZXR1cm4gY29udGV4dC5hdHRyaWJ1dGVzW2F0dHJOYW1lXS5kZWZhdWx0QmluZGluZ01vZGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJpbmRpbmdNb2RlLm9uZVdheTtcbiAgfVxuXG4gIGJpbmQocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KSB7XG4gICAgbGV0IGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGluZm8uZGVmYXVsdEJpbmRpbmdNb2RlID09PSB1bmRlZmluZWQgfHwgaW5mby5kZWZhdWx0QmluZGluZ01vZGUgPT09IG51bGwgPyB0aGlzLmRldGVybWluZURlZmF1bHRCaW5kaW5nTW9kZShlbGVtZW50LCBpbmZvLmF0dHJOYW1lLCBjb250ZXh0KSA6IGluZm8uZGVmYXVsdEJpbmRpbmdNb2RlLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcblxuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfVxuXG4gIHRyaWdnZXIocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvKSB7XG4gICAgcmV0dXJuIG5ldyBMaXN0ZW5lckV4cHJlc3Npb24odGhpcy5ldmVudE1hbmFnZXIsIGluZm8uYXR0ck5hbWUsIHRoaXMucGFyc2VyLnBhcnNlKGluZm8uYXR0clZhbHVlKSwgZGVsZWdhdGlvblN0cmF0ZWd5Lm5vbmUsIHRydWUsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuICB9XG5cbiAgY2FwdHVyZShyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8pIHtcbiAgICByZXR1cm4gbmV3IExpc3RlbmVyRXhwcmVzc2lvbih0aGlzLmV2ZW50TWFuYWdlciwgaW5mby5hdHRyTmFtZSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBkZWxlZ2F0aW9uU3RyYXRlZ3kuY2FwdHVyaW5nLCB0cnVlLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIGRlbGVnYXRlKHJlc291cmNlcywgZWxlbWVudCwgaW5mbykge1xuICAgIHJldHVybiBuZXcgTGlzdGVuZXJFeHByZXNzaW9uKHRoaXMuZXZlbnRNYW5hZ2VyLCBpbmZvLmF0dHJOYW1lLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGRlbGVnYXRpb25TdHJhdGVneS5idWJibGluZywgdHJ1ZSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gIH1cblxuICBjYWxsKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XG5cbiAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdID0gbmV3IENhbGxFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBpbmZvLmF0dHJOYW1lLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgb3B0aW9ucyhyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpIHtcbiAgICBsZXQgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuICAgIGxldCBhdHRyVmFsdWUgPSBpbmZvLmF0dHJWYWx1ZTtcbiAgICBsZXQgbGFuZ3VhZ2UgPSB0aGlzLmxhbmd1YWdlO1xuICAgIGxldCBuYW1lID0gbnVsbDtcbiAgICBsZXQgdGFyZ2V0ID0gJyc7XG4gICAgbGV0IGN1cnJlbnQ7XG4gICAgbGV0IGk7XG4gICAgbGV0IGlpO1xuICAgIGxldCBpblN0cmluZyA9IGZhbHNlO1xuICAgIGxldCBpbkVzY2FwZSA9IGZhbHNlO1xuICAgIGxldCBmb3VuZE5hbWUgPSBmYWxzZTtcblxuICAgIGZvciAoaSA9IDAsIGlpID0gYXR0clZhbHVlLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGN1cnJlbnQgPSBhdHRyVmFsdWVbaV07XG5cbiAgICAgIGlmIChjdXJyZW50ID09PSAnOycgJiYgIWluU3RyaW5nKSB7XG4gICAgICAgIGlmICghZm91bmROYW1lKSB7XG4gICAgICAgICAgbmFtZSA9IHRoaXMuX2dldFByaW1hcnlQcm9wZXJ0eU5hbWUocmVzb3VyY2VzLCBjb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBpbmZvID0gbGFuZ3VhZ2UuaW5zcGVjdEF0dHJpYnV0ZShyZXNvdXJjZXMsICc/JywgbmFtZSwgdGFyZ2V0LnRyaW0oKSk7XG4gICAgICAgIGxhbmd1YWdlLmNyZWF0ZUF0dHJpYnV0ZUluc3RydWN0aW9uKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgaW5zdHJ1Y3Rpb24sIGNvbnRleHQpO1xuXG4gICAgICAgIGlmICghaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXSkge1xuICAgICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBpbmZvLmF0dHJWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRhcmdldCA9ICcnO1xuICAgICAgICBuYW1lID0gbnVsbDtcbiAgICAgIH0gZWxzZSBpZiAoY3VycmVudCA9PT0gJzonICYmIG5hbWUgPT09IG51bGwpIHtcbiAgICAgICAgZm91bmROYW1lID0gdHJ1ZTtcbiAgICAgICAgbmFtZSA9IHRhcmdldC50cmltKCk7XG4gICAgICAgIHRhcmdldCA9ICcnO1xuICAgICAgfSBlbHNlIGlmIChjdXJyZW50ID09PSAnXFxcXCcpIHtcbiAgICAgICAgdGFyZ2V0ICs9IGN1cnJlbnQ7XG4gICAgICAgIGluRXNjYXBlID0gdHJ1ZTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0YXJnZXQgKz0gY3VycmVudDtcblxuICAgICAgICBpZiAobmFtZSAhPT0gbnVsbCAmJiBpbkVzY2FwZSA9PT0gZmFsc2UgJiYgY3VycmVudCA9PT0gJ1xcJycpIHtcbiAgICAgICAgICBpblN0cmluZyA9ICFpblN0cmluZztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpbkVzY2FwZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIGlmICghZm91bmROYW1lKSB7XG4gICAgICBuYW1lID0gdGhpcy5fZ2V0UHJpbWFyeVByb3BlcnR5TmFtZShyZXNvdXJjZXMsIGNvbnRleHQpO1xuICAgIH1cblxuICAgIGlmIChuYW1lICE9PSBudWxsKSB7XG4gICAgICBpbmZvID0gbGFuZ3VhZ2UuaW5zcGVjdEF0dHJpYnV0ZShyZXNvdXJjZXMsICc/JywgbmFtZSwgdGFyZ2V0LnRyaW0oKSk7XG4gICAgICBsYW5ndWFnZS5jcmVhdGVBdHRyaWJ1dGVJbnN0cnVjdGlvbihyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGluc3RydWN0aW9uLCBjb250ZXh0KTtcblxuICAgICAgaWYgKCFpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdKSB7XG4gICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBpbmZvLmF0dHJWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH1cblxuICBfZ2V0UHJpbWFyeVByb3BlcnR5TmFtZShyZXNvdXJjZXMsIGNvbnRleHQpIHtcbiAgICBsZXQgdHlwZSA9IHJlc291cmNlcy5nZXRBdHRyaWJ1dGUoY29udGV4dC5hdHRyaWJ1dGVOYW1lKTtcbiAgICBpZiAodHlwZSAmJiB0eXBlLnByaW1hcnlQcm9wZXJ0eSkge1xuICAgICAgcmV0dXJuIHR5cGUucHJpbWFyeVByb3BlcnR5LmF0dHJpYnV0ZTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAnZm9yJyhyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24pIHtcbiAgICBsZXQgcGFydHM7XG4gICAgbGV0IGtleVZhbHVlO1xuICAgIGxldCBpbnN0cnVjdGlvbjtcbiAgICBsZXQgYXR0clZhbHVlO1xuICAgIGxldCBpc0Rlc3RydWN0dXJpbmc7XG5cbiAgICBhdHRyVmFsdWUgPSBpbmZvLmF0dHJWYWx1ZTtcbiAgICBpc0Rlc3RydWN0dXJpbmcgPSBhdHRyVmFsdWUubWF0Y2goL14gKltbXS4rW1xcXV0vKTtcbiAgICBwYXJ0cyA9IGlzRGVzdHJ1Y3R1cmluZyA/IGF0dHJWYWx1ZS5zcGxpdCgnb2YgJykgOiBhdHRyVmFsdWUuc3BsaXQoJyBvZiAnKTtcblxuICAgIGlmIChwYXJ0cy5sZW5ndGggIT09IDIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW5jb3JyZWN0IHN5bnRheCBmb3IgXCJmb3JcIi4gVGhlIGZvcm0gaXM6IFwiJGxvY2FsIG9mICRpdGVtc1wiIG9yIFwiWyRrZXksICR2YWx1ZV0gb2YgJGl0ZW1zXCIuJyk7XG4gICAgfVxuXG4gICAgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuXG4gICAgaWYgKGlzRGVzdHJ1Y3R1cmluZykge1xuICAgICAga2V5VmFsdWUgPSBwYXJ0c1swXS5yZXBsYWNlKC9bW1xcXV0vZywgJycpLnJlcGxhY2UoLywvZywgJyAnKS5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpLnNwbGl0KCcgJyk7XG4gICAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzLmtleSA9IGtleVZhbHVlWzBdO1xuICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcy52YWx1ZSA9IGtleVZhbHVlWzFdO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzLmxvY2FsID0gcGFydHNbMF07XG4gICAgfVxuXG4gICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcy5pdGVtcyA9IG5ldyBCaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgJ2l0ZW1zJywgdGhpcy5wYXJzZXIucGFyc2UocGFydHNbMV0pLCBiaW5kaW5nTW9kZS5vbmVXYXksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgJ3R3by13YXknKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XG5cbiAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdID0gbmV3IEJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLmF0dHJpYnV0ZU1hcC5tYXAoZWxlbWVudC50YWdOYW1lLCBpbmZvLmF0dHJOYW1lKSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBiaW5kaW5nTW9kZS50d29XYXksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgJ3RvLXZpZXcnKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIGxldCBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XG5cbiAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdID0gbmV3IEJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLmF0dHJpYnV0ZU1hcC5tYXAoZWxlbWVudC50YWdOYW1lLCBpbmZvLmF0dHJOYW1lKSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBiaW5kaW5nTW9kZS50b1ZpZXcsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG5cbiAgJ2Zyb20tdmlldycocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uKSB7XG4gICAgbGV0IGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGJpbmRpbmdNb2RlLmZyb21WaWV3LCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcblxuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfVxuXG4gICdvbmUtdGltZScocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uKSB7XG4gICAgbGV0IGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIGJpbmRpbmdNb2RlLm9uZVRpbWUsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9XG59LCBfY2xhc3M0LmluamVjdCA9IFtQYXJzZXIsIE9ic2VydmVyTG9jYXRvciwgRXZlbnRNYW5hZ2VyLCBBdHRyaWJ1dGVNYXBdLCBfdGVtcDIpO1xuXG5TeW50YXhJbnRlcnByZXRlci5wcm90b3R5cGVbJ29uZS13YXknXSA9IFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZVsndG8tdmlldyddO1xuXG5sZXQgaW5mbyA9IHt9O1xuXG5leHBvcnQgbGV0IFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UgPSAoX3RlbXAzID0gX2NsYXNzNSA9IGNsYXNzIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UgZXh0ZW5kcyBCaW5kaW5nTGFuZ3VhZ2Uge1xuXG4gIGNvbnN0cnVjdG9yKHBhcnNlciwgb2JzZXJ2ZXJMb2NhdG9yLCBzeW50YXhJbnRlcnByZXRlciwgYXR0cmlidXRlTWFwKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnBhcnNlciA9IHBhcnNlcjtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnN5bnRheEludGVycHJldGVyID0gc3ludGF4SW50ZXJwcmV0ZXI7XG4gICAgdGhpcy5lbXB0eVN0cmluZ0V4cHJlc3Npb24gPSB0aGlzLnBhcnNlci5wYXJzZSgnXFwnXFwnJyk7XG4gICAgc3ludGF4SW50ZXJwcmV0ZXIubGFuZ3VhZ2UgPSB0aGlzO1xuICAgIHRoaXMuYXR0cmlidXRlTWFwID0gYXR0cmlidXRlTWFwO1xuICAgIHRoaXMudG9CaW5kaW5nQ29udGV4dEF0dHIgPSAndG8tYmluZGluZy1jb250ZXh0JztcbiAgfVxuXG4gIGluc3BlY3RBdHRyaWJ1dGUocmVzb3VyY2VzLCBlbGVtZW50TmFtZSwgYXR0ck5hbWUsIGF0dHJWYWx1ZSkge1xuICAgIGxldCBwYXJ0cyA9IGF0dHJOYW1lLnNwbGl0KCcuJyk7XG5cbiAgICBpbmZvLmRlZmF1bHRCaW5kaW5nTW9kZSA9IG51bGw7XG5cbiAgICBpZiAocGFydHMubGVuZ3RoID09PSAyKSB7XG4gICAgICBpbmZvLmF0dHJOYW1lID0gcGFydHNbMF0udHJpbSgpO1xuICAgICAgaW5mby5hdHRyVmFsdWUgPSBhdHRyVmFsdWU7XG4gICAgICBpbmZvLmNvbW1hbmQgPSBwYXJ0c1sxXS50cmltKCk7XG5cbiAgICAgIGlmIChpbmZvLmNvbW1hbmQgPT09ICdyZWYnKSB7XG4gICAgICAgIGluZm8uZXhwcmVzc2lvbiA9IG5ldyBOYW1lRXhwcmVzc2lvbih0aGlzLnBhcnNlci5wYXJzZShhdHRyVmFsdWUpLCBpbmZvLmF0dHJOYW1lLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICAgICAgaW5mby5jb21tYW5kID0gbnVsbDtcbiAgICAgICAgaW5mby5hdHRyTmFtZSA9ICdyZWYnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5mby5leHByZXNzaW9uID0gbnVsbDtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGF0dHJOYW1lID09PSAncmVmJykge1xuICAgICAgaW5mby5hdHRyTmFtZSA9IGF0dHJOYW1lO1xuICAgICAgaW5mby5hdHRyVmFsdWUgPSBhdHRyVmFsdWU7XG4gICAgICBpbmZvLmNvbW1hbmQgPSBudWxsO1xuICAgICAgaW5mby5leHByZXNzaW9uID0gbmV3IE5hbWVFeHByZXNzaW9uKHRoaXMucGFyc2VyLnBhcnNlKGF0dHJWYWx1ZSksICdlbGVtZW50JywgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGluZm8uYXR0ck5hbWUgPSBhdHRyTmFtZTtcbiAgICAgIGluZm8uYXR0clZhbHVlID0gYXR0clZhbHVlO1xuICAgICAgaW5mby5jb21tYW5kID0gbnVsbDtcbiAgICAgIGNvbnN0IGludGVycG9sYXRpb25QYXJ0cyA9IHRoaXMucGFyc2VJbnRlcnBvbGF0aW9uKHJlc291cmNlcywgYXR0clZhbHVlKTtcbiAgICAgIGlmIChpbnRlcnBvbGF0aW9uUGFydHMgPT09IG51bGwpIHtcbiAgICAgICAgaW5mby5leHByZXNzaW9uID0gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGluZm8uZXhwcmVzc2lvbiA9IG5ldyBJbnRlcnBvbGF0aW9uQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50TmFtZSwgYXR0ck5hbWUpLCBpbnRlcnBvbGF0aW9uUGFydHMsIGJpbmRpbmdNb2RlLm9uZVdheSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucywgYXR0ck5hbWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpbmZvO1xuICB9XG5cbiAgY3JlYXRlQXR0cmlidXRlSW5zdHJ1Y3Rpb24ocmVzb3VyY2VzLCBlbGVtZW50LCB0aGVJbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KSB7XG4gICAgbGV0IGluc3RydWN0aW9uO1xuXG4gICAgaWYgKHRoZUluZm8uZXhwcmVzc2lvbikge1xuICAgICAgaWYgKHRoZUluZm8uYXR0ck5hbWUgPT09ICdyZWYnKSB7XG4gICAgICAgIHJldHVybiB0aGVJbmZvLmV4cHJlc3Npb247XG4gICAgICB9XG5cbiAgICAgIGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZSh0aGVJbmZvLmF0dHJOYW1lKTtcbiAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbdGhlSW5mby5hdHRyTmFtZV0gPSB0aGVJbmZvLmV4cHJlc3Npb247XG4gICAgfSBlbHNlIGlmICh0aGVJbmZvLmNvbW1hbmQpIHtcbiAgICAgIGluc3RydWN0aW9uID0gdGhpcy5zeW50YXhJbnRlcnByZXRlci5pbnRlcnByZXQocmVzb3VyY2VzLCBlbGVtZW50LCB0aGVJbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH1cblxuICBjcmVhdGVMZXRFeHByZXNzaW9ucyhyZXNvdXJjZXMsIGxldEVsZW1lbnQpIHtcbiAgICBsZXQgZXhwcmVzc2lvbnMgPSBbXTtcbiAgICBsZXQgYXR0cmlidXRlcyA9IGxldEVsZW1lbnQuYXR0cmlidXRlcztcblxuICAgIGxldCBhdHRyO1xuXG4gICAgbGV0IHBhcnRzO1xuICAgIGxldCBhdHRyTmFtZTtcbiAgICBsZXQgYXR0clZhbHVlO1xuICAgIGxldCBjb21tYW5kO1xuICAgIGxldCB0b0JpbmRpbmdDb250ZXh0QXR0ciA9IHRoaXMudG9CaW5kaW5nQ29udGV4dEF0dHI7XG4gICAgbGV0IHRvQmluZGluZ0NvbnRleHQgPSBsZXRFbGVtZW50Lmhhc0F0dHJpYnV0ZSh0b0JpbmRpbmdDb250ZXh0QXR0cik7XG4gICAgZm9yIChsZXQgaSA9IDAsIGlpID0gYXR0cmlidXRlcy5sZW5ndGg7IGlpID4gaTsgKytpKSB7XG4gICAgICBhdHRyID0gYXR0cmlidXRlc1tpXTtcbiAgICAgIGF0dHJOYW1lID0gYXR0ci5uYW1lO1xuICAgICAgYXR0clZhbHVlID0gYXR0ci5ub2RlVmFsdWU7XG4gICAgICBwYXJ0cyA9IGF0dHJOYW1lLnNwbGl0KCcuJyk7XG5cbiAgICAgIGlmIChhdHRyTmFtZSA9PT0gdG9CaW5kaW5nQ29udGV4dEF0dHIpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgY29tbWFuZCA9IHBhcnRzWzFdO1xuICAgICAgICBpZiAoY29tbWFuZCAhPT0gJ2JpbmQnKSB7XG4gICAgICAgICAgTG9nTWFuYWdlci5nZXRMb2dnZXIoJ3RlbXBsYXRpbmctYmluZGluZy1sYW5ndWFnZScpLndhcm4oYERldGVjdGVkIGludmFsaWQgbGV0IGNvbW1hbmQuIEV4cGVjdGVkIFwiJHtwYXJ0c1swXX0uYmluZFwiLCBnaXZlbiBcIiR7YXR0ck5hbWV9XCJgKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBleHByZXNzaW9ucy5wdXNoKG5ldyBMZXRFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBjYW1lbENhc2UocGFydHNbMF0pLCB0aGlzLnBhcnNlci5wYXJzZShhdHRyVmFsdWUpLCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zLCB0b0JpbmRpbmdDb250ZXh0KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhdHRyTmFtZSA9IGNhbWVsQ2FzZShhdHRyTmFtZSk7XG4gICAgICAgIHBhcnRzID0gdGhpcy5wYXJzZUludGVycG9sYXRpb24ocmVzb3VyY2VzLCBhdHRyVmFsdWUpO1xuICAgICAgICBpZiAocGFydHMgPT09IG51bGwpIHtcbiAgICAgICAgICBMb2dNYW5hZ2VyLmdldExvZ2dlcigndGVtcGxhdGluZy1iaW5kaW5nLWxhbmd1YWdlJykud2FybihgRGV0ZWN0ZWQgc3RyaW5nIGxpdGVyYWwgaW4gbGV0IGJpbmRpbmdzLiBEaWQgeW91IG1lYW4gXCIke2F0dHJOYW1lfS5iaW5kPSR7YXR0clZhbHVlfVwiIG9yIFwiJHthdHRyTmFtZX09XFwkeyR7YXR0clZhbHVlfX1cIiA/YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcnRzKSB7XG4gICAgICAgICAgZXhwcmVzc2lvbnMucHVzaChuZXcgTGV0SW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBhdHRyTmFtZSwgcGFydHMsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMsIHRvQmluZGluZ0NvbnRleHQpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBleHByZXNzaW9ucy5wdXNoKG5ldyBMZXRFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBhdHRyTmFtZSwgbmV3IExpdGVyYWxTdHJpbmcoYXR0clZhbHVlKSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucywgdG9CaW5kaW5nQ29udGV4dCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBleHByZXNzaW9ucztcbiAgfVxuXG4gIGluc3BlY3RUZXh0Q29udGVudChyZXNvdXJjZXMsIHZhbHVlKSB7XG4gICAgY29uc3QgcGFydHMgPSB0aGlzLnBhcnNlSW50ZXJwb2xhdGlvbihyZXNvdXJjZXMsIHZhbHVlKTtcbiAgICBpZiAocGFydHMgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgJ3RleHRDb250ZW50JywgcGFydHMsIGJpbmRpbmdNb2RlLm9uZVdheSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucywgJ3RleHRDb250ZW50Jyk7XG4gIH1cblxuICBwYXJzZUludGVycG9sYXRpb24ocmVzb3VyY2VzLCB2YWx1ZSkge1xuICAgIGxldCBpID0gdmFsdWUuaW5kZXhPZignJHsnLCAwKTtcbiAgICBsZXQgaWkgPSB2YWx1ZS5sZW5ndGg7XG4gICAgbGV0IGNoYXI7XG4gICAgbGV0IHBvcyA9IDA7XG4gICAgbGV0IG9wZW4gPSAwO1xuICAgIGxldCBxdW90ZSA9IG51bGw7XG4gICAgbGV0IGludGVycG9sYXRpb25TdGFydDtcbiAgICBsZXQgcGFydHM7XG4gICAgbGV0IHBhcnRJbmRleCA9IDA7XG5cbiAgICB3aGlsZSAoaSA+PSAwICYmIGkgPCBpaSAtIDIpIHtcbiAgICAgIG9wZW4gPSAxO1xuICAgICAgaW50ZXJwb2xhdGlvblN0YXJ0ID0gaTtcbiAgICAgIGkgKz0gMjtcblxuICAgICAgZG8ge1xuICAgICAgICBjaGFyID0gdmFsdWVbaV07XG4gICAgICAgIGkrKztcblxuICAgICAgICBpZiAoY2hhciA9PT0gXCInXCIgfHwgY2hhciA9PT0gJ1wiJykge1xuICAgICAgICAgIGlmIChxdW90ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcXVvdGUgPSBjaGFyO1xuICAgICAgICAgIH0gZWxzZSBpZiAocXVvdGUgPT09IGNoYXIpIHtcbiAgICAgICAgICAgIHF1b3RlID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hhciA9PT0gJ1xcXFwnKSB7XG4gICAgICAgICAgaSsrO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHF1b3RlICE9PSBudWxsKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hhciA9PT0gJ3snKSB7XG4gICAgICAgICAgb3BlbisrO1xuICAgICAgICB9IGVsc2UgaWYgKGNoYXIgPT09ICd9Jykge1xuICAgICAgICAgIG9wZW4tLTtcbiAgICAgICAgfVxuICAgICAgfSB3aGlsZSAob3BlbiA+IDAgJiYgaSA8IGlpKTtcblxuICAgICAgaWYgKG9wZW4gPT09IDApIHtcbiAgICAgICAgcGFydHMgPSBwYXJ0cyB8fCBbXTtcbiAgICAgICAgaWYgKHZhbHVlW2ludGVycG9sYXRpb25TdGFydCAtIDFdID09PSAnXFxcXCcgJiYgdmFsdWVbaW50ZXJwb2xhdGlvblN0YXJ0IC0gMl0gIT09ICdcXFxcJykge1xuICAgICAgICAgIHBhcnRzW3BhcnRJbmRleF0gPSB2YWx1ZS5zdWJzdHJpbmcocG9zLCBpbnRlcnBvbGF0aW9uU3RhcnQgLSAxKSArIHZhbHVlLnN1YnN0cmluZyhpbnRlcnBvbGF0aW9uU3RhcnQsIGkpO1xuICAgICAgICAgIHBhcnRJbmRleCsrO1xuICAgICAgICAgIHBhcnRzW3BhcnRJbmRleF0gPSB0aGlzLmVtcHR5U3RyaW5nRXhwcmVzc2lvbjtcbiAgICAgICAgICBwYXJ0SW5kZXgrKztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdmFsdWUuc3Vic3RyaW5nKHBvcywgaW50ZXJwb2xhdGlvblN0YXJ0KTtcbiAgICAgICAgICBwYXJ0SW5kZXgrKztcbiAgICAgICAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdGhpcy5wYXJzZXIucGFyc2UodmFsdWUuc3Vic3RyaW5nKGludGVycG9sYXRpb25TdGFydCArIDIsIGkgLSAxKSk7XG4gICAgICAgICAgcGFydEluZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgcG9zID0gaTtcbiAgICAgICAgaSA9IHZhbHVlLmluZGV4T2YoJyR7JywgaSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocGFydEluZGV4ID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBwYXJ0c1twYXJ0SW5kZXhdID0gdmFsdWUuc3Vic3RyKHBvcyk7XG4gICAgcmV0dXJuIHBhcnRzO1xuICB9XG59LCBfY2xhc3M1LmluamVjdCA9IFtQYXJzZXIsIE9ic2VydmVyTG9jYXRvciwgU3ludGF4SW50ZXJwcmV0ZXIsIEF0dHJpYnV0ZU1hcF0sIF90ZW1wMyk7XG5cbmV4cG9ydCBmdW5jdGlvbiBjb25maWd1cmUoY29uZmlnKSB7XG4gIGNvbmZpZy5jb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b24oQmluZGluZ0xhbmd1YWdlLCBUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlKTtcbiAgY29uZmlnLmNvbnRhaW5lci5yZWdpc3RlckFsaWFzKEJpbmRpbmdMYW5ndWFnZSwgVGVtcGxhdGluZ0JpbmRpbmdMYW5ndWFnZSk7XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///aurelia-templating-binding\n");

/***/ }),

/***/ "aurelia-templating-resources":
/*!***********************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-resources/dist/es2015/aurelia-templating-resources.js ***!
  \***********************************************************************************************/
/*! exports provided: AbstractRepeater, ArrayRepeatStrategy, AttrBindingBehavior, BindingSignaler, Compose, DebounceBindingBehavior, Else, Focus, FromViewBindingBehavior, HTMLSanitizer, Hide, If, MapRepeatStrategy, NullRepeatStrategy, NumberRepeatStrategy, OneTimeBindingBehavior, OneWayBindingBehavior, Repeat, RepeatStrategyLocator, Replaceable, SanitizeHTMLValueConverter, SelfBindingBehavior, SetRepeatStrategy, Show, SignalBindingBehavior, ThrottleBindingBehavior, ToViewBindingBehavior, TwoWayBindingBehavior, UpdateTriggerBindingBehavior, With, configure, createFullOverrideContext, getItemsSourceExpression, isOneTime, unwrapExpression, updateOneTimeBinding, updateOverrideContext, viewsRequireLifecycle */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractRepeater\", function() { return AbstractRepeater; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ArrayRepeatStrategy\", function() { return ArrayRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AttrBindingBehavior\", function() { return AttrBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindingSignaler\", function() { return BindingSignaler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Compose\", function() { return Compose; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DebounceBindingBehavior\", function() { return DebounceBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Else\", function() { return Else; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Focus\", function() { return Focus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FromViewBindingBehavior\", function() { return FromViewBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HTMLSanitizer\", function() { return HTMLSanitizer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Hide\", function() { return Hide; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"If\", function() { return If; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MapRepeatStrategy\", function() { return MapRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NullRepeatStrategy\", function() { return NullRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NumberRepeatStrategy\", function() { return NumberRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OneTimeBindingBehavior\", function() { return OneTimeBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OneWayBindingBehavior\", function() { return OneWayBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Repeat\", function() { return Repeat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RepeatStrategyLocator\", function() { return RepeatStrategyLocator; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Replaceable\", function() { return Replaceable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SanitizeHTMLValueConverter\", function() { return SanitizeHTMLValueConverter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SelfBindingBehavior\", function() { return SelfBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SetRepeatStrategy\", function() { return SetRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Show\", function() { return Show; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SignalBindingBehavior\", function() { return SignalBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ThrottleBindingBehavior\", function() { return ThrottleBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ToViewBindingBehavior\", function() { return ToViewBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TwoWayBindingBehavior\", function() { return TwoWayBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UpdateTriggerBindingBehavior\", function() { return UpdateTriggerBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"With\", function() { return With; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure$1; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createFullOverrideContext\", function() { return createFullOverrideContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getItemsSourceExpression\", function() { return getItemsSourceExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isOneTime\", function() { return isOneTime; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"unwrapExpression\", function() { return unwrapExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateOneTimeBinding\", function() { return updateOneTimeBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateOverrideContext\", function() { return updateOverrideContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"viewsRequireLifecycle\", function() { return viewsRequireLifecycle; });\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-dependency-injection */ \"./node_modules/aurelia-dependency-injection/dist/es2015/aurelia-dependency-injection.js\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n/* harmony import */ var aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-task-queue */ \"./node_modules/aurelia-task-queue/dist/es2015/aurelia-task-queue.js\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-templating */ \"./node_modules/aurelia-templating/dist/es2015/aurelia-templating.js\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-binding */ \"./node_modules/aurelia-binding/dist/es2015/aurelia-binding.js\");\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-logging */ \"./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js\");\n/* harmony import */ var aurelia_loader__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-loader */ \"./node_modules/aurelia-loader/dist/es2015/aurelia-loader.js\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-path */ \"./node_modules/aurelia-path/dist/es2015/aurelia-path.js\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! aurelia-metadata */ \"./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js\");\n\n\n\n\n\n\n\n\n\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\n\nlet Compose = class Compose {\r\n    constructor(element, container, compositionEngine, viewSlot, viewResources, taskQueue) {\r\n        this.element = element;\r\n        this.container = container;\r\n        this.compositionEngine = compositionEngine;\r\n        this.viewSlot = viewSlot;\r\n        this.viewResources = viewResources;\r\n        this.taskQueue = taskQueue;\r\n        this.currentController = null;\r\n        this.currentViewModel = null;\r\n        this.changes = Object.create(null);\r\n    }\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Container\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"], aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__[\"TaskQueue\"]];\r\n    }\r\n    created(owningView) {\r\n        this.owningView = owningView;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        this.bindingContext = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n        let changes = this.changes;\r\n        changes.view = this.view;\r\n        changes.viewModel = this.viewModel;\r\n        changes.model = this.model;\r\n        if (!this.pendingTask) {\r\n            processChanges(this);\r\n        }\r\n    }\r\n    unbind() {\r\n        this.changes = Object.create(null);\r\n        this.bindingContext = null;\r\n        this.overrideContext = null;\r\n        let returnToCache = true;\r\n        let skipAnimation = true;\r\n        this.viewSlot.removeAll(returnToCache, skipAnimation);\r\n    }\r\n    modelChanged(newValue, oldValue) {\r\n        this.changes.model = newValue;\r\n        requestUpdate(this);\r\n    }\r\n    viewChanged(newValue, oldValue) {\r\n        this.changes.view = newValue;\r\n        requestUpdate(this);\r\n    }\r\n    viewModelChanged(newValue, oldValue) {\r\n        this.changes.viewModel = newValue;\r\n        requestUpdate(this);\r\n    }\r\n};\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Compose.prototype, \"model\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Compose.prototype, \"view\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Compose.prototype, \"viewModel\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Compose.prototype, \"swapOrder\", void 0);\r\nCompose = __decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"noView\"],\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])('compose')\r\n], Compose);\r\nfunction isEmpty(obj) {\r\n    for (const _ in obj) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nfunction tryActivateViewModel(vm, model) {\r\n    if (vm && typeof vm.activate === 'function') {\r\n        return Promise.resolve(vm.activate(model));\r\n    }\r\n}\r\nfunction createInstruction(composer, instruction) {\r\n    return Object.assign(instruction, {\r\n        bindingContext: composer.bindingContext,\r\n        overrideContext: composer.overrideContext,\r\n        owningView: composer.owningView,\r\n        container: composer.container,\r\n        viewSlot: composer.viewSlot,\r\n        viewResources: composer.viewResources,\r\n        currentController: composer.currentController,\r\n        host: composer.element,\r\n        swapOrder: composer.swapOrder\r\n    });\r\n}\r\nfunction processChanges(composer) {\r\n    const changes = composer.changes;\r\n    composer.changes = Object.create(null);\r\n    if (!('view' in changes) && !('viewModel' in changes) && ('model' in changes)) {\r\n        composer.pendingTask = tryActivateViewModel(composer.currentViewModel, changes.model);\r\n        if (!composer.pendingTask) {\r\n            return;\r\n        }\r\n    }\r\n    else {\r\n        let instruction = {\r\n            view: composer.view,\r\n            viewModel: composer.currentViewModel || composer.viewModel,\r\n            model: composer.model\r\n        };\r\n        instruction = Object.assign(instruction, changes);\r\n        instruction = createInstruction(composer, instruction);\r\n        composer.pendingTask = composer.compositionEngine.compose(instruction).then(controller => {\r\n            composer.currentController = controller;\r\n            composer.currentViewModel = controller ? controller.viewModel : null;\r\n        });\r\n    }\r\n    composer.pendingTask = composer.pendingTask\r\n        .then(() => {\r\n        completeCompositionTask(composer);\r\n    }, reason => {\r\n        completeCompositionTask(composer);\r\n        throw reason;\r\n    });\r\n}\r\nfunction completeCompositionTask(composer) {\r\n    composer.pendingTask = null;\r\n    if (!isEmpty(composer.changes)) {\r\n        processChanges(composer);\r\n    }\r\n}\r\nfunction requestUpdate(composer) {\r\n    if (composer.pendingTask || composer.updateRequested) {\r\n        return;\r\n    }\r\n    composer.updateRequested = true;\r\n    composer.taskQueue.queueMicroTask(() => {\r\n        composer.updateRequested = false;\r\n        processChanges(composer);\r\n    });\r\n}\n\nclass IfCore {\r\n    constructor(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.view = null;\r\n        this.bindingContext = null;\r\n        this.overrideContext = null;\r\n        this.showing = false;\r\n        this.cache = true;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        this.bindingContext = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n    }\r\n    unbind() {\r\n        if (this.view === null) {\r\n            return;\r\n        }\r\n        this.view.unbind();\r\n        if (!this.viewFactory.isCaching) {\r\n            return;\r\n        }\r\n        if (this.showing) {\r\n            this.showing = false;\r\n            this.viewSlot.remove(this.view, true, true);\r\n        }\r\n        else {\r\n            this.view.returnToCache();\r\n        }\r\n        this.view = null;\r\n    }\r\n    _show() {\r\n        if (this.showing) {\r\n            if (!this.view.isBound) {\r\n                this.view.bind(this.bindingContext, this.overrideContext);\r\n            }\r\n            return;\r\n        }\r\n        if (this.view === null) {\r\n            this.view = this.viewFactory.create();\r\n        }\r\n        if (!this.view.isBound) {\r\n            this.view.bind(this.bindingContext, this.overrideContext);\r\n        }\r\n        this.showing = true;\r\n        return this.viewSlot.add(this.view);\r\n    }\r\n    _hide() {\r\n        if (!this.showing) {\r\n            return;\r\n        }\r\n        this.showing = false;\r\n        let removed = this.viewSlot.remove(this.view);\r\n        if (removed instanceof Promise) {\r\n            return removed.then(() => {\r\n                this._unbindView();\r\n            });\r\n        }\r\n        this._unbindView();\r\n    }\r\n    _unbindView() {\r\n        const cache = this.cache === 'false' ? false : !!this.cache;\r\n        this.view.unbind();\r\n        if (!cache) {\r\n            this.view = null;\r\n        }\r\n    }\r\n}\n\nlet If = class If extends IfCore {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.cache = true;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        super.bind(bindingContext, overrideContext);\r\n        if (this.condition) {\r\n            this._show();\r\n        }\r\n        else {\r\n            this._hide();\r\n        }\r\n    }\r\n    conditionChanged(newValue) {\r\n        this._update(newValue);\r\n    }\r\n    _update(show) {\r\n        if (this.animating) {\r\n            return;\r\n        }\r\n        let promise;\r\n        if (this.elseVm) {\r\n            promise = show ? this._swap(this.elseVm, this) : this._swap(this, this.elseVm);\r\n        }\r\n        else {\r\n            promise = show ? this._show() : this._hide();\r\n        }\r\n        if (promise) {\r\n            this.animating = true;\r\n            promise.then(() => {\r\n                this.animating = false;\r\n                if (this.condition !== this.showing) {\r\n                    this._update(this.condition);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    _swap(remove, add) {\r\n        switch (this.swapOrder) {\r\n            case 'before':\r\n                return Promise.resolve(add._show()).then(() => remove._hide());\r\n            case 'with':\r\n                return Promise.all([remove._hide(), add._show()]);\r\n            default:\r\n                let promise = remove._hide();\r\n                return promise ? promise.then(() => add._show()) : add._show();\r\n        }\r\n    }\r\n};\r\n__decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"])({ primaryProperty: true })\r\n], If.prototype, \"condition\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], If.prototype, \"swapOrder\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], If.prototype, \"cache\", void 0);\r\nIf = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('if'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n], If);\n\nlet Else = class Else extends IfCore {\r\n    constructor(viewFactory, viewSlot) {\r\n        super(viewFactory, viewSlot);\r\n        this._registerInIf();\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        super.bind(bindingContext, overrideContext);\r\n        if (this.ifVm.condition) {\r\n            this._hide();\r\n        }\r\n        else {\r\n            this._show();\r\n        }\r\n    }\r\n    _registerInIf() {\r\n        let previous = this.viewSlot.anchor.previousSibling;\r\n        while (previous && !previous.au) {\r\n            previous = previous.previousSibling;\r\n        }\r\n        if (!previous || !previous.au.if) {\r\n            throw new Error(\"Can't find matching If for Else custom attribute.\");\r\n        }\r\n        this.ifVm = previous.au.if.viewModel;\r\n        this.ifVm.elseVm = this;\r\n    }\r\n};\r\nElse = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('else'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n], Else);\n\nlet With = class With {\r\n    constructor(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.parentOverrideContext = null;\r\n        this.view = null;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        this.parentOverrideContext = overrideContext;\r\n        this.valueChanged(this.value);\r\n    }\r\n    valueChanged(newValue) {\r\n        let overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"createOverrideContext\"])(newValue, this.parentOverrideContext);\r\n        let view = this.view;\r\n        if (!view) {\r\n            view = this.view = this.viewFactory.create();\r\n            view.bind(newValue, overrideContext);\r\n            this.viewSlot.add(view);\r\n        }\r\n        else {\r\n            view.bind(newValue, overrideContext);\r\n        }\r\n    }\r\n    unbind() {\r\n        let view = this.view;\r\n        this.parentOverrideContext = null;\r\n        if (view) {\r\n            view.unbind();\r\n        }\r\n    }\r\n};\r\nWith = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('with'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n], With);\n\nconst oneTime = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].oneTime;\r\nfunction updateOverrideContexts(views, startIndex) {\r\n    let length = views.length;\r\n    if (startIndex > 0) {\r\n        startIndex = startIndex - 1;\r\n    }\r\n    for (; startIndex < length; ++startIndex) {\r\n        updateOverrideContext(views[startIndex].overrideContext, startIndex, length);\r\n    }\r\n}\r\nfunction createFullOverrideContext(repeat, data, index, length, key) {\r\n    let bindingContext = {};\r\n    let overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"createOverrideContext\"])(bindingContext, repeat.scope.overrideContext);\r\n    if (typeof key !== 'undefined') {\r\n        bindingContext[repeat.key] = key;\r\n        bindingContext[repeat.value] = data;\r\n    }\r\n    else {\r\n        bindingContext[repeat.local] = data;\r\n    }\r\n    updateOverrideContext(overrideContext, index, length);\r\n    return overrideContext;\r\n}\r\nfunction updateOverrideContext(overrideContext, index, length) {\r\n    let first = (index === 0);\r\n    let last = (index === length - 1);\r\n    let even = index % 2 === 0;\r\n    overrideContext.$index = index;\r\n    overrideContext.$first = first;\r\n    overrideContext.$last = last;\r\n    overrideContext.$middle = !(first || last);\r\n    overrideContext.$odd = !even;\r\n    overrideContext.$even = even;\r\n}\r\nfunction getItemsSourceExpression(instruction, attrName) {\r\n    return instruction.behaviorInstructions\r\n        .filter(bi => bi.originalAttrName === attrName)[0]\r\n        .attributes\r\n        .items\r\n        .sourceExpression;\r\n}\r\nfunction unwrapExpression(expression) {\r\n    let unwrapped = false;\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"BindingBehavior\"]) {\r\n        expression = expression.expression;\r\n    }\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"ValueConverter\"]) {\r\n        expression = expression.expression;\r\n        unwrapped = true;\r\n    }\r\n    return unwrapped ? expression : null;\r\n}\r\nfunction isOneTime(expression) {\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"BindingBehavior\"]) {\r\n        if (expression.name === 'oneTime') {\r\n            return true;\r\n        }\r\n        expression = expression.expression;\r\n    }\r\n    return false;\r\n}\r\nfunction updateOneTimeBinding(binding) {\r\n    if (binding.call && binding.mode === oneTime) {\r\n        binding.call(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"]);\r\n    }\r\n    else if (binding.updateOneTimeBindings) {\r\n        binding.updateOneTimeBindings();\r\n    }\r\n}\r\nfunction indexOf(array, item, matcher, startIndex) {\r\n    if (!matcher) {\r\n        return array.indexOf(item);\r\n    }\r\n    const length = array.length;\r\n    for (let index = startIndex || 0; index < length; index++) {\r\n        if (matcher(array[index], item)) {\r\n            return index;\r\n        }\r\n    }\r\n    return -1;\r\n}\n\nclass ArrayRepeatStrategy {\r\n    getCollectionObserver(observerLocator, items) {\r\n        return observerLocator.getArrayObserver(items);\r\n    }\r\n    instanceChanged(repeat, items) {\r\n        const itemsLength = items.length;\r\n        if (!items || itemsLength === 0) {\r\n            repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n            return;\r\n        }\r\n        const children = repeat.views();\r\n        const viewsLength = children.length;\r\n        if (viewsLength === 0) {\r\n            this._standardProcessInstanceChanged(repeat, items);\r\n            return;\r\n        }\r\n        if (repeat.viewsRequireLifecycle) {\r\n            const childrenSnapshot = children.slice(0);\r\n            const itemNameInBindingContext = repeat.local;\r\n            const matcher = repeat.matcher();\r\n            let itemsPreviouslyInViews = [];\r\n            const viewsToRemove = [];\r\n            for (let index = 0; index < viewsLength; index++) {\r\n                const view = childrenSnapshot[index];\r\n                const oldItem = view.bindingContext[itemNameInBindingContext];\r\n                if (indexOf(items, oldItem, matcher) === -1) {\r\n                    viewsToRemove.push(view);\r\n                }\r\n                else {\r\n                    itemsPreviouslyInViews.push(oldItem);\r\n                }\r\n            }\r\n            let updateViews;\r\n            let removePromise;\r\n            if (itemsPreviouslyInViews.length > 0) {\r\n                removePromise = repeat.removeViews(viewsToRemove, true, !repeat.viewsRequireLifecycle);\r\n                updateViews = () => {\r\n                    for (let index = 0; index < itemsLength; index++) {\r\n                        const item = items[index];\r\n                        const indexOfView = indexOf(itemsPreviouslyInViews, item, matcher, index);\r\n                        let view;\r\n                        if (indexOfView === -1) {\r\n                            const overrideContext = createFullOverrideContext(repeat, items[index], index, itemsLength);\r\n                            repeat.insertView(index, overrideContext.bindingContext, overrideContext);\r\n                            itemsPreviouslyInViews.splice(index, 0, undefined);\r\n                        }\r\n                        else if (indexOfView === index) {\r\n                            view = children[indexOfView];\r\n                            itemsPreviouslyInViews[indexOfView] = undefined;\r\n                        }\r\n                        else {\r\n                            view = children[indexOfView];\r\n                            repeat.moveView(indexOfView, index);\r\n                            itemsPreviouslyInViews.splice(indexOfView, 1);\r\n                            itemsPreviouslyInViews.splice(index, 0, undefined);\r\n                        }\r\n                        if (view) {\r\n                            updateOverrideContext(view.overrideContext, index, itemsLength);\r\n                        }\r\n                    }\r\n                    this._inPlaceProcessItems(repeat, items);\r\n                };\r\n            }\r\n            else {\r\n                removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n                updateViews = () => this._standardProcessInstanceChanged(repeat, items);\r\n            }\r\n            if (removePromise instanceof Promise) {\r\n                removePromise.then(updateViews);\r\n            }\r\n            else {\r\n                updateViews();\r\n            }\r\n        }\r\n        else {\r\n            this._inPlaceProcessItems(repeat, items);\r\n        }\r\n    }\r\n    _standardProcessInstanceChanged(repeat, items) {\r\n        for (let i = 0, ii = items.length; i < ii; i++) {\r\n            let overrideContext = createFullOverrideContext(repeat, items[i], i, ii);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n    }\r\n    _inPlaceProcessItems(repeat, items) {\r\n        let itemsLength = items.length;\r\n        let viewsLength = repeat.viewCount();\r\n        while (viewsLength > itemsLength) {\r\n            viewsLength--;\r\n            repeat.removeView(viewsLength, true, !repeat.viewsRequireLifecycle);\r\n        }\r\n        let local = repeat.local;\r\n        for (let i = 0; i < viewsLength; i++) {\r\n            let view = repeat.view(i);\r\n            let last = i === itemsLength - 1;\r\n            let middle = i !== 0 && !last;\r\n            let bindingContext = view.bindingContext;\r\n            let overrideContext = view.overrideContext;\r\n            if (bindingContext[local] === items[i]\r\n                && overrideContext.$middle === middle\r\n                && overrideContext.$last === last) {\r\n                continue;\r\n            }\r\n            bindingContext[local] = items[i];\r\n            overrideContext.$middle = middle;\r\n            overrideContext.$last = last;\r\n            repeat.updateBindings(view);\r\n        }\r\n        for (let i = viewsLength; i < itemsLength; i++) {\r\n            let overrideContext = createFullOverrideContext(repeat, items[i], i, itemsLength);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n    }\r\n    instanceMutated(repeat, array, splices) {\r\n        if (repeat.__queuedSplices) {\r\n            for (let i = 0, ii = splices.length; i < ii; ++i) {\r\n                let { index, removed, addedCount } = splices[i];\r\n                Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"mergeSplice\"])(repeat.__queuedSplices, index, removed, addedCount);\r\n            }\r\n            repeat.__array = array.slice(0);\r\n            return;\r\n        }\r\n        let maybePromise = this._runSplices(repeat, array.slice(0), splices);\r\n        if (maybePromise instanceof Promise) {\r\n            let queuedSplices = repeat.__queuedSplices = [];\r\n            let runQueuedSplices = () => {\r\n                if (!queuedSplices.length) {\r\n                    repeat.__queuedSplices = undefined;\r\n                    repeat.__array = undefined;\r\n                    return;\r\n                }\r\n                let nextPromise = this._runSplices(repeat, repeat.__array, queuedSplices) || Promise.resolve();\r\n                queuedSplices = repeat.__queuedSplices = [];\r\n                nextPromise.then(runQueuedSplices);\r\n            };\r\n            maybePromise.then(runQueuedSplices);\r\n        }\r\n    }\r\n    _runSplices(repeat, array, splices) {\r\n        let removeDelta = 0;\r\n        let rmPromises = [];\r\n        for (let i = 0, ii = splices.length; i < ii; ++i) {\r\n            let splice = splices[i];\r\n            let removed = splice.removed;\r\n            for (let j = 0, jj = removed.length; j < jj; ++j) {\r\n                let viewOrPromise = repeat.removeView(splice.index + removeDelta + rmPromises.length, true);\r\n                if (viewOrPromise instanceof Promise) {\r\n                    rmPromises.push(viewOrPromise);\r\n                }\r\n            }\r\n            removeDelta -= splice.addedCount;\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            return Promise.all(rmPromises).then(() => {\r\n                let spliceIndexLow = this._handleAddedSplices(repeat, array, splices);\r\n                updateOverrideContexts(repeat.views(), spliceIndexLow);\r\n            });\r\n        }\r\n        let spliceIndexLow = this._handleAddedSplices(repeat, array, splices);\r\n        updateOverrideContexts(repeat.views(), spliceIndexLow);\r\n        return undefined;\r\n    }\r\n    _handleAddedSplices(repeat, array, splices) {\r\n        let spliceIndex;\r\n        let spliceIndexLow;\r\n        let arrayLength = array.length;\r\n        for (let i = 0, ii = splices.length; i < ii; ++i) {\r\n            let splice = splices[i];\r\n            let addIndex = spliceIndex = splice.index;\r\n            let end = splice.index + splice.addedCount;\r\n            if (typeof spliceIndexLow === 'undefined' || spliceIndexLow === null || spliceIndexLow > splice.index) {\r\n                spliceIndexLow = spliceIndex;\r\n            }\r\n            for (; addIndex < end; ++addIndex) {\r\n                let overrideContext = createFullOverrideContext(repeat, array[addIndex], addIndex, arrayLength);\r\n                repeat.insertView(addIndex, overrideContext.bindingContext, overrideContext);\r\n            }\r\n        }\r\n        return spliceIndexLow;\r\n    }\r\n}\n\nclass MapRepeatStrategy {\r\n    getCollectionObserver(observerLocator, items) {\r\n        return observerLocator.getMapObserver(items);\r\n    }\r\n    instanceChanged(repeat, items) {\r\n        let removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(() => this._standardProcessItems(repeat, items));\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, items);\r\n    }\r\n    _standardProcessItems(repeat, items) {\r\n        let index = 0;\r\n        let overrideContext;\r\n        items.forEach((value, key) => {\r\n            overrideContext = createFullOverrideContext(repeat, value, index, items.size, key);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n            ++index;\r\n        });\r\n    }\r\n    instanceMutated(repeat, map, records) {\r\n        let key;\r\n        let i;\r\n        let ii;\r\n        let overrideContext;\r\n        let removeIndex;\r\n        let addIndex;\r\n        let record;\r\n        let rmPromises = [];\r\n        let viewOrPromise;\r\n        for (i = 0, ii = records.length; i < ii; ++i) {\r\n            record = records[i];\r\n            key = record.key;\r\n            switch (record.type) {\r\n                case 'update':\r\n                    removeIndex = this._getViewIndexByKey(repeat, key);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    overrideContext = createFullOverrideContext(repeat, map.get(key), removeIndex, map.size, key);\r\n                    repeat.insertView(removeIndex, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'add':\r\n                    addIndex = repeat.viewCount() <= map.size - 1 ? repeat.viewCount() : map.size - 1;\r\n                    overrideContext = createFullOverrideContext(repeat, map.get(key), addIndex, map.size, key);\r\n                    repeat.insertView(map.size - 1, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'delete':\r\n                    if (record.oldValue === undefined) {\r\n                        return;\r\n                    }\r\n                    removeIndex = this._getViewIndexByKey(repeat, key);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    break;\r\n                case 'clear':\r\n                    repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n                    break;\r\n                default:\r\n                    continue;\r\n            }\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            Promise.all(rmPromises).then(() => {\r\n                updateOverrideContexts(repeat.views(), 0);\r\n            });\r\n        }\r\n        else {\r\n            updateOverrideContexts(repeat.views(), 0);\r\n        }\r\n    }\r\n    _getViewIndexByKey(repeat, key) {\r\n        let i;\r\n        let ii;\r\n        let child;\r\n        for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {\r\n            child = repeat.view(i);\r\n            if (child.bindingContext[repeat.key] === key) {\r\n                return i;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n}\n\nclass NullRepeatStrategy {\r\n    instanceChanged(repeat, items) {\r\n        repeat.removeAllViews(true);\r\n    }\r\n    getCollectionObserver(observerLocator, items) {\r\n    }\r\n}\n\nclass NumberRepeatStrategy {\r\n    getCollectionObserver() {\r\n        return null;\r\n    }\r\n    instanceChanged(repeat, value) {\r\n        let removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(() => this._standardProcessItems(repeat, value));\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, value);\r\n    }\r\n    _standardProcessItems(repeat, value) {\r\n        let childrenLength = repeat.viewCount();\r\n        let i;\r\n        let ii;\r\n        let overrideContext;\r\n        let viewsToRemove;\r\n        value = Math.floor(value);\r\n        viewsToRemove = childrenLength - value;\r\n        if (viewsToRemove > 0) {\r\n            if (viewsToRemove > childrenLength) {\r\n                viewsToRemove = childrenLength;\r\n            }\r\n            for (i = 0, ii = viewsToRemove; i < ii; ++i) {\r\n                repeat.removeView(childrenLength - (i + 1), true, !repeat.viewsRequireLifecycle);\r\n            }\r\n            return;\r\n        }\r\n        for (i = childrenLength, ii = value; i < ii; ++i) {\r\n            overrideContext = createFullOverrideContext(repeat, i, i, ii);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n        updateOverrideContexts(repeat.views(), 0);\r\n    }\r\n}\n\nclass SetRepeatStrategy {\r\n    getCollectionObserver(observerLocator, items) {\r\n        return observerLocator.getSetObserver(items);\r\n    }\r\n    instanceChanged(repeat, items) {\r\n        let removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(() => this._standardProcessItems(repeat, items));\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, items);\r\n    }\r\n    _standardProcessItems(repeat, items) {\r\n        let index = 0;\r\n        let overrideContext;\r\n        items.forEach(value => {\r\n            overrideContext = createFullOverrideContext(repeat, value, index, items.size);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n            ++index;\r\n        });\r\n    }\r\n    instanceMutated(repeat, set, records) {\r\n        let value;\r\n        let i;\r\n        let ii;\r\n        let overrideContext;\r\n        let removeIndex;\r\n        let record;\r\n        let rmPromises = [];\r\n        let viewOrPromise;\r\n        for (i = 0, ii = records.length; i < ii; ++i) {\r\n            record = records[i];\r\n            value = record.value;\r\n            switch (record.type) {\r\n                case 'add':\r\n                    let size = Math.max(set.size - 1, 0);\r\n                    overrideContext = createFullOverrideContext(repeat, value, size, set.size);\r\n                    repeat.insertView(size, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'delete':\r\n                    removeIndex = this._getViewIndexByValue(repeat, value);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    break;\r\n                case 'clear':\r\n                    repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n                    break;\r\n                default:\r\n                    continue;\r\n            }\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            Promise.all(rmPromises).then(() => {\r\n                updateOverrideContexts(repeat.views(), 0);\r\n            });\r\n        }\r\n        else {\r\n            updateOverrideContexts(repeat.views(), 0);\r\n        }\r\n    }\r\n    _getViewIndexByValue(repeat, value) {\r\n        let i;\r\n        let ii;\r\n        let child;\r\n        for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {\r\n            child = repeat.view(i);\r\n            if (child.bindingContext[repeat.local] === value) {\r\n                return i;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n}\n\nclass RepeatStrategyLocator {\r\n    constructor() {\r\n        this.matchers = [];\r\n        this.strategies = [];\r\n        this.addStrategy(items => items === null || items === undefined, new NullRepeatStrategy());\r\n        this.addStrategy(items => items instanceof Array, new ArrayRepeatStrategy());\r\n        this.addStrategy(items => items instanceof Map, new MapRepeatStrategy());\r\n        this.addStrategy(items => items instanceof Set, new SetRepeatStrategy());\r\n        this.addStrategy(items => typeof items === 'number', new NumberRepeatStrategy());\r\n    }\r\n    addStrategy(matcher, strategy) {\r\n        this.matchers.push(matcher);\r\n        this.strategies.push(strategy);\r\n    }\r\n    getStrategy(items) {\r\n        let matchers = this.matchers;\r\n        for (let i = 0, ii = matchers.length; i < ii; ++i) {\r\n            if (matchers[i](items)) {\r\n                return this.strategies[i];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n}\n\nconst lifecycleOptionalBehaviors = ['focus', 'if', 'else', 'repeat', 'show', 'hide', 'with'];\r\nfunction behaviorRequiresLifecycle(instruction) {\r\n    let t = instruction.type;\r\n    let name = t.elementName !== null ? t.elementName : t.attributeName;\r\n    return lifecycleOptionalBehaviors.indexOf(name) === -1 && (t.handlesAttached || t.handlesBind || t.handlesCreated || t.handlesDetached || t.handlesUnbind)\r\n        || t.viewFactory && viewsRequireLifecycle(t.viewFactory)\r\n        || instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);\r\n}\r\nfunction targetRequiresLifecycle(instruction) {\r\n    let behaviors = instruction.behaviorInstructions;\r\n    if (behaviors) {\r\n        let i = behaviors.length;\r\n        while (i--) {\r\n            if (behaviorRequiresLifecycle(behaviors[i])) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);\r\n}\r\nfunction viewsRequireLifecycle(viewFactory) {\r\n    if ('_viewsRequireLifecycle' in viewFactory) {\r\n        return viewFactory._viewsRequireLifecycle;\r\n    }\r\n    viewFactory._viewsRequireLifecycle = false;\r\n    if (viewFactory.viewFactory) {\r\n        viewFactory._viewsRequireLifecycle = viewsRequireLifecycle(viewFactory.viewFactory);\r\n        return viewFactory._viewsRequireLifecycle;\r\n    }\r\n    if (viewFactory.template.querySelector('.au-animate')) {\r\n        viewFactory._viewsRequireLifecycle = true;\r\n        return true;\r\n    }\r\n    for (let id in viewFactory.instructions) {\r\n        if (targetRequiresLifecycle(viewFactory.instructions[id])) {\r\n            viewFactory._viewsRequireLifecycle = true;\r\n            return true;\r\n        }\r\n    }\r\n    viewFactory._viewsRequireLifecycle = false;\r\n    return false;\r\n}\n\nclass AbstractRepeater {\r\n    constructor(options) {\r\n        Object.assign(this, {\r\n            local: 'items',\r\n            viewsRequireLifecycle: true\r\n        }, options);\r\n    }\r\n    viewCount() {\r\n        throw new Error('subclass must implement `viewCount`');\r\n    }\r\n    views() {\r\n        throw new Error('subclass must implement `views`');\r\n    }\r\n    view(index) {\r\n        throw new Error('subclass must implement `view`');\r\n    }\r\n    matcher() {\r\n        throw new Error('subclass must implement `matcher`');\r\n    }\r\n    addView(bindingContext, overrideContext) {\r\n        throw new Error('subclass must implement `addView`');\r\n    }\r\n    insertView(index, bindingContext, overrideContext) {\r\n        throw new Error('subclass must implement `insertView`');\r\n    }\r\n    moveView(sourceIndex, targetIndex) {\r\n        throw new Error('subclass must implement `moveView`');\r\n    }\r\n    removeAllViews(returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeAllViews`');\r\n    }\r\n    removeViews(viewsToRemove, returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeView`');\r\n    }\r\n    removeView(index, returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeView`');\r\n    }\r\n    updateBindings(view) {\r\n        throw new Error('subclass must implement `updateBindings`');\r\n    }\r\n}\n\nlet Repeat = class Repeat extends AbstractRepeater {\r\n    constructor(viewFactory, instruction, viewSlot, viewResources, observerLocator, strategyLocator) {\r\n        super({\r\n            local: 'item',\r\n            viewsRequireLifecycle: viewsRequireLifecycle(viewFactory)\r\n        });\r\n        this.viewFactory = viewFactory;\r\n        this.instruction = instruction;\r\n        this.viewSlot = viewSlot;\r\n        this.lookupFunctions = viewResources.lookupFunctions;\r\n        this.observerLocator = observerLocator;\r\n        this.key = 'key';\r\n        this.value = 'value';\r\n        this.strategyLocator = strategyLocator;\r\n        this.ignoreMutation = false;\r\n        this.sourceExpression = getItemsSourceExpression(this.instruction, 'repeat.for');\r\n        this.isOneTime = isOneTime(this.sourceExpression);\r\n        this.viewsRequireLifecycle = viewsRequireLifecycle(viewFactory);\r\n    }\r\n    call(context, changes) {\r\n        this[context](this.items, changes);\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        this.scope = { bindingContext, overrideContext };\r\n        this.matcherBinding = this._captureAndRemoveMatcherBinding();\r\n        this.itemsChanged();\r\n    }\r\n    unbind() {\r\n        this.scope = null;\r\n        this.items = null;\r\n        this.matcherBinding = null;\r\n        this.viewSlot.removeAll(true, true);\r\n        this._unsubscribeCollection();\r\n    }\r\n    _unsubscribeCollection() {\r\n        if (this.collectionObserver) {\r\n            this.collectionObserver.unsubscribe(this.callContext, this);\r\n            this.collectionObserver = null;\r\n            this.callContext = null;\r\n        }\r\n    }\r\n    itemsChanged() {\r\n        this._unsubscribeCollection();\r\n        if (!this.scope) {\r\n            return;\r\n        }\r\n        let items = this.items;\r\n        this.strategy = this.strategyLocator.getStrategy(items);\r\n        if (!this.strategy) {\r\n            throw new Error(`Value for '${this.sourceExpression}' is non-repeatable`);\r\n        }\r\n        if (!this.isOneTime && !this._observeInnerCollection()) {\r\n            this._observeCollection();\r\n        }\r\n        this.ignoreMutation = true;\r\n        this.strategy.instanceChanged(this, items);\r\n        this.observerLocator.taskQueue.queueMicroTask(() => {\r\n            this.ignoreMutation = false;\r\n        });\r\n    }\r\n    _getInnerCollection() {\r\n        let expression = unwrapExpression(this.sourceExpression);\r\n        if (!expression) {\r\n            return null;\r\n        }\r\n        return expression.evaluate(this.scope, null);\r\n    }\r\n    handleCollectionMutated(collection, changes) {\r\n        if (!this.collectionObserver) {\r\n            return;\r\n        }\r\n        if (this.ignoreMutation) {\r\n            return;\r\n        }\r\n        this.strategy.instanceMutated(this, collection, changes);\r\n    }\r\n    handleInnerCollectionMutated(collection, changes) {\r\n        if (!this.collectionObserver) {\r\n            return;\r\n        }\r\n        if (this.ignoreMutation) {\r\n            return;\r\n        }\r\n        this.ignoreMutation = true;\r\n        let newItems = this.sourceExpression.evaluate(this.scope, this.lookupFunctions);\r\n        this.observerLocator.taskQueue.queueMicroTask(() => this.ignoreMutation = false);\r\n        if (newItems === this.items) {\r\n            this.itemsChanged();\r\n        }\r\n        else {\r\n            this.items = newItems;\r\n        }\r\n    }\r\n    _observeInnerCollection() {\r\n        let items = this._getInnerCollection();\r\n        let strategy = this.strategyLocator.getStrategy(items);\r\n        if (!strategy) {\r\n            return false;\r\n        }\r\n        this.collectionObserver = strategy.getCollectionObserver(this.observerLocator, items);\r\n        if (!this.collectionObserver) {\r\n            return false;\r\n        }\r\n        this.callContext = 'handleInnerCollectionMutated';\r\n        this.collectionObserver.subscribe(this.callContext, this);\r\n        return true;\r\n    }\r\n    _observeCollection() {\r\n        let items = this.items;\r\n        this.collectionObserver = this.strategy.getCollectionObserver(this.observerLocator, items);\r\n        if (this.collectionObserver) {\r\n            this.callContext = 'handleCollectionMutated';\r\n            this.collectionObserver.subscribe(this.callContext, this);\r\n        }\r\n    }\r\n    _captureAndRemoveMatcherBinding() {\r\n        if (this.viewFactory.viewFactory) {\r\n            const instructions = this.viewFactory.viewFactory.instructions;\r\n            const instructionIds = Object.keys(instructions);\r\n            for (let i = 0; i < instructionIds.length; i++) {\r\n                const expressions = instructions[instructionIds[i]].expressions;\r\n                if (expressions) {\r\n                    for (let ii = 0; ii < expressions.length; ii++) {\r\n                        if (expressions[ii].targetProperty === 'matcher') {\r\n                            const matcherBinding = expressions[ii];\r\n                            expressions.splice(ii, 1);\r\n                            return matcherBinding;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    viewCount() { return this.viewSlot.children.length; }\r\n    views() { return this.viewSlot.children; }\r\n    view(index) { return this.viewSlot.children[index]; }\r\n    matcher() { return this.matcherBinding ? this.matcherBinding.sourceExpression.evaluate(this.scope, this.matcherBinding.lookupFunctions) : null; }\r\n    addView(bindingContext, overrideContext) {\r\n        let view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.add(view);\r\n    }\r\n    insertView(index, bindingContext, overrideContext) {\r\n        let view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.insert(index, view);\r\n    }\r\n    moveView(sourceIndex, targetIndex) {\r\n        this.viewSlot.move(sourceIndex, targetIndex);\r\n    }\r\n    removeAllViews(returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAll(returnToCache, skipAnimation);\r\n    }\r\n    removeViews(viewsToRemove, returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeMany(viewsToRemove, returnToCache, skipAnimation);\r\n    }\r\n    removeView(index, returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAt(index, returnToCache, skipAnimation);\r\n    }\r\n    updateBindings(view) {\r\n        const $view = view;\r\n        let j = $view.bindings.length;\r\n        while (j--) {\r\n            updateOneTimeBinding($view.bindings[j]);\r\n        }\r\n        j = $view.controllers.length;\r\n        while (j--) {\r\n            let k = $view.controllers[j].boundProperties.length;\r\n            while (k--) {\r\n                let binding = $view.controllers[j].boundProperties[k].binding;\r\n                updateOneTimeBinding(binding);\r\n            }\r\n        }\r\n    }\r\n};\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Repeat.prototype, \"items\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Repeat.prototype, \"local\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Repeat.prototype, \"key\", void 0);\r\n__decorate([\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n], Repeat.prototype, \"value\", void 0);\r\nRepeat = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('repeat'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"TargetInstruction\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"ObserverLocator\"], RepeatStrategyLocator)\r\n], Repeat);\n\nconst aureliaHideClassName = 'aurelia-hide';\r\nconst aureliaHideClass = `.${aureliaHideClassName} { display:none !important; }`;\r\nfunction injectAureliaHideStyleAtHead() {\r\n    aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(aureliaHideClass);\r\n}\r\nfunction injectAureliaHideStyleAtBoundary(domBoundary) {\r\n    if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"FEATURE\"].shadowDOM && domBoundary && !domBoundary.hasAureliaHideStyle) {\r\n        domBoundary.hasAureliaHideStyle = true;\r\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(aureliaHideClass, domBoundary);\r\n    }\r\n}\n\nlet Show = class Show {\r\n    constructor(element, animator, domBoundary) {\r\n        this.element = element;\r\n        this.animator = animator;\r\n        this.domBoundary = domBoundary;\r\n    }\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Animator\"], aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Optional\"].of(aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].boundary, true)];\r\n    }\r\n    created() {\r\n        injectAureliaHideStyleAtBoundary(this.domBoundary);\r\n    }\r\n    valueChanged(newValue) {\r\n        let element = this.element;\r\n        let animator = this.animator;\r\n        if (newValue) {\r\n            animator.removeClass(element, aureliaHideClassName);\r\n        }\r\n        else {\r\n            animator.addClass(element, aureliaHideClassName);\r\n        }\r\n    }\r\n    bind(bindingContext) {\r\n        this.valueChanged(this.value);\r\n    }\r\n};\r\nShow = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('show')\r\n], Show);\n\nlet Hide = class Hide {\r\n    constructor(element, animator, domBoundary) {\r\n        this.element = element;\r\n        this.animator = animator;\r\n        this.domBoundary = domBoundary;\r\n    }\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Animator\"], aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Optional\"].of(aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].boundary, true)];\r\n    }\r\n    created() {\r\n        injectAureliaHideStyleAtBoundary(this.domBoundary);\r\n    }\r\n    valueChanged(newValue) {\r\n        if (newValue) {\r\n            this.animator.addClass(this.element, aureliaHideClassName);\r\n        }\r\n        else {\r\n            this.animator.removeClass(this.element, aureliaHideClassName);\r\n        }\r\n    }\r\n    bind(bindingContext) {\r\n        this.valueChanged(this.value);\r\n    }\r\n    value(value) {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n};\r\nHide = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('hide')\r\n], Hide);\n\nconst SCRIPT_REGEX = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\r\nlet needsToWarn = true;\r\nclass HTMLSanitizer {\r\n    sanitize(input) {\r\n        if (needsToWarn) {\r\n            needsToWarn = false;\r\n            Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_5__[\"getLogger\"])('html-sanitizer')\r\n                .warn(`CAUTION: The default HTMLSanitizer does NOT provide security against a wide variety of sophisticated XSS attacks,\nand should not be relied on for sanitizing input from unknown sources.\nPlease see https://aurelia.io/docs/binding/basics#element-content for instructions on how to use a secure solution like DOMPurify or sanitize-html.`);\r\n        }\r\n        return input.replace(SCRIPT_REGEX, '');\r\n    }\r\n}\n\nlet SanitizeHTMLValueConverter = class SanitizeHTMLValueConverter {\r\n    constructor(sanitizer) {\r\n        this.sanitizer = sanitizer;\r\n    }\r\n    toView(untrustedMarkup) {\r\n        if (untrustedMarkup === null || untrustedMarkup === undefined) {\r\n            return null;\r\n        }\r\n        return this.sanitizer.sanitize(untrustedMarkup);\r\n    }\r\n};\r\nSanitizeHTMLValueConverter = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"valueConverter\"])('sanitizeHTML'),\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(HTMLSanitizer)\r\n], SanitizeHTMLValueConverter);\n\nlet Replaceable = class Replaceable {\r\n    constructor(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.view = null;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        if (this.view === null) {\r\n            this.view = this.viewFactory.create();\r\n            this.viewSlot.add(this.view);\r\n        }\r\n        this.view.bind(bindingContext, overrideContext);\r\n    }\r\n    unbind() {\r\n        this.view.unbind();\r\n    }\r\n};\r\nReplaceable = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('replaceable'),\r\n    aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n    Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n], Replaceable);\n\nlet Focus = class Focus {\r\n    constructor(element, taskQueue) {\r\n        this.element = element;\r\n        this.taskQueue = taskQueue;\r\n        this.isAttached = false;\r\n        this.needsApply = false;\r\n    }\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__[\"TaskQueue\"]];\r\n    }\r\n    valueChanged(newValue) {\r\n        if (this.isAttached) {\r\n            this._apply();\r\n        }\r\n        else {\r\n            this.needsApply = true;\r\n        }\r\n    }\r\n    _apply() {\r\n        if (this.value) {\r\n            this.taskQueue.queueMicroTask(() => {\r\n                if (this.value) {\r\n                    this.element.focus();\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this.element.blur();\r\n        }\r\n    }\r\n    attached() {\r\n        this.isAttached = true;\r\n        if (this.needsApply) {\r\n            this.needsApply = false;\r\n            this._apply();\r\n        }\r\n        this.element.addEventListener('focus', this);\r\n        this.element.addEventListener('blur', this);\r\n    }\r\n    detached() {\r\n        this.isAttached = false;\r\n        this.element.removeEventListener('focus', this);\r\n        this.element.removeEventListener('blur', this);\r\n    }\r\n    handleEvent(e) {\r\n        if (e.type === 'focus') {\r\n            this.value = true;\r\n        }\r\n        else if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].activeElement !== this.element) {\r\n            this.value = false;\r\n        }\r\n    }\r\n};\r\nFocus = __decorate([\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('focus', aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay)\r\n], Focus);\n\nlet cssUrlMatcher = /url\\((?!['\"]data)([^)]+)\\)/gi;\r\nfunction fixupCSSUrls(address, css) {\r\n    if (typeof css !== 'string') {\r\n        throw new Error(`Failed loading required CSS file: ${address}`);\r\n    }\r\n    return css.replace(cssUrlMatcher, (match, p1) => {\r\n        let quote = p1.charAt(0);\r\n        if (quote === '\\'' || quote === '\"') {\r\n            p1 = p1.substr(1, p1.length - 2);\r\n        }\r\n        return 'url(\\'' + Object(aurelia_path__WEBPACK_IMPORTED_MODULE_7__[\"relativeToFile\"])(p1, address) + '\\')';\r\n    });\r\n}\r\nclass CSSResource {\r\n    constructor(address) {\r\n        this.address = address;\r\n        this._scoped = null;\r\n        this._global = false;\r\n        this._alreadyGloballyInjected = false;\r\n    }\r\n    initialize(container, Target) {\r\n        this._scoped = new Target(this);\r\n    }\r\n    register(registry, name) {\r\n        if (name === 'scoped') {\r\n            registry.registerViewEngineHooks(this._scoped);\r\n        }\r\n        else {\r\n            this._global = true;\r\n        }\r\n    }\r\n    load(container) {\r\n        return container.get(aurelia_loader__WEBPACK_IMPORTED_MODULE_6__[\"Loader\"])\r\n            .loadText(this.address)\r\n            .catch(err => null)\r\n            .then(text => {\r\n            text = fixupCSSUrls(this.address, text);\r\n            this._scoped.css = text;\r\n            if (this._global) {\r\n                this._alreadyGloballyInjected = true;\r\n                aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(text);\r\n            }\r\n        });\r\n    }\r\n}\r\nclass CSSViewEngineHooks {\r\n    constructor(owner) {\r\n        this.owner = owner;\r\n        this.css = null;\r\n    }\r\n    beforeCompile(content, resources, instruction) {\r\n        if (instruction.targetShadowDOM) {\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css, content, true);\r\n        }\r\n        else if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"FEATURE\"].scopedCSS) {\r\n            let styleNode = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css, content, true);\r\n            styleNode.setAttribute('scoped', 'scoped');\r\n        }\r\n        else if (this._global && !this.owner._alreadyGloballyInjected) {\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css);\r\n            this.owner._alreadyGloballyInjected = true;\r\n        }\r\n    }\r\n}\r\nfunction _createCSSResource(address) {\r\n    let ViewCSS = class ViewCSS extends CSSViewEngineHooks {\r\n    };\r\n    ViewCSS = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"resource\"])(new CSSResource(address))\r\n    ], ViewCSS);\r\n    return ViewCSS;\r\n}\n\nlet AttrBindingBehavior = class AttrBindingBehavior {\r\n    bind(binding, source) {\r\n        binding.targetObserver = new aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"DataAttributeObserver\"](binding.target, binding.targetProperty);\r\n    }\r\n    unbind(binding, source) {\r\n    }\r\n};\r\nAttrBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('attr')\r\n], AttrBindingBehavior);\n\nlet modeBindingBehavior = {\r\n    bind(binding, source, lookupFunctions) {\r\n        binding.originalMode = binding.mode;\r\n        binding.mode = this.mode;\r\n    },\r\n    unbind(binding, source) {\r\n        binding.mode = binding.originalMode;\r\n        binding.originalMode = null;\r\n    }\r\n};\r\nlet OneTimeBindingBehavior = class OneTimeBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].oneTime;\r\n    }\r\n};\r\nOneTimeBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('oneTime')\r\n], OneTimeBindingBehavior);\r\nlet OneWayBindingBehavior = class OneWayBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].toView;\r\n    }\r\n};\r\nOneWayBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('oneWay')\r\n], OneWayBindingBehavior);\r\nlet ToViewBindingBehavior = class ToViewBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].toView;\r\n    }\r\n};\r\nToViewBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('toView')\r\n], ToViewBindingBehavior);\r\nlet FromViewBindingBehavior = class FromViewBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView;\r\n    }\r\n};\r\nFromViewBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('fromView')\r\n], FromViewBindingBehavior);\r\nlet TwoWayBindingBehavior = class TwoWayBindingBehavior {\r\n    constructor() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay;\r\n    }\r\n};\r\nTwoWayBindingBehavior = __decorate([\r\n    Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('twoWay')\r\n], TwoWayBindingBehavior);\n\nfunction throttle(newValue) {\r\n    let state = this.throttleState;\r\n    let elapsed = +new Date() - state.last;\r\n    if (elapsed >= state.delay) {\r\n        clearTimeout(state.timeoutId);\r\n        state.timeoutId = null;\r\n        state.last = +new Date();\r\n        this.throttledMethod(newValue);\r\n        return;\r\n    }\r\n    state.newValue = newValue;\r\n    if (state.timeoutId === null) {\r\n        state.timeoutId = setTimeout(() => {\r\n            state.timeoutId = null;\r\n            state.last = +new Date();\r\n            this.throttledMethod(state.newValue);\r\n        }, state.delay - elapsed);\r\n    }\r\n}\r\nlet ThrottleBindingBehavior = class ThrottleBindingBehavior {\r\n    bind(binding, source, delay = 200) {\r\n        let methodToThrottle = 'updateTarget';\r\n        if (binding.callSource) {\r\n            methodToThrottle = 'callSource';\r\n        }\r\n        else if (binding.updateSource && binding.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay) {\r\n            methodToThrottle = 'updateSource';\r\n        }\r\n        binding.throttledMethod = binding[methodToThrottle];\r\n        binding.throttledMethod.originalName = methodToThrottle;\r\n        binding[methodToThrottle] = throttle;\r\n        binding.throttleState = {\r\n            delay: delay,\r\n            last: 0,\r\n            timeoutId: null\r\n        };\r\n    }\r\n    unbind(binding, source) {\r\n        let methodToRestore = binding.throttledMethod.originalName;\r\n        binding[methodToRestore] = binding.throttledMethod;\r\n        binding.throttledMethod = null;\r\n        clearTimeout(binding.throttleState.timeoutId);\r\n        binding.throttleState = null;\r\n    }\r\n};\r\nThrottleBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('throttle')\r\n], ThrottleBindingBehavior);\n\nconst unset = {};\r\nfunction debounceCallSource(event) {\r\n    const state = this.debounceState;\r\n    clearTimeout(state.timeoutId);\r\n    state.timeoutId = setTimeout(() => this.debouncedMethod(event), state.delay);\r\n}\r\nfunction debounceCall(context, newValue, oldValue) {\r\n    const state = this.debounceState;\r\n    clearTimeout(state.timeoutId);\r\n    if (context !== state.callContextToDebounce) {\r\n        state.oldValue = unset;\r\n        this.debouncedMethod(context, newValue, oldValue);\r\n        return;\r\n    }\r\n    if (state.oldValue === unset) {\r\n        state.oldValue = oldValue;\r\n    }\r\n    state.timeoutId = setTimeout(() => {\r\n        const _oldValue = state.oldValue;\r\n        state.oldValue = unset;\r\n        this.debouncedMethod(context, newValue, _oldValue);\r\n    }, state.delay);\r\n}\r\nlet DebounceBindingBehavior = class DebounceBindingBehavior {\r\n    bind(binding, source, delay = 200) {\r\n        const isCallSource = binding.callSource !== undefined;\r\n        const methodToDebounce = isCallSource ? 'callSource' : 'call';\r\n        const debouncer = isCallSource ? debounceCallSource : debounceCall;\r\n        const mode = binding.mode;\r\n        const callContextToDebounce = mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay || mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView ? aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"targetContext\"] : aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"];\r\n        binding.debouncedMethod = binding[methodToDebounce];\r\n        binding.debouncedMethod.originalName = methodToDebounce;\r\n        binding[methodToDebounce] = debouncer;\r\n        binding.debounceState = {\r\n            callContextToDebounce,\r\n            delay,\r\n            timeoutId: 0,\r\n            oldValue: unset\r\n        };\r\n    }\r\n    unbind(binding, source) {\r\n        const methodToRestore = binding.debouncedMethod.originalName;\r\n        binding[methodToRestore] = binding.debouncedMethod;\r\n        binding.debouncedMethod = null;\r\n        clearTimeout(binding.debounceState.timeoutId);\r\n        binding.debounceState = null;\r\n    }\r\n};\r\nDebounceBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('debounce')\r\n], DebounceBindingBehavior);\n\nfunction findOriginalEventTarget(event) {\r\n    return (event.path && event.path[0]) || (event.deepPath && event.deepPath[0]) || event.target;\r\n}\r\nfunction handleSelfEvent(event) {\r\n    let target = findOriginalEventTarget(event);\r\n    if (this.target !== target) {\r\n        return;\r\n    }\r\n    this.selfEventCallSource(event);\r\n}\r\nlet SelfBindingBehavior = class SelfBindingBehavior {\r\n    bind(binding, source) {\r\n        if (!binding.callSource || !binding.targetEvent) {\r\n            throw new Error('Self binding behavior only supports event.');\r\n        }\r\n        binding.selfEventCallSource = binding.callSource;\r\n        binding.callSource = handleSelfEvent;\r\n    }\r\n    unbind(binding, source) {\r\n        binding.callSource = binding.selfEventCallSource;\r\n        binding.selfEventCallSource = null;\r\n    }\r\n};\r\nSelfBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('self')\r\n], SelfBindingBehavior);\n\nclass BindingSignaler {\r\n    constructor() {\r\n        this.signals = {};\r\n    }\r\n    signal(name) {\r\n        let bindings = this.signals[name];\r\n        if (!bindings) {\r\n            return;\r\n        }\r\n        let i = bindings.length;\r\n        while (i--) {\r\n            bindings[i].call(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"]);\r\n        }\r\n    }\r\n}\n\nlet SignalBindingBehavior = class SignalBindingBehavior {\r\n    constructor(bindingSignaler) {\r\n        this.signals = bindingSignaler.signals;\r\n    }\r\n    static inject() { return [BindingSignaler]; }\r\n    bind(binding, source, ...names) {\r\n        if (!binding.updateTarget) {\r\n            throw new Error('Only property bindings and string interpolation bindings can be signaled.  Trigger, delegate and call bindings cannot be signaled.');\r\n        }\r\n        let signals = this.signals;\r\n        if (names.length === 1) {\r\n            let name = names[0];\r\n            let bindings = signals[name] || (signals[name] = []);\r\n            bindings.push(binding);\r\n            binding.signalName = name;\r\n        }\r\n        else if (names.length > 1) {\r\n            let i = names.length;\r\n            while (i--) {\r\n                let name = names[i];\r\n                let bindings = signals[name] || (signals[name] = []);\r\n                bindings.push(binding);\r\n            }\r\n            binding.signalName = names;\r\n        }\r\n        else {\r\n            throw new Error('Signal name is required.');\r\n        }\r\n    }\r\n    unbind(binding, source) {\r\n        let signals = this.signals;\r\n        let name = binding.signalName;\r\n        binding.signalName = null;\r\n        if (Array.isArray(name)) {\r\n            let names = name;\r\n            let i = names.length;\r\n            while (i--) {\r\n                let n = names[i];\r\n                let bindings = signals[n];\r\n                bindings.splice(bindings.indexOf(binding), 1);\r\n            }\r\n        }\r\n        else {\r\n            let bindings = signals[name];\r\n            bindings.splice(bindings.indexOf(binding), 1);\r\n        }\r\n    }\r\n};\r\nSignalBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('signal')\r\n], SignalBindingBehavior);\n\nconst eventNamesRequired = 'The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:\\'blur\\'\">';\r\nconst notApplicableMessage = 'The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.';\r\nlet UpdateTriggerBindingBehavior = class UpdateTriggerBindingBehavior {\r\n    bind(binding, source, ...events) {\r\n        if (events.length === 0) {\r\n            throw new Error(eventNamesRequired);\r\n        }\r\n        if (binding.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay && binding.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView) {\r\n            throw new Error(notApplicableMessage);\r\n        }\r\n        let targetObserver = binding.observerLocator.getObserver(binding.target, binding.targetProperty);\r\n        if (!targetObserver.handler) {\r\n            throw new Error(notApplicableMessage);\r\n        }\r\n        binding.targetObserver = targetObserver;\r\n        targetObserver.originalHandler = binding.targetObserver.handler;\r\n        let handler = new aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"EventSubscriber\"](events);\r\n        targetObserver.handler = handler;\r\n    }\r\n    unbind(binding, source) {\r\n        let targetObserver = binding.targetObserver;\r\n        targetObserver.handler.dispose();\r\n        targetObserver.handler = targetObserver.originalHandler;\r\n        targetObserver.originalHandler = null;\r\n    }\r\n};\r\nUpdateTriggerBindingBehavior = __decorate([\r\n    Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('updateTrigger')\r\n], UpdateTriggerBindingBehavior);\n\nfunction _createDynamicElement({ name, viewUrl, bindableNames, useShadowDOMmode }) {\r\n    let DynamicElement = class DynamicElement {\r\n        bind(bindingContext) {\r\n            this.$parent = bindingContext;\r\n        }\r\n    };\r\n    DynamicElement = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])(name),\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useView\"])(viewUrl)\r\n    ], DynamicElement);\r\n    for (let i = 0, ii = bindableNames.length; i < ii; ++i) {\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"])(bindableNames[i])(DynamicElement);\r\n    }\r\n    switch (useShadowDOMmode) {\r\n        case 'open':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])({ mode: 'open' })(DynamicElement);\r\n            break;\r\n        case 'closed':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])({ mode: 'closed' })(DynamicElement);\r\n            break;\r\n        case '':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])(DynamicElement);\r\n            break;\r\n        case null:\r\n            break;\r\n        default:\r\n            Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_5__[\"getLogger\"])('aurelia-html-only-element')\r\n                .warn(`Expected 'use-shadow-dom' value to be \"close\", \"open\" or \"\", received ${useShadowDOMmode}`);\r\n            break;\r\n    }\r\n    return DynamicElement;\r\n}\n\nfunction getElementName(address) {\r\n    return /([^\\/^\\?]+)\\.html/i.exec(address)[1].toLowerCase();\r\n}\r\nfunction configure(config) {\r\n    const viewEngine = config.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]);\r\n    const loader = config.aurelia.loader;\r\n    viewEngine.addResourcePlugin('.html', {\r\n        'fetch': function (viewUrl) {\r\n            return loader.loadTemplate(viewUrl).then(registryEntry => {\r\n                let bindableNames = registryEntry.template.getAttribute('bindable');\r\n                const useShadowDOMmode = registryEntry.template.getAttribute('use-shadow-dom');\r\n                const name = getElementName(viewUrl);\r\n                if (bindableNames) {\r\n                    bindableNames = bindableNames.split(',').map(x => x.trim());\r\n                    registryEntry.template.removeAttribute('bindable');\r\n                }\r\n                else {\r\n                    bindableNames = [];\r\n                }\r\n                return { [name]: _createDynamicElement({ name, viewUrl, bindableNames, useShadowDOMmode }) };\r\n            });\r\n        }\r\n    });\r\n}\n\nfunction configure$1(config) {\r\n    injectAureliaHideStyleAtHead();\r\n    config.globalResources(Compose, If, Else, With, Repeat, Show, Hide, Replaceable, Focus, SanitizeHTMLValueConverter, OneTimeBindingBehavior, OneWayBindingBehavior, ToViewBindingBehavior, FromViewBindingBehavior, TwoWayBindingBehavior, ThrottleBindingBehavior, DebounceBindingBehavior, SelfBindingBehavior, SignalBindingBehavior, UpdateTriggerBindingBehavior, AttrBindingBehavior);\r\n    configure(config);\r\n    let viewEngine = config.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]);\r\n    let styleResourcePlugin = {\r\n        fetch(address) {\r\n            return { [address]: _createCSSResource(address) };\r\n        }\r\n    };\r\n    ['.css', '.less', '.sass', '.scss', '.styl'].forEach(ext => viewEngine.addResourcePlugin(ext, styleResourcePlugin));\r\n}\n\n\n//# sourceMappingURL=aurelia-templating-resources.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvZXMyMDE1L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMuanM/OWIzMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250YWluZXIsIGluamVjdCwgT3B0aW9uYWwgfSBmcm9tICdhdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uJztcbmltcG9ydCB7IERPTSwgRkVBVFVSRSB9IGZyb20gJ2F1cmVsaWEtcGFsJztcbmltcG9ydCB7IFRhc2tRdWV1ZSB9IGZyb20gJ2F1cmVsaWEtdGFzay1xdWV1ZSc7XG5pbXBvcnQgeyBDb21wb3NpdGlvbkVuZ2luZSwgVmlld1Nsb3QsIFZpZXdSZXNvdXJjZXMsIGJpbmRhYmxlLCBub1ZpZXcsIGN1c3RvbUVsZW1lbnQsIGN1c3RvbUF0dHJpYnV0ZSwgdGVtcGxhdGVDb250cm9sbGVyLCBCb3VuZFZpZXdGYWN0b3J5LCBUYXJnZXRJbnN0cnVjdGlvbiwgQW5pbWF0b3IsIHJlc291cmNlLCB1c2VWaWV3LCB1c2VTaGFkb3dET00sIFZpZXdFbmdpbmUgfSBmcm9tICdhdXJlbGlhLXRlbXBsYXRpbmcnO1xuaW1wb3J0IHsgY3JlYXRlT3ZlcnJpZGVDb250ZXh0LCBiaW5kaW5nTW9kZSwgQmluZGluZ0JlaGF2aW9yLCBWYWx1ZUNvbnZlcnRlciwgc291cmNlQ29udGV4dCwgbWVyZ2VTcGxpY2UsIE9ic2VydmVyTG9jYXRvciwgdmFsdWVDb252ZXJ0ZXIsIERhdGFBdHRyaWJ1dGVPYnNlcnZlciwgYmluZGluZ0JlaGF2aW9yLCB0YXJnZXRDb250ZXh0LCBFdmVudFN1YnNjcmliZXIgfSBmcm9tICdhdXJlbGlhLWJpbmRpbmcnO1xuaW1wb3J0IHsgZ2V0TG9nZ2VyIH0gZnJvbSAnYXVyZWxpYS1sb2dnaW5nJztcbmltcG9ydCB7IExvYWRlciB9IGZyb20gJ2F1cmVsaWEtbG9hZGVyJztcbmltcG9ydCB7IHJlbGF0aXZlVG9GaWxlIH0gZnJvbSAnYXVyZWxpYS1wYXRoJztcbmltcG9ydCB7IG1peGluIH0gZnJvbSAnYXVyZWxpYS1tZXRhZGF0YSc7XG5cbi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcblxyXG5mdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XG5cbmxldCBDb21wb3NlID0gY2xhc3MgQ29tcG9zZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBjb250YWluZXIsIGNvbXBvc2l0aW9uRW5naW5lLCB2aWV3U2xvdCwgdmlld1Jlc291cmNlcywgdGFza1F1ZXVlKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgICAgICB0aGlzLmNvbXBvc2l0aW9uRW5naW5lID0gY29tcG9zaXRpb25FbmdpbmU7XHJcbiAgICAgICAgdGhpcy52aWV3U2xvdCA9IHZpZXdTbG90O1xyXG4gICAgICAgIHRoaXMudmlld1Jlc291cmNlcyA9IHZpZXdSZXNvdXJjZXM7XHJcbiAgICAgICAgdGhpcy50YXNrUXVldWUgPSB0YXNrUXVldWU7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50Q29udHJvbGxlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50Vmlld01vZGVsID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNoYW5nZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGluamVjdCgpIHtcclxuICAgICAgICByZXR1cm4gW0RPTS5FbGVtZW50LCBDb250YWluZXIsIENvbXBvc2l0aW9uRW5naW5lLCBWaWV3U2xvdCwgVmlld1Jlc291cmNlcywgVGFza1F1ZXVlXTtcclxuICAgIH1cclxuICAgIGNyZWF0ZWQob3duaW5nVmlldykge1xyXG4gICAgICAgIHRoaXMub3duaW5nVmlldyA9IG93bmluZ1ZpZXc7XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICAgICAgbGV0IGNoYW5nZXMgPSB0aGlzLmNoYW5nZXM7XHJcbiAgICAgICAgY2hhbmdlcy52aWV3ID0gdGhpcy52aWV3O1xyXG4gICAgICAgIGNoYW5nZXMudmlld01vZGVsID0gdGhpcy52aWV3TW9kZWw7XHJcbiAgICAgICAgY2hhbmdlcy5tb2RlbCA9IHRoaXMubW9kZWw7XHJcbiAgICAgICAgaWYgKCF0aGlzLnBlbmRpbmdUYXNrKSB7XHJcbiAgICAgICAgICAgIHByb2Nlc3NDaGFuZ2VzKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHVuYmluZCgpIHtcclxuICAgICAgICB0aGlzLmNoYW5nZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcclxuICAgICAgICBsZXQgcmV0dXJuVG9DYWNoZSA9IHRydWU7XHJcbiAgICAgICAgbGV0IHNraXBBbmltYXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QucmVtb3ZlQWxsKHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xyXG4gICAgfVxyXG4gICAgbW9kZWxDaGFuZ2VkKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcy5tb2RlbCA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIHJlcXVlc3RVcGRhdGUodGhpcyk7XHJcbiAgICB9XHJcbiAgICB2aWV3Q2hhbmdlZChuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcclxuICAgICAgICB0aGlzLmNoYW5nZXMudmlldyA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIHJlcXVlc3RVcGRhdGUodGhpcyk7XHJcbiAgICB9XHJcbiAgICB2aWV3TW9kZWxDaGFuZ2VkKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcy52aWV3TW9kZWwgPSBuZXdWYWx1ZTtcclxuICAgICAgICByZXF1ZXN0VXBkYXRlKHRoaXMpO1xyXG4gICAgfVxyXG59O1xyXG5fX2RlY29yYXRlKFtcclxuICAgIGJpbmRhYmxlXHJcbl0sIENvbXBvc2UucHJvdG90eXBlLCBcIm1vZGVsXCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGFibGVcclxuXSwgQ29tcG9zZS5wcm90b3R5cGUsIFwidmlld1wiLCB2b2lkIDApO1xyXG5fX2RlY29yYXRlKFtcclxuICAgIGJpbmRhYmxlXHJcbl0sIENvbXBvc2UucHJvdG90eXBlLCBcInZpZXdNb2RlbFwiLCB2b2lkIDApO1xyXG5fX2RlY29yYXRlKFtcclxuICAgIGJpbmRhYmxlXHJcbl0sIENvbXBvc2UucHJvdG90eXBlLCBcInN3YXBPcmRlclwiLCB2b2lkIDApO1xyXG5Db21wb3NlID0gX19kZWNvcmF0ZShbXHJcbiAgICBub1ZpZXcsXHJcbiAgICBjdXN0b21FbGVtZW50KCdjb21wb3NlJylcclxuXSwgQ29tcG9zZSk7XHJcbmZ1bmN0aW9uIGlzRW1wdHkob2JqKSB7XHJcbiAgICBmb3IgKGNvbnN0IF8gaW4gb2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuZnVuY3Rpb24gdHJ5QWN0aXZhdGVWaWV3TW9kZWwodm0sIG1vZGVsKSB7XHJcbiAgICBpZiAodm0gJiYgdHlwZW9mIHZtLmFjdGl2YXRlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2bS5hY3RpdmF0ZShtb2RlbCkpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUluc3RydWN0aW9uKGNvbXBvc2VyLCBpbnN0cnVjdGlvbikge1xyXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oaW5zdHJ1Y3Rpb24sIHtcclxuICAgICAgICBiaW5kaW5nQ29udGV4dDogY29tcG9zZXIuYmluZGluZ0NvbnRleHQsXHJcbiAgICAgICAgb3ZlcnJpZGVDb250ZXh0OiBjb21wb3Nlci5vdmVycmlkZUNvbnRleHQsXHJcbiAgICAgICAgb3duaW5nVmlldzogY29tcG9zZXIub3duaW5nVmlldyxcclxuICAgICAgICBjb250YWluZXI6IGNvbXBvc2VyLmNvbnRhaW5lcixcclxuICAgICAgICB2aWV3U2xvdDogY29tcG9zZXIudmlld1Nsb3QsXHJcbiAgICAgICAgdmlld1Jlc291cmNlczogY29tcG9zZXIudmlld1Jlc291cmNlcyxcclxuICAgICAgICBjdXJyZW50Q29udHJvbGxlcjogY29tcG9zZXIuY3VycmVudENvbnRyb2xsZXIsXHJcbiAgICAgICAgaG9zdDogY29tcG9zZXIuZWxlbWVudCxcclxuICAgICAgICBzd2FwT3JkZXI6IGNvbXBvc2VyLnN3YXBPcmRlclxyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gcHJvY2Vzc0NoYW5nZXMoY29tcG9zZXIpIHtcclxuICAgIGNvbnN0IGNoYW5nZXMgPSBjb21wb3Nlci5jaGFuZ2VzO1xyXG4gICAgY29tcG9zZXIuY2hhbmdlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICBpZiAoISgndmlldycgaW4gY2hhbmdlcykgJiYgISgndmlld01vZGVsJyBpbiBjaGFuZ2VzKSAmJiAoJ21vZGVsJyBpbiBjaGFuZ2VzKSkge1xyXG4gICAgICAgIGNvbXBvc2VyLnBlbmRpbmdUYXNrID0gdHJ5QWN0aXZhdGVWaWV3TW9kZWwoY29tcG9zZXIuY3VycmVudFZpZXdNb2RlbCwgY2hhbmdlcy5tb2RlbCk7XHJcbiAgICAgICAgaWYgKCFjb21wb3Nlci5wZW5kaW5nVGFzaykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgbGV0IGluc3RydWN0aW9uID0ge1xyXG4gICAgICAgICAgICB2aWV3OiBjb21wb3Nlci52aWV3LFxyXG4gICAgICAgICAgICB2aWV3TW9kZWw6IGNvbXBvc2VyLmN1cnJlbnRWaWV3TW9kZWwgfHwgY29tcG9zZXIudmlld01vZGVsLFxyXG4gICAgICAgICAgICBtb2RlbDogY29tcG9zZXIubW9kZWxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGluc3RydWN0aW9uID0gT2JqZWN0LmFzc2lnbihpbnN0cnVjdGlvbiwgY2hhbmdlcyk7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb24gPSBjcmVhdGVJbnN0cnVjdGlvbihjb21wb3NlciwgaW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgIGNvbXBvc2VyLnBlbmRpbmdUYXNrID0gY29tcG9zZXIuY29tcG9zaXRpb25FbmdpbmUuY29tcG9zZShpbnN0cnVjdGlvbikudGhlbihjb250cm9sbGVyID0+IHtcclxuICAgICAgICAgICAgY29tcG9zZXIuY3VycmVudENvbnRyb2xsZXIgPSBjb250cm9sbGVyO1xyXG4gICAgICAgICAgICBjb21wb3Nlci5jdXJyZW50Vmlld01vZGVsID0gY29udHJvbGxlciA/IGNvbnRyb2xsZXIudmlld01vZGVsIDogbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGNvbXBvc2VyLnBlbmRpbmdUYXNrID0gY29tcG9zZXIucGVuZGluZ1Rhc2tcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY29tcGxldGVDb21wb3NpdGlvblRhc2soY29tcG9zZXIpO1xyXG4gICAgfSwgcmVhc29uID0+IHtcclxuICAgICAgICBjb21wbGV0ZUNvbXBvc2l0aW9uVGFzayhjb21wb3Nlcik7XHJcbiAgICAgICAgdGhyb3cgcmVhc29uO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gY29tcGxldGVDb21wb3NpdGlvblRhc2soY29tcG9zZXIpIHtcclxuICAgIGNvbXBvc2VyLnBlbmRpbmdUYXNrID0gbnVsbDtcclxuICAgIGlmICghaXNFbXB0eShjb21wb3Nlci5jaGFuZ2VzKSkge1xyXG4gICAgICAgIHByb2Nlc3NDaGFuZ2VzKGNvbXBvc2VyKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZXF1ZXN0VXBkYXRlKGNvbXBvc2VyKSB7XHJcbiAgICBpZiAoY29tcG9zZXIucGVuZGluZ1Rhc2sgfHwgY29tcG9zZXIudXBkYXRlUmVxdWVzdGVkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29tcG9zZXIudXBkYXRlUmVxdWVzdGVkID0gdHJ1ZTtcclxuICAgIGNvbXBvc2VyLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzaygoKSA9PiB7XHJcbiAgICAgICAgY29tcG9zZXIudXBkYXRlUmVxdWVzdGVkID0gZmFsc2U7XHJcbiAgICAgICAgcHJvY2Vzc0NoYW5nZXMoY29tcG9zZXIpO1xyXG4gICAgfSk7XHJcbn1cblxuY2xhc3MgSWZDb3JlIHtcclxuICAgIGNvbnN0cnVjdG9yKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy52aWV3ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zaG93aW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jYWNoZSA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICB9XHJcbiAgICB1bmJpbmQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudmlldyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmlldy51bmJpbmQoKTtcclxuICAgICAgICBpZiAoIXRoaXMudmlld0ZhY3RvcnkuaXNDYWNoaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd2luZykge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy52aWV3U2xvdC5yZW1vdmUodGhpcy52aWV3LCB0cnVlLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlldy5yZXR1cm5Ub0NhY2hlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBfc2hvdygpIHtcclxuICAgICAgICBpZiAodGhpcy5zaG93aW5nKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy52aWV3LmlzQm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy5iaW5kKHRoaXMuYmluZGluZ0NvbnRleHQsIHRoaXMub3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnZpZXcgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy52aWV3ID0gdGhpcy52aWV3RmFjdG9yeS5jcmVhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLnZpZXcuaXNCb3VuZCkge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXcuYmluZCh0aGlzLmJpbmRpbmdDb250ZXh0LCB0aGlzLm92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld1Nsb3QuYWRkKHRoaXMudmlldyk7XHJcbiAgICB9XHJcbiAgICBfaGlkZSgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc2hvd2luZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9IGZhbHNlO1xyXG4gICAgICAgIGxldCByZW1vdmVkID0gdGhpcy52aWV3U2xvdC5yZW1vdmUodGhpcy52aWV3KTtcclxuICAgICAgICBpZiAocmVtb3ZlZCBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbW92ZWQudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91bmJpbmRWaWV3KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91bmJpbmRWaWV3KCk7XHJcbiAgICB9XHJcbiAgICBfdW5iaW5kVmlldygpIHtcclxuICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuY2FjaGUgPT09ICdmYWxzZScgPyBmYWxzZSA6ICEhdGhpcy5jYWNoZTtcclxuICAgICAgICB0aGlzLnZpZXcudW5iaW5kKCk7XHJcbiAgICAgICAgaWYgKCFjYWNoZSkge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXcgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5sZXQgSWYgPSBjbGFzcyBJZiBleHRlbmRzIElmQ29yZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xyXG4gICAgICAgIHRoaXMuY2FjaGUgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgc3VwZXIuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICBpZiAodGhpcy5jb25kaXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbmRpdGlvbkNoYW5nZWQobmV3VmFsdWUpIHtcclxuICAgICAgICB0aGlzLl91cGRhdGUobmV3VmFsdWUpO1xyXG4gICAgfVxyXG4gICAgX3VwZGF0ZShzaG93KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHByb21pc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuZWxzZVZtKSB7XHJcbiAgICAgICAgICAgIHByb21pc2UgPSBzaG93ID8gdGhpcy5fc3dhcCh0aGlzLmVsc2VWbSwgdGhpcykgOiB0aGlzLl9zd2FwKHRoaXMsIHRoaXMuZWxzZVZtKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHByb21pc2UgPSBzaG93ID8gdGhpcy5fc2hvdygpIDogdGhpcy5faGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJvbWlzZSkge1xyXG4gICAgICAgICAgICB0aGlzLmFuaW1hdGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIHByb21pc2UudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uZGl0aW9uICE9PSB0aGlzLnNob3dpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGUodGhpcy5jb25kaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfc3dhcChyZW1vdmUsIGFkZCkge1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5zd2FwT3JkZXIpIHtcclxuICAgICAgICAgICAgY2FzZSAnYmVmb3JlJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoYWRkLl9zaG93KCkpLnRoZW4oKCkgPT4gcmVtb3ZlLl9oaWRlKCkpO1xyXG4gICAgICAgICAgICBjYXNlICd3aXRoJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbcmVtb3ZlLl9oaWRlKCksIGFkZC5fc2hvdygpXSk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBsZXQgcHJvbWlzZSA9IHJlbW92ZS5faGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UgPyBwcm9taXNlLnRoZW4oKCkgPT4gYWRkLl9zaG93KCkpIDogYWRkLl9zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5fX2RlY29yYXRlKFtcclxuICAgIGJpbmRhYmxlKHsgcHJpbWFyeVByb3BlcnR5OiB0cnVlIH0pXHJcbl0sIElmLnByb3RvdHlwZSwgXCJjb25kaXRpb25cIiwgdm9pZCAwKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICBiaW5kYWJsZVxyXG5dLCBJZi5wcm90b3R5cGUsIFwic3dhcE9yZGVyXCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGFibGVcclxuXSwgSWYucHJvdG90eXBlLCBcImNhY2hlXCIsIHZvaWQgMCk7XHJcbklmID0gX19kZWNvcmF0ZShbXHJcbiAgICBjdXN0b21BdHRyaWJ1dGUoJ2lmJyksXHJcbiAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICBpbmplY3QoQm91bmRWaWV3RmFjdG9yeSwgVmlld1Nsb3QpXHJcbl0sIElmKTtcblxubGV0IEVsc2UgPSBjbGFzcyBFbHNlIGV4dGVuZHMgSWZDb3JlIHtcclxuICAgIGNvbnN0cnVjdG9yKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHN1cGVyKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCk7XHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJJbklmKCk7XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICBzdXBlci5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgIGlmICh0aGlzLmlmVm0uY29uZGl0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3coKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfcmVnaXN0ZXJJbklmKCkge1xyXG4gICAgICAgIGxldCBwcmV2aW91cyA9IHRoaXMudmlld1Nsb3QuYW5jaG9yLnByZXZpb3VzU2libGluZztcclxuICAgICAgICB3aGlsZSAocHJldmlvdXMgJiYgIXByZXZpb3VzLmF1KSB7XHJcbiAgICAgICAgICAgIHByZXZpb3VzID0gcHJldmlvdXMucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXByZXZpb3VzIHx8ICFwcmV2aW91cy5hdS5pZikge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBmaW5kIG1hdGNoaW5nIElmIGZvciBFbHNlIGN1c3RvbSBhdHRyaWJ1dGUuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlmVm0gPSBwcmV2aW91cy5hdS5pZi52aWV3TW9kZWw7XHJcbiAgICAgICAgdGhpcy5pZlZtLmVsc2VWbSA9IHRoaXM7XHJcbiAgICB9XHJcbn07XHJcbkVsc2UgPSBfX2RlY29yYXRlKFtcclxuICAgIGN1c3RvbUF0dHJpYnV0ZSgnZWxzZScpLFxyXG4gICAgdGVtcGxhdGVDb250cm9sbGVyLFxyXG4gICAgaW5qZWN0KEJvdW5kVmlld0ZhY3RvcnksIFZpZXdTbG90KVxyXG5dLCBFbHNlKTtcblxubGV0IFdpdGggPSBjbGFzcyBXaXRoIHtcclxuICAgIGNvbnN0cnVjdG9yKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy5wYXJlbnRPdmVycmlkZUNvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLnBhcmVudE92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlZCh0aGlzLnZhbHVlKTtcclxuICAgIH1cclxuICAgIHZhbHVlQ2hhbmdlZChuZXdWYWx1ZSkge1xyXG4gICAgICAgIGxldCBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVPdmVycmlkZUNvbnRleHQobmV3VmFsdWUsIHRoaXMucGFyZW50T3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICBsZXQgdmlldyA9IHRoaXMudmlldztcclxuICAgICAgICBpZiAoIXZpZXcpIHtcclxuICAgICAgICAgICAgdmlldyA9IHRoaXMudmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XHJcbiAgICAgICAgICAgIHZpZXcuYmluZChuZXdWYWx1ZSwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy52aWV3U2xvdC5hZGQodmlldyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2aWV3LmJpbmQobmV3VmFsdWUsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdW5iaW5kKCkge1xyXG4gICAgICAgIGxldCB2aWV3ID0gdGhpcy52aWV3O1xyXG4gICAgICAgIHRoaXMucGFyZW50T3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcclxuICAgICAgICBpZiAodmlldykge1xyXG4gICAgICAgICAgICB2aWV3LnVuYmluZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuV2l0aCA9IF9fZGVjb3JhdGUoW1xyXG4gICAgY3VzdG9tQXR0cmlidXRlKCd3aXRoJyksXHJcbiAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICBpbmplY3QoQm91bmRWaWV3RmFjdG9yeSwgVmlld1Nsb3QpXHJcbl0sIFdpdGgpO1xuXG5jb25zdCBvbmVUaW1lID0gYmluZGluZ01vZGUub25lVGltZTtcclxuZnVuY3Rpb24gdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyh2aWV3cywgc3RhcnRJbmRleCkge1xyXG4gICAgbGV0IGxlbmd0aCA9IHZpZXdzLmxlbmd0aDtcclxuICAgIGlmIChzdGFydEluZGV4ID4gMCkge1xyXG4gICAgICAgIHN0YXJ0SW5kZXggPSBzdGFydEluZGV4IC0gMTtcclxuICAgIH1cclxuICAgIGZvciAoOyBzdGFydEluZGV4IDwgbGVuZ3RoOyArK3N0YXJ0SW5kZXgpIHtcclxuICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHQodmlld3Nbc3RhcnRJbmRleF0ub3ZlcnJpZGVDb250ZXh0LCBzdGFydEluZGV4LCBsZW5ndGgpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBkYXRhLCBpbmRleCwgbGVuZ3RoLCBrZXkpIHtcclxuICAgIGxldCBiaW5kaW5nQ29udGV4dCA9IHt9O1xyXG4gICAgbGV0IG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZU92ZXJyaWRlQ29udGV4dChiaW5kaW5nQ29udGV4dCwgcmVwZWF0LnNjb3BlLm92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICBpZiAodHlwZW9mIGtleSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICBiaW5kaW5nQ29udGV4dFtyZXBlYXQua2V5XSA9IGtleTtcclxuICAgICAgICBiaW5kaW5nQ29udGV4dFtyZXBlYXQudmFsdWVdID0gZGF0YTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGJpbmRpbmdDb250ZXh0W3JlcGVhdC5sb2NhbF0gPSBkYXRhO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0KG92ZXJyaWRlQ29udGV4dCwgaW5kZXgsIGxlbmd0aCk7XHJcbiAgICByZXR1cm4gb3ZlcnJpZGVDb250ZXh0O1xyXG59XHJcbmZ1bmN0aW9uIHVwZGF0ZU92ZXJyaWRlQ29udGV4dChvdmVycmlkZUNvbnRleHQsIGluZGV4LCBsZW5ndGgpIHtcclxuICAgIGxldCBmaXJzdCA9IChpbmRleCA9PT0gMCk7XHJcbiAgICBsZXQgbGFzdCA9IChpbmRleCA9PT0gbGVuZ3RoIC0gMSk7XHJcbiAgICBsZXQgZXZlbiA9IGluZGV4ICUgMiA9PT0gMDtcclxuICAgIG92ZXJyaWRlQ29udGV4dC4kaW5kZXggPSBpbmRleDtcclxuICAgIG92ZXJyaWRlQ29udGV4dC4kZmlyc3QgPSBmaXJzdDtcclxuICAgIG92ZXJyaWRlQ29udGV4dC4kbGFzdCA9IGxhc3Q7XHJcbiAgICBvdmVycmlkZUNvbnRleHQuJG1pZGRsZSA9ICEoZmlyc3QgfHwgbGFzdCk7XHJcbiAgICBvdmVycmlkZUNvbnRleHQuJG9kZCA9ICFldmVuO1xyXG4gICAgb3ZlcnJpZGVDb250ZXh0LiRldmVuID0gZXZlbjtcclxufVxyXG5mdW5jdGlvbiBnZXRJdGVtc1NvdXJjZUV4cHJlc3Npb24oaW5zdHJ1Y3Rpb24sIGF0dHJOYW1lKSB7XHJcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb24uYmVoYXZpb3JJbnN0cnVjdGlvbnNcclxuICAgICAgICAuZmlsdGVyKGJpID0+IGJpLm9yaWdpbmFsQXR0ck5hbWUgPT09IGF0dHJOYW1lKVswXVxyXG4gICAgICAgIC5hdHRyaWJ1dGVzXHJcbiAgICAgICAgLml0ZW1zXHJcbiAgICAgICAgLnNvdXJjZUV4cHJlc3Npb247XHJcbn1cclxuZnVuY3Rpb24gdW53cmFwRXhwcmVzc2lvbihleHByZXNzaW9uKSB7XHJcbiAgICBsZXQgdW53cmFwcGVkID0gZmFsc2U7XHJcbiAgICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEJpbmRpbmdCZWhhdmlvcikge1xyXG4gICAgICAgIGV4cHJlc3Npb24gPSBleHByZXNzaW9uLmV4cHJlc3Npb247XHJcbiAgICB9XHJcbiAgICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIFZhbHVlQ29udmVydGVyKSB7XHJcbiAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZXhwcmVzc2lvbjtcclxuICAgICAgICB1bndyYXBwZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVud3JhcHBlZCA/IGV4cHJlc3Npb24gOiBudWxsO1xyXG59XHJcbmZ1bmN0aW9uIGlzT25lVGltZShleHByZXNzaW9uKSB7XHJcbiAgICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEJpbmRpbmdCZWhhdmlvcikge1xyXG4gICAgICAgIGlmIChleHByZXNzaW9uLm5hbWUgPT09ICdvbmVUaW1lJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZXhwcmVzc2lvbjtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVPbmVUaW1lQmluZGluZyhiaW5kaW5nKSB7XHJcbiAgICBpZiAoYmluZGluZy5jYWxsICYmIGJpbmRpbmcubW9kZSA9PT0gb25lVGltZSkge1xyXG4gICAgICAgIGJpbmRpbmcuY2FsbChzb3VyY2VDb250ZXh0KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGJpbmRpbmcudXBkYXRlT25lVGltZUJpbmRpbmdzKSB7XHJcbiAgICAgICAgYmluZGluZy51cGRhdGVPbmVUaW1lQmluZGluZ3MoKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpbmRleE9mKGFycmF5LCBpdGVtLCBtYXRjaGVyLCBzdGFydEluZGV4KSB7XHJcbiAgICBpZiAoIW1hdGNoZXIpIHtcclxuICAgICAgICByZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcclxuICAgIGZvciAobGV0IGluZGV4ID0gc3RhcnRJbmRleCB8fCAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgIGlmIChtYXRjaGVyKGFycmF5W2luZGV4XSwgaXRlbSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiAtMTtcclxufVxuXG5jbGFzcyBBcnJheVJlcGVhdFN0cmF0ZWd5IHtcclxuICAgIGdldENvbGxlY3Rpb25PYnNlcnZlcihvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmVyTG9jYXRvci5nZXRBcnJheU9ic2VydmVyKGl0ZW1zKTtcclxuICAgIH1cclxuICAgIGluc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbXNMZW5ndGggPSBpdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgaWYgKCFpdGVtcyB8fCBpdGVtc0xlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gcmVwZWF0LnZpZXdzKCk7XHJcbiAgICAgICAgY29uc3Qgdmlld3NMZW5ndGggPSBjaGlsZHJlbi5sZW5ndGg7XHJcbiAgICAgICAgaWYgKHZpZXdzTGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0luc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSkge1xyXG4gICAgICAgICAgICBjb25zdCBjaGlsZHJlblNuYXBzaG90ID0gY2hpbGRyZW4uc2xpY2UoMCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1OYW1lSW5CaW5kaW5nQ29udGV4dCA9IHJlcGVhdC5sb2NhbDtcclxuICAgICAgICAgICAgY29uc3QgbWF0Y2hlciA9IHJlcGVhdC5tYXRjaGVyKCk7XHJcbiAgICAgICAgICAgIGxldCBpdGVtc1ByZXZpb3VzbHlJblZpZXdzID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXdzVG9SZW1vdmUgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHZpZXdzTGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gY2hpbGRyZW5TbmFwc2hvdFtpbmRleF07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvbGRJdGVtID0gdmlldy5iaW5kaW5nQ29udGV4dFtpdGVtTmFtZUluQmluZGluZ0NvbnRleHRdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4T2YoaXRlbXMsIG9sZEl0ZW0sIG1hdGNoZXIpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzVG9SZW1vdmUucHVzaCh2aWV3KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zUHJldmlvdXNseUluVmlld3MucHVzaChvbGRJdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgdXBkYXRlVmlld3M7XHJcbiAgICAgICAgICAgIGxldCByZW1vdmVQcm9taXNlO1xyXG4gICAgICAgICAgICBpZiAoaXRlbXNQcmV2aW91c2x5SW5WaWV3cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZVZpZXdzKHZpZXdzVG9SZW1vdmUsIHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVZpZXdzID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBpdGVtc0xlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gaXRlbXNbaW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleE9mVmlldyA9IGluZGV4T2YoaXRlbXNQcmV2aW91c2x5SW5WaWV3cywgaXRlbSwgbWF0Y2hlciwgaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmlldztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4T2ZWaWV3ID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIGl0ZW1zW2luZGV4XSwgaW5kZXgsIGl0ZW1zTGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KGluZGV4LCBvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtc1ByZXZpb3VzbHlJblZpZXdzLnNwbGljZShpbmRleCwgMCwgdW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpbmRleE9mVmlldyA9PT0gaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcgPSBjaGlsZHJlbltpbmRleE9mVmlld107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtc1ByZXZpb3VzbHlJblZpZXdzW2luZGV4T2ZWaWV3XSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcgPSBjaGlsZHJlbltpbmRleE9mVmlld107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQubW92ZVZpZXcoaW5kZXhPZlZpZXcsIGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zUHJldmlvdXNseUluVmlld3Muc3BsaWNlKGluZGV4T2ZWaWV3LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zUHJldmlvdXNseUluVmlld3Muc3BsaWNlKGluZGV4LCAwLCB1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHQodmlldy5vdmVycmlkZUNvbnRleHQsIGluZGV4LCBpdGVtc0xlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5QbGFjZVByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVZpZXdzID0gKCkgPT4gdGhpcy5fc3RhbmRhcmRQcm9jZXNzSW5zdGFuY2VDaGFuZ2VkKHJlcGVhdCwgaXRlbXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyZW1vdmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZS50aGVuKHVwZGF0ZVZpZXdzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVZpZXdzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luUGxhY2VQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX3N0YW5kYXJkUHJvY2Vzc0luc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gaXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIGl0ZW1zW2ldLCBpLCBpaSk7XHJcbiAgICAgICAgICAgIHJlcGVhdC5hZGRWaWV3KG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfaW5QbGFjZVByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgbGV0IGl0ZW1zTGVuZ3RoID0gaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgIGxldCB2aWV3c0xlbmd0aCA9IHJlcGVhdC52aWV3Q291bnQoKTtcclxuICAgICAgICB3aGlsZSAodmlld3NMZW5ndGggPiBpdGVtc0xlbmd0aCkge1xyXG4gICAgICAgICAgICB2aWV3c0xlbmd0aC0tO1xyXG4gICAgICAgICAgICByZXBlYXQucmVtb3ZlVmlldyh2aWV3c0xlbmd0aCwgdHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbG9jYWwgPSByZXBlYXQubG9jYWw7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2aWV3c0xlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCB2aWV3ID0gcmVwZWF0LnZpZXcoaSk7XHJcbiAgICAgICAgICAgIGxldCBsYXN0ID0gaSA9PT0gaXRlbXNMZW5ndGggLSAxO1xyXG4gICAgICAgICAgICBsZXQgbWlkZGxlID0gaSAhPT0gMCAmJiAhbGFzdDtcclxuICAgICAgICAgICAgbGV0IGJpbmRpbmdDb250ZXh0ID0gdmlldy5iaW5kaW5nQ29udGV4dDtcclxuICAgICAgICAgICAgbGV0IG92ZXJyaWRlQ29udGV4dCA9IHZpZXcub3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgICAgICBpZiAoYmluZGluZ0NvbnRleHRbbG9jYWxdID09PSBpdGVtc1tpXVxyXG4gICAgICAgICAgICAgICAgJiYgb3ZlcnJpZGVDb250ZXh0LiRtaWRkbGUgPT09IG1pZGRsZVxyXG4gICAgICAgICAgICAgICAgJiYgb3ZlcnJpZGVDb250ZXh0LiRsYXN0ID09PSBsYXN0KSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBiaW5kaW5nQ29udGV4dFtsb2NhbF0gPSBpdGVtc1tpXTtcclxuICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0LiRtaWRkbGUgPSBtaWRkbGU7XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dC4kbGFzdCA9IGxhc3Q7XHJcbiAgICAgICAgICAgIHJlcGVhdC51cGRhdGVCaW5kaW5ncyh2aWV3KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IHZpZXdzTGVuZ3RoOyBpIDwgaXRlbXNMZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIGl0ZW1zW2ldLCBpLCBpdGVtc0xlbmd0aCk7XHJcbiAgICAgICAgICAgIHJlcGVhdC5hZGRWaWV3KG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpbnN0YW5jZU11dGF0ZWQocmVwZWF0LCBhcnJheSwgc3BsaWNlcykge1xyXG4gICAgICAgIGlmIChyZXBlYXQuX19xdWV1ZWRTcGxpY2VzKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHNwbGljZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHsgaW5kZXgsIHJlbW92ZWQsIGFkZGVkQ291bnQgfSA9IHNwbGljZXNbaV07XHJcbiAgICAgICAgICAgICAgICBtZXJnZVNwbGljZShyZXBlYXQuX19xdWV1ZWRTcGxpY2VzLCBpbmRleCwgcmVtb3ZlZCwgYWRkZWRDb3VudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVwZWF0Ll9fYXJyYXkgPSBhcnJheS5zbGljZSgwKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbWF5YmVQcm9taXNlID0gdGhpcy5fcnVuU3BsaWNlcyhyZXBlYXQsIGFycmF5LnNsaWNlKDApLCBzcGxpY2VzKTtcclxuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICBsZXQgcXVldWVkU3BsaWNlcyA9IHJlcGVhdC5fX3F1ZXVlZFNwbGljZXMgPSBbXTtcclxuICAgICAgICAgICAgbGV0IHJ1blF1ZXVlZFNwbGljZXMgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXF1ZXVlZFNwbGljZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVwZWF0Ll9fcXVldWVkU3BsaWNlcyA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQuX19hcnJheSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgbmV4dFByb21pc2UgPSB0aGlzLl9ydW5TcGxpY2VzKHJlcGVhdCwgcmVwZWF0Ll9fYXJyYXksIHF1ZXVlZFNwbGljZXMpIHx8IFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgcXVldWVkU3BsaWNlcyA9IHJlcGVhdC5fX3F1ZXVlZFNwbGljZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIG5leHRQcm9taXNlLnRoZW4ocnVuUXVldWVkU3BsaWNlcyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG1heWJlUHJvbWlzZS50aGVuKHJ1blF1ZXVlZFNwbGljZXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9ydW5TcGxpY2VzKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpIHtcclxuICAgICAgICBsZXQgcmVtb3ZlRGVsdGEgPSAwO1xyXG4gICAgICAgIGxldCBybVByb21pc2VzID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gc3BsaWNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIGxldCBzcGxpY2UgPSBzcGxpY2VzW2ldO1xyXG4gICAgICAgICAgICBsZXQgcmVtb3ZlZCA9IHNwbGljZS5yZW1vdmVkO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMCwgamogPSByZW1vdmVkLmxlbmd0aDsgaiA8IGpqOyArK2opIHtcclxuICAgICAgICAgICAgICAgIGxldCB2aWV3T3JQcm9taXNlID0gcmVwZWF0LnJlbW92ZVZpZXcoc3BsaWNlLmluZGV4ICsgcmVtb3ZlRGVsdGEgKyBybVByb21pc2VzLmxlbmd0aCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmlld09yUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBybVByb21pc2VzLnB1c2godmlld09yUHJvbWlzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVtb3ZlRGVsdGEgLT0gc3BsaWNlLmFkZGVkQ291bnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChybVByb21pc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHJtUHJvbWlzZXMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwbGljZUluZGV4TG93ID0gdGhpcy5faGFuZGxlQWRkZWRTcGxpY2VzKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgc3BsaWNlSW5kZXhMb3cpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHNwbGljZUluZGV4TG93ID0gdGhpcy5faGFuZGxlQWRkZWRTcGxpY2VzKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpO1xyXG4gICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIHNwbGljZUluZGV4TG93KTtcclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgX2hhbmRsZUFkZGVkU3BsaWNlcyhyZXBlYXQsIGFycmF5LCBzcGxpY2VzKSB7XHJcbiAgICAgICAgbGV0IHNwbGljZUluZGV4O1xyXG4gICAgICAgIGxldCBzcGxpY2VJbmRleExvdztcclxuICAgICAgICBsZXQgYXJyYXlMZW5ndGggPSBhcnJheS5sZW5ndGg7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlpID0gc3BsaWNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIGxldCBzcGxpY2UgPSBzcGxpY2VzW2ldO1xyXG4gICAgICAgICAgICBsZXQgYWRkSW5kZXggPSBzcGxpY2VJbmRleCA9IHNwbGljZS5pbmRleDtcclxuICAgICAgICAgICAgbGV0IGVuZCA9IHNwbGljZS5pbmRleCArIHNwbGljZS5hZGRlZENvdW50O1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHNwbGljZUluZGV4TG93ID09PSAndW5kZWZpbmVkJyB8fCBzcGxpY2VJbmRleExvdyA9PT0gbnVsbCB8fCBzcGxpY2VJbmRleExvdyA+IHNwbGljZS5pbmRleCkge1xyXG4gICAgICAgICAgICAgICAgc3BsaWNlSW5kZXhMb3cgPSBzcGxpY2VJbmRleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKDsgYWRkSW5kZXggPCBlbmQ7ICsrYWRkSW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIGxldCBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgYXJyYXlbYWRkSW5kZXhdLCBhZGRJbmRleCwgYXJyYXlMZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgcmVwZWF0Lmluc2VydFZpZXcoYWRkSW5kZXgsIG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3BsaWNlSW5kZXhMb3c7XHJcbiAgICB9XHJcbn1cblxuY2xhc3MgTWFwUmVwZWF0U3RyYXRlZ3kge1xyXG4gICAgZ2V0Q29sbGVjdGlvbk9ic2VydmVyKG9ic2VydmVyTG9jYXRvciwgaXRlbXMpIHtcclxuICAgICAgICByZXR1cm4gb2JzZXJ2ZXJMb2NhdG9yLmdldE1hcE9ic2VydmVyKGl0ZW1zKTtcclxuICAgIH1cclxuICAgIGluc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgbGV0IHJlbW92ZVByb21pc2UgPSByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgIGlmIChyZW1vdmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICByZW1vdmVQcm9taXNlLnRoZW4oKCkgPT4gdGhpcy5fc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcykpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpO1xyXG4gICAgfVxyXG4gICAgX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpIHtcclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG4gICAgICAgIGxldCBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4ge1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgdmFsdWUsIGluZGV4LCBpdGVtcy5zaXplLCBrZXkpO1xyXG4gICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICsraW5kZXg7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpbnN0YW5jZU11dGF0ZWQocmVwZWF0LCBtYXAsIHJlY29yZHMpIHtcclxuICAgICAgICBsZXQga2V5O1xyXG4gICAgICAgIGxldCBpO1xyXG4gICAgICAgIGxldCBpaTtcclxuICAgICAgICBsZXQgb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIGxldCByZW1vdmVJbmRleDtcclxuICAgICAgICBsZXQgYWRkSW5kZXg7XHJcbiAgICAgICAgbGV0IHJlY29yZDtcclxuICAgICAgICBsZXQgcm1Qcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIGxldCB2aWV3T3JQcm9taXNlO1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIHJlY29yZCA9IHJlY29yZHNbaV07XHJcbiAgICAgICAgICAgIGtleSA9IHJlY29yZC5rZXk7XHJcbiAgICAgICAgICAgIHN3aXRjaCAocmVjb3JkLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlSW5kZXggPSB0aGlzLl9nZXRWaWV3SW5kZXhCeUtleShyZXBlYXQsIGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld09yUHJvbWlzZSA9IHJlcGVhdC5yZW1vdmVWaWV3KHJlbW92ZUluZGV4LCB0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdPclByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJtUHJvbWlzZXMucHVzaCh2aWV3T3JQcm9taXNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIG1hcC5nZXQoa2V5KSwgcmVtb3ZlSW5kZXgsIG1hcC5zaXplLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KHJlbW92ZUluZGV4LCBvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdhZGQnOlxyXG4gICAgICAgICAgICAgICAgICAgIGFkZEluZGV4ID0gcmVwZWF0LnZpZXdDb3VudCgpIDw9IG1hcC5zaXplIC0gMSA/IHJlcGVhdC52aWV3Q291bnQoKSA6IG1hcC5zaXplIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgbWFwLmdldChrZXkpLCBhZGRJbmRleCwgbWFwLnNpemUsIGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVwZWF0Lmluc2VydFZpZXcobWFwLnNpemUgLSAxLCBvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWNvcmQub2xkVmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUluZGV4ID0gdGhpcy5fZ2V0Vmlld0luZGV4QnlLZXkocmVwZWF0LCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdPclByb21pc2UgPSByZXBlYXQucmVtb3ZlVmlldyhyZW1vdmVJbmRleCwgdHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3T3JQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBybVByb21pc2VzLnB1c2godmlld09yUHJvbWlzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2xlYXInOlxyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChybVByb21pc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgUHJvbWlzZS5hbGwocm1Qcm9taXNlcykudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHRzKHJlcGVhdC52aWV3cygpLCAwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHRzKHJlcGVhdC52aWV3cygpLCAwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfZ2V0Vmlld0luZGV4QnlLZXkocmVwZWF0LCBrZXkpIHtcclxuICAgICAgICBsZXQgaTtcclxuICAgICAgICBsZXQgaWk7XHJcbiAgICAgICAgbGV0IGNoaWxkO1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gcmVwZWF0LnZpZXdDb3VudCgpOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBjaGlsZCA9IHJlcGVhdC52aWV3KGkpO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQuYmluZGluZ0NvbnRleHRbcmVwZWF0LmtleV0gPT09IGtleSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxufVxuXG5jbGFzcyBOdWxsUmVwZWF0U3RyYXRlZ3kge1xyXG4gICAgaW5zdGFuY2VDaGFuZ2VkKHJlcGVhdCwgaXRlbXMpIHtcclxuICAgICAgICByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSk7XHJcbiAgICB9XHJcbiAgICBnZXRDb2xsZWN0aW9uT2JzZXJ2ZXIob2JzZXJ2ZXJMb2NhdG9yLCBpdGVtcykge1xyXG4gICAgfVxyXG59XG5cbmNsYXNzIE51bWJlclJlcGVhdFN0cmF0ZWd5IHtcclxuICAgIGdldENvbGxlY3Rpb25PYnNlcnZlcigpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGluc3RhbmNlQ2hhbmdlZChyZXBlYXQsIHZhbHVlKSB7XHJcbiAgICAgICAgbGV0IHJlbW92ZVByb21pc2UgPSByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgIGlmIChyZW1vdmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICByZW1vdmVQcm9taXNlLnRoZW4oKCkgPT4gdGhpcy5fc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCB2YWx1ZSkpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgdmFsdWUpO1xyXG4gICAgfVxyXG4gICAgX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgdmFsdWUpIHtcclxuICAgICAgICBsZXQgY2hpbGRyZW5MZW5ndGggPSByZXBlYXQudmlld0NvdW50KCk7XHJcbiAgICAgICAgbGV0IGk7XHJcbiAgICAgICAgbGV0IGlpO1xyXG4gICAgICAgIGxldCBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICAgICAgbGV0IHZpZXdzVG9SZW1vdmU7XHJcbiAgICAgICAgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKTtcclxuICAgICAgICB2aWV3c1RvUmVtb3ZlID0gY2hpbGRyZW5MZW5ndGggLSB2YWx1ZTtcclxuICAgICAgICBpZiAodmlld3NUb1JlbW92ZSA+IDApIHtcclxuICAgICAgICAgICAgaWYgKHZpZXdzVG9SZW1vdmUgPiBjaGlsZHJlbkxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdmlld3NUb1JlbW92ZSA9IGNoaWxkcmVuTGVuZ3RoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gdmlld3NUb1JlbW92ZTsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHJlcGVhdC5yZW1vdmVWaWV3KGNoaWxkcmVuTGVuZ3RoIC0gKGkgKyAxKSwgdHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChpID0gY2hpbGRyZW5MZW5ndGgsIGlpID0gdmFsdWU7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBpLCBpLCBpaSk7XHJcbiAgICAgICAgICAgIHJlcGVhdC5hZGRWaWV3KG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgMCk7XHJcbiAgICB9XHJcbn1cblxuY2xhc3MgU2V0UmVwZWF0U3RyYXRlZ3kge1xyXG4gICAgZ2V0Q29sbGVjdGlvbk9ic2VydmVyKG9ic2VydmVyTG9jYXRvciwgaXRlbXMpIHtcclxuICAgICAgICByZXR1cm4gb2JzZXJ2ZXJMb2NhdG9yLmdldFNldE9ic2VydmVyKGl0ZW1zKTtcclxuICAgIH1cclxuICAgIGluc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgbGV0IHJlbW92ZVByb21pc2UgPSByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgIGlmIChyZW1vdmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICByZW1vdmVQcm9taXNlLnRoZW4oKCkgPT4gdGhpcy5fc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcykpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpO1xyXG4gICAgfVxyXG4gICAgX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpIHtcclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG4gICAgICAgIGxldCBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICAgICAgaXRlbXMuZm9yRWFjaCh2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCB2YWx1ZSwgaW5kZXgsIGl0ZW1zLnNpemUpO1xyXG4gICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICsraW5kZXg7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpbnN0YW5jZU11dGF0ZWQocmVwZWF0LCBzZXQsIHJlY29yZHMpIHtcclxuICAgICAgICBsZXQgdmFsdWU7XHJcbiAgICAgICAgbGV0IGk7XHJcbiAgICAgICAgbGV0IGlpO1xyXG4gICAgICAgIGxldCBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICAgICAgbGV0IHJlbW92ZUluZGV4O1xyXG4gICAgICAgIGxldCByZWNvcmQ7XHJcbiAgICAgICAgbGV0IHJtUHJvbWlzZXMgPSBbXTtcclxuICAgICAgICBsZXQgdmlld09yUHJvbWlzZTtcclxuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHJlY29yZHMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICByZWNvcmQgPSByZWNvcmRzW2ldO1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHJlY29yZC52YWx1ZTtcclxuICAgICAgICAgICAgc3dpdGNoIChyZWNvcmQudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkJzpcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc2l6ZSA9IE1hdGgubWF4KHNldC5zaXplIC0gMSwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIHZhbHVlLCBzaXplLCBzZXQuc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVwZWF0Lmluc2VydFZpZXcoc2l6ZSwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVJbmRleCA9IHRoaXMuX2dldFZpZXdJbmRleEJ5VmFsdWUocmVwZWF0LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld09yUHJvbWlzZSA9IHJlcGVhdC5yZW1vdmVWaWV3KHJlbW92ZUluZGV4LCB0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdPclByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJtUHJvbWlzZXMucHVzaCh2aWV3T3JQcm9taXNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjbGVhcic6XHJcbiAgICAgICAgICAgICAgICAgICAgcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJtUHJvbWlzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBQcm9taXNlLmFsbChybVByb21pc2VzKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIDApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9nZXRWaWV3SW5kZXhCeVZhbHVlKHJlcGVhdCwgdmFsdWUpIHtcclxuICAgICAgICBsZXQgaTtcclxuICAgICAgICBsZXQgaWk7XHJcbiAgICAgICAgbGV0IGNoaWxkO1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gcmVwZWF0LnZpZXdDb3VudCgpOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBjaGlsZCA9IHJlcGVhdC52aWV3KGkpO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQuYmluZGluZ0NvbnRleHRbcmVwZWF0LmxvY2FsXSA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbn1cblxuY2xhc3MgUmVwZWF0U3RyYXRlZ3lMb2NhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMubWF0Y2hlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnN0cmF0ZWdpZXMgPSBbXTtcclxuICAgICAgICB0aGlzLmFkZFN0cmF0ZWd5KGl0ZW1zID0+IGl0ZW1zID09PSBudWxsIHx8IGl0ZW1zID09PSB1bmRlZmluZWQsIG5ldyBOdWxsUmVwZWF0U3RyYXRlZ3koKSk7XHJcbiAgICAgICAgdGhpcy5hZGRTdHJhdGVneShpdGVtcyA9PiBpdGVtcyBpbnN0YW5jZW9mIEFycmF5LCBuZXcgQXJyYXlSZXBlYXRTdHJhdGVneSgpKTtcclxuICAgICAgICB0aGlzLmFkZFN0cmF0ZWd5KGl0ZW1zID0+IGl0ZW1zIGluc3RhbmNlb2YgTWFwLCBuZXcgTWFwUmVwZWF0U3RyYXRlZ3koKSk7XHJcbiAgICAgICAgdGhpcy5hZGRTdHJhdGVneShpdGVtcyA9PiBpdGVtcyBpbnN0YW5jZW9mIFNldCwgbmV3IFNldFJlcGVhdFN0cmF0ZWd5KCkpO1xyXG4gICAgICAgIHRoaXMuYWRkU3RyYXRlZ3koaXRlbXMgPT4gdHlwZW9mIGl0ZW1zID09PSAnbnVtYmVyJywgbmV3IE51bWJlclJlcGVhdFN0cmF0ZWd5KCkpO1xyXG4gICAgfVxyXG4gICAgYWRkU3RyYXRlZ3kobWF0Y2hlciwgc3RyYXRlZ3kpIHtcclxuICAgICAgICB0aGlzLm1hdGNoZXJzLnB1c2gobWF0Y2hlcik7XHJcbiAgICAgICAgdGhpcy5zdHJhdGVnaWVzLnB1c2goc3RyYXRlZ3kpO1xyXG4gICAgfVxyXG4gICAgZ2V0U3RyYXRlZ3koaXRlbXMpIHtcclxuICAgICAgICBsZXQgbWF0Y2hlcnMgPSB0aGlzLm1hdGNoZXJzO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IG1hdGNoZXJzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKG1hdGNoZXJzW2ldKGl0ZW1zKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RyYXRlZ2llc1tpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxuXG5jb25zdCBsaWZlY3ljbGVPcHRpb25hbEJlaGF2aW9ycyA9IFsnZm9jdXMnLCAnaWYnLCAnZWxzZScsICdyZXBlYXQnLCAnc2hvdycsICdoaWRlJywgJ3dpdGgnXTtcclxuZnVuY3Rpb24gYmVoYXZpb3JSZXF1aXJlc0xpZmVjeWNsZShpbnN0cnVjdGlvbikge1xyXG4gICAgbGV0IHQgPSBpbnN0cnVjdGlvbi50eXBlO1xyXG4gICAgbGV0IG5hbWUgPSB0LmVsZW1lbnROYW1lICE9PSBudWxsID8gdC5lbGVtZW50TmFtZSA6IHQuYXR0cmlidXRlTmFtZTtcclxuICAgIHJldHVybiBsaWZlY3ljbGVPcHRpb25hbEJlaGF2aW9ycy5pbmRleE9mKG5hbWUpID09PSAtMSAmJiAodC5oYW5kbGVzQXR0YWNoZWQgfHwgdC5oYW5kbGVzQmluZCB8fCB0LmhhbmRsZXNDcmVhdGVkIHx8IHQuaGFuZGxlc0RldGFjaGVkIHx8IHQuaGFuZGxlc1VuYmluZClcclxuICAgICAgICB8fCB0LnZpZXdGYWN0b3J5ICYmIHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh0LnZpZXdGYWN0b3J5KVxyXG4gICAgICAgIHx8IGluc3RydWN0aW9uLnZpZXdGYWN0b3J5ICYmIHZpZXdzUmVxdWlyZUxpZmVjeWNsZShpbnN0cnVjdGlvbi52aWV3RmFjdG9yeSk7XHJcbn1cclxuZnVuY3Rpb24gdGFyZ2V0UmVxdWlyZXNMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24pIHtcclxuICAgIGxldCBiZWhhdmlvcnMgPSBpbnN0cnVjdGlvbi5iZWhhdmlvckluc3RydWN0aW9ucztcclxuICAgIGlmIChiZWhhdmlvcnMpIHtcclxuICAgICAgICBsZXQgaSA9IGJlaGF2aW9ycy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgICAgICBpZiAoYmVoYXZpb3JSZXF1aXJlc0xpZmVjeWNsZShiZWhhdmlvcnNbaV0pKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBpbnN0cnVjdGlvbi52aWV3RmFjdG9yeSAmJiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkpO1xyXG59XHJcbmZ1bmN0aW9uIHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh2aWV3RmFjdG9yeSkge1xyXG4gICAgaWYgKCdfdmlld3NSZXF1aXJlTGlmZWN5Y2xlJyBpbiB2aWV3RmFjdG9yeSkge1xyXG4gICAgICAgIHJldHVybiB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlO1xyXG4gICAgfVxyXG4gICAgdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IGZhbHNlO1xyXG4gICAgaWYgKHZpZXdGYWN0b3J5LnZpZXdGYWN0b3J5KSB7XHJcbiAgICAgICAgdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh2aWV3RmFjdG9yeS52aWV3RmFjdG9yeSk7XHJcbiAgICAgICAgcmV0dXJuIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGU7XHJcbiAgICB9XHJcbiAgICBpZiAodmlld0ZhY3RvcnkudGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmF1LWFuaW1hdGUnKSkge1xyXG4gICAgICAgIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgaWQgaW4gdmlld0ZhY3RvcnkuaW5zdHJ1Y3Rpb25zKSB7XHJcbiAgICAgICAgaWYgKHRhcmdldFJlcXVpcmVzTGlmZWN5Y2xlKHZpZXdGYWN0b3J5Lmluc3RydWN0aW9uc1tpZF0pKSB7XHJcbiAgICAgICAgICAgIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gZmFsc2U7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cblxuY2xhc3MgQWJzdHJhY3RSZXBlYXRlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCB7XHJcbiAgICAgICAgICAgIGxvY2FsOiAnaXRlbXMnLFxyXG4gICAgICAgICAgICB2aWV3c1JlcXVpcmVMaWZlY3ljbGU6IHRydWVcclxuICAgICAgICB9LCBvcHRpb25zKTtcclxuICAgIH1cclxuICAgIHZpZXdDb3VudCgpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGB2aWV3Q291bnRgJyk7XHJcbiAgICB9XHJcbiAgICB2aWV3cygpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGB2aWV3c2AnKTtcclxuICAgIH1cclxuICAgIHZpZXcoaW5kZXgpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGB2aWV3YCcpO1xyXG4gICAgfVxyXG4gICAgbWF0Y2hlcigpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGBtYXRjaGVyYCcpO1xyXG4gICAgfVxyXG4gICAgYWRkVmlldyhiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgYWRkVmlld2AnKTtcclxuICAgIH1cclxuICAgIGluc2VydFZpZXcoaW5kZXgsIGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGBpbnNlcnRWaWV3YCcpO1xyXG4gICAgfVxyXG4gICAgbW92ZVZpZXcoc291cmNlSW5kZXgsIHRhcmdldEluZGV4KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgbW92ZVZpZXdgJyk7XHJcbiAgICB9XHJcbiAgICByZW1vdmVBbGxWaWV3cyhyZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgcmVtb3ZlQWxsVmlld3NgJyk7XHJcbiAgICB9XHJcbiAgICByZW1vdmVWaWV3cyh2aWV3c1RvUmVtb3ZlLCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgcmVtb3ZlVmlld2AnKTtcclxuICAgIH1cclxuICAgIHJlbW92ZVZpZXcoaW5kZXgsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGByZW1vdmVWaWV3YCcpO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlQmluZGluZ3Modmlldykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHVwZGF0ZUJpbmRpbmdzYCcpO1xyXG4gICAgfVxyXG59XG5cbmxldCBSZXBlYXQgPSBjbGFzcyBSZXBlYXQgZXh0ZW5kcyBBYnN0cmFjdFJlcGVhdGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKHZpZXdGYWN0b3J5LCBpbnN0cnVjdGlvbiwgdmlld1Nsb3QsIHZpZXdSZXNvdXJjZXMsIG9ic2VydmVyTG9jYXRvciwgc3RyYXRlZ3lMb2NhdG9yKSB7XHJcbiAgICAgICAgc3VwZXIoe1xyXG4gICAgICAgICAgICBsb2NhbDogJ2l0ZW0nLFxyXG4gICAgICAgICAgICB2aWV3c1JlcXVpcmVMaWZlY3ljbGU6IHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh2aWV3RmFjdG9yeSlcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnZpZXdGYWN0b3J5ID0gdmlld0ZhY3Rvcnk7XHJcbiAgICAgICAgdGhpcy5pbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uO1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QgPSB2aWV3U2xvdDtcclxuICAgICAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IHZpZXdSZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xyXG4gICAgICAgIHRoaXMua2V5ID0gJ2tleSc7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9ICd2YWx1ZSc7XHJcbiAgICAgICAgdGhpcy5zdHJhdGVneUxvY2F0b3IgPSBzdHJhdGVneUxvY2F0b3I7XHJcbiAgICAgICAgdGhpcy5pZ25vcmVNdXRhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IGdldEl0ZW1zU291cmNlRXhwcmVzc2lvbih0aGlzLmluc3RydWN0aW9uLCAncmVwZWF0LmZvcicpO1xyXG4gICAgICAgIHRoaXMuaXNPbmVUaW1lID0gaXNPbmVUaW1lKHRoaXMuc291cmNlRXhwcmVzc2lvbik7XHJcbiAgICAgICAgdGhpcy52aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodmlld0ZhY3RvcnkpO1xyXG4gICAgfVxyXG4gICAgY2FsbChjb250ZXh0LCBjaGFuZ2VzKSB7XHJcbiAgICAgICAgdGhpc1tjb250ZXh0XSh0aGlzLml0ZW1zLCBjaGFuZ2VzKTtcclxuICAgIH1cclxuICAgIGJpbmQoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIHRoaXMuc2NvcGUgPSB7IGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQgfTtcclxuICAgICAgICB0aGlzLm1hdGNoZXJCaW5kaW5nID0gdGhpcy5fY2FwdHVyZUFuZFJlbW92ZU1hdGNoZXJCaW5kaW5nKCk7XHJcbiAgICAgICAgdGhpcy5pdGVtc0NoYW5nZWQoKTtcclxuICAgIH1cclxuICAgIHVuYmluZCgpIHtcclxuICAgICAgICB0aGlzLnNjb3BlID0gbnVsbDtcclxuICAgICAgICB0aGlzLml0ZW1zID0gbnVsbDtcclxuICAgICAgICB0aGlzLm1hdGNoZXJCaW5kaW5nID0gbnVsbDtcclxuICAgICAgICB0aGlzLnZpZXdTbG90LnJlbW92ZUFsbCh0cnVlLCB0cnVlKTtcclxuICAgICAgICB0aGlzLl91bnN1YnNjcmliZUNvbGxlY3Rpb24oKTtcclxuICAgIH1cclxuICAgIF91bnN1YnNjcmliZUNvbGxlY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbk9ic2VydmVyLnVuc3Vic2NyaWJlKHRoaXMuY2FsbENvbnRleHQsIHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlciA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbENvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGl0ZW1zQ2hhbmdlZCgpIHtcclxuICAgICAgICB0aGlzLl91bnN1YnNjcmliZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICBpZiAoIXRoaXMuc2NvcGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaXRlbXMgPSB0aGlzLml0ZW1zO1xyXG4gICAgICAgIHRoaXMuc3RyYXRlZ3kgPSB0aGlzLnN0cmF0ZWd5TG9jYXRvci5nZXRTdHJhdGVneShpdGVtcyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnN0cmF0ZWd5KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVmFsdWUgZm9yICcke3RoaXMuc291cmNlRXhwcmVzc2lvbn0nIGlzIG5vbi1yZXBlYXRhYmxlYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5pc09uZVRpbWUgJiYgIXRoaXMuX29ic2VydmVJbm5lckNvbGxlY3Rpb24oKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9vYnNlcnZlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlnbm9yZU11dGF0aW9uID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnN0cmF0ZWd5Lmluc3RhbmNlQ2hhbmdlZCh0aGlzLCBpdGVtcyk7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pZ25vcmVNdXRhdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgX2dldElubmVyQ29sbGVjdGlvbigpIHtcclxuICAgICAgICBsZXQgZXhwcmVzc2lvbiA9IHVud3JhcEV4cHJlc3Npb24odGhpcy5zb3VyY2VFeHByZXNzaW9uKTtcclxuICAgICAgICBpZiAoIWV4cHJlc3Npb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBleHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc2NvcGUsIG51bGwpO1xyXG4gICAgfVxyXG4gICAgaGFuZGxlQ29sbGVjdGlvbk11dGF0ZWQoY29sbGVjdGlvbiwgY2hhbmdlcykge1xyXG4gICAgICAgIGlmICghdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5pZ25vcmVNdXRhdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc3RyYXRlZ3kuaW5zdGFuY2VNdXRhdGVkKHRoaXMsIGNvbGxlY3Rpb24sIGNoYW5nZXMpO1xyXG4gICAgfVxyXG4gICAgaGFuZGxlSW5uZXJDb2xsZWN0aW9uTXV0YXRlZChjb2xsZWN0aW9uLCBjaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25PYnNlcnZlcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmlnbm9yZU11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pZ25vcmVNdXRhdGlvbiA9IHRydWU7XHJcbiAgICAgICAgbGV0IG5ld0l0ZW1zID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc2NvcGUsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcclxuICAgICAgICB0aGlzLm9ic2VydmVyTG9jYXRvci50YXNrUXVldWUucXVldWVNaWNyb1Rhc2soKCkgPT4gdGhpcy5pZ25vcmVNdXRhdGlvbiA9IGZhbHNlKTtcclxuICAgICAgICBpZiAobmV3SXRlbXMgPT09IHRoaXMuaXRlbXMpIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtc0NoYW5nZWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBuZXdJdGVtcztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfb2JzZXJ2ZUlubmVyQ29sbGVjdGlvbigpIHtcclxuICAgICAgICBsZXQgaXRlbXMgPSB0aGlzLl9nZXRJbm5lckNvbGxlY3Rpb24oKTtcclxuICAgICAgICBsZXQgc3RyYXRlZ3kgPSB0aGlzLnN0cmF0ZWd5TG9jYXRvci5nZXRTdHJhdGVneShpdGVtcyk7XHJcbiAgICAgICAgaWYgKCFzdHJhdGVneSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29sbGVjdGlvbk9ic2VydmVyID0gc3RyYXRlZ3kuZ2V0Q29sbGVjdGlvbk9ic2VydmVyKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBpdGVtcyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25PYnNlcnZlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2FsbENvbnRleHQgPSAnaGFuZGxlSW5uZXJDb2xsZWN0aW9uTXV0YXRlZCc7XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIuc3Vic2NyaWJlKHRoaXMuY2FsbENvbnRleHQsIHRoaXMpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgX29ic2VydmVDb2xsZWN0aW9uKCkge1xyXG4gICAgICAgIGxldCBpdGVtcyA9IHRoaXMuaXRlbXM7XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIgPSB0aGlzLnN0cmF0ZWd5LmdldENvbGxlY3Rpb25PYnNlcnZlcih0aGlzLm9ic2VydmVyTG9jYXRvciwgaXRlbXMpO1xyXG4gICAgICAgIGlmICh0aGlzLmNvbGxlY3Rpb25PYnNlcnZlcikge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxDb250ZXh0ID0gJ2hhbmRsZUNvbGxlY3Rpb25NdXRhdGVkJztcclxuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIuc3Vic2NyaWJlKHRoaXMuY2FsbENvbnRleHQsIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9jYXB0dXJlQW5kUmVtb3ZlTWF0Y2hlckJpbmRpbmcoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudmlld0ZhY3Rvcnkudmlld0ZhY3RvcnkpIHtcclxuICAgICAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25zID0gdGhpcy52aWV3RmFjdG9yeS52aWV3RmFjdG9yeS5pbnN0cnVjdGlvbnM7XHJcbiAgICAgICAgICAgIGNvbnN0IGluc3RydWN0aW9uSWRzID0gT2JqZWN0LmtleXMoaW5zdHJ1Y3Rpb25zKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnN0cnVjdGlvbklkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZXhwcmVzc2lvbnMgPSBpbnN0cnVjdGlvbnNbaW5zdHJ1Y3Rpb25JZHNbaV1dLmV4cHJlc3Npb25zO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4cHJlc3Npb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaWkgPSAwOyBpaSA8IGV4cHJlc3Npb25zLmxlbmd0aDsgaWkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhwcmVzc2lvbnNbaWldLnRhcmdldFByb3BlcnR5ID09PSAnbWF0Y2hlcicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoZXJCaW5kaW5nID0gZXhwcmVzc2lvbnNbaWldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbnMuc3BsaWNlKGlpLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaGVyQmluZGluZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgdmlld0NvdW50KCkgeyByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbi5sZW5ndGg7IH1cclxuICAgIHZpZXdzKCkgeyByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbjsgfVxyXG4gICAgdmlldyhpbmRleCkgeyByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbltpbmRleF07IH1cclxuICAgIG1hdGNoZXIoKSB7IHJldHVybiB0aGlzLm1hdGNoZXJCaW5kaW5nID8gdGhpcy5tYXRjaGVyQmluZGluZy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc2NvcGUsIHRoaXMubWF0Y2hlckJpbmRpbmcubG9va3VwRnVuY3Rpb25zKSA6IG51bGw7IH1cclxuICAgIGFkZFZpZXcoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIGxldCB2aWV3ID0gdGhpcy52aWV3RmFjdG9yeS5jcmVhdGUoKTtcclxuICAgICAgICB2aWV3LmJpbmQoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgdGhpcy52aWV3U2xvdC5hZGQodmlldyk7XHJcbiAgICB9XHJcbiAgICBpbnNlcnRWaWV3KGluZGV4LCBiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgbGV0IHZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xyXG4gICAgICAgIHZpZXcuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90Lmluc2VydChpbmRleCwgdmlldyk7XHJcbiAgICB9XHJcbiAgICBtb3ZlVmlldyhzb3VyY2VJbmRleCwgdGFyZ2V0SW5kZXgpIHtcclxuICAgICAgICB0aGlzLnZpZXdTbG90Lm1vdmUoc291cmNlSW5kZXgsIHRhcmdldEluZGV4KTtcclxuICAgIH1cclxuICAgIHJlbW92ZUFsbFZpZXdzKHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3U2xvdC5yZW1vdmVBbGwocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbik7XHJcbiAgICB9XHJcbiAgICByZW1vdmVWaWV3cyh2aWV3c1RvUmVtb3ZlLCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld1Nsb3QucmVtb3ZlTWFueSh2aWV3c1RvUmVtb3ZlLCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKTtcclxuICAgIH1cclxuICAgIHJlbW92ZVZpZXcoaW5kZXgsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3U2xvdC5yZW1vdmVBdChpbmRleCwgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbik7XHJcbiAgICB9XHJcbiAgICB1cGRhdGVCaW5kaW5ncyh2aWV3KSB7XHJcbiAgICAgICAgY29uc3QgJHZpZXcgPSB2aWV3O1xyXG4gICAgICAgIGxldCBqID0gJHZpZXcuYmluZGluZ3MubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgdXBkYXRlT25lVGltZUJpbmRpbmcoJHZpZXcuYmluZGluZ3Nbal0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBqID0gJHZpZXcuY29udHJvbGxlcnMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgbGV0IGsgPSAkdmlldy5jb250cm9sbGVyc1tqXS5ib3VuZFByb3BlcnRpZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZSAoay0tKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYmluZGluZyA9ICR2aWV3LmNvbnRyb2xsZXJzW2pdLmJvdW5kUHJvcGVydGllc1trXS5iaW5kaW5nO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT25lVGltZUJpbmRpbmcoYmluZGluZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGFibGVcclxuXSwgUmVwZWF0LnByb3RvdHlwZSwgXCJpdGVtc1wiLCB2b2lkIDApO1xyXG5fX2RlY29yYXRlKFtcclxuICAgIGJpbmRhYmxlXHJcbl0sIFJlcGVhdC5wcm90b3R5cGUsIFwibG9jYWxcIiwgdm9pZCAwKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICBiaW5kYWJsZVxyXG5dLCBSZXBlYXQucHJvdG90eXBlLCBcImtleVwiLCB2b2lkIDApO1xyXG5fX2RlY29yYXRlKFtcclxuICAgIGJpbmRhYmxlXHJcbl0sIFJlcGVhdC5wcm90b3R5cGUsIFwidmFsdWVcIiwgdm9pZCAwKTtcclxuUmVwZWF0ID0gX19kZWNvcmF0ZShbXHJcbiAgICBjdXN0b21BdHRyaWJ1dGUoJ3JlcGVhdCcpLFxyXG4gICAgdGVtcGxhdGVDb250cm9sbGVyLFxyXG4gICAgaW5qZWN0KEJvdW5kVmlld0ZhY3RvcnksIFRhcmdldEluc3RydWN0aW9uLCBWaWV3U2xvdCwgVmlld1Jlc291cmNlcywgT2JzZXJ2ZXJMb2NhdG9yLCBSZXBlYXRTdHJhdGVneUxvY2F0b3IpXHJcbl0sIFJlcGVhdCk7XG5cbmNvbnN0IGF1cmVsaWFIaWRlQ2xhc3NOYW1lID0gJ2F1cmVsaWEtaGlkZSc7XHJcbmNvbnN0IGF1cmVsaWFIaWRlQ2xhc3MgPSBgLiR7YXVyZWxpYUhpZGVDbGFzc05hbWV9IHsgZGlzcGxheTpub25lICFpbXBvcnRhbnQ7IH1gO1xyXG5mdW5jdGlvbiBpbmplY3RBdXJlbGlhSGlkZVN0eWxlQXRIZWFkKCkge1xyXG4gICAgRE9NLmluamVjdFN0eWxlcyhhdXJlbGlhSGlkZUNsYXNzKTtcclxufVxyXG5mdW5jdGlvbiBpbmplY3RBdXJlbGlhSGlkZVN0eWxlQXRCb3VuZGFyeShkb21Cb3VuZGFyeSkge1xyXG4gICAgaWYgKEZFQVRVUkUuc2hhZG93RE9NICYmIGRvbUJvdW5kYXJ5ICYmICFkb21Cb3VuZGFyeS5oYXNBdXJlbGlhSGlkZVN0eWxlKSB7XHJcbiAgICAgICAgZG9tQm91bmRhcnkuaGFzQXVyZWxpYUhpZGVTdHlsZSA9IHRydWU7XHJcbiAgICAgICAgRE9NLmluamVjdFN0eWxlcyhhdXJlbGlhSGlkZUNsYXNzLCBkb21Cb3VuZGFyeSk7XHJcbiAgICB9XHJcbn1cblxubGV0IFNob3cgPSBjbGFzcyBTaG93IHtcclxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGFuaW1hdG9yLCBkb21Cb3VuZGFyeSkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5hbmltYXRvciA9IGFuaW1hdG9yO1xyXG4gICAgICAgIHRoaXMuZG9tQm91bmRhcnkgPSBkb21Cb3VuZGFyeTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBpbmplY3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtET00uRWxlbWVudCwgQW5pbWF0b3IsIE9wdGlvbmFsLm9mKERPTS5ib3VuZGFyeSwgdHJ1ZSldO1xyXG4gICAgfVxyXG4gICAgY3JlYXRlZCgpIHtcclxuICAgICAgICBpbmplY3RBdXJlbGlhSGlkZVN0eWxlQXRCb3VuZGFyeSh0aGlzLmRvbUJvdW5kYXJ5KTtcclxuICAgIH1cclxuICAgIHZhbHVlQ2hhbmdlZChuZXdWYWx1ZSkge1xyXG4gICAgICAgIGxldCBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xyXG4gICAgICAgIGxldCBhbmltYXRvciA9IHRoaXMuYW5pbWF0b3I7XHJcbiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgICAgIGFuaW1hdG9yLnJlbW92ZUNsYXNzKGVsZW1lbnQsIGF1cmVsaWFIaWRlQ2xhc3NOYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGFuaW1hdG9yLmFkZENsYXNzKGVsZW1lbnQsIGF1cmVsaWFIaWRlQ2xhc3NOYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBiaW5kKGJpbmRpbmdDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZWQodGhpcy52YWx1ZSk7XHJcbiAgICB9XHJcbn07XHJcblNob3cgPSBfX2RlY29yYXRlKFtcclxuICAgIGN1c3RvbUF0dHJpYnV0ZSgnc2hvdycpXHJcbl0sIFNob3cpO1xuXG5sZXQgSGlkZSA9IGNsYXNzIEhpZGUge1xyXG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgYW5pbWF0b3IsIGRvbUJvdW5kYXJ5KSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmFuaW1hdG9yID0gYW5pbWF0b3I7XHJcbiAgICAgICAgdGhpcy5kb21Cb3VuZGFyeSA9IGRvbUJvdW5kYXJ5O1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGluamVjdCgpIHtcclxuICAgICAgICByZXR1cm4gW0RPTS5FbGVtZW50LCBBbmltYXRvciwgT3B0aW9uYWwub2YoRE9NLmJvdW5kYXJ5LCB0cnVlKV07XHJcbiAgICB9XHJcbiAgICBjcmVhdGVkKCkge1xyXG4gICAgICAgIGluamVjdEF1cmVsaWFIaWRlU3R5bGVBdEJvdW5kYXJ5KHRoaXMuZG9tQm91bmRhcnkpO1xyXG4gICAgfVxyXG4gICAgdmFsdWVDaGFuZ2VkKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0b3IuYWRkQ2xhc3ModGhpcy5lbGVtZW50LCBhdXJlbGlhSGlkZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmFuaW1hdG9yLnJlbW92ZUNsYXNzKHRoaXMuZWxlbWVudCwgYXVyZWxpYUhpZGVDbGFzc05hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGJpbmQoYmluZGluZ0NvbnRleHQpIHtcclxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlZCh0aGlzLnZhbHVlKTtcclxuICAgIH1cclxuICAgIHZhbHVlKHZhbHVlKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNZXRob2Qgbm90IGltcGxlbWVudGVkLicpO1xyXG4gICAgfVxyXG59O1xyXG5IaWRlID0gX19kZWNvcmF0ZShbXHJcbiAgICBjdXN0b21BdHRyaWJ1dGUoJ2hpZGUnKVxyXG5dLCBIaWRlKTtcblxuY29uc3QgU0NSSVBUX1JFR0VYID0gLzxzY3JpcHRcXGJbXjxdKig/Oig/ITxcXC9zY3JpcHQ+KTxbXjxdKikqPFxcL3NjcmlwdD4vZ2k7XHJcbmxldCBuZWVkc1RvV2FybiA9IHRydWU7XHJcbmNsYXNzIEhUTUxTYW5pdGl6ZXIge1xyXG4gICAgc2FuaXRpemUoaW5wdXQpIHtcclxuICAgICAgICBpZiAobmVlZHNUb1dhcm4pIHtcclxuICAgICAgICAgICAgbmVlZHNUb1dhcm4gPSBmYWxzZTtcclxuICAgICAgICAgICAgZ2V0TG9nZ2VyKCdodG1sLXNhbml0aXplcicpXHJcbiAgICAgICAgICAgICAgICAud2FybihgQ0FVVElPTjogVGhlIGRlZmF1bHQgSFRNTFNhbml0aXplciBkb2VzIE5PVCBwcm92aWRlIHNlY3VyaXR5IGFnYWluc3QgYSB3aWRlIHZhcmlldHkgb2Ygc29waGlzdGljYXRlZCBYU1MgYXR0YWNrcyxcbmFuZCBzaG91bGQgbm90IGJlIHJlbGllZCBvbiBmb3Igc2FuaXRpemluZyBpbnB1dCBmcm9tIHVua25vd24gc291cmNlcy5cblBsZWFzZSBzZWUgaHR0cHM6Ly9hdXJlbGlhLmlvL2RvY3MvYmluZGluZy9iYXNpY3MjZWxlbWVudC1jb250ZW50IGZvciBpbnN0cnVjdGlvbnMgb24gaG93IHRvIHVzZSBhIHNlY3VyZSBzb2x1dGlvbiBsaWtlIERPTVB1cmlmeSBvciBzYW5pdGl6ZS1odG1sLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5wdXQucmVwbGFjZShTQ1JJUFRfUkVHRVgsICcnKTtcclxuICAgIH1cclxufVxuXG5sZXQgU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIgPSBjbGFzcyBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzYW5pdGl6ZXIpIHtcclxuICAgICAgICB0aGlzLnNhbml0aXplciA9IHNhbml0aXplcjtcclxuICAgIH1cclxuICAgIHRvVmlldyh1bnRydXN0ZWRNYXJrdXApIHtcclxuICAgICAgICBpZiAodW50cnVzdGVkTWFya3VwID09PSBudWxsIHx8IHVudHJ1c3RlZE1hcmt1cCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5zYW5pdGl6ZXIuc2FuaXRpemUodW50cnVzdGVkTWFya3VwKTtcclxuICAgIH1cclxufTtcclxuU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIgPSBfX2RlY29yYXRlKFtcclxuICAgIHZhbHVlQ29udmVydGVyKCdzYW5pdGl6ZUhUTUwnKSxcclxuICAgIGluamVjdChIVE1MU2FuaXRpemVyKVxyXG5dLCBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlcik7XG5cbmxldCBSZXBsYWNlYWJsZSA9IGNsYXNzIFJlcGxhY2VhYmxlIHtcclxuICAgIGNvbnN0cnVjdG9yKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy52aWV3ID0gbnVsbDtcclxuICAgIH1cclxuICAgIGJpbmQoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIGlmICh0aGlzLnZpZXcgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy52aWV3ID0gdGhpcy52aWV3RmFjdG9yeS5jcmVhdGUoKTtcclxuICAgICAgICAgICAgdGhpcy52aWV3U2xvdC5hZGQodGhpcy52aWV3KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy52aWV3LmJpbmQoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICB9XHJcbiAgICB1bmJpbmQoKSB7XHJcbiAgICAgICAgdGhpcy52aWV3LnVuYmluZCgpO1xyXG4gICAgfVxyXG59O1xyXG5SZXBsYWNlYWJsZSA9IF9fZGVjb3JhdGUoW1xyXG4gICAgY3VzdG9tQXR0cmlidXRlKCdyZXBsYWNlYWJsZScpLFxyXG4gICAgdGVtcGxhdGVDb250cm9sbGVyLFxyXG4gICAgaW5qZWN0KEJvdW5kVmlld0ZhY3RvcnksIFZpZXdTbG90KVxyXG5dLCBSZXBsYWNlYWJsZSk7XG5cbmxldCBGb2N1cyA9IGNsYXNzIEZvY3VzIHtcclxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIHRhc2tRdWV1ZSkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy50YXNrUXVldWUgPSB0YXNrUXVldWU7XHJcbiAgICAgICAgdGhpcy5pc0F0dGFjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5uZWVkc0FwcGx5ID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgaW5qZWN0KCkge1xyXG4gICAgICAgIHJldHVybiBbRE9NLkVsZW1lbnQsIFRhc2tRdWV1ZV07XHJcbiAgICB9XHJcbiAgICB2YWx1ZUNoYW5nZWQobmV3VmFsdWUpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2FwcGx5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm5lZWRzQXBwbHkgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9hcHBseSgpIHtcclxuICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5ibHVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgYXR0YWNoZWQoKSB7XHJcbiAgICAgICAgdGhpcy5pc0F0dGFjaGVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5uZWVkc0FwcGx5KSB7XHJcbiAgICAgICAgICAgIHRoaXMubmVlZHNBcHBseSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9hcHBseSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMpO1xyXG4gICAgfVxyXG4gICAgZGV0YWNoZWQoKSB7XHJcbiAgICAgICAgdGhpcy5pc0F0dGFjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzKTtcclxuICAgIH1cclxuICAgIGhhbmRsZUV2ZW50KGUpIHtcclxuICAgICAgICBpZiAoZS50eXBlID09PSAnZm9jdXMnKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChET00uYWN0aXZlRWxlbWVudCAhPT0gdGhpcy5lbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbkZvY3VzID0gX19kZWNvcmF0ZShbXHJcbiAgICBjdXN0b21BdHRyaWJ1dGUoJ2ZvY3VzJywgYmluZGluZ01vZGUudHdvV2F5KVxyXG5dLCBGb2N1cyk7XG5cbmxldCBjc3NVcmxNYXRjaGVyID0gL3VybFxcKCg/IVsnXCJdZGF0YSkoW14pXSspXFwpL2dpO1xyXG5mdW5jdGlvbiBmaXh1cENTU1VybHMoYWRkcmVzcywgY3NzKSB7XHJcbiAgICBpZiAodHlwZW9mIGNzcyAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCBsb2FkaW5nIHJlcXVpcmVkIENTUyBmaWxlOiAke2FkZHJlc3N9YCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY3NzLnJlcGxhY2UoY3NzVXJsTWF0Y2hlciwgKG1hdGNoLCBwMSkgPT4ge1xyXG4gICAgICAgIGxldCBxdW90ZSA9IHAxLmNoYXJBdCgwKTtcclxuICAgICAgICBpZiAocXVvdGUgPT09ICdcXCcnIHx8IHF1b3RlID09PSAnXCInKSB7XHJcbiAgICAgICAgICAgIHAxID0gcDEuc3Vic3RyKDEsIHAxLmxlbmd0aCAtIDIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJ3VybChcXCcnICsgcmVsYXRpdmVUb0ZpbGUocDEsIGFkZHJlc3MpICsgJ1xcJyknO1xyXG4gICAgfSk7XHJcbn1cclxuY2xhc3MgQ1NTUmVzb3VyY2Uge1xyXG4gICAgY29uc3RydWN0b3IoYWRkcmVzcykge1xyXG4gICAgICAgIHRoaXMuYWRkcmVzcyA9IGFkZHJlc3M7XHJcbiAgICAgICAgdGhpcy5fc2NvcGVkID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9nbG9iYWwgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9hbHJlYWR5R2xvYmFsbHlJbmplY3RlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgaW5pdGlhbGl6ZShjb250YWluZXIsIFRhcmdldCkge1xyXG4gICAgICAgIHRoaXMuX3Njb3BlZCA9IG5ldyBUYXJnZXQodGhpcyk7XHJcbiAgICB9XHJcbiAgICByZWdpc3RlcihyZWdpc3RyeSwgbmFtZSkge1xyXG4gICAgICAgIGlmIChuYW1lID09PSAnc2NvcGVkJykge1xyXG4gICAgICAgICAgICByZWdpc3RyeS5yZWdpc3RlclZpZXdFbmdpbmVIb29rcyh0aGlzLl9zY29wZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fZ2xvYmFsID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsb2FkKGNvbnRhaW5lcikge1xyXG4gICAgICAgIHJldHVybiBjb250YWluZXIuZ2V0KExvYWRlcilcclxuICAgICAgICAgICAgLmxvYWRUZXh0KHRoaXMuYWRkcmVzcylcclxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBudWxsKVxyXG4gICAgICAgICAgICAudGhlbih0ZXh0ID0+IHtcclxuICAgICAgICAgICAgdGV4dCA9IGZpeHVwQ1NTVXJscyh0aGlzLmFkZHJlc3MsIHRleHQpO1xyXG4gICAgICAgICAgICB0aGlzLl9zY29wZWQuY3NzID0gdGV4dDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2dsb2JhbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYWxyZWFkeUdsb2JhbGx5SW5qZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgRE9NLmluamVjdFN0eWxlcyh0ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmNsYXNzIENTU1ZpZXdFbmdpbmVIb29rcyB7XHJcbiAgICBjb25zdHJ1Y3Rvcihvd25lcikge1xyXG4gICAgICAgIHRoaXMub3duZXIgPSBvd25lcjtcclxuICAgICAgICB0aGlzLmNzcyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBiZWZvcmVDb21waWxlKGNvbnRlbnQsIHJlc291cmNlcywgaW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICBpZiAoaW5zdHJ1Y3Rpb24udGFyZ2V0U2hhZG93RE9NKSB7XHJcbiAgICAgICAgICAgIERPTS5pbmplY3RTdHlsZXModGhpcy5jc3MsIGNvbnRlbnQsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChGRUFUVVJFLnNjb3BlZENTUykge1xyXG4gICAgICAgICAgICBsZXQgc3R5bGVOb2RlID0gRE9NLmluamVjdFN0eWxlcyh0aGlzLmNzcywgY29udGVudCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHN0eWxlTm9kZS5zZXRBdHRyaWJ1dGUoJ3Njb3BlZCcsICdzY29wZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5fZ2xvYmFsICYmICF0aGlzLm93bmVyLl9hbHJlYWR5R2xvYmFsbHlJbmplY3RlZCkge1xyXG4gICAgICAgICAgICBET00uaW5qZWN0U3R5bGVzKHRoaXMuY3NzKTtcclxuICAgICAgICAgICAgdGhpcy5vd25lci5fYWxyZWFkeUdsb2JhbGx5SW5qZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBfY3JlYXRlQ1NTUmVzb3VyY2UoYWRkcmVzcykge1xyXG4gICAgbGV0IFZpZXdDU1MgPSBjbGFzcyBWaWV3Q1NTIGV4dGVuZHMgQ1NTVmlld0VuZ2luZUhvb2tzIHtcclxuICAgIH07XHJcbiAgICBWaWV3Q1NTID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgcmVzb3VyY2UobmV3IENTU1Jlc291cmNlKGFkZHJlc3MpKVxyXG4gICAgXSwgVmlld0NTUyk7XHJcbiAgICByZXR1cm4gVmlld0NTUztcclxufVxuXG5sZXQgQXR0ckJpbmRpbmdCZWhhdmlvciA9IGNsYXNzIEF0dHJCaW5kaW5nQmVoYXZpb3Ige1xyXG4gICAgYmluZChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICBiaW5kaW5nLnRhcmdldE9ic2VydmVyID0gbmV3IERhdGFBdHRyaWJ1dGVPYnNlcnZlcihiaW5kaW5nLnRhcmdldCwgYmluZGluZy50YXJnZXRQcm9wZXJ0eSk7XHJcbiAgICB9XHJcbiAgICB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XHJcbiAgICB9XHJcbn07XHJcbkF0dHJCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgIGJpbmRpbmdCZWhhdmlvcignYXR0cicpXHJcbl0sIEF0dHJCaW5kaW5nQmVoYXZpb3IpO1xuXG5sZXQgbW9kZUJpbmRpbmdCZWhhdmlvciA9IHtcclxuICAgIGJpbmQoYmluZGluZywgc291cmNlLCBsb29rdXBGdW5jdGlvbnMpIHtcclxuICAgICAgICBiaW5kaW5nLm9yaWdpbmFsTW9kZSA9IGJpbmRpbmcubW9kZTtcclxuICAgICAgICBiaW5kaW5nLm1vZGUgPSB0aGlzLm1vZGU7XHJcbiAgICB9LFxyXG4gICAgdW5iaW5kKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIGJpbmRpbmcubW9kZSA9IGJpbmRpbmcub3JpZ2luYWxNb2RlO1xyXG4gICAgICAgIGJpbmRpbmcub3JpZ2luYWxNb2RlID0gbnVsbDtcclxuICAgIH1cclxufTtcclxubGV0IE9uZVRpbWVCaW5kaW5nQmVoYXZpb3IgPSBjbGFzcyBPbmVUaW1lQmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMubW9kZSA9IGJpbmRpbmdNb2RlLm9uZVRpbWU7XHJcbiAgICB9XHJcbn07XHJcbk9uZVRpbWVCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgIG1peGluKG1vZGVCaW5kaW5nQmVoYXZpb3IpLFxyXG4gICAgYmluZGluZ0JlaGF2aW9yKCdvbmVUaW1lJylcclxuXSwgT25lVGltZUJpbmRpbmdCZWhhdmlvcik7XHJcbmxldCBPbmVXYXlCaW5kaW5nQmVoYXZpb3IgPSBjbGFzcyBPbmVXYXlCaW5kaW5nQmVoYXZpb3Ige1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlID0gYmluZGluZ01vZGUudG9WaWV3O1xyXG4gICAgfVxyXG59O1xyXG5PbmVXYXlCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgIG1peGluKG1vZGVCaW5kaW5nQmVoYXZpb3IpLFxyXG4gICAgYmluZGluZ0JlaGF2aW9yKCdvbmVXYXknKVxyXG5dLCBPbmVXYXlCaW5kaW5nQmVoYXZpb3IpO1xyXG5sZXQgVG9WaWV3QmluZGluZ0JlaGF2aW9yID0gY2xhc3MgVG9WaWV3QmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMubW9kZSA9IGJpbmRpbmdNb2RlLnRvVmlldztcclxuICAgIH1cclxufTtcclxuVG9WaWV3QmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICBtaXhpbihtb2RlQmluZGluZ0JlaGF2aW9yKSxcclxuICAgIGJpbmRpbmdCZWhhdmlvcigndG9WaWV3JylcclxuXSwgVG9WaWV3QmluZGluZ0JlaGF2aW9yKTtcclxubGV0IEZyb21WaWV3QmluZGluZ0JlaGF2aW9yID0gY2xhc3MgRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3Ige1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlID0gYmluZGluZ01vZGUuZnJvbVZpZXc7XHJcbiAgICB9XHJcbn07XHJcbkZyb21WaWV3QmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICBtaXhpbihtb2RlQmluZGluZ0JlaGF2aW9yKSxcclxuICAgIGJpbmRpbmdCZWhhdmlvcignZnJvbVZpZXcnKVxyXG5dLCBGcm9tVmlld0JpbmRpbmdCZWhhdmlvcik7XHJcbmxldCBUd29XYXlCaW5kaW5nQmVoYXZpb3IgPSBjbGFzcyBUd29XYXlCaW5kaW5nQmVoYXZpb3Ige1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlID0gYmluZGluZ01vZGUudHdvV2F5O1xyXG4gICAgfVxyXG59O1xyXG5Ud29XYXlCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgIG1peGluKG1vZGVCaW5kaW5nQmVoYXZpb3IpLFxyXG4gICAgYmluZGluZ0JlaGF2aW9yKCd0d29XYXknKVxyXG5dLCBUd29XYXlCaW5kaW5nQmVoYXZpb3IpO1xuXG5mdW5jdGlvbiB0aHJvdHRsZShuZXdWYWx1ZSkge1xyXG4gICAgbGV0IHN0YXRlID0gdGhpcy50aHJvdHRsZVN0YXRlO1xyXG4gICAgbGV0IGVsYXBzZWQgPSArbmV3IERhdGUoKSAtIHN0YXRlLmxhc3Q7XHJcbiAgICBpZiAoZWxhcHNlZCA+PSBzdGF0ZS5kZWxheSkge1xyXG4gICAgICAgIGNsZWFyVGltZW91dChzdGF0ZS50aW1lb3V0SWQpO1xyXG4gICAgICAgIHN0YXRlLnRpbWVvdXRJZCA9IG51bGw7XHJcbiAgICAgICAgc3RhdGUubGFzdCA9ICtuZXcgRGF0ZSgpO1xyXG4gICAgICAgIHRoaXMudGhyb3R0bGVkTWV0aG9kKG5ld1ZhbHVlKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBzdGF0ZS5uZXdWYWx1ZSA9IG5ld1ZhbHVlO1xyXG4gICAgaWYgKHN0YXRlLnRpbWVvdXRJZCA9PT0gbnVsbCkge1xyXG4gICAgICAgIHN0YXRlLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBzdGF0ZS50aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgICAgICBzdGF0ZS5sYXN0ID0gK25ldyBEYXRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMudGhyb3R0bGVkTWV0aG9kKHN0YXRlLm5ld1ZhbHVlKTtcclxuICAgICAgICB9LCBzdGF0ZS5kZWxheSAtIGVsYXBzZWQpO1xyXG4gICAgfVxyXG59XHJcbmxldCBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvciA9IGNsYXNzIFRocm90dGxlQmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGJpbmQoYmluZGluZywgc291cmNlLCBkZWxheSA9IDIwMCkge1xyXG4gICAgICAgIGxldCBtZXRob2RUb1Rocm90dGxlID0gJ3VwZGF0ZVRhcmdldCc7XHJcbiAgICAgICAgaWYgKGJpbmRpbmcuY2FsbFNvdXJjZSkge1xyXG4gICAgICAgICAgICBtZXRob2RUb1Rocm90dGxlID0gJ2NhbGxTb3VyY2UnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChiaW5kaW5nLnVwZGF0ZVNvdXJjZSAmJiBiaW5kaW5nLm1vZGUgPT09IGJpbmRpbmdNb2RlLnR3b1dheSkge1xyXG4gICAgICAgICAgICBtZXRob2RUb1Rocm90dGxlID0gJ3VwZGF0ZVNvdXJjZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJpbmRpbmcudGhyb3R0bGVkTWV0aG9kID0gYmluZGluZ1ttZXRob2RUb1Rocm90dGxlXTtcclxuICAgICAgICBiaW5kaW5nLnRocm90dGxlZE1ldGhvZC5vcmlnaW5hbE5hbWUgPSBtZXRob2RUb1Rocm90dGxlO1xyXG4gICAgICAgIGJpbmRpbmdbbWV0aG9kVG9UaHJvdHRsZV0gPSB0aHJvdHRsZTtcclxuICAgICAgICBiaW5kaW5nLnRocm90dGxlU3RhdGUgPSB7XHJcbiAgICAgICAgICAgIGRlbGF5OiBkZWxheSxcclxuICAgICAgICAgICAgbGFzdDogMCxcclxuICAgICAgICAgICAgdGltZW91dElkOiBudWxsXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIHVuYmluZChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICBsZXQgbWV0aG9kVG9SZXN0b3JlID0gYmluZGluZy50aHJvdHRsZWRNZXRob2Qub3JpZ2luYWxOYW1lO1xyXG4gICAgICAgIGJpbmRpbmdbbWV0aG9kVG9SZXN0b3JlXSA9IGJpbmRpbmcudGhyb3R0bGVkTWV0aG9kO1xyXG4gICAgICAgIGJpbmRpbmcudGhyb3R0bGVkTWV0aG9kID0gbnVsbDtcclxuICAgICAgICBjbGVhclRpbWVvdXQoYmluZGluZy50aHJvdHRsZVN0YXRlLnRpbWVvdXRJZCk7XHJcbiAgICAgICAgYmluZGluZy50aHJvdHRsZVN0YXRlID0gbnVsbDtcclxuICAgIH1cclxufTtcclxuVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgIGJpbmRpbmdCZWhhdmlvcigndGhyb3R0bGUnKVxyXG5dLCBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvcik7XG5cbmNvbnN0IHVuc2V0ID0ge307XHJcbmZ1bmN0aW9uIGRlYm91bmNlQ2FsbFNvdXJjZShldmVudCkge1xyXG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLmRlYm91bmNlU3RhdGU7XHJcbiAgICBjbGVhclRpbWVvdXQoc3RhdGUudGltZW91dElkKTtcclxuICAgIHN0YXRlLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gdGhpcy5kZWJvdW5jZWRNZXRob2QoZXZlbnQpLCBzdGF0ZS5kZWxheSk7XHJcbn1cclxuZnVuY3Rpb24gZGVib3VuY2VDYWxsKGNvbnRleHQsIG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLmRlYm91bmNlU3RhdGU7XHJcbiAgICBjbGVhclRpbWVvdXQoc3RhdGUudGltZW91dElkKTtcclxuICAgIGlmIChjb250ZXh0ICE9PSBzdGF0ZS5jYWxsQ29udGV4dFRvRGVib3VuY2UpIHtcclxuICAgICAgICBzdGF0ZS5vbGRWYWx1ZSA9IHVuc2V0O1xyXG4gICAgICAgIHRoaXMuZGVib3VuY2VkTWV0aG9kKGNvbnRleHQsIG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHN0YXRlLm9sZFZhbHVlID09PSB1bnNldCkge1xyXG4gICAgICAgIHN0YXRlLm9sZFZhbHVlID0gb2xkVmFsdWU7XHJcbiAgICB9XHJcbiAgICBzdGF0ZS50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBjb25zdCBfb2xkVmFsdWUgPSBzdGF0ZS5vbGRWYWx1ZTtcclxuICAgICAgICBzdGF0ZS5vbGRWYWx1ZSA9IHVuc2V0O1xyXG4gICAgICAgIHRoaXMuZGVib3VuY2VkTWV0aG9kKGNvbnRleHQsIG5ld1ZhbHVlLCBfb2xkVmFsdWUpO1xyXG4gICAgfSwgc3RhdGUuZGVsYXkpO1xyXG59XHJcbmxldCBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvciA9IGNsYXNzIERlYm91bmNlQmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGJpbmQoYmluZGluZywgc291cmNlLCBkZWxheSA9IDIwMCkge1xyXG4gICAgICAgIGNvbnN0IGlzQ2FsbFNvdXJjZSA9IGJpbmRpbmcuY2FsbFNvdXJjZSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGNvbnN0IG1ldGhvZFRvRGVib3VuY2UgPSBpc0NhbGxTb3VyY2UgPyAnY2FsbFNvdXJjZScgOiAnY2FsbCc7XHJcbiAgICAgICAgY29uc3QgZGVib3VuY2VyID0gaXNDYWxsU291cmNlID8gZGVib3VuY2VDYWxsU291cmNlIDogZGVib3VuY2VDYWxsO1xyXG4gICAgICAgIGNvbnN0IG1vZGUgPSBiaW5kaW5nLm1vZGU7XHJcbiAgICAgICAgY29uc3QgY2FsbENvbnRleHRUb0RlYm91bmNlID0gbW9kZSA9PT0gYmluZGluZ01vZGUudHdvV2F5IHx8IG1vZGUgPT09IGJpbmRpbmdNb2RlLmZyb21WaWV3ID8gdGFyZ2V0Q29udGV4dCA6IHNvdXJjZUNvbnRleHQ7XHJcbiAgICAgICAgYmluZGluZy5kZWJvdW5jZWRNZXRob2QgPSBiaW5kaW5nW21ldGhvZFRvRGVib3VuY2VdO1xyXG4gICAgICAgIGJpbmRpbmcuZGVib3VuY2VkTWV0aG9kLm9yaWdpbmFsTmFtZSA9IG1ldGhvZFRvRGVib3VuY2U7XHJcbiAgICAgICAgYmluZGluZ1ttZXRob2RUb0RlYm91bmNlXSA9IGRlYm91bmNlcjtcclxuICAgICAgICBiaW5kaW5nLmRlYm91bmNlU3RhdGUgPSB7XHJcbiAgICAgICAgICAgIGNhbGxDb250ZXh0VG9EZWJvdW5jZSxcclxuICAgICAgICAgICAgZGVsYXksXHJcbiAgICAgICAgICAgIHRpbWVvdXRJZDogMCxcclxuICAgICAgICAgICAgb2xkVmFsdWU6IHVuc2V0XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIHVuYmluZChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICBjb25zdCBtZXRob2RUb1Jlc3RvcmUgPSBiaW5kaW5nLmRlYm91bmNlZE1ldGhvZC5vcmlnaW5hbE5hbWU7XHJcbiAgICAgICAgYmluZGluZ1ttZXRob2RUb1Jlc3RvcmVdID0gYmluZGluZy5kZWJvdW5jZWRNZXRob2Q7XHJcbiAgICAgICAgYmluZGluZy5kZWJvdW5jZWRNZXRob2QgPSBudWxsO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChiaW5kaW5nLmRlYm91bmNlU3RhdGUudGltZW91dElkKTtcclxuICAgICAgICBiaW5kaW5nLmRlYm91bmNlU3RhdGUgPSBudWxsO1xyXG4gICAgfVxyXG59O1xyXG5EZWJvdW5jZUJpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGluZ0JlaGF2aW9yKCdkZWJvdW5jZScpXHJcbl0sIERlYm91bmNlQmluZGluZ0JlaGF2aW9yKTtcblxuZnVuY3Rpb24gZmluZE9yaWdpbmFsRXZlbnRUYXJnZXQoZXZlbnQpIHtcclxuICAgIHJldHVybiAoZXZlbnQucGF0aCAmJiBldmVudC5wYXRoWzBdKSB8fCAoZXZlbnQuZGVlcFBhdGggJiYgZXZlbnQuZGVlcFBhdGhbMF0pIHx8IGV2ZW50LnRhcmdldDtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVTZWxmRXZlbnQoZXZlbnQpIHtcclxuICAgIGxldCB0YXJnZXQgPSBmaW5kT3JpZ2luYWxFdmVudFRhcmdldChldmVudCk7XHJcbiAgICBpZiAodGhpcy50YXJnZXQgIT09IHRhcmdldCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuc2VsZkV2ZW50Q2FsbFNvdXJjZShldmVudCk7XHJcbn1cclxubGV0IFNlbGZCaW5kaW5nQmVoYXZpb3IgPSBjbGFzcyBTZWxmQmluZGluZ0JlaGF2aW9yIHtcclxuICAgIGJpbmQoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgaWYgKCFiaW5kaW5nLmNhbGxTb3VyY2UgfHwgIWJpbmRpbmcudGFyZ2V0RXZlbnQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTZWxmIGJpbmRpbmcgYmVoYXZpb3Igb25seSBzdXBwb3J0cyBldmVudC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYmluZGluZy5zZWxmRXZlbnRDYWxsU291cmNlID0gYmluZGluZy5jYWxsU291cmNlO1xyXG4gICAgICAgIGJpbmRpbmcuY2FsbFNvdXJjZSA9IGhhbmRsZVNlbGZFdmVudDtcclxuICAgIH1cclxuICAgIHVuYmluZChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgICAgICBiaW5kaW5nLmNhbGxTb3VyY2UgPSBiaW5kaW5nLnNlbGZFdmVudENhbGxTb3VyY2U7XHJcbiAgICAgICAgYmluZGluZy5zZWxmRXZlbnRDYWxsU291cmNlID0gbnVsbDtcclxuICAgIH1cclxufTtcclxuU2VsZkJpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGluZ0JlaGF2aW9yKCdzZWxmJylcclxuXSwgU2VsZkJpbmRpbmdCZWhhdmlvcik7XG5cbmNsYXNzIEJpbmRpbmdTaWduYWxlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnNpZ25hbHMgPSB7fTtcclxuICAgIH1cclxuICAgIHNpZ25hbChuYW1lKSB7XHJcbiAgICAgICAgbGV0IGJpbmRpbmdzID0gdGhpcy5zaWduYWxzW25hbWVdO1xyXG4gICAgICAgIGlmICghYmluZGluZ3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaSA9IGJpbmRpbmdzLmxlbmd0aDtcclxuICAgICAgICB3aGlsZSAoaS0tKSB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzW2ldLmNhbGwoc291cmNlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbmxldCBTaWduYWxCaW5kaW5nQmVoYXZpb3IgPSBjbGFzcyBTaWduYWxCaW5kaW5nQmVoYXZpb3Ige1xyXG4gICAgY29uc3RydWN0b3IoYmluZGluZ1NpZ25hbGVyKSB7XHJcbiAgICAgICAgdGhpcy5zaWduYWxzID0gYmluZGluZ1NpZ25hbGVyLnNpZ25hbHM7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgaW5qZWN0KCkgeyByZXR1cm4gW0JpbmRpbmdTaWduYWxlcl07IH1cclxuICAgIGJpbmQoYmluZGluZywgc291cmNlLCAuLi5uYW1lcykge1xyXG4gICAgICAgIGlmICghYmluZGluZy51cGRhdGVUYXJnZXQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPbmx5IHByb3BlcnR5IGJpbmRpbmdzIGFuZCBzdHJpbmcgaW50ZXJwb2xhdGlvbiBiaW5kaW5ncyBjYW4gYmUgc2lnbmFsZWQuICBUcmlnZ2VyLCBkZWxlZ2F0ZSBhbmQgY2FsbCBiaW5kaW5ncyBjYW5ub3QgYmUgc2lnbmFsZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBzaWduYWxzID0gdGhpcy5zaWduYWxzO1xyXG4gICAgICAgIGlmIChuYW1lcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgbGV0IG5hbWUgPSBuYW1lc1swXTtcclxuICAgICAgICAgICAgbGV0IGJpbmRpbmdzID0gc2lnbmFsc1tuYW1lXSB8fCAoc2lnbmFsc1tuYW1lXSA9IFtdKTtcclxuICAgICAgICAgICAgYmluZGluZ3MucHVzaChiaW5kaW5nKTtcclxuICAgICAgICAgICAgYmluZGluZy5zaWduYWxOYW1lID0gbmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobmFtZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICBsZXQgaSA9IG5hbWVzLmxlbmd0aDtcclxuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IG5hbWUgPSBuYW1lc1tpXTtcclxuICAgICAgICAgICAgICAgIGxldCBiaW5kaW5ncyA9IHNpZ25hbHNbbmFtZV0gfHwgKHNpZ25hbHNbbmFtZV0gPSBbXSk7XHJcbiAgICAgICAgICAgICAgICBiaW5kaW5ncy5wdXNoKGJpbmRpbmcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJpbmRpbmcuc2lnbmFsTmFtZSA9IG5hbWVzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaWduYWwgbmFtZSBpcyByZXF1aXJlZC4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgbGV0IHNpZ25hbHMgPSB0aGlzLnNpZ25hbHM7XHJcbiAgICAgICAgbGV0IG5hbWUgPSBiaW5kaW5nLnNpZ25hbE5hbWU7XHJcbiAgICAgICAgYmluZGluZy5zaWduYWxOYW1lID0gbnVsbDtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lKSkge1xyXG4gICAgICAgICAgICBsZXQgbmFtZXMgPSBuYW1lO1xyXG4gICAgICAgICAgICBsZXQgaSA9IG5hbWVzLmxlbmd0aDtcclxuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IG4gPSBuYW1lc1tpXTtcclxuICAgICAgICAgICAgICAgIGxldCBiaW5kaW5ncyA9IHNpZ25hbHNbbl07XHJcbiAgICAgICAgICAgICAgICBiaW5kaW5ncy5zcGxpY2UoYmluZGluZ3MuaW5kZXhPZihiaW5kaW5nKSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCBiaW5kaW5ncyA9IHNpZ25hbHNbbmFtZV07XHJcbiAgICAgICAgICAgIGJpbmRpbmdzLnNwbGljZShiaW5kaW5ncy5pbmRleE9mKGJpbmRpbmcpLCAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcblNpZ25hbEJpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgYmluZGluZ0JlaGF2aW9yKCdzaWduYWwnKVxyXG5dLCBTaWduYWxCaW5kaW5nQmVoYXZpb3IpO1xuXG5jb25zdCBldmVudE5hbWVzUmVxdWlyZWQgPSAnVGhlIHVwZGF0ZVRyaWdnZXIgYmluZGluZyBiZWhhdmlvciByZXF1aXJlcyBhdCBsZWFzdCBvbmUgZXZlbnQgbmFtZSBhcmd1bWVudDogZWcgPGlucHV0IHZhbHVlLmJpbmQ9XCJmaXJzdE5hbWUgJiB1cGRhdGVUcmlnZ2VyOlxcJ2JsdXJcXCdcIj4nO1xyXG5jb25zdCBub3RBcHBsaWNhYmxlTWVzc2FnZSA9ICdUaGUgdXBkYXRlVHJpZ2dlciBiaW5kaW5nIGJlaGF2aW9yIGNhbiBvbmx5IGJlIGFwcGxpZWQgdG8gdHdvLXdheS8gZnJvbS12aWV3IGJpbmRpbmdzIG9uIGlucHV0L3NlbGVjdCBlbGVtZW50cy4nO1xyXG5sZXQgVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvciA9IGNsYXNzIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3Ige1xyXG4gICAgYmluZChiaW5kaW5nLCBzb3VyY2UsIC4uLmV2ZW50cykge1xyXG4gICAgICAgIGlmIChldmVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihldmVudE5hbWVzUmVxdWlyZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYmluZGluZy5tb2RlICE9PSBiaW5kaW5nTW9kZS50d29XYXkgJiYgYmluZGluZy5tb2RlICE9PSBiaW5kaW5nTW9kZS5mcm9tVmlldykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3Iobm90QXBwbGljYWJsZU1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgdGFyZ2V0T2JzZXJ2ZXIgPSBiaW5kaW5nLm9ic2VydmVyTG9jYXRvci5nZXRPYnNlcnZlcihiaW5kaW5nLnRhcmdldCwgYmluZGluZy50YXJnZXRQcm9wZXJ0eSk7XHJcbiAgICAgICAgaWYgKCF0YXJnZXRPYnNlcnZlci5oYW5kbGVyKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihub3RBcHBsaWNhYmxlTWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJpbmRpbmcudGFyZ2V0T2JzZXJ2ZXIgPSB0YXJnZXRPYnNlcnZlcjtcclxuICAgICAgICB0YXJnZXRPYnNlcnZlci5vcmlnaW5hbEhhbmRsZXIgPSBiaW5kaW5nLnRhcmdldE9ic2VydmVyLmhhbmRsZXI7XHJcbiAgICAgICAgbGV0IGhhbmRsZXIgPSBuZXcgRXZlbnRTdWJzY3JpYmVyKGV2ZW50cyk7XHJcbiAgICAgICAgdGFyZ2V0T2JzZXJ2ZXIuaGFuZGxlciA9IGhhbmRsZXI7XHJcbiAgICB9XHJcbiAgICB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgbGV0IHRhcmdldE9ic2VydmVyID0gYmluZGluZy50YXJnZXRPYnNlcnZlcjtcclxuICAgICAgICB0YXJnZXRPYnNlcnZlci5oYW5kbGVyLmRpc3Bvc2UoKTtcclxuICAgICAgICB0YXJnZXRPYnNlcnZlci5oYW5kbGVyID0gdGFyZ2V0T2JzZXJ2ZXIub3JpZ2luYWxIYW5kbGVyO1xyXG4gICAgICAgIHRhcmdldE9ic2VydmVyLm9yaWdpbmFsSGFuZGxlciA9IG51bGw7XHJcbiAgICB9XHJcbn07XHJcblVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgIGJpbmRpbmdCZWhhdmlvcigndXBkYXRlVHJpZ2dlcicpXHJcbl0sIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IpO1xuXG5mdW5jdGlvbiBfY3JlYXRlRHluYW1pY0VsZW1lbnQoeyBuYW1lLCB2aWV3VXJsLCBiaW5kYWJsZU5hbWVzLCB1c2VTaGFkb3dET01tb2RlIH0pIHtcclxuICAgIGxldCBEeW5hbWljRWxlbWVudCA9IGNsYXNzIER5bmFtaWNFbGVtZW50IHtcclxuICAgICAgICBiaW5kKGJpbmRpbmdDb250ZXh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuJHBhcmVudCA9IGJpbmRpbmdDb250ZXh0O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEeW5hbWljRWxlbWVudCA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGN1c3RvbUVsZW1lbnQobmFtZSksXHJcbiAgICAgICAgdXNlVmlldyh2aWV3VXJsKVxyXG4gICAgXSwgRHluYW1pY0VsZW1lbnQpO1xyXG4gICAgZm9yIChsZXQgaSA9IDAsIGlpID0gYmluZGFibGVOYW1lcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgYmluZGFibGUoYmluZGFibGVOYW1lc1tpXSkoRHluYW1pY0VsZW1lbnQpO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoICh1c2VTaGFkb3dET01tb2RlKSB7XHJcbiAgICAgICAgY2FzZSAnb3Blbic6XHJcbiAgICAgICAgICAgIHVzZVNoYWRvd0RPTSh7IG1vZGU6ICdvcGVuJyB9KShEeW5hbWljRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2Nsb3NlZCc6XHJcbiAgICAgICAgICAgIHVzZVNoYWRvd0RPTSh7IG1vZGU6ICdjbG9zZWQnIH0pKER5bmFtaWNFbGVtZW50KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnJzpcclxuICAgICAgICAgICAgdXNlU2hhZG93RE9NKER5bmFtaWNFbGVtZW50KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBudWxsOlxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBnZXRMb2dnZXIoJ2F1cmVsaWEtaHRtbC1vbmx5LWVsZW1lbnQnKVxyXG4gICAgICAgICAgICAgICAgLndhcm4oYEV4cGVjdGVkICd1c2Utc2hhZG93LWRvbScgdmFsdWUgdG8gYmUgXCJjbG9zZVwiLCBcIm9wZW5cIiBvciBcIlwiLCByZWNlaXZlZCAke3VzZVNoYWRvd0RPTW1vZGV9YCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIER5bmFtaWNFbGVtZW50O1xyXG59XG5cbmZ1bmN0aW9uIGdldEVsZW1lbnROYW1lKGFkZHJlc3MpIHtcclxuICAgIHJldHVybiAvKFteXFwvXlxcP10rKVxcLmh0bWwvaS5leGVjKGFkZHJlc3MpWzFdLnRvTG93ZXJDYXNlKCk7XHJcbn1cclxuZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZykge1xyXG4gICAgY29uc3Qgdmlld0VuZ2luZSA9IGNvbmZpZy5jb250YWluZXIuZ2V0KFZpZXdFbmdpbmUpO1xyXG4gICAgY29uc3QgbG9hZGVyID0gY29uZmlnLmF1cmVsaWEubG9hZGVyO1xyXG4gICAgdmlld0VuZ2luZS5hZGRSZXNvdXJjZVBsdWdpbignLmh0bWwnLCB7XHJcbiAgICAgICAgJ2ZldGNoJzogZnVuY3Rpb24gKHZpZXdVcmwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxvYWRlci5sb2FkVGVtcGxhdGUodmlld1VybCkudGhlbihyZWdpc3RyeUVudHJ5ID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBiaW5kYWJsZU5hbWVzID0gcmVnaXN0cnlFbnRyeS50ZW1wbGF0ZS5nZXRBdHRyaWJ1dGUoJ2JpbmRhYmxlJyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VTaGFkb3dET01tb2RlID0gcmVnaXN0cnlFbnRyeS50ZW1wbGF0ZS5nZXRBdHRyaWJ1dGUoJ3VzZS1zaGFkb3ctZG9tJyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gZ2V0RWxlbWVudE5hbWUodmlld1VybCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYmluZGFibGVOYW1lcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGJpbmRhYmxlTmFtZXMgPSBiaW5kYWJsZU5hbWVzLnNwbGl0KCcsJykubWFwKHggPT4geC50cmltKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlZ2lzdHJ5RW50cnkudGVtcGxhdGUucmVtb3ZlQXR0cmlidXRlKCdiaW5kYWJsZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmluZGFibGVOYW1lcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgW25hbWVdOiBfY3JlYXRlRHluYW1pY0VsZW1lbnQoeyBuYW1lLCB2aWV3VXJsLCBiaW5kYWJsZU5hbWVzLCB1c2VTaGFkb3dET01tb2RlIH0pIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XG5cbmZ1bmN0aW9uIGNvbmZpZ3VyZSQxKGNvbmZpZykge1xyXG4gICAgaW5qZWN0QXVyZWxpYUhpZGVTdHlsZUF0SGVhZCgpO1xyXG4gICAgY29uZmlnLmdsb2JhbFJlc291cmNlcyhDb21wb3NlLCBJZiwgRWxzZSwgV2l0aCwgUmVwZWF0LCBTaG93LCBIaWRlLCBSZXBsYWNlYWJsZSwgRm9jdXMsIFNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyLCBPbmVUaW1lQmluZGluZ0JlaGF2aW9yLCBPbmVXYXlCaW5kaW5nQmVoYXZpb3IsIFRvVmlld0JpbmRpbmdCZWhhdmlvciwgRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3IsIFR3b1dheUJpbmRpbmdCZWhhdmlvciwgVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IsIERlYm91bmNlQmluZGluZ0JlaGF2aW9yLCBTZWxmQmluZGluZ0JlaGF2aW9yLCBTaWduYWxCaW5kaW5nQmVoYXZpb3IsIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IsIEF0dHJCaW5kaW5nQmVoYXZpb3IpO1xyXG4gICAgY29uZmlndXJlKGNvbmZpZyk7XHJcbiAgICBsZXQgdmlld0VuZ2luZSA9IGNvbmZpZy5jb250YWluZXIuZ2V0KFZpZXdFbmdpbmUpO1xyXG4gICAgbGV0IHN0eWxlUmVzb3VyY2VQbHVnaW4gPSB7XHJcbiAgICAgICAgZmV0Y2goYWRkcmVzcykge1xyXG4gICAgICAgICAgICByZXR1cm4geyBbYWRkcmVzc106IF9jcmVhdGVDU1NSZXNvdXJjZShhZGRyZXNzKSB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBbJy5jc3MnLCAnLmxlc3MnLCAnLnNhc3MnLCAnLnNjc3MnLCAnLnN0eWwnXS5mb3JFYWNoKGV4dCA9PiB2aWV3RW5naW5lLmFkZFJlc291cmNlUGx1Z2luKGV4dCwgc3R5bGVSZXNvdXJjZVBsdWdpbikpO1xyXG59XG5cbmV4cG9ydCB7IEFic3RyYWN0UmVwZWF0ZXIsIEFycmF5UmVwZWF0U3RyYXRlZ3ksIEF0dHJCaW5kaW5nQmVoYXZpb3IsIEJpbmRpbmdTaWduYWxlciwgQ29tcG9zZSwgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IsIEVsc2UsIEZvY3VzLCBGcm9tVmlld0JpbmRpbmdCZWhhdmlvciwgSFRNTFNhbml0aXplciwgSGlkZSwgSWYsIE1hcFJlcGVhdFN0cmF0ZWd5LCBOdWxsUmVwZWF0U3RyYXRlZ3ksIE51bWJlclJlcGVhdFN0cmF0ZWd5LCBPbmVUaW1lQmluZGluZ0JlaGF2aW9yLCBPbmVXYXlCaW5kaW5nQmVoYXZpb3IsIFJlcGVhdCwgUmVwZWF0U3RyYXRlZ3lMb2NhdG9yLCBSZXBsYWNlYWJsZSwgU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIsIFNlbGZCaW5kaW5nQmVoYXZpb3IsIFNldFJlcGVhdFN0cmF0ZWd5LCBTaG93LCBTaWduYWxCaW5kaW5nQmVoYXZpb3IsIFRocm90dGxlQmluZGluZ0JlaGF2aW9yLCBUb1ZpZXdCaW5kaW5nQmVoYXZpb3IsIFR3b1dheUJpbmRpbmdCZWhhdmlvciwgVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvciwgV2l0aCwgY29uZmlndXJlJDEgYXMgY29uZmlndXJlLCBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0LCBnZXRJdGVtc1NvdXJjZUV4cHJlc3Npb24sIGlzT25lVGltZSwgdW53cmFwRXhwcmVzc2lvbiwgdXBkYXRlT25lVGltZUJpbmRpbmcsIHVwZGF0ZU92ZXJyaWRlQ29udGV4dCwgdmlld3NSZXF1aXJlTGlmZWN5Y2xlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzLmpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///aurelia-templating-resources\n");

/***/ }),

/***/ "aurelia-templating-router":
/*!*****************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-router/dist/es2015/aurelia-templating-router.js ***!
  \*****************************************************************************************/
/*! exports provided: RouteHref, RouterView, TemplatingRouteLoader, configure */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouteHref\", function() { return RouteHref; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RouterView\", function() { return RouterView; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TemplatingRouteLoader\", function() { return TemplatingRouteLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony import */ var aurelia_router__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-router */ \"./node_modules/aurelia-router/dist/es2015/aurelia-router.js\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-metadata */ \"./node_modules/aurelia-metadata/dist/es2015/aurelia-metadata.js\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-path */ \"./node_modules/aurelia-path/dist/es2015/aurelia-path.js\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-templating */ \"./node_modules/aurelia-templating/dist/es2015/aurelia-templating.js\");\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-dependency-injection */ \"./node_modules/aurelia-dependency-injection/dist/es2015/aurelia-dependency-injection.js\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-binding */ \"./node_modules/aurelia-binding/dist/es2015/aurelia-binding.js\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-pal */ \"./node_modules/aurelia-pal/dist/es2015/aurelia-pal.js\");\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-logging */ \"./node_modules/aurelia-logging/dist/es2015/aurelia-logging.js\");\n\n\n\n\n\n\n\n\n\nclass EmptyLayoutViewModel {\r\n}\r\n/**\r\n * Implementation of Aurelia Router ViewPort. Responsible for loading route, composing and swapping routes views\r\n */\r\nclass RouterView {\r\n    constructor(element, container, viewSlot, router, viewLocator, compositionTransaction, compositionEngine) {\r\n        this.element = element;\r\n        this.container = container;\r\n        this.viewSlot = viewSlot;\r\n        this.router = router;\r\n        this.viewLocator = viewLocator;\r\n        this.compositionTransaction = compositionTransaction;\r\n        this.compositionEngine = compositionEngine;\r\n        // add this <router-view/> to router view ports lookup based on name attribute\r\n        // when this router is the root router-view\r\n        // also trigger AppRouter registerViewPort extra flow\r\n        this.router.registerViewPort(this, this.element.getAttribute('name'));\r\n        // Each <router-view/> process its instruction as a composition transaction\r\n        // there are differences between intial composition and subsequent compositions\r\n        // also there are differences between root composition and child <router-view/> composition\r\n        // mark the first composition transaction with a property initialComposition to distinguish it\r\n        // when the root <router-view/> gets new instruction for the first time\r\n        if (!('initialComposition' in compositionTransaction)) {\r\n            compositionTransaction.initialComposition = true;\r\n            this.compositionTransactionNotifier = compositionTransaction.enlist();\r\n        }\r\n    }\r\n    /**@internal */\r\n    static inject() {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_6__[\"DOM\"].Element, aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__[\"Container\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewLocator\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionTransaction\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"]];\r\n    }\r\n    created(owningView) {\r\n        this.owningView = owningView;\r\n    }\r\n    bind(bindingContext, overrideContext) {\r\n        // router needs to get access to view model of current route parent\r\n        // doing it in generic way via viewModel property on container\r\n        this.container.viewModel = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n    }\r\n    /**\r\n     * Implementation of `aurelia-router` ViewPort interface, responsible for templating related part in routing Pipeline\r\n     */\r\n    process($viewPortInstruction, waitToSwap) {\r\n        // have strong typings without exposing it in public typings, this is to ensure maximum backward compat\r\n        const viewPortInstruction = $viewPortInstruction;\r\n        const component = viewPortInstruction.component;\r\n        const childContainer = component.childContainer;\r\n        const viewModel = component.viewModel;\r\n        const viewModelResource = component.viewModelResource;\r\n        const metadata = viewModelResource.metadata;\r\n        const config = component.router.currentInstruction.config;\r\n        const viewPortConfig = config.viewPorts ? (config.viewPorts[viewPortInstruction.name] || {}) : {};\r\n        childContainer.get(RouterViewLocator)._notify(this);\r\n        // layoutInstruction is our layout viewModel\r\n        const layoutInstruction = {\r\n            viewModel: viewPortConfig.layoutViewModel || config.layoutViewModel || this.layoutViewModel,\r\n            view: viewPortConfig.layoutView || config.layoutView || this.layoutView,\r\n            model: viewPortConfig.layoutModel || config.layoutModel || this.layoutModel,\r\n            router: viewPortInstruction.component.router,\r\n            childContainer: childContainer,\r\n            viewSlot: this.viewSlot\r\n        };\r\n        // viewport will be a thin wrapper around composition engine\r\n        // to process instruction/configuration from users\r\n        // preparing all information related to a composition process\r\n        // first by getting view strategy of a ViewPortComponent View\r\n        const viewStrategy = this.viewLocator.getViewStrategy(component.view || viewModel);\r\n        if (viewStrategy && component.view) {\r\n            viewStrategy.makeRelativeTo(aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(component.router.container.viewModel.constructor).moduleId);\r\n        }\r\n        // using metadata of a custom element view model to load appropriate view-factory instance\r\n        return metadata\r\n            .load(childContainer, viewModelResource.value, null, viewStrategy, true)\r\n            // for custom element, viewFactory typing is always ViewFactory\r\n            // for custom attribute, it will be HtmlBehaviorResource\r\n            .then((viewFactory) => {\r\n            // if this is not the first time that this <router-view/> is composing its instruction\r\n            // try to capture ownership of the composition transaction\r\n            // child <router-view/> will not be able to capture, since root <router-view/> typically captures\r\n            // the ownership token\r\n            if (!this.compositionTransactionNotifier) {\r\n                this.compositionTransactionOwnershipToken = this.compositionTransaction.tryCapture();\r\n            }\r\n            if (layoutInstruction.viewModel || layoutInstruction.view) {\r\n                viewPortInstruction.layoutInstruction = layoutInstruction;\r\n            }\r\n            const viewPortComponentBehaviorInstruction = aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BehaviorInstruction\"].dynamic(this.element, viewModel, viewFactory);\r\n            viewPortInstruction.controller = metadata.create(childContainer, viewPortComponentBehaviorInstruction);\r\n            if (waitToSwap) {\r\n                return null;\r\n            }\r\n            this.swap(viewPortInstruction);\r\n        });\r\n    }\r\n    swap($viewPortInstruction) {\r\n        // have strong typings without exposing it in public typings, this is to ensure maximum backward compat\r\n        const viewPortInstruction = $viewPortInstruction;\r\n        const viewPortController = viewPortInstruction.controller;\r\n        const layoutInstruction = viewPortInstruction.layoutInstruction;\r\n        const previousView = this.view;\r\n        // Final step of swapping a <router-view/> ViewPortComponent\r\n        const work = () => {\r\n            const swapStrategy = aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SwapStrategies\"][this.swapOrder] || aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"SwapStrategies\"].after;\r\n            const viewSlot = this.viewSlot;\r\n            swapStrategy(viewSlot, previousView, () => Promise.resolve(viewSlot.add(this.view))).then(() => {\r\n                this._notify();\r\n            });\r\n        };\r\n        // Ensure all users setups have been completed\r\n        const ready = (owningView_or_layoutView) => {\r\n            viewPortController.automate(this.overrideContext, owningView_or_layoutView);\r\n            const transactionOwnerShipToken = this.compositionTransactionOwnershipToken;\r\n            // if this router-view is the root <router-view/> of a normal startup via aurelia.setRoot\r\n            // attemp to take control of the transaction\r\n            // if ownership can be taken\r\n            // wait for transaction to complete before swapping\r\n            if (transactionOwnerShipToken) {\r\n                return transactionOwnerShipToken\r\n                    .waitForCompositionComplete()\r\n                    .then(() => {\r\n                    this.compositionTransactionOwnershipToken = null;\r\n                    return work();\r\n                });\r\n            }\r\n            // otherwise, just swap\r\n            return work();\r\n        };\r\n        // If there is layout instruction, new to compose layout before processing ViewPortComponent\r\n        // layout controller/view/view-model is composed using composition engine APIs\r\n        if (layoutInstruction) {\r\n            if (!layoutInstruction.viewModel) {\r\n                // createController chokes if there's no viewmodel, so create a dummy one\r\n                // but avoid using a POJO as it creates unwanted metadata in Object constructor\r\n                layoutInstruction.viewModel = new EmptyLayoutViewModel();\r\n            }\r\n            // using composition engine to create compose layout\r\n            return this.compositionEngine\r\n                // first create controller from layoutInstruction\r\n                // and treat it as CompositionContext\r\n                // then emulate slot projection with ViewPortComponent view\r\n                .createController(layoutInstruction)\r\n                .then((layoutController) => {\r\n                const layoutView = layoutController.view;\r\n                aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ShadowDOM\"].distributeView(viewPortController.view, layoutController.slots || layoutView.slots);\r\n                // when there is a layout\r\n                // view hierarchy is: <router-view/> owner view -> layout view -> ViewPortComponent view\r\n                layoutController.automate(Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_5__[\"createOverrideContext\"])(layoutInstruction.viewModel), this.owningView);\r\n                layoutView.children.push(viewPortController.view);\r\n                return layoutView || layoutController;\r\n            })\r\n                .then((newView) => {\r\n                this.view = newView;\r\n                return ready(newView);\r\n            });\r\n        }\r\n        // if there is no layout, then get ViewPortComponent view ready as view property\r\n        // and process controller/swapping\r\n        // when there is no layout\r\n        // view hierarchy is: <router-view/> owner view -> ViewPortComponent view\r\n        this.view = viewPortController.view;\r\n        return ready(this.owningView);\r\n    }\r\n    /**\r\n     * Notify composition transaction that this router has finished processing\r\n     * Happens when this <router-view/> is the root router-view\r\n     * @internal\r\n     */\r\n    _notify() {\r\n        const notifier = this.compositionTransactionNotifier;\r\n        if (notifier) {\r\n            notifier.done();\r\n            this.compositionTransactionNotifier = null;\r\n        }\r\n    }\r\n}\r\n/**\r\n * @internal Actively avoid using decorator to reduce the amount of code generated\r\n *\r\n * There is no view to compose by default in a router view\r\n * This custom element is responsible for composing its own view, based on current config\r\n */\r\nRouterView.$view = null;\r\n/**\r\n * @internal Actively avoid using decorator to reduce the amount of code generated\r\n */\r\nRouterView.$resource = {\r\n    name: 'router-view',\r\n    bindables: ['swapOrder', 'layoutView', 'layoutViewModel', 'layoutModel', 'inherit-binding-context']\r\n};\r\n/**\r\n* Locator which finds the nearest RouterView, relative to the current dependency injection container.\r\n*/\r\nclass RouterViewLocator {\r\n    /**\r\n    * Creates an instance of the RouterViewLocator class.\r\n    */\r\n    constructor() {\r\n        this.promise = new Promise((resolve) => this.resolve = resolve);\r\n    }\r\n    /**\r\n    * Finds the nearest RouterView instance.\r\n    * @returns A promise that will be resolved with the located RouterView instance.\r\n    */\r\n    findNearest() {\r\n        return this.promise;\r\n    }\r\n    /**@internal */\r\n    _notify(routerView) {\r\n        this.resolve(routerView);\r\n    }\r\n}\n\n/**@internal exported for unit testing */\r\nclass EmptyClass {\r\n}\r\naurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"inlineView\"]('<template></template>')(EmptyClass);\r\n/**\r\n * Default implementation of `RouteLoader` used for loading component based on a route config\r\n */\r\nclass TemplatingRouteLoader extends aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"RouteLoader\"] {\r\n    constructor(compositionEngine) {\r\n        super();\r\n        this.compositionEngine = compositionEngine;\r\n    }\r\n    /**\r\n     * Resolve a view model from a RouteConfig\r\n     * Throws when there is neither \"moduleId\" nor \"viewModel\" property\r\n     * @internal\r\n     */\r\n    resolveViewModel(router, config) {\r\n        return new Promise((resolve, reject) => {\r\n            let viewModel;\r\n            if ('moduleId' in config) {\r\n                let moduleId = config.moduleId;\r\n                if (moduleId === null) {\r\n                    viewModel = EmptyClass;\r\n                }\r\n                else {\r\n                    // this requires container of router has passes a certain point\r\n                    // where a view model has been setup on the container\r\n                    // it will fail in enhance scenario because no viewport has been registered\r\n                    moduleId = Object(aurelia_path__WEBPACK_IMPORTED_MODULE_2__[\"relativeToFile\"])(moduleId, aurelia_metadata__WEBPACK_IMPORTED_MODULE_1__[\"Origin\"].get(router.container.viewModel.constructor).moduleId);\r\n                    if (/\\.html/i.test(moduleId)) {\r\n                        viewModel = createDynamicClass(moduleId);\r\n                    }\r\n                    else {\r\n                        viewModel = moduleId;\r\n                    }\r\n                }\r\n                return resolve(viewModel);\r\n            }\r\n            // todo: add if ('viewModel' in config) to support static view model resolution\r\n            reject(new Error('Invalid route config. No \"moduleId\" found.'));\r\n        });\r\n    }\r\n    /**\r\n     * Create child container based on a router container\r\n     * Also ensures that child router are properly constructed in the newly created child container\r\n     * @internal\r\n     */\r\n    createChildContainer(router) {\r\n        const childContainer = router.container.createChild();\r\n        childContainer.registerSingleton(RouterViewLocator);\r\n        childContainer.getChildRouter = function () {\r\n            let childRouter;\r\n            childContainer.registerHandler(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], () => childRouter || (childRouter = router.createChild(childContainer)));\r\n            return childContainer.get(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"]);\r\n        };\r\n        return childContainer;\r\n    }\r\n    /**\r\n     * Load corresponding component of a route config of a navigation instruction\r\n     */\r\n    loadRoute(router, config, _navInstruction) {\r\n        return this\r\n            .resolveViewModel(router, config)\r\n            .then(viewModel => this.compositionEngine.ensureViewModel({\r\n            viewModel: viewModel,\r\n            childContainer: this.createChildContainer(router),\r\n            view: config.view || config.viewStrategy,\r\n            router: router\r\n        }));\r\n    }\r\n}\r\n/**@internal */\r\nTemplatingRouteLoader.inject = [aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"]];\r\n/**@internal exported for unit testing */\r\nfunction createDynamicClass(moduleId) {\r\n    const name = /([^\\/^\\?]+)\\.html/i.exec(moduleId)[1];\r\n    class DynamicClass {\r\n        bind(bindingContext) {\r\n            this.$parent = bindingContext;\r\n        }\r\n    }\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])(name)(DynamicClass);\r\n    Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useView\"])(moduleId)(DynamicClass);\r\n    return DynamicClass;\r\n}\n\nconst logger = Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_7__[\"getLogger\"])('route-href');\r\n/**\r\n * Helper custom attribute to help associate an element with a route by name\r\n */\r\nclass RouteHref {\r\n    constructor(router, element) {\r\n        this.router = router;\r\n        this.element = element;\r\n        this.attribute = 'href';\r\n    }\r\n    /*@internal */\r\n    static inject() {\r\n        return [aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_pal__WEBPACK_IMPORTED_MODULE_6__[\"DOM\"].Element];\r\n    }\r\n    bind() {\r\n        this.isActive = true;\r\n        this.processChange();\r\n    }\r\n    unbind() {\r\n        this.isActive = false;\r\n    }\r\n    attributeChanged(value, previous) {\r\n        if (previous) {\r\n            this.element.removeAttribute(previous);\r\n        }\r\n        return this.processChange();\r\n    }\r\n    processChange() {\r\n        return this.router\r\n            .ensureConfigured()\r\n            .then(() => {\r\n            if (!this.isActive) {\r\n                // returning null to avoid Bluebird warning\r\n                return null;\r\n            }\r\n            const element = this.element;\r\n            const href = this.router.generate(this.route, this.params);\r\n            if (element.au.controller) {\r\n                element.au.controller.viewModel[this.attribute] = href;\r\n            }\r\n            else {\r\n                element.setAttribute(this.attribute, href);\r\n            }\r\n            // returning null to avoid Bluebird warning\r\n            return null;\r\n        })\r\n            .catch((reason) => {\r\n            logger.error(reason);\r\n        });\r\n    }\r\n}\r\n/**\r\n * @internal Actively avoid using decorator to reduce the amount of code generated\r\n */\r\nRouteHref.$resource = {\r\n    type: 'attribute',\r\n    name: 'route-href',\r\n    bindables: [\r\n        { name: 'route', changeHandler: 'processChange', primaryProperty: true },\r\n        { name: 'params', changeHandler: 'processChange' },\r\n        'attribute'\r\n    ] // type definition of Aurelia templating is wrong\r\n};\n\nfunction configure(config) {\r\n    config\r\n        .singleton(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"RouteLoader\"], TemplatingRouteLoader)\r\n        .singleton(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"AppRouter\"])\r\n        .globalResources(RouterView, RouteHref);\r\n    config.container.registerAlias(aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"Router\"], aurelia_router__WEBPACK_IMPORTED_MODULE_0__[\"AppRouter\"]);\r\n}\n\n\n//# sourceMappingURL=aurelia-templating-router.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyL2Rpc3QvZXMyMDE1L2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIuanM/ZTk2MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIsIFJvdXRlTG9hZGVyLCBBcHBSb3V0ZXIgfSBmcm9tICdhdXJlbGlhLXJvdXRlcic7XG5pbXBvcnQgeyBPcmlnaW4gfSBmcm9tICdhdXJlbGlhLW1ldGFkYXRhJztcbmltcG9ydCB7IHJlbGF0aXZlVG9GaWxlIH0gZnJvbSAnYXVyZWxpYS1wYXRoJztcbmltcG9ydCB7IFZpZXdTbG90LCBWaWV3TG9jYXRvciwgQ29tcG9zaXRpb25UcmFuc2FjdGlvbiwgQ29tcG9zaXRpb25FbmdpbmUsIEJlaGF2aW9ySW5zdHJ1Y3Rpb24sIFNoYWRvd0RPTSwgU3dhcFN0cmF0ZWdpZXMsIGlubGluZVZpZXcsIGN1c3RvbUVsZW1lbnQsIHVzZVZpZXcgfSBmcm9tICdhdXJlbGlhLXRlbXBsYXRpbmcnO1xuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSAnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbic7XG5pbXBvcnQgeyBjcmVhdGVPdmVycmlkZUNvbnRleHQgfSBmcm9tICdhdXJlbGlhLWJpbmRpbmcnO1xuaW1wb3J0IHsgRE9NIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuaW1wb3J0IHsgZ2V0TG9nZ2VyIH0gZnJvbSAnYXVyZWxpYS1sb2dnaW5nJztcblxuY2xhc3MgRW1wdHlMYXlvdXRWaWV3TW9kZWwge1xyXG59XHJcbi8qKlxyXG4gKiBJbXBsZW1lbnRhdGlvbiBvZiBBdXJlbGlhIFJvdXRlciBWaWV3UG9ydC4gUmVzcG9uc2libGUgZm9yIGxvYWRpbmcgcm91dGUsIGNvbXBvc2luZyBhbmQgc3dhcHBpbmcgcm91dGVzIHZpZXdzXHJcbiAqL1xyXG5jbGFzcyBSb3V0ZXJWaWV3IHtcclxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGNvbnRhaW5lciwgdmlld1Nsb3QsIHJvdXRlciwgdmlld0xvY2F0b3IsIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24sIGNvbXBvc2l0aW9uRW5naW5lKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XHJcbiAgICAgICAgdGhpcy52aWV3TG9jYXRvciA9IHZpZXdMb2NhdG9yO1xyXG4gICAgICAgIHRoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbiA9IGNvbXBvc2l0aW9uVHJhbnNhY3Rpb247XHJcbiAgICAgICAgdGhpcy5jb21wb3NpdGlvbkVuZ2luZSA9IGNvbXBvc2l0aW9uRW5naW5lO1xyXG4gICAgICAgIC8vIGFkZCB0aGlzIDxyb3V0ZXItdmlldy8+IHRvIHJvdXRlciB2aWV3IHBvcnRzIGxvb2t1cCBiYXNlZCBvbiBuYW1lIGF0dHJpYnV0ZVxyXG4gICAgICAgIC8vIHdoZW4gdGhpcyByb3V0ZXIgaXMgdGhlIHJvb3Qgcm91dGVyLXZpZXdcclxuICAgICAgICAvLyBhbHNvIHRyaWdnZXIgQXBwUm91dGVyIHJlZ2lzdGVyVmlld1BvcnQgZXh0cmEgZmxvd1xyXG4gICAgICAgIHRoaXMucm91dGVyLnJlZ2lzdGVyVmlld1BvcnQodGhpcywgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnbmFtZScpKTtcclxuICAgICAgICAvLyBFYWNoIDxyb3V0ZXItdmlldy8+IHByb2Nlc3MgaXRzIGluc3RydWN0aW9uIGFzIGEgY29tcG9zaXRpb24gdHJhbnNhY3Rpb25cclxuICAgICAgICAvLyB0aGVyZSBhcmUgZGlmZmVyZW5jZXMgYmV0d2VlbiBpbnRpYWwgY29tcG9zaXRpb24gYW5kIHN1YnNlcXVlbnQgY29tcG9zaXRpb25zXHJcbiAgICAgICAgLy8gYWxzbyB0aGVyZSBhcmUgZGlmZmVyZW5jZXMgYmV0d2VlbiByb290IGNvbXBvc2l0aW9uIGFuZCBjaGlsZCA8cm91dGVyLXZpZXcvPiBjb21wb3NpdGlvblxyXG4gICAgICAgIC8vIG1hcmsgdGhlIGZpcnN0IGNvbXBvc2l0aW9uIHRyYW5zYWN0aW9uIHdpdGggYSBwcm9wZXJ0eSBpbml0aWFsQ29tcG9zaXRpb24gdG8gZGlzdGluZ3Vpc2ggaXRcclxuICAgICAgICAvLyB3aGVuIHRoZSByb290IDxyb3V0ZXItdmlldy8+IGdldHMgbmV3IGluc3RydWN0aW9uIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIGlmICghKCdpbml0aWFsQ29tcG9zaXRpb24nIGluIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24pKSB7XHJcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb24uaW5pdGlhbENvbXBvc2l0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIgPSBjb21wb3NpdGlvblRyYW5zYWN0aW9uLmVubGlzdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgc3RhdGljIGluamVjdCgpIHtcclxuICAgICAgICByZXR1cm4gW0RPTS5FbGVtZW50LCBDb250YWluZXIsIFZpZXdTbG90LCBSb3V0ZXIsIFZpZXdMb2NhdG9yLCBDb21wb3NpdGlvblRyYW5zYWN0aW9uLCBDb21wb3NpdGlvbkVuZ2luZV07XHJcbiAgICB9XHJcbiAgICBjcmVhdGVkKG93bmluZ1ZpZXcpIHtcclxuICAgICAgICB0aGlzLm93bmluZ1ZpZXcgPSBvd25pbmdWaWV3O1xyXG4gICAgfVxyXG4gICAgYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgLy8gcm91dGVyIG5lZWRzIHRvIGdldCBhY2Nlc3MgdG8gdmlldyBtb2RlbCBvZiBjdXJyZW50IHJvdXRlIHBhcmVudFxyXG4gICAgICAgIC8vIGRvaW5nIGl0IGluIGdlbmVyaWMgd2F5IHZpYSB2aWV3TW9kZWwgcHJvcGVydHkgb24gY29udGFpbmVyXHJcbiAgICAgICAgdGhpcy5jb250YWluZXIudmlld01vZGVsID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEltcGxlbWVudGF0aW9uIG9mIGBhdXJlbGlhLXJvdXRlcmAgVmlld1BvcnQgaW50ZXJmYWNlLCByZXNwb25zaWJsZSBmb3IgdGVtcGxhdGluZyByZWxhdGVkIHBhcnQgaW4gcm91dGluZyBQaXBlbGluZVxyXG4gICAgICovXHJcbiAgICBwcm9jZXNzKCR2aWV3UG9ydEluc3RydWN0aW9uLCB3YWl0VG9Td2FwKSB7XHJcbiAgICAgICAgLy8gaGF2ZSBzdHJvbmcgdHlwaW5ncyB3aXRob3V0IGV4cG9zaW5nIGl0IGluIHB1YmxpYyB0eXBpbmdzLCB0aGlzIGlzIHRvIGVuc3VyZSBtYXhpbXVtIGJhY2t3YXJkIGNvbXBhdFxyXG4gICAgICAgIGNvbnN0IHZpZXdQb3J0SW5zdHJ1Y3Rpb24gPSAkdmlld1BvcnRJbnN0cnVjdGlvbjtcclxuICAgICAgICBjb25zdCBjb21wb25lbnQgPSB2aWV3UG9ydEluc3RydWN0aW9uLmNvbXBvbmVudDtcclxuICAgICAgICBjb25zdCBjaGlsZENvbnRhaW5lciA9IGNvbXBvbmVudC5jaGlsZENvbnRhaW5lcjtcclxuICAgICAgICBjb25zdCB2aWV3TW9kZWwgPSBjb21wb25lbnQudmlld01vZGVsO1xyXG4gICAgICAgIGNvbnN0IHZpZXdNb2RlbFJlc291cmNlID0gY29tcG9uZW50LnZpZXdNb2RlbFJlc291cmNlO1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gdmlld01vZGVsUmVzb3VyY2UubWV0YWRhdGE7XHJcbiAgICAgICAgY29uc3QgY29uZmlnID0gY29tcG9uZW50LnJvdXRlci5jdXJyZW50SW5zdHJ1Y3Rpb24uY29uZmlnO1xyXG4gICAgICAgIGNvbnN0IHZpZXdQb3J0Q29uZmlnID0gY29uZmlnLnZpZXdQb3J0cyA/IChjb25maWcudmlld1BvcnRzW3ZpZXdQb3J0SW5zdHJ1Y3Rpb24ubmFtZV0gfHwge30pIDoge307XHJcbiAgICAgICAgY2hpbGRDb250YWluZXIuZ2V0KFJvdXRlclZpZXdMb2NhdG9yKS5fbm90aWZ5KHRoaXMpO1xyXG4gICAgICAgIC8vIGxheW91dEluc3RydWN0aW9uIGlzIG91ciBsYXlvdXQgdmlld01vZGVsXHJcbiAgICAgICAgY29uc3QgbGF5b3V0SW5zdHJ1Y3Rpb24gPSB7XHJcbiAgICAgICAgICAgIHZpZXdNb2RlbDogdmlld1BvcnRDb25maWcubGF5b3V0Vmlld01vZGVsIHx8IGNvbmZpZy5sYXlvdXRWaWV3TW9kZWwgfHwgdGhpcy5sYXlvdXRWaWV3TW9kZWwsXHJcbiAgICAgICAgICAgIHZpZXc6IHZpZXdQb3J0Q29uZmlnLmxheW91dFZpZXcgfHwgY29uZmlnLmxheW91dFZpZXcgfHwgdGhpcy5sYXlvdXRWaWV3LFxyXG4gICAgICAgICAgICBtb2RlbDogdmlld1BvcnRDb25maWcubGF5b3V0TW9kZWwgfHwgY29uZmlnLmxheW91dE1vZGVsIHx8IHRoaXMubGF5b3V0TW9kZWwsXHJcbiAgICAgICAgICAgIHJvdXRlcjogdmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQucm91dGVyLFxyXG4gICAgICAgICAgICBjaGlsZENvbnRhaW5lcjogY2hpbGRDb250YWluZXIsXHJcbiAgICAgICAgICAgIHZpZXdTbG90OiB0aGlzLnZpZXdTbG90XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyB2aWV3cG9ydCB3aWxsIGJlIGEgdGhpbiB3cmFwcGVyIGFyb3VuZCBjb21wb3NpdGlvbiBlbmdpbmVcclxuICAgICAgICAvLyB0byBwcm9jZXNzIGluc3RydWN0aW9uL2NvbmZpZ3VyYXRpb24gZnJvbSB1c2Vyc1xyXG4gICAgICAgIC8vIHByZXBhcmluZyBhbGwgaW5mb3JtYXRpb24gcmVsYXRlZCB0byBhIGNvbXBvc2l0aW9uIHByb2Nlc3NcclxuICAgICAgICAvLyBmaXJzdCBieSBnZXR0aW5nIHZpZXcgc3RyYXRlZ3kgb2YgYSBWaWV3UG9ydENvbXBvbmVudCBWaWV3XHJcbiAgICAgICAgY29uc3Qgdmlld1N0cmF0ZWd5ID0gdGhpcy52aWV3TG9jYXRvci5nZXRWaWV3U3RyYXRlZ3koY29tcG9uZW50LnZpZXcgfHwgdmlld01vZGVsKTtcclxuICAgICAgICBpZiAodmlld1N0cmF0ZWd5ICYmIGNvbXBvbmVudC52aWV3KSB7XHJcbiAgICAgICAgICAgIHZpZXdTdHJhdGVneS5tYWtlUmVsYXRpdmVUbyhPcmlnaW4uZ2V0KGNvbXBvbmVudC5yb3V0ZXIuY29udGFpbmVyLnZpZXdNb2RlbC5jb25zdHJ1Y3RvcikubW9kdWxlSWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB1c2luZyBtZXRhZGF0YSBvZiBhIGN1c3RvbSBlbGVtZW50IHZpZXcgbW9kZWwgdG8gbG9hZCBhcHByb3ByaWF0ZSB2aWV3LWZhY3RvcnkgaW5zdGFuY2VcclxuICAgICAgICByZXR1cm4gbWV0YWRhdGFcclxuICAgICAgICAgICAgLmxvYWQoY2hpbGRDb250YWluZXIsIHZpZXdNb2RlbFJlc291cmNlLnZhbHVlLCBudWxsLCB2aWV3U3RyYXRlZ3ksIHRydWUpXHJcbiAgICAgICAgICAgIC8vIGZvciBjdXN0b20gZWxlbWVudCwgdmlld0ZhY3RvcnkgdHlwaW5nIGlzIGFsd2F5cyBWaWV3RmFjdG9yeVxyXG4gICAgICAgICAgICAvLyBmb3IgY3VzdG9tIGF0dHJpYnV0ZSwgaXQgd2lsbCBiZSBIdG1sQmVoYXZpb3JSZXNvdXJjZVxyXG4gICAgICAgICAgICAudGhlbigodmlld0ZhY3RvcnkpID0+IHtcclxuICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBub3QgdGhlIGZpcnN0IHRpbWUgdGhhdCB0aGlzIDxyb3V0ZXItdmlldy8+IGlzIGNvbXBvc2luZyBpdHMgaW5zdHJ1Y3Rpb25cclxuICAgICAgICAgICAgLy8gdHJ5IHRvIGNhcHR1cmUgb3duZXJzaGlwIG9mIHRoZSBjb21wb3NpdGlvbiB0cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAvLyBjaGlsZCA8cm91dGVyLXZpZXcvPiB3aWxsIG5vdCBiZSBhYmxlIHRvIGNhcHR1cmUsIHNpbmNlIHJvb3QgPHJvdXRlci12aWV3Lz4gdHlwaWNhbGx5IGNhcHR1cmVzXHJcbiAgICAgICAgICAgIC8vIHRoZSBvd25lcnNoaXAgdG9rZW5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4gPSB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb24udHJ5Q2FwdHVyZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChsYXlvdXRJbnN0cnVjdGlvbi52aWV3TW9kZWwgfHwgbGF5b3V0SW5zdHJ1Y3Rpb24udmlldykge1xyXG4gICAgICAgICAgICAgICAgdmlld1BvcnRJbnN0cnVjdGlvbi5sYXlvdXRJbnN0cnVjdGlvbiA9IGxheW91dEluc3RydWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXdQb3J0Q29tcG9uZW50QmVoYXZpb3JJbnN0cnVjdGlvbiA9IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uZHluYW1pYyh0aGlzLmVsZW1lbnQsIHZpZXdNb2RlbCwgdmlld0ZhY3RvcnkpO1xyXG4gICAgICAgICAgICB2aWV3UG9ydEluc3RydWN0aW9uLmNvbnRyb2xsZXIgPSBtZXRhZGF0YS5jcmVhdGUoY2hpbGRDb250YWluZXIsIHZpZXdQb3J0Q29tcG9uZW50QmVoYXZpb3JJbnN0cnVjdGlvbik7XHJcbiAgICAgICAgICAgIGlmICh3YWl0VG9Td2FwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnN3YXAodmlld1BvcnRJbnN0cnVjdGlvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBzd2FwKCR2aWV3UG9ydEluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgLy8gaGF2ZSBzdHJvbmcgdHlwaW5ncyB3aXRob3V0IGV4cG9zaW5nIGl0IGluIHB1YmxpYyB0eXBpbmdzLCB0aGlzIGlzIHRvIGVuc3VyZSBtYXhpbXVtIGJhY2t3YXJkIGNvbXBhdFxyXG4gICAgICAgIGNvbnN0IHZpZXdQb3J0SW5zdHJ1Y3Rpb24gPSAkdmlld1BvcnRJbnN0cnVjdGlvbjtcclxuICAgICAgICBjb25zdCB2aWV3UG9ydENvbnRyb2xsZXIgPSB2aWV3UG9ydEluc3RydWN0aW9uLmNvbnRyb2xsZXI7XHJcbiAgICAgICAgY29uc3QgbGF5b3V0SW5zdHJ1Y3Rpb24gPSB2aWV3UG9ydEluc3RydWN0aW9uLmxheW91dEluc3RydWN0aW9uO1xyXG4gICAgICAgIGNvbnN0IHByZXZpb3VzVmlldyA9IHRoaXMudmlldztcclxuICAgICAgICAvLyBGaW5hbCBzdGVwIG9mIHN3YXBwaW5nIGEgPHJvdXRlci12aWV3Lz4gVmlld1BvcnRDb21wb25lbnRcclxuICAgICAgICBjb25zdCB3b3JrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzd2FwU3RyYXRlZ3kgPSBTd2FwU3RyYXRlZ2llc1t0aGlzLnN3YXBPcmRlcl0gfHwgU3dhcFN0cmF0ZWdpZXMuYWZ0ZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXdTbG90ID0gdGhpcy52aWV3U2xvdDtcclxuICAgICAgICAgICAgc3dhcFN0cmF0ZWd5KHZpZXdTbG90LCBwcmV2aW91c1ZpZXcsICgpID0+IFByb21pc2UucmVzb2x2ZSh2aWV3U2xvdC5hZGQodGhpcy52aWV3KSkpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gRW5zdXJlIGFsbCB1c2VycyBzZXR1cHMgaGF2ZSBiZWVuIGNvbXBsZXRlZFxyXG4gICAgICAgIGNvbnN0IHJlYWR5ID0gKG93bmluZ1ZpZXdfb3JfbGF5b3V0VmlldykgPT4ge1xyXG4gICAgICAgICAgICB2aWV3UG9ydENvbnRyb2xsZXIuYXV0b21hdGUodGhpcy5vdmVycmlkZUNvbnRleHQsIG93bmluZ1ZpZXdfb3JfbGF5b3V0Vmlldyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uT3duZXJTaGlwVG9rZW4gPSB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbjtcclxuICAgICAgICAgICAgLy8gaWYgdGhpcyByb3V0ZXItdmlldyBpcyB0aGUgcm9vdCA8cm91dGVyLXZpZXcvPiBvZiBhIG5vcm1hbCBzdGFydHVwIHZpYSBhdXJlbGlhLnNldFJvb3RcclxuICAgICAgICAgICAgLy8gYXR0ZW1wIHRvIHRha2UgY29udHJvbCBvZiB0aGUgdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgLy8gaWYgb3duZXJzaGlwIGNhbiBiZSB0YWtlblxyXG4gICAgICAgICAgICAvLyB3YWl0IGZvciB0cmFuc2FjdGlvbiB0byBjb21wbGV0ZSBiZWZvcmUgc3dhcHBpbmdcclxuICAgICAgICAgICAgaWYgKHRyYW5zYWN0aW9uT3duZXJTaGlwVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbk93bmVyU2hpcFRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgLndhaXRGb3JDb21wb3NpdGlvbkNvbXBsZXRlKClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB3b3JrKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBvdGhlcndpc2UsIGp1c3Qgc3dhcFxyXG4gICAgICAgICAgICByZXR1cm4gd29yaygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgbGF5b3V0IGluc3RydWN0aW9uLCBuZXcgdG8gY29tcG9zZSBsYXlvdXQgYmVmb3JlIHByb2Nlc3NpbmcgVmlld1BvcnRDb21wb25lbnRcclxuICAgICAgICAvLyBsYXlvdXQgY29udHJvbGxlci92aWV3L3ZpZXctbW9kZWwgaXMgY29tcG9zZWQgdXNpbmcgY29tcG9zaXRpb24gZW5naW5lIEFQSXNcclxuICAgICAgICBpZiAobGF5b3V0SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgaWYgKCFsYXlvdXRJbnN0cnVjdGlvbi52aWV3TW9kZWwpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZUNvbnRyb2xsZXIgY2hva2VzIGlmIHRoZXJlJ3Mgbm8gdmlld21vZGVsLCBzbyBjcmVhdGUgYSBkdW1teSBvbmVcclxuICAgICAgICAgICAgICAgIC8vIGJ1dCBhdm9pZCB1c2luZyBhIFBPSk8gYXMgaXQgY3JlYXRlcyB1bndhbnRlZCBtZXRhZGF0YSBpbiBPYmplY3QgY29uc3RydWN0b3JcclxuICAgICAgICAgICAgICAgIGxheW91dEluc3RydWN0aW9uLnZpZXdNb2RlbCA9IG5ldyBFbXB0eUxheW91dFZpZXdNb2RlbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHVzaW5nIGNvbXBvc2l0aW9uIGVuZ2luZSB0byBjcmVhdGUgY29tcG9zZSBsYXlvdXRcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9zaXRpb25FbmdpbmVcclxuICAgICAgICAgICAgICAgIC8vIGZpcnN0IGNyZWF0ZSBjb250cm9sbGVyIGZyb20gbGF5b3V0SW5zdHJ1Y3Rpb25cclxuICAgICAgICAgICAgICAgIC8vIGFuZCB0cmVhdCBpdCBhcyBDb21wb3NpdGlvbkNvbnRleHRcclxuICAgICAgICAgICAgICAgIC8vIHRoZW4gZW11bGF0ZSBzbG90IHByb2plY3Rpb24gd2l0aCBWaWV3UG9ydENvbXBvbmVudCB2aWV3XHJcbiAgICAgICAgICAgICAgICAuY3JlYXRlQ29udHJvbGxlcihsYXlvdXRJbnN0cnVjdGlvbilcclxuICAgICAgICAgICAgICAgIC50aGVuKChsYXlvdXRDb250cm9sbGVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsYXlvdXRWaWV3ID0gbGF5b3V0Q29udHJvbGxlci52aWV3O1xyXG4gICAgICAgICAgICAgICAgU2hhZG93RE9NLmRpc3RyaWJ1dGVWaWV3KHZpZXdQb3J0Q29udHJvbGxlci52aWV3LCBsYXlvdXRDb250cm9sbGVyLnNsb3RzIHx8IGxheW91dFZpZXcuc2xvdHMpO1xyXG4gICAgICAgICAgICAgICAgLy8gd2hlbiB0aGVyZSBpcyBhIGxheW91dFxyXG4gICAgICAgICAgICAgICAgLy8gdmlldyBoaWVyYXJjaHkgaXM6IDxyb3V0ZXItdmlldy8+IG93bmVyIHZpZXcgLT4gbGF5b3V0IHZpZXcgLT4gVmlld1BvcnRDb21wb25lbnQgdmlld1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0Q29udHJvbGxlci5hdXRvbWF0ZShjcmVhdGVPdmVycmlkZUNvbnRleHQobGF5b3V0SW5zdHJ1Y3Rpb24udmlld01vZGVsKSwgdGhpcy5vd25pbmdWaWV3KTtcclxuICAgICAgICAgICAgICAgIGxheW91dFZpZXcuY2hpbGRyZW4ucHVzaCh2aWV3UG9ydENvbnRyb2xsZXIudmlldyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGF5b3V0VmlldyB8fCBsYXlvdXRDb250cm9sbGVyO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKG5ld1ZpZXcpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldyA9IG5ld1ZpZXc7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVhZHkobmV3Vmlldyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyBsYXlvdXQsIHRoZW4gZ2V0IFZpZXdQb3J0Q29tcG9uZW50IHZpZXcgcmVhZHkgYXMgdmlldyBwcm9wZXJ0eVxyXG4gICAgICAgIC8vIGFuZCBwcm9jZXNzIGNvbnRyb2xsZXIvc3dhcHBpbmdcclxuICAgICAgICAvLyB3aGVuIHRoZXJlIGlzIG5vIGxheW91dFxyXG4gICAgICAgIC8vIHZpZXcgaGllcmFyY2h5IGlzOiA8cm91dGVyLXZpZXcvPiBvd25lciB2aWV3IC0+IFZpZXdQb3J0Q29tcG9uZW50IHZpZXdcclxuICAgICAgICB0aGlzLnZpZXcgPSB2aWV3UG9ydENvbnRyb2xsZXIudmlldztcclxuICAgICAgICByZXR1cm4gcmVhZHkodGhpcy5vd25pbmdWaWV3KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTm90aWZ5IGNvbXBvc2l0aW9uIHRyYW5zYWN0aW9uIHRoYXQgdGhpcyByb3V0ZXIgaGFzIGZpbmlzaGVkIHByb2Nlc3NpbmdcclxuICAgICAqIEhhcHBlbnMgd2hlbiB0aGlzIDxyb3V0ZXItdmlldy8+IGlzIHRoZSByb290IHJvdXRlci12aWV3XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgX25vdGlmeSgpIHtcclxuICAgICAgICBjb25zdCBub3RpZmllciA9IHRoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyO1xyXG4gICAgICAgIGlmIChub3RpZmllcikge1xyXG4gICAgICAgICAgICBub3RpZmllci5kb25lKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEBpbnRlcm5hbCBBY3RpdmVseSBhdm9pZCB1c2luZyBkZWNvcmF0b3IgdG8gcmVkdWNlIHRoZSBhbW91bnQgb2YgY29kZSBnZW5lcmF0ZWRcclxuICpcclxuICogVGhlcmUgaXMgbm8gdmlldyB0byBjb21wb3NlIGJ5IGRlZmF1bHQgaW4gYSByb3V0ZXIgdmlld1xyXG4gKiBUaGlzIGN1c3RvbSBlbGVtZW50IGlzIHJlc3BvbnNpYmxlIGZvciBjb21wb3NpbmcgaXRzIG93biB2aWV3LCBiYXNlZCBvbiBjdXJyZW50IGNvbmZpZ1xyXG4gKi9cclxuUm91dGVyVmlldy4kdmlldyA9IG51bGw7XHJcbi8qKlxyXG4gKiBAaW50ZXJuYWwgQWN0aXZlbHkgYXZvaWQgdXNpbmcgZGVjb3JhdG9yIHRvIHJlZHVjZSB0aGUgYW1vdW50IG9mIGNvZGUgZ2VuZXJhdGVkXHJcbiAqL1xyXG5Sb3V0ZXJWaWV3LiRyZXNvdXJjZSA9IHtcclxuICAgIG5hbWU6ICdyb3V0ZXItdmlldycsXHJcbiAgICBiaW5kYWJsZXM6IFsnc3dhcE9yZGVyJywgJ2xheW91dFZpZXcnLCAnbGF5b3V0Vmlld01vZGVsJywgJ2xheW91dE1vZGVsJywgJ2luaGVyaXQtYmluZGluZy1jb250ZXh0J11cclxufTtcclxuLyoqXHJcbiogTG9jYXRvciB3aGljaCBmaW5kcyB0aGUgbmVhcmVzdCBSb3V0ZXJWaWV3LCByZWxhdGl2ZSB0byB0aGUgY3VycmVudCBkZXBlbmRlbmN5IGluamVjdGlvbiBjb250YWluZXIuXHJcbiovXHJcbmNsYXNzIFJvdXRlclZpZXdMb2NhdG9yIHtcclxuICAgIC8qKlxyXG4gICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBSb3V0ZXJWaWV3TG9jYXRvciBjbGFzcy5cclxuICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gdGhpcy5yZXNvbHZlID0gcmVzb2x2ZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICogRmluZHMgdGhlIG5lYXJlc3QgUm91dGVyVmlldyBpbnN0YW5jZS5cclxuICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSBsb2NhdGVkIFJvdXRlclZpZXcgaW5zdGFuY2UuXHJcbiAgICAqL1xyXG4gICAgZmluZE5lYXJlc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZTtcclxuICAgIH1cclxuICAgIC8qKkBpbnRlcm5hbCAqL1xyXG4gICAgX25vdGlmeShyb3V0ZXJWaWV3KSB7XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlKHJvdXRlclZpZXcpO1xyXG4gICAgfVxyXG59XG5cbi8qKkBpbnRlcm5hbCBleHBvcnRlZCBmb3IgdW5pdCB0ZXN0aW5nICovXHJcbmNsYXNzIEVtcHR5Q2xhc3Mge1xyXG59XHJcbmlubGluZVZpZXcoJzx0ZW1wbGF0ZT48L3RlbXBsYXRlPicpKEVtcHR5Q2xhc3MpO1xyXG4vKipcclxuICogRGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBvZiBgUm91dGVMb2FkZXJgIHVzZWQgZm9yIGxvYWRpbmcgY29tcG9uZW50IGJhc2VkIG9uIGEgcm91dGUgY29uZmlnXHJcbiAqL1xyXG5jbGFzcyBUZW1wbGF0aW5nUm91dGVMb2FkZXIgZXh0ZW5kcyBSb3V0ZUxvYWRlciB7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb21wb3NpdGlvbkVuZ2luZSkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5jb21wb3NpdGlvbkVuZ2luZSA9IGNvbXBvc2l0aW9uRW5naW5lO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNvbHZlIGEgdmlldyBtb2RlbCBmcm9tIGEgUm91dGVDb25maWdcclxuICAgICAqIFRocm93cyB3aGVuIHRoZXJlIGlzIG5laXRoZXIgXCJtb2R1bGVJZFwiIG5vciBcInZpZXdNb2RlbFwiIHByb3BlcnR5XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgcmVzb2x2ZVZpZXdNb2RlbChyb3V0ZXIsIGNvbmZpZykge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB2aWV3TW9kZWw7XHJcbiAgICAgICAgICAgIGlmICgnbW9kdWxlSWQnIGluIGNvbmZpZykge1xyXG4gICAgICAgICAgICAgICAgbGV0IG1vZHVsZUlkID0gY29uZmlnLm1vZHVsZUlkO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1vZHVsZUlkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld01vZGVsID0gRW1wdHlDbGFzcztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgcmVxdWlyZXMgY29udGFpbmVyIG9mIHJvdXRlciBoYXMgcGFzc2VzIGEgY2VydGFpbiBwb2ludFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZXJlIGEgdmlldyBtb2RlbCBoYXMgYmVlbiBzZXR1cCBvbiB0aGUgY29udGFpbmVyXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBmYWlsIGluIGVuaGFuY2Ugc2NlbmFyaW8gYmVjYXVzZSBubyB2aWV3cG9ydCBoYXMgYmVlbiByZWdpc3RlcmVkXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlSWQgPSByZWxhdGl2ZVRvRmlsZShtb2R1bGVJZCwgT3JpZ2luLmdldChyb3V0ZXIuY29udGFpbmVyLnZpZXdNb2RlbC5jb25zdHJ1Y3RvcikubW9kdWxlSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgvXFwuaHRtbC9pLnRlc3QobW9kdWxlSWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdNb2RlbCA9IGNyZWF0ZUR5bmFtaWNDbGFzcyhtb2R1bGVJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3TW9kZWwgPSBtb2R1bGVJZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh2aWV3TW9kZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHRvZG86IGFkZCBpZiAoJ3ZpZXdNb2RlbCcgaW4gY29uZmlnKSB0byBzdXBwb3J0IHN0YXRpYyB2aWV3IG1vZGVsIHJlc29sdXRpb25cclxuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignSW52YWxpZCByb3V0ZSBjb25maWcuIE5vIFwibW9kdWxlSWRcIiBmb3VuZC4nKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBjaGlsZCBjb250YWluZXIgYmFzZWQgb24gYSByb3V0ZXIgY29udGFpbmVyXHJcbiAgICAgKiBBbHNvIGVuc3VyZXMgdGhhdCBjaGlsZCByb3V0ZXIgYXJlIHByb3Blcmx5IGNvbnN0cnVjdGVkIGluIHRoZSBuZXdseSBjcmVhdGVkIGNoaWxkIGNvbnRhaW5lclxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZUNoaWxkQ29udGFpbmVyKHJvdXRlcikge1xyXG4gICAgICAgIGNvbnN0IGNoaWxkQ29udGFpbmVyID0gcm91dGVyLmNvbnRhaW5lci5jcmVhdGVDaGlsZCgpO1xyXG4gICAgICAgIGNoaWxkQ29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uKFJvdXRlclZpZXdMb2NhdG9yKTtcclxuICAgICAgICBjaGlsZENvbnRhaW5lci5nZXRDaGlsZFJvdXRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGV0IGNoaWxkUm91dGVyO1xyXG4gICAgICAgICAgICBjaGlsZENvbnRhaW5lci5yZWdpc3RlckhhbmRsZXIoUm91dGVyLCAoKSA9PiBjaGlsZFJvdXRlciB8fCAoY2hpbGRSb3V0ZXIgPSByb3V0ZXIuY3JlYXRlQ2hpbGQoY2hpbGRDb250YWluZXIpKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZENvbnRhaW5lci5nZXQoUm91dGVyKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBjaGlsZENvbnRhaW5lcjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTG9hZCBjb3JyZXNwb25kaW5nIGNvbXBvbmVudCBvZiBhIHJvdXRlIGNvbmZpZyBvZiBhIG5hdmlnYXRpb24gaW5zdHJ1Y3Rpb25cclxuICAgICAqL1xyXG4gICAgbG9hZFJvdXRlKHJvdXRlciwgY29uZmlnLCBfbmF2SW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICAucmVzb2x2ZVZpZXdNb2RlbChyb3V0ZXIsIGNvbmZpZylcclxuICAgICAgICAgICAgLnRoZW4odmlld01vZGVsID0+IHRoaXMuY29tcG9zaXRpb25FbmdpbmUuZW5zdXJlVmlld01vZGVsKHtcclxuICAgICAgICAgICAgdmlld01vZGVsOiB2aWV3TW9kZWwsXHJcbiAgICAgICAgICAgIGNoaWxkQ29udGFpbmVyOiB0aGlzLmNyZWF0ZUNoaWxkQ29udGFpbmVyKHJvdXRlciksXHJcbiAgICAgICAgICAgIHZpZXc6IGNvbmZpZy52aWV3IHx8IGNvbmZpZy52aWV3U3RyYXRlZ3ksXHJcbiAgICAgICAgICAgIHJvdXRlcjogcm91dGVyXHJcbiAgICAgICAgfSkpO1xyXG4gICAgfVxyXG59XHJcbi8qKkBpbnRlcm5hbCAqL1xyXG5UZW1wbGF0aW5nUm91dGVMb2FkZXIuaW5qZWN0ID0gW0NvbXBvc2l0aW9uRW5naW5lXTtcclxuLyoqQGludGVybmFsIGV4cG9ydGVkIGZvciB1bml0IHRlc3RpbmcgKi9cclxuZnVuY3Rpb24gY3JlYXRlRHluYW1pY0NsYXNzKG1vZHVsZUlkKSB7XHJcbiAgICBjb25zdCBuYW1lID0gLyhbXlxcL15cXD9dKylcXC5odG1sL2kuZXhlYyhtb2R1bGVJZClbMV07XHJcbiAgICBjbGFzcyBEeW5hbWljQ2xhc3Mge1xyXG4gICAgICAgIGJpbmQoYmluZGluZ0NvbnRleHQpIHtcclxuICAgICAgICAgICAgdGhpcy4kcGFyZW50ID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY3VzdG9tRWxlbWVudChuYW1lKShEeW5hbWljQ2xhc3MpO1xyXG4gICAgdXNlVmlldyhtb2R1bGVJZCkoRHluYW1pY0NsYXNzKTtcclxuICAgIHJldHVybiBEeW5hbWljQ2xhc3M7XHJcbn1cblxuY29uc3QgbG9nZ2VyID0gZ2V0TG9nZ2VyKCdyb3V0ZS1ocmVmJyk7XHJcbi8qKlxyXG4gKiBIZWxwZXIgY3VzdG9tIGF0dHJpYnV0ZSB0byBoZWxwIGFzc29jaWF0ZSBhbiBlbGVtZW50IHdpdGggYSByb3V0ZSBieSBuYW1lXHJcbiAqL1xyXG5jbGFzcyBSb3V0ZUhyZWYge1xyXG4gICAgY29uc3RydWN0b3Iocm91dGVyLCBlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmF0dHJpYnV0ZSA9ICdocmVmJztcclxuICAgIH1cclxuICAgIC8qQGludGVybmFsICovXHJcbiAgICBzdGF0aWMgaW5qZWN0KCkge1xyXG4gICAgICAgIHJldHVybiBbUm91dGVyLCBET00uRWxlbWVudF07XHJcbiAgICB9XHJcbiAgICBiaW5kKCkge1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucHJvY2Vzc0NoYW5nZSgpO1xyXG4gICAgfVxyXG4gICAgdW5iaW5kKCkge1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGF0dHJpYnV0ZUNoYW5nZWQodmFsdWUsIHByZXZpb3VzKSB7XHJcbiAgICAgICAgaWYgKHByZXZpb3VzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUocHJldmlvdXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzQ2hhbmdlKCk7XHJcbiAgICB9XHJcbiAgICBwcm9jZXNzQ2hhbmdlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJvdXRlclxyXG4gICAgICAgICAgICAuZW5zdXJlQ29uZmlndXJlZCgpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXR1cm5pbmcgbnVsbCB0byBhdm9pZCBCbHVlYmlyZCB3YXJuaW5nXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBocmVmID0gdGhpcy5yb3V0ZXIuZ2VuZXJhdGUodGhpcy5yb3V0ZSwgdGhpcy5wYXJhbXMpO1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5hdS5jb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmF1LmNvbnRyb2xsZXIudmlld01vZGVsW3RoaXMuYXR0cmlidXRlXSA9IGhyZWY7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZSwgaHJlZik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gcmV0dXJuaW5nIG51bGwgdG8gYXZvaWQgQmx1ZWJpcmQgd2FybmluZ1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IocmVhc29uKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogQGludGVybmFsIEFjdGl2ZWx5IGF2b2lkIHVzaW5nIGRlY29yYXRvciB0byByZWR1Y2UgdGhlIGFtb3VudCBvZiBjb2RlIGdlbmVyYXRlZFxyXG4gKi9cclxuUm91dGVIcmVmLiRyZXNvdXJjZSA9IHtcclxuICAgIHR5cGU6ICdhdHRyaWJ1dGUnLFxyXG4gICAgbmFtZTogJ3JvdXRlLWhyZWYnLFxyXG4gICAgYmluZGFibGVzOiBbXHJcbiAgICAgICAgeyBuYW1lOiAncm91dGUnLCBjaGFuZ2VIYW5kbGVyOiAncHJvY2Vzc0NoYW5nZScsIHByaW1hcnlQcm9wZXJ0eTogdHJ1ZSB9LFxyXG4gICAgICAgIHsgbmFtZTogJ3BhcmFtcycsIGNoYW5nZUhhbmRsZXI6ICdwcm9jZXNzQ2hhbmdlJyB9LFxyXG4gICAgICAgICdhdHRyaWJ1dGUnXHJcbiAgICBdIC8vIHR5cGUgZGVmaW5pdGlvbiBvZiBBdXJlbGlhIHRlbXBsYXRpbmcgaXMgd3JvbmdcclxufTtcblxuZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZykge1xyXG4gICAgY29uZmlnXHJcbiAgICAgICAgLnNpbmdsZXRvbihSb3V0ZUxvYWRlciwgVGVtcGxhdGluZ1JvdXRlTG9hZGVyKVxyXG4gICAgICAgIC5zaW5nbGV0b24oUm91dGVyLCBBcHBSb3V0ZXIpXHJcbiAgICAgICAgLmdsb2JhbFJlc291cmNlcyhSb3V0ZXJWaWV3LCBSb3V0ZUhyZWYpO1xyXG4gICAgY29uZmlnLmNvbnRhaW5lci5yZWdpc3RlckFsaWFzKFJvdXRlciwgQXBwUm91dGVyKTtcclxufVxuXG5leHBvcnQgeyBSb3V0ZUhyZWYsIFJvdXRlclZpZXcsIFRlbXBsYXRpbmdSb3V0ZUxvYWRlciwgY29uZmlndXJlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyLmpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///aurelia-templating-router\n");

/***/ }),

/***/ "main":
/*!*********************!*\
  !*** ./src/main.js ***!
  \*********************/
/*! exports provided: configure */
/***/ (function(module, exports) {

eval("throw new Error(\"Module build failed (from ./node_modules/babel-loader/lib/index.js):\\nError: ENOENT: no such file or directory, open '/home/vagrant/b2note/b2note_app/src/main.js'\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///main\n");

/***/ })

/******/ });